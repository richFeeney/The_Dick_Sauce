'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[61],{1436:function(t,C,a){a.r(C);var c=a(0),b=a(508),d=a(49),f=a(10),e=a(54),k=a(86),l=a(84),m=a(221),v=a(413),n=a(37),w=a(7),r=a(15),u=a(85),y=a(82),x=a(222),B=a(13),z=a(108),A=a(4),I=a(88),F=a(146),U=a(124),X=a(572),S=a(93),H=a(553),D=a(5),J=a(720),M=a(131),G=a(513),T=a(368),K=a(170),L=a(247),V=a(33),W=a(245),da=a(563),qa=a(12),O=a(1),ea=a(11),R=a(14),oa=a(21),pa=a(132),Pa=a(151),Z=a(339),Ra=a(681),Ga=a(551),Ba=
a(19);const fa=Ba.a.k8c,Y=H.a.FMe;class ja extends S.a{constructor(Hb,Nc,Db){super(Hb);this.ZHg='<div id="AgaveTaskPaneHeaderId"><span class="{0}" id="{1}"></span></div><div id="{2}"></div>';this.YYb=null;this.jjd=this.h9f=!1;this.P6d=this.pj=this.mf=null;this.su=0;this.button=null;this.lJf=!1;this.rbc="Help.GiveFeedback.Url";this.onCloseButtonTabKeyDown=Cc=>{if(void 0!==Cc.Ca&&null!==Cc.Ca&&Cc.Ca.keyCode===u.a.cA)if(Cc.Ca.shiftKey){if(!V.a.Ad(this.$)){Cc=this.$.da.za(183);if(!Cc)return!1;Cc.NNd()}}else this.hg(!0,
!1),Cc.Ca.preventDefault(),Cc.Ca.stopPropagation();return!0};this.Nmc=(Cc,Xc)=>{Object.getType(Xc)===String&&Xc.toString()===this.mf.InstanceId&&(Cc=!!this.title,Xc=!this.jjd,Cc&&this.GJe(),this.oag(),V.a.Ad(this.$)&&(Cc&&this.h9f||Xc&&this.jjd)&&this.Y6.updateTaskPane(this.tW,this.GB))};this.nla=()=>{var Cc;O.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")&&this.pj.UHd(this.mf.InstanceId);var Xc=da.a(this.mf);if(Xc)if(this.mf.TaskpaneTitle===R.a.instance.ga(983))r.ULS.sendTraceTag(537151139,
9,50,"Chart task pane closed");else if(this.mf.PrimaryMarketplace)if("FA000000005"===this.mf.PrimaryMarketplace.SolutionId){r.ULS.sendTraceTag(537151138,397,50,"Ideas task pane closed");let ld="Unknown",Dd="Unknown",Od="Unknown";null===(Cc=this.mf.OsfPropertyBag)||void 0===Cc?void 0:Cc.forEach(Qd=>{2===Qd.length&&("LaunchMode"===Qd[0]?ld=Qd[1]:"CorrelationId"===Qd[0]?Dd=Qd[1]:"LaunchSelectionMode"===Qd[0]&&(Od=Qd[1]))});Cc={["LaunchMode"]:ld,["CorrelationId"]:Dd,["LaunchSelectionMode"]:Od,["Location"]:"taskPane"};
pa.b(this.$).Cd(M.a.EYg,Cc,void 0,!0);'"Default"'===ld?y.a.instance.Wb("Common.ISystemInitiatedFeedback").execute(Qd=>{Qd.logActivity("Office_Excel_Ideas_InitializeClosePaneFloodgate",null)}):'"RecommendedCharts"'===ld?y.a.instance.Wb("Common.ISystemInitiatedFeedback").execute(Qd=>{Qd.logActivity("Office_Excel_RecommendedCharts_InitializeClosePaneFloodgate",null)}):'"RecommendedPivotTables"'===ld&&O.EwaSettings.isChangeGateEnabled("OfficeVSO:4724516_AddSurveyForRecommendedPivotTables")?y.a.instance.Wb("Common.ISystemInitiatedFeedback").execute(Qd=>
{Qd.logActivity("Office_Excel_RecommendedPivotTable_InitializeClosePaneFloodgate",null)}):'"ChartDesigner"'===ld&&O.EwaSettings.isChangeGateEnabled("OfficeVSO:5202022_AddSurveyForChartDesigner")&&y.a.instance.Wb("Common.ISystemInitiatedFeedback").execute(Qd=>{Qd.logActivity("Office_Excel_ChartDesigner_InitializeClosePaneFloodgate",null)})}else V.a.bdi()&&"FA000000043"===this.mf.PrimaryMarketplace.SolutionId?"Record Actions"===this.mf.TaskpaneTitle&&(this.$.aba=!1,r.ULS.sendTraceTag(537151137,0,50,
"OnCloseButtonClick: set recording state to false since the recorder task pane is closed.")):this.mf.PrimaryMarketplace.SolutionId===X.a&&this.Flf(!1);ea.HelperMethods.iw(this.mf)?this.ig(!1):(V.a.Ad(this.$)?this.Y6.hideTaskPane(this.tW):this.raiseEvent("AgavePaneRemovedEventKey"),this.pj.MPa(this.mf.InstanceId),V.a.Ad(this.$)||this.Y6.Pw());oa.g(this.$).setFocus();if(1===this.mf.WebExtensionOsfControlType&&!Xc){this.mf.TaskpaneVisible=!1;const ld=this.$.oa.va.Sb();Xc=(Dd,Od,Qd)=>L.c(this.$.oa.va,
this.mf.InstanceId,!1,Dd,Od,Qd,ld);O.EwaSettings.dc()?T.a(this.$.userOperationManager,Xc,Dd=>new K.a(547,0,Dd,64),null):T.a(this.$.userOperationManager,Xc,Dd=>new G.a(547,0,Dd,0),null)}return!0};this.Hzf=(Cc,Xc)=>{Object.getType(Xc)===String&&Xc.toString()===this.mf.InstanceId&&(V.a.Ad(this.$)?this.Y6.hideTaskPane(this.tW):this.raiseEvent("AgavePaneRemovedEventKey"))};this.Gzf=(Cc,Xc)=>{Object.getType(Xc)===String&&Xc.toString()===this.mf.InstanceId&&(this.bWd(),V.a.Ad(this.$)?this.O5():this.Y6.VF(this,
!0))};this.onResize=()=>{this.q7c()};this.$=Nc;this.Y6=Db;this.domElement.innerHTML=String.format(this.ZHg,fa,this.$.Bb+D.a.doe,this.$.Bb+D.a.coe);this.hkg=qa.DOMElementExtensions.getElementById(this.domElement,this.$.Bb+D.a.coe);this.sra=qa.DOMElementExtensions.getElementById(this.domElement,this.$.Bb+D.a.doe);O.EwaSettings.ma(421)&&(this.YYb=qa.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId"));Hb=qa.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId");
this.Hna=this.z4g();Hb.appendChild(this.Hna);x.a.instance.ra(B.a.click,this.Hna,this.nla);this.Ahc=z.KeyInputManager.instance.ms(this.Hna,this.nla,u.a.$h);V.a.Ad(this.$)||z.KeyInputManager.instance.ra(B.a.Kb,this.Hna,this.onCloseButtonTabKeyDown);qa.DOMElementExtensions.setVisible(this.sra,!1);this.domElement.style.height="100%";this.domElement.style.width="100%";this.domElement.style.overflowY="hidden";this.q7c();this.$&&O.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&
this.domElement.classList.add(H.a.GMe);this.$.EA(this.onResize)}dP(Hb){this.addHandler("AgavePaneRemovedEventKey",Hb)}qR(Hb){this.removeHandler("AgavePaneRemovedEventKey",Hb)}nDg(Hb){this.addHandler("AgavePaneReadyKey",Hb)}I$i(Hb){this.removeHandler("AgavePaneReadyKey",Hb)}get zFa(){return this.hkg}get Yg(){return 6}get Tk(){return this.mf.TaskpaneIconCssClass||""}get RM(){return this.mf.TaskpaneButtonTooltip||this.mf.WebExtensionToolTip+" "+this.title}get iconUrl(){return this.P6d}get wo(){return this.mf.TaskpaneWidth}get isResizable(){const Hb=
Nc=>{var Db,Cc;return(null===(Cc=null===(Db=this.mf)||void 0===Db?void 0:Db.PrimaryMarketplace)||void 0===Cc?void 0:Cc.SolutionId)===Nc};return!OSF.OsfControl.isFirstPartyStoreString(this.mf.PrimaryMarketplace.MarketplaceType)&&O.EwaSettings.isChangeGateEnabled("OfficeVSO:4470694_LegacyTaskpaneResizeForThirdParty")||Hb("FA000000043")||O.EwaSettings.isChangeGateEnabled("OfficeVSO:6130323_PowerBiSDXResize")&&Hb("FA000000054")||O.EwaSettings.isChangeGateEnabled("OfficeVSO:6545419_ExcelIdeasResize")&&
Hb("FA000000005")?!0:!1}get $d(){return W.a.$Hg}get mc(){return this.domElement}get kf(){return!!this.mf}get title(){return this.pj.BLh(this.mf.InstanceId)}get titleText(){return this.title}get xYa(){return OSF.OsfControlTarget.TaskPane}get instanceId(){return this.mf.InstanceId}get tW(){return"AgaveTaskPane-"+this.instanceId.replace(RegExp("[{}]","g"),"")}get GB(){const Hb=this.Y6.rua(this.mc,this.titleText,this.wo,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=
!0},()=>{this.isVisible=!1},this.wo,void 0,this.iconUrl,this.mf.TaskpaneIconId,ea.HelperMethods.iw(this.mf));if(O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",!1)&&this.mf.SrcLocationOverrideResourceId===this.rbc){Hb.contentProps.type="OcvFeedbackTaskPaneProps";Hb.hideHeader=!1;let Nc=JSON.parse(this.mf.OsfPropertyBag[0][1]);Hb.contentProps.feedbackTaskPaneProps={customerUiWrapperFeedbackData:Nc,taskPaneLocation:Hb.location,taskPaneIdToClose:this.tW}}return Hb}startEdit(){return!0}Ixc(){return!0}kif(){this.pj.Sh.notifyAgave(this.mf.InstanceId,
OSF.AgaveHostAction.TabIn)}lif(){this.pj.Sh.notifyAgave(this.mf.InstanceId,OSF.AgaveHostAction.TabInShift)}Gzd(){this.pj.Vle(this.Hzf);this.pj.UDg(this.Gzf);let Hb=this.pj.ycd(this.mf.InstanceId);this.title&&Hb||this.pj.XDg(this.Nmc);this.title&&this.GJe();this.raiseEvent("AgavePaneReadyKey");V.a.Ad(this.$)&&(""!==this.Tk&&e.a.hf(10),this.BH(),O.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&V.a.Ad(this.$)&&ea.HelperMethods.iw(this.mf)&&this.mf.Preload&&!this.mf.TaskpaneVisible?
this.A3b():this.O5())}A3b(){this.Y6.A3b(this.tW,this.GB)}O5(){this.Y6.O5(this.tW,this.GB)}dispose(){var Hb,Nc;this.lJf||(null===(Nc=null===(Hb=this.mf)||void 0===Hb?void 0:Hb.PrimaryMarketplace)||void 0===Nc?void 0:Nc.SolutionId)!==X.a||this.Flf(!0);x.a.instance.Ba(B.a.click,this.Hna,this.nla);z.KeyInputManager.instance.Bv(this.Hna,this.Ahc);V.a.Ad(this.$)||z.KeyInputManager.instance.Ba(B.a.Kb,this.Hna,this.onCloseButtonTabKeyDown);this.pj&&(this.pj.kaj(this.Nmc),this.pj.iaj(this.Hzf),this.pj.haj(this.Gzf),
this.$&&(this.$.zD(this.onResize),this.$=null));this.$=this.mf=null;super.dispose()}BH(){this.domElement.classList.add(Y);this.mf&&this.oag()}dR(Hb){Hb||this.bWd()}ig(Hb){if(this.mf){const Nc=this.mf.TaskpaneVisible!==Hb;this.mf.TaskpaneVisible=Hb;V.a.Ad(this.$)?Hb||this.Y6.hideTaskPane(this.tW):this.Y6.Pw();ea.HelperMethods.iw(this.mf)&&Nc&&this.pj.pAh(this.instanceId,Hb)}}lp(){let Hb=!1;this.mf&&this.$.Bd&8388608&&(Hb=this.mf.TaskpaneVisible);return Hb}Zr(){return!this.mf||OSF.OsfControl.isFirstPartyStoreString(this.mf.PrimaryMarketplace.MarketplaceType)||
this.$.p9?ea.HelperMethods.iw(this.mf)?this.mf.TaskpaneVisible:!!this.mf:!1}hg(Hb,Nc){return Nc?!1:(this.bWd(),this.pj.Sh.notifyAgave(this.mf.InstanceId,Hb?OSF.AgaveHostAction.TabIn:OSF.AgaveHostAction.TabInShift),!0)}kh(Hb){return qa.DOMElementExtensions.vf(this.mc,Hb)}lj(){}Nj(){}mQ(Hb,Nc){var Db=Nc.querySelectorAll(qa.DOMElementExtensions.qr);Nc=qa.DOMElementExtensions.Kl(Db);Db=qa.DOMElementExtensions.fz(Db);let Cc=!1;Nc===Hb.Cb&&Hb.Ca.shiftKey?((Hb=document.getElementById(this.$.Bb+D.a.Vkc))&&
qa.DOMElementExtensions.isVisible(Hb)?qa.DOMElementExtensions.setFocus(Hb):this.hg(!1,!1),Cc=!0):Db!==Hb.Cb||Hb.Ca.shiftKey||(this.SYf(),Cc=!0);return Cc}SYf(){this.Hna&&qa.DOMElementExtensions.setFocus(this.Hna)}z4g(){const Hb=document.createElement("a");Hb.tabIndex=0;Hb.id="AgaveTaskpaneCloseButtonId";Hb.className=D.a.Idb+(A.AFrameworkApplication.isRtl?D.a.V$:D.a.W$);Hb.title=R.a.instance.ga(10);Hb.setAttribute(I.a.Kd,I.a.Ms);Hb.style.borderColor="transparent";O.EwaSettings.isChangeGateEnabled("OfficeVSO:4186654_RemoveAgaveTaskpaneCloseBottomMargin")?
Hb.style.margin="6px 6px 0px 6px":Hb.style.margin="6px";Hb.style.zIndex="2";Hb.style.position="relative";const Nc=document.createElement("span");Nc.className="StandardButtonImage clip16x16 StandardButtonImageNoText";Nc.id=Hb.id+"-close";const Db=Pa.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","",!0,R.a.instance.ga(798));Nc.appendChild(Db);Hb.appendChild(Nc);return Hb}GJe(){this.sra.innerText=this.title;this.sra.style.textOverflow="ellipsis";this.sra.style.whiteSpace="nowrap";this.sra.style.overflowX=
"hidden";this.mf.TaskpaneTitleCssClass&&(this.sra.className=this.sra.className+" "+this.mf.TaskpaneTitleCssClass);O.EwaSettings.ma(421)&&(this.YYb.className=this.YYb.className+" "+this.mf.TaskpaneHeaderCssClass);qa.DOMElementExtensions.setVisible(this.sra,!0);this.button&&(this.button.JZa.title=this.title);this.q7c();this.h9f=!0}oag(){if(O.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")){if(this.Tk&&!V.a.Ad(this.$)){if(this.button){var Hb=e.a.hf(10),Nc=this.button.ul;
Nc.setAttribute("src",Hb);Nc.setAttribute("class",this.Tk)}return}}else if(this.Tk){this.button&&(Hb=e.a.hf(10),Nc=this.button.ul,Nc.setAttribute("src",Hb),Nc.setAttribute("class",this.Tk));return}if(Hb=O.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")?this.mf.TaskpaneIconUrl?this.mf.TaskpaneIconUrl:this.pj.ycd(this.mf.InstanceId):this.pj.ycd(this.mf.InstanceId))this.$.gka&&this.mf.PrimaryMarketplace&&this.mf.PrimaryMarketplace.SolutionId===J.a.solutionId&&(Hb=this.fPh(Hb)),
V.a.Ad(this.$)?this.P6d=Hb:(Nc=this.button.ul,Nc.setAttribute("src",Hb),Nc.setAttribute("onerror","this.onerror = null;this.src = '"+e.a.current.Rn(102)+"';")),this.jjd=!0}fPh(Hb){const Nc=J.a.s0e(this.$),Db=J.a.m3a(this.$),Cc=J.a.vvb(this.$),Xc=J.a.Z_e(this.$),ld=this.mf.SrcLocationOverrideResourceId,Dd=V.a.Ad(this.$);return ld===Nc?Dd?Hb.replace("/icon-32.png","/record-tp-20.png"):Hb.replace("/icon-32.png","/record-tp-32.png"):ld===Db?Dd?Hb.replace("/icon-32.png","/code-tp-20.png"):Hb.replace("/icon-32.png",
"/code-tp-32.png"):ld===Cc?Dd?Hb.replace("/icon-32.png","/rfb-tp-20.png"):Hb.replace("/icon-32.png","/rfb-tp-32.png"):ld===Xc?Dd?Hb.replace("/icon-32.png","/flowconnector-tp-20.png"):Hb.replace("/icon-32.png","/flowconnector-tp-32.png"):Hb}q7c(){this.$&&!O.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&(this.zFa.style.height=ea.HelperMethods.pc(this.Y6.oO.offsetHeight-this.YYb.offsetHeight))}bWd(){this.pj.oxd(this)}Flf(Hb){Hb={["PaneClosedTime"]:Date.now(),["IsSessionEnded"]:Hb.toString()};
const Nc=new Ra.a(Ga.a.Sk());Nc.add("PaneClosedTime",3);Nc.add("IsSessionEnded",1);F.a.sendTelemetryEvent(Object(w.a)(new Z.a,{name:"Office.Excel.Online.Protection.TaskPaneClosed",dataFields:U.a.Uj(Hb,Nc)}));this.lJf=!0}}Object(c.a)(ja,"AgaveTaskPane",S.a,[102,382,401,402]);class ca extends m.a{constructor(Hb){super();this.TBd=[];this.WDf=null;this.htf=Nc=>{this.qb(Object(l.a)(382,Nc))};this.$=Hb;this.Fb()}create(){n.TaskExtensions.Aa(v.a(this.$),Hb=>{Hb=new ja(document.createElement("div"),this.$,
Hb.result);this.TBd.push(Hb);Hb.nDg(this.htf);this.Qa.raiseEvent(m.a.QWc,null,Hb)},this.la,3)}dispose(){for(const Hb of this.TBd)Hb.I$i(this.htf);k.a.qc(this.TBd);k.a.Ia(this.WDf);this.$=this.WDf=null;super.dispose()}}Object(c.a)(ca,"AgaveTaskPaneFactory",m.a,[]);var aa=a(83),ta=a(258),xa=a(353),ia=a(554),ya=a(18),ib=a(16);class wa extends Sys.EventArgs{constructor(Hb,Nc,Db){super();this.vzb=Db}}Object(c.a)(wa,"TaskPaneVisibilityChangedEventArgs",Sys.EventArgs,[]);var sa=a(44),Ya=a(38),bb=a(235);
const mb=H.a.Aph,Ca=H.a.Cph,$a=`<span class='${Ba.a.x1b} ${H.a.Dph} {3}'><img class='{1}' alt='{0}' src='{2}' {4}/></span>`;class Kb extends bb.a{constructor(Hb){super(document.createElement("a"));this.Qa=new Ya.a;this.Uge=null;this.ed=()=>{this.enabled&&this.Qa.raiseEvent("tpButtonClicked",null,this);return!0};this.rtl=Hb}ADg(Hb){this.Qa.addHandler("tpButtonClicked",Hb)}lPf(Hb){this.Qa.removeHandler("tpButtonClicked",Hb)}get JZa(){return this.domElement}get taskPane(){return this.Uge}get enabled(){return super.enabled}set enabled(Hb){Hb!==
super.enabled&&(this.domElement.classList.toggle(H.a.KT),this.domElement.classList.toggle(Ca),this.domElement.tabIndex=Hb?0:-1,super.enabled=Hb)}get ul(){return this.domElement.firstChild.firstChild}dispose(){k.a.qc([this.Qa]);this.Qa=null;this.domElement&&sa.a.jma(this.domElement);super.dispose()}qai(Hb){const Nc=6===Hb.Yg,Db=Nc&&!Hb.Tk;this.domElement.innerHTML=String.format($a,Hb.RM,Hb.Tk,Db?e.a.current.Rn(102):e.a.hf(10),H.a.Aha,Db?String.format('style="width:24px;{0}:0px"',this.rtl?"right":"left"):
"");this.domElement.classList.add(mb);this.domElement.classList.add(Ca);this.domElement.title=Hb.RM;this.domElement.tabIndex=0;qa.DOMElementExtensions.nu(this.domElement,D.a.Ms,null,null);this.Uge=Hb;Nc&&this.taskPane.BH();x.a.instance.ra(B.a.click,this.domElement,this.ed);z.KeyInputManager.instance.ms(this.domElement,this.ed,u.a.$h)}}Object(c.a)(Kb,"TaskPaneButton",bb.a,[469]);class rb extends S.a{constructor(Hb,Nc,Db){super(Hb);this.animationManager=this.P4=this.ye=null;this.cJ=this.qUa=!1;this.o3d=
0;this.jb=null;this.MJc=!1;this.Gz=()=>{this.zhi||(this.Pw(),this.$.qf())};this.vyd=(Cc,Xc)=>{this.onButtonClick(Cc,Xc)};this.q5=()=>{this.ANb()};r.ULS.sendTraceTag(523379010,9,50,"NovDeprecation: NovToolbarControl");this.$=Nc;ta.a(this.$).Xh(this);this.$.zb.Pf(this.q5);this.configuration=Db;this.baseName=ea.HelperMethods.QY(this.domElement,this.configuration.iUd||this.configuration.tW);this.U7b={};this.Kdb=[];this.Jt=[];this.Cob={};this.Vge=document.getElementById(this.baseName+this.configuration.vyc);
this.oO||r.ULS.sendTraceTag(537151132,0,15,`NovToolbarControl.NovToolbarControl: Element id=${this.baseName+this.configuration.vyc} not found`);this.Iwg=document.getElementById(this.baseName+this.configuration.tW);this.Av||r.ULS.sendTraceTag(537151131,0,15,`NovToolbarControl.NovToolbarControl: Element id=${this.baseName+this.configuration.tW} not found`);this.Jwg=document.getElementById(this.baseName+this.configuration.izc);this.mL||r.ULS.sendTraceTag(537151130,0,15,`NovToolbarControl.NovToolbarControl: Element id=${this.baseName+
this.configuration.izc} not found`);this.mL.innerHTML=String.format(rb.CHj,this.baseName+this.configuration.lVd,this.baseName+rb.qMb);this.E1d=document.getElementById(this.baseName+rb.qMb);this.OXc||r.ULS.sendTraceTag(537151129,0,15,`NovToolbarControl.NovToolbarControl: Element id=${this.baseName+rb.qMb} not found`);(this.Bob=document.getElementById(this.baseName+rb.qMb))||r.ULS.sendTraceTag(537151128,0,15,`NovToolbarControl.NovToolbarControl: Element id=${this.baseName+rb.qMb} not found`);this.cmg=
this.H2c(this.configuration.$_c,this.Y_c);this.bmg=rb.eCe(this.configuration.Z_c,R.a.instance.ga(1299),this.L_h,this.DGa,!0);this.Wng=this.H2c(this.configuration.s9c,this.lQe);this.Vng=rb.eCe(this.configuration.p9c,R.a.instance.ga(1298),this.M_h,this.iia,!1);qa.DOMElementExtensions.setVisible(this.iia,!1);x.a.instance.ra(B.a.click,this.A_a,Object(aa.a)(this,this.BDb,"onCollapseIconClicked"));x.a.instance.ra(B.a.click,this.FIa,Object(aa.a)(this,this.MDb,"onExpandIconClicked"));x.a.instance.ra(B.a.click,
this.DGa,Object(aa.a)(this,this.BDb,"onCollapseIconClicked"));x.a.instance.ra(B.a.click,this.iia,Object(aa.a)(this,this.MDb,"onExpandIconClicked"));z.KeyInputManager.instance.ra(B.a.Kb,this.A_a,Object(aa.a)(this,this.Iyd,"onCollapseIconKeyDown"));z.KeyInputManager.instance.ra(B.a.Kb,this.FIa,Object(aa.a)(this,this.czd,"onExpandIconKeyDown"))}mE(Hb){this.addHandler(rb.GTa,Hb);Hb(this,new wa(this.isVisible,qa.DOMElementExtensions.isVisible(this.mL),this.vzb))}SF(Hb){this.removeHandler(rb.GTa,Hb)}get mL(){return this.Jwg}get mc(){return this.mL}get kf(){return this.qUa}set kf(Hb){this.qUa=
Hb}get Av(){return this.Iwg}get $d(){return W.a.FDi}get oO(){return this.Vge}get $z(){return this.Jt}get Bg(){return this.ye}get qM(){return null}get $fa(){return null}get isCollapsed(){return this.cJ}get l4b(){return this.o3d}get $(){return this.jb}set $(Hb){this.jb=Hb}get OXc(){return this.E1d}get A_a(){return this.bmg}get FIa(){return this.Vng}get DGa(){return this.cmg}get iia(){return this.Wng}get zhi(){return this.MJc}get M_h(){return this.$.Ml&&this.$.isChromeRtl?this.configuration.K7b:this.configuration.J1b}get L_h(){return this.$.Ml&&
this.$.isChromeRtl?this.configuration.J1b:this.configuration.K7b}Cqb(Hb,Nc,Db,Cc,Xc){let ld=Hb.za(Nc);ld||(ld=ib.a(ya.a,Db,Hb,Nc),ld.SetScriptLoadFlavor(Xc));Cc&&ld.ITc(Cc);const Dd=""+Nc;Dd in this.U7b||ld.FYb((Nd,he)=>{this.z5(he)});let Od=null;const Qd=()=>{ld.create();Od()};this.U7b[Dd]=Od=()=>{ld.rrc(Qd);delete this.U7b[Dd]};ld.gYb(Qd)}dispose(){if(this.Jt)for(let Nc=0,Db=this.Jt.length;Nc<Db;Nc++)this.Jt[Nc].lPf(this.vyd),this.Jt[Nc].dispose();const Hb=this.U7b;for(let Nc in Hb)({key:Nc,value:Hb[Nc]}).value();
this.$.ea&&this.$.zb&&this.$.zb.zg(this.q5);this.Bob=this.E1d=this.Vge=this.ye=this.Cob=this.Kdb=this.Jt=null;x.a.instance.Ba(B.a.click,this.A_a,Object(aa.a)(this,this.BDb,"onCollapseIconClicked"));x.a.instance.Ba(B.a.click,this.FIa,Object(aa.a)(this,this.MDb,"onExpandIconClicked"));x.a.instance.Ba(B.a.click,this.DGa,Object(aa.a)(this,this.BDb,"onCollapseIconClicked"));x.a.instance.Ba(B.a.click,this.iia,Object(aa.a)(this,this.MDb,"onExpandIconClicked"));z.KeyInputManager.instance.Ba(B.a.Kb,this.A_a,
Object(aa.a)(this,this.Iyd,"onCollapseIconKeyDown"));z.KeyInputManager.instance.Ba(B.a.Kb,this.FIa,Object(aa.a)(this,this.czd,"onExpandIconKeyDown"));super.dispose()}hg(Hb,Nc){if(Nc)return!1;this.ye&&!this.isCollapsed?(Hb=this.Bg.taskPane,Hb.kf&&Hb.hg(!0,!1)||qa.DOMElementExtensions.setFocus(this.Bg.JZa)):qa.DOMElementExtensions.setFocus(this.FIa);return!0}kh(Hb){return this.isVisible?qa.DOMElementExtensions.vf(this.domElement,Hb)||qa.DOMElementExtensions.vf(this.domElement,qa.DOMElementExtensions.Uub(Hb)):
!1}lj(){}Nj(){this.ye&&this.ye.taskPane.Nj()}setFocusOnToolbarFirstElement(){this.isCollapsed?qa.DOMElementExtensions.setFocus(this.FIa):qa.DOMElementExtensions.setFocus(this.A_a)}NNd(){for(let Hb=this.Jt.length-1;0<=Hb;Hb--)if(this.Jt[Hb].isVisible){qa.DOMElementExtensions.setFocus(this.Jt[Hb].JZa);return}this.setFocusOnToolbarFirstElement()}Jvb(Hb){const Nc=[];for(let Db=this.Jt.length-1;0<=Db;Db--)this.Jt[Db].taskPane.Yg===Hb&&Nc.push(this.Jt[Db].taskPane);return Nc}Qbd(Hb){const Nc=[];for(let Db=
0;Db<this.Jt.length;Db++)this.Jt[Db].taskPane.Yg===Hb&&Nc.push(this.Jt[Db]);return Nc}ple(Hb){if(Hb){let Nc;const Db=Object(l.a)(382,Hb);Db?(Nc=new Kb(this.$.Ml&&this.$.isChromeRtl),Nc.domElement.id=this.baseName+"bt_"+Hb.Yg.toString()+"_"+Hb.mf.InstanceId,this.Bob.appendChild(Nc.domElement),this.Cob["6"]=Nc,Db.button=Nc):Nc=this.Cob[Hb.Yg.toString()];Nc.qai(Hb);Nc.ADg(this.vyd);Nc.isVisible=Hb.lp();Nc.enabled=Hb.Zr();this.Kdb.push(Hb);this.Jt.push(Nc);this.$.Ml&&Hb.BH();rb.KAi(Hb,this.oO);this.Dkh(Nc);
this.ANb()}}VF(Hb,Nc){let Db;for(const Cc of this.Jt)Db=Cc.taskPane,Db.Yg===Hb.Yg&&Db==Hb&&this.S0b(Cc,Nc)}rua(){r.ULS.shipAssertTag(537151124,11,!1,"NovToolbarControl.GenerateTaskPaneData: should only be used with WAC infra.");return null}O5(){r.ULS.shipAssertTag(537151123,11,!1,"NovToolbarControl.ShowTaskPane: should only be used with WAC infra.")}A3b(){r.ULS.shipAssertTag(528023624,11,!1,"NovToolbarControl.createTaskPaneInHidden: should only be used with WAC infra.")}updateTaskPane(){r.ULS.shipAssertTag(537151122,
11,!1,"NovToolbarControl.UpdateTaskPane: should only be used with WAC infra.")}setSelectedTaskPane(){r.ULS.shipAssertTag(537151121,11,!1,"NovToolbarControl.SetSelectedTaskPane: should only be used with WAC infra.")}hideTaskPane(){r.ULS.shipAssertTag(537151120,11,!1,"NovToolbarControl.HideTaskPane: should only be used with WAC infra.")}R2f(Hb,Nc){Hb?(this.MJc=!0,this.sKb(!1)):(this.MJc=!1,this.sKb(!0),Nc&&(this.Pw(),this.$.qf()))}uQ(Hb){if(!this.Kdb.includes(Hb)){let Db=null;Db=()=>{this.s$i(Hb);Hb.qR(Db)};
Hb.dP(Db);this.ple(Hb);var Nc=Object(l.a)(457,Hb);Nc&&(Nc.mE(this.Gz),this.Gz(Nc,Sys.EventArgs.Empty));if(Nc=Object(l.a)(138,Hb))Nc.mE(this.Gz),this.Gz(Nc,Sys.EventArgs.Empty);if(Nc=Object(l.a)(458,Hb))Nc.mE(this.Gz),this.Gz(Nc,Sys.EventArgs.Empty);this.$.Ml&&Hb.BH();this.raiseEvent(rb.YEf,null,Hb);this.Pw()}}S0b(Hb,Nc){if(Hb.taskPane.Zr()&&Hb.taskPane.lp()){if(this.ye){this.ye.domElement.classList.remove(rb.Olb);this.ye.taskPane.isVisible=!1;if(O.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Db=
Object(l.a)(382,this.ye.taskPane);Db&&Db.pj.UHd(Db.mf.InstanceId)}this.P4=this.ye}this.ye=Hb;this.ye.taskPane.isVisible=!0;this.ye.domElement.classList.add(rb.Olb);Nc&&this.QJ(!1,!1);this.Veb()}}onButtonClick(Hb){let Nc=!1;if(this.ye!==Hb){Nc=!0;const Db=Hb.taskPane.mc;this.animationManager.a_i(Db);if(this.ye){if(O.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Cc=Object(l.a)(382,this.ye.taskPane);Cc&&Cc.pj.UHd(Cc.mf.InstanceId)}this.ye.taskPane.isVisible=!1;this.ye.domElement.classList.remove(rb.Olb)}this.P4=
this.ye;this.ye=Hb;this.ye.domElement.classList.add(rb.Olb);this.ye.taskPane.isVisible=!0;this.Veb();this.animationManager.xwh(Db)}this.QJ(!(this.isCollapsed||Nc),!1)}Veb(){const Hb=this.l4b;let Nc=0;this.ye&&(Nc=this.ye.taskPane.su?this.ye.taskPane.su:this.ye.taskPane.wo);if(Nc!==Hb){this.o3d=Nc;const Db=this.$.Ml?xa.a.QBd+xa.a.m1c:0;this.isCollapsed||(this.animationManager&&this.ye?this.animationManager.anb(this.Av,Hb+Db,Nc+Db,this.Bg.taskPane):this.Av.style.width=ea.HelperMethods.pc(Nc+Db));this.tza();
this.raiseEvent(rb.g4f,null,this)}}EE(Hb){const Nc=new Kb(this.$.Ml&&this.$.isChromeRtl);Nc.isVisible=!1;Nc.domElement.id=this.baseName+"bt_"+Hb.toString();this.Bob.appendChild(Nc.domElement);this.Cob[Hb.toString()]=Nc}ANb(){if(void 0!==this.Jt&&null!==this.Jt){void 0===this.ye||null===this.ye||this.ye.taskPane.Zr()||(this.ye.domElement.classList.remove(rb.Olb),this.ye.taskPane.isVisible=!1,this.ye.taskPane.lp()&&(this.P4=this.ye),this.ye=null);var Hb=null;for(let Nc=0;Nc<this.Jt.length;Nc++)if(this.Kdb[Nc].lp()){const Db=
this.Kdb[Nc].Zr();(this.Jt[Nc].enabled=Db)&&!Hb&&(Hb=this.Jt[Nc])}void 0!==this.ye&&null!==this.ye||!Hb||(void 0!==this.P4&&null!==this.P4&&this.P4.taskPane.Zr()&&this.P4.taskPane.lp()?this.S0b(this.P4,!1):this.S0b(Hb,!1));void 0!==ia.a(this.$)&&null!==ia.a(this.$)&&ia.a(this.$).isVisible&&void 0!==this.ye&&null!==this.ye&&1!==this.ye.taskPane.Yg&&(ia.a(this.$).isVisible=!1);void 0!==this.ye&&null!==this.ye&&7!==this.ye.taskPane.Yg&&(Hb=this.$.da.za(52),null===Hb||void 0===Hb?0:Hb.isVisible)&&(Hb.isVisible=
!1);void 0!==this.ye&&null!==this.ye&&8!==this.ye.taskPane.Yg&&(Hb=this.$.da.za(233))&&(Hb.isVisible=!1);void 0!==this.ye&&null!==this.ye&&9!==this.ye.taskPane.Yg&&(Hb=this.$.da.za(248))&&(Hb.isVisible=!1);O.EwaSettings.ma(296)&&void 0!==this.ye&&null!==this.ye&&12!==this.ye.taskPane.Yg&&(Hb=this.$.da.za(302))&&(Hb.isVisible=!1);O.EwaSettings.ma(480)&&void 0!==this.ye&&null!==this.ye&&15!==this.ye.taskPane.Yg&&(Hb=this.$.da.za(365))&&(Hb.isVisible=!1);V.a.xqd(this.$)&&void 0!==this.ye&&null!==this.ye&&
13!==this.ye.taskPane.Yg&&(Hb=this.$.da.za(334))&&(Hb.isVisible=!1);void 0!==this.ye&&null!==this.ye&&14!==this.ye.taskPane.Yg&&(Hb=this.$.da.za(346))&&(Hb.isVisible=!1);void 0!==this.ye&&null!==this.ye&&16!==this.ye.taskPane.Yg&&(Hb=this.$.da.za(371))&&(Hb.isVisible=!1);O.EwaSettings.pgc()&&void 0!==this.ye&&null!==this.ye&&17!==this.ye.taskPane.Yg&&(Hb=this.$.da.za(408))&&(Hb.isVisible=!1);O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)&&void 0!==this.ye&&
null!==this.ye&&18!==this.ye.taskPane.Yg&&(Hb=this.$.da.za(415))&&(Hb.isVisible=!1);this.Veb()}}BRe(Hb,Nc){qa.DOMElementExtensions.setVisible(this.DGa,!Hb);qa.DOMElementExtensions.setVisible(this.iia,Hb);Hb&&this.raiseEvent(rb.Zye,null,this);this.Veb();Nc&&qa.DOMElementExtensions.setFocus(Hb?this.FIa:this.A_a)}lva(Hb,Nc){this.$.ud(Hb,Nc,26,null)}z5(Hb){Hb.bO&&this.uQ(Hb.bO)}s$i(Hb){if(Hb){const Nc=this.Jt.length;let Db=!1;for(let Cc=0;Cc<Nc;Cc++){const Xc=this.Jt[Cc];if(Xc.taskPane===Hb){this.Bob.removeChild(Xc.JZa);
delete this.Cob[Hb.Yg.toString()];Array.remove(this.Kdb,Hb);Array.remove(this.Jt,Xc);Xc.lPf(this.vyd);Xc.taskPane.mc.parentNode.removeChild(Xc.taskPane.mc);this.ye&&this.ye.taskPane===Xc.taskPane&&(this.ye=null);this.P4&&this.P4.taskPane===Xc.taskPane&&(this.P4=null);Db=!0;break}}Db&&this.ANb()}}Dkh(Hb){const Nc=Hb.taskPane.Yg,Db=this.$.Ml,Cc=!!this.ye&&1===this.ye.taskPane.Yg;(Db&&0===Nc||!Db&&(1===Nc||!Cc&&2===Nc))&&this.S0b(Hb,!1)}static KAi(Hb,Nc){const Db=Hb.mc;Db.parentNode&&Db.parentNode.removeChild(Db);
Nc.appendChild(Db);Hb.isVisible=!1}static eCe(Hb,Nc,Db,Cc,Xc){const ld=document.createElement("a");ld.setAttribute(D.a.LX,Xc?D.a.lk:D.a.fr);ld.setAttribute(D.a.Kd,D.a.Ms);ld.tabIndex=0;ld.classList.add(Ba.a.PA);ld.classList.add(Hb);ld.classList.add(H.a.zph);ld.innerHTML=String.format(rb.LWg,Nc,Db,e.a.hf(10));Cc.appendChild(ld);return ld}}rb.GTa="tpVisibility";rb.CHj=`<div id='{0}' class='${H.a.Fph}'><div id='{1}' class='${H.a.Eph}'></div></div>`;rb.LWg="<img title='{0}' class='{1}' alt='{0}' src='{2}'/>";
rb.qMb="novTaskpaneButtonGroup";rb.Olb=H.a.Bph;rb.g4f="tpSizeChanged";rb.Zye="tpCollapsed";rb.YEf="tpAdded";Object(c.a)(rb,"NovToolbarControl",S.a,[459,102,2]);var cc=a(525),nc=a(104),Wb=a(514);class Ea{constructor(){this.K7b=this.J1b=this.p9c=this.Z_c=this.s9c=this.$_c=this.lVd=this.izc=this.vyc=this.tW=this.iUd=null}}Object(c.a)(Ea,"Configuration",null,[]);class ua extends rb{constructor(Hb,Nc){super(Hb,Nc,ua.l2c());this.afb=!1;this.Li=()=>{this.ayd()};this.Omc=Db=>{r.ULS.sendTraceTag(521405900,
9,50,"NovDeprecation: onPaneSectionKeyDown");var Cc=!1;if(9===Db.Ca.keyCode){var Xc=this.domElement.querySelectorAll(xa.a.ZEf);Cc=qa.DOMElementExtensions.Kl(Xc);Xc=qa.DOMElementExtensions.fz(Xc);Cc=qa.DOMElementExtensions.Sma(Db.Ca,Cc,Xc)}else 27===Db.Ca.keyCode&&this.Bg.taskPane.ig(!1);return Cc};r.ULS.sendTraceTag(523379012,9,50,"NovDeprecation: NovActionToolbarControl");z.KeyInputManager.instance.ra(B.a.Kb,this.domElement,this.Omc)}get kf(){return!0}set kf(Hb){super.kf=Hb}get $d(){return W.a.BDi}get vzb(){return this.$.isChromeRtl}get Y_c(){return this.Av}get lQe(){return this.mL}initialize(){this.EE(3);
this.EE(4);this.EE(5);this.Pw()}dispose(){z.KeyInputManager.instance.Ba(B.a.Kb,this.domElement,this.Omc);super.dispose()}Pw(){let Hb=0;const Nc=this.$z;for(let Db=Nc.length-1;0<=Db;Db--){const Cc=Nc[Db].taskPane.lp();(Nc[Db].isVisible=Cc)&&Hb++}this.sKb(0<Hb);qa.DOMElementExtensions.setVisible(this.OXc,1<Hb);this.ANb()}LJd(){}ayd(){oa.g(this.$).Ea.sv(this.Li);Wb.a(this.$).Ea.sv(this.Li);nc.a(this.$);this.Bg&&3===this.Bg.taskPane.Yg?this.$.MT.Ea.kZ()&&this.QJ(!0,!1):this.afb||this.QJ(!1,!1)}QJ(Hb,
Nc){if(this.isCollapsed!==Hb){var Db=this.l4b+xa.a.QBd+xa.a.m1c;this.cJ=!this.isCollapsed;this.animationManager.anb(this.Av,Hb?Db:0,Hb?0:Db,this.Bg.taskPane);this.animationManager.UIg(this.iia,Hb);this.BRe(Hb,Nc)}}sKb(Hb){const Nc=this.isVisible!==Hb;qa.DOMElementExtensions.setVisible(this.Av,Hb);Nc&&this.raiseEvent(rb.GTa,new wa(Hb,Hb,!this.vzb),this)}onButtonClick(Hb,Nc){super.onButtonClick(Hb,Nc);this.afb=this.isCollapsed}BDb(Hb){if(Hb.Cb===this.DGa&&3!==Hb.tb)return!1;this.lva(329273335,Hb.tb);
this.QJ(!0,!0);return this.afb=!0}MDb(Hb){if(Hb.Cb===this.iia&&3!==Hb.tb)return!1;this.lva(1962240939,Hb.tb);this.QJ(!1,!0);this.afb=!1;return!0}Iyd(Hb){return 13===Hb.Ca.keyCode?(this.lva(329273335,Hb.tb),this.QJ(!0,!0),this.afb=!0):!1}czd(Hb){return 13===Hb.Ca.keyCode?(this.lva(1962240939,Hb.tb),this.QJ(!1,!0),this.afb=!1,!0):!1}tza(){}H2c(Hb,Nc){const Db=document.createElement("div");Db.classList.add(Hb);Nc.appendChild(Db);return Db}static ka(Hb){var Nc=Hb.da.za(51);if(!Nc){const Db=cc.a(Hb.domElement);
Db&&(r.ULS.sendTraceTag(523379011,9,50,"NovDeprecation: NovActionToolbarControl attach"),Nc=document.getElementById(ea.HelperMethods.QY(Db,D.a.$Cb)+D.a.Qrf),Nc=Hb.da.Ga(51,new ua(Nc,Hb)))}return Nc}static l2c(){const Hb=new Ea;Hb.iUd=D.a.Qrf;Hb.tW=D.a.yDi;Hb.vyc=D.a.xDi;Hb.izc=D.a.ADi;Hb.lVd=D.a.zDi;Hb.$_c=H.a.rph;Hb.s9c=H.a.tph;Hb.Z_c=H.a.qph;Hb.p9c=H.a.sph;Hb.J1b=H.a.WOe;Hb.K7b=H.a.UOe;return Hb}}Object(c.a)(ua,"NovActionToolbarControl",rb,[]);var ma=a(30),fb=a(211),sb=a(61),Ua=a(47),ab=a(45),na=
a(319),Na=a(71),Va=a(22),Sa=a(283),vb=a(280);const Oa=Ba.a.$ph,yb=Ba.a.aqh,Ob=Ba.a.dth,Ja=H.a.FMe,lb=`<div class="${Ba.a.k8c}"><div title="{0}" class="${Ba.a.jqh}">{0}</div></div><div><div class="${Ba.a.cqh}">{1}</div><div class="${Ba.a.gqh} ${Ba.a.Zo}" id="parametersSection">&nbsp;</div><div align="bottom" class="${Ba.a.bqh}"><button class="${Ba.a.DMe} ${Ba.a.Zph}" id="applyButton" type="submit">{2}</button><button class="${Ba.a.DMe}" id="resetButton" type="button">{3}</button></div></div>`,Pb=`<div><div class="${Ba.a.hqh}"><label for="{2}" title="{1}">{0}</label></div><div class="${Ba.a.iqh}"><input type="text" maxlength="255" id="{2}"/></div></div>`;
class Jb extends bb.a{constructor(Hb,Nc,Db){super(Hb);this.lOd=this.PUa=this.m0=null;this.su=0;this.TBf=()=>{this.PUa=null};this.nrj=()=>{k.a.Ia(this.lOd);this.lOd=null;this.isVisible!==this.TPd&&this.raiseEvent("parameterTaskPaneVilibilityChanged")};this.A_g=(Cc,Xc)=>Va.a.compare(Cc.Name,Xc.Name,!0);this.otf=Cc=>{Na.g(Cc);if(!this.Ara.domElement.classList.contains(Ba.a.e7b)){oa.g(this.$).Go(!0);var Xc=[];for(Cc=0;Cc<this.m0.length;Cc++){const Dd=this.PUa[Cc],Od=this.m0[Cc].text;Dd.Values=[Od];Od&&
Xc.push(Dd)}if(Xc.length){var ld=this.$.oa.va.Sb();this.Ara.addCssClass(Ba.a.e7b);this.$.userOperationManager.Ub(new K.a(142,0,(Dd,Od,Qd)=>sb.F(this.$.oa.va,Xc,!1,0,!1,vb.b(Dd,this.TQi),vb.a(Od,this.SQi),Qd,null,ld)),null)}}};this.FPi=Cc=>{Na.g(Cc);Cc=this.m0;for(let Xc=0,ld=Cc.length;Xc<ld;Xc++)Cc[Xc].text=""};this.TQi=()=>{this.Ara.removeCssClass(Ba.a.e7b)};this.SQi=()=>{this.Ara.removeCssClass(Ba.a.e7b)};this.EEb=(Cc,Xc)=>{13===Xc.charCode&&this.otf(Xc)};this.$=Nc;this.taskPaneManager=Db;Hb.innerHTML=
String.format(lb,this.titleText,R.a.instance.ga(1331),R.a.instance.ga(1332),R.a.instance.ga(1333));this.goc=this.getElementById("parametersSection");this.Ara=new na.a(this.getElementById("applyButton"));this.Ara.Gc.ka("click",this.otf);this.aKd=new na.a(this.getElementById("resetButton"));this.aKd.Gc.ka("click",this.FPi);this.$.ea.jk(this.TBf);ta.a(this.$).Xh(this)}dP(Hb){this.get_events().addHandler("RemoveParamTpEventKey",Hb)}qR(Hb){this.get_events().removeHandler("RemoveParamTpEventKey",Hb)}mE(Hb){this.addHandler("parameterTaskPaneVilibilityChanged",
Hb)}SF(Hb){this.removeHandler("parameterTaskPaneVilibilityChanged",Hb)}get A5b(){this.G9e();return this.PUa}get mc(){return this.domElement}get wo(){return 250}get isResizable(){return!1}get kf(){return this.isVisible}get $d(){return W.a.wVi}get Yg(){return 2}get Tk(){return Ob}get RM(){return R.a.instance.ga(1068)}get TPd(){return!!this.A5b&&0<this.A5b.length&&!this.$.isEditMode}get titleText(){return R.a.instance.ga(1330)}get GB(){return this.taskPaneManager.rua(this.mc,this.titleText,this.wo,this.isResizable,
()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1})}BH(){this.domElement.classList.add(this.$.isChromeRtl?yb:Oa);this.style.width=ea.HelperMethods.pc(this.wo);this.domElement.classList.add(Ja)}ig(Hb){V.a.Ad(this.$)&&(Hb?(this.G9e(),this.taskPaneManager.O5("ParametersTaskPane",this.GB)):this.taskPaneManager.hideTaskPane("ParametersTaskPane"))}lp(){return this.TPd}Zr(){return this.TPd}dR(){}dispose(){this.$&&this.$.ea.Ik(this.TBf);this.WOf();k.a.qc([this.Ara,
this.aKd]);this.PUa=this.goc=this.$=this.Ara=this.aKd=null;super.dispose()}hg(Hb,Nc){Nc||(this.m0&&0<this.m0.length?this.m0[0]:this.Ara).focus();return!Nc}kh(Hb){return qa.DOMElementExtensions.vf(this.mc,Hb)}lj(){}Nj(){}mQ(){return!1}G9e(){!this.PUa&&this.$.Bd&2048&&this.NLg(this.$.workbookContext.TaskPaneParameters,this.$.ya.SlicerParameters)}NLg(Hb,Nc){var Db=[];this.WOf();if(!this.$.isEditMode&&Hb&&0<Hb.length){var Cc=this.A_g;if(Nc&&0<Nc.length){var Xc=new fb.a([...Nc]);Xc.s9.sort(Cc)}else Xc=
null;for(let Dd=0,Od=Hb.length;Dd<Od;Dd++){var ld=Hb[Dd];Nc&&!(0>ea.HelperMethods.mx(Xc,0,Xc.$ia(),ld,Cc))||ld.IsPivotPageField||ld.IsSlicer||Db.push(ld)}}this.PUa=Db;if(this.goc&&(this.$.Ml||this.isVisible===0<Db.length||(this.lOd=Ua.a.instance.create(this.nrj,500,ab.a.xVi,!0,!0)),this.goc.innerHTML="",Db.length)){Nc="";Hb=[];for(let Dd=0,Od=Db.length;Dd<Od;Dd++)Cc=this.$.Bb+"param"+Dd,Hb.push(Cc),ld=Db[Dd],Xc=ld.Name?ma.a.Eg(ld.Name):"",ld=ld.Comment?ma.a.$Y(ld.Comment):"",Nc+=String.format(Pb,
Xc,ld,Cc);this.goc.innerHTML=Nc;Nc=[];for(let Dd=0,Od=Db.length;Dd<Od;Dd++)Db=new Sa.a(document.getElementById(Hb[Dd])),Nc.push(Db),Db.YEg(this.EEb);this.m0=Nc}}WOf(){if(this.m0){for(let Hb=0,Nc=this.m0.length;Hb<Nc;Hb++)this.m0[Hb].Zaj(this.EEb);k.a.qc(this.m0);this.m0=null}}static OLg(Hb,Nc){const Db=Hb.da;let Cc=Db.za(17);if(!Cc){const Xc=document.getElementById(Hb.Bb+D.a.yVi);Xc&&(Cc=Db.Ga(17,new Jb(Xc,Hb,Nc)))}return Cc}}Object(c.a)(Jb,"ParametersTaskPane",bb.a,[137,401,102,2]);class Lb extends m.a{constructor(Hb){super();
this.$=Hb;this.Fb()}create(){n.TaskExtensions.Aa(v.a(this.$),Hb=>{this.qb(Jb.OLg(this.$,Hb.result))},this.la,3)}}Object(c.a)(Lb,"ParametersTaskPaneFactory",m.a,[]);var Ab=a(691),nb=a(182),va=a(55);class db{Nc(){return!1}executeCommand(Hb,Nc){Hb=Nc.command;switch(Hb){case 329273335:case 1962240939:case 296943390:case -625072140:return va.Task.Ta(!0);default:return nb.a(Hb)}}Cc(Hb,Nc,Db,Cc){if(Hb=!!Cc&&2===Cc.Sy)switch(Nc.command){case 329273335:case 1962240939:case 296943390:case -625072140:break;
default:Hb=!1}return Hb}Rc(){return!1}}Object(c.a)(db,"TaskPaneCommandHandler",null,[195]);class Xa extends Ab.a{constructor(Hb){super(Hb)}yd(){this.gd([new db])}static ka(Hb){Ab.a.Nd(115,new Xa(Hb))}}Object(c.a)(Xa,"TaskPaneCommandHandlerFactory",Ab.a,[]);var gb=a(1311),Ha=a(174);class tb{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=
this.middleContainer=null}}Object(c.a)(tb,"TaskPaneGroupAppProps",null,[]);var bc=a(27),tc=a(213);class Ma{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(c.a)(Ma,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var Tb=a(289),zb=a(127);class ic{constructor(Hb){this.width=Hb}}Object(c.a)(ic,"ActiveTaskPaneData",null,[]);class Qb extends Ya.a{constructor(Hb,Nc){super();this.isVisible=!1;this.jUd=this.Ida=-1;this.RFe=
40;this.Bg=this.mL=this.animationManager=this.MFc=null;this.ozd=()=>{this.xSf()};this.Ayc=new Set;this.Ayc.add("FieldListTaskPane");this.Ayc.add("PivotTableSettingsTaskPane");this.Ayc.add("SlicerSettingsTaskPane");this.jb=Nc;ta.a(this.$).Xh(this);this.Av=Hb;this.s8a=this.rQg();V.a.vj()||A.AFrameworkApplication.ta.Oa.$e||(this.Av.style.bottom=this.$.Ml?"":this.$.Bd&4?ea.HelperMethods.pc(this.$.Cda):"0");this.V7b={};this.rMb={};this.o0d={};this.fUd=zb.a.instance.Zd(this.mc);this.fUd.ka("focusin",this.ozd);
this.rai()}get $(){return this.jb}get $fa(){return this.o0d}get qM(){return this.MFc}get isCollapsed(){return!this.qM}dispose(){ta.a(this.$).Nz(this);const Hb=this.V7b;for(let Nc in Hb)({key:Nc,value:Hb[Nc]}).value();this.rMb=this.o0d=this.V7b=null;this.fUd.JC();this.s8a=this.Av=this.fUd=null;super.dispose()}rua(Hb,Nc,Db,Cc,Xc,ld,Dd,Od,Qd=Qb.bri,Nd=Qb.ari,he=null,ve=null,Td=!1){const ke=Object(w.a)(new Ma,{getContent:()=>Hb});ke.isSharedRuntime=Td;return Object(w.a)(new gb.a,{hideHeader:!0,contentProps:ke,
title:Nc,width:Db,location:2,onOpen:Xc,onClose:ld,onShow:Dd,onHide:Od,iconUrl:he,iconId:ve,enableResize:Cc,minResizeWidth:Qd,maxResizeWidth:Nd})}O5(Hb,Nc){Ha.UISurfaces.Lj().then(Db=>{Hb in this.$fa?Db.setSelectedTaskPane(Hb):Db.showTaskPane(Hb,Nc);return null})}A3b(Hb,Nc){Ha.UISurfaces.Lj().then(Db=>{Db.initializeHiddenSharedRuntimeTaskPane(Hb,Nc);const Cc=this.$.domElement;Cc.addEventListener("scroll",function ld(){0!=Cc.scrollLeft&&(Cc.scrollLeft=0,Cc.removeEventListener("scroll",ld))})})}updateTaskPane(Hb,
Nc){Ha.UISurfaces.Lj().then(Db=>{Db.updateTaskPane(Hb,Nc);return null})}setSelectedTaskPane(Hb){Ha.UISurfaces.Lj().then(Nc=>{Nc.setSelectedTaskPane(Hb);return null})}hideTaskPane(Hb){Ha.UISurfaces.Lj().then(Nc=>{Nc.hideTaskPane(Hb,Qb.BHj);return null})}get mc(){return this.Av}get kf(){return this.isVisible}get $d(){return W.a.xyc}hg(Hb,Nc){return Nc?!1:(this.uWf(),!0)}kh(Hb){return qa.DOMElementExtensions.vf(this.mc,Hb)}lj(){this.$.frame.Ee.Sj(this.$d)}Nj(){}rQg(){const Hb=document.createElement(tc.a.div);
Hb.style.height="0px";Hb.style.width="0px";Hb.tabIndex=-1;return Hb}pGh(){var Hb=qa.DOMElementExtensions.getElementById(this.Av,"tabStripFocusZone");if(Hb){Hb=Hb.getElementsByTagName("button");for(let Nc=0;Nc<Hb.length;Nc++)if(Boolean.parse(Hb[Nc].getAttribute("aria-selected")))return Hb[Nc].getAttribute("aria-controls")}return null}b0g(Hb){return(Hb=window.getComputedStyle(Hb,null).getPropertyValue("transition-duration"))?parseInt(Hb.endsWith("ms")?parseFloat(Hb):1E3*parseFloat(Hb),10):0}t7i(){const Hb=
document.getElementById("tabbedTaskPaneContainer");Hb&&Hb.addEventListener("transitionend",()=>this.hGa(-1))}rai(){Ha.UISurfaces.Lj().then(Hb=>{let Nc;Hb.renderTaskPaneGroups(null,this.Av,(Nc=new tb,Nc.middleContainer=this.s8a,Nc.onOpen=(Db,Cc)=>{this.isVisible=!0;-1===this.Ida&&(this.Ida=this.b0g(Cc));V.a.vj()||(this.$fa[Db]=new ic(qa.DOMElementExtensions.uP(qa.DOMElementExtensions.getElementById(Cc,Qb.T7f))))},Nc.onClose=Db=>{this.isVisible=0<Hb.selectors.getTabbedTaskPaneCount();r.ULS.sendTraceTag(537014371,
0,50,`Closing of ${Db} TaskPane`);if(!this.isVisible)this.bTe(),V.a.vj()||A.AFrameworkApplication.ta.Oa.$e||window.requestAnimationFrame(()=>{this.TYb(this.s8a)});else if(!V.a.vj()&&this.qM&&this.qM!==Db){const Cc=1<Hb.selectors.getTabbedTaskPaneCount()?this.Sac():0,Xc=1===Hb.selectors.getTabbedTaskPaneCount()?-1*this.Sac():0;this.Ine(Db,this.qM,Cc,Xc)}V.a.vj()?this.hGa(this.Ida):(A.AFrameworkApplication.ta.Oa.$e&&0>=this.Ida&&this.hGa(this.Ida),delete this.$fa[Db]);delete this.rMb[Db]},Nc.onShow=
(Db,Cc)=>{null!=this.Yh&&(this.Yh.stop(),this.Yh=null);this.MFc=Db;this.xSf();1!==Cc&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.rij()},0)});V.a.vj()?window.requestAnimationFrame(()=>{this.hGa(this.Ida)}):A.AFrameworkApplication.ta.Oa.$e&&0>=this.Ida?window.requestAnimationFrame(()=>{this.hGa(this.Ida)}):window.requestAnimationFrame(()=>{this.Rjj(this.s8a,this.Ida)})},Nc.onHide=(Db,Cc,Xc)=>{const ld=this.pGh();ld!==Db&&(this.Yh=this.$.Ib.Bc("UserAction","TaskPaneToggle"),r.ULS.sendTraceTag(537014370,
0,50,`Toggling Pane from ${Db} to ${ld}`));Xc?V.a.vj()||this.TYb(this.s8a):!V.a.vj()&&ld&&(Db=1===Object.keys(this.$fa).length?this.Sac():0,this.Ine(this.qM,ld,this.Sac(),Db));this.MFc=null;Xc&&1!==Cc&&this.bTe();V.a.vj()&&window.requestAnimationFrame(()=>{this.hGa(this.Ida)})},Nc.setFocusCallback=(Db,Cc)=>{Cc&&(this.rMb[Db]=Cc)},Nc.onResizeStart=()=>{V.a.vj()||this.GUc(ea.HelperMethods.pc(0))},Nc.onResizeEnd=()=>{V.a.vj()?this.hGa():(this.TYb(this.s8a),this.$fa[this.qM]=this.Gfd(this.qM));r.ULS.sendTraceTag(537014369,
0,50,`Resizing of ${this.qM} TaskPane`)},Nc));A.AFrameworkApplication.ta.Oa.$e&&!V.a.vj()&&this.t7i();return null})}TYb(Hb){this.GUc(this.$.isChromeRtl?Hb.style.left:Hb.style.right)}GUc(Hb){r.ULS.sendTraceTag(537014368,0,50,`Grid adjust is triggered for taskPane ${this.qM}`);this.$.hfj(Hb)}hGa(Hb=0){-1<Hb?va.Task.delay(Hb+this.RFe).continueWith(()=>{this.$.Tya(Tb.a.NY("ResetContentAreaMargin"))}):this.$.Tya(Tb.a.NY("ResetContentAreaMargin"))}Ine(Hb,Nc,Db,Cc){Nc=Nc.endsWith(Qb.gUd)?Nc.substring(0,
Nc.length-Qb.gUd.length):Nc;Nc=this.X2e(Nc);Cc=Nc+Cc;Hb=this.X2e(Hb);Cc<Hb&&this.GUc(ea.HelperMethods.pc(Nc+Db))}Rjj(Hb,Nc){window.setTimeout(()=>{this.TYb(Hb)},Nc+this.RFe)}Sac(){return-1!==this.jUd?this.jUd:this.jUd=qa.DOMElementExtensions.uP(qa.DOMElementExtensions.getElementById(this.Av,"tabStripFocusZone"))}Gfd(Hb){return qa.DOMElementExtensions.uP(qa.DOMElementExtensions.getElementById(qa.DOMElementExtensions.getElementById(this.Av,Hb+Qb.gUd),Qb.T7f))}X2e(Hb){if(Hb in this.$fa){const Nc=this.$fa[Hb].width;
return 0<Nc?Nc:this.Gfd(Hb)}return Hb?this.Gfd(Hb):0}bTe(){oa.g(this.$).setFocus()}rij(){if(this.rMb[this.qM]){const Hb=this.rMb[this.qM];Hb&&Hb(null,null)}else this.Ayc.has(this.qM)||this.uWf()}uWf(){Ha.UISurfaces.Lj().then(Hb=>{1<Hb.selectors.getTabbedTaskPaneCount()?Hb.focusTabbedTaskPaneArea():(Hb=qa.DOMElementExtensions.getElementById(this.mc,"AgaveTaskpaneCloseButtonId"))?Hb.focus():(Hb=qa.DOMElementExtensions.Kl(this.mc.querySelectorAll("button")))&&Hb.focus();return null})}xSf(){this.$.domElement.scrollLeft=
0;bc.a.cMa&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=0},0)})}mE(Hb){this.addHandler(Qb.GTa,Hb)}SF(Hb){this.removeHandler(Qb.GTa,Hb)}get oO(){return this.Av}get $z(){r.ULS.shipAssertTag(537151112,11,!1,"ReactTaskPaneManager.TaskPaneButtons should not be used with the WAC infra");return null}Cqb(Hb,Nc,Db,Cc,Xc){let ld=Hb.za(Nc);ld||(ld=ib.a(ya.a,Db,Hb,Nc),ld.SetScriptLoadFlavor(Xc));Cc&&ld.ITc(Cc);const Dd=""+Nc;let Od=null;
const Qd=()=>{ld.create();Od()};this.V7b[Dd]=Od=()=>{ld.rrc(Qd);delete this.V7b[Dd]};ld.gYb(Qd)}initialize(){r.ULS.shipAssertTag(537151111,11,!1,"ReactTaskPaneManager.Initialize should not be used with the WAC infra")}R2f(){}uQ(){r.ULS.shipAssertTag(537151110,11,!1,"ReactTaskPaneManager.InsertPane should not be used with the WAC infra")}VF(){r.ULS.shipAssertTag(537151109,11,!1,"ReactTaskPaneManager.SelectPane should not be used with the WAC infra")}ple(){r.ULS.shipAssertTag(537151108,11,!1,"ReactTaskPaneManager.AddTaskPane should not be used with the WAC infra")}LJd(){r.ULS.shipAssertTag(537151107,
11,!1,"ReactTaskPaneManager.RepositionTaskpaneForCurrentMode should not be used with the WAC infra")}Jvb(){r.ULS.shipAssertTag(537151106,11,!1,"ReactTaskPaneManager.GetTaskPane should not be used with the WAC infra");return null}Qbd(){r.ULS.shipAssertTag(537151105,11,!1,"ReactTaskPaneManager.GetButtonsByTaskPaneType should not be used with the WAC infra");return null}QJ(){r.ULS.shipAssertTag(537151104,11,!1,"ReactTaskPaneManager.ExpandOrCollapsePane should not be used with the WAC infra")}Pw(){r.ULS.shipAssertTag(537151075,
11,!1,"ReactTaskPaneManager.UpdateAvailablePanes should not be used with the WAC infra")}ayd(){r.ULS.shipAssertTag(537151071,11,!1,"ReactTaskPaneManager.OnActiveItemSlicersLoaded should not be used with the WAC infra")}setFocusOnToolbarFirstElement(){r.ULS.shipAssertTag(537151070,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarFirstElement should not be used with the WAC infra")}NNd(){r.ULS.shipAssertTag(537151069,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarLastElement should not be used with the WAC infra")}static ka(Hb){const Nc=
Qb.nRg(Hb.Bb,Hb.isChromeRtl);Qb.VLg(Hb,Nc);return new Qb(Nc,Hb)}static nRg(Hb,Nc){const Db=document.createElement("div");Db.id=Hb+D.a.yyc;V.a.vj()?Db.classList.add(Ba.a.sWj):(Db.classList.add(Nc?Ba.a.uWj:Ba.a.tWj),A.AFrameworkApplication.ta.Oa.$e&&Db.classList.add(Ba.a.APa));return Db}static VLg(Hb,Nc){Hb.isMobileMode&&Nc.setAttribute("aria-hidden","true");Hb.Ml?(Hb=ea.HelperMethods.QY(null,D.a.$Cb),Hb=document.getElementById(Hb+D.a.yxd),V.a.vj()&&Nc.classList.add(Ba.a.ALe),Hb.appendChild(Nc)):A.AFrameworkApplication.ta.Oa.$e?
document.getElementById("FarPaneRegion").appendChild(Nc):(V.a.vj()&&Nc.classList.add(Ba.a.ALe),document.getElementById(Hb.Bb+D.a.s_a).insertBefore(Nc,Hb.tAa))}}Qb.bri=300;Qb.ari=950;Qb.BHj=2;Qb.gUd="-panel";Qb.T7f="ExcelTaskPaneContentWrapper";Qb.g4f="rtpSizeChanged";Qb.Zye="rtpCollapsed";Qb.YEf="rtpAdded";Qb.GTa="rtpVisibility";Object(c.a)(Qb,"ReactTaskPaneManager",Ya.a,[459,102,2]);var wb=a(94),hc=a(154),Za=a(236),ub=a(412),uc=a(48),Oc=a(704),Bb=a(426),Nb=a(293);class dc extends Nb.a{constructor(Hb){super(5,
Hb)}}Object(c.a)(dc,"ResizeAnimationEvent",Nb.a,[]);var sc=a(468),yc=a(581),cd=a(101);class pd{constructor(Hb,Nc){this.V7f=null;r.ULS.sendTraceTag(521405899,9,50,"NovDeprecation: TaskPaneAnimationManager");this.$=Nc;this.taskPane=Hb}qwh(){this.V7f=qa.DOMElementExtensions.getElementById(this.taskPane.parentNode,this.$.Bb+D.a.xxd);const Hb=pd.z3b(this.taskPane),Nc=pd.z3b(this.V7f),Db=yc.a(cd.a.sl);Db.animate(Hb,D.a.Bcb);Db.animate(Nc,D.a.Bcb)}UIg(Hb,Nc){const Db=()=>{qa.DOMElementExtensions.setVisible(Hb,
Nc)},Cc=yc.a(cd.a.sl);Nc?Cc.animate(pd.z3b(Hb),D.a.Bcb,null,Db):Cc.animate(pd.n6g(Hb),D.a.Bcb,null,null,Db)}a_i(Hb){Hb.style.opacity="0"}xwh(Hb){yc.a(cd.a.sl).animate(pd.z3b(Hb),D.a.Bcb)}anb(Hb,Nc,Db,Cc){Nc||(Cc.isVisible=!0);this.$.tza(Db);yc.a(cd.a.sl).animate(pd.R8g(Hb,Nc,Db),D.a.Bcb,null,null,()=>{this.$.uza();Db||1===Cc.Yg||(Cc.isVisible=!1);Cc.dR(Db<Nc)})}static n6g(Hb){Hb=new Bb.a(Hb);Hb.PG(1,0);return Hb}static R8g(Hb,Nc,Db){Hb=new dc(Hb);Hb.VIg(Nc,Db);return Hb}static z3b(Hb){Hb=new sc.a(Hb);
Hb.PG(0,1);return Hb}}Object(c.a)(pd,"TaskPaneAnimationManager",null,[435]);const Rb=`<div id="{0}" class="${H.a.Jph}" runat="server"></div></div><div id="{1}" class="${H.a.Iph} ${H.a.Zo}" runat="server"></div>`,Dc=`<button type="button" id="{0}" class="${H.a.Gph}"></button><span><div id="{1}" class="${H.a.Hph}"></div></span>`,nd=H.a.pph;class od extends rb{constructor(Hb,Nc,Db){super(Hb,Db,od.l2c());this.hoc=null;this.Wpd=!1;this.PR=null;this.Omc=Cc=>{var Xc=!1;if(9===Cc.Ca.keyCode){Xc=this.Bg.taskPane.mQ(Cc,
this.mL);if(!Xc){Xc=this.$.da.za(52);var ld=this.domElement.querySelectorAll(this.Bg.taskPane===Xc?Xc.qr:xa.a.ZEf);Xc=qa.DOMElementExtensions.Kl(ld);ld=qa.DOMElementExtensions.fz(ld);Xc=qa.DOMElementExtensions.Sma(Cc.Ca,Xc,ld)}return Xc}ld=wb.FocusManager.instance().ei;if(null===ld||void 0===ld?0:ld.dN)return Xc;27===Cc.Ca.keyCode&&this.Bg.taskPane.ig(!1);return Xc};this.$c=()=>{this.mL.style.bottom=this.Av.style.bottom=this.$.Ml?"":this.$.Bd&4&&!A.AFrameworkApplication.ta.Oa.$e?ea.HelperMethods.pc(this.$.Cda):
"0";this.Pw()};this.OAf=Cc=>{Object(ub.a)(382,this.Bg.taskPane)&&(this.Bg.taskPane.zFa.firstChild.style[D.a.pointerEvents]="none");this.Wpd=!0;this.PR=this.hvb(Cc.clientPoint);hc.a.instance.ra(B.a.Xf,this.domElement.ownerDocument.body,this.cnc);hc.a.instance.ra(B.a.te,this.domElement.ownerDocument.body,this.dnc);Za.a.instance.ra(B.a.zj,this.domElement.ownerDocument.body,this.cnc);Za.a.instance.ra(B.a.Mf,this.domElement.ownerDocument.body,this.dnc);return!0};this.dnc=()=>{Object(ub.a)(382,this.Bg.taskPane)&&
(this.Bg.taskPane.zFa.firstChild.style[D.a.pointerEvents]="");this.Wpd=!1;hc.a.instance.Ba(B.a.Xf,this.domElement.ownerDocument.body,this.cnc);hc.a.instance.Ba(B.a.te,this.domElement.ownerDocument.body,this.dnc);Za.a.instance.Ba(B.a.zj,this.domElement.ownerDocument.body,this.cnc);Za.a.instance.Ba(B.a.Mf,this.domElement.ownerDocument.body,this.dnc);return!0};this.cnc=Cc=>{this.Wpd&&(Cc=this.hvb(Cc.clientPoint),Cc=Oc.a.KD(Cc,this.PR),this.Foe(Cc.x));return!0};this.GPi=Cc=>{void 0!==Cc.Ca&&null!==Cc.Ca&&
(9===Cc.Ca.keyCode?Cc.Ca.shiftKey?(Cc=Object(ub.a)(102,this.Bg.taskPane)?this.Bg.taskPane:null)&&Cc.hg(!1,!1):this.setFocusOnToolbarFirstElement():37!==Cc.Ca.keyCode&&39!==Cc.Ca.keyCode||this.Foe(37===Cc.Ca.keyCode?-20:20));return!0};r.ULS.sendTraceTag(521405898,9,50,"NovDeprecation: TaskPanePickerControl");this.$.domElement.classList.add(nd);this.U7f=Nc;this.initialize();z.KeyInputManager.instance.ra(B.a.Kb,this.domElement,this.Omc);this.sMb=qa.DOMElementExtensions.getElementById(Nc.parentNode,this.$.Bb+
D.a.Vkc);this.Cyc=qa.DOMElementExtensions.getElementById(Nc.parentNode,this.$.Bb+D.a.Srf);this.sMb.title=R.a.instance.ga(2230);hc.a.instance.ra(B.a.Af,this.Cyc,this.OAf);Za.a.instance.ra(B.a.pointerDown,this.Cyc,this.OAf);z.KeyInputManager.instance.ra(B.a.Kb,this.sMb,this.GPi)}get $d(){return W.a.xyc}get vzb(){return!this.$.Ml||!this.$.isChromeRtl}get Y_c(){return this.mL}get lQe(){return this.Y_c}Veb(){super.Veb();this.sMb&&(this.Bg&&this.Bg.taskPane.isResizable?(this.sMb.style.display="block",this.Cyc.style.display=
"block"):(this.sMb.style.display="none",this.Cyc.style.display="none"))}get jzc(){const Hb=this.mL;return Hb&&qa.DOMElementExtensions.isVisible(Hb)?xa.a.jzc:0}LJd(Hb){Hb&&(this.animationManager=Hb);this.$.Ml?this.Bej():(this.Cej(),this.animationManager=Hb||new pd(this.Av,this.$),this.animationManager.qwh())}dispose(){this.hoc&&this.hoc.SF(this.Gz);ia.a(this.$)&&ia.a(this.$).SF(this.Gz);const Hb=this.$.da.za(52);Hb&&Hb.SF(this.Gz);this.$.Al(this.$c);k.a.qc([this.hoc]);this.hoc=null;super.dispose()}initialize(){this.LJd(null);
this.EE(0);this.EE(1);this.EE(2);this.EE(7);this.EE(8);this.EE(9);this.EE(10);O.EwaSettings.ma(296)&&this.EE(12);O.EwaSettings.ma(480)&&this.EE(15);O.EwaSettings.isChangeGateEnabled("OfficeVSO:4458651_ExternalLinksEnableDisableRibbonButtonDuringSession")?this.EE(13):V.a.xqd(this.$)&&this.EE(13);this.EE(14);this.EE(16);O.EwaSettings.pgc()&&this.EE(17);O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)&&this.EE(18);this.Pw()}ayd(){}Pw(){var Hb=0;let Nc=0;for(let Db=
this.$z.length-1;0<=Db;Db--){const Cc=this.$z[Db].taskPane.lp(),Xc=this.$z[Db].taskPane;if(this.$z[Db].isVisible=Cc)Nc++,(1!==Xc.Yg&&(O.EwaSettings.isChangeGateEnabled("OfficeVSO:4465901_HideCommentsTaskPaneButtonOnClosePane")||7!==Xc.Yg)&&14!==Xc.Yg&&16!==Xc.Yg||Xc.Zr())&&Hb++}Hb=0<Hb;qa.DOMElementExtensions.setVisible(this.mL,Hb);this.sKb(Hb);qa.DOMElementExtensions.setVisible(this.iia,Hb&&this.isCollapsed);qa.DOMElementExtensions.setVisible(this.DGa,Hb&&!this.isCollapsed);qa.DOMElementExtensions.setVisible(this.OXc,
1<Nc);this.ANb()}QJ(Hb,Nc){if(this.isCollapsed!==Hb){Hb||(this.U7f.style.display=A.AFrameworkApplication.ta.Oa.$e?"flex":"block");var Db=this.l4b+(this.$.Ml?xa.a.QBd+xa.a.m1c:0);this.cJ=!this.isCollapsed;var Cc=Hb?Db:0;Db=Hb?0:Db;this.Bg&&(this.animationManager.anb(this.Av,Cc,Db,this.Bg.taskPane),this.tza());Hb&&(this.U7f.style.display="none");this.BRe(Hb,Nc)}}sKb(Hb){const Nc=this.isVisible!==Hb;this.kf=Hb;qa.DOMElementExtensions.setVisible(this.domElement,Hb);Nc&&(A.AFrameworkApplication.ta.Oa.$e&&
qa.DOMElementExtensions.toggleCssClass(this.domElement,H.a.cph,Hb),this.tza(),this.raiseEvent(rb.GTa,new wa(Hb,Hb,this.vzb),this))}BDb(Hb){if(Hb.Cb===this.DGa&&3!==Hb.tb)return!1;this.lva(296943390,Hb.tb);this.QJ(!0,!0);return!0}MDb(Hb){if(Hb.Cb===this.iia&&3!==Hb.tb)return!1;this.lva(-625072140,Hb.tb);this.QJ(!1,!0);return!0}Iyd(Hb){return 13===Hb.Ca.keyCode?(this.lva(296943390,Hb.tb),this.QJ(!0,!0),!0):!1}czd(Hb){return 13===Hb.Ca.keyCode?(this.lva(-625072140,Hb.tb),this.QJ(!1,!0),!0):!1}tza(){if(!this.$.Ml){let Hb=
0;this.$.Bd&262144&&(Hb+=this.jzc,qa.DOMElementExtensions.isVisible(this.Av)&&!this.isCollapsed&&(Hb+=this.l4b));this.$.tza(Hb)}}H2c(Hb,Nc){const Db=document.createElement("div");Db.classList.add(Hb);Nc.insertBefore(Db,Nc.firstChild);return Db}Bej(){const Hb=this.domElement;var Nc=ea.HelperMethods.QY(null,D.a.$Cb);Nc=document.getElementById(Nc+D.a.yxd);Hb.parentNode&&Hb.parentNode!==Nc&&Hb.parentNode.removeChild(Hb);Nc.appendChild(Hb);this.l5e()}Cej(){const Hb=this.domElement;let Nc=document.getElementById(this.$.Bb+
D.a.s_a);A.AFrameworkApplication.ta.Oa.$e&&(Nc=document.getElementById("FarPaneRegion"));Hb.parentNode&&Hb.parentNode!==Nc&&Hb.parentNode.removeChild(Hb);Nc.appendChild(Hb);this.l5e()}l5e(){const Hb=this.Av,Nc=this.mL;var Db=!this.$.Ml;const Cc=this.$.ea,Xc=Db?"0":"";Hb.style.right=Xc;A.AFrameworkApplication.ta.Oa.$e||(Hb.style.marginRight=ea.HelperMethods.pc(xa.a.jzc));Hb.style.bottom=Db?this.$.Bd&4&&!A.AFrameworkApplication.ta.Oa.$e?ea.HelperMethods.pc(this.$.Cda):"0":"";this.oO.style.bottom=Xc;
Nc.style.right=Xc;this.$.el(this.$c);Cc.vF&&this.$c(null,null);Db||(Db=this.$.isChromeRtl?"left":"right",Hb.style[Db]="0",Nc.style[Db]="0")}hvb(Hb){const Nc=new uc.a(0,0);return Oc.a.xs(Nc,this.Av,Hb,!1)}Foe(Hb){const Nc=this.Av.offsetWidth;Hb=Nc-Hb;Hb<this.Bg.taskPane.wo?Hb=this.Bg.taskPane.wo:950<Hb&&(Hb=950);this.Bg.taskPane.su=Hb;const Db=new pd(this.Av,this.$);Db.anb(this.Av,Nc,Hb,this.Bg.taskPane);Object(ub.a)(382,this.Bg.taskPane)||Db.anb(this.Bg.taskPane.mc,Nc,Hb,this.Bg.taskPane);this.$.tza(this.mL.offsetWidth+
Hb);this.$.Tya(Tb.a.NY("AnimateTaskpaneResize"))}static ka(Hb){let Nc=null;Hb.Ib&&(Nc=Hb.Ib.Og("ComponentAttach","AttachTaskPanePickerControl"),Nc.start());const Db=od.pRg(Hb.Bb),Cc=od.oRg(Hb.Bb),Xc=od.qRg(Hb.Bb);Db.appendChild(Xc);Db.appendChild(Cc);od.WLg(Hb,Db);Hb=new od(Db,Cc,Hb);Nc&&Nc.stop();return Hb}static pRg(Hb){const Nc=document.createElement("div");Nc.id=Hb+D.a.yyc;return Nc}static oRg(Hb){const Nc=document.createElement("div");Nc.id=Hb+D.a.Rrf;Nc.className=H.a.uph;let Db=String.format(Rb,
Hb+D.a.DDi,Hb+D.a.WQ);Db+=String.format(Dc,Hb+D.a.Vkc,Hb+D.a.Srf);Nc.innerHTML=Db;A.AFrameworkApplication.ta.Oa.$e&&qa.DOMElementExtensions.toggleCssClass(Nc,H.a.APa,!0);return Nc}static qRg(Hb){const Nc=document.createElement("div");Nc.id=Hb+D.a.xxd;Nc.className=H.a.xrh;Nc.style.zIndex="100";A.AFrameworkApplication.ta.Oa.$e&&qa.DOMElementExtensions.toggleCssClass(Nc,H.a.APa,!0);return Nc}static WLg(Hb,Nc){Hb.Ml?(Hb=ea.HelperMethods.QY(null,D.a.$Cb),Hb=document.getElementById(Hb+D.a.yxd)):Hb=A.AFrameworkApplication.ta.Oa.$e?
document.getElementById("FarPaneRegion"):document.getElementById(Hb.Bb+D.a.s_a);Hb.appendChild(Nc)}static l2c(){const Hb=new Ea;Hb.iUd=D.a.yyc;Hb.tW=D.a.Rrf;Hb.vyc=D.a.WQ;Hb.izc=D.a.xxd;Hb.lVd=D.a.EDi;Hb.$_c=H.a.wph;Hb.s9c=H.a.yph;Hb.Z_c=H.a.vph;Hb.p9c=H.a.xph;Hb.J1b=H.a.VOe;Hb.K7b=H.a.XOe;return Hb}}Object(c.a)(od,"TaskPanePickerControl",rb,[]);class wd extends m.a{constructor(Hb){super();this.$=Hb;this.Fb()}create(){V.a.Ad(this.$)?this.qb(Qb.ka(this.$)):this.qb(od.ka(this.$))}static ka(Hb){Hb.da.Ga(50,
new wd(Hb))}}Object(c.a)(wd,"TaskPaneManagerFactory",m.a,[]);class Pc extends d.a{constructor(Hb){super(Hb);this.vw=()=>{this.$.ea.oR(this.vw);this.XDe()};this.$=Hb}XDe(){const Hb=this.$.da;Hb.Ga(72,new Lb(this.$));Hb.Ga(77,new ca(this.$));wd.ka(this.$);O.EwaSettings.isChangeGateEnabled("OfficeVSO:6938438_deleteNovActionToolbarControl")||ua.ka(this.$);Xa.ka(this.$)}static main(){f.a.Fa(Hb=>{b.a.Cjd(Hb.domElement.ownerDocument,e.a.current.Rn(97),()=>{Hb.oI()});const Nc=new Pc(Hb);Hb.ea.jv?Nc.XDe():
Hb.ea.bT(Nc.vw)})}}Object(c.a)(Pc,"TaskPaneSliceBootstrapper",d.a,[]);Type.registerNamespace("_Ewa");Pc.main();Type.registerNamespace("CommandUI.TaskPane")}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.tp.js.map/3c24e4e0c90a0f5b4faf1f4013b145a6/EwaDSEsNext.tp.js.map