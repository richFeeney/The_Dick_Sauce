'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[27],{1126:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b,d,f,e,k,l){this.Ena=b;this.confidence=d;this.headerRowCount=f;this.headerColumnCount=e;this.orientation=k;this.fields=l}}Object(t.a)(c,"TableInterpretation",null,[])},1153:function(t,C,a){var c=a(10);t=a(0);var b=a(15),d=a(221),f=a(50),e=a(37),k=a(7),l=a(172),m=a(721),v=a(695);class n extends m.a{constructor(){super();this.tableName=
this.interpretations=this.range=null;this.H_=Object.assign(new v.a,{T_:n.getTypeName(),B_:n.Pd()})}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelRecognizedTableNew"}static Pd(){return["AugLoop_Core_Annotation"]}}Object(t.a)(n,"ExcelRecognizedTableNew",m.a,[]);class w extends n{constructor(){super();this.requestId=null;this.H_=Object.assign(new v.a,{T_:w.getTypeName(),B_:w.Pd()})}static getTypeName(){return"AugLoop_ExcelTableai_ExcelRangeMetadata"}static Pd(){return["AugLoop_ExcelTableAi_ExcelRecognizedTableNew",
"AugLoop_Core_Annotation"]}}Object(t.a)(w,"ExcelRangeMetadata",n,[]);m=a(1282);class r extends m.a{constructor(){super();this.value=null;this.type=0;this.H_=Object.assign(new v.a,{T_:r.getTypeName(),B_:r.Pd()})}static getTypeName(){return"AugLoop_ExcelTableai_ExtendedExcelCell"}static Pd(){return["AugLoop_Excel_ExcelCell","AugLoop_Core_GridCell"]}}Object(t.a)(r,"ExtendedExcelCell",m.a,[]);m=a(864);class u extends m.a{constructor(){super();this.mergeCellAddresses=this.requestId=this.cells=this.range=
null;this.H_=Object.assign(new v.a,{T_:u.getTypeName(),B_:u.Pd()})}static getTypeName(){return"AugLoop_ExcelTableai_RangeDataSignal"}static Pd(){return["AugLoop_Signals_Signal"]}}Object(t.a)(u,"RangeDataSignal",m.a,[]);m=a(716);class y extends m.a{constructor(){super();this.worksheetId=null;this.bottom=this.right=this.top=this.left=0;this.H_=Object.assign(new v.a,{T_:y.getTypeName(),B_:y.Pd()})}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelRangeAddressNew"}static Pd(){return[]}}Object(t.a)(y,
"ExcelRangeAddressNew",m.a,[]);var x=a(99);m=a(38);var B=a(1),z=a(22),A=a(21);class I extends Sys.EventArgs{constructor(R){super();this.OGb=R}}Object(t.a)(I,"RecognizedTableUpdateEventArgs",Sys.EventArgs,[]);var F=a(185),U=a(24),X=a(338);class S{constructor(R,oa,pa,Pa){this.nE=R;this.interpretations=oa;this.tableName=pa;this.id=Pa}}Object(t.a)(S,"RecognizedTable",null,[]);class H{constructor(R,oa,pa){this.classification=R;this.aggregations=oa;this.headerReferences=pa}}Object(t.a)(H,"TableField",null,
[]);var D=a(1126);const J=R=>{var oa=new X.a(M(R.range),R.range.worksheetId);var pa=R.interpretations;var Pa=new F.a;if(pa&&pa.length)for(const ia of pa){b:switch(ia.orientation.toLowerCase()){case "columnmajor":pa=2;break b;case "rowmajor":pa=1;break b;default:b.ULS.sendTraceTag(537151256,0,50,"Invalid value for table orientaion."),pa=0}const ya=pa;if(0===ya)b.ULS.sendTraceTag(537151257,0,50,"Invalid value for table orientaion. Skipping current interpretation.");else{pa=D.a;var Z=M(ia.location),
Ra=ia.confidence,Ga=ia.headerRowCount,Ba=ia.headerColumnCount;var fa=ia.fields;var Y=new F.a;if(fa)for(const ib of fa){fa=Y;var ja=fa.add;c:switch(ib.classification.toLowerCase()){case "dimension":var ca=1;break c;case "measure":ca=2;break c;default:b.ULS.sendTraceTag(537151255,0,50,"Invalid value %s for field classification."),ca=0}var aa=ib.aggregations;var ta=new F.a;if(aa)for(const wa of aa)switch(wa.toLowerCase()){case "sum":ta.add(0);break;case "count":ta.add(1);break;case "average":ta.add(2);
break;case "min":ta.add(3);break;case "max":ta.add(4);break;case "distinctcount":ta.add(5);break;case "stddev":ta.add(6);break;case "variance":ta.add(7);break;default:b.ULS.sendTraceTag(537151254,0,50,"Invalid value for aggregation type.")}aa=ta;var xa=ib.headerReferences;ta=new F.a;if(xa)for(const wa of xa)xa=new U.Range(wa.top,wa.left,wa.top,wa.left,!1,!1),ta.add(xa);ja.call(fa,new H(ca,aa,ta))}pa=new pa(Z,Ra,Ga,Ba,ya,Y);Pa.add(pa)}}return new S(oa,Pa,R.tableName,R.id)},M=R=>new U.Range(R.top,R.left,
R.bottom,R.right,!1,!1);class G{constructor(R){this.oy=new Map;this.ald=!1;this.tableIntelligenceManager=R;this.tableIntelligenceManager.RXa("Valid",this.YSi.bind(this));this.tableIntelligenceManager.RXa("Invalid",this.EMi.bind(this))}Bac(R,oa){return this.oy?this.oy.has(R.sheetId)?this.oy.get(R.sheetId).filter(pa=>pa.table.nE.range.Dd(R.range)&&(pa.lCb&oa)==pa.lCb):[]:(b.ULS.sendTraceTag(521025344,306,10,"Recognized table is null"),[])}YSi(R,oa){if(this.oy){if(!this.ald){for(const [pa,Pa]of this.oy)Pa.every(Z=>
4===Z.lCb)?this.oy.delete(pa):this.oy.set(pa,Pa.filter(Z=>4!==Z.lCb));this.ald=!0}R=oa.OGb;this.oy.has(R.nE.sheetId)||this.oy.set(R.nE.sheetId,[]);this.oy.get(R.nE.sheetId).push({table:R,lCb:2})}else b.ULS.sendTraceTag(521025315,306,10,"Recognized table is null")}EMi(R,oa){this.ald=!1;R=oa.OGb;if(this.oy)if(this.oy.has(R.nE.sheetId))for(const pa of this.oy.get(R.nE.sheetId))pa.table.id===oa.OGb.id&&(pa.lCb=4);else b.ULS.debugAssertTag(522981602,306,!1,"No recognized tables for sheet");else b.ULS.sendTraceTag(521025314,
306,10,"Recognized table is null")}}Object(t.a)(G,"TableIntelligenceQueryManager",null,[284]);class T{}Object(t.a)(T,"RecognizedTableLog",null,[]);class K{}Object(t.a)(K,"Interpretation",null,[]);class L{constructor(R){this.oy=new Map;this.kZb=void 0;this.fnb=new Set;this.qDb=void 0;this.tableIntelligenceManager=R}Gig(){this.qDb?b.ULS.shipAssertTag(522303246,306,!1,"LogXlimRecognizedTables should not be called twice."):(this.qDb=this.gyd.bind(this),this.tableIntelligenceManager.RXa("Valid",this.qDb))}avi(R){R=
this.t6(R);b.ULS.sendTraceTag(521233111,306,15,`${JSON.stringify(R)}`)}gyd(R,oa){R=oa.OGb;B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.fnb&&this.oy?(this.fnb.has(R.id)||(this.RCg(R),this.fnb.add(R.id)),this.kZb||(this.kZb=window.setTimeout(this.J5.bind(this),2E3))):b.ULS.sendTraceTag(522303245,306,15,`AnnotationId set or recognized table store is null. annotationIdSet = ${!!this.fnb}, recognizedTableStore = ${!!this.oy}`))}J5(){for(const [,R]of this.oy)b.ULS.sendTraceTag(521233110,
306,15,JSON.stringify(R));window.clearTimeout(this.kZb);this.fnb=this.kZb=void 0;this.oy.clear();this.oy=void 0;this.tableIntelligenceManager.n$i(this.qDb);this.qDb=void 0}RCg(R){const oa=R.nE.sheetId;this.oy.has(oa)||this.oy.set(oa,[]);this.oy.get(oa).push(this.t6(R))}t6(R){const oa=[],pa=B.EwaSettings.isChangeGateEnabled("OfficeVSO:6670393_logRecognizedTableDimensions");for(const Pa of R.interpretations)if(pa){let Z=0,Ra=0;for(const Ga of Pa.fields)1===Ga.classification?Z++:2===Ga.classification&&
Ra++;oa.push({confidence:Pa.confidence,headerRowCount:Pa.headerRowCount,headerColumnCount:Pa.headerColumnCount,orientation:Pa.orientation,measureCount:Ra,dimensionCount:Z})}else oa.push({confidence:Pa.confidence,headerRowCount:Pa.headerRowCount,headerColumnCount:Pa.headerColumnCount,orientation:Pa.orientation});return{interpretations:oa,range:{top:R.nE.range.top,bottom:R.nE.range.bottom,left:R.nE.range.left,right:R.nE.range.right},isTable:!!R.tableName,annotationId:pa?R.id:null}}}Object(t.a)(L,"RecognizedTableLogger",
null,[]);class V extends m.a{constructor(R,oa){super();this.bfc=this.dcf=!1;this.Ioe={};this.instantaneousSupportInformationManager=null;this.iGd=void 0;this.omf=!1;this.Xvh=(pa,Pa)=>{var Z;1===Pa.operationType&&((Pa=Pa.rJ)?(b.ULS.sendTraceTag(537151251,306,50,`TableIntelligenceManager::ExcelRangeMetadataHandler called for requestID = ${Pa.requestId}`),pa=J(Pa),B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(null===(Z=this.iGd)||void 0===Z?void 0:Z.avi(pa)),
({value:Z}=this.KRd.Dc(Pa.requestId)).returnValue?(this.KRd.remove(Pa.requestId),Z(pa)):b.ULS.sendTraceTag(537151250,306,10,`TableIntelligenceManager::ExcelRangeMetadataHandler Callback not found for requestId = ${Pa.requestId}`)):b.ULS.sendTraceTag(537151252,306,10,"TableIntelligenceManager::ExcelRangeMetadataHandler excelRangeMetadata is null."))};this.Bzg=(pa,Pa)=>{this.$.isChangeGateEnabled("OfficeVSO:6137444_UseCommonFunctionForExcelRecognizedTableAnnotation")?this.HIf("RecognizedTableUpdate",
Pa):1===Pa.operationType&&((pa=Pa.rJ)?(pa=J(pa),this.raiseEvent("RecognizedTableUpdate",new I(pa))):b.ULS.sendTraceTag(537151249,306,10,"TableIntelligenceManager::GetRange ExcelRecognizedTable is null."))};this.augmentationLoopManager=R;this.$=oa;this.KRd=new x.a;B.EwaSettings.isChangeGateEnabled("OfficeVSO:6102923_registerTableIntelligenceService")&&this.$.da.Ga(20,this);B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.iGd=new L(this))}X3a(){this.C7f||
(this.C7f=new G(this));return this.C7f}YQh(R,oa){if(!B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OnDemandMetadataEnabled",!1))return 1;if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:6648526_LimitCellsInSignal")&&1E4<R.range.WG)return b.ULS.sendTraceTag(520501002,306,15,`Signal with range size of ${R.range.WG} exceeds limit of ${1E4}`),4;this.Wyg();if(this.eki(R.range))return this.gUh(R,oa);b.ULS.sendTraceTag(537151253,306,15,"Range is not completely contained within the viewport");
return 2}cGg(R){this.Xyg();this.addHandler("RecognizedTableUpdate",R);this.P9e()}Rbj(R){this.removeHandler("RecognizedTableUpdate",R)}RXa(R,oa){var pa,Pa;B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThreshold",!1)&&(null===(Pa=null===(pa=this.$)||void 0===pa?void 0:pa.xa)||void 0===Pa?0:Pa.count)&&this.$.xa.count>B.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThresholdValue",100)?b.ULS.sendTraceTag(520720838,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.xa.count}`):
(this.Ioe[R]||(this.bfc||(this.augmentationLoopManager.activateAnnotation(n.getTypeName()),this.bfc=!0),this.augmentationLoopManager.O1.bP(R,n.getTypeName(),(Z,Ra)=>this.HIf(this.Cud(R),Ra)),this.Ioe[R]=!0),this.UBg(R,oa),this.P9e())}n$i(R){this.removeHandler(this.Cud("Valid"),R)}UBg(R,oa){this.addHandler(this.Cud(R),oa)}p7i(){B.EwaSettings.ma(291)&&B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligence",!1)&&(this.augmentationLoopManager.activateAnnotation(n.getTypeName()),
this.augmentationLoopManager.bP(n.getTypeName(),this.Bzg))}o7i(){this.augmentationLoopManager.activateAnnotation(w.getTypeName());this.augmentationLoopManager.bP(w.getTypeName(),this.Xvh)}Xyg(){var R,oa;B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThreshold",!1)&&(null===(oa=null===(R=this.$)||void 0===R?void 0:R.xa)||void 0===oa?0:oa.count)&&this.$.xa.count>B.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThresholdValue",
100)?b.ULS.sendTraceTag(520720837,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.xa.count}`):this.bfc||(this.p7i(),this.bfc=!0)}Wyg(){this.dcf||(this.dcf=!0,this.o7i())}HIf(R,oa){1===oa.operationType&&((oa=oa.rJ)?(oa=J(oa),this.raiseEvent(R,new I(oa))):b.ULS.sendTraceTag(523772681,306,10,"TableIntelligenceManager::processAndRaiseExcelRecognizedTableAnnotationReceivedEvent ExcelRecognizedTable is null."))}Cud(R){return`${"RecognizedTableUpdate"}_${R}`}gUh(R,
oa){b.ULS.sendTraceTag(537151248,306,15,"On-Demand Metadata Triggered");const pa=R.range,Pa=A.g(this.$).mk("TableIntelligence",pa,1),Z=[],Ra=[];let Ga=0;const Ba=B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1),fa=B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceNumberFormatEnabled",!1);for(fa&&!this.instantaneousSupportInformationManager&&this.$.da.Za(268,Y=>{this.instantaneousSupportInformationManager=Y});Pa.$$mn();){const Y=Pa.$$cu();
if(!Y)continue;if(0===Y.Sw.type&&z.a.Aq(Y.Sw.value))continue;B.EwaSettings.isChangeGateEnabled("OfficeVSO:5857908_OnDemandMergeCells")&&Y.KH&&Y.range&&Ra.push(Object(k.a)(new y,{worksheetId:R.sheetId,left:Y.range.left-1,top:Y.range.top-1,right:Y.range.right-1,bottom:Y.range.bottom-1}));const ja=Y.range.top-1,ca=Y.range.left-1;let aa=null,ta=null;fa&&({category:ta}=this.instantaneousSupportInformationManager.ZAa(Y.cell.Gk,!0),Y.text!=Y.Sw.value&&(aa=Y.text,Ba&&Ga++));Z.push(Object.assign(new r,{row:ja,
column:ca,value:Y.Sw.value,type:Y.Sw.type,displayText:aa,EZj:ta}))}Ba&&b.ULS.sendTraceTag(526260166,306,50,`TableIntelligenceManager::getRangeDataFromGrid requests non-null displayText: ${Ga}, number of values: ${Z.length}, range size: ${pa.height} rows by ${pa.width} columns`);if(0<Z.length)return this.w8g(Z,R,Ra,oa),Ra.length?5:0;b.ULS.sendTraceTag(537151247,306,15,"All cells in range were empty");return 3}w8g(R,oa,pa,Pa){var Z=oa.range;Z=Object(k.a)(new y,{top:Z.top,left:Z.left,bottom:Z.bottom,
right:Z.right,worksheetId:oa.sheetId});oa=l.a.create().toString();R=Object(k.a)(new u,{cells:R,range:Z,mergeCellAddresses:pa,requestId:oa});this.augmentationLoopManager.pTd(R);this.KRd.add(oa,Pa)}eki(R){const oa=A.g(this.$);if(B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)){const pa=oa.vub();b.ULS.sendTraceTag(520501001,306,50,`viewportWidth: ${pa.width}, viewportHeight: ${pa.height}`)}return oa.Ea.oK(4,this.$.pa)&&!!oa.Vb(R.topLeft)&&!!oa.Vb(R.bottomLeft)&&
!!oa.Vb(R.topRight)&&!!oa.Vb(R.bottomRight)}P9e(){var R;!this.omf&&B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.omf=!0,null===(R=this.iGd)||void 0===R?void 0:R.Gig())}}Object(t.a)(V,"TableIntelligenceManager",m.a,[2,257]);class W extends d.a{constructor(R){super();this.$=R;this.Fb()}create(){e.TaskExtensions.Aa(f.GetServiceTaskFactory.Ra(this.$.da,328,327,1),R=>{if(R=R.result){let oa=this.$.da.za(20);oa||(oa=new V(R,this.$),B.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")&&
this.$.da.Ga(20,oa));this.qb(oa)}else b.ULS.sendTraceTag(537151246,306,10,"AugmentationLoopManager instance null. Can not create TableIntelligenceManager instance. Creating null service event."),this.qb(null)},this.$.la,3)}static ka(R){R.da.Ga(404,new W(R))}}Object(t.a)(W,"TableIntelligenceManagerFactory",d.a,[]);class da{constructor(R,oa){this.Joe=!1;this.tableIntelligenceManager=R;B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableGridHighlights",!1)&&void f.GetServiceTaskFactory.cja(oa.da,
510,511,1);this.tableIntelligenceManager.RXa("Valid",()=>{B.EwaSettings.isChangeGateEnabled("OfficeVSO:6280730_avoidLoggingForEveryAnnotation")&&!this.Joe&&(b.ULS.sendTraceTag(526979921,0,15,"Received annotation with interpretations"),this.Joe=!0)})}}Object(t.a)(da,"TableIntelligenceDarkActivationManager",null,[256]);var qa=a(696);class O extends d.a{constructor(R){super();this.$=R;this.Fb()}static ka(R){R.da.Ga(481,new O(R))}create(){const R=f.GetServiceTaskFactory.Ra(this.$.da,20,404,1);e.TaskExtensions.Aa(R,
()=>{const oa=R.result,pa=Object(qa.b)(this.$.da,480,()=>new da(oa,this.$));this.qb(pa)},this.$.la,3)}}Object(t.a)(O,"TableIntelligenceDarkActivationManagerFactory",d.a,[]);a.d(C,"a",function(){return ea});const ea=()=>{c.a.Fa(R=>{W.ka(R);O.ka(R)})}},1250:function(t,C,a){var c=a(10);t=a(0);var b=a(221),d=a(15),f=a(38),e=a(1);class k extends f.a{constructor(){super()}aWd(n,w){d.ULS.sendTraceTag(537154185,0,50,`ProactiveSuggestionManager.TriggerProactiveSuggestion: proactive suggestion was triggered. Range: ${n}, TriggerType: ${w}`);
if(e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1))switch(w){case 0:this.raiseEvent("pssort",void 0,n);break;case 1:this.raiseEvent("psfilter",void 0,n);break;case 2:this.raiseEvent("pscrttbl",void 0,n)}}}Object(t.a)(k,"ProactiveSuggestionManager",f.a,[693]);var l=a(696);class m extends b.a{constructor(n){super();this.$=n;this.Fb()}create(){let n=Object(l.a)(this.$.da,476,()=>new k);this.qb(n)}static ka(n){n.da.Ga(475,new m(n))}}Object(t.a)(m,
"ProactiveSuggestionManagerFactory",b.a,[]);a.d(C,"a",function(){return v});const v=()=>{c.a.Fa(n=>{m.ka(n)})}},1421:function(t,C,a){function c(ob,Zb=oa.a.Eb){return R.b(ob.ud(-1502853784,Zb,12,null))}function b(ob,Zb){ob.ud(2105621672,oa.a.Eb,12,{onClose:Zb})}function d(ob,Zb="DataCleansingTaskPane"){ob.ud(802602464,oa.a.Eb,12,{[pa.a.rU]:Zb})}function f(ob){ob={otelEvent:Object.assign(Object.assign({},ob),{telemetryProperties:{ariaTenantToken:"19eb5e37de684ce38ce5cf3d5842d3f7-e8722941-bde5-4b98-9cd5-2775ec51482c-6873",
nexusTenantToken:1777}}),additionalDataFields:void 0};fa.a.sendOtelEvent(ob)}function e(ob){Y.add(ob)}function k(ob){if(I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanDataSurvey",!1)){const Zb=Y.has(0),Bc=Y.has(1);Zb&&!Bc&&ob.ud(2063144036,-1,0,null)}}function l(ob,Zb){return Object(ja.a)(this,void 0,void 0,function*(){if(Pa.m(ob.pa)){const Bc=ob.pa;return Zb.map(bd=>Ra(bd,!0)).filter(bd=>Bc.a0.bgc(bd))}return[]})}function m(ob,Zb,Bc){return Object(ja.a)(this,void 0,void 0,function*(){try{switch(null===
Zb||void 0===Zb?void 0:Zb.type){case 0:return v(ob,Zb,Bc);case 2:return w(ob,Zb,Bc);case 1:return n(ob,Zb,Bc);default:G.ULS.sendTraceTag(520987281,0,10,`applySuggestion: Unknown suggestion type ${null===Zb||void 0===Zb?void 0:Zb.type}`)}}catch(bd){G.ULS.sendTraceTag(520987280,0,10,`applySuggestion: ${bd}`)}return null})}function v(ob,Zb,Bc){return Object(ja.a)(this,void 0,void 0,function*(){const bd=Zb.variations.filter(Ve=>Ve.isSelected&&Ve.value!==Zb.replacementValue).map(Ve=>Ve.value),Ed={["SheetName"]:ob.pa.sheetName,
["MatchCase"]:!1,["MatchEntireCell"]:!1,["SearchAllSheets"]:!1,["ExcludeFormulaResult"]:!1,["SearchUp"]:!1,["SearchStrings"]:bd},ge=Zb.variations.every(Ve=>Ve.value!==Zb.replacementValue),be=new wa(!ge&&!0),{cAd:qe,aAd:ze,sBd:Ce}=r(0);Object(rb.a)(ob.userOperationManager,(Ve,we,vc)=>vb.w(ob.oa.va,Ed,Object(sa.u)(ob.pa.sheetName,null,Bc),Zb.replacementValue,Object(ma.b)(Ve,qe),Object(ma.a)(we,ze),vc,be),Ve=>new cc.a(258,0,Ve),null);yield Ce;return{result:bd.length,Ana:!0}})}function n(ob,Zb,Bc){return Object(ja.a)(this,
void 0,void 0,function*(){if(null===Bc||void 0===Bc||!Bc.length)return G.ULS.sendTraceTag(520987279,0,10,"applyNumberFormatInconsistencySuggestion: empty changeRanges."),Promise.resolve({result:0,Ana:!1});const bd=Object(sa.u)(ob.pa.sheetName,null,Bc),Ed=new wa(!0),ge={},be=Zb.formats.find(({key:vc})=>vc===Zb.replacementFormat).format;ge.NumberFormatOptions=Object(S.a)(new Na.a,{NumberFormatCategory:-1,CustomFormatString:be});ge.ValidMembers=32;ge.NumberFormat=15;const qe=Object(sa.o)(fb.g(ob).ha.sa.activeCell,
ob),ze=ob.oa.va.Sb({MZ:!0,dZ:1}),{cAd:Ce,aAd:Ve,sBd:we}=r(1);Object(rb.a)(ob.userOperationManager,(vc,ed,Id)=>Ea.l(ob.oa.va,bd,qe,ge,!1,null,null,!0,Object(ma.b)(vc,Ce),Object(ma.a)(ed,Ve),Id,Ed,ze,null),vc=>new cc.a(11,0,vc),null);yield we;return{result:-1,Ana:!0}})}function w(ob,Zb,Bc){return Object(ja.a)(this,void 0,void 0,function*(){const {cAd:bd,aAd:Ed,sBd:ge}=r(2),be=new wa(!0);Object(rb.a)(ob.userOperationManager,(qe,ze,Ce)=>{var Ve=ob.oa.va,we=Object(sa.u)(ob.activeItemName,null,Bc);a:{var vc=
Zb.extraSpacesType;switch(vc){case 0:vc=1;break a;case 2:vc=2;break a;case 1:vc=4;break a;default:throw G.ULS.sendTraceTag(520987278,0,10,`ConvertExtraSpacesTypeToTrimWhitespaceType: Unknown ExtraSpacesPaddingType ${vc}`),Error.argument("illegal ExtraSpacesPaddingType");}}return ua(Ve,we,vc,Object(ma.b)(qe,bd),Object(ma.a)(ze,Ed),Ce,be)},qe=>new cc.a(253,0,qe),null);return{result:(yield ge).Result,Ana:!0}})}function r(ob){const Zb=new Ca.a;return{cAd(Bc){Bc&&$a.a.rg(Bc.Errors)?(G.ULS.sendTraceTag(520987277,
0,10,`DataCleansing onOperationSuccess: Ewa result contains error messages after applying type [${ob}]`),Zb.setResult(null)):(G.ULS.sendTraceTag(520987276,0,50,`DataCleansing onOperationSuccess: Suggestion of type [${ob}] applied successfully.`),Zb.setResult(Bc))},aAd(Bc){G.ULS.sendTraceTag(520987275,0,10,`DataCleansing onOperationFailed: Ewa result contains error messages for type [${ob}], HttpStatus [${Bc.data.httpStatus}]`);Zb.setResult(null)},sBd:R.d(Zb.task)}}function u(ob,Zb,Bc,bd=Rb){const {Nx:Ed,
success:ge}=ob.xTe(Bc,Zb,bd.width,bd.font);return ge?Ed:(G.ULS.sendTraceTag(512508562,0,50,"formatValue: Failed to acquire friendly format string"),"")}a.r(C);var y=a(508),x=a(10),B=a(33),z=a(0),A=a(691),I=a(1),F=a(182),U=a(55);class X{constructor(ob,Zb){this.$=ob;this.nVi=Zb}Nc(){return!1}executeCommand(ob,Zb){ob=!0;switch(Zb.command){case -1190551534:this.nVi.qDe();break;default:ob=!1}return ob?U.Task.Ta(!0):F.a(Zb.command)}Cc(ob,Zb){return-1190551534===Zb.command&&I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",
!1)}Rc(){return!1}}Object(z.a)(X,"DataCleansingCommandHandler",null,[195]);var S=a(7),H=a(86),D=a(50),J=a(413),M=a(37),G=a(15),T=a(38);class K{constructor(ob,Zb){this.Kwg=ob;this.$Lc=Zb}get kUd(){return this.Kwg}get messageType(){return this.$Lc}toString(){return"TaskPaneViewState: "+this.kUd+", MessageType: "+this.messageType}}Object(z.a)(K,"DataCleansingTaskPaneState",null,[]);class L extends T.a{constructor(ob){super();this.Xvc=this.MPd=this.ZPa=this.V5a=this.isInViewMode=this.NLa=this.Y5e=!1;
this.XQ=()=>{if(this.isInViewMode=!this.$.ea.isEditMode)this.ZPa=!1;G.ULS.sendTraceTag(537163355,0,50,`DataCleansingPaneStateManager.OnApplicationModeChanged: view mode has changed to ${this.isInViewMode}.`);this.cBa()};this.rB=(Zb,Bc)=>{Zb=Bc.DYd;G.ULS.sendTraceTag(537163354,0,50,`DataCleansingPaneStateManager.OnUserListChanged: the number of coauth users has changed to ${Zb}.`);if(this.NLa&&1>=Zb||!this.NLa&&1<Zb)this.NLa=1<Bc.DYd,G.ULS.sendTraceTag(537163353,0,50,`DataCleansingPaneStateManager.OnUserListChanged: coauthoring mode has changed to ${this.NLa}.`),
this.NLa&&(this.ZPa=!1),this.cBa()};this.aR=()=>{if(this.V5a=this.$.pa.Ed.lv)this.ZPa=!1;G.ULS.sendTraceTag(537163352,0,50,`DataCleansingPaneStateManager.OnNamedSheetViewModeChanged: named sheet view mode has changed to ${this.V5a}.`);this.cBa()};this.Gh=(Zb,Bc)=>{G.ULS.sendTraceTag(537163351,0,50,"DataCleansingPaneStateManager.OnActiveSheetChanged: active sheet was changed.");Bc.tD.Ed.QPa(this.aR);Bc.pa.Ed.mra(this.aR);this.V5a=Bc.pa.Ed.lv;this.ZPa=!1;this.cBa()};this.KEb=()=>{G.ULS.sendTraceTag(523257922,
0,50,"DataCleansingPaneStateManager.onUnrecoverableErrorOccurred: Received augmentation loop permanent session close.");this.cBa()};this.$=ob;this.MPd&&this.$.ea.b9(this.rB);this.$.ea.GX(this.XQ);this.$.pa.Ed.mra(this.aR);this.$.En.Pf(this.Gh);this.tnc=this.tnc.bind(this);this.$.da.Za(411,Zb=>{Zb.JGg(this.tnc);this.Xvc&&Zb.QGg(this.KEb);2===Zb.status&&(this.Y5e=!0);this.cBa()});this.Eqe()&&(this.isInViewMode=!this.$.ea.isEditMode,this.NLa=1<this.$.ea.Jm.length,this.V5a=this.$.pa.Ed.lv);this.Qgb=this.dAe()}get currentState(){return this.Qgb}get dataCleansingManager(){return this.$.da.za(411,
void 0)}Nmb(ob){this.addHandler("scev",ob)}Orc(ob){this.removeHandler("scev",ob)}dispose(){this.$.da.Za(411,ob=>{ob.tcj(this.tnc);ob.zcj(this.KEb)});this.$.ea.n6(this.rB);this.MPd&&this.$.ea.n6(this.rB);this.$.ea.z_(this.XQ);this.$.pa.Ed.QPa(this.aR);this.$.En.zg(this.Gh)}uAd(){this.ZPa=!1;G.ULS.sendTraceTag(537163356,0,50,"DataCleansingPaneStateManager.OnRefreshRequested: refresh pane was triggerd.");this.cBa()}tnc(ob,{sheetId:Zb,Gda:Bc}){G.ULS.sendTraceTag(537163350,0,50,`DataCleansingPaneStateManager.OnSuggestionsStatusChanged: suggestion status of sheet id ${Zb} has changed to ${Bc}.`);
ob=this.$.xa.pa.sheetId;ob===Zb&&2===Bc&&(this.ZPa=!0);ob!==Zb||4!==Bc&&2!==Bc&&5!==Bc||this.cBa()}Eqe(){return this.$&&this.$.ea&&this.$.ea.Jm&&this.$.pa&&this.$.pa.Ed?!0:(G.ULS.sendTraceTag(537163349,0,50,"DataCleansingPaneStateManager.AreDependenciesValid: at least one of the dependencies is null."),!1)}cBa(){this.Qgb=this.dAe();this.raiseEvent("scev")}dAe(){let ob;ob=this.z4h()?new K(4,5):this.isInViewMode?new K(5,2):this.MPd&&this.NLa?new K(5,1):this.V5a?new K(5,3):this.ZPa?new K(2,0):this.idi()?
new K(1,0):new K(0,0);G.ULS.sendTraceTag(537163348,0,50,`DataCleansingPaneStateManager.ConcludeState: the new state of the data cleansing task pane is: ${ob}`);return ob}idi(){const ob=this.vGh();return 4===ob||6===ob}vGh(){return this.dataCleansingManager?this.dataCleansingManager.F9b():0}z4h(){return this.Y5e||!this.jld()||!this.Eqe()}jld(){const ob=this.dataCleansingManager;return this.Xvc&&I.EwaSettings.isChangeGateEnabled("OfficeVSO:6245313_disableTaskPaneWhenALSessionClose")&&ob?ob.jld:!0}}
Object(z.a)(L,"DataCleansingPaneStateManager",T.a,[]);var V=a(174),W=a(1311),da;(function(ob){ob[ob.textInconsistency=0]="textInconsistency";ob[ob.numberFormatInconsistency=1]="numberFormatInconsistency";ob[ob.extraSpaces=2]="extraSpaces"})(da||(da={}));Object(z.b)("SuggestionType",da);var qa=a(737),O=a(14);class ea{constructor(){this.availableTables=this.selectedTable=this.suggestions=this.callbacks=this.isLoading=this.type=null;this.viewState=0;this.applyConfirmationMessage=this.messageType=null}}
Object(z.a)(ea,"DataCleansingTaskPaneProps",null,[]);var R=a(196),oa=a(77),pa=a(5),Pa=a(65),Z=a(24);const Ra=(ob,Zb)=>{ob=new Z.Range(ob.top,ob.left,ob.bottom,ob.right,!1,Zb);if(Zb&&(1>ob.top||ob.top>ob.maxRows||1>ob.bottom||ob.bottom>ob.maxRows||ob.top>ob.bottom||1>ob.left||ob.left>ob.maxColumns||1>ob.right||ob.right>ob.maxColumns||ob.left>ob.right))throw G.ULS.sendTraceTag(537163357,0,10,"DataCleansingOouiAdapter.ValidateRange: range is invalid"),Error.argument("DataCleansingOouiAdapter.ValidateRange: range is invalid");
return ob};class Ga{constructor(ob,Zb){this.onKeyDown=Bc=>{switch(this.$.shortcutKeyManager.Xs(new Sys.UI.DomEvent(Bc))){case -1502853784:switch(Bc.stopPropagation(),Bc=this.$.ea.sNb,Bc){case 1:G.ULS.sendTraceTag(523805083,0,50,"DataCleansingReactTaskPane.onKeyDown: Undo command triggered");void c(this.$,1);break;default:G.ULS.sendTraceTag(523621314,0,50,`DataCleansingReactTaskPane.onKeyDown: Undo command skipped, state is ${Bc}`)}}};this.u4b=ob;this.$=Zb}AI(ob,Zb,Bc,bd,Ed,ge){void V.UISurfaces.Lj().then(be=>
{var qe,ze;be.showTaskPane("DataCleansingTaskPane",this.Xv(ob,Zb,Bc.kUd,bd,Ed,ge,Bc.messageType));be=null!==(qe=null===Zb||void 0===Zb?void 0:Zb.length)&&void 0!==qe?qe:0;qe=null!==(ze=null===bd||void 0===bd?void 0:bd.length)&&void 0!==ze?ze:0;ze=this.X1e(Zb);G.ULS.sendTraceTag(537163409,0,50,`DataCleansingReactTaskPane.ShowReactTaskPane: Suggestions count: [${be}], tableNames count: [${qe}], taskPaneState: [${Bc}], ${ze}`);return null})}vu(ob,Zb,Bc,bd,Ed,ge,be=null){void V.UISurfaces.Lj().then(qe=>
{qe.updateTaskPane("DataCleansingTaskPane",this.Xv(ob,Zb,Bc.kUd,bd,Ed,ge,Bc.messageType,be));qe=this.X1e(Zb);G.ULS.sendTraceTag(537163408,0,50,`DataCleansingReactTaskPane.UpdateReactTaskPane: Suggestions count: [${Zb.length}], tableNames count: [${bd.length}], taskPaneState: [${Bc}], ${qe}`);return null})}PM(){void V.UISurfaces.Lj().then(ob=>{ob.hideTaskPane("DataCleansingTaskPane",2);return null})}eda(){void V.UISurfaces.Lj().then(ob=>{ob.setSelectedTaskPane("DataCleansingTaskPane");return null})}X1e(ob){if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6807973_DataCleansingLogSuggestionCountPerType")){const Zb=
JSON.stringify(this.yXh(ob));ob=this.zXh(ob);return`suggestionsCountPerType: [${Zb}], suggestionsGroupIdentifier: [${ob}]`}return""}yXh(ob){var Zb;return null!==(Zb=null===ob||void 0===ob?void 0:ob.reduce((Bc,bd)=>{bd=da[bd.type];bd in Bc?Bc[bd]++:Bc[bd]=1;return Bc},{}))&&void 0!==Zb?Zb:{}}zXh(ob){var Zb;if(null===(Zb=null===ob||void 0===ob?void 0:ob[0])||void 0===Zb||!Zb.tableRange)return"";Zb=Pa.d(this.$.pa);ob=Ra(ob[0].tableRange,!1).toString();return`${Zb} ${ob}`}Xv(ob,Zb,Bc,bd,Ed,ge,be,qe=null){Zb=
Object(S.a)(new ea,{type:"DataCleansingTaskPaneProps",suggestions:Zb,callbacks:ge,availableTables:bd,selectedTable:Ed,isLoading:0===Bc,viewState:Bc,messageType:be,applyConfirmationMessage:qe});return B.a.Ad(this.$)?Object(S.a)(new W.a,{width:320,contentProps:Zb,title:O.a.instance.ga(1305),onOpen:ze=>{ze.addEventListener("keydown",this.onKeyDown);this.u4b.fy()},onClose:ze=>{ze.removeEventListener("keydown",this.onKeyDown);this.u4b.qB()},onHide:()=>{this.u4b.qB()},onShow:()=>{this.u4b.fy()}}):Object(S.a)(new W.a,
{contentProps:Object(S.a)(new qa.a,{container:ob,paneProps:Zb})})}}Object(z.a)(Ga,"DataCleansingReactTaskPane",null,[]);class Ba{constructor(){this.containsHiddenCells=this.onPaneLifecycleEvent=this.sendOtelEvent=this.onFeedback=this.onCustomNumberFormatOptionChosen=this.canApplySuggestion=this.onUndo=this.onForceRefresh=this.onTableSelected=this.onSuggestionRejected=this.onSuggestionApplied=this.onSuggestionValuesChanged=this.onCancelSuggestionPreview=this.onSuggestionPreview=this.onSuggestionDeselected=
this.onSuggestionSelected=null}}Object(z.a)(Ba,"DataCleansingTaskPaneCallbacks",null,[]);var fa=a(146);const Y=new Set;var ja=a(187);class ca{constructor(ob){this.TT=this.H7a=null;this.vyf=()=>{this.hideTaskPane()};this.wyf=()=>{this.qB()};this.xyf=()=>{this.fy()};this.MCf=()=>{this.updateTaskPane()};this.onSuggestionApplied=Zb=>{Zb&&this.zyj();e(1)};this.aca=()=>{this.updateTaskPane()};this.Gh=()=>{this.Ef&&this.$.da.Za(411,Zb=>{Zb.vWf()})};this.uAd=()=>{this.$.da.Za(411,Zb=>{Zb.CJj()});this.vya.uAd()};
this.$=ob;this.Ysa=new Ga(this,this.$);this.Ef=this.l6a=!1;this.vya=new L(ob);this.vya.Nmb(this.aca);this.$.da.Za(411,Zb=>{Zb.NFg(this.MCf);Zb.MFg(this.onSuggestionApplied);this.$.En.Pf(this.Gh)})}qDe(){const ob=this.$.da.za(411),Zb=null===ob||void 0===ob?void 0:ob.$Ue();this.U3g(Zb,this.ZBe(ob))}U3g(ob=null,Zb=null){let Bc=null,bd=null,Ed=null;ob&&(Bc=ob.F7f,bd=ob.ER,Ed=ob.suggestions);if(B.a.Ad(this.$))this.Ef?this.Ysa.eda():this.Ysa.AI(this.H7a,Ed,this.vya.currentState,Bc,bd,Zb);else if(this.TT)this.W2f(Ed,
Bc,bd,Zb);else if(!this.l6a){this.l6a=!0;const ge=D.GetServiceTaskFactory.Ra(this.$.da,415,416,0),be=J.a(this.$);ob=D.GetServiceTaskFactory.create(this.$.da,203,this.$.la,0);M.TaskExtensions.Aa(M.TaskExtensions.Wd([ge,be,ob],this.$.la),()=>{this.TT=ge.result;be.result.uQ(this.TT);this.SRi();this.W2f(Ed,Bc,bd,Zb)},this.$.la,3);return}U.Task.Ta(!0)}fy(){this.Ef=!0;Y.clear();this.$.da.Za(411,ob=>{ob.vWf()})}qB(){this.Ef=!1;k(this.$);this.$.da.Za(411,ob=>{ob.onSuggestionDeselected(null);ob.ddh();ob.m1b()})}dispose(){this.vya.Orc(this.aca);
H.a.Ia(this.vya);this.$.da.Za(411,ob=>{ob.Ebj(this.MCf);ob.Dbj(this.onSuggestionApplied)});this.hideTaskPane();this.TT&&(this.TT.RN(this.vyf),this.TT.DId(this.wyf),this.TT.EId(this.xyf),this.$.En.zg(this.Gh),this.TT=null);this.H7a=this.Ysa=this.$=null;this.l6a=!1}ZBe(ob){return ob?Object(S.a)(new Ba,{onSuggestionSelected:ob.onSuggestionSelected,onSuggestionDeselected:ob.onSuggestionDeselected,onSuggestionPreview:ob.onSuggestionPreview,onCancelSuggestionPreview:ob.onCancelSuggestionPreview,onSuggestionValuesChanged:ob.onSuggestionValuesChanged,
onSuggestionApplied:ob.wFi,onSuggestionRejected:ob.onSuggestionRejected,onTableSelected:ob.onTableSelected,onForceRefresh:this.uAd,onUndo:ob.GSi,canApplySuggestion:ob.canApplySuggestion,onCustomNumberFormatOptionChosen:ob.onCustomNumberFormatOptionChosen,onFeedback:()=>{d(this.$)},sendOtelEvent:f,onPaneLifecycleEvent:e,containsHiddenCells:Zb=>l(this.$,Zb)}):null}SRi(){this.H7a=this.TT.pM();this.TT.aM(this.vyf);this.TT.fUc(this.wyf);this.TT.gUc(this.xyf)}W2f(ob,Zb,Bc,bd){this.TT.ig(!0);this.Ef?(this.Ysa.vu(this.H7a,
ob,this.vya.currentState,Zb,Bc,bd),this.Ysa.eda()):(this.Ysa.AI(this.H7a,ob,this.vya.currentState,Zb,Bc,bd),this.fy())}hideTaskPane(){this.Ysa.PM();this.qB()}updateTaskPane(){this.$.da.Za(411,ob=>{if(this.Ef){const Zb=ob.$Ue();this.Ysa.vu(this.H7a,Zb.suggestions,this.vya.currentState,Zb.F7f,Zb.ER,this.ZBe(ob))}})}zyj(){this.Ef&&this.updateTaskPane()}}Object(z.a)(ca,"DataCleansingPaneManager",null,[]);class aa{constructor(ob,Zb){this.type="DataCleansingStatefulTaskPaneProps";this.annotations=[];this.callbacks=
ob;this.hostAppCallbacks=Zb}}Object(z.a)(aa,"TaskpaneProps",null,[808]);class ta{constructor(ob,Zb,Bc){this.Jc=ob;this.czb=!1;this.GB=Object(S.a)(new W.a,{width:330,title:O.a.instance.ga(1305),onOpen:()=>{this.czb=!0;Y.clear()},onClose:()=>{this.czb=!1;k(this.Jc)},onHide:()=>{this.czb=!1;k(this.Jc)},onShow:()=>{this.czb=!0;Y.clear()}});this.GB.contentProps=new aa(Zb,Bc)}kvc(ob){Object.assign(this.GB.contentProps,ob);void this.render()}render(){return Object(ja.a)(this,void 0,void 0,function*(){if(this.czb){const ob=
yield V.UISurfaces.Lj();ob.updateTaskPane("DataCleansingStatefulTaskPane",this.GB);ob.setSelectedTaskPane("DataCleansingStatefulTaskPane")}})}show(){return Object(ja.a)(this,void 0,void 0,function*(){(yield V.UISurfaces.Lj()).showTaskPane("DataCleansingStatefulTaskPane",this.GB)})}hide(){return Object(ja.a)(this,void 0,void 0,function*(){(yield V.UISurfaces.Lj()).hideTaskPane("DataCleansingStatefulTaskPane",this.GB.location)})}}Object(z.a)(ta,"DataCleansingTaskpane",null,[]);class xa{constructor(ob){this.$=
ob;this.Dxf=(Zb,Bc)=>{var bd;null===(bd=this.v4b)||void 0===bd?void 0:bd.kvc(Bc)}}qDe(){B.a.Ad?this.Jvb().then(ob=>ob.show()):G.ULS.sendTraceTag(522782367,0,10,"DataCleansingPaneManager.createOrShowDataCleansingTaskPane: Stateful taskpane is only supported in the new WacTaskPaneInfra")}dispose(){var ob;null===(ob=this.dataCleansingHostManager)||void 0===ob?void 0:ob.Orc(this.Dxf)}Jvb(){return Object(ja.a)(this,void 0,void 0,function*(){this.v4b||(this.dataCleansingHostManager=yield D.GetServiceTaskFactory.cja(this.$.da,
494,495,4),this.v4b=new ta(this.$,this.dataCleansingHostManager.callbacks,this.dataCleansingHostManager.fJg),this.v4b.kvc(this.dataCleansingHostManager.state),this.dataCleansingHostManager.Nmb(this.Dxf));return this.v4b})}}Object(z.a)(xa,"DataCleansingPaneManager",null,[]);class ia extends A.a{constructor(ob){super(ob)}yd(){I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingStatefulTaskPane",!1)?this.gd([new X(this.$,new xa(this.$))]):this.gd([new X(this.$,new ca(this.$))])}static ka(ob){A.a.Nd(417,
new ia(ob))}}Object(z.a)(ia,"DataCleansingCommandHandlerFactory",A.a,[]);var ya=a(221),ib=a(82);class wa{constructor(ob){this.a2f=ob}}Object(z.a)(wa,"DataCleansingApplyContext",null,[]);var sa=a(43);class Ya{constructor(ob,Zb,Bc){this.suggestions=ob;this.F7f=Zb;this.ER=Bc}}Object(z.a)(Ya,"DataCleansingSuggestionsResponse",null,[]);var bb=a(262),mb=a(569),Ca=a(155),$a=a(29);class Kb{constructor(ob,Zb=null){this.NYa=new Ca.a;this.uQc=this.fNc=null;this.dAd=Bc=>{Bc&&$a.a.rg(Bc.Errors)?(G.ULS.sendTraceTag(537163360,
0,10,`DataCleansingEwaSuggestion.OnOperationSuccessCallback: Ewa result contains error messages after applying type [${this.type}]`),this.NYa.setResult(null)):(G.ULS.sendTraceTag(537163359,0,50,`DataCleansingEwaSuggestion.OnOperationSuccessCallback: Suggestion of type [${this.type}] applied successfuly.`),this.NYa.setResult(Bc))};this.bAd=Bc=>{G.ULS.sendTraceTag(537163358,0,10,`DataCleansingEwaSuggestion.OnOperationFailedCallback: Ewa result contains error messages for type [${this.type}], HttpStatus [${Bc.data.httpStatus}]`);
this.NYa.setResult(null)};this.jb=ob;Zb&&(this.fNc=Zb,this.uQc=Ra(Zb.suggestionRange,!0))}get id(){return this.FN.id}get type(){return this.FN.type}get FN(){return this.fNc}get suggestionRange(){return this.uQc}get $(){return this.jb}mYi(ob,Zb){this.fNc=ob=this.E1c(ob,Zb);this.uQc=Ra(ob.suggestionRange,!0)}}Object(z.a)(Kb,"DataCleansingEwaSuggestion",null,[]);var rb=a(368),cc=a(170);class nc{constructor(){this.bottom=this.top=this.right=this.left=0}}Object(z.a)(nc,"RangeAddress",null,[]);const Wb=
ob=>Object(S.a)(new nc,{left:ob.left,right:ob.right,top:ob.top,bottom:ob.bottom});var Ea=a(61);const ua=(ob,Zb,Bc,bd,Ed,ge,be,qe=null)=>{qe=ob.Na(9,qe);qe.ranges=Zb;qe.trimWhitespaceType=Bc;return Ea.g(ob,"TrimWhitespace",qe,bd,Ed,ge,be,0)};var ma=a(280),fb=a(21),sb=a(338);class Ua{constructor(){this.id=null;this.type=0;this.columnName=this.columnIdentifier=this.suggestionRange=this.suggestionRangeStringRef=this.tableIdentifier=this.tableRange=this.tableName=null}}Object(z.a)(Ua,"DataCleansingSuggestion",
null,[]);class ab extends Ua{constructor(){super();this.extraSpacesType=0;this.ranges=null}}Object(z.a)(ab,"ExtraSpacesSuggestion",Ua,[]);class na extends Kb{constructor(ob,Zb=null){super(ob,Zb)}Did(ob){const Zb=this.Cua();Zb&&fb.g(this.$).lb.vv(sb.a.d7(Pa.d(this.$.pa),Object(sa.W)(Zb)),ob,!0,void 0,!0)}Cua(){const ob=this.FN;ob||G.ULS.sendTraceTag(537163405,0,10,"ExtraSpacesEwaSuggestion.HighlightOnGrid: suggestion cast failure, should not happen");const Zb=[];for(const Bc of ob.ranges)Zb.push(Ra(Bc,
!1));if(0<Zb.length)return Zb}uYc(){return!0}apply(){const ob=this.FN,Zb=new wa(!0);rb.a(this.$.userOperationManager,(Bc,bd,Ed)=>ua(this.$.oa.va,Object(sa.u)(this.$.activeItemName,null,bb.a.map(ob.ranges,ge=>Ra(ge,!1))),na.d2g(ob.extraSpacesType),ma.b(Bc,this.dAd),ma.a(bd,this.bAd),Ed,Zb),Bc=>new cc.a(253,0,Bc),null);return R.d(this.NYa.task).then(Bc=>({result:Bc.Result,Ana:!0}))}E1c(ob,Zb){if(!ob)return G.ULS.sendTraceTag(537163404,0,10,"ExtraSpacesEwaSuggestion.ConvertToPaneSuggestion: suggestion cast failure, should not happen"),
null;Zb=Object(S.a)(new ab,{id:mb.a.create().toString(),type:2,tableRange:Zb.tableRange,tableName:Zb.tableName,columnName:Zb.m0c,extraSpacesType:this.eWi(ob.extraSpacesType),ranges:[]});var Bc=Wb(ob.suggestionRange);Zb.suggestionRange=Bc;Bc=Ra(Bc,!0);Zb.suggestionRangeStringRef=Bc.hz(!1);for(const bd of ob.ranges)Zb.ranges.push(Wb(bd));return Zb}eWi(ob){switch(ob){case "Leading":return 0;case "Trailing":return 1;case "InBetween":return 2;default:throw G.ULS.sendTraceTag(537163403,0,10,"ExtraSpacesEwaSuggestion.ParseStringToExtraSpacesType: received illegal extra spaces type."),
Error.argument("illegal extra spaces type");}}static d2g(ob){switch(ob){case 0:return 1;case 2:return 2;case 1:return 4;default:throw G.ULS.sendTraceTag(537163402,0,10,"ExtraSpacesEwaSuggestion.ConvertExtraSpacesTypeToTrimWhitespaceType: received illegal ExtraSpacesPaddingType."),Error.argument("illegal ExtraSpacesPaddingType");}}}Object(z.a)(na,"ExtraSpacesEwaSuggestion",Kb,[]);var Na=a(769);class Va extends Ua{constructor(){super();this.isMixedNumberText=this.variationsType=this.formats=this.replacementFormat=
this.suggestedFormat=null}}Object(z.a)(Va,"NumberFormatInconsistencySuggestion",Ua,[]);class Sa extends Kb{constructor(ob,Zb,Bc=null){super(ob,Bc);this.lqe=!1;this.ug=Zb}Did(ob){const Zb=this.Cua();Zb&&fb.g(this.$).lb.vv(sb.a.d7(Pa.d(this.$.pa),Object(sa.W)(Zb)),ob,!0,void 0,!1);fb.g(this.$).lb.update(!1)}Cua(){const ob=this.FN;ob||G.ULS.sendTraceTag(537163401,0,10,"NumberFormattingEwaSuggestion.HighlightOnGrid: suggestion cast failure, should not happen");const Zb=[];for(const Bc of ob.formats)if(Bc.ranges&&
0<Bc.ranges.length)for(const bd of Bc.ranges)(Bc.format!==ob.replacementFormat||I.EwaSettings.isChangeGateEnabled("OfficeVSO:6401137_DataClensingStringTypeAsNonTextFix")&&!Bc.isApplicable)&&Zb.push(Ra(bd,!1));if(0<Zb.length)return Zb}uYc(){return!this.lqe}apply(){const ob=this.FN;var Zb=this.Cua();if(!Zb)return G.ULS.sendTraceTag(524940618,0,10,"NumberFormattingEwaSuggestion.apply: empty bad ranges."),Promise.resolve({result:0,Ana:!1});const Bc=new wa(!0),bd={},Ed=ob.formats.find(({key:ze})=>ze===
ob.replacementFormat).format;bd.NumberFormatOptions=Sa.E2g(Ed);bd.ValidMembers=32;bd.NumberFormat=15;const ge=Object(sa.u)(this.$.pa.sheetName,null,Zb);Zb=fb.g(this.$);const be=Object(sa.o)(Zb.ha.sa.activeCell,this.$),qe=this.$.oa.va.Sb({MZ:!0,dZ:1});rb.a(this.$.userOperationManager,(ze,Ce,Ve)=>Ea.l(this.$.oa.va,ge,be,bd,!1,null,null,!0,ma.b(ze,this.dAd),ma.a(Ce,this.bAd),Ve,Bc,qe,null),ze=>new cc.a(11,0,ze),null);return R.d(this.NYa.task).then(()=>({result:-1,Ana:!0}))}E1c(ob,Zb){if(!ob)return G.ULS.sendTraceTag(537163400,
0,10,"NumberFormattingEwaSuggestion.ConvertToPaneSuggestion: suggestion cast failure, should not happen"),null;var Bc=ob.suggestedFormat.value;const bd=this.zUe(Bc);Zb=Object(S.a)(new Va,{id:mb.a.create().toString(),type:1,tableRange:Zb.tableRange,tableName:Zb.tableName,columnName:Zb.m0c,replacementFormat:Bc,suggestedFormat:Bc,formats:[],variationsType:this.fWi(ob.variationsType)});Bc=Wb(ob.suggestionRange);Zb.suggestionRange=Bc;Bc=Ra(Bc,!0);Zb.suggestionRangeStringRef=Bc.hz(!1);this.zpe(bd,ob.suggestedFormat,
Zb);for(var Ed of ob.otherFormats)ob=this.zUe(Ed.value),this.zpe(ob,Ed,Zb);Ed=this.Jzh(Zb);Zb.suggestedFormat=Ed;Zb.replacementFormat=Ed;Ed||(this.lqe=!0);return Zb}Jzh(ob){if(ob=ob.formats.find(Zb=>Zb.isApplicable))return ob.format}zpe(ob,Zb,Bc){ob={value:ob,ranges:[],isApplicable:ob?Zb.isApplicable:!1,format:Zb.value,key:Zb.value};this.vvc(ob,Zb.ranges);Bc.formats.push(ob)}zUe(ob){if(!Sa.Ntb.has(ob)){const Zb=this.ug.xTe("1234.56",ob,244,"12px sans-serif");Zb.success?(Array.from(Sa.Ntb.values()).find(Bc=>
Bc==Zb.Nx)&&G.ULS.sendTraceTag(524170578,0,50,"Duplicated friendly format string for different formats."),Sa.Ntb.set(ob,Zb.Nx)):(G.ULS.sendTraceTag(537163399,0,50,"NumberFormattingEwaSuggestion.GenerateFriendlyFormatString: Failed to acquire friendly format string"),Sa.Ntb.set(ob,""))}return Sa.Ntb.get(ob)}vvc(ob,Zb){for(const Bc of Zb)Zb=Wb(Bc),ob.ranges.push(Zb)}static E2g(ob){return Object(S.a)(new Na.a,{NumberFormatCategory:-1,CustomFormatString:ob})}fWi(ob){switch(ob){case "AllNumber":return 0;
case "AllText":return 1;case "MixedNumberAndText":return 2;default:throw G.ULS.sendTraceTag(529105823,0,10,"NumberFormattingEwaSuggestion.ParseStringToNumberFormatVariationsType: received illegal variations type."),Error.argument("illegal variations type");}}}Sa.Ntb=new Map;Object(z.a)(Sa,"NumberFormattingEwaSuggestion",Kb,[]);var vb=a(247),Oa=a(79);class yb extends Kb{constructor(ob,Zb=null){super(ob,Zb)}Did(ob){const Zb=this.Cua();Zb&&fb.g(this.$).lb.vv(sb.a.d7(Pa.d(this.$.pa),Object(sa.W)(Zb)),
ob,!0,void 0,!1);fb.g(this.$).lb.update(!1)}Cua(){const ob=this.FN;ob||G.ULS.sendTraceTag(537163392,0,10,"TextInconsistencyEwaSuggestion.HighlightOnGrid: suggestion cast failure, should not happen");const Zb=this.M2e(Bc=>Bc.isSelected&&Bc.value!==ob.replacementValue,!1);if(0<Zb.length)return Zb}uYc(){const ob=this.FN;return bb.a.any(ob.variations,Zb=>Zb.isSelected&&Zb.value!==ob.replacementValue)&&!!ob.replacementValue}apply(){const ob=this.FN,Zb=this.aK(),Bc=this.M2e(be=>be.isSelected&&be.value!==
ob.replacementValue),bd=ob.variations.every(be=>be.value!==ob.replacementValue),Ed=new wa(!bd&&!0);rb.a(this.$.userOperationManager,(be,qe,ze)=>vb.w(this.$.oa.va,Zb,Object(sa.u)(this.$.pa.sheetName,null,Bc),ob.replacementValue,ma.b(be,this.dAd),ma.a(qe,this.bAd),ze,Ed),be=>new cc.a(258,0,be),null);const ge=ob.variations.filter(be=>be.isSelected&&be.value!==ob.replacementValue).length;return R.d(this.NYa.task).then(()=>({result:ge,Ana:!0}))}E1c(ob,Zb){if(!ob)return G.ULS.sendTraceTag(537163361,0,10,
"TextInconsistencyEwaSuggestion.ConvertToPaneSuggestion: suggestion cast failure, should not happen"),null;Zb={id:mb.a.create().toString(),type:0,tableRange:Zb.tableRange,tableName:Zb.tableName,columnName:Zb.m0c,normalizedValue:ob.normalizedValue,suggestedValue:ob.suggestedValue.value,replacementValue:ob.suggestedValue.value,variations:[],tableIdentifier:null,suggestionRange:null,suggestionRangeStringRef:null,columnIdentifier:null};var Bc=Wb(ob.suggestionRange);Zb.suggestionRange=Bc;Bc=Ra(Bc,!0);
Zb.suggestionRangeStringRef=Bc.hz(!1);Bc={value:ob.suggestedValue.value,ranges:[],isSelected:!1};this.vvc(Bc,ob.suggestedValue.ranges);Zb.variations.push(Bc);for(const bd of ob.variations)ob={value:bd.value,ranges:[],isSelected:!0},this.vvc(ob,bd.ranges),Zb.variations.push(ob);return Zb}vvc(ob,Zb){for(const Bc of Zb)Zb=Wb(Bc),ob.ranges.push(Zb)}aK(){const ob=this.FN,Zb=Oa.select(Oa.where(Oa.asEnumerable(ob.variations),bd=>bd.isSelected&&bd.value!==ob.replacementValue),bd=>bd.value),Bc={ExcludeFormulaResult:!0,
MatchCase:!0,MatchEntireCell:!0,SearchAllSheets:!1};Bc.SearchStrings=Oa.toArray(Zb);Bc.SearchUp=!1;Bc.SheetName=this.$.pa.sheetName;return Bc}M2e(ob,Zb=!0){const Bc=[],bd=this.FN;for(const Ed of bd.variations)Ed.ranges&&ob(Ed)&&Bc.push(...bb.a.map(Ed.ranges,ge=>Ra(ge,Zb)));return Bc}}Object(z.a)(yb,"TextInconsistencyEwaSuggestion",Kb,[]);const Ob=(ob,Zb,Bc,bd)=>{try{switch(Bc.type){case "TextInconsistency":return Ja(Bc,bd,()=>new yb(ob));case "ExtraSpaces":return Ja(Bc,bd,()=>new na(ob));case "NumberFormattingInconsistency":return Ja(Bc,
bd,()=>new Sa(ob,Zb));default:return G.ULS.sendTraceTag(537163424,0,10,"DataCleansingEwaSuggestionFactory.CreateFromTableLintSuggestion: suggestion type is not supported - "+Bc.type),null}}catch(Ed){return G.ULS.sendTraceTag(537163423,0,10,"DataCleansingEwaSuggestionFactory.CreateFromTableLintSuggestion: exception thrown"),null}},Ja=(ob,Zb,Bc)=>{Bc=Bc();Bc.mYi(ob,Zb);return Bc};class lb extends T.a{constructor(ob){super();this.Jz=new Map;this.Ska=new Map;this.vZb=new Map;this.NKc=null;this.Gda=new Map;
this.$=ob}get sif(){return this.NKc}get kje(){var ob=this.$.xa.pa.sheetId;const Zb=[];if(!this.Jz.has(ob))return Zb;ob=this.Jz.get(ob);for(let Bc of ob.keys())this.ZUe(Bc).length&&Zb.push(Bc);return Zb}get izg(){const ob=this.$.xa.pa.sheetId;return this.Gda.has(ob)?this.Gda.get(ob):0}get fGj(){return this.Gda.keys()}m1b(){this.Ska=new Map}eXg(){this.vZb=new Map;this.NKc=null}applySuggestion(ob){ob&&this.vZb.set(ob.id,ob)}xxe(ob){const Zb=this.Gda.get(ob);if(2===Zb||5===Zb)I.EwaSettings.isChangeGateEnabled("OfficeVSO:6443391_InfiniteLoadingOnSwitchingSheets")?
G.ULS.sendTraceTag(537163407,0,50,`DataCleansingSuggestionsCollection.clearAllSuggestions: Clearing all suggestions for sheet ${ob}. Suggestions status=${Zb}.`):G.ULS.sendTraceTag(521213260,0,50,"DataCleansingSuggestionsCollection.clearAllSuggestions: Clearing all suggestions."),this.m1b(),this.FXg(),this.eXg()}lAi(ob,Zb){this.Ska.set(ob,Zb)}onSuggestionApplied(ob){this.NKc=ob}FSi(ob){this.vZb.delete(ob)}Fm(ob,Zb){if(this.Jz.has(ob)&&(ob=this.Jz.get(ob),ob.has(Zb))){Zb=ob.get(Zb);for(let Bc of Zb.values())return Ra(Bc.FN.tableRange,
!0)}return null}xmi(ob,Zb){return this.Jz.has(ob)?this.Jz.get(ob).has(Zb):!1}ZUe(ob){const Zb=[];if(!ob)return Zb;var Bc=this.$.xa.pa.sheetId;if(!this.Jz.has(Bc))return Zb;Bc=this.Jz.get(Bc);if(Bc.has(ob)){ob=Bc.get(ob);for(let bd of ob.keys())this.vZb.has(bd)||(this.Ska.has(bd)?Zb.push(this.Ska.get(bd).FN):Zb.push(ob.get(bd).FN))}return Zb}V3a(ob){return this.Ska.has(void 0)?this.Ska.get(void 0):this.Jz.has(ob)&&(ob=this.Jz.get(ob),ob.has(void 0)&&(ob=ob.get(void 0),ob.has(void 0)))?ob.get(void 0):
null}vXh(ob){if(this.Ska.has(ob))return this.Ska.get(ob);for(const Zb of this.Jz.values())for(const Bc of Zb.values())if(Bc.has(ob))return Bc.get(ob);return null}AOd(ob,Zb,Bc){if(Bc){this.xxe(ob);this.Gda.set(ob,1);for(const bd of Bc)this.yCg(ob,Zb,bd)}}aId(ob,Zb,Bc){this.r$i(ob,Zb,Bc);this.Ska.delete(Bc.id)}s_f(ob,Zb){this.Gda.set(Zb,ob);G.ULS.sendTraceTag(537163406,0,50,`DataCleansingSuggestionsCollection.setAllSheetsSuggestionsStatus: Setting the suggestions status of sheet id ${Zb} to ${ob}.`)}ofd(ob){return this.Gda.get(ob)}xWh(ob){let Zb=
0;if(this.Jz.has(ob)){ob=this.Jz.get(ob);for(const [,Bc]of ob)Zb+=Bc.size}return Zb}FXg(){this.Jz=new Map;this.Gda=new Map}r$i(ob,Zb,Bc){if(this.Jz.has(ob)){const bd=this.Jz.get(ob);if(bd.has(Zb)){const Ed=bd.get(Zb);Ed.has(Bc.id)&&(Ed.delete(Bc.id),Ed.size||bd.delete(Zb),bd.size||this.Jz.delete(ob))}}}yCg(ob,Zb,Bc){this.Jz.has(ob)||this.Jz.set(ob,new Map);const bd=this.Jz.get(ob);bd.has(Zb)||this.Jz.get(ob).set(Zb,new Map);bd.get(Zb).set(Bc.id,Bc)}}Object(z.a)(lb,"DataCleansingSuggestionsCollection",
T.a,[]);var Pb=a(721),Jb=a(695);class Lb extends Pb.a{constructor(){super();this.columnIdentifier=this.tableIdentifier=this.tableRange=this.tableName=this.worksheetName=this.worksheetId=null;this.H_=Object.assign(new Jb.a,{T_:Lb.getTypeName(),B_:Lb.Pd()})}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotationBase"}static Pd(){return["AugLoop_Core_Annotation"]}}Object(z.a)(Lb,"TableLintAnnotationBase",Pb.a,[]);class Ab extends Lb{constructor(){super();this.investigationTelemetry=this.suggestions=
this.columnName=this.columnTitle=null;this.H_=Object.assign(new Jb.a,{T_:Ab.getTypeName(),B_:Ab.Pd()})}static getTypeName(){return"AugLoop_Tablelint_TableLintColumnAnnotation"}static Pd(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}}Object(z.a)(Ab,"TableLintColumnAnnotation",Lb,[]);class nb extends Pb.a{constructor(){super();this.worksheetId=null;this.errorCount=this.suggestionsCount=0;this.unsupportedFeaturesSet=null;this.H_=Object.assign(new Jb.a,{T_:nb.getTypeName(),
B_:nb.Pd()})}static getTypeName(){return"AugLoop_Tablelint_TableLintWorksheetAggregateAnnotation"}static Pd(){return["AugLoop_Core_Annotation"]}}Object(z.a)(nb,"TableLintWorksheetAggregateAnnotation",Pb.a,[]);class va extends Lb{constructor(){super();this.errorCategory=this.errorType=this.investigationTelemetry=this.columnName=this.columnTitle=null;this.H_=Object.assign(new Jb.a,{T_:va.getTypeName(),B_:va.Pd()})}static getTypeName(){return"AugLoop_Tablelint_TableLintErrorAnnotation"}static Pd(){return["AugLoop_Tablelint_TableLintAnnotationBase",
"AugLoop_Core_Annotation"]}}Object(z.a)(va,"TableLintErrorAnnotation",Lb,[]);class db extends Lb{constructor(){super();this.unsupportedFeatures=this.investigationTelemetry=this.columnName=this.columnTitle=null;this.H_=Object.assign(new Jb.a,{T_:db.getTypeName(),B_:db.Pd()})}static getTypeName(){return"AugLoop_Tablelint_TableLintUnsupportedFeatureAnnotation"}static Pd(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}}Object(z.a)(db,"TableLintUnsupportedFeatureAnnotation",
Lb,[]);class Xa extends T.a{constructor(ob){super();this.uga=!1;this.D7f=(Zb,Bc)=>{if(Zb=Bc.rJ)switch(Bc.operationType){case 1:case 2:this.raiseEvent("carek",Zb);break;case 3:this.raiseEvent("caiek",Zb);break;default:G.ULS.sendTraceTag(537163396,306,15,`TableLintManager.TableLintColumnAnnotationHandler Received unexpected OperationType:${Bc.operationType}`)}else G.ULS.sendTraceTag(537163397,306,50,"TableLintManager.TableLintColumnAnnotationHandler TableLintColumnAnnotation is null.")};this.E7f=(Zb,
Bc)=>{if(Bc.rJ)switch(Bc.operationType){case 1:case 2:this.raiseEvent("aarek",Bc.rJ);break;case 3:break;default:G.ULS.sendTraceTag(537163394,306,15,`TableLintManager.TableLintAnnotationHandler Received unexpected OperationType:${Bc.operationType}`)}else G.ULS.sendTraceTag(537163395,306,50,"TableLintManager.TableLintWorksheetAggregateAnnotationHandler TableLintWorksheetAggregateAnnotation is null.")};this.iHj=(Zb,Bc)=>{G.ULS.sendTraceTag(537163393,306,50,`TableLintManager.TableLintColumnAnnotationStateUpdateHandler Received state update: ${Zb}->${Bc}`)};
this.augmentationLoopManager=ob}$Wb(){this.uga?G.ULS.sendTraceTag(537163398,0,50,"TableLintManager.ActivateEvents: Events are already registered"):(this.z8i(),this.uga=!0)}dispose(){this.uga&&(this.dPj(),this.uga=!1)}Mle(ob){this.addHandler("carek",ob)}pPf(ob){this.removeHandler("carek",ob)}Gle(ob){this.addHandler("aarek",ob)}ePf(ob){this.removeHandler("aarek",ob)}rDg(ob){this.addHandler("caiek",ob)}L$i(ob){this.removeHandler("caiek",ob)}z8i(){G.ULS.sendTraceTag(574482312,0,50,"TableLintManager.RegisterTableLintEvents: activate annotations");
this.augmentationLoopManager.activateAnnotation(Ab.getTypeName(),this.iHj);this.augmentationLoopManager.activateAnnotation(nb.getTypeName());this.augmentationLoopManager.O1.bP("Valid",Ab.getTypeName(),this.D7f);this.augmentationLoopManager.O1.bP("Valid",nb.getTypeName(),this.E7f);this.augmentationLoopManager.activateAnnotation(va.getTypeName());this.augmentationLoopManager.activateAnnotation(db.getTypeName())}dPj(){this.augmentationLoopManager.O1.IPa("Valid",Ab.getTypeName(),this.D7f);this.augmentationLoopManager.O1.IPa("Valid",
nb.getTypeName(),this.E7f)}}Object(z.a)(Xa,"TableLintManager",T.a,[2]);class gb{constructor(ob,Zb,Bc,bd){this.tableName=ob;this.columnName=Zb;this.columnTitle=Bc;this.tableRange=bd}get m0c(){const ob=String.format(O.a.instance.ob(178),this.columnTitle);return this.columnName?`${ob} (${this.columnName})`:ob}}Object(z.a)(gb,"ColumnMetadata",null,[]);class Ha{constructor(ob,Zb,Bc,bd){this.jmf=[];this.CDb=(Ed,ge)=>{this.dataCleansingManager.AOd(ge.worksheetId,ge.tableName,this.WDe(ge))};this.pDb=(Ed,
ge)=>{this.Lsi(ge);this.dataCleansingManager.Osj(ge.worksheetId)};this.itf=(Ed,ge)=>{this.dataCleansingManager.aId(ge.worksheetId,ge.tableName,this.WDe(ge)[0])};this.dataCleansingManager=ob;this.$=bd;this.ug=Bc;this.LD=Zb;this.LD.Mle(this.CDb);this.LD.Gle(this.pDb);this.LD.rDg(this.itf)}dispose(){this.LD.pPf(this.CDb);this.LD.ePf(this.pDb);this.LD.L$i(this.itf)}Lsi(ob){this.jmf.includes(ob.worksheetId)||(this.jmf.push(ob.worksheetId),G.ULS.sendTraceTag(521200220,0,50,`AnnotationsHandler.logAggregateAnnotationStatus aggregated information:
        ${JSON.stringify({["suggestionCount"]:ob.suggestionsCount,["errorsCount"]:ob.errorCount,["unsupportedFeaturesCount"]:ob.unsupportedFeaturesSet.length,["unsupportedFeatures"]:ob.unsupportedFeaturesSet.join(",")})}`))}WDe(ob){const Zb=[],Bc=new gb(ob.tableName,ob.columnName,ob.columnTitle,Wb(ob.tableRange));for(const bd of ob.suggestions)(ob=Ob(this.$,this.ug,bd,Bc))&&Zb.push(ob);return Zb}}Object(z.a)(Ha,"AnnotationsHandler",null,[2]);var tb=a(97);class bc extends Sys.EventArgs{constructor(ob,
Zb){super();this.sheetId=ob;this.Gda=Zb}}Object(z.a)(bc,"DataCleansingSuggestionStatusChangedEventArgs",Sys.EventArgs,[]);var tc=a(90);class Ma extends T.a{constructor(ob,Zb,Bc){var bd,Ed,ge;super();this.FWc=[45];this.LD=this.Ooe=this.ER=null;this.eic=0;this.Q3f=this.Xvc=!1;this.timestamps={Qbb:0,K8b:0,NAb:0,Cdb:0};this.onSuggestionSelected=be=>{(be=this.V3a(be))?(this.s7e(be),this.PAi(be)):G.ULS.sendTraceTag(537163416,0,10,"DataCleansingManager.OnSuggestionSelected: Attempted to highlight missing suggestion")};
this.onSuggestionDeselected=()=>{this.Swb()};this.onSuggestionPreview=be=>{(be=this.V3a(be))?this.s7e(be):G.ULS.sendTraceTag(537163415,0,10,"DataCleansingManager.OnSuggestionPreview: Attempted to highlight missing suggestion")};this.onCancelSuggestionPreview=()=>{this.Swb()};this.onSuggestionValuesChanged=be=>{G.ULS.sendTraceTag(537163414,0,50,`DataCleansingManager.OnSuggestionValuesChanged: Change in suggestion of type [${be.type}]`);a:{var qe=this.$,ze=this.ug;switch(be.type){case 0:be=new yb(qe,
be);break a;case 2:be=new na(qe,be);break a;case 1:be=new Sa(qe,ze,be);break a;default:G.ULS.sendTraceTag(537163422,0,10,"DataCleansingEwaSuggestionFactory.CreateFromPaneSuggestion: suggestion type is not supported"),be=null}}this.suggestions.lAi(be.id,be);this.onSuggestionSelected(be.id);this.raiseEvent("oscek")};this.wFi=be=>{const qe=this.V3a(be);if(!qe)return G.ULS.sendTraceTag(537163413,0,10,"DataCleansingManager.OnSuggestionApplied: Attempted to apply non-existant suggestion"),Promise.reject();
I.EwaSettings.isChangeGateEnabled("OfficeVSO:6808053_DCHiddenCellsTelemetry")&&void l(this.$,[qe.suggestionRange]).then(ze=>{ze.length&&G.ULS.sendTraceTag(512501985,0,50,"DataCleansingManager.OnSuggestionApplied: suggestion with hidden cells applied")});be=(I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingNewApply",!1)?m(this.$,qe.FN,qe.Cua()):qe.apply()).then(ze=>{ze.Ana&&(this.Swb(),this.suggestions.applySuggestion(qe),qe.id===this.suggestions.sif?this.raiseEvent("osaek",
void 0,qe):this.raiseEvent("oscek"));return ze.result});this.suggestions.onSuggestionApplied(qe.id);return be};this.onCustomNumberFormatOptionChosen=be=>this.V3a(be)?new Promise(qe=>{b(this.$,ze=>{qe(ze);G.ULS.sendTraceTag(523548835,0,50,`DataCleansingManager.onCustomNumberFormatOptionChosen: user closed the NumberFormatDialog while clicking on ${ze?"OK":"Cancel"} button.`)})}):(G.ULS.sendTraceTag(523548864,0,10,`DataCleansingManager.onCustomNumberFormatOptionChosen: Attempted to choose non-existant suggestion. suggestionId: ${be}`),
Promise.reject(`Couldn't find the suggestion with the requested id. id: ${be}`));this.GSi=()=>{const be=this.suggestions.sif;return c(this.$).then(qe=>{qe&&(this.suggestions.FSi(be),this.raiseEvent("oscek"))})};this.canApplySuggestion=be=>{be=this.V3a(be);return be?be.uYc():(G.ULS.sendTraceTag(537163412,0,10,"DataCleansingManager.CanApplySuggestion: Did not find suggestion in collection"),!1)};this.onSuggestionRejected=()=>{};this.onTableSelected=be=>{if(!this.S6a||this.ER!==be){this.Swb();this.ER=
be;this.S6a=!0;be=this.suggestions.Fm(this.$.pa.sheetId,be);if(!be)throw Error.argument("Table does not exist in suggestion collection");fb.g(this.$).Dg(sa.v(be,this.$),be.topLeft,null,null,0,tb.a.dataCleansing);this.VFj();this.raiseEvent("oscek")}};this.Vc=()=>{this.r5c()};this.yTi=be=>{be instanceof wa?(G.ULS.sendTraceTag(526410371,0,50,`DataCleansingManager.OnWorkbookChangedEventHandler: Suggestion applied with shouldSkipRefresh=${be.a2f}`),be=be.a2f?6:5):(this.DJj(),G.ULS.sendTraceTag(526410370,
0,50,"DataCleansingManager.OnWorkbookChangedEventHandler: Invalidating all existing suggestions since the workbook changed"),be=2);for(let qe of this.suggestions.fGj)this.suggestions.s_f(be,qe),this.raiseEvent("osscek",new bc(qe,this.suggestions.ofd(qe)))};this.X_d=(be,qe)=>{be=JSON.stringify(qe.coauthVersion);G.ULS.sendTraceTag(524817559,0,50,`DataCleansingManager.WorkbookCoauthVersionChangedEventHandler: Workbook changed, revision record is now ${be}`);this.yTi(qe.userContext)};this.V8a=()=>{G.ULS.sendTraceTag(523257923,
0,50,"DataCleansingManager.onAugmentationLoopSessionClose: Received augmentation loop session close.");this.Xvc&&(this.bhf=!0,this.raiseEvent("ueek"))};this.Gh=()=>{this.showCallout()};this.$=Bc;this.augmentationLoopManager=ob;this.ug=Zb;this.suggestions=new lb(Bc);this.S6a=!1;this.Xsa=this.augmentationLoopManager?0:2;this.bhf=!1;null===(Ed=null===(bd=this.augmentationLoopManager)||void 0===bd?void 0:bd.O1)||void 0===Ed?void 0:Ed.Zje(this.X_d);null===(ge=this.augmentationLoopManager)||void 0===ge?
void 0:ge.EXb(this.V8a);I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTeachingCallout",!1)&&this.$.En.Pf(this.Gh)}get status(){return this.Xsa}get jld(){return!this.bhf}NFg(ob){this.addHandler("oscek",ob)}Ebj(ob){this.removeHandler("oscek",ob)}MFg(ob){this.addHandler("osaek",ob)}Dbj(ob){this.removeHandler("osaek",ob)}JGg(ob){this.addHandler("osscek",ob)}tcj(ob){this.removeHandler("osscek",ob)}QGg(ob){this.addHandler("ueek",ob)}zcj(ob){this.removeHandler("ueek",ob)}initialize(){2===
this.Xsa?G.ULS.sendTraceTag(537163421,0,50,"DataCleansingManager.Initialize: skipping initialization since manager status is Error"):I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TableLintExperiment",!1)||I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)?(G.ULS.sendTraceTag(574408774,0,50,"DataCleansingManager.Initialize: activate tablelint events"),this.Xsa=1,this.$ie()):I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TableLintProdExperiment",
!1)&&(G.ULS.sendTraceTag(537163420,0,50,"DataCleansingManager.Initialize: Check license for activating tablelint events"),ib.a.instance.Wb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ob=>{ob.isFeatureEnabled("ExcelIntelligence",!1).then(Zb=>{Zb&&(G.ULS.sendTraceTag(537163419,0,50,"DataCleansingManager.Initialize: LicenseEnabled - activate tablelint events"),this.Xsa=1,this.$ie());return Zb})}))}F9b(){return 2===this.Xsa?3:this.suggestions.izg}$Ue(){this.uli||this.rZf();
return new Ya(this.suggestions.ZUe(this.ER),this.suggestions.kje,this.ER)}vWf(){this.rZf();if(this.ER)this.onTableSelected(this.ER)}AOd(ob,Zb,Bc){if(0===this.Xsa||1===this.Xsa)G.ULS.sendTraceTag(537163418,0,50,"DataCleansingManager.SetSuggestions: Setting data cleansing manager status to Ready"),this.Xsa=3;6!==this.F9b()&&(this.suggestions.AOd(ob,Zb,Bc),this.raiseEvent("osscek",new bc(ob,this.suggestions.ofd(ob))))}aId(ob,Zb,Bc){this.suggestions.aId(ob,Zb,Bc);this.raiseEvent("oscek")}Osj(ob){this.Jvi();
G.ULS.sendTraceTag(537163417,0,50,`DataCleansingManager.SetSuggestionsReady: the suggestions of sheet id ${ob} are ready.`);I.EwaSettings.isChangeGateEnabled("OfficeVSO:6443391_InfiniteLoadingOnSwitchingSheets")&&this.suggestions.xxe(ob);6!==this.F9b()&&(this.suggestions.s_f(4,ob),this.raiseEvent("osscek",new bc(ob,this.suggestions.ofd(ob))));ob===this.$.pa.sheetId&&this.showCallout()}ddh(){this.S6a&&this.r5c();this.ER=null}m1b(){this.suggestions.m1b()}dispose(){this.augmentationLoopManager.O1.lOf(this.X_d);
this.S6a&&this.$&&this.vbg();H.a.Ia(this.Ooe);H.a.Ia(this.LD);super.dispose()}CJj(){this.timestamps.Cdb?(G.ULS.sendTraceTag(523903316,0,50,'DataCleansingManager.timestampSeeNewChangesClicked "see new changes" clicked after suggestions were loaded'),this.timestamps.Qbb=0):this.timestamps.Qbb=performance.now()}DJj(){var ob;this.timestamps.Qbb=0;this.timestamps.Cdb=0;(ob=this.timestamps).K8b||(ob.K8b=performance.now());this.timestamps.NAb=performance.now()}Jvi(){var ob;this.timestamps.Cdb=performance.now();
if(this.timestamps.NAb){const Zb=this.timestamps.Cdb-(null!==(ob=this.timestamps.K8b)&&void 0!==ob?ob:this.timestamps.NAb);ob=JSON.stringify({["timeElapsedSinceFirstManualChange"]:Zb,["timeElapsedSinceLastManualChange"]:this.timestamps.Cdb-this.timestamps.NAb,["timeElapsedSinceSeeNewChangesClick"]:this.timestamps.Qbb?this.timestamps.Cdb-this.timestamps.Qbb:0});G.ULS.sendTraceTag(523903315,0,50,`DataCleansingManager.logTimeElapsedTillSuggestionsReady suggestion appears timers:
        ${ob}`)}this.timestamps.NAb=0;this.timestamps.K8b=0;this.timestamps.Qbb=0}$ie(){this.LD=new Xa(this.augmentationLoopManager);this.Ooe=new Ha(this,this.LD,this.ug,this.$);this.LD.$Wb()}VFj(){fb.g(this.$).ha.lE(this.Vc);fb.g(this.$).hC(this.Vc)}vbg(){fb.g(this.$).ha.nI(this.Vc);fb.g(this.$).AD(this.Vc)}afh(){if(this.S6a){const ob=this.suggestions.Fm(this.$.pa.sheetId,this.ER).topLeft;fb.g(this.$).ha.Lw([ob],0,ob,0);this.r5c()}}r5c(){this.S6a=!1;this.vbg()}PAi(ob){ob=ob.Cua();if(null===ob||void 0===
ob?0:ob.length)[{topLeft:ob}]=ob.sort((Zb,Bc)=>Zb.top<Bc.top?-1:Zb.top>Bc.top?1:0),fb.g(this.$).nK(ob)||(G.ULS.sendTraceTag(523547680,0,50,"DataCleansingManager.moveViewportToSuggestionIfNeeded moving viewport"),fb.g(this.$).dt(ob,0,tb.a.dataCleansing))}s7e(ob){this.afh();this.Swb();ob.Did(this.FWc)}Swb(){fb.g(this.$).lb.Mg(this.FWc);fb.g(this.$).lb.oi(null,this.FWc,!1);fb.g(this.$).lb.update(!1)}rZf(){this.ER=this.suggestions.kje[0]}get uli(){return this.ER&&this.suggestions.xmi(this.$.pa.sheetId,
this.ER)}V3a(ob){return this.suggestions.vXh(ob)}showCallout(){if(!this.Q3f&&I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTeachingCallout",!1)){var ob=this.F9b();if(6===ob||4===ob)if(ob=this.suggestions.xWh(this.$.pa.sheetId),2>ob)G.ULS.sendTraceTag(521410393,0,50,`DataCleansingManager.showCallout: suggestion count(${ob}) is below threshold to show teaching callout`);else{var Zb=new tc.a(-847286761,oa.a.Eb,this.$.Mc,0,pa.a.KV),Bc={};Bc.SuggestionsCount=ob;Bc.CalloutName=
16;this.Q3f=!0;this.$.Ka.Mb(Zb,Bc)}}}}Object(z.a)(Ma,"DataCleansingManager",T.a,[695,2]);class Tb extends ya.a{constructor(ob){super();this.$=ob;this.Fb()}create(){const ob=D.GetServiceTaskFactory.Ra(this.$.da,328,327,1),Zb=D.GetServiceTaskFactory.create(this.$.da,18,this.$.la,1);M.TaskExtensions.Aa(M.TaskExtensions.Wd([ob,Zb],this.la),()=>{let Bc=this.$.da.za(411);Bc||(Bc=new Ma(ob.result,Zb.result,this.$),I.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")&&
this.$.da.Ga(411,Bc),Bc.initialize(),G.ULS.sendTraceTag(537163411,0,50,"DataCleansingManagerFactory.Create: DataCleansingManager initialized successfully"));this.qb(Bc)},this.la,3)}static ka(ob){ob.da.Ga(412,new Tb(ob))}}Object(z.a)(Tb,"DataCleansingManagerFactory",ya.a,[]);var zb=a(784),ic=a(222),Qb=a(13),wb=a(108),hc=a(4),Za=a(85),ub=a(235),uc=a(137);class Oc{}Oc.zah="DataCleansingPane";Oc.Bah="DataCleansingPaneHeader";Oc.Aah="DataCleansingPaneBody";Oc.Cah="DataCleansingPaneTitle";Oc.yah="DataCleansingCloseButton";
Object(z.a)(Oc,"CssClassNames",null,[]);var Bb=a(19),Nb=a(258),dc=a(245),sc=a(12),yc=a(700);class cd extends ub.a{constructor(ob,Zb){super(document.createElement("div"));this.Cp=!1;this.zye=this.he=null;this.su=0;this.$j=()=>{this.ig(!1);this.raiseEvent("DCTPC");return!0};this.$=ob;this.taskPaneManager=Zb;this.L8h();Nb.a(ob).Xh(this)}dP(ob){this.get_events().addHandler("DCTPR",ob)}qR(ob){this.get_events().removeHandler("DCTPR",ob)}aM(ob){this.addHandler("DCTPC",ob)}RN(ob){this.removeHandler("DCTPC",
ob)}fUc(ob){this.addHandler("DCTPCO",ob)}DId(ob){this.removeHandler("DCTPCO",ob)}gUc(ob){this.addHandler("DCTPC",ob)}EId(ob){this.removeHandler("DCTPC",ob)}get isVisible(){return super.isVisible}set isVisible(ob){super.isVisible!==ob&&(super.isVisible=ob,this.raiseEvent(ob?"DCTPC":"DCTPCO"))}get kf(){return this.isVisible}get $d(){return dc.a.Dah}get Yg(){return 18}get Tk(){return Bb.a.ZOe}get RM(){return O.a.instance.ga(1073)}get wo(){return 320}get isResizable(){return!1}get mc(){return this.domElement}get titleText(){return O.a.instance.ga(1305)}BH(){}lp(){return this.Cp}Zr(){return this.Cp}dR(){}mQ(){return!1}lj(){}Nj(){}hg(){return!0}kh(ob){return sc.DOMElementExtensions.vf(this.mc,
ob)}ig(ob){this.isVisible=this.Cp=ob;this.taskPaneManager.Pw();ob&&0<this.taskPaneManager.$z.length&&(!this.taskPaneManager.Bg||18!==this.taskPaneManager.Bg.taskPane.Yg||this.taskPaneManager.isCollapsed)&&this.taskPaneManager.VF(this,!0);this.$.qf()}pM(){const ob=yc.b("div","DataCleansingPaneBodyId",Oc.Aah),Zb=this.domElement;Zb.setAttribute(uc.a.ariaLabel,O.a.instance.ga(1306));Zb.appendChild(this.ZG());Zb.appendChild(ob);return ob}dispose(){this.he&&(ic.a.instance.Ba(Qb.a.click,this.he,this.$j),
wb.KeyInputManager.instance.Bv(this.he,this.zye),this.he=null);this.taskPaneManager=this.$=null;super.dispose()}L8h(){const ob=this.domElement;ob.id="DataCleansingPaneId";document.getElementById(this.$.Bb+pa.a.WQ).appendChild(ob);ob.classList.add(Oc.zah)}ZG(){const ob=yc.b("div","DataCleansingPaneHeaderId",Oc.Bah),Zb=yc.b("span","DataCleansingPaneTitleId",pa.a.zyc+Oc.Cah);Zb.innerText=this.titleText;this.he=zb.a.pb("DataCleansingPaneCloseButtonId",pa.a.Idb+Oc.yah,O.a.instance.ga(10),"ClosePaneGlyph_16x16x32",
!1);this.he.classList.add(hc.AFrameworkApplication.isRtl?pa.a.V$:pa.a.W$);ic.a.instance.ra(Qb.a.click,this.he,this.$j);this.zye=wb.KeyInputManager.instance.ms(this.he,this.$j,Za.a.$h);ob.appendChild(Zb);ob.appendChild(this.he);return ob}}Object(z.a)(cd,"DataCleansingTaskPane",ub.a,[717,2,401,102]);class pd extends ya.a{constructor(ob){super();this.$=ob;this.Fb()}create(){M.TaskExtensions.Aa(J.a(this.$),ob=>{ob=ob.result;ob=this.$.da.za(415)||this.$.da.Ga(415,new cd(this.$,ob));this.qb(ob)},this.la,
3)}static ka(ob){ob.da.Ga(416,new pd(ob))}}Object(z.a)(pd,"DataCleansingTaskPaneFactory",ya.a,[]);const Rb={width:244,font:"12px sans-serif"},Dc=[45];class nd{constructor(ob,Zb){this.$=ob;this.ug=Zb;this.doUndo=()=>Object(ja.a)(this,void 0,void 0,function*(){yield c(this.$)});this.highlightRangesOnGrid=(Bc,bd)=>Object(ja.a)(this,void 0,void 0,function*(){this.lz(Bc,bd)});this.selectRangeOnGrid=(Bc,bd={})=>Object(ja.a)(this,void 0,void 0,function*(){this.selectRange(Bc,bd)});this.openCustomNumberFormat=
()=>Object(ja.a)(this,void 0,void 0,function*(){return new Promise(Bc=>{b(this.$,bd=>{Bc(bd);G.ULS.sendTraceTag(520942165,0,50,`HostAppCallbacks.openCustomNumberFormat: resolved with "${bd?"OK":"Cancel"}"`)})})});this.openFeedback=Bc=>Object(ja.a)(this,void 0,void 0,function*(){d(this.$,Bc)});this.sendOtelEvent=Bc=>Object(ja.a)(this,void 0,void 0,function*(){f(Bc)});this.formatRanges=(Bc=[])=>Object(ja.a)(this,void 0,void 0,function*(){return Bc.map(bd=>Ra(bd,!1).hz(!1))});this.formatValues=Bc=>Object(ja.a)(this,
void 0,void 0,function*(){return Bc.map(bd=>u(this.ug,bd.format,bd.value))});this.containsHiddenCells=Bc=>l(this.$,Bc)}get grid(){return fb.g(this.$)}lz(ob,Zb){const Bc=this.grid.lb;Bc.Mg(Dc,!1,!0);Bc.oi(null,Dc,!1);if(null===ob||void 0===ob?0:ob.length){const bd=sb.a.d7(Pa.d(this.$.pa),ob.map(Ed=>Ra(Ed,!1)));Bc.vv(bd,Dc,!0,void 0,!1);Zb&&this.OAi(ob)}Bc.update(!1)}OAi(ob){if(null===ob||void 0===ob?0:ob.length){const Zb=this.grid;[ob]=ob.sort((Bc,bd)=>Bc.top<bd.top?-1:Bc.top>bd.top?1:0);ob=Z.Range.Uc(ob.top,
ob.left);Zb.nK(ob)||(G.ULS.sendTraceTag(520660942,0,50,"HostAppCallbacks.moveViewportToRangeIfNeeded moving viewport"),Zb.dt(ob,0,tb.a.dataCleansing))}else G.ULS.sendTraceTag(520660941,0,10,"HostAppCallbacks.moveViewportToRangeIfNeeded no ranges to move viewport")}selectRange(ob,Zb){const Bc=this.grid;if(null===Zb||void 0===Zb?0:Zb.z0a){Zb=Ra(Zb.z0a,!1);const bd=Bc.ha.sa.selectedRanges;if(1<bd.length){G.ULS.sendTraceTag(520660940,0,50,"HostAppCallbacks.selectRange: skipped - more than one range is currently selected");
return}if(!Zb.equals(bd[0])){G.ULS.sendTraceTag(520660939,0,50,"HostAppCallbacks.selectRange: skipped - selected range is not equal to the range in the filter");return}}G.ULS.sendTraceTag(520660938,0,50,"HostAppCallbacks.selectRange: selecting range");ob=Ra(ob,!1);Zb=Object(sa.v)(ob,this.$);Bc.Dg(Zb,ob.topLeft,void 0,null,0,tb.a.dataCleansing,void 0,void 0,void 0,void 0,!0)}}Object(z.a)(nd,"HostAppCallbacks",null,[794]);class od{constructor(ob){this.$=ob;this.applySuggestion=(Zb,Bc=[])=>Object(ja.a)(this,
void 0,void 0,function*(){const bd=Bc.map(Ed=>Ra(Ed,!1));return m(this.$,Zb,bd)});this.refreshAnnotations=()=>{throw Error("Method not implemented.");};this.onPaneLifecycleEvent=Zb=>Object(ja.a)(this,void 0,void 0,function*(){e(Zb)})}}Object(z.a)(od,"DataCleansingCallbacks",null,[793]);class wd{constructor(){this.annotations=[];this.hostState=new Pc;this.worksheetState=new Hb}}Object(z.a)(wd,"DataCleansingHostState",null,[]);class Pc{constructor(){this.isInCoauthoring=this.isInViewMode=this.isInErrorState=
!1}}Object(z.a)(Pc,"HostState",null,[791]);class Hb{constructor(){this.isProtected=this.isInNamedSheetView=!1}}Object(z.a)(Hb,"WorksheetState",null,[792]);class Nc extends T.a{constructor(ob,Zb,Bc){super();this.$=ob;this.eVc=Zb;this.wNa=new wd;this.fCf=()=>{this.stateChanged()};this.Gh=(bd,Ed)=>{this.wbg(Ed.tD);this.P6f(Ed.pa);this.stateChanged()};this.aR=()=>{this.stateChanged()};this.rB=()=>{this.stateChanged()};this.XQ=()=>{this.stateChanged()};this.KEb=()=>{G.ULS.sendTraceTag(512492932,0,50,"DataCleansingHostManager.onUnrecoverableErrorOccurred: Received AL permanent session close.")};
this.H5=(bd,Ed)=>{Pa.m(Ed.item)&&Ed.item.li!==this.wNa.worksheetState.isProtected&&(G.ULS.sendTraceTag(512492931,0,50,`DataCleansingHostManager.onSheetOptionsChanged: sheet protection has changed to ${Ed.item.li}.`),this.stateChanged())};this.callbacks=new od(this.$);this.fJg=new nd(this.$,Bc);Zb.BGg(this.fCf);Zb.RGg(this.KEb);Zb.$Wb();ob.En.Pf(this.Gh);ob.ea.b9(this.rB);ob.ea.GX(this.XQ);this.P6f(this.$.pa)}Nmb(ob){this.addHandler(Nc.WSd,ob)}Orc(ob){this.removeHandler(Nc.WSd,ob)}dispose(){this.eVc.ncj(this.fCf);
this.eVc.Acj(this.KEb);this.$.En.zg(this.Gh);this.$.ea.n6(this.rB);this.$.ea.z_(this.XQ);this.wbg(this.$.pa);super.dispose()}get state(){const ob=Pa.d(this.$.pa);this.wNa.annotations=this.eVc.J0f(ob);Pa.m(this.$.pa)&&(this.wNa.worksheetState.isInNamedSheetView=this.$.pa.Ed.lv,this.wNa.worksheetState.isProtected=this.$.pa.li);this.wNa.hostState.isInViewMode=!this.$.ea.isEditMode;this.wNa.hostState.isInCoauthoring=this.isInCoauthoring();return this.wNa}isInCoauthoring(){return!1}stateChanged(){this.raiseEvent(Nc.WSd,
this.state)}P6f(ob){Pa.m(ob)&&(ob.Ed.mra(this.aR),ob.hYa(this.H5))}wbg(ob){Pa.m(ob)&&(ob.Ed.QPa(this.aR),ob.Nrc(this.H5))}}Nc.WSd="scek";Object(z.a)(Nc,"DataCleansingHostManager",T.a,[]);class Db extends T.a{constructor(ob){super();this.$=ob;this.uPd=new Map;this.i0c=new Map;this.fze=new Map;this.V8a=()=>{G.ULS.sendTraceTag(520987272,0,50,"DataCleansingAnnotationsManager.onAugmentationLoopSessionClose: Received augmentation loop session close.");this.raiseEvent(Db.NWd)};this.CDb=(Zb,Bc)=>{this.i0c.set(Bc.id,
Bc);G.ULS.sendTraceTag(512354457,0,50,`DataCleansingAnnotationsManager.onColumnAnnotationReceived: Received ${Bc.id}`)};this.pDb=(Zb,Bc)=>{Zb=this.uPd.get(Bc.worksheetId);G.ULS.sendTraceTag(512354456,0,50,`DataCleansingAnnotationsManager.onAggregateAnnotationReceived: Received ${JSON.stringify({["id"]:Bc.id,["previous"]:null===Zb||void 0===Zb?void 0:Zb.id,["errorCount"]:Bc.errorCount,["suggestionsCount"]:Bc.suggestionsCount})}`);(null===Zb||void 0===Zb?void 0:Zb.id)===Bc.id&&G.ULS.sendTraceTag(512354455,
0,50,`DataCleansingAnnotationsManager.onAggregateAnnotationReceived: Received duplicate ${Bc.id}`);this.uPd.set(Bc.worksheetId,Bc);Zb=Array.from(this.i0c.values()).filter(bd=>bd.worksheetId===Bc.worksheetId);Zb.forEach(bd=>{this.i0c.delete(bd.id)});G.ULS.debugAssertTag(512354319,0,Bc.suggestionsCount===Zb.reduce((bd,Ed)=>bd+Ed.suggestions.length,0),"DataCleansingAnnotationsManager.onAggregateAnnotationReceived: Not all column annotations received");this.fze.set(Bc.id,Zb);this.aJg(Bc.worksheetId)}}BGg(ob){this.addHandler(Db.vPd,
ob)}ncj(ob){this.removeHandler(Db.vPd,ob)}RGg(ob){this.addHandler(Db.NWd,ob)}Acj(ob){this.removeHandler(Db.NWd,ob)}dispose(){this.LD&&(this.LD.pPf(this.CDb),this.LD.ePf(this.pDb),this.LD.dispose());super.dispose()}$Wb(){Object(ja.a)(this,void 0,void 0,function*(){const ob=yield D.GetServiceTaskFactory.cja(this.$.da,328,327,1);ob?(this.LD=new Xa(ob),ob.EXb(this.V8a),this.LD.Mle(this.CDb),this.LD.Gle(this.pDb),this.LD.$Wb(),G.ULS.sendTraceTag(520987274,0,50,"DataCleansingAnnotationsManager.activateEvents: events activated")):
G.ULS.sendTraceTag(520987273,0,10,"DataCleansingAnnotationsManager.activateEvents: no augmentationLoopManager")})}J0f(ob){var Zb;if(ob=this.uPd.get(ob)){const Bc=null!==(Zb=this.fze.get(ob.id))&&void 0!==Zb?Zb:[];return[ob,...Bc]}return[]}aJg(ob){ob={sheetId:ob,annotations:this.J0f(ob)};this.raiseEvent(Db.vPd,ob)}}Db.vPd="sacek";Db.NWd="ueoek";Object(z.a)(Db,"DataCleansingAnnotationsManager",T.a,[]);var Cc=a(696);class Xc extends ya.a{constructor(ob){super();this.$=ob;this.Fb()}create(){I.EwaSettings.isChangeGateEnabled("OfficeVSO:6894126_FAMServiceRegistrationFixes")?
this.PCe().then(ob=>{const Zb=Object(Cc.a)(this.$.da,494,()=>{const Bc=new Db(this.$);return new Nc(this.$,Bc,ob)});this.qb(Zb)},()=>{G.ULS.sendTraceTag(512508561,0,10,"DataCleansingHostManagerFactory.Create: failed to create formatCellsAction")}):this.rSh().then(ob=>{this.qb(ob)},()=>{G.ULS.sendTraceTag(512508560,0,10,"DataCleansingHostManagerFactory.Create: failed to create DataCleansingHostManager")})}PCe(){return R.d(D.GetServiceTaskFactory.create(this.$.da,18,this.$.la,this.hb))}rSh(){return Object(ja.a)(this,
void 0,void 0,function*(){var ob=this.$.da.za(494);ob?G.ULS.sendTraceTag(522314576,0,50,"DataCleansingHostManagerFactory.Create: DataCleansingHostManager already exists"):(ob=new Db(this.$),ob=new Nc(this.$,ob,yield this.PCe()),G.ULS.sendTraceTag(522314575,0,50,"DataCleansingHostManagerFactory.Create: DataCleansingHostManager created successfully"));return ob})}static ka(ob){ob.da.Ga(495,new Xc(ob))}}Object(z.a)(Xc,"DataCleansingHostManagerFactory",ya.a,[]);var ld=a(131),Dd=a(152),Od=a(132),Qd;(function(ob){ob[ob.success=
0]="success";ob[ob.featureDisabled=1]="featureDisabled";ob[ob.rangeNotInGrid=2]="rangeNotInGrid";ob[ob.emptyRange=3]="emptyRange";ob[ob.rangeTooLarge=4]="rangeTooLarge";ob[ob.successWithMergedCells=5]="successWithMergedCells"})(Qd||(Qd={}));Object(z.b)("ResultCode",Qd);var Nd=a(58),he=a(160),ve=a(22),Td=a(185),ke;(function(ob){ob.FormatAsTable="FormatAsTable";ob.ExplicitClose="ExplicitClose";ob.ESC="Dismiss";ob.CommandExecution="CommandExecution";ob.Undo="Undo";ob.SelectionEnd="SelectionEnd"})(ke||
(ke={}));Object(z.b)("IgnoreSource",ke);class xe{constructor(ob,Zb,Bc){this.nBd=()=>{var bd=new tc.a(-859308420,oa.a.Eb,this.$.Mc,9,null);this.$.Ka.Mb(bd,{[oa.a.Zf]:"HelpID=22118",["InputMethod"]:oa.a.Eb,["ShouldCanvasTakeFocus"]:!0,[oa.a.Pc]:pa.a.oQ,[pa.a.Hda]:!0});bd=this.dataFields;bd.suggestionType="table";Od.b(this.$).Cd(ld.a.z4f,bd,{},!0)};this.H1c=()=>{const bd=sa.v(this.Ulb.Ena,this.$);var Ed=sa.D(bd);this.D6a(Ed)||this.grid.ha.Lw([Ed],0,Ed.topLeft,0);G.ULS.sendTraceTag(522806800,0,50,this.Wg("convertToTable",
"Create table initiated"));Ed={};Ed.TableRange=bd;Ed.HasHeader=!0;this.$.ud(71074531,oa.a.Eb,9,Ed).continueWith(ge=>{Dd.b(ge)&&ge.result?(G.ULS.sendTraceTag(522806799,0,50,this.Wg("convertToTable","Create table complete")),Od.b(this.$).Cd(ld.a.y4f,this.dataFields,{},!0),this.Vaa()?he.a(this.$).Vl.activateRibbonTab(pa.a.Yya):this.grid.cYa(this.kLb)):G.ULS.sendTraceTag(522806798,0,10,this.Wg("convertToTable","Create table failed"));this.qjd(ke.FormatAsTable);this.sBb()})};this.onClose=()=>{this.qjd(ke.ExplicitClose);
this.sBb()};this.onDismiss=bd=>{(bd=bd?new Sys.UI.DomEvent(bd):null)&&"keydown"===bd.type&&27===bd.keyCode&&this.qjd(ke.ESC);G.ULS.sendTraceTag(522806797,0,100,this.Wg("onDismiss","OnDismiss called for Table Invitation"))};this.kLb=()=>{this.Vaa()&&(he.a(this.$).Vl.activateRibbonTab(pa.a.Yya),this.grid.Uab(this.kLb))};this.sBb=()=>{ib.a.instance.Wb("Common.ISystemInitiatedFeedback").execute(bd=>{bd.logActivity("Office_Excel_SmartView_FormatAsTableOnPasteFloodgate",null)})};this.$=ob;this.qjd=Bc;this.proactiveSuggestionCard=
Zb;this.dataFields={["Class"]:"TableSuggestionCardUtil",["LaunchSource"]:"Default"};this.grid=fb.g(this.$);this.isVisible=!1}Owc(ob,Zb){this.dataFields.LaunchSource=Zb;this.Ulb=ob;Zb=[{key:"learnMessage",text:O.a.instance.Xa(708),onClick:this.nBd}];(this.isVisible=this.proactiveSuggestionCard.show(ob.Ena,O.a.instance.Xa(702),O.a.instance.Xa(703),O.a.instance.Xa(704),O.a.instance.Xa(705),this.H1c,this.onClose,Zb,()=>{this.x5(!0)},()=>{this.x5(!1)},"TableDesignIdeas",I.EwaSettings.isChangeGateEnabled("OfficeVSO:6472403_FallbackCardLocation")?
13:void 0,I.EwaSettings.isChangeGateEnabled("OfficeVSO:6472403_FallbackCardLocation")?[11]:void 0,5,this.onDismiss,void 0,!0))?(Od.b(this.$).Cd(ld.a.A4f,this.dataFields,{},!0),G.ULS.sendTraceTag(522806802,0,50,this.Wg("showTableSuggestionCard","Proactive suggestion card displayed"))):G.ULS.sendTraceTag(522806801,0,15,this.Wg("showTableSuggestionCard","Proactive suggestion card failed to show"))}get visible(){return this.isVisible}hide(){this.proactiveSuggestionCard.hide();this.isVisible=!1}dispose(){this.proactiveSuggestionCard&&
this.proactiveSuggestionCard.dispose()}x5(ob){ob?(ob=[],ob.push(this.Ulb.Ena),ob=sb.a.d7(Pa.d(this.$.pa),ob),this.grid.lb.vv(ob,[0],!0)):this.grid.lb.jza()}Vaa(){return this.grid.Ea.oK(4,this.$.pa)}Wg(ob,Zb,Bc){let bd=Object.assign({},this.dataFields);bd.Method=ob;bd.Message=Zb;Bc&&(bd.Fields=Bc);return Nd.a.Ac(bd)}D6a(ob){return ob.Dd(this.grid.ha.sa.activeRange)}}Object(z.a)(xe,"TableSuggestionCardUtil",null,[]);class le{constructor(ob,Zb,Bc,bd){this.syi=I.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SmartView.MaxIntelligentMetadataDismissCount",
3);this.V3=Ed=>{this.B8e.add(this.hXb.nE);I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.EnableRoamingServiceIntegration",!1)&&("FormatAsTable"===Ed?this.Bma.pfj():this.Bma.K7h());this.Hdb.visible&&this.Hdb.hide()};this.yg=()=>{this.Hdb.visible&&null!=this.hXb&&!this.D6a(this.hXb.nE)&&this.V3("SelectionEnd")};this.YQ=(Ed,ge)=>{1928326585!=ge.Jd.command&&1833782813!=ge.Jd.command&&(this.V3("CommandExecution"),this.$.Ka.mza(this.YQ))};this.$=ob;this.hXb=null;this.tableIntelligenceManager=
Zb;this.B8e=new Td.a;this.dataFields={["Class"]:"IntelligentMetadataTableManager",["LaunchSource"]:"Default"};this.grid=fb.g(this.$);this.Ulb=null;this.Q8i();this.proactiveSuggestionCard=Bc;this.Hdb=new xe(this.$,this.proactiveSuggestionCard,this.V3);this.eHj=.75;this.Bma=bd}MLj(ob,Zb){var Bc;return Object(ja.a)(this,void 0,void 0,function*(){if(I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1))if(hc.AFrameworkApplication.XH("XLS-SmartView-EnableRoamingServiceIntegration-Treatment;XLS-SmartView-EnableRoamingServiceIntegration-Control"),
I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.EnableRoamingServiceIntegration",!1)&&(yield this.Bma.xPh())>=this.syi)G.ULS.sendTraceTag(520135585,306,50,this.Wg("triggerHandRaise","Exceeded maximum intelligent metadata dismiss count."));else{var bd=this.tableIntelligenceManager.X3a().Bac(ob,6);for(let Ed of this.B8e)if(Ed.sheetId===ob.sheetId&&Ed.range.Dd(ob.range))return;1<=bd.length&&this.z7h(null===(Bc=bd[0])||void 0===Bc?void 0:Bc.table)&&(this.Hdb.Owc(this.Ulb,Zb),this.$.Ka.fFa(this.YQ))}else G.ULS.sendTraceTag(522740425,
0,50,this.Wg("triggerIntelligentMetadataTableHandRaise","Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions is disabled"))})}Q8i(){this.grid.ha.cT(this.yg)}z7h(ob){for(let Zb of ob.interpretations)if(Zb.confidence>=this.eHj&&2===Zb.orientation&&1===Zb.headerRowCount&&!ob.tableName)return this.Ulb=Zb,this.hXb=ob,!0;return!1}Wg(ob,Zb,Bc){let bd=Object.assign({},this.dataFields);bd.Method=ob;bd.Message=Zb;Bc&&(bd.Fields=Bc);return Nd.a.Ac(bd)}D6a(ob){return ob.range.contains(this.grid.ha.sa.activeRange)}}
Object(z.a)(le,"IntelligentMetadataTableManager",null,[]);var Je=a(513),Fe=a(281),eb=a(216),Xb=a(121);const oc={version:1,Nlc:0,Ndc:0};class Gc{constructor(ob){this.M7h=()=>{this.smartViewTableHandRaiseSetting&&(this.smartViewTableHandRaiseSetting.Nlc++,this.aBc())};this.K7h=()=>{this.smartViewTableHandRaiseSetting&&(this.smartViewTableHandRaiseSetting.Ndc++,this.aBc())};this.rfj=()=>{this.smartViewTableHandRaiseSetting&&(this.smartViewTableHandRaiseSetting.Nlc=0,this.aBc())};this.pfj=()=>{this.smartViewTableHandRaiseSetting&&
(this.smartViewTableHandRaiseSetting.Ndc=0,this.aBc())};this.kTf=()=>{G.ULS.sendTraceTag(521007203,0,50,this.Wg("retrieveSmartViewTableHandRaiseSettingFromRoamingService","Reading latest roaming setting."));return new Promise(Zb=>{vb.v(this.$.oa.va,2,Bc=>{G.ULS.sendTraceTag(521007198,0,50,this.Wg("retrieveSmartViewTableHandRaiseSettingFromRoamingService","OnReadRoamingStringSuccess called."));if($a.a.rg(Bc.Errors))Bc={["errors"]:$a.a.yc(Bc.Errors)},G.ULS.sendTraceTag(521007197,0,10,this.Wg("retrieveSmartViewTableHandRaiseSettingFromRoamingService",
"onReadRoamingSuccessCallback encountered an error.",Bc)),Zb(null);else if(Bc.Result){if(Bc=this.mdh(Bc.Result))G.ULS.sendTraceTag(521007196,0,50,this.Wg("retrieveSmartViewTableHandRaiseSettingFromRoamingService","Successfully retrieved smartViewTableHandRaiseSetting.",{["version"]:Bc.version})),1>Bc.version?Zb(oc):Zb(Bc)}else G.ULS.sendTraceTag(512304031,0,50,this.Wg("retrieveSmartViewTableHandRaiseSettingFromRoamingService","onReadRoamingSuccessCallback received null result. Returning default value.")),
Zb(oc)},Bc=>{Bc={["EwaErrors"]:Xb.a.lf(Bc.data)};G.ULS.sendTraceTag(520135584,0,10,this.Wg("retrieveSmartViewTableHandRaiseSettingFromRoamingService","Roaming operation failed.",Bc));Zb(null)},null,null)})};this.aBc=()=>{const Zb=this.anj(this.smartViewTableHandRaiseSetting);Zb?(G.ULS.sendTraceTag(521007199,0,50,this.Wg("updateSmartViewTableHandRaiseSettingFromRoamingService","Updating roaming setting.")),vb.B(this.$.oa.va,2,Zb,Bc=>{G.ULS.sendTraceTag(521007189,0,50,this.Wg("onWriteRoamingStringSuccess",
"OnWriteRoamingStringSuccess called."));$a.a.rg(Bc.Errors)?(Bc={["errors"]:$a.a.yc(Bc.Errors)},G.ULS.sendTraceTag(521007188,0,10,this.Wg("onWriteRoamingStringSuccess","onWriteRoamingStringSuccess encountered an error.",Bc))):Bc.Result&&(Bc.Result||G.ULS.sendTraceTag(521007187,0,15,this.Wg("onWriteRoamingStringSuccess","Failed to write to the roaming service.")))},Bc=>{Bc={["EwaErrors"]:Xb.a.lf(Bc.data)};G.ULS.sendTraceTag(520135583,0,10,this.Wg("updateSmartViewTableHandRaiseSettingFromRoamingService",
"Roaming operation failed.",Bc))},null,null)):G.ULS.sendTraceTag(521007200,0,15,this.Wg("updateSmartViewTableHandRaiseSettingFromRoamingService","Empty serialized roaming setting."))};this.mdh=Zb=>{if(!Zb)return G.ULS.sendTraceTag(521007195,0,15,this.Wg("deserializeToSmartViewTableHandRaiseSetting","Received an empty roamingXml.")),null;let Bc;try{Bc=Nd.a.Vh(Zb)}catch(bd){return G.ULS.sendTraceTag(521007192,0,10,this.Wg("deserializeToSmartViewTableHandRaiseSetting","Error while deserializing SmartViewTableHandRaiseSetting.",
{["errorMessage"]:bd.message})),null}return Bc};this.anj=Zb=>{if(!Zb)return G.ULS.sendTraceTag(521007191,0,50,this.Wg("updateSmartViewTableHandRaiseSettingFromRoamingService","Empty roaming setting.")),null;Zb=Nd.a.Ac(Zb);return 200<Zb.length?(G.ULS.sendTraceTag(521007190,0,10,"serializeFromSmartViewTableHandRaiseSetting - Exceeded the MaxSize for smartViewTableHandRaiseSettingMaxSize."),null):Zb};this.Wg=(Zb,Bc,bd)=>{let Ed=Object.assign({},this.dataFields);Ed.Method=Zb;Ed.Message=Bc;bd&&(Ed.Fields=
bd);return Nd.a.Ac(Ed)};this.$=ob;this.dataFields={["Class"]:"SmartViewTableHandRaiseRoamingHandler"};this.smartViewTableHandRaiseSetting=null}iSh(){return Object(ja.a)(this,void 0,void 0,function*(){if(this.smartViewTableHandRaiseSetting)return this.smartViewTableHandRaiseSetting.Nlc;const ob=yield this.kTf();return ob?(this.smartViewTableHandRaiseSetting=ob,this.smartViewTableHandRaiseSetting.Nlc):Number.POSITIVE_INFINITY})}xPh(){return Object(ja.a)(this,void 0,void 0,function*(){if(this.smartViewTableHandRaiseSetting)return this.smartViewTableHandRaiseSetting.Ndc;
const ob=yield this.kTf();return ob?(this.smartViewTableHandRaiseSetting=ob,this.smartViewTableHandRaiseSetting.Ndc):Number.POSITIVE_INFINITY})}}Object(z.a)(Gc,"SmartViewTableHandRaiseRoamingHandler",null,[]);class Vc{constructor(ob,Zb,Bc){this.m9=this.RMa=null;this.Tkd=this.SMa=!1;this.CAa=this.d9a=null;this.jzb=this.Leg=!1;this.Dyi=I.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SmartView.MaxOnDemandDismissCount",3);this.l3h=(bd,Ed)=>{G.ULS.sendTraceTag(527983895,306,50,this.Wg("handleSmartViewActivationCallback",
"handleSmartViewActivationCallback invoked."));if(!Ed)return G.ULS.sendTraceTag(527983894,306,10,this.Wg("handleSmartViewActivationCallback","surveyParams is null.")),null;if(!Ed.contextInfo||0===Ed.contextInfo.length)return G.ULS.sendTraceTag(527983893,306,10,this.Wg("handleSmartViewActivationCallback","no valid contextInfo in surveyParams.",{["contextInfo"]:Ed.contextInfo})),null;this.t_e(Ed.contextInfo[Ed.contextInfo.length-1].context);return null};this.qDf=()=>{this.V3("Undo");this.$.ea.rQf(this.qDf)};
this.yg=()=>{this.proactiveSuggestionCard.isVisible&&null!=this.$xa&&!this.D6a(this.$xa.nE.range)?this.V3("SelectionEnd"):this.jzb||this.NXd()};this.Owc=bd=>{const Ed=[{key:"learnMessage",text:O.a.instance.Xa(708),onClick:this.nBd}];this.proactiveSuggestionCard.show(bd,O.a.instance.Xa(702),O.a.instance.Xa(703),O.a.instance.Xa(704),O.a.instance.Xa(705),this.H1c,this.onClose,Ed,()=>{this.x5(!0)},()=>{this.x5(!1)},"TableDesignIdeas",I.EwaSettings.isChangeGateEnabled("OfficeVSO:6472403_FallbackCardLocation")?
13:void 0,I.EwaSettings.isChangeGateEnabled("OfficeVSO:6472403_FallbackCardLocation")?[11]:void 0,5,this.onDismiss,void 0,!0);this.proactiveSuggestionCard.isVisible?(Od.b(this.$).Cd(ld.a.A4f,this.dataFields,{},!0),G.ULS.sendTraceTag(523622039,0,50,this.Wg("showTableSuggestionCard","Proactive suggestion card displayed"))):G.ULS.sendTraceTag(523530261,0,15,this.Wg("showTableSuggestionCard","Proactive suggestion card failed to show"))};this.nBd=()=>{var bd=new tc.a(-859308420,oa.a.Eb,this.$.Mc,9,null);
this.$.Ka.Mb(bd,{[oa.a.Zf]:"HelpID=22118",["InputMethod"]:oa.a.Eb,["ShouldCanvasTakeFocus"]:!0,[oa.a.Pc]:pa.a.oQ,[pa.a.Hda]:!0});bd=Object.assign({},this.dataFields);bd.suggestionType="table";Od.b(this.$).Cd(ld.a.z4f,bd,{},!0)};this.V3=bd=>{this.A8e=this.$xa.nE;this.NXd();this.Spj();this.$.Ka.mza(this.YQ);this.grid.ha.rR(this.yg);I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.EnableRoamingServiceIntegration",!1)&&("FormatAsTable"===bd?this.Bma.rfj():this.Bma.M7h());"ExplicitClose"===
bd&&Od.b(this.$).Cd(ld.a.GCj,this.dataFields,{},!0);G.ULS.sendTraceTag(526165469,0,50,this.Wg("ignoreActiveRange","Ignore Current Range",{["ignoreSource"]:bd}))};this.sBb=()=>{ib.a.instance.Wb("Common.ISystemInitiatedFeedback").execute(bd=>{bd.logActivity("Office_Excel_SmartView_FormatAsTableOnPasteFloodgate",null)})};this.H1c=()=>{const bd=sa.v(this.Gfb.Ena,this.$);G.ULS.sendTraceTag(537155670,0,50,this.Wg("convertToTable","Create table initiated"));const Ed={};Ed.TableRange=bd;Ed.HasHeader=!0;this.$.ud(71074531,
oa.a.Eb,9,Ed).continueWith(ge=>{Dd.b(ge)&&ge.result?(G.ULS.sendTraceTag(537155669,0,50,this.Wg("convertToTable","Create table complete")),Od.b(this.$).Cd(ld.a.y4f,this.dataFields,{},!0),this.Vaa()?he.a(this.$).Vl.activateRibbonTab(pa.a.Yya):this.grid.cYa(this.kLb)):G.ULS.sendTraceTag(537155668,0,10,this.Wg("convertToTable","Create table failed"));this.V3("FormatAsTable");this.sBb()})};this.onClose=()=>{this.V3("ExplicitClose");this.sBb()};this.onDismiss=bd=>{(bd=bd?new Sys.UI.DomEvent(bd):null)&&
"keydown"===bd.type&&27===bd.keyCode&&this.V3("Dismiss");G.ULS.sendTraceTag(526260301,0,100,this.Wg("onDismiss","OnDismiss called for Table Invitation"))};this.YQ=(bd,Ed)=>{bd=Ed.properties;bd.SourceControlId&&!bd.ShouldCanvasTakeFocus&&bd.SourceControlId.includes("Sensitivity")||this.Pgh(Ed.Jd.command)&&this.V3("CommandExecution")};this.Spj=()=>{const bd=this.grid.ha.sa.activeRange;this.grid.ha.updateSelection(bd,bd,0,0)};this.bya=()=>{this.Vaa()&&(this.getMetadata(this.K3c),this.K3c=null,this.grid.Uab(this.bya))};
this.kLb=()=>{this.Vaa()&&(he.a(this.$).Vl.activateRibbonTab(pa.a.Yya),this.grid.Uab(this.kLb))};this.$=ob;this.tableIntelligenceManager=Zb;this.A8e=this.Gfb=this.$xa=null;this.dataFields={["Class"]:"IntelligentMetadataOverlayManager",["LaunchSource"]:"Default"};this.K3c=null;this.proactiveSuggestionCard=Bc;this.grid=fb.g(this.$);this.Hdb=new xe(this.$,this.proactiveSuggestionCard,this.V3);this.Bma=new Gc(this.$);ib.a.instance.Wb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(bd=>
{this.m9=bd;void bd.isFeatureEnabled("SmartViewTableHandRaise",!1).then(Ed=>this.SMa=Ed);void bd.isFeatureEnabled("SmartViewIntelligentMetadataTableHandRaise",!1).then(Ed=>{this.Tkd=Ed;I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&Ed&&!this.Exb&&(this.Exb=new le(this.$,this.tableIntelligenceManager,this.proactiveSuggestionCard,this.Bma));return Ed});this.RMa=bd.gma("SmartViewTableHandRaise",Ed=>{this.SMa=Ed.isEnabled});bd.gma("SmartViewIntelligentMetadataTableHandRaise",
Ed=>{this.Tkd=Ed.isEnabled;I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.Tkd&&!this.Exb&&(this.Exb=new le(this.$,this.tableIntelligenceManager,this.proactiveSuggestionCard,this.Bma))})});this.Leg=["en-US","en-GB","en-CA","en-AU","en_IN"].includes(this.$.veb);(ob=ib.a.instance.Wb("Common.ISystemInitiatedFeedback"))&&ob.execute(bd=>{bd.Bqc("SmartViewSuggestion",this.l3h)});this.$.Ib&&(this.d9a=this.$.Ib.Og("WebServiceCall","onDemandStopWatch"),
this.CAa=this.$.Ib.Og("WebServiceCall","getTableInfoStopwatch"))}get hje(){return this.Gfb}hSj(ob){this.$xa=null;ob.tableName||(this.$xa=ob);ob={["Duration"]:-1};this.d9a&&(this.d9a.stop(),ob.Duration=this.d9a.uc);G.ULS.sendTraceTag(523622040,0,50,this.Wg("updateOnDemandRecognizedTable","OnDemand request succeeded",ob));this.NXd();this.$.ea.mne(this.qDf)}g7(ob,Zb){return Object(ja.a)(this,void 0,void 0,function*(){this.dataFields.LaunchSource=Zb;var Bc=ob;Bc||G.ULS.sendTraceTag(523530262,306,10,this.Wg("triggerHandRaise",
"sheetRange is null or undefined"));if(I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisableSmartViewLicenseCheck",!1)||this.SMa)if(this.Leg)if(this.$.ya.IsMeetingLiveSession)G.ULS.sendTraceTag(520901637,306,50,this.Wg("triggerHandRaise","User is in Teams live."));else if(eb.a.LLa()||eb.a.owa())G.ULS.sendTraceTag(520901636,306,50,this.Wg("triggerHandRaise","User is in Excel hosted in Teams."));else if(hc.AFrameworkApplication.XH("XLS-SmartView-EnableRoamingServiceIntegration-Treatment;XLS-SmartView-EnableRoamingServiceIntegration-Control"),
I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.EnableRoamingServiceIntegration",!1)&&(yield this.Bma.iSh())>=this.Dyi)G.ULS.sendTraceTag(520135586,306,50,this.Wg("triggerHandRaise","Exceeded maximum on demand dismiss count."));else{hc.AFrameworkApplication.XH("XLS-SmartView-GetTableInfo-Treatment;XLS-SmartView-GetTableInfo-Control");if(!this.tmi(Bc)){G.ULS.sendTraceTag(527229345,306,50,this.Wg("triggerHandRaise","Surrounding Cells contain values, update boundary required"));
if(!I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.GetTableInfo",!1))return;Bc=yield this.fld(Bc);if(!Bc){G.ULS.sendTraceTag(522823200,306,50,this.Wg("triggerHandRaise","Expanded Range is null or undefined"));return}}this.i1g(Bc)?G.ULS.sendTraceTag(520642720,306,50,this.Wg("triggerHandRaise","Header contains links or formulas.")):(hc.AFrameworkApplication.XH("XLS-SmartView-SelectionNotInRange-Control;XLS-SmartView-SelectionNotInRange-Treatment"),this.Pff(Bc.range)?this.zwa(Bc.range)?
G.ULS.sendTraceTag(523117070,306,50,this.Wg("triggerHandRaise","Specified range is empty")):I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DisableLPP",!1)||I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PasteSmartViewTestOnly",!1)?(G.ULS.sendTraceTag(522831705,306,50,this.Wg("triggerHandRaise","LPP Disabled, requesting OnDemandMetadata")),this.t_e(Bc)):this.xvi(Bc):G.ULS.sendTraceTag(526260302,0,50,this.Wg("triggerHandRaise","User selection out of range, OOUI hid")))}else G.ULS.sendTraceTag(523544584,
306,50,this.Wg("triggerHandRaise","Invalid language for TriggerHandRaise."));else G.ULS.sendTraceTag(527958875,306,50,this.Wg("triggerHandRaise","License is not enabled."))})}XVd(ob,Zb){return Object(ja.a)(this,void 0,void 0,function*(){this.Exb&&void this.Exb.MLj(ob,Zb)})}xvi(ob){const Zb=ib.a.instance.Wb("Common.ISystemInitiatedFeedback");Zb&&(G.ULS.sendTraceTag(527983892,306,50,this.Wg("logSmartViewEventToLpp","logged event to LPP")),Zb.execute(Bc=>{Bc.logActivity("SmartViewProactiveSuggestionActivity",
null,ob)}))}t_e(ob){this.jzb||this.grid.ha.cT(this.yg);this.Vaa()?this.getMetadata(ob):(this.K3c=ob,this.grid.cYa(this.bya))}dispose(){this.proactiveSuggestionCard&&this.proactiveSuggestionCard.dispose()}NXd(){if(I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.OnPasteEnabled",!1)&&null!=this.$xa){var ob=this.$xa.nE;if(this.A8e!==ob&&ob.sheetId===this.$.xa.pa.sheetId&&this.Pff(ob.range)){ob=.5;let Bc=null;this.jzb=!1;for(var Zb of this.$xa.interpretations)Zb.confidence>=ob&&2===
Zb.orientation&&(ob=Zb.confidence,Bc=Zb);Bc?1!==Bc.headerRowCount||Bc.headerColumnCount?(this.grid.ha.rR(this.yg),this.jzb=!0,G.ULS.sendTraceTag(527218011,0,50,this.Wg("updateOnDemandActionButton","The recognition cannot be converted to a table"))):this.Gfb===Bc&&this.proactiveSuggestionCard.isVisible||(this.Gfb=Bc,Zb=this.dataFields.LaunchSource,I.EwaSettings.isChangeGateEnabled("OfficeVSO:6648444_UseTableSuggestionCardUtil")?this.Hdb.Owc(this.hje,Zb):this.Owc(this.hje.Ena),this.$.Ka.fFa(this.YQ)):
(this.grid.ha.rR(this.yg),this.jzb=!0,G.ULS.sendTraceTag(527958874,0,50,this.Wg("updateOnDemandActionButton","The recognition contained no interpretations")))}else this.proactiveSuggestionCard.isVisible&&this.proactiveSuggestionCard.hide()}}x5(ob){ob?(ob=[],ob.push(this.Gfb.Ena),ob=sb.a.d7(Pa.d(this.$.pa),ob),this.grid.lb.vv(ob,[0],!0)):this.grid.lb.jza()}Pgh(ob){return![1928326585,1833782813,-1059615499,-1027730316,-1104934572,-28797232,71074531].includes(ob)}i1g(ob){ob=new Z.Range(ob.range.top,
ob.range.left,ob.range.top,ob.range.right,!0,!1);for(ob=fb.g(this.$).mk("IntelligenceMetadataOverlay.containsFormulasInHeader",ob,1);ob.$$mn();)if(ob.$$cu().gF)return!0;return!1}getMetadata(ob){this.d9a.start();ob=this.tableIntelligenceManager.YQh(ob,this.hSj.bind(this));G.ULS.sendTraceTag(523622038,0,50,this.Wg("getMetadata","OnDemand metadata requested"));ob&&(G.ULS.sendTraceTag(536953376,0,50,this.Wg("getMetadata","getMetadataForRange unsuccessful",{["resultCode"]:Qd[ob]})),this.d9a.stop())}Vaa(){return this.grid.Ea.oK(4,
this.$.pa)}tmi(ob){ob=new Z.Range(1<ob.range.top-1?ob.range.top-1:1,1<ob.range.left-1?ob.range.left-1:1,ob.range.bottom+1,ob.range.right+1,!0,!1);const Zb=1===ob.top,Bc=1===ob.left,bd=fb.g(this.$).mk("IntelligenceMetadataOverlay",ob,1);for(;bd.$$mn();){const Ed=bd.$$cu();if((Ed.range.top===ob.top&&!Zb||Ed.range.left===ob.left&&!Bc||Ed.range.bottom===ob.bottom||Ed.range.right===ob.right)&&!Ed.Sw.value.length)return!1}return!0}Pff(ob){return I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.SelectionNotInRange",
!1)||this.D6a(ob)}D6a(ob){return ob.Dd(this.grid.ha.sa.activeRange)}zwa(ob){for(ob=fb.g(this.$).mk("IntelligentMetadataOverlayManager.isRangeEmpty",ob,1);ob.$$mn();){const Zb=ob.$$cu();if(Zb&&(0!==Zb.Sw.type||!ve.a.Aq(Zb.Sw.value)))return!1}return!0}Wg(ob,Zb,Bc){let bd=Object.assign({},this.dataFields);bd.Method=ob;bd.Message=Zb;Bc&&(bd.Fields=Bc);return Nd.a.Ac(bd)}fld(ob){return Object(ja.a)(this,void 0,void 0,function*(){this.CAa||(this.CAa=this.$.Ib.Og("WebServiceCall","getTableInfoStopwatch"));
this.CAa.start();const Zb=sa.v(ob.range.topLeft,this.$),Bc=this.$.oa.va.Sb(),bd={Duration:-1};return new Promise(Ed=>{var ge=(be,qe,ze)=>Ea.s(this.$.oa.va,Zb,Object(ma.b)(be,Ce=>{!Ce||Fe.a(Ce)?(G.ULS.sendTraceTag(521249761,306,50,this.Wg("invokeGetTableInfoAction","Result returned with errors")),Ed(null)):(Ce=sa.D(Ce.Result.TableRange),this.CAa.stop(),bd.Duration=this.CAa.uc,G.ULS.sendTraceTag(522823199,306,50,this.Wg("invokeGetTableInfoAction","GetTableRange Succeeded",bd)),Ed(new sb.a(Ce,ob.sheetId)))}),
Object(ma.a)(qe,()=>{this.CAa.stop();bd.Duration=this.CAa.uc;G.ULS.sendTraceTag(522823198,306,50,this.Wg("invokeGetTableInfoAction","GetTableRange Failed",bd));Ed(null)}),ze,null,Bc);ge=I.EwaSettings.dc()?new cc.a(260,0,ge,88):new Je.a(260,0,ge,24);ge.Xma(()=>!0);this.$.userOperationManager.Ub(ge,null)})})}}Object(z.a)(Vc,"IntelligentMetadataOverlayManager",null,[721,2]);class P extends ya.a{constructor(ob){super();this.$=ob;this.Fb()}create(){const ob=D.GetServiceTaskFactory.Ra(this.$.da,20,404,
1),Zb=D.GetServiceTaskFactory.Ra(this.$.da,486,487,1);M.TaskExtensions.Aa(M.TaskExtensions.Wd([ob,Zb],this.$.la),()=>{const Bc=ob.result,bd=Zb.result;if(Bc&&bd){let Ed=this.$.da.za(426);Ed||(Ed=new Vc(this.$,Bc,bd),this.$.da.Ga(426,Ed));this.qb(Ed);G.ULS.sendTraceTag(537155667,0,50,"IntelligentMetadataOverlayManagerFactory.Create: IntelligentMetadataOverlayManager initialized successfully")}else null==Bc&&G.ULS.sendTraceTag(537155666,306,10,"IntelligentMetadataOverlayManagerFactory.Create: TableIntelligenceManager instance null."),
null==bd&&G.ULS.sendTraceTag(525620054,306,10,"IntelligentMetadataOverlayManagerFactory.Create: ProactiveSuggestionCard instance null."),this.qb(null)},this.$.la,3)}static ka(ob){ob.da.Ga(427,new P(ob))}}Object(z.a)(P,"IntelligentMetadataOverlayManagerFactory",ya.a,[]);var Ta=a(78),pb=a(454);class Yb{constructor(ob,Zb){this.text=this.cardViewManager=null;this.$=ob;this.Po=Zb}b8g(){const ob=this.c8g();pb.a(this.$,243,242,0,Zb=>{this.cardViewManager=Zb;Zb.z2f(this.Po,4,ob)})}y5h(){this.cardViewManager&&
this.cardViewManager.FKa(-1,-1,this.Po)}c8g(){const ob={};ob.description=this.text;const Zb={fieldType:0};Zb.display=this.text;ob.fields=[Zb];return ob}}Object(z.a)(Yb,"PivotTableHandRaiseCardManager",null,[]);var Ac=a(709);class Zc extends Ta.a{constructor(ob,Zb,Bc){super();this.gXb=null;this.isVisible=this.ojd=this.FZ=this.eN=!1;this.s$a=null;this.x5=(bd,Ed)=>{Ed?this.fdb():this.Dcc()};this.onKeyUp=bd=>{const Ed=bd.ys;bd=bd.Ca;switch(bd.keyCode){case 27:return this.eN?(this.Dcc(),this.Wca(Ed),!0):
!1;case 121:return bd.altKey&&bd.shiftKey?(this.eN?(this.Dcc(),this.Wca(Ed)):(this.fdb(),this.kKb(Ed)),!0):!1;case 17:return this.FZ||this.ojd?!1:(this.ojd=!0,window.setTimeout(()=>{this.ojd=!1},30),this.eN?(this.Dcc(),this.Wca(Ed)):(this.fdb(),this.kKb(Ed)),!0);default:return!1}};this.onKeyDown=bd=>{bd=bd.Ca;this.FZ=bd.ctrlKey&&17!==bd.keyCode;return 13===bd.keyCode&&this.eN?(this.nEf(),!0):!1};this.$=ob;this.jo=Zb.u3b(ob,Bc,()=>{this.nEf()},"","","","PivotTableHandRaisePointerDown",O.a.instance.ga(1825))}setRange(ob){this.gXb=
ob}get jz(){return this.jo.jz}dispose(){this.jo.dispose();this.$=null;super.dispose()}hAa(){this.hide();const ob=fb.g(this.$),Zb=ob.ib.Vi(this.gXb),Bc=ob.mg(this.gXb,Zb),bd=ob.Lf(Zb).Mm;var Ed=this.$.da.za(271);if((!Ed||!Ed.Qdi())&&Bc&&bd&&0<=Bc.x&&0<=Bc.y&&bd.width>Bc.width+160){Ed=Bc.bottomRight.x+this.jz;const ge=Bc.bottomRight.y;let be=!1;Ed+160>bd.bottomRight.x&&(Ed=Bc.topLeft.x-this.jz,be=!0);this.jo.Icg(Ac.a.mlj,null,Zb);this.jo.u6b(this.x5,Zb);this.Bp(Ed,ge,ob.rtl,Zb,be);I.EwaSettings.isChangeGateEnabled("OfficeVSO:5449290_RichTooltip")||
(this.jo.domElement(Zb).title=O.a.instance.Xa(683));this.$.frame.xt.mR(Qb.a.Fd,this.$.domElement,this.onKeyUp,Zb);this.$.frame.xt.pt(Qb.a.Kb,this.$.domElement,this.onKeyDown,!0);this.$.da.Za(211,qe=>{const ze=O.a.instance.ga(1825)+" "+O.a.instance.ga(1747);qe.setEnabled(!0);qe.readText(ze)});this.isVisible=!0}}fdb(){G.ULS.sendTraceTag(537154657,306,50,"PivotTableHandRaiseLaunchButton:ShowRichToolTip Show tooltip");I.EwaSettings.isChangeGateEnabled("OfficeVSO:5449290_RichTooltip")&&(this.s$a||(this.s$a=
new Yb(this.$,this.jo.domElement(1)),this.s$a.text=O.a.instance.Xa(683)),this.s$a.b8g())}Dcc(){this.s$a&&this.s$a.y5h()}hide(){this.isVisible&&(this.jo.hide(),G.ULS.sendTraceTag(537154656,306,50,"PivotTableHandRaiseLaunchButton:Hide Dismissing Pivot table hand rasie OOUI."),this.$.frame.xt.Ba(Qb.a.Fd,this.$.domElement,this.onKeyUp),this.$.frame.xt.At(Qb.a.Kb,this.$.domElement,this.onKeyDown,!0),this.isVisible=this.eN=this.FZ=!1)}Wca(ob){this.jo.getButton(ob).obb();this.eN=!1}kKb(ob){this.jo.getButton(ob).JFb();
this.eN=!0;this.$.da.Za(211,Zb=>{const Bc=O.a.instance.Xa(683)+" "+O.a.instance.ga(1826);Zb.setEnabled(!0);Zb.readText(Bc)})}nEf(){G.ULS.sendTraceTag(537154655,306,50,"PivotTableHandRaiseLaunchButton:OpenPane Pivot table hand rasie OOUI clicked.");const ob={SourceControlId:"PivotTableHandRaise"};ob.StartingRanges=[this.gXb];this.$.ud(2137617149,0,0,ob).continueWith(()=>{this.hide()})}Bp(ob,Zb,Bc,bd,Ed){this.jo.Bp(ob,Zb,Bc,bd,!1,Ed);G.ULS.sendTraceTag(556615632,306,50,"PivotTableHandRaiseLaunchButton:ShowAt Pivot table hand raise OOUI shown.")}}
Object(z.a)(Zc,"PivotTableHandRaiseLaunchButton",Ta.a,[]);var id=a(309);class gd{constructor(){this.pta=0;this.localStorage=new id.a;this.pta=this.WLh()}u$b(){return this.pta}fKd(){this.pta=0;this.RUf()}Qjd(){this.pta++;this.RUf()}WLh(){try{if(!this.localStorage.If())return 0;const ob=this.localStorage.getItem("PivotTableHandRaiseDismissCount");return ob?Number.parseLocale(ob):0}catch(ob){return G.ULS.sendTraceTag(522311635,306,10,"PivotTableHandRaiseLocalStorageLoaderSaver:getDismissCountFromCache failure"),
0}}RUf(){try{this.localStorage.If()&&this.localStorage.setItem("PivotTableHandRaiseDismissCount",this.pta.toString())}catch(ob){G.ULS.sendTraceTag(522311634,306,10,"PivotTableHandRaiseLocalStorageLoaderSaver:saveDismissCountToCache failure")}}}Object(z.a)(gd,"PivotTableHandRaiseLocalStorageLoaderSaver",null,[]);class Ub{constructor(ob){this.version=1;this.$Md=0;this.$=ob}u$b(){return Object(ja.a)(this,void 0,void 0,function*(){this.KTf||(this.KTf=this.XLh());return(yield this.KTf)+this.$Md})}fKd(){this.$Md=
0;this.aVf(0)}Qjd(){Object(ja.a)(this,void 0,void 0,function*(){this.$Md++;this.aVf(yield this.u$b())})}XLh(){return new Promise(ob=>{vb.v(this.$.oa.va,3,Zb=>{$a.a.rg(Zb.Errors)?(G.ULS.sendTraceTag(520370311,0,10,`readRoamingString encountered an error. Errors: ${$a.a.yc(Zb.Errors)}`),ob(Number.POSITIVE_INFINITY)):Zb.Result?(Zb=JSON.parse(Zb.Result),!Zb||null==Zb.version||null==Zb.pta||Zb.version<this.version?ob(0):ob(Zb.pta)):(G.ULS.sendTraceTag(520370310,0,50,"readRoamingString - Received null"),
ob(0))},(Zb,Bc,bd)=>{Zb=Xb.a.lf(Zb.data);G.ULS.sendTraceTag(520370309,0,10,`OnRoamingOperationFailure: Encountered errors for ${bd}. Errors: ${$a.a.yc(Zb)}.`);ob(Number.POSITIVE_INFINITY)},null,null)})}aVf(ob){ob!==Number.POSITIVE_INFINITY&&(ob=JSON.stringify({version:this.version,pta:ob}),vb.B(this.$.oa.va,3,ob,Zb=>{$a.a.rg(Zb.Errors)?G.ULS.sendTraceTag(520370308,0,10,`writeRoamingString encountered an error. Errors: ${$a.a.yc(Zb.Errors)}`):Zb.Result||G.ULS.sendTraceTag(520370307,0,10,"writeRoamingString failed to write to roaming service.")},
(Zb,Bc,bd)=>{Zb=Xb.a.lf(Zb.data);G.ULS.sendTraceTag(520370306,0,10,`OnRoamingOperationFailure: Encountered errors for ${bd}. Errors: ${$a.a.yc(Zb)}.`)},null,null))}}Object(z.a)(Ub,"PivotTableHandRaiseRoamingHandler",null,[735]);class Lc{constructor(ob,Zb,Bc,bd,Ed=null){this.Gof=I.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.MaxPivotTableHandRaiseCount",1);this.Hof=I.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.MaxPivotTableHandRaiseDismissCount",20);this.Eh=this.m9=this.RMa=
null;this.SMa=!1;this.Foc=this.Eoc=null;this.t2h=(ge,be)=>{ge=this.s2h(be);a:{switch(ge){case "InvalidContextInfo":case "SurveyParamsNull":be="Error";break a;case "Success":be="Success";break a}be=void 0}G.ULS.sendTraceTag(521441668,306,50,`PivotTableHandRaiseManager.handlePivotTableActivationCallback Results: ${JSON.stringify({result:ge,status:be})}`);return null};this.Vc=(ge,be)=>{be&&be.Ogf||(fb.g(this.$).ha.RF(this.Vc),I.EwaSettings.isChangeGateEnabled("OfficeVSO:6238554_PTPSRemoveCardUXFlight")||
I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseCardUX",!1)?(G.ULS.sendTraceTag(526984154,306,50,"PivotTableProactiveSuggestion: selection changed, hide hand raise card"),this.y5c()):this.Eh.hide())};this.$=ob;this.tableIntelligenceManager=Zb;this.svgIconProvider=Ed;this.rha=bd;this.F$d=this.m3d=0;I.EwaSettings.isChangeGateEnabled("OfficeVSO:6238554_PTPSRemoveCardUXFlight")||(this.Eh=new Zc(this.$,bd,Ed));this.proactiveSuggestionCard=Bc;ib.a.instance.Wb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ge=>
{this.m9=ge;ge.isFeatureEnabled("ExcelIdeasPivotTableHandRaise",!1).then(be=>this.SMa=be);this.RMa=ge.gma("ExcelIdeasPivotTableHandRaise",be=>{this.SMa=be.isEnabled})});(ob=ib.a.instance.Wb("Common.ISystemInitiatedFeedback"))&&ob.execute(ge=>{ge.Bqc("PivotTableHandRaiseSurface",this.t2h)});if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:7062246_RemovePivotTableHandRaiseRoamingFlight")||I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseRoaming",!1))this.Foc=new Ub(this.$);
I.EwaSettings.isChangeGateEnabled("OfficeVSO:6002302_PTPSOptOut")&&(this.Eoc=new gd)}get D3c(){return this.m3d}get xmf(){return this.F$d}g7(ob){return Object(ja.a)(this,void 0,void 0,function*(){var Zb;I.EwaSettings.isChangeGateEnabled("OfficeVSO:6622525_PTPSLogDuration")&&(Zb=Date.now());const Bc=yield this.HLj(ob);a:{switch(Bc){case "Success":case "SuccessWithLppDisabled":var bd="Success";break a;case "DismissCountAboveLimit":case "ExpandedRangeNull":case "IncorrectLicense":case "LppAndTableMetadataDisabled":case "NotInEditMode":case "NotPivotable":case "NoTableMetadata":case "RangeTooLarge":case "TriggerCountAboveMax":bd=
"Aborted";break a;case "ActiveRangeNull":case "ExpandRangeFailed":case "SystemInitiatedFeedbackNull":bd="Error";break a}bd=void 0}Zb={result:Bc,status:bd,duration:I.EwaSettings.isChangeGateEnabled("OfficeVSO:6622525_PTPSLogDuration")?Date.now()-Zb:void 0};G.ULS.sendTraceTag(521441669,306,50,`PivotTableHandRaiseManager.triggerHandRaise Results: ${JSON.stringify(Zb)}`)})}HLj(ob){return Object(ja.a)(this,void 0,void 0,function*(){I.EwaSettings.isChangeGateEnabled("OfficeVSO:6176249_UserActionLogs")&&
Od.b(this.$).Cd(ld.a.vXi,{},void 0,!0);if(!this.SMa)return G.ULS.sendTraceTag(537154654,306,50,"PivotTableHandRaiseManager:TriggerHandRaise License is not enabled."),"IncorrectLicense";if(!ob)return G.ULS.sendTraceTag(537154653,306,10,"PivotTableHandRaiseManager:TriggerHandRaise activeRangeForHandRaise is null."),"ActiveRangeNull";if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6212469_PTPSReadOnly")&&!this.$.ea.isEditMode)return G.ULS.sendTraceTag(523100545,306,50,"PivotTableHandRaiseManager:TriggerHandRaise not in edit mode."),
"NotInEditMode";if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:7062246_RemovePivotTableHandRaiseRoamingFlight")||I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseRoaming",!1)){if((yield this.Foc.u$b())>=this.Hof)return G.ULS.sendTraceTag(520370312,306,50,"PivotTableHandRaiseManager:TriggerHandRaise dismiss count above limit"),"DismissCountAboveLimit"}else if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6002302_PTPSOptOut")&&this.Eoc.u$b()>=this.Hof)return G.ULS.sendTraceTag(522311633,
306,50,"PivotTableHandRaiseManager:TriggerHandRaise dismiss count above limit"),"DismissCountAboveLimit";if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6138004_PTPSMaxCells")){try{var Zb=yield this.expandRange(ob)}catch(Bc){return"ExpandRangeFailed"}if(!Zb)return G.ULS.sendTraceTag(523776330,306,50,"PivotTableHandRaiseManager.triggerHandRaise expanded range is null"),"ExpandedRangeNull";if(176E4<Zb.WG)return G.ULS.sendTraceTag(523776329,306,50,"PivotTableHandRaiseManager.triggerHandRaise range is too large to generate suggestions"),
"RangeTooLarge";I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseNotOverlapData",!1)&&(ob=Zb)}if(I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseTestOnly",!1))return this.D3c<this.Gof?(this.oRd(ob),"SuccessWithLppDisabled"):"TriggerCountAboveMax";if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6578734_PTPSRemoveFlights")||I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseTableMetadataIntEnabled",!1)){Zb=this.FUh(ob);
if(!Zb)return"NoTableMetadata";if(this.ymi(Zb))return I.EwaSettings.isChangeGateEnabled("OfficeVSO:6578734_PTPSRemoveFlights")||I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseLppIntEnabled",!1)?this.flf(ob):this.D3c<this.Gof?(this.oRd(ob),"SuccessWithLppDisabled"):"TriggerCountAboveMax";G.ULS.sendTraceTag(537154652,306,50,"PivotTableHandRaiseManager:TriggerHandRaise table data is not pivotable.");return"NotPivotable"}return I.EwaSettings.isChangeGateEnabled("OfficeVSO:6578734_PTPSRemoveFlights")||
I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseLppIntEnabled",!1)?this.flf(ob):"LppAndTableMetadataDisabled"})}dispose(){this.Eh&&this.Eh.dispose();this.proactiveSuggestionCard&&this.proactiveSuggestionCard.dispose()}FUh(ob){var Zb;G.ULS.sendTraceTag(537154651,306,50,"PivotTableHandRaiseManager:GetRelevantRecognizedTable get table metadata info.");ob=null===(Zb=this.tableIntelligenceManager.X3a().Bac(new sb.a(ob,Pa.d(this.$.xa.pa)),6)[0])||void 0===Zb?void 0:Zb.table;
I.EwaSettings.isChangeGateEnabled("OfficeVSO:6785518_PTPSLogRecognizedTableID")&&ob&&G.ULS.sendTraceTag(520147406,306,50,`PivotTableHandRaiseManager.getRelevantRecognizedTable Found metadata with ID: ${ob.id}`);return ob}flf(ob){return Object(ja.a)(this,void 0,void 0,function*(){const Zb=ib.a.instance.Wb("Common.ISystemInitiatedFeedback");return Zb?(this.F$d=this.xmf+1,G.ULS.sendTraceTag(537154648,306,50,`PivotTableHandRaiseManager:TriggerHandRaise PivotTableHandRaiseActivity LPP activity log count: ${this.xmf}`),
I.EwaSettings.isChangeGateEnabled("OfficeVSO:6622525_PTPSLogDuration")?(yield new Promise(Bc=>{Zb.execute(Bc)})).logActivity("PivotTableHandRaiseActivity",null,ob):Zb.execute(Bc=>{Bc.logActivity("PivotTableHandRaiseActivity",null,ob)}),"Success"):"SystemInitiatedFeedbackNull"})}s2h(ob){G.ULS.sendTraceTag(537154647,306,50,"PivotTableHandRaiseManager:HandlePivotTableActivationCallback HandlePivotTableActivationCallback invoked.");return ob?!ob.contextInfo||!ob.contextInfo.length||1<ob.contextInfo.length?
(G.ULS.sendTraceTag(537154645,306,10,"PivotTableHandRaiseManager:HandlePivotTableActivationCallback no valid contextInfo in surveyParams."),"InvalidContextInfo"):this.oRd(ob.contextInfo[0].context):(G.ULS.sendTraceTag(537154646,306,10,"PivotTableHandRaiseManager:HandlePivotTableActivationCallback surveyParams is null."),"SurveyParamsNull")}oRd(ob){I.EwaSettings.isChangeGateEnabled("OfficeVSO:6238554_PTPSRemoveCardUXFlight")||I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseCardUX",
!1)?(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6176249_UserActionLogs")&&Od.b(this.$).Cd(ld.a.uXi,{},void 0,!0),G.ULS.sendTraceTag(526984158,306,50,"PivotTableProactiveSuggestion: show pivot table hand raise."),this.proactiveSuggestionCard.show(ob,O.a.instance.ga(1830),O.a.instance.Xa(685),O.a.instance.ga(1828),O.a.instance.ga(1829),()=>{I.EwaSettings.isChangeGateEnabled("OfficeVSO:6176249_UserActionLogs")&&Od.b(this.$).Cd(ld.a.tXi,{},void 0,!0);G.ULS.sendTraceTag(526984157,306,50,"PivotTableProactiveSuggestion:OpenPane Pivot table hand raise OOUI clicked.");
I.EwaSettings.isChangeGateEnabled("OfficeVSO:6423587_PTPSCardRaceConditionFix")&&this.proactiveSuggestionCard.hide();this.$.ud(2137617149,0,0,{SourceControlId:"PivotTableHandRaise",jjg:[ob]}).continueWith(()=>{I.EwaSettings.isChangeGateEnabled("OfficeVSO:7062246_RemovePivotTableHandRaiseRoamingFlight")||I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseRoaming",!1)?this.Foc.fKd():I.EwaSettings.isChangeGateEnabled("OfficeVSO:6002302_PTPSOptOut")&&this.Eoc.fKd();I.EwaSettings.isChangeGateEnabled("OfficeVSO:6423587_PTPSCardRaceConditionFix")||
this.proactiveSuggestionCard.hide()})},()=>{I.EwaSettings.isChangeGateEnabled("OfficeVSO:6176249_UserActionLogs")&&Od.b(this.$).Cd(ld.a.sXi,{},void 0,!0);G.ULS.sendTraceTag(526984156,306,50,"PivotTableProactiveSuggestion: Not Now clicked.");this.y5c()},void 0,void 0,void 0,void 0,I.EwaSettings.isChangeGateEnabled("OfficeVSO:6837335_PTPSNotOverlapRibbon")||I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseNotOverlapData",!1)?11:void 0,I.EwaSettings.isChangeGateEnabled("OfficeVSO:6837335_PTPSNotOverlapRibbon")?
[13,8,10,6,4,2,0]:void 0,void 0,Zb=>{Zb=Zb?new Sys.UI.DomEvent(Zb):null;"keydown"===(null===Zb||void 0===Zb?void 0:Zb.type)&&27===Zb.keyCode&&(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6176249_UserActionLogs")&&Od.b(this.$).Cd(ld.a.rXi,{},void 0,!0),this.y5c())},!1,!0)):(this.Eh.setRange(ob),this.Eh.hAa());fb.g(this.$).ha.NG(this.Vc);this.m3d=this.D3c+1;return"Success"}ymi(ob){for(let Zb of ob.interpretations)if(.75<=Zb.confidence&&2===Zb.orientation&&1===Zb.headerRowCount)return!0;return!1}expandRange(ob){return Object(ja.a)(this,
void 0,void 0,function*(){const Zb=fb.g(this.$);yield new Promise(qe=>{if(Zb.Ea.oK(4,this.$.pa))qe();else{const ze=()=>{Zb.Ea.oK(4,this.$.pa)&&(Zb.Uab(ze),qe())};Zb.cYa(ze)}});if(Zb.Db.zwa(ob))return G.ULS.sendTraceTag(521246810,306,50,"PivotTableHandRaiseManager.expandRange: Range is empty"),null;const Bc=Zb.Db.Yj(ob);if(Bc)return Bc.usedRange;const bd=yield D.GetServiceTaskFactory.cja(this.$.da,482,483,1),Ed=this.$.oa.va.Sb(),ge=Object(sa.o)(ob,this.$),be=Object(sa.v)(ob,this.$);return new Promise((qe,
ze)=>{var Ce=(Ve,we,vc)=>bd.getExpandedRangeForPivotTable(this.$.oa.va,be,ge,Object(ma.b)(Ve,ed=>{G.ULS.sendTraceTag(526790984,306,50,"PivotTableHandRaiseManager.getSelectionForHandRaise: Expanded range");ed=Object(sa.Z)(ed.Result,this.$.xa);ed.returnValue?qe(ed.range):(G.ULS.sendTraceTag(526790983,306,10,"PivotTableHandRaiseManager.getSelectionForHandRaise: Failed to parse expanded range"),ze(Error("PivotTableHandRaiseManager.getSelectionForHandRaise: Failed to parse expanded range")))}),Object(ma.a)(we,
()=>{G.ULS.sendTraceTag(526790982,306,10,"PivotTableHandRaiseManager.getSelectionForHandRaise: Failed to expand range");ze(Error("PivotTableHandRaiseManager.getSelectionForHandRaise: Failed to expand range"))}),vc,null,Ed);Ce=I.EwaSettings.dc()?new cc.a(511,0,Ce,88):new Je.a(511,0,Ce,24);Ce.Xma(()=>!0);this.$.userOperationManager.Ub(Ce,null)})})}y5c(){if(!I.EwaSettings.isChangeGateEnabled("OfficeVSO:6002302_PTPSOptOut")||this.proactiveSuggestionCard.isVisible)this.proactiveSuggestionCard.hide(),I.EwaSettings.isChangeGateEnabled("OfficeVSO:7062246_RemovePivotTableHandRaiseRoamingFlight")||
I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseRoaming",!1)?this.Foc.Qjd():I.EwaSettings.isChangeGateEnabled("OfficeVSO:6002302_PTPSOptOut")&&this.Eoc.Qjd()}}Object(z.a)(Lc,"PivotTableHandRaiseManager",null,[726,2]);class hd extends ya.a{constructor(ob){super();this.$=ob;this.Fb()}create(){const ob=D.GetServiceTaskFactory.Ra(this.$.da,20,404,1),Zb=D.GetServiceTaskFactory.Ra(this.$.da,486,487,1);let Bc=null;I.EwaSettings.isChangeGateEnabled("OfficeVSO:6238554_PTPSRemoveCardUXFlight")||
(Bc=D.GetServiceTaskFactory.Ra(this.$.da,12,477,1));let bd=null;!I.EwaSettings.isChangeGateEnabled("OfficeVSO:6238554_PTPSRemoveCardUXFlight")&&I.EwaSettings.ma(539)&&(bd=D.GetServiceTaskFactory.Ra(this.$.da,388,387,1));const Ed=[ob,Zb];Bc&&Ed.push(Bc);bd&&Ed.push(bd);M.TaskExtensions.Aa(U.Task.zL(...Ed),()=>{if(!this.$.da.za(430)){var ge=ob.result;const be=Zb.result,qe=null===Bc||void 0===Bc?void 0:Bc.result,ze=null===bd||void 0===bd?void 0:bd.result;ge&&be?(ge=new Lc(this.$,ge,be,qe,ze),this.qb(ge),
this.$.da.Ga(430,ge)):(null==ge&&G.ULS.sendTraceTag(537154644,306,10,"PivotTableHandRaiseManagerFactory.Create: TableIntelligenceManager instance null."),null==be&&G.ULS.sendTraceTag(525620053,306,10,"PivotTableHandRaiseManagerFactory.Create: ProactiveSuggestionCard instance null."),this.qb(null))}},this.$.la)}static ka(ob){ob.da.Ga(431,new hd(ob))}dispose(){this.$=null;super.dispose()}}Object(z.a)(hd,"PivotTableHandRaiseManagerFactory",ya.a,[]);var Kd=a(1250),Wd=a(1153),oe=a(27),We=a(34),Ze=a(48),
Be=a(28),af=a(47);class ff extends ub.a{constructor(ob){super(document.createElement("div"));this.$=ob;this.isMac=oe.a.isMac;this.onKeyDown=Zb=>{Zb=Zb.Ca;switch(Zb.keyCode){case 27:if(this.Pm.onDismiss)this.Pm.onDismiss(Zb);this.hide();return!0;default:return!1}};this.onKeyUp=Zb=>{Zb=Zb.Ca;switch(Zb.keyCode){case 121:return Zb.altKey&&Zb.shiftKey?(this.focus(),!0):!1;default:return!1}};this.Kaf=(Zb,Bc)=>Zb.x==Bc.x&&Zb.y==Bc.y&&Zb.width==Bc.width&&Zb.height==Bc.height;this.TVe=(Zb,Bc)=>{const bd=Zb.topLeft.y,
Ed=Zb.bottomRight.y,ge=Zb.topLeft.x;Zb=Zb.bottomRight.x;switch(Bc){case 0:return new Ze.a(ge+320,bd-166);case 1:return new Ze.a(ge-(320-(Zb-ge))/2,bd-166);case 2:return new Ze.a(Zb-320,bd-166);case 3:return new Ze.a(ge,bd);case 4:return new Ze.a(ge+320,Ed+166);case 5:return new Ze.a(ge-(320-(Zb-ge))/2,Ed+166);case 6:return new Ze.a(Zb-320,Ed+166);case 7:return new Ze.a(ge,Ed);case 8:return new Ze.a(ge-320,bd+166);case 9:return new Ze.a(ge-320,bd-(166-(Ed-bd))/2);case 10:return new Ze.a(ge-320,Ed-
166);case 11:return new Ze.a(Zb+320,bd+166);case 12:return new Ze.a(Zb+320,bd-(166-(Ed-bd))/2);case 13:return new Ze.a(Zb+320,Ed-166);default:throw Error(`Unhandled direction: ${Bc}`);}};this.mXd=()=>{this.isVisible?(this.jWj=Be.a.Wa.je.m,this.hide(),this.Vbg=af.a.instance.create(()=>{this.pQj()},this.Ifg,"ProactiveSuggestionCard.UpdateCardPosition",void 0,!0)):this.grid.view.Pq(this.mXd)};this.pQj=()=>{Be.a.Wa.je.m-this.jWj>=this.Ifg&&this.Wrc()};this.grid=fb.g(ob);this.hEd=null;this.Q0b=this.nU=
!1;this.Ifg=250;this.nNd=!1}show(ob,Zb,Bc,bd,Ed,ge,be,qe,ze,Ce,Ve,we,vc,ed,Id,Ld,ce){this.rootBounds=Sys.UI.DomElement.getBounds(this.grid.sva.mc);this.nNd=ce;this.Mfi=!!we;this.LIa=vc;this.Pm={range:ob,container:this.domElement,title:Zb,description:Bc,primaryButtonText:bd,secondaryButtonText:Ed,ZOi:ge,AQi:be,menuItems:qe,eEb:ze,y5:Ce,icon:Ve,direction:we,gapSpace:ed,onDismiss:Id,j8g:la=>{la&&(this.hEd=la)},setInitialFocus:Ld,ariaLabel:this.isMac?Zb+" "+O.a.instance.ga(1832):Zb+" "+O.a.instance.ga(1831)};
ob=this.Wrc();this.nU||(this.$.frame.xt.ra(Qb.a.Fd,this.$.domElement,this.onKeyUp),this.$.frame.xt.pt(Qb.a.Kb,this.$.domElement,this.onKeyDown,!0),this.nU=!0);this.$.da.Za(211,la=>{const jb=this.isMac?O.a.instance.ga(1832):O.a.instance.ga(1831);la.setEnabled(!0);la.readText(jb)});return ob}hide(){G.ULS.sendTraceTag(527218006,1,50,"ProactiveSuggestionUIControl.Hide: calling AppChrome API to unmount card UI.");I.EwaSettings.isChangeGateEnabled("OfficeVSO:6423587_PTPSCardRaceConditionFix")&&this.Vbg&&
this.Vbg.cancel();appChrome.unmountReactComponent(this.domElement);this.isVisible=!1;this.grid.view.Pq(this.mXd);this.nU&&(this.$.frame.xt.Ba(Qb.a.Fd,this.$.domElement,this.onKeyUp),this.$.frame.xt.At(Qb.a.Kb,this.$.domElement,this.onKeyDown,!0),this.nU=!1)}focus(){this.hEd&&this.hEd.focus()}dispose(){super.dispose()}getDirectionalHint(ob){var Zb,Bc,bd=this.grid.ib.Vi(ob);ob=this.grid.mg(ob,bd);bd=this.grid.Lf(bd).Mm;const Ed=this.TVe(ob,null!==(Zb=this.Pm.direction)&&void 0!==Zb?Zb:13);if(bd.pha(Ed))return null!==
(Bc=this.Pm.direction)&&void 0!==Bc?Bc:13;if(void 0===this.Pm.direction)return 11;if(this.LIa&&0<this.LIa.length)for(Zb=0;Zb<this.LIa.length;Zb++){if(Bc=this.TVe(ob,this.LIa[Zb]),bd.pha(Bc))return this.LIa[Zb]}else return this.Pm.direction}getCellBounds(ob){if(ob=this.grid.Vb(ob))if(ob.cell.Dk)if(this.grid.kaa(ob.cell.Sx.Od)){if(!I.EwaSettings.isChangeGateEnabled("OfficeVSO:6837335_PTPSNotOverlapRibbon"))return{WFa:this.grid.getCellBounds(ob.cell,!0),direction:void 0};var Zb=this.getDirectionalHint(ob.range);
if(void 0===Zb)G.ULS.sendTraceTag(512361876,1,15,"ProactiveSuggestionUIControl.GetCellBounds failed to show UI, direction is undefined");else return{WFa:this.grid.getCellBounds(ob.cell,!0),direction:Zb}}else G.ULS.sendTraceTag(525341026,1,15,"ProactiveSuggestionUIControl.GetCellBounds failed to show UI, gridViewBlock not found");else G.ULS.sendTraceTag(527218009,1,15,"ProactiveSuggestionUIControl.GetCellBounds: failed to show UI, formattedActiveCell is not in view.");else G.ULS.sendTraceTag(527218010,
1,15,"ProactiveSuggestionUIControl.GetCellBounds: failed to show UI, formattedActiveCell is null.")}getRangeBounds(ob){var Zb=this.grid.ib.Vi(ob),Bc=this.grid.mg(ob,Zb);const bd=this.grid.Lf(Zb);Zb=bd.Mm;if(!Zb.Dd(Bc))return{WFa:this.rootBounds,direction:this.Pm.direction};Bc=Zb.Ge(Bc);var Ed=Bc.topLeft.y;const ge=Bc.bottomRight.y,be=Bc.topLeft.x,qe=Bc.bottomRight.x;Bc=this.Pm.direction;if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6837335_PTPSNotOverlapRibbon")){if(Bc=this.getDirectionalHint(ob),
void 0===Bc)return{WFa:this.rootBounds,direction:this.Pm.direction}}else ob=new Ze.a(qe,ge-134),this.Q0b=!Zb.pha(ob);ob=Sys.UI.DomElement.getLocation(bd.domElement);Ed=new Sys.UI.Point(be+ob.x-Zb.topLeft.x,Ed+ob.y-Zb.topLeft.y);Zb=new Sys.UI.Point(qe+ob.x-Zb.topLeft.x,ge+ob.y-Zb.topLeft.y);Ed=We.a(this.$).gja(Ed);Zb=We.a(this.$).gja(Zb);return{WFa:new Sys.UI.Bounds(Ed.x,Ed.y,Zb.x-Ed.x,Zb.y-Ed.y),direction:Bc}}XIh(){const ob=this.getRangeBounds(this.Pm.range);return this.nNd&&!this.Kaf(ob.WFa,this.rootBounds)?
ob:this.getCellBounds(this.Pm.range)}Wrc(){if(!this.Pm)return!1;if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6837335_PTPSNotOverlapRibbon")){var ob=this.XIh();if(!ob)return G.ULS.sendTraceTag(512361875,1,15,"ProactiveSuggestionUIControl.renderCard: cardLayoutInfo is undefined"),!1;var Zb=ob.WFa;ob=ob.direction;if(void 0===Zb)return G.ULS.sendTraceTag(512361874,1,15,"ProactiveSuggestionUIControl.renderCard: bounds is undefined"),!1}else this.nNd?(Zb=this.getRangeBounds(this.Pm.range).WFa,I.EwaSettings.isChangeGateEnabled("OfficeVSO:6472403_FallbackCardLocation")?
this.Pm.direction=this.Q0b&&null!=this.LIa?this.LIa[0]:this.Pm.direction:this.Pm.direction=this.Mfi?this.Pm.direction:this.Q0b?11:13,this.Q0b=!1):(Zb=this.getCellBounds(this.Pm.range),Zb=null!=Zb?Zb[0]:void 0);if(this.Kaf(Zb,this.rootBounds))return G.ULS.sendTraceTag(525341025,1,15,"ProactiveSuggestionUIControl.RenderCard failed to show UI, targetBounds set to root"),!1;G.ULS.shipAssertTag(527218008,1,!!Zb,"ProactiveSuggestionUIControl.RenderCard: target cell bounds should not be null.");G.ULS.sendTraceTag(527218007,
1,50,"ProactiveSuggestionUIControl.RenderCard: calling AppChrome API to render card UI.");appChrome.renderProactiveSuggestionCard(Zb.y,Zb.x,Zb.y+Zb.height,Zb.x+Zb.width,this.Pm.container,this.Pm.title,this.Pm.description,this.Pm.primaryButtonText,this.Pm.secondaryButtonText,this.Pm.ZOi,this.Pm.AQi,this.Pm.menuItems,this.Pm.eEb,this.Pm.y5,this.Pm.icon,I.EwaSettings.isChangeGateEnabled("OfficeVSO:6837335_PTPSNotOverlapRibbon")?ob:this.Pm.direction,this.Pm.gapSpace,this.Pm.onDismiss,this.Pm.j8g,this.Pm.setInitialFocus,
this.Pm.ariaLabel);this.isVisible=!0;this.grid.view.Ls(this.mXd);return!0}}Object(z.a)(ff,"ProactiveSuggestionCard",ub.a,[749]);class Pe extends ya.a{constructor(ob){super();this.$=ob;this.Fb()}static ka(ob){ob.da.Ga(487,new Pe(ob))}create(){var ob;this.qb(null!==(ob=this.$.da.za(486))&&void 0!==ob?ob:this.$.da.Ga(486,new ff(this.$)))}dispose(){this.$=null;super.dispose()}}Object(z.a)(Pe,"ProactiveSuggestionCardFactory",ya.a,[]);var Ne=a(116);class se{constructor(ob){ob.Qx(Zb=>{void Zb.aaa(1).then(()=>
{const Bc=document.createElement("div"),bd=Object(fb.g)(ob).tj;appChrome.renderProactiveSuggestionDebugPane(Bc,bd,Ne.a.mu)})});I.EwaSettings.ma(291)&&I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligence",!1)&&void D.GetServiceTaskFactory.cja(ob.da,510,511,1)}}Object(z.a)(se,"ProactiveSuggestionDebugToolsManager",null,[]);class Wa extends ya.a{constructor(ob){super();this.$=ob;this.Fb()}static ka(ob){ob.da.Ga(509,new Wa(ob))}create(){this.qb(Object(Cc.c)(this.$.da,508,()=>
new se(this.$)))}}Object(z.a)(Wa,"ProactiveSuggestionDebugToolsManagerFactory",ya.a,[]);var Sb=a(1126);class wc{constructor(ob,Zb){this.$=ob;this.tableIntelligenceManager=Zb;ob.xa.Pf(()=>this.zXd());this.tableIntelligenceManager.RXa("Valid",()=>{this.zXd()});this.tableIntelligenceManager.RXa("Invalid",()=>{this.zXd()})}zXd(){const ob=[],Zb=[],Bc=[],bd=this.$.xa.pa;if(bd){var Ed=this.tableIntelligenceManager.X3a().Bac(new sb.a(Object(sa.f)(),bd.sheetId),2);for(const ge of Ed){if(ge.table.nE.sheetId!==
bd.sheetId)continue;Ed=this.QHh(ge.table);if(!Ed)continue;const be=Ed.Ena.clone();be.left+=Ed.headerColumnCount;be.top+=Ed.headerRowCount;let qe=!0,ze=!0;for(let Ce=0;Ce<Ed.fields.count;Ce++){const Ve=be.clone();2===Ed.orientation?(Ve.left+=Ce,Ve.right=Ve.left):(Ve.top+=Ce,Ve.bottom=Ve.top);1===Ed.fields.na(Ce).classification?(this.Mke(ob,Ve,ze),ze=!1):(this.Mke(Zb,Ve,qe),qe=!1)}Ed=this.ROh(Ed);null!=Ed&&Bc.push(Ed)}this.FHd();0<ob.length&&this.lz(ob,[32]);0<Zb.length&&this.lz(Zb,[33]);0<Bc.length&&
this.lz(Bc,[31])}else G.ULS.sendTraceTag(520147412,0,50,"GridHighlighter.updateGridHighlights: Active sheet null")}FHd(){const ob=[33,32,31];Object(fb.g)(this.$).lb.Mg(ob);Object(fb.g)(this.$).lb.fRa(new sb.a(null,Pa.d(this.$.pa)),ob)}Mke(ob,Zb,Bc){!ob.length||Bc?ob.push(Zb.clone()):(Bc=ob[ob.length-1],Bc.right+1===Zb.left?Bc.right=Zb.right:Bc.bottom+1===Zb.top?Bc.bottom=Zb.bottom:ob.push(Zb.clone()))}QHh(ob){var Zb=ob.interpretations;return 0===(null===Zb||void 0===Zb?void 0:Zb.count)?null:1===Zb.count?
Zb.na(0):2===Zb.count?Zb.na(0).confidence===Zb.na(1).confidence?(ob=2===Zb.na(0).orientation?Zb.na(0):Zb.na(1),Zb=1===Zb.na(0).orientation?Zb.na(0):Zb.na(1),new Sb.a(ob.Ena,ob.confidence,Zb.headerRowCount,ob.headerColumnCount,ob.orientation,ob.fields)):ob.interpretations.na(0).confidence>ob.interpretations.na(1).confidence?ob.interpretations.na(0):ob.interpretations.na(1):null}lz(ob,Zb){ob=sb.a.d7(Pa.d(this.$.pa),ob);Object(fb.g)(this.$).lb.vv(ob,Zb,!0)}ROh(ob){const Zb=ob.Ena.clone();if(2===ob.orientation){if(0===
ob.headerRowCount)return null;Zb.bottom=Zb.top+ob.headerRowCount-1}else{if(0===ob.headerColumnCount)return null;Zb.right=Zb.left+ob.headerColumnCount-1}return Zb}}Object(z.a)(wc,"RecognizedTableGridHighlighter",null,[]);class Uc extends ya.a{constructor(ob){super();this.$=ob;this.Fb()}static ka(ob){ob.da.Ga(511,new Uc(ob))}create(){void D.GetServiceTaskFactory.cja(this.$.da,20,404,1).then(ob=>{this.qb(Object(Cc.c)(this.$.da,510,()=>new wc(this.$,ob)))})}}Object(z.a)(Uc,"RecognizedTableGridHighlighterFactory",
ya.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataCleansing");Type.registerNamespace("_Ewa");y.a.Hi('.DataCleansingPane{background:#edebe9;height:100%;overflow:hidden;display:flex;flex-direction:column}.DataCleansingPaneHeader{position:relative;overflow:hidden;padding:16px 16px 16px 16px}.DataCleansingPaneBody{flex:auto;position:relative}.DataCleansingPaneTitle{position:relative !important;max-width:230px;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:normal;background:#edebe9;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.DataCleansingCloseButton{display:inline-block;padding:0 5px;font-size:16px}');
(()=>{x.a.Fa(ob=>{I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingStatefulTaskPane",!1)?(Xc.ka(ob),ia.ka(ob)):(Tb.ka(ob),ia.ka(ob),B.a.Ad(ob)||pd.ka(ob))})})();(()=>{x.a.Fa(ob=>{P.ka(ob)})})();(()=>{x.a.Fa(ob=>{hd.ka(ob)})})();Object(Kd.a)();Object(Wd.a)();(()=>{x.a.Fa(ob=>{Pe.ka(ob)})})();(()=>{x.a.Fa(ob=>{Wa.ka(ob)})})();(()=>{x.a.Fa(ob=>{Uc.ka(ob)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.datacleansing.js.map/b27b11a969f700a4a5c693ed94a72540/EwaDSEsNext.datacleansing.js.map