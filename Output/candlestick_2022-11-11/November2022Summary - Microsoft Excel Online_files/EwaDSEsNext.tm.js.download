'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[35],{1273:function(t,C,a){a.r(C);t=a(0);var c=a(15),b=a(98),d=a(78),f=a(11),e=a(221);class k extends e.a{constructor(v){super();this.$=v;this.Fb()}create(){const {RenderingFidelityTracker:v}=a(1273);let n=this.$.da.za(462);n||(n=this.$.da.Ga(462,new v));this.qb(n)}}Object(t.a)(k,"RenderingFidelityTrackerFactory",e.a,[]);var l=a(46);a.d(C,"RenderingFidelityTracker",function(){return m});class m extends d.a{constructor(){super();
this.Tzi=3E4;this.feb={};this.dZd={};this.Ise={};b.Health.instance.addQosPillar("Fidelity")}static ka(v){v.da.Ga(463,new k(v))}MIg(v,n,w,r){if(!(l.PageLoadTrackingInfo.instance.TJa(new Date)<this.Tzi)){var u=f.HelperMethods.Lba(()=>{var y=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(n),x=Object.keys(y),B=this.Ise[v];for(var z=0;z<x.length;z++){var A=x[z];this.dZd[A]||(null===B||void 0===B?0:B[A])&&this.feb[A]&&(this.feb[A]-=B[A])}this.Ise[v]=y;for(z=0;z<x.length;z++)if(B=x[z],!this.dZd[B])if(A=
y[B],this.feb[B]&&(A+=this.feb[B]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(B,A)){this.dZd[B]=!0;y=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(B);x=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(B);y&&x&&b.Health.instance.recordQosError(y,[x],!1,!0,!0,!1,null);c.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+B+", isHC:"+w+", scaleFactor:"+r+"}");break}else this.feb[B]=A});1<u&&c.ULS.sendTraceTag(527472323,
1,50,`RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration=${u}`)}}}Object(t.a)(m,"RenderingFidelityTracker",d.a,[681,2])},1416:function(t,C,a){function c(za){var Aa=za.replace(/-.*/g,()=>"");Aa=ub.get(Aa);return null!==Aa&&void 0!==Aa?Aa:Za&&za.startsWith("ooux")?"ooux":"other"}a.r(C);var b=a(0),d=a(15);class f{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=
this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(b.a)(f,"BrowserInfo",null,[]);class e{constructor(){this.Version=
this.Name=null}}Object(b.a)(e,"PluginInfo",null,[]);var k=a(4),l=a(27);class m{static fui(){if(k.AFrameworkApplication.fa.qa("LogBrowserInfoIsEnabled")){var za=m.RDh();try{const Aa=JSON.stringify(za);d.ULS.sendTraceTag(6903563,102,50,Aa)}catch(Aa){d.ULS.sendTraceTag(6903564,102,15,Aa.message)}}else d.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static dTh(){const za=window.navigator.plugins;if(!za||!za.length)return null;const Aa=[];for(let xc=0;xc<za.length;xc++){const zd=
za[xc].name,de=za[xc].version;Array.add(Aa,Object.assign(new e,{Name:zd,Version:de}))}return Aa}static RDh(){const za=new f,Aa=new Sys.StringBuilder;m.Zs(xc=>{za.DocElemClientHeight=xc},()=>document.documentElement.clientHeight,Aa);m.Zs(xc=>{za.DocElemClientWidth=xc},()=>document.documentElement.clientWidth,Aa);m.Zs(xc=>{za.DocElemOffsetHeight=xc},()=>document.documentElement.offsetHeight,Aa);m.Zs(xc=>{za.DocElemOffsetWidth=xc},()=>document.documentElement.offsetWidth,Aa);m.Zs(xc=>{za.ScreenAvailHeight=
xc},()=>window.screen.availHeight,Aa);m.Zs(xc=>{za.ScreenAvailWidth=xc},()=>window.screen.availWidth,Aa);m.Zs(xc=>{za.ScreenWidth=xc},()=>window.screen.width,Aa);m.Zs(xc=>{za.ScreenHeight=xc},()=>window.screen.height,Aa);m.Zs(xc=>{za.ScreenLogicalXdpi=xc},()=>window.screen.logicalXDPI,Aa);m.Zs(xc=>{za.ScreenLogicalYdpi=xc},()=>window.screen.logicalYDPI,Aa);m.Zs(xc=>{za.ScreenDeviceXdpi=xc},()=>window.screen.deviceXDPI,Aa);m.Zs(xc=>{za.ScreenDeviceYdpi=xc},()=>window.screen.deviceYDPI,Aa);m.Zs(xc=>
{za.WinInnerHeight=xc},()=>window.self.innerHeight,Aa);m.Zs(xc=>{za.WinInnerWidth=xc},()=>window.self.innerWidth,Aa);m.Zs(xc=>{za.WinOuterHeight=xc},()=>window.self.outerHeight,Aa);m.Zs(xc=>{za.WinOuterWidth=xc},()=>window.self.outerWidth,Aa);m.Zs(xc=>{za.WinOrientation=xc},()=>window.self.orientation,Aa);m.Zs(xc=>{za.WinDevicePixelRatio=xc},()=>window.self.devicePixelRatio,Aa);m.Zs(xc=>{za.SupportsTouch=xc},()=>l.a.gyc,Aa);m.Zs(xc=>{za.NavAppName=xc},()=>window.navigator.appName,Aa);m.Zs(xc=>{za.NavAppVersion=
xc},()=>window.navigator.appVersion,Aa);m.Zs(xc=>{za.NavLanguage=xc},()=>window.navigator.browserLanguage||window.navigator.language,Aa);m.Zs(xc=>{za.NavUserAgent=xc},()=>window.navigator.userAgent,Aa);m.Zs(xc=>{za.NavPlatform=xc},()=>window.navigator.platform,Aa);m.Zs(xc=>{za.NavPlugins=xc},m.dTh,Aa);m.Zs(xc=>{za.CalculatedDevicePixelRatio=xc},()=>m.devicePixelRatio,Aa);za.Error=Aa.toString();return za}static get devicePixelRatio(){const za=window.devicePixelRatio;return isNaN(za)?window.screen.deviceXDPI/
window.screen.logicalXDPI:za}static Zs(za,Aa,xc){try{const zd=Aa();za(zd)}catch(zd){xc.isEmpty()||xc.append(" | "),xc.append(zd.message||"null")}}}Object(b.a)(m,"BrowserInfoLogger",null,[]);var v=a(246);class n{get name(){return"Common.App.BrowserInfoLogger"}Rh(){}init(){m.fui()}dispose(){}static main(){v.a.instance.yi(new n)}}Object(b.a)(n,"BrowserInfoLoggerPackage",null,[4,5]);var w=a(80);class r{constructor(za){this.tDc=za}Lbf(za){if(!this.tDc)return!0;za=w.a.Add(za);if(!za)return!1;za=za.toLowerCase();
for(let Aa=0;Aa<this.tDc.length;Aa++)if(za.endsWith(this.tDc[Aa]))return!0;return!1}}Object(b.a)(r,"DomainAllowListManager",null,[]);class u{constructor(za,Aa){this.n$=null;this.YQc=za;this.url=Aa}get mYd(){return w.a.Jca(this.url)}get yt(){return this.YQc}aVd(){const za={},Aa=this.yt;za.a=this.mYd;za.b=this.round(Aa.navigationStart);za.c=this.round(Aa.unloadEventStart);za.d=this.round(Aa.unloadEventEnd);za.e=this.round(Aa.redirectStart);za.f=this.round(Aa.redirectEnd);za.g=this.round(Aa.fetchStart);
za.h=this.round(Aa.domainLookupStart);za.i=this.round(Aa.domainLookupEnd);za.j=this.round(Aa.connectStart);za.k=this.round(Aa.connectEnd);za.l=void 0!==Aa.secureConnectionStart&&null!==Aa.secureConnectionStart?this.round(Aa.secureConnectionStart):0;za.m=this.round(Aa.requestStart);za.n=this.round(Aa.responseStart);za.o=this.round(Aa.responseEnd);za.q=this.round(Aa.domInteractive);za.r=this.round(Aa.domContentLoadedEventStart);za.s=this.round(Aa.domContentLoadedEventEnd);za.t=this.round(Aa.domComplete);
za.u=this.round(Aa.loadEventStart);za.v=this.round(Aa.loadEventEnd);za.w=this.n$;return za}round(za){return Math.round(1E3*za)/1E3}}Object(b.a)(u,"PerformanceTimingEntry",null,[]);const y=(za,Aa)=>{const xc={};let zd=null;switch(za){case 0:zd="ResourceTiming";za=Aa.a;null!=za&&(xc.Url=za);za=Aa.b;null!=za&&(xc.InitiatorType=za);za=null==Aa.c?null:Aa.c.toString();null!=za&&(xc.RedirectStart=za);za=null==Aa.d?null:Aa.d.toString();null!=za&&(xc.RedirectEnd=za);za=null==Aa.e?null:Aa.e.toString();null!=
za&&(xc.FetchStart=za);za=null==Aa.f?null:Aa.f.toString();null!=za&&(xc.DomainLookupStart=za);za=null==Aa.g?null:Aa.g.toString();null!=za&&(xc.DomainLookupEnd=za);za=null==Aa.h?null:Aa.h.toString();null!=za&&(xc.ConnectStart=za);za=null==Aa.i?null:Aa.i.toString();null!=za&&(xc.ConnectEnd=za);za=null==Aa.j?null:Aa.j.toString();null!=za&&(xc.SecureConnectionStart=za);za=null==Aa.k?null:Aa.k.toString();null!=za&&(xc.RequestStart=za);za=null==Aa.l?null:Aa.l.toString();null!=za&&(xc.ResponseStart=za);
za=null==Aa.m?null:Aa.m.toString();null!=za&&(xc.ResponseEnd=za);za=Aa.n;null!=za&&(xc.CustomText=za);za=null==Aa.o?null:Aa.o.toString();null!=za&&(xc.DecodedBodySize=za);za=null==Aa.p?null:Aa.p.toString();null!=za&&(xc.EncodedBodySize=za);Aa=null==Aa.q?null:Aa.q.toString();null!=Aa&&(xc.TransferSize=Aa);break;case 1:zd="PerformanceTiming",za=Aa.a,null!=za&&(xc.Url=za),za=null==Aa.b?null:Aa.b.toString(),null!=za&&(xc.NavigationStart=za),za=null==Aa.c?null:Aa.c.toString(),null!=za&&(xc.UnloadEventStart=
za),za=null==Aa.d?null:Aa.d.toString(),null!=za&&(xc.UnloadEventEnd=za),za=null==Aa.e?null:Aa.e.toString(),null!=za&&(xc.RedirectStart=za),za=null==Aa.f?null:Aa.f.toString(),null!=za&&(xc.RedirectEnd=za),za=null==Aa.g?null:Aa.g.toString(),null!=za&&(xc.FetchStart=za),za=null==Aa.h?null:Aa.h.toString(),null!=za&&(xc.DomainLookupStart=za),za=null==Aa.i?null:Aa.i.toString(),null!=za&&(xc.DomainLookupEnd=za),za=null==Aa.j?null:Aa.j.toString(),null!=za&&(xc.ConnectStart=za),za=null==Aa.k?null:Aa.k.toString(),
null!=za&&(xc.ConnectEnd=za),za=null==Aa.l?null:Aa.l.toString(),null!=za&&(xc.SecureConnectionStart=za),za=null==Aa.m?null:Aa.m.toString(),null!=za&&(xc.RequestStart=za),za=null==Aa.n?null:Aa.n.toString(),null!=za&&(xc.ResponseStart=za),za=null==Aa.o?null:Aa.o.toString(),null!=za&&(xc.ResponseEnd=za),za=null==Aa.p?null:Aa.p.toString(),null!=za&&(xc.DomLoading=za),za=null==Aa.q?null:Aa.q.toString(),null!=za&&(xc.DomInteractive=za),za=null==Aa.r?null:Aa.r.toString(),null!=za&&(xc.DomContentLoadedEventStart=
za),za=null==Aa.s?null:Aa.s.toString(),null!=za&&(xc.DomContentLoadedEventEnd=za),za=null==Aa.t?null:Aa.t.toString(),null!=za&&(xc.DomComplete=za),za=null==Aa.u?null:Aa.u.toString(),null!=za&&(xc.LoadEventStart=za),za=null==Aa.v?null:Aa.v.toString(),null!=za&&(xc.LoadEventEnd=za),Aa=Aa.w,null!=Aa&&(xc.CustomText=Aa)}xc.Table=zd;return Sys.Serialization.JavaScriptSerializer.serialize(xc)};var x=a(52),B=a(218),z=a(316);class A{constructor(za,Aa=null,xc=null){this.Pg=za;this.lYd=this;this.Sog=Aa||(()=>
window.location.href);this.sGc=new r(xc)}run(){if(A.oP(window.performance))try{const de=this.Sog();if(A.rxg.exec(de)&&this.sGc.Lbf(de)){var za=new u(window.performance.timing,de);z.a.instance.C5i(za.yt.fetchStart);z.a.instance.D5i(za.yt.navigationStart);z.a.instance.dCb(x.a.NCh,"connectStart","requestStart");z.a.instance.dCb(x.a.VCh,"requestStart","responseStart");z.a.instance.dCb(x.a.YCh,"responseStart","responseEnd");this.lYd.Le(1,za.aVd());this.Pg.Ym(x.a.nua,za.yt.fetchStart);this.Pg.Ym(x.a.SCh,
za.yt.domainLookupStart);this.Pg.Ym(x.a.RCh,za.yt.domainLookupEnd);this.Pg.Ym(x.a.PCh,za.yt.connectStart);this.Pg.Ym(x.a.ZCh,za.yt.secureConnectionStart);this.Pg.Ym(x.a.OCh,za.yt.connectEnd);this.Pg.Ym(x.a.WCh,za.yt.requestStart);this.Pg.Ym(x.a.Lad,za.yt.responseStart);this.Pg.Ym(x.a.TCh,za.yt.responseEnd-za.yt.responseStart);this.Pg.Ym(x.a.XCh,za.yt.responseStart-za.yt.requestStart);var Aa=0,xc=0,zd=0;({transferSize:Aa,U6c:xc,z4c:zd}=this.jNj(de)).returnValue&&(this.Pg.Ym(x.a.$Ch,Aa),this.Pg.Ym(x.a.QCh,
zd),this.Pg.Ym(x.a.UCh,xc));this.Pg.Ym(x.a.Kad,za.yt.navigationStart)}}catch(de){d.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",de)}}jNj(za){let Aa,xc,zd;zd=xc=Aa=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:Aa,U6c:xc,z4c:zd};za=window.performance.getEntriesByName(za,"navigation");if(void 0===za||null===za||1!==za.length)return{returnValue:!1,transferSize:Aa,U6c:xc,z4c:zd};
za=za[0];var de=za.transferSize;void 0!==Aa&&null!==Aa&&(Aa=de);de=za.decodedBodySize;void 0!==de&&null!==de&&(zd=de);za=za.encodedBodySize;void 0!==za&&null!==za&&(xc=za);return{returnValue:!0,transferSize:Aa,U6c:xc,z4c:zd}}Le(za,Aa){d.ULS.sendTraceTag(4551815,306,50,y(za,Aa))}static get instance(){return A.Ma||(A.Ma=new A(B.a.instance,null,k.AFrameworkApplication.fa.qa("PerfTimingLoggerFilterDomainsIsEnabled")?k.AFrameworkApplication.fa.fw("ResourceLoggerDomainAllowList"):null))}static oP(za){return!(void 0===
za||null===za)&&!(void 0===za.timing||null===za.timing)}}A.Ma=null;A.rxg=RegExp("^https?://.*","i");Object(b.a)(A,"PerformanceTimingLogger",null,[760]);var I=a(95),F=a(84);class U{constructor(za,Aa){this.n$=null;this.YQc=za;this.behavior=Aa;this.url=this.yt.name}get mYd(){return 2===this.behavior?this.url:w.a.Jca(this.url)}get yt(){return this.YQc}aVd(){const za={},Aa=this.yt;za.a=this.mYd;za.b=Aa.initiatorType;za.c=this.round(Aa.redirectStart);za.d=this.round(Aa.redirectEnd);za.e=this.round(Aa.fetchStart);
za.f=this.round(Aa.domainLookupStart);za.g=this.round(Aa.domainLookupEnd);za.h=this.round(Aa.connectStart);za.i=this.round(Aa.connectEnd);za.j=void 0!==Aa.secureConnectionStart&&null!==Aa.secureConnectionStart?this.round(Aa.secureConnectionStart):0;za.k=this.round(Aa.requestStart);za.l=this.round(Aa.responseStart);za.m=this.round(Aa.responseEnd);za.o=this.round(U.Q3a(Aa,"decodedBodySize"));za.p=this.round(U.Q3a(Aa,"encodedBodySize"));za.q=this.round(U.Q3a(Aa,"transferSize"));za.n=this.n$;return za}round(za){return Math.round(1E3*
za)/1E3}static Q3a(za,Aa){return za[Aa]}}Object(b.a)(U,"ResourceTimingEntry",null,[805]);var X=a(98),S=a(134),H=a(41),D=a(110),J=a(186);class M{constructor(za,Aa=null,xc=100){this.O0d=za;this.MVb=Aa;this.Kfb={};this.Dlg=xc}yMj(za){var Aa=za.name.toLowerCase();const xc=w.a.Wua(Aa);this.rgj(xc,Aa)&&(xc in this.Kfb?d.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",xc):(Aa={},Aa.fetchstart=za.fetchStart,Aa.responseend=za.responseEnd,Aa.iscached=this.Vmi(za),
Aa.encodedsize=U.Q3a(za,"encodedBodySize"),Aa.decodedsize=U.Q3a(za,"decodedBodySize"),this.Kfb[xc]=Aa))}rgj(za,Aa){if(this.O0d)return Array.contains(this.O0d,za);if(this.MVb)for(za=w.a.HM(Aa),Aa=0;Aa<this.MVb.length;Aa++)if(this.MVb[Aa]&&za.endsWith(this.MVb[Aa]))return!0;return!1}Vmi(za){try{const Aa=U.Q3a(za,"transferSize");if(void 0!==Aa&&null!==Aa)return!Aa;d.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return za.responseEnd-
za.fetchStart<this.Dlg}catch(Aa){d.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",Aa.message)}return!1}$5i(){if(D.a.Dh(this.Kfb))d.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var za=k.AFrameworkApplication.ZE?k.AFrameworkApplication.ZE.split(";"):[],Aa=Object.assign(new J.a,{extendedProperties:S.a.Lr()});Aa.extendedProperties.set("Flights",H.c(za));this.nui(Aa,this.Kfb,
X.Health.instance)}}nui(za,Aa,xc){if(Aa){var zd=0,de=0,pe=0,$e=0,Df=0,Sf=0,Bf=0,kg=0,wf=0,lg=0,ng=0;for(let Qf in Aa){var If=Aa[Qf];try{const dg=Object(F.a)(Object,If);if(!dg)continue;const ph=dg.iscached?Boolean.parse(dg.iscached.toString()):!1,Ag=dg.fetchstart?this.parseFloat(dg.fetchstart.toString()):0,Sg=(dg.responseend?this.parseFloat(dg.responseend.toString()):0)-Ag,ch=dg.encodedsize?this.parseFloat(dg.encodedsize.toString()):0,ah=dg.decodedsize?this.parseFloat(dg.decodedsize.toString()):0;
zd+=Sg;$e+=ch;Bf+=ah;lg++;ph?(pe+=Sg,Sf+=ch,wf+=ah,ng++):(de+=Sg,Df+=ch,kg+=ah)}catch(dg){d.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",dg.message)}}za.extendedProperties.set("StaticResources",H.c(Aa));za.extendedProperties.set("TotalResourceDownloadLatency",zd.toString());za.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",de.toString());za.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",pe.toString());za.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
$e.toString());za.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Df.toString());za.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",Sf.toString());za.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Bf.toString());za.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",kg.toString());za.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",wf.toString());za.extendedProperties.set("TotalNumberOfResourcesDownloaded",
lg.toString());za.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",ng.toString());xc.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);xc.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",za)}}parseFloat(za){if(!za)return 0;za=parseFloat(za);return isNaN(za)?0:za}}Object(b.a)(M,"AppStaticResourceManager",null,[]);class G extends Sys.EventArgs{constructor(za){super();this.entries=za}}Object(b.a)(G,"EntriesAvailableEventArgs",Sys.EventArgs,
[]);var T=a(107);class K{constructor(za,Aa,xc=null,zd=null,de=100){this.qKc=!1;this.Pi=null;this.Lgb=0;this.$a=new I.a;this.Pfb=null;this.wS=!1;this.khe=0;this.fe=za;this.D3d=0;this.lYd=this;this.sGc=new r(xc);this.Gu=Aa;zd&&(this.Pfb=new M(null,zd,de))}get pte(){try{return!(void 0===this.Gu||null===this.Gu)&&!(void 0===this.Gu.getEntriesByType||null===this.Gu.getEntriesByType)}catch(za){return d.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",
za),!1}}get Fbh(){return this.D3d}get isActive(){return this.wS}get RUd(){return this.khe}jEg(za){this.$a.addHandler(K.z7c,za)}vaj(za){this.$a.removeHandler(K.z7c,za)}Rh(za,Aa){const xc=this.RUd!==za;this.khe=za;this.isActive&&this.fe&&xc&&(this.Xo(),this.Ag());this.D3d=Aa}activate(){!this.isActive&&this.pte&&(this.Ag(),this.wS=!0)}deactivate(za){this.isActive&&(this.Xo(),za&&this.flush(),this.wS=!1)}flush(){if(this.isActive&&this.pte)try{var za=window.performance.getEntriesByType("resource");0<za.length-
this.Lgb&&d.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",za.length-this.Lgb);const Aa=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);Aa&&(window.performance.clearResourceTimings(),this.Lgb=0);const xc=[];for(let zd=this.Lgb;zd<za.length;zd++)this.sGc.Lbf(za[zd].name)&&(this.Pfb&&this.Pfb.yMj(za[zd]),xc.push(new U(za[zd],this.Fbh)));Aa||(this.Lgb=za.length);this.$a.raiseEvent(K.z7c,
new G(xc));for(za=0;za<xc.length;za++)0!==xc[za].behavior&&2!==xc[za].behavior||this.lYd.Le(0,xc[za].aVd());0<xc.length&&d.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",xc.length)}catch(Aa){d.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",Aa)}}Le(za,Aa){d.ULS.sendTraceTag(4310804,306,50,y(za,Aa))}B5i(){this.Pfb.$5i()}Ag(){this.fe&&0<this.RUd&&(this.Pi=new T.a(3,2,1E3*this.RUd,()=>{this.flush()},
5),this.fe.Ag(this.Pi),this.qKc=!0)}Xo(){this.qKc&&(this.fe.Xo(this.Pi),this.Pi=null,this.qKc=!1)}}K.z7c="EntriesAvailable";Object(b.a)(K,"ResourceTimingLogger",null,[684,760]);var L=a(119);class V{constructor(){this.fb=null}get name(){return"Common.ResourceTiming"}init(){this.fb.resolve("Common.NetworkTiming.IResourceTimingLogger");A.instance.run()}dispose(){}Rh(za){this.fb=za;let Aa=null;if(k.AFrameworkApplication.fa.qa("ResourceLoggerFilterDomainsIsEnabled"))try{Aa=k.AFrameworkApplication.fa.fw("ResourceLoggerDomainAllowList")}catch(de){d.ULS.sendTraceTag(51652512,
306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const xc=[];xc.push(w.a.HM(L.a.kL).toLowerCase());xc.push(w.a.HM(L.a.Ccb).toLowerCase());const zd=k.AFrameworkApplication.fa.nd("AppStaticResourceMonitorCacheThresholdInMs",100);za.register(684,"Common.NetworkTiming.IResourceTimingLogger").tc().Fc(()=>new K(k.AFrameworkApplication.zi,window.performance,Aa,xc,zd))}static main(){v.a.instance.yi(new V)}}Object(b.a)(V,"ResourceTimingPackage",null,[4,5]);var W=a(83);class da extends Sys.EventArgs{constructor(za,
Aa){super();this.wIj=za;this.actualValue=Aa}}Object(b.a)(da,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var qa=a(165);class O{constructor(){this.CUa=[];this.b3d=this.HFc=0;this.Aea=null;this.$a=new I.a}init(za,Aa,xc){this.Aea=za;this.HFc=Aa;this.b3d=xc;this.Aea.Ime(Object(W.a)(this,this.KHi,"onCpuMeterFrameAvailable"));this.xFg(Object(W.a)(this,this.o3g,"cpuPercentThresholdExceeded"))}KHi(za,Aa){Aa.Zqf&&(Array.enqueue(this.CUa,Aa.Zqf.CP),this.CUa.length>this.b3d&&(Array.dequeue(this.CUa),
this.eWg()))}eWg(){var za=this.CUa.length;let Aa=0;for(let xc=0;xc<za;xc++){const zd=Array.dequeue(this.CUa);Aa+=zd;Array.enqueue(this.CUa,zd)}za=Aa/za;za>this.HFc&&this.$a.raiseEvent("CPTTE",new da(this.HFc,za))}o3g(za,Aa){qa.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.n5g(Aa.wIj,Aa.actualValue))}xFg(za){this.$a.addHandler("CPTTE",za)}n5g(za,Aa){const xc={};xc.ThresholdValue=za;xc.ActualValue=Aa;return xc}}Object(b.a)(O,"CpuMeterMonitor",null,[764]);var ea=a(155);class R{constructor(){this.S=
this.T=this.M=this.C=0}}Object(b.a)(R,"ProfileInformation",null,[]);var oa=a(13),pa=a(44),Pa=a(263);class Z{constructor(za=0,Aa=0){this.SIc=!1;this.VCa={};this.eTb=za;this.nTb=Aa;this.mRc=0;pa.a.addHandler(window.self,oa.a.bIg,()=>{this.SIc=!0});pa.a.addHandler(window.self,oa.a.cIg,()=>{this.SIc=!1})}eoe(za,Aa,xc){const zd=Z.generateKey(Aa,xc);zd in this.VCa?Aa=this.VCa[zd]:(Aa=new R,Aa.S=xc?1:0,this.VCa[zd]=Aa,this.mRc++);Aa.C++;Aa.M=za>Aa.M?za:Aa.M;Aa.T+=za}OG(za,Aa){this.eoe(za,Aa,!1);this.SIc&&
this.eoe(za,Aa,!0)}getData(){if(0<this.nTb&&this.mRc>this.nTb)return this.RKh();const za=0<this.eTb,Aa={},xc=this.VCa;for(let de in xc){var zd=de;const pe=xc[de];this.TTf(pe);za&&pe.T>=this.eTb&&(Aa[zd]=pe)}return za?D.a.Dh(Aa)?null:Aa:this.VCa}RKh(){var za=0<this.eTb,Aa=[];const xc=this.VCa;for(let zd in xc){const de={key:zd,value:xc[zd]};let pe=de.value;(!za||pe.T>=this.eTb)&&Array.add(Aa,de)}if(Aa.length>this.nTb)Aa.sort((zd,de)=>de.value.T-zd.value.T),Aa=Aa.slice(0,this.nTb);else if(!Aa.length)return null;
za={};for(const zd of Aa)Aa=zd.value,this.TTf(Aa),za[zd.key]=Aa;return za}TTf(za){za.M=Pa.a.s6(za.M,0);za.T=Pa.a.s6(za.T,0)}reset(){this.VCa={};this.mRc=0}static generateKey(za,Aa){return Aa?za+" [it]":za}}Object(b.a)(Z,"FunctionCallAggregator",null,[762]);class Ra{}Ra.iNg="BatchedOperation";Ra.replication="Replication";Ra.ONj="25";Ra.Bdj="9_"+Ra.iNg+"_"+Ra.replication;Object(b.a)(Ra,"CpuMeterConstants",null,[]);class Ga{}Object(b.a)(Ga,"CpuMeterFrame",null,[]);class Ba extends Sys.EventArgs{constructor(za){super();
this.Zqf=za}}Object(b.a)(Ba,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class fa{}Object(b.a)(fa,"MiniTaskItemInfo",null,[]);class Y{}Object(b.a)(Y,"TaskItemInfo",null,[]);var ja=a(550),ca=a(99);class aa{static f_h(){if(!aa.vPb&&(aa.vPb=new ca.a,k.AFrameworkApplication.fa&&k.AFrameworkApplication.fa.lo("AggregatorIdDisabledList"))){const za=k.AFrameworkApplication.fa.fw("AggregatorIdDisabledList");for(let Aa=0;Aa<za.length;Aa++)aa.vPb.ia(za[Aa],!0)}return aa.vPb}}aa.vPb=null;Object(b.a)(aa,
"DisabledAggregatorListStore",null,[]);var ta=a(266);class xa{constructor(za,Aa,xc,zd,de,pe=!0,$e=null){this.ZW=this.yge=this.W8d=!1;this.fe=null;if(!za)throw ta.a.argument("taskManagerLazy");if(!de)throw ta.a.argument("dataAggregator");this.Hwg=za;this.LMc=Aa;this._id=xc;this.s7d=6E4*zd;this.HQb=de;this.Nde=pe;this.Ckb=$e;aa.f_h().mb(this._id.toString())&&(this.ZW=!0)}get taskManager(){return this.fe||(this.fe=this.Hwg.value)}track(za,Aa=null){this.ZW||(this.Xkh(),this.Xjj(),this.HQb.OG(za,Aa))}Xjj(){!this.W8d&&
0<this.s7d&&(this.W8d=!0,this.GVf())}GVf(){const za=new T.a(5,1,this.s7d,()=>{this.Zlj()},19,this._id.toString());this.taskManager.Ag(za)}Zlj(){!this.Ckb||this.Ckb.xvj()?this.PWf():this.Nde&&this.HQb.reset();this.GVf()}PWf(){const za=this.HQb.getData();if(za){const Aa=parseInt(String(za.length));if(isNaN(Aa)||0<Aa)this.muc(za),this.Nde&&this.HQb.reset()}}muc(za){d.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:za})}Xkh(){this.yge||(this.LMc(()=>{this.PWf()}),
this.yge=!0)}static DM(za,Aa,xc,zd,de){return new xa(new ja.a(()=>k.AFrameworkApplication.zi),k.AFrameworkApplication.$Lb,za,Aa,xc,zd,de)}static V2a(za,Aa,xc){return xa.DM(za,Aa,xc,!0,null)}}Object(b.a)(xa,"Aggregator",null,[765]);class ia{constructor(za=null){this.Um=null;this.reset();this.Ckb=za}OG(za,Aa){if(!this.Ckb||this.Ckb.xvj())Aa in this.Um||(this.Um[Aa]=[]),this.Um[Aa].push(za)}getData(){return D.a.count(this.Um)?this.Um:null}reset(){this.Um={}}}Object(b.a)(ia,"NamedValuesAggregator",null,
[762]);var ya=a(262);class ib{constructor(za,Aa,xc,zd,de){this.uEa=0;this.bE=null;this.WUb=this.ige=0;this.yee=!1;this.$Ua=0;this.xib=!1;this.lqa=null;this.lSb=0;this.ube=new I.a;this.$Vb=[];this.HL=za;this.HLc=Aa;this.IHc=xc;this.I$d=zd;k.AFrameworkApplication.fa&&k.AFrameworkApplication.fa.qa("WrapSetTimeoutForTelemetryIsEnabled")&&this.Zqd();this.Yng=de;this.JHc=new Z(100);this.Trg=xa.V2a(1,5,new ia)}Ime(za){this.ube.addHandler("OnCpuMeterFrameAvailable",za)}P$a(za,Aa,xc,zd=null){xc=zd?zd.priority:
7;const de=this.HL();this.start(Aa,xc);try{za()}finally{this.stop(Aa,zd),za=this.HL()-de,this.I$d.track(za,Aa)}}GV(za,Aa){const xc=this.HL();try{za()}finally{za=this.HL()-xc,this.IHc.OG(za,Aa),0<this.uEa&&this.JHc.OG(za,Aa),this.I$d.track(za,Aa)}}TAd(za){const Aa=new Y;Aa.TN=za.cjc;Aa.TP=za.priority;this.FKf(1,Aa)}h8a(za){this.lSb|=za}start(za,Aa){if(!this.uEa){this.JHc.reset();const xc=this.ghf(za);xc&&this.Pud(1);this.bE=new Y;this.bE.TN=za;this.bE.TP=Aa;this.bE.ST=(new Date).toISOString();this.bE.STS=
Pa.a.s6(this.HL(),2);xc?this.bE.UI=1:this.Lii(za)?this.bE.UI=2:this.bE.UI=0}this.uEa++}Pud(za){this.$Ua|=za}e_c(za=!0,Aa=0){this.$Ua=za?0:this.$Ua&~Aa}stop(za,Aa=null){let xc;this.uEa--;0>=this.uEa&&this.bE&&(xc=this.HL()-this.bE.STS,this.WUb+=xc,this.HLc.OG(xc,za),this.ghf(za)&&this.e_c(!1,1),this.bE.TRT=Pa.a.s6(xc,2),Aa&&(this.bE.TQT=Pa.a.s6(Aa.c2i,2),this.bE.TDT=Pa.a.s6(Aa.zif,2)),this.Yng&&(this.FKf(0,this.bE),this.hej()),this.uEa=0);0<=za.indexOf(Ra.ONj)&&this.h8a(2);0<=za.indexOf(Ra.Bdj)&&this.h8a(4);
1===(this.$Ua&1)&&this.h8a(1);2===(this.$Ua&2)&&this.h8a(8)}hej(){var za=this.bE.TRT;if(750<za){let xc=this.JHc.getData();if(xc){const zd={};for(let de in xc){var Aa=xc[de];const pe=de;pe.startsWith("SiOp_")||pe.endsWith("[it]")||(zd[pe]=Math.round(100*Aa.T/za))}xc=zd}za=Object.assign(new fa,{B:this.bE.STS,T:za,S:xc});this.Trg.track(za,this.bE.TN)}}ICj(){var za=this.HL()-this.ige,Aa=Pa.a.s6(this.WUb/za*100,2);za=new Ga;za.CP=Aa;za.II=this.lSb;Aa=this.HLc.getData();D.a.count(Aa)&&(za.LRT=Aa);Aa=this.IHc.getData();
D.a.count(Aa)&&(za.FP=Aa);this.ube.raiseEvent("OnCpuMeterFrameAvailable",new Ba(za));this.f5f()}f5f(){this.HLc.reset();this.IHc.reset();this.WUb=this.uEa=0;this.ige=this.HL();this.lSb=0;this.bE=null}run(){this.yee?this.ICj():(this.f5f(),this.yee=!0);this.lqa?this.lqa(Object(W.a)(this,this.run,"run"),1E3):window.setTimeout(Object(W.a)(this,this.run,"run"),1E3)}ZSc(za,Aa,xc){const zd=Array(2);zd[0]=Aa;zd[1]=xc;this.$Vb[za]||(this.$Vb[za]=[]);this.$Vb[za].push(zd)}FKf(za,Aa){za=this.$Vb[za];if(!ya.a.Dh(za))for(let zd=
0;zd<za.length;zd++){var xc=za[zd];const de=xc[0];xc=xc[1];de&&!de(Aa)||xc(Aa)}}Zqd(){if(!this.xib){const za=window.setTimeout;this.lqa=(Aa,xc)=>za(Aa,xc);this.xib=!0}}ghf(za){return za.startsWith("key")||za.startsWith("input")}Lii(za){return za.startsWith("click")||za.startsWith("mouse")||za.startsWith("pointer")}}Object(b.a)(ib,"CpuMeter",null,[55]);class wa{constructor(za){this.Kgb=null;this.hk=new ea.a;this.HL=za}initialize(za,Aa,xc,zd=!1){this.Kgb||(this.Kgb=new ib(this.HL,za,Aa,xc,zd),this.hk.setResult(this.Kgb));
return this.Kgb}}Object(b.a)(wa,"CpuMeterProvider",null,[763]);class sa{constructor(za=1){this.gx=[];this.PQb=[];this._count=za}Pzh(){let za=0;for(let Aa=0;Aa<this.gx.length;Aa++)this.gx[Aa]<this.gx[za]&&(za=Aa);return za}OG(za,Aa){za=Pa.a.s6(za,2);if(this.gx.length<this._count)Array.add(this.gx,za),Array.add(this.PQb,Aa);else{var xc=this.Pzh();za>this.gx[xc]&&(this.gx[xc]=za,this.PQb[xc]=Aa)}}getData(){return this.gx.length?{["Vals"]:this.gx,["Desc"]:this.PQb}:null}reset(){this.gx=[];this.PQb=[]}}
Object(b.a)(sa,"MaxDataAggregator",null,[762]);var Ya=a(39),bb=a(82);class mb{get name(){return"Common.App.CpuMeter"}Rh(za){za.register(wa,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").tc().Fc(()=>new wa(Ya.a.Sd));za.register(O,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").tc().Fc(()=>new O)}init(){const za=k.AFrameworkApplication.fa;if(za.qa("CpuMeterIsEnabled")){const Aa=bb.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");z.a.instance.cpe.continueWith(()=>
{mb.J9h(za,Aa)})}}dispose(){}static J9h(za,Aa){const xc=xa.V2a(10,5,new Z(za.nd("TaskManagerLoggingThreshold",0),za.nd("CpuMeterMaximumEntriesToLog",0)));Aa=Aa.initialize(new sa(5),new Z,xc,za.qa("CPUMeterExposeTaskDetailsIsEnabled"));Aa.run();za.qa("CpuMeterMonitorIsEnabled")&&bb.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(Aa,za.Eua("CpuMeterAverageCpuPercentThreshold",80),za.nd("CpuMeterRollingAverageFramesCount",15));qa.a(16827671,306,50,"Initializing CpuMeter")}static main(){v.a.instance.yi(new mb)}}
Object(b.a)(mb,"CpuMeterPackage",null,[4,5]);var Ca=a(939);class $a{get name(){return"Common.App.EventsCachePackage"}Rh(){}init(){Ca.a.instance.init()}dispose(){}static main(){v.a.instance.yi(new $a)}}Object(b.a)($a,"EventsCachePackage",null,[4,5]);var Kb=a(10),rb=a(221),cc=a(1232),nc=a(163),Wb=a(370),Ea=a(203),ua=a(147),ma=a(59),fb=a(90),sb=a(1),Ua=a(22),ab=a(157),na=a(758);class Na extends cc.a{constructor(za,Aa,xc){super(Aa,xc);this.Qa=new I.a;this.h6h=zd=>{if(sb.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){const de=
zd.Values.m_Origin;k.AFrameworkApplication.wopiHostOriginFromPostMessage||(k.AFrameworkApplication.wopiHostOriginFromPostMessage=de)}switch(zd.MessageId){case nc.a.Rid:ab.a(this.$).G4e(zd);break;case nc.a.Csd:ua.a.ltas(null);break;case nc.a.Rcc:this.XLi();break;case nc.a.Wid:this.WLi(zd)}};this.$=za;xc!==na.a.l9&&this.$Ea(xc);this.Y$h();this.h$h();za=this.h6h;this.Tl(nc.a.Rid,za);this.Tl(nc.a.Csd,za);this.Tl(nc.a.Rcc,za);this.Tl(nc.a.Wid,za)}dispose(){this.$=null;super.dispose()}Y$h(){this.eo(nc.a.Vue);
this.eo(nc.a.Rid);this.eo(nc.a.Rcc);this.eo(nc.a.Wid);this.SSc(nc.a.Csd);this.eo(nc.a.Vid)}h$h(){this.dga(nc.a.Elb);this.dga(nc.a.tta);this.dga("App_CloseTab");this.dga(nc.a.HTa);this.dga(nc.a.ITa);this.dga(nc.a.J7e);this.dga(nc.a.Occ)}XLi(){const za={};za.hostMessageReceived=(new Date).getTime();d.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");k.AFrameworkApplication.Apd=!0;za.appUnloadStart=(new Date).getTime();za.sendBeaconFlight=k.AFrameworkApplication.fa.qa("SendBeaconOnShuttingDownRequestsEnabled");
za.sendBeaconSupported=ma.a.kda();ma.a.lpe();za.appUnloadEnd=(new Date).getTime();za.appMessageSent=(new Date).getTime();this.Fj(nc.a.rJg,za)}WLi(za){d.ULS.sendTraceTag(537162882,0,50,"EwaHostMessenger.OnHostSwitchMode");za.Values&&Wb.a.Jwd in za.Values&&Ua.a.equals(za.Values[Wb.a.Jwd],Ea.a.edit,!0)&&!this.$.isEditMode&&(d.ULS.sendTraceTag(537162881,0,50,`EwaHostMessenger.OnHostSwitchMode: Switching to ${za.Values[Wb.a.Jwd]}`),za=new fb.a(-8805455,0,1,0,null),this.$.Ka.Mb(za))}}Object(b.a)(Na,"EwaHostMessenger",
cc.a,[769,156,2]);class Va extends rb.a{constructor(za){super();this.Wze=!1;this.$=za;this.Fb()}create(){const za=this.$.da,Aa=bb.a.instance;if(!this.Wze){this.Wze=!0;let xc;xc=sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?this.$.ya.DocumentHostInfo.PostMessageOrigin||na.a.l9:k.AFrameworkApplication.eDd||na.a.l9;Aa.register(Na,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").tc().Fc(()=>new Na(this.$,window.parent,
xc,k.AFrameworkApplication.fa.qa("HostSendReadyToAcceptPostMessage")))}this.qb(za.za(21)||za.Ga(21,Aa.resolve("Postmessage.IHostPostmessenger")))}}Object(b.a)(Va,"HostMessengerFactory",rb.a,[]);var Sa=a(124),vb=a(146),Oa=a(681),yb=a(551),Ob=a(78),Ja=a(131),lb=a(454),Pb=a(45),Jb=a(313),Lb=a(346),Ab=a(350),nb=a(489),va=a(5),db=a(51);class Xa{constructor(za,Aa,xc){this.correlations=this.properties=this.operation=null;this.operation=za;this.properties=Aa;this.correlations=xc}static jxh(za,Aa,xc){const zd=
{},de=db.b();switch(za.command){case -1537138325:zd.Action=Aa.LabelText;break;case -1104934572:zd.PrevTab=de.nj(parseInt(Aa.OldContextCommand,10));zd.NextTab=de.nj(parseInt(Aa.NewContextCommand,10));break;case 802602464:zd.Origin=Aa[va.a.rU];break;case -1027730316:case -1059615499:zd.MenuType=Aa.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:"SqmControlId"in Aa&&(zd.SqmControlId=Aa.SqmControlId)}zd.InputMethod=Lb.a[za.method];zd.Location=
Ab.a[za.Re];zd.Mode=nb.a[za.mode];zd.ParentName=za.tabName;zd.IsSystemInitiated="IsSystemInitiated"in Aa?Aa.IsSystemInitiated:!1;zd.NoReporting="NoReporting"in Aa?Aa.NoReporting:!1;"ControlIdToLog"in Aa&&(zd.ControlId=Aa.ControlIdToLog);"TerminalParentControlIdToLog"in Aa&&(zd.TerminalParentControlId=Aa.TerminalParentControlIdToLog);for(const pe of Object.keys(xc))zd[pe]=xc[pe];return zd}}Object(b.a)(Xa,"InteractivityRecord",null,[]);class gb extends Xa{constructor(za,Aa,xc){super(za.operation,za.properties,
za.correlations);this.timeFromNavigationStart=this.timeFromAppInteractive=0;this.timeFromAppInteractive=Aa;this.timeFromNavigationStart=xc}}Object(b.a)(gb,"FirstUserInteractivityRecord",Xa,[]);var Ha=a(637);class tb{constructor(){this.commandSurface=this.triggerMethod=Sa.a.Beb}static Y9h(){tb.m2a||(tb.m2a=new Ha.a(yb.a.Sk()),tb.m2a.add("InputMethod"),tb.m2a.add("Location"),tb.m2a.add("Mode"))}}tb.m2a=null;Object(b.a)(tb,"ExcelUserAction",null,[]);var bc=a(201),tc=a(46),Ma=a(425),Tb=a(212);class zb extends Ob.a{constructor(za){super();
this.y$e=0;this.zSe=!1;this.prd=Array(zb.k8a);this.$3b=0;this.$=za;this.Lyb=sb.EwaSettings.ma(78);this.Hgf=sb.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");this.pji=sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5893585_PageLoadEngagementInfo");Sa.a.xSh();this.Maa={};zb.XWb||(zb.XWb=new Oa.a(yb.a.Sk()),zb.g9h(zb.XWb));tb.Y9h();if(sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(za=0;za<zb.k8a;za++)this.prd[za]="NA"}dispose(){this.$=
this.Maa=null;super.dispose()}fRf(za,Aa,xc){if(this.Lyb){var zd=db.b().nj(za.command),de=JSON.stringify(za);zd||d.ULS.sendTraceTag(537155555,3,50,`InteractivityLogger.ReportCommand: command name is null or empty. commandName: ${zd}, command: ${za.command}, commandInfo: ${de}`);Aa=Xa.jxh(za,Aa,xc);xc=!!Aa&&(!("IsSystemInitiated"in Aa)||!Aa.IsSystemInitiated);this.$&&this.$.ea.Fg&&xc&&Ca.a.instance.iMf("OtelUserAction",new Ma.a(zd,za.tabName,Date.now()));this.vRf(zd,Aa,null,!0,!0)}}Cd(za,Aa,xc=null,
zd=!1){this.Lyb&&this.vRf(za,Aa,xc,!1,zd)}MSd(za){if(this.Lyb)if(this.Maa){++this.y$e;this.Maa[za]||(this.Maa[za]=[]);var Aa=this.y$e.toString();this.Maa[za].push(Aa);d.ULS.sendTraceTag(537155553,0,50,`StartInteractivityCorrellation - '${za}', correlation=${Aa}`)}else d.ULS.shipAssertTag(537155554,0,!1,`StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${za}] == null`)}cTd(za){if(this.Lyb)if(this.Maa&&this.Maa[za]){var Aa=this.Maa[za],xc=Aa.pop().toString();
Aa.length||delete this.Maa[za];d.ULS.sendTraceTag(537155551,0,50,`StopInteractivityCorrellation - '${za}', correlation=${xc}`)}else d.ULS.shipAssertTag(537155552,0,!1,`StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${za}] == null`)}IP(za,Aa,xc=!1){return this.Lyb?Jb.a(zd=>{this.Cd(za,zd(),void 0,xc)},zb.yIj,this.la,Pb.a.Xbi,!1,!Aa):null}vJd(){let za="";for(let Aa=0;Aa<zb.k8a;Aa++)za+=this.prd[(this.$3b+zb.k8a-Aa-1)%zb.k8a]+",";d.ULS.sendTraceTag(557188890,
0,15,`Last operations ${za}`)}PRj(za){za&&(this.prd[this.$3b]=za,this.$3b=(this.$3b+1)%zb.k8a)}kui(za,Aa,xc){k.AFrameworkApplication.E6b();const zd=za.operation,de=za.properties;void 0!==xc?lb.a(this.$,432,433,0,pe=>{pe.b6i(zd,de,xc)}):this.VNj(za);this.WNj(za);this.AUi(Aa,de,zd)}VNj(za){this.MBj(za)||(this.zSe=!0,za=new gb(za,tc.PageLoadTrackingInfo.instance.TJa(new Date),tc.PageLoadTrackingInfo.iz()),za=Sys.Serialization.JavaScriptSerializer.serialize(za),d.ULS.sendTraceTag(458261331,0,50,`${za}`))}MBj(za){const Aa=
za.properties;za=za.operation;return this.zSe||void 0===za||null===za||za===Ja.a.xSc||za===Ja.a.wMd||za===Ja.a.CDd||ma.a.God(za)||!!Aa&&"IsSystemInitiated"in Aa&&Aa.IsSystemInitiated}WNj(za){sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.PRj(za.operation);za=Sys.Serialization.JavaScriptSerializer.serialize(za);d.ULS.sendTraceTag(21542793,0,50,`${za}`)}AUi(za,Aa,xc){Sa.a.qka()&&(Aa?"NoReporting"in Aa&&Aa.NoReporting||"IsSystemInitiated"in Aa&&Aa.IsSystemInitiated||
!za&&!this.Hgf||((za=Sa.a.Uj(Aa,zb.XWb,tb.m2a))?(Aa=zb.rxh(Aa))?vb.a.sendUserActionEvent(Sa.a.D3b(xc,null,Aa.triggerMethod,Aa.commandSurface,za)):d.ULS.sendTraceTag(537155550,0,50,"user action was null"):d.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):d.ULS.sendTraceTag(537155548,0,50,`Not logging action telemetry because adction data was null, actionName: ${xc}`))}vRf(za,Aa,xc,zd,de){const pe=bc.a(this.$);if(this.Hgf){let Df=null;Ua.a.equals(za,Ja.a.Ztc,!0)&&
Aa&&"InputMethod"in Aa&&(Df=Ja.a.vTe(za,Aa.InputMethod));pe.jIb(Df||za,xc)}else Ua.a.equals(za,Ja.a.Ztc,!0)&&Aa&&"InputMethod"in Aa&&(za=Ja.a.vTe(za,Aa.InputMethod)),pe.jIb(za,xc);Aa&&(Aa.IsCommand=zd);let $e=void 0;this.pji&&($e="ActionRelativeTime"in Aa?Aa.ActionRelativeTime:tc.PageLoadTrackingInfo.iz());Object(Tb.c)(()=>{const Df=new Xa(za,Aa,this.Maa);this.kui(Df,de,$e)},this.$.la,50)}static rxh(za){if(!za)return null;const Aa=new tb;"InputMethod"in za&&(Aa.triggerMethod=za.InputMethod);"Location"in
za&&(Aa.commandSurface=za.Location);return Aa}static g9h(za){za?(za.add("Origin",2),za.add("InputMethod",2),za.add("ButtonType",2),za.add("selectedRange",2),za.add("SelectedRanges",2),za.add("editRange",2),za.add("Location",2),za.add("Mode",2),za.add("CurrentSelectionMode",2),za.add("Action",2),za.add("type",2),za.add("floatingObjectType",2),za.add("PrevTab",2),za.add("NextTab",2),za.add("DialogName",2),za.add("dx",3),za.add("dy",3),za.add("NumberOfSelectedRanges",3),za.add("IsCommand",1),za.add("IsInFormulaBarEdit",
1),za.add("isLink",1),za.add("isSheetRef",1),za.add("isEmptyText",1),za.add("isFormula",1),za.add("IsResizingHiddenHeader",1)):d.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")}}zb.yIj=1E3;zb.k8a=40;zb.XWb=null;Object(b.a)(zb,"InteractivityLogger",Ob.a,[15]);var ic=a(50),Qb=a(37),wb=a(7);class hc{constructor(){this.appInfoProperties=this.appState=null}}Object(b.a)(hc,"CurrentAppInfo",null,[]);const Za=sb.EwaSettings.isChangeGateEnabled("OfficeVSO:6476239_OfficeOnlineUxInteractivityBucket"),
ub=new Map;[{name:"keyboard_selection",actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit active_cell_selection_change_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set(["active_cell_selection_change","cell_text_active_cell_selection_change","formulaBar_active_cell_selection_change"])},{name:"headers",actions:new Set(["header_resize_start","header_resize_autofit"])}].forEach(za=>{za.actions.forEach(Aa=>{ub.set(Aa,za.name)})});class uc{constructor(){this.value=this.key=null}}Object(b.a)(uc,"AppInfoProperty",null,[]);class Oc{constructor(za){this.$=za}getAppState(){const za=tc.PageLoadTrackingInfo.instance.TJa(new Date);
return-1===za?"boot":3E4>za?"postboot":"steady"}isChangeGateEnabled(za){return sb.EwaSettings.isChangeGateEnabled(za)}getBooleanFeatureGate(za,Aa){return sb.EwaSettings.getBooleanFeatureGate(za,Aa)}getCurrentAppInfo(){return Object(wb.a)(new hc,{appState:this.getAppState(),appInfoProperties:[Object(wb.a)(new uc,{key:"coauthCount",value:this.$.ea.Jm.length.toString()})]})}sendBeaconTraceTag(za,Aa,xc,zd){this.$.sendBeaconTraceTag(za,Aa,xc,zd)}getActionBucket(za){return c(za)}getAppInfoForReport(){return`${"maxCoauthCount"}: ${this.$.ea.Uyi}`}}
Object(b.a)(Oc,"InteractivityTrackerCallbacks",null,[804]);class Bb{constructor(){this.events=null;this.durationThresholdInMs=0;this.patchTaskScheduling=this.callbacks=null}}Object(b.a)(Bb,"InteractivityTrackerOptions",null,[]);var Nb=a(196);class dc{constructor(za){this.Naa=null;if(dc.sdf)d.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization.");else{if(sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker"))this.initialize(za);
else{const Aa=ic.GetServiceTaskFactory.Ra(za.da,283,284,1);Qb.TaskExtensions.Aa(Aa,()=>{Qb.TaskExtensions.Aa(Nb.c(Aa.result.Zn.loadScript(va.a.x$e)),()=>{d.ULS.sendTraceTag(537155544,0,50,"Interactivity slice is loaded");this.initialize(za)},za.la,3)},za.la,3)}dc.sdf=!0}}initialize(za){d.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");if(this.Naa=interactivity.InteractivityTrackerFactoryGlobal.create()){const Aa=new Bb;sb.EwaSettings.gqd()&&dc.Z6f.push(oa.a.B9);
Aa.events=dc.Z6f;Aa.durationThresholdInMs=dc.durationThresholdInMs;Aa.callbacks=new Oc(za);Aa.patchTaskScheduling=sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PatchClientTaskScheduling",!1);za=this.Naa.start(Aa);za.started?d.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):d.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+za.failureReason)}else d.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")}TAa(za,
Aa,xc){this.Naa?this.Naa.track(za,Aa,xc):d.ULS.sendTraceTag(524326924,0,50,`InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: ${Aa}`)}RDe(){return this.Naa?this.Naa.createActionsRetriever():(d.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),null)}dispose(){this.Naa&&(this.Naa.stop(),this.Naa=null)}}dc.durationThresholdInMs=100;dc.Z6f="click mousedown contextmenu keypress keydown dblclick touchend".split(" ");
dc.sdf=!1;Object(b.a)(dc,"InteractivityTrackerService",null,[301]);var sc=a(696);class yc extends rb.a{constructor(za){super();this.$=za;this.Fb()}create(){if(sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")){const za=ic.GetServiceTaskFactory.Ra(this.$.da,283,284,this.hb);Qb.TaskExtensions.Aa(za,()=>{Qb.TaskExtensions.Aa(Nb.c(za.result.Zn.loadScript("interactivity")),()=>{this.qb(Object(sc.a)(this.$.da,443,()=>new dc(this.$)))},this.$.la,3)},this.$.la,
3)}else this.qb(Object(sc.c)(this.$.da,443,()=>new dc(this.$)))}static ka(za){za.da.Ga(444,new yc(za))}}Object(b.a)(yc,"InteractivityTrackerServiceFactory",rb.a,[]);var cd=a(86),pd=a(380),Rb=a(8),Dc=a(47),nd=a(189),od=a(58);class wd{constructor(za){this.tCj=za}getCustomProperties(za){const Aa=new Map;if(za.hasOwnProperty("startTimeInMs")&&za.hasOwnProperty("totalExecutionTimeInMs")){const xc=za.startTimeInMs;za=this.tCj.retrieveSlowActionsBetweenTimeRange(xc,xc+za.totalExecutionTimeInMs);Aa.set("actions",
od.a.Ac(za))}return Aa}}Object(b.a)(wd,"CallTreeCustomPropertiesRetriever",null,[787]);class Pc{constructor(){this.customProperties=new Map}addCustomProperty(za,Aa){this.customProperties.set(za,Aa)}getCustomProperties(){return this.customProperties}}Object(b.a)(Pc,"CustomPropertiesRetriever",null,[785]);class Hb{isFeatureEnabled(za,Aa){return sb.EwaSettings.getBooleanFeatureGate(za,Aa)}}Object(b.a)(Hb,"ExcelFeatureChecker",null,[786]);class Nc{isProfilingEnabled(){return!0}}Object(b.a)(Nc,"ExcelProfilingFeatureChecker",
null,[788]);class Db{constructor(za,Aa){this.CRi=za;this.ERi=Aa}onProfilerEvent(za){switch(za.eventId){case 1:this.CRi(sb.EwaSettings.isChangeGateEnabled("OfficeVSO:6144046_KeepOldCollectedActions"));break;case 0:this.ERi();break;default:d.ULS.sendTraceTag(537155529,0,15,`JSCPUIJSCPUProfilerObserver.OnProfilerEvent: got unhandled profilerEventId ${za.eventId}`)}}}Object(b.a)(Db,"JSCPUProfilerObserver",null,[784]);class Cc{constructor(){this.samplingIntervalInMs=0;this.idleIntervalInMs=this.profilingIntervalInMs=
this.maximumNumberOfSamplesToTake=null}}Object(b.a)(Cc,"JSCPUProfilerInitOptions",null,[]);class Xc{constructor(){this.shouldMakeSerializedCallTreesFullyReconstructible=this.shouldKeepQueryParamsInResourceURLs=this.shouldProcessProfileCapturedWhileUserIsIdle=this.shouldSendProfilesForDeobfuscationImmediately=this.canUseMultipleWebWorkers=this.shouldUseInMemoryLogger=this.featureEnabledChecker=this.deObfuscationRequestQueryParamsRetriever=this.deObfuscationRequestBodyPropertiesRetriever=this.durationThresholdInMsToLogOperationData=
this.shouldAlwaysLogOperationsData=this.shouldUseSendBeaconForSendingCallTrees=this.shouldSendAllCallTreesFromProfileInASingleRequest=this.frameTotalExecutionTimeFilteringThresholdInMs=this.shouldCompressSerializedCallTrees=this.shouldRecordExpandedTimeStamps=this.profilerTraceProcessingWebWorkerSourceURL=this.useMainEventLoopForProfilerTraceProcessing=this.shouldKeepSamplesOutsideOfProfilingInterval=this.shouldProfilingStartInAHiddenDocument=this.shouldProcessProfileCapturedInAHiddenDocument=this.callTreeFilteringThresholdInMs=
this.deObfuscationEndpoint=this.ulsInstance=this.buildVersion=this.appName=null}}Object(b.a)(Xc,"JSCPUProfilingPackageInitOptions",null,[]);class ld{constructor(za,Aa){this.interactivityTrackerService=this.m5f=this.HEd=this.Q$a=this.IEd=this.aJf=this.bJf=null;this.Q0i=new Set([1,0]);d.ULS.sendTraceTag(537155528,0,50,"JsSelfProfilerManager.Ctor: creating new JsSelfProfilerManager");this.$=za;this.interactivityTrackerService=Aa;this.V$h();this.U$h();this.Ooi=this.$.ya.JsProfilingSampleIntervalInMs;
this.profilingIntervalInMs=sb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingWindowDurationInMs",1E4);this.MAe=sb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingIdleIntervalInMs",3E5);this.wEj()}dispose(){d.ULS.sendTraceTag(537155527,0,50,"JsSelfProfilerManager.Dispose");cd.a.Ia(this.m5f);this.HEd=this.$=null;this.IEd.clear();this.Q$a.clear()}PDj(){const za=Math.random()*this.MAe;d.ULS.sendTraceTag(537155526,0,50,`JsSelfProfilerManager.Ctor: starting ContinuousSessionProfiler in: ${za}`);
this.m5f=Dc.a.instance.create(()=>{this.ved("ExcelOnlineContinuousSessionProfiler",2).start()},za,Pb.a.Nuj,!0)}aEj(){d.ULS.sendTraceTag(537155525,0,50,"JsSelfProfilerManager.StartFullSessionProfiler: Starting a new profiler");this.ved("ExcelOnlineFullSessionProfiler",3).start()}hEj(za){d.ULS.sendTraceTag(537155524,0,50,"JsSelfProfilerManager.StartManualProfiler: Starting a new profiler");this.Vef(za)?this.ved(za,0,1E4).start():d.ULS.shipAssertTag(537155523,0,!1,"JsSelfProfilerManager.StartManualProfiler: Profiler name is invalid.")}fFj(za){this.Vef(za)?
(za=this.f0e(za))&&za.stop():d.ULS.shipAssertTag(537155522,0,!1,"JsSelfProfilerManager.StopManualProfiler: Profiler name is invalid.")}GEd(za){return this.Q$a.has(za)}wEj(){sb.EwaSettings.L0e()||(sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FullSessionJSProfiler",!1)?this.aEj():this.PDj())}createProfiler(za,Aa,xc,zd,de,pe){d.ULS.sendTraceTag(537155521,0,50,"JsSelfProfilerManager.CreateProfiler: Creating a new profiler");const $e=new Cc;$e.samplingIntervalInMs=Aa;$e.maximumNumberOfSamplesToTake=
xc;$e.idleIntervalInMs=zd;$e.profilingIntervalInMs=de;return this.q8g(za,pe,$e)}U$h(){const za=new Nc,Aa=new Xc;Aa.ulsInstance=new pd.a;Aa.deObfuscationEndpoint="ProfilerReporting.ashx";Aa.shouldCompressSerializedCallTrees=!1;Aa.shouldKeepSamplesOutsideOfProfilingInterval=!1;Aa.shouldSendAllCallTreesFromProfileInASingleRequest=!sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldSendEachCallTreeIndividuallyFromProfile",!1);Aa.shouldUseSendBeaconForSendingCallTrees=sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldUseSendBeaconForSendingCallTrees",
!1);Aa.callTreeFilteringThresholdInMs=sb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerCallTreeFilteringThresholdInMs",1);Aa.deObfuscationRequestQueryParamsRetriever=this.e5g();Aa.deObfuscationRequestBodyPropertiesRetriever=this.d5g();Aa.featureEnabledChecker=new Hb;Aa.useMainEventLoopForProfilerTraceProcessing=!1;Aa.profilerTraceProcessingWebWorkerSourceURL=this.$.ya.JSProfilerProcessingWebWorkerJsScriptUrl;Aa.shouldProcessProfileCapturedWhileUserIsIdle=sb.EwaSettings.isChangeGateEnabled("OfficeVSO:6144063_ShouldProcessProfileCapturedWhileUserIsIdle");
this.HEd=this.bJf.retrievePackage(za,Aa).retrieveProfilerFactory()}e5g(){const za=new Pc;za.addCustomProperty(Rb.a.LJf,k.AFrameworkApplication.userType);za.addCustomProperty(k.AFrameworkApplication.cfb,k.AFrameworkApplication.userSessionId);za.addCustomProperty(Rb.a.Twd,this.$.ya.SkipAuthentication?Rb.a.orf:null);za.addCustomProperty(Rb.a.bFd,this.$.ya.MachineCluster);return za}d5g(){const za=new Pc;za.addCustomProperty("appName","Excel");za.addCustomProperty("buildVersion",k.AFrameworkApplication.buildVersion);
za.addCustomProperty("shouldUseSourceMaps","true");za.addCustomProperty("shouldFilterSensitiveResources","true");za.addCustomProperty("shouldUseJSSelfProfilerSpecificDeobfuscator",this.kyj().toString());return za}q8g(za,Aa,xc){const zd=new Pc;zd.addCustomProperty("ProfilerName",za);this.aJf.set(za,zd);Aa=this.HEd.createProfiler(Aa,xc,zd);this.Q$a.set(za,Aa);za=this.E6g(za);Aa.subscribeProfilerObserver(za,this.Q0i);return Aa}f0e(za){return this.GEd(za)?this.Q$a.get(za):(d.ULS.shipAssertTag(537155520,
0,!1,`JsSelfProfilerManager.GetProfiler: Profiler with such name (${za}) does not exist`),null)}ved(za,Aa,xc=null){if(this.GEd(za))return this.f0e(za);const zd=this.Ooi;return this.createProfiler(za,zd,null!=xc&&0<zd?xc/zd:2E6,2===Aa?this.MAe:null,0===Aa?null:this.profilingIntervalInMs,Aa)}E6g(za){var Aa=sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")?this.interactivityTrackerService:nd.b(this.$);if(Aa){const xc=Aa.RDe();if(xc){Aa=this.Q$a.get(za);
const zd=new wd(xc);Aa.subscribeCallTreeCustomPropertiesRetriever(zd);Aa=new Db(de=>{xc.startCollectingSlowActions(de)},Object(W.a)(xc,xc.stopCollectingSlowActions,"stopCollectingSlowActions"));this.IEd.set(za,Aa);return Aa}d.ULS.sendTraceTag(537155491,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: CreateSlowActionsRetriever returned null");return null}d.ULS.sendTraceTag(537155490,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: call to InteractivityTracker returned null");
return null}V$h(){this.bJf=officeOnlineCpuProfiling.getJSCPUProfilingPackageRetriever();this.aJf=new Map;this.IEd=new Map;this.Q$a=new Map}Vef(za){return!!za}kyj(){return!sb.EwaSettings.isChangeGateEnabled("OfficeVSO:6967854_ESNextEnabled")}}Object(b.a)(ld,"JsSelfProfilerManager",null,[766,2]);class Dd extends rb.a{constructor(za){super();this.$=za;this.Fb()}create(){d.ULS.sendTraceTag(537155489,0,50,"JsSelfProfilerManagerFactory.Create: loading officeOnlineCpuProfiling script");const za=ic.GetServiceTaskFactory.Ra(this.$.da,
283,284,this.hb);Qb.TaskExtensions.Aa(za,()=>{sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")?this.$.da.Za(443,Aa=>{this.SCe(za.result,Aa)}):this.SCe(za.result)},this.$.la,3)}SCe(za,Aa){Qb.TaskExtensions.Aa(Nb.c(za.Zn.loadScript("officeOnlineCpuProfiling")),()=>{const xc=Object(sc.a)(this.$.da,437,()=>new ld(this.$,Aa));this.qb(xc)},this.$.la,3)}static ka(za){za.da.Ga(438,new Dd(za))}}Object(b.a)(Dd,"JsSelfProfilerManagerFactory",rb.a,[]);class Od{constructor(){this.order=
0;this.componentName=this.name=null;this.timeFromNavigationStart=0}}Object(b.a)(Od,"ActionData",null,[]);class Qd{constructor(){this.hasBlockedActions=!1;this.blockedActions=[]}}Object(b.a)(Qd,"BlockedEngagementInfo",null,[]);class Nd extends Od{constructor(){super();this.inputMethod=null;this.isCommand=!1}}Object(b.a)(Nd,"SuccessfulActionData",Od,[]);class he{constructor(){this.successfulActions=[]}}Object(b.a)(he,"SuccessfulEngagementInfo",null,[]);var ve=a(42);class Td{constructor(za){this.RIa=
new Set;this.bMb=null;this.ySe=this.R6f=!1;this.xg=()=>{this.cti();this.bMb=Dc.a.instance.create(()=>{this.wBb()},Td.bGj,Pb.a.wBb)};this.Ec=()=>{this.wBb()};this.TEb=(Aa,xc)=>{Aa=this.job.blockedActions.length;const zd=xc.details?xc.actionName+"_"+xc.details:xc.actionName;xc=Object(wb.a)(new Od,{order:Aa+1,name:zd,componentName:xc.componentName,timeFromNavigationStart:xc.timeFromNavigationStart});this.job.blockedActions.push(xc)};this.job=new Qd;this.job.hasBlockedActions=!1;this.Bdb=new he;this.Oyh();
this.$=za;this.$.ea.El(this.xg);this.$.kk(this.Ec);sb.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")&&(this.jBe=new Promise(Aa=>{this.N2g=Aa}))}dispose(){this.$.ea&&this.$.ea.Wn(this.xg);this.$.zl(this.Ec);cd.a.Ia(this.bMb);this.$=this.bMb=null}b6i(za,Aa,xc){if(void 0!==za&&null!==za&&Aa){var zd=this.Bdb.successfulActions.length+1,de="InputMethod"in Aa?Aa.InputMethod:"",pe="IsCommand"in Aa&&Aa.IsCommand;if(this.kni(za,Aa,de,pe)){if(sb.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")){const $e=
!pe&&za;this.ySe||$e===Ja.a.Dfg||$e===Ja.a.Efg||$e===Ja.a.Afg||$e===Ja.a.Bfg||(this.ySe=!0,this.N2g(void 0))}zd>Td.Bof||(za=Object(wb.a)(new Nd,{order:zd,name:za,componentName:"Location"in Aa?Aa.Location:"",timeFromNavigationStart:xc,inputMethod:de,isCommand:pe}),this.Bdb.successfulActions.push(za),1===zd?this.Sti():zd===Td.Bof&&this.wBb())}}}L5i(za){ve.a(this.$).xYb(this.TEb);this.job.hasBlockedActions=!0;this.TEb(null,za)}cti(){d.ULS.sendTraceTag(254546634,0,50,`${H.c(this.job)}`)}Sti(){tc.PageLoadTrackingInfo.instance.TJa(new Date)>
Td.azh?d.ULS.sendTraceTag(537154758,0,50,`First user interaction was filtered: ${H.c(this.Bdb.successfulActions[0])}`):d.ULS.sendTraceTag(254563592,0,50,`${H.c(this.Bdb.successfulActions[0])}`)}wBb(){!this.R6f&&this.Bdb.successfulActions.length&&(this.R6f=!0,cd.a.Ia(this.bMb),this.bMb=null,this.$.sendBeaconTraceTag(254559496,50,!1,H.c(this.Bdb)))}Oyh(){this.RIa.add(Ja.a.xSc);this.RIa.add(Ja.a.wMd);this.RIa.add(Ja.a.CDd);this.RIa.add(Ja.a.BHf);this.RIa.add(Ja.a.DHf);this.RIa.add(Ja.a.FHf)}kni(za,Aa,
xc,zd){xc=!xc||"unknown"===xc;const de="IsSystemInitiated"in Aa&&Aa.IsSystemInitiated;Aa="NoReporting"in Aa&&Aa.NoReporting;const pe=this.RIa.has(za);za=Ua.a.equals(za,Ja.a.Ztc,!0)&&xc;return!de&&!Aa&&!pe&&!za&&!(zd&&xc)}}Td.Bof=10;Td.azh=6E4;Td.bGj=12E4;Object(b.a)(Td,"PageLoadEngagementInfo",null,[703]);class ke extends rb.a{constructor(za){super();this.$=za;this.Fb()}create(){this.qb(this.$.da.za(432)||this.$.da.Ga(432,new Td(this.$)))}static ka(za){za.da.Ga(433,new ke(za))}}Object(b.a)(ke,"PageLoadEngagementInfoFactory",
rb.a,[]);var xe=a(53),le=a(136),Je=a(512),Fe=a(38),eb=a(74),Xb=a(416),oc=a(35),Gc=a(231);class Vc extends Sys.EventArgs{constructor(za){super();this.kU=za}}Object(b.a)(Vc,"ErrorDataArgs",Sys.EventArgs,[]);var P=a(642),Ta=a(111),pb=a(28);class Yb{constructor(za,Aa){this.fQb=null;this.y4b=this.Nid=!1;this.Jee=this.Kee=null;this.L4a=this.K4a=0;this.NVf=za;this.Ybe=Aa}get OEf(){return this.Ybe}get jJb(){return this.Kee}get MVf(){return this.Jee}get Moi(){return this.Kue(this.NVf.getTime())}get lVi(){return this.Kue(this.MVf.getTime())}get p1f(){return!(this.y4b||
void 0===window.bsqmXLSPageLoadStartTime)}get C_c(){try{return this.fQb||(this.fQb=Ta.toUtc(window.bsqmXLSPageLoadStartTime)),this.fQb}catch(za){return null}}set C_c(za){this.fQb=za}ksj(za){this.y4b||(this.Kee=za,this.Jee=Ta.toUtc(this.jJb))}n6h(za){if(za.Values&&(!this.K4a||!this.L4a))try{Wb.a.O7e in za.Values&&(this.K4a=parseInt(za.Values[Wb.a.O7e].toString(),10));Wb.a.P7e in za.Values&&(this.L4a=parseInt(za.Values[Wb.a.P7e].toString(),10));const Aa=z.a.instance;0<this.K4a&&(this.nlf(this.K4a,"PageLoadFromHostClick"),
Aa.f6i(this.K4a));0<this.L4a&&(this.nlf(this.L4a,"PageLoadFromHostFrameCreation"),Aa.g6i(this.L4a));const xc=za.Values[Wb.a.q6h]||0,zd=za.Values[Wb.a.o6h]||za.Values[Wb.a.p6h]||0;0<zd&&Aa.N5i(zd);Aa.O5i(xc)}catch(Aa){}}Jfj(){this.NVf=this.C_c=pb.a.Wa.Nb;this.Ybe=0;this.Nid=this.y4b=!1}Kue(za){const Aa=this.C_c.getTime();return Aa>=za?0:za-Aa+this.OEf}nlf(za,Aa){if(za){const xc=db.b();xc.SLb("UserAction",Aa,Aa,pb.a.XBb(za),P.EcmaDateClock.instance.appStart);xc.psb(Aa,Ta.toTimestamp(this.jJb))}}}Object(b.a)(Yb,
"PageLoadPerfInfo",null,[]);var Ac=a(71);class Zc{constructor(za,Aa,xc){this.eQc=za.keyCode;this.TJb(za.ctrlKey,1);this.TJb(za.shiftKey,2);this.TJb(za.altKey,4);this.TJb(Ac.b(za),8);this.TJb(xc,16);this.eQc=this.qdb|Aa<<24}get qdb(){return this.eQc}get keyCode(){return this.qdb&65535}TJb(za,Aa){za&&(this.eQc=this.qdb|Aa<<16)}}Object(b.a)(Zc,"ShortcutSqmData",null,[]);class id{constructor(){this.Etd=null;this.DZg={["0"]:0,["1"]:1,["2"]:2,["4"]:3,["8"]:4,["16"]:5,["32"]:6};this.CSf()}AUg(za,Aa,xc){0===
xc&&(xc=this.DZg[Aa.toString()]);return id.o1f(za,xc)&&(za=new Zc(za,xc,l.a.isMac),!oc.a.og(this.Etd,za.qdb.toString()))?(this.Etd[za.qdb.toString()]=!0,za):null}CSf(){this.Etd={}}static jhi(za){return 112<=za&&123>=za||61440<=za&&61451>=za}static tii(za){return 17!==za&&18!==za&&16!==za&&91!==za&&93!==za}static o1f(za,Aa){let xc=za.ctrlKey||za.altKey||Ac.b(za);za=za.keyCode;xc=id.jhi(za)||xc;xc=id.tii(za)&&xc;return 0!==Aa&&xc}}Object(b.a)(id,"UnhandledShortcutLogger",null,[]);class gd{constructor(za){this.S1b=
[];this.qJg=null;this.sqmManager=za}FXb(za){this.S1b.push(za)}V4(za,Aa,xc){try{if(Aa)Aa.endTime=xc,this.sqmManager.$je(Aa);else for(let zd=0,de=this.S1b.length;zd<de;zd++){const pe=this.S1b[zd];za?(pe.endTime=pe.startTime,pe.lze=0):pe.endTime=xc;this.sqmManager.$je(pe)}}catch(zd){}finally{this.S1b.length=0}}}Object(b.a)(gd,"UserInteractionPerfInfo",null,[]);var Ub=a(36),Lc=a(68),hd=a(230);class Kd extends Ob.a{constructor(za,Aa){super();this.vhd=this.lIb=!1;this.r1f=!0;this.Qa=new Fe.a;this.KFc=!1;
this.Ec=()=>{const xc=Lc.a(this.$).jd.activityState,zd=oc.a.og(xc,Ub.a.Gje);oc.a.og(xc,Ub.a.Ylb)||zd||this.upload()};this.$=za;this.Iub=Aa;this.ea=za.ea;this.$.kk(this.Ec);this.Mag=new id;this.IOa=new Yb(ma.a.OLd,za.ya.PageGenerationMetrics.TimeToCompleteFirstFlush);this.rBc=new gd(this)}PTc(za){this.Qa.addHandler("EREK",za)}nId(za){this.Qa.removeHandler("EREK",za)}get gah(){return this.KFc}get Dbi(){return this.$.frame.FQ?Rb.a.Fbi:Rb.a.Ebi}get workbookContext(){return this.$.workbookContext}get nT(){Kd.Yfb||
(Kd.Yfb=this.nKe());Kd.uXc||(Kd.uXc=!0,this.B9e());return Kd.Yfb}set nT(za){Kd.Yfb=za;Kd.Yfb||(Kd.uXc=!1)}get e2(){return eb.a(this.$.ya,3)}dispose(){this.gah&&k.AFrameworkApplication.Bn&&k.AFrameworkApplication.Bn.disable();this.$&&this.$.zl(this.Ec);this.$=this.rBc=this.IOa=this.nT=null;super.dispose()}G4e(za){this.IOa.n6h(za);this.$ti()}gNd(za){this.setDw(9415,za)}FXb(za){this.rBc.FXb(za)}V4(za,Aa,xc){this.rBc.V4(za,Aa,xc)}dtd(za){if(this.e2){const Aa=this.ea.isNamedObjectViewMode&&1===this.workbookContext.NovMode;
za=this.$.isEditMode||za&&this.ea.workbookContext.Options&512?2:Aa?9:this.ea.jc.inEmbedView?14:1;this.setDw(8721,za);this.PAh(za);this.KFc=!1}}Blf(){const za=this.IOa;this.e2&&za.p1f&&(this.setDw(9450,za.OEf),this.setDw(9085,za.Moi))}Clf(za){if(!this.lIb){this.lIb=!0;const Aa=this.IOa;let xc=0;this.e2&&Aa.p1f?(Aa.ksj(za),this.rBc.qJg=Aa.MVf,this.setDw(9086,Aa.lVi),Aa.y4b=!0,xc=this.IOa.jJb.getTime()):xc=za.getTime();Qb.TaskExtensions.Aa(this.Iub.value,zd=>{zd.result.Fj(nc.a.jJg,{[Wb.a.kJg]:xc})},
this.la,3)}}$je(za){this.e2&&za&&1!==za.Ada&&this.hga(8327,Gc.b(za),Gc.n(za),Gc.a(za),2,za.lze,Gc.o(za),Gc.d(za),Gc.e(za))}tJd(za,Aa){za&&za.MessageIdHash&&this.sJd(za.MessageIdHash,za.MessageIdName,za.MessageId,za.ErrorCause?za.ErrorCause:xe.a.Qzc,!1,Aa,za,null)}sJd(za,Aa,xc,zd,de,pe,$e,Df){Kd.appEncounteredFirstError||(Kd.appEncounteredFirstError=!0,le.a.get_instance().isCompleted(13)||(le.a.get_instance().ut(13),d.ULS.sendTraceTag(537151323,0,50,"App encountered its first error so updating app init status")));
za=this.ysb(za);const Sf=!!$e,Bf={};Bf.ErrorName=Aa;Bf.ErrorHashCode=za.toString();Bf.ErrorId=xc.toString();Bf.ErrorCause=zd.toString();Bf.ErrorType=0===pe?"ErrorDialog":"BusinessBar";Bf.BusinessBarEntryName=Df||"null";Bf.ServerCorrelationId=Sf?$e.CorrelationId:"null";Bf.WebMethodName=Sf?$e.WebMethodName:"null";Bf.SessionHostingEcs=this.ea.workbookContext?this.ea.workbookContext.EcsServerName:"null";Bf.WfeServerId=Sf?$e.WfeServerId:"null";Aa=od.a.Ac(Bf);this.Qa.raiseEvent("EREK",new Vc(Bf));d.ULS.sendTraceTag(1881314,
0,15,Aa);this.e2&&(S.a.lMf(za.toString()),this.hga(9134,za,zd,xe.a.MWd),this.ea.jv||de||(this.setDw(10459,za),this.dtd(!0),this.vhd=!0,this.upload(),this.B9e()))}ysb(za){return 5439488|(za>>>16^za&65535)&65535}xtd(za,Aa,xc){za=this.Mag.AUg(za,Aa,xc);this.e2&&za&&this.hga(11007,za.qdb)}upload(){!this.e2||!this.lIb&&!this.vhd||l.a.Tf&&k.AFrameworkApplication.Ng?l.a.Tf&&k.AFrameworkApplication.Ng&&d.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.nT.cOb(),this.KFc=!0);
k.AFrameworkApplication.Bn=this.nT=null;this.IOa.Jfj();this.lIb=!1;k.AFrameworkApplication.Bn=this.nT=this.nKe();this.Mag.CSf()}$ti(){const za=this.IOa;if(this.e2&&!za.Nid){var Aa=za.K4a,xc=za.L4a,zd=za.jJb.getTime();k.AFrameworkApplication.rM=za.jJb;Aa&&this.setDw(10324,Aa>zd?0:zd-Aa);xc&&this.setDw(10325,xc>zd?0:zd-xc);za.Nid=!0}}hga(za,...Aa){this.e2&&this.nT.hga(za,...Aa)}setDw(za,Aa){this.e2&&this.nT.setDw(za,Aa)}nKe(){Xb.a.JKe(this.$.ya);return k.AFrameworkApplication.Bn}PAh(za){let Aa;try{Aa=
Object(F.a)(Object,od.a.Vh(k.AFrameworkApplication.fa.appSettings.SessionStartInfoJson))}catch(xc){d.ULS.sendTraceTag(537151311,0,15,`Couldn't parse SessionStartInfoJson. Message: ${xc.message}`);return}if(Aa){let xc=Object(F.a)(String,Aa.ApplicationModeExtended),zd=Object(F.a)(String,Aa.ApplicationMode);xc&&zd&&(xc=xc.toUpperCase(),2!==za&&16!==za||"VIEW"!==xc&&"UNIFIED"!==xc?1!==za||"EDIT"!==xc&&"UNIFIED"!==xc||(xc="VIEW",zd="View"):(xc="EDIT",zd="Edit"),Aa.ApplicationModeExtended=xc,Aa.ApplicationMode=
zd,k.AFrameworkApplication.fa.appSettings.SessionStartInfoJson=od.a.Ac(Aa))}}B9e(){const za=this.$.ya;this.nT.GQ=!0;this.nT.SNb(za.BWsaStartTime);this.setDw(59,83);this.lIb=!1;if(this.e2){const Aa=za.DocumentHostInfo;this.H9g();this.setDw(8491,this.$.mG);this.setDw(9236,za.RequestedUILcid);this.setDw(8473,za.WacHostId);this.setDw(9902,Gc.c(Aa.ClusterId));sb.EwaSettings.ma(453)?this.nT.NYf(""):this.nT.NYf(za.FlightHolder?za.FlightHolder.FlightId:"");this.gNd(this.ea.jc.inEmbedView?1:0);this.vhd=!1;
this.setDw(9104,Gc.c(Aa.FileSourceId));this.setDw(10309,this.Dbi);this.fuj();k.AFrameworkApplication.wb.yNf(Je.a.getInstance(!1))}}fuj(){z.a.instance.l9h(this.nT);if(this.r1f){const za=z.a.instance;za.H5i();za.Z5i();za.Y5i();za.X5i();za.T5i();this.r1f=!1}}H9g(){this.createStream(8327,1,hd.a.ach,hd.a.K0a);this.createStream(9134,1,3,hd.a.K0a);this.createStream(11007,1,1,hd.a.K0a)}createStream(za,Aa,xc,zd){this.nT.createStream(za,Aa,xc,zd)}}Kd.Yfb=null;Kd.uXc=!1;Kd.appEncounteredFirstError=!1;Object(b.a)(Kd,
"SqmManager",Ob.a,[161,682]);var Wd=a(735);class oe{constructor(za,Aa=!1){this.entryTypes=null;this.buffered=!1;this.entryTypes=za;this.buffered=Aa}}Object(b.a)(oe,"PerformanceObserverInit",null,[]);class We extends Sys.EventArgs{constructor(za){super();this.MKe=za}}Object(b.a)(We,"LongTaskObservedEventArgs",Sys.EventArgs,[]);class Ze extends Sys.EventArgs{constructor(za){super();this.Fdc=za}}Object(b.a)(Ze,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);class Be{constructor(za){this.Qa=
new Fe.a;this.dJc=!1;this.xg=()=>{if(l.a.jp){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(this.cwi)).observe(new oe([Rb.a.Htd])),this.dJc=!0)}catch(Aa){this.dJc=!1,d.ULS.sendTraceTag(537153885,0,10,`Exception related to PerformanceObserver: ${Aa}`)}this.Qa.raiseEvent("ltpoiek",new Ze(this.Fdc))}};this.cwi=Aa=>{this.Qa.raiseEvent("ltoek",new We(Aa))};this.$=za;this.$.ea.Fg?this.xg(this,Sys.EventArgs.Empty):this.$.ea.El(this.xg)}get Fdc(){return this.dJc}yme(za){this.Qa.addHandler("ltoek",
za)}hbj(za){this.Qa.removeHandler("ltoek",za)}hFg(za){this.Qa.addHandler("ltpoiek",za)}ibj(za){this.Qa.removeHandler("ltpoiek",za)}dispose(){this.$.ea.Wn(this.xg);cd.a.Ia(this.Qa);this.$=this.Qa=null}}Object(b.a)(Be,"LongTaskPerformanceObserver",null,[2]);var af=a(173);class ff{constructor(za=0,Aa=0){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=za;this.longTaskDuration=Aa}get Ktd(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:
0}Hni(za){return 100*this.Ktd>za}OCg(za){this.sle(za.longTaskDuration);this.ATc(za.activeSessionDuration)}sle(za){this.longTaskDuration+=za}ATc(za){this.activeSessionDuration+=za}}Object(b.a)(ff,"LongTaskPerformanceData",null,[]);class Pe{constructor(za,Aa,xc,zd,de){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;this.maxUsersCount=0;this.isVetoSession=za;this.entireSessionData=Aa;this.worstWindowData=xc;this.postBootWindowData=zd;this.maxUsersCount=
de}get reportName(){return"LongTaskPerformance"}static get Djh(){return new Pe(!1,new ff,new ff,new ff,0)}}Object(b.a)(Pe,"LongTaskPerformanceDataStatistics",null,[734]);class Ne extends Sys.EventArgs{constructor(za){super();this.Itd=za}}Object(b.a)(Ne,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var se=a(456),Wa=a(374);class Sb{constructor(za,Aa){this.Qa=new Fe.a;this.BMa=this.Y4=this.cS=this.Me=null;this.nif=this.CQd=this.ghc=!1;this.jNa=null;this.maxUsersCount=0;this.ymc=(xc,zd)=>{xc=zd.MKe.getEntriesByType(Rb.a.Htd);
for(const de of xc)this.Me.bD(de.duration)||k.AFrameworkApplication.iMa||(this.cS.sle(de.duration),this.Qa.raiseEvent("lttek",new Ne(de)),xc={},xc.LongTaskDuration=de.duration,xc.LongTaskStartTime=de.startTime,d.ULS.sendTraceTag(187982418,0,50,JSON.stringify(xc)))};this.xg=()=>{this.CQd=!0;this.Cxc()};this.rB=(xc,zd)=>{zd&&(this.maxUsersCount=Math.max(this.maxUsersCount,zd.DYd));this.Y4.maxUsersCount=this.maxUsersCount};this.$c=()=>{this.Cxc()};this.Ec=()=>{this.a6f()};this.Lyf=(xc,zd)=>{zd.Fdc&&
this.Cxc()};this.gmf=()=>{this.cS.ATc(Ta.getElapsedMilliseconds(this.BMa,pb.a.Wa.Nb));this.BSd(!0);var xc=!1;this.Y4.postBootWindowData.activeSessionDuration?(!this.nif&&sb.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(this.Beg&&db.b().yRf(2),X.Health.instance.recordKpiUsage(Wa.a.longJsTask,0,se.a.Noi,null),this.nif=!0),!this.Y4.isVetoSession&&this.cS.Hni(this.pfg)&&(this.Y4.isVetoSession=!0,sb.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&
(this.Beg&&db.b().zRf(2,this.awi),X.Health.instance.recordKpiFailure(Wa.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,null))),this.Y4.worstWindowData.Ktd<=this.cS.Ktd&&(this.Y4.worstWindowData=this.cS),this.Y4.entireSessionData.OCg(this.cS)):(this.Y4.postBootWindowData=new ff(this.cS.activeSessionDuration,this.cS.longTaskDuration),xc=!0);const zd={};zd.LastWindowScore=this.cS;zd.postBootWindow=xc;zd.CoauthersNumber=this.$.ea.Jm.length;xc=JSON.stringify(zd);d.ULS.sendTraceTag(20779346,0,50,xc);this.cS=
new ff};this.qlc=()=>{this.Me.Ii||k.AFrameworkApplication.iMa||this.BSd(!1)};this.plc=()=>{this.cS.ATc(Ta.getElapsedMilliseconds(this.BMa,pb.a.Wa.Nb));this.BMa=null;this.jNa.cancel()};this.$=za;this.pfg=za.ya.LongTaskPerformanceVetoThreshold;this.awi="PercentageOver_"+this.pfg.toString();this.Jtd=za.ya.LongTaskPerformanceWindowDurationInMs;this.gN=Aa;this.Beg=sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5142056_use_UTR_in_LongJsTask");this.$.da.Za(291,xc=>{this.Me=xc;this.Cxc()});this.$.ea.Fg?this.xg(this,
Sys.EventArgs.Empty):this.$.ea.El(this.xg);this.gN.hFg(this.Lyf);this.$.el(this.$c);this.$.kk(this.Ec)}iFg(za){this.Qa.addHandler("lttek",za)}jbj(za){this.Qa.removeHandler("lttek",za)}dispose(){this.CQd=!1;this.a6f();this.$.Al(this.$c);this.$.zl(this.Ec);this.gN.ibj(this.Lyf);cd.a.Ia(this.jNa);this.gN=this.$=this.jNa=null;void 0!==this.Me&&null!==this.Me&&cd.a.Ia(this.Me)}Cxc(){void 0===this.Me||null===this.Me?d.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):
this.gN.Fdc?this.ghc?d.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):this.CQd?(this.ghc=!0,this.Y4=Pe.Djh,this.cS=new ff,this.$.ea.b9(this.rB),this.maxUsersCount=this.$.ea.Jm.length,this.gN.yme(this.ymc),this.Me.ZXa(this.plc),this.Me.Cmb(this.qlc),k.AFrameworkApplication.FTc(this.plc),k.AFrameworkApplication.GTc(this.qlc),this.jNa=Dc.a.instance.create(this.gmf,this.Jtd,Pb.a.rlf,!1),bc.a(this.$).FX(this.Y4),
this.Me.Ii||k.AFrameworkApplication.iMa||this.BSd(!0),d.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):d.ULS.sendTraceTag(537153881,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):d.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")}a6f(){this.ghc&&
(this.ghc=!1,this.$.ea.Wn(this.xg),this.gN.hbj(this.ymc),this.$.ea.n6(this.rB),void 0!==this.Me&&null!==this.Me&&(this.Me.Oab(this.plc),this.Me.Pab(this.qlc)),k.AFrameworkApplication.fPf(this.plc),k.AFrameworkApplication.gPf(this.qlc),this.jNa.cancel(),this.BMa=this.cS=this.Y4=null,this.maxUsersCount=0)}BSd(za){za||void 0===this.BMa||null===this.BMa?(this.BMa=pb.a.Wa.Nb,this.jNa=af.AsyncMethodContext.J7g(this.gmf,za?this.Jtd:this.Jtd-this.cS.activeSessionDuration,Pb.a.rlf,this.jNa)):d.ULS.sendTraceTag(589875356,
0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")}}Object(b.a)(Sb,"LongTaskPerformanceTracker",null,[2]);class wc extends Fe.a{constructor(za,Aa){super();this.statusBarManager=this.Me=null;this.Myf=(xc,zd)=>{zd.Itd&&zd.Itd.duration>=this.dwi&&(this.tmf++,this.Lif=zd.Itd.duration)};this.$=za;this.$.da.Za(29,xc=>{this.statusBarManager=xc;xc.oJ(this)});this.$.da.Za(291,xc=>{this.Me=
xc});this.Lif=this.tmf=0;this.dwi=za.ya.LongTaskThresholdMs;this.T7a=Aa;this.T7a.iFg(this.Myf)}qq(za){this.addHandler("LTSCEK",za)}Oq(za){this.removeHandler("LTSCEK",za)}Dz(){this.nn("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")}Rr(za,Aa){if("QueryLongTasksCount"!==za)return!1;this.E2h(Aa);return!0}nn(){return sb.EwaSettings.ma(580)}dispose(){this.statusBarManager&&(this.statusBarManager.PF(this),this.statusBarManager=null);this.T7a.jbj(this.Myf);super.dispose()}E2h(za){za.Value=`Long Tasks: ${this.tmf} | Last Task Duration: ${Math.round(this.Lif)}ms`}}
Object(b.a)(wc,"LongTasksStatusBarManager",Fe.a,[2,191,192]);var Uc=a(11);class ob{constructor(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}}Object(b.a)(ob,"NetworkInfoData",null,[]);class Zb extends Fe.a{constructor(za){super();this.statusBarManager=null;this.nTc=!1;this.Lrf=()=>{this.raiseEvent("NetworkInformation")};this.$=za;sb.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry")&&(this.VZ=this.qWd("connection")||
this.qWd("mozConnection")||this.qWd("webkitConnection"))&&sb.EwaSettings.ma(469)&&za.da.Za(29,Aa=>{this.statusBarManager=Aa;Aa.oJ(this);this.VZ.addEventListener("change",this.Lrf);this.nTc=!0})}qq(za){this.addHandler("NetworkInformation",za)}Oq(za){this.removeHandler("NetworkInformation",za)}E3a(){return this.VZ?Object(wb.a)(new ob,{bandwidthMps:this.VZ.downlink,rttMs:this.VZ.rtt,connectionType:this.VZ.type,effectiveConnection:this.VZ.effectiveType,downlinkMaxMps:this.VZ.downlinkMax}):null}Rr(za,
Aa){if("QueryNetworkInformation"!==za)return!1;this.F2h(Aa);return!0}nn(){return this.nTc}dispose(){this.nTc&&(this.statusBarManager&&(this.statusBarManager.PF(this),this.statusBarManager=null),this.VZ&&this.VZ.removeEventListener("change",this.Lrf));this.$=null;super.dispose()}qWd(za){return Uc.HelperMethods.mn(window.navigator,za)?window.navigator[za]:null}F2h(za){za.Value="Network: "+this.VZ.downlink.toString()+" Mbps, "+this.VZ.rtt.toString()+" ms"}}Object(b.a)(Zb,"NetworkInformationManager",
Fe.a,[191,192]);var Bc=a(185),bd=a(21);class Ed{constructor(za="",Aa=-1,xc=-1,zd=-1,de=!1,pe=!0,$e=!0,Df=!1,Sf="",Bf=-1){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=za;this.startTime=Aa;this.startToNextFrame=xc;this.startToResponseRenderEnd=zd;this.wasHidden=de;this.isUserOperation=pe;this.isGroupBreaking=
$e;this.operationThatLedToLogging=Sf;this.startToOperationThatLedToLogging=Bf;this.isPartOfGroup=Df}}Object(b.a)(Ed,"OperationStatisticsData",null,[]);var ge=a(79);class be{constructor(){this.operationsGroups=null;this.I8h()}isGroup(za,Aa,xc){const zd=new Bc.a;zd.addRange(za);zd.addRange(Aa);for(let de=0;de<this.operationsGroups.count;de++)if(this.Lji(this.operationsGroups.na(de),zd,xc))return d.ULS.sendTraceTag(595194768,1,50,`OperationsGroupDetector: Operation '${xc}' is part of a group ( operationsList: ${this.wEf(za)} , frameOperationsList: ${this.wEf(Aa)})`),
!0;d.ULS.sendTraceTag(595194767,1,50,`OperationsGroupDetector: Operation '${xc}' is NOT part of a group.`);return!1}Lji(za,Aa,xc){let zd=0;for(let de=0;de<Aa.count;de++)if(Aa.na(de).isGroupBreaking){if(za.count<=zd||!Ua.a.equals(Aa.na(de).name,za.na(zd),!0))return!1;zd++}return za.count>zd&&Ua.a.equals(xc,za.na(zd),!0)}wEf(za){za=ge.select(za,Aa=>Aa.name);return`[${ge.toArray(za).join(", ")}]`}I8h(){this.operationsGroups=new Bc.a;let za;this.PXa((za=new Bc.a,za.add("Paste"),za.add("SelectingRange_unknown"),
za));let Aa;this.PXa((Aa=new Bc.a,Aa.add("AutoSum"),Aa.add("SelectingRange_unknown"),Aa));let xc;this.PXa((xc=new Bc.a,xc.add("ChangeSheetDirection"),xc.add("ActiveItemChanged"),xc));let zd;this.PXa((zd=new Bc.a,zd.add("InsertSheet"),zd.add("ActiveItemChanged"),zd.add("SelectingRange_unknown"),zd));let de;this.PXa((de=new Bc.a,de.add("DeleteSheet"),de.add("DialogButtonClick"),de.add("ActiveItemChanged"),de.add("SelectingRange_unknown"),de));let pe;this.PXa((pe=new Bc.a,pe.add("EditBoxEndEdit"),pe.add("SetCell"),
pe.add("SelectingRange_keyboard"),pe.add("MoveDownWithinSelectionOrCommitEdit"),pe))}PXa(za){this.operationsGroups.add(za)}}Object(b.a)(be,"OperationsGroupDetector",null,[]);var qe=a(25);class ze{constructor(za,Aa,xc,zd){this.framePerformanceTracker=this.aIb=this.g_=this.i0=null;this.Wdj=()=>{this.cVc=-1;const de=Uc.HelperMethods.Tb();this.lTj(de);sb.EwaSettings.ma(369)&&(this.qJb&&(d.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),
this.TNb(this.JE,de),this.qJb=!1),this.Bfc&&(this.TNb(this.oD,de),this.qJb||this.TNb(this.JE,de)));window.setTimeout(this.Xti,0)};this.Xti=()=>{var de=[];const pe=this.$.ya.OperationToPrevOperationThreshold;for(var $e=0;$e<this.JE.count;$e++){var Df=this.JE.na($e);$e<pe&&de.push(Df);this.oD.add(Df)}bd.g(this.$)&&bd.g(this.$).Ea?(($e=this.sessionStatisticsManager.wcd(0))?(Df=JSON.stringify(this.CBb),de=JSON.stringify(de),d.ULS.sendTraceTag(237798547,1,50,`DOM count: (${$e.Lzi}, ${$e.TMg}, ${$e.Ayi}), long tasks: ${Df}, operations count: ${this.JE.count}, operations: ${de}`)):
d.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),this.JE.count>pe&&d.ULS.sendTraceTag(537153875,1,50,`More than ${pe} operations are in the operationsList. count: ${this.JE.count}`),this.JE.clear(),this.CBb.clear()):d.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.ymc=(de,pe)=>{this.bwi(pe.MKe)};this.$=za;this.xI=Aa;this.Lh=this.Lh||pb.a.Wa;this.oD=new Bc.a;this.JE=new Bc.a;this.cVc=this.n7a=-1;this.CBb=new Bc.a;this.operationsGroupDetector=
new be;this.qJb=this.Bfc=!1;this.c9h();this.K8h();this.J8h();this.sessionStatisticsManager=xc;this.gN=zd;this.gN.yme(this.ymc);this.$.da.Za(263,de=>{this.framePerformanceTracker=de})}jIb(za,Aa){var xc=Uc.HelperMethods.Tb();const zd=sb.EwaSettings.ma(369)?this.operationsGroupDetector.isGroup(this.oD,this.JE,za):!1;this.Bfc=this.zef(za);sb.EwaSettings.ma(369)?this.Bfc&&0<this.oD.count&&!zd&&(this.pSj(),this.$cg(za,xc),this.SSe()):0<this.oD.count&&this.zef(za)&&(this.$cg(za,xc),this.SSe());this.n7a=
-1;if(bd.g(this.$)&&bd.g(this.$).Ea){var de=!this.i0.contains(za);xc=new Ed(za,xc,void 0,void 0,void 0,de,this.Bfc,zd);this.JE.add(xc);this.framePerformanceTracker&&this.framePerformanceTracker.pEj(xc.name,Aa);sb.EwaSettings.ma(369)&&!this.qJb&&this.aIb.contains(za)&&(this.qJb=!0);-1===this.cVc&&(this.cVc=window.requestAnimationFrame(this.Wdj))}else d.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")}gsc(){this.n7a=Uc.HelperMethods.Tb()}osc(){this.oD.count||this.JE.count?(this.TNb(this.JE,
this.n7a),this.TNb(this.oD,this.n7a)):d.ULS.sendTraceTag(0,1,50,`ReportOnBlockCacheConsistant when no operations in the list. Last block render time: ${this.n7a}`);this.n7a=-1}zef(za){return!this.g_.contains(za)&&!za.includes("Menu")&&!za.includes("TellMe")}SSe(){for(let za=0;za<this.oD.count;za++){const Aa=this.oD.na(za);this.xI.Hyg(Aa);this.Eui(Aa)}this.oD.clear()}lTj(za){for(let Aa=0;Aa<this.JE.count;Aa++)this.JE.na(Aa).startToNextFrame=this.oed(this.JE.na(Aa).startTime,za),this.JE.na(Aa).wasHidden=
Wd.a.bD(this.JE.na(Aa).startToNextFrame)}$cg(za,Aa){for(let xc=0;xc<this.oD.count;xc++)-1===this.oD.na(xc).startToResponseRenderEnd&&(this.oD.na(xc).operationThatLedToLogging=za,this.oD.na(xc).startToOperationThatLedToLogging=this.oed(this.oD.na(xc).startTime,Aa))}pSj(){var za=!1;for(let Aa of this.oD)if(Aa.isPartOfGroup){za=!0;break}if(za)for(za=0;za<this.oD.count;za++)this.oD.na(za).isPartOfGroup=this.oD.na(za).isGroupBreaking}TNb(za,Aa){for(let xc=0;xc<za.count;xc++)za.na(xc).startToResponseRenderEnd=
this.oed(za.na(xc).startTime,Aa),za.na(xc).wasHidden=Wd.a.bD(za.na(xc).startToResponseRenderEnd)}Eui(za){za=JSON.stringify(za);d.ULS.sendTraceTag(2020372336,1,50,`${za}`)}oed(za,Aa){return-1===za?-1:-1===Aa?-2:Aa-za}bwi(za){za=za.getEntriesByType(Rb.a.Htd);for(let Aa=0;Aa<za.length;Aa++)if(30>this.CBb.count)if(this.JE.count)this.CBb.add(this.UWi(za[Aa]));else{const xc=za[Aa];if(null===xc||void 0===xc?0:xc.attribution)void 0!==xc.attribution.containerSrc&&null!==xc.attribution.containerSrc&&(xc.attribution.containerSrc=
""),void 0!==xc.attribution.containerId&&null!==xc.attribution.containerId&&(xc.attribution.containerId=""),void 0!==xc.attribution.containerName&&null!==xc.attribution.containerName&&(xc.attribution.containerName="");d.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty.")}else{d.ULS.sendTraceTag(537153874,1,50,`More then ${30} long tasks are in the longTaskList. entries length: ${za.length} First long task: ${this.CBb.na(0)}`);break}}UWi(za){return`name:${za.name}, startTime:${za.startTime}, duration:${za.duration}`}c9h(){this.i0||
(this.i0=new Ha.a(yb.a.Sk()),this.i0.add("ActiveItemChanged"),this.i0.add(db.b().nj(-1398645260)),this.i0.add(db.b().nj(722290388)),this.i0.add(db.b().nj(974713501)),this.i0.add(qe.a.hQ(qe.a.F1b)),this.i0.add(qe.a.hQ(qe.a.E1b)),this.i0.add(qe.a.hQ(qe.a.Fpb)),this.i0.add(qe.a.hQ(qe.a.sJf)),this.i0.add(qe.a.hQ(qe.a.yma)))}K8h(){this.g_||(this.g_=new Ha.a(yb.a.Sk()),this.g_.add("PromptEditInBrowser"),this.g_.add(db.b().nj(-1398645260)),this.g_.add(db.b().nj(722290388)),this.g_.add(db.b().nj(974713501)),
this.g_.add(qe.a.hQ(qe.a.F1b)),this.g_.add(qe.a.hQ(qe.a.E1b)),this.g_.add(qe.a.hQ(qe.a.Fpb)),this.g_.add(qe.a.hQ(qe.a.sJf)),this.g_.add(qe.a.hQ(qe.a.yma)))}J8h(){this.aIb||(this.aIb=new Ha.a(yb.a.Sk()),this.aIb.add("SelectingRange_keyboard"),this.aIb.add("SelectingRange_mouse"))}}Object(b.a)(ze,"OperationStatistics",null,[]);var Ce=a(577);class Ve{constructor(za,Aa){this.messageIdName=null;this.errorCause=0;this.messageIdName=za;this.errorCause=Aa}}Object(b.a)(Ve,"RequestError",null,[]);class we{constructor(za,
Aa,xc,zd,de,pe,$e,Df,Sf,Bf,kg,wf,lg,ng,If,Qf,dg){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=
0;this.isDocumentHidden=this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=0;this.requestName=za;this.isUserTriggeredRequest=we.GPh(za);this.isFullyLoggedKPIRequest=we.CPh(za);this.isPromotedUTRRequest=we.DPh(za);this.requestDuration=Aa;this.totalOperationDuration=xc;this.requestTimeInQueue=zd;this.requestInvokedTime=de;this.ecsOperationDuration=pe.EcsOperationDuration;this.EcsRequestDuration=pe.EcsRequestDuration;this.WfeRequestDuration=
pe.WfeRequestDuration;this.TimeFromLastEcsFreeze=pe.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=pe.DuringLoadOnDemand;this.correlationID=$e;this.errors=we.X0g(Df);this.httpStatus=Sf;this.requestResourceTiming=Bf;this.communicationErrorRetryCount=kg;this.successfulCall=wf;this.isDocumentHidden=lg;this.coauthorsCount=ng;this.responseSize=If;this.networkInfoData=Qf;this.responseToCallbackTime=dg}static X0g(za){if(!za)return[];const Aa=[];for(const xc of za)Aa.push(new Ve(xc.MessageIdName,xc.ErrorCause));
return Aa}static GPh(za){return!we.JCi.contains(za)}static SRh(){const za=new Ha.a(yb.a.Sk());za.add("CheckPersistedContentUpdate");za.add("GetContentBundle");za.add("GetSessionStatus");za.add("GetStatusBarAggregates");za.add("PollSessionStatus");za.add("UpdatePresenceUsers");za.add("UploadLatencyTelemetry");return za}static CPh(za){return we.pDh.contains(za)}static DPh(za){return we.U0i.contains(za)}static jOh(){const za=new Ha.a(yb.a.Sk());za.add("SetRichTextCell");za.add("Copy");za.add("FormatCells");
za.add("PasteRange");za.add("FindCell");za.add("ApplyToRangesV2");za.add("ResizeRowsColumns");za.add("InsertDeleteCells");za.add("FillRange");za.add("PasteHtmlContent");za.add("ApplyFilter");za.add("PasteString");za.add("Undo");za.add("LineageUpdateView");za.add("FindAll");za.add("ApplyHyperlink");za.add("AutoFit");za.add("GetPrintSettings");za.add("GetEdgeCell");za.add("Paste");za.add("MoveAndResizeFloatingObject");za.add("FindRange");za.add("SetCustomFilter");za.add("RenameSheet");za.add("ApplyThreadedComment");
za.add("SortFilterColumn");za.add("InsertCopiedCutCells");za.add("InsertSheet");za.add("ToggleAutoFilter");za.add("ReorderSheets");za.add("SetOutlineLevel");za.add("RefreshAll");za.add("LineageOpenPaneOrChangeFilter");za.add("ApplySlicerSelection");za.add("GetCardViewCardByCell");za.add("AutoSum");za.add("LineageClosePane");za.add("Sort");za.add("ClearAutoFilter");za.add("DeleteSheet");za.add("Redo");sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(za.add("RemovePageBreak"),
za.add("InsertPageBreak"),za.add("SetPrintArea"),za.add("ClearPrintArea"));return za}static EPh(){const za=new Ha.a(yb.a.Sk());za.add("DeleteConditionalFormattingRules");za.add("GetConditionalFormattingRules");za.add("AddConditionalFormattingRule");za.add("QuickEditConditionalFormattingRule");za.add("GetPrintSettings");za.add("UpdatePresenceUsers");za.add("GetThemeInfo");za.add("InsertCopiedCutCells");za.add("PasteRange");sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&
(za.add("LineageOpenPaneOrChangeFilter"),za.add("LineageUpdateView"),za.add("LineageRefreshView"),za.add("LineageLoadMore"));return za}}we.JCi=we.SRh();we.pDh=we.jOh();we.U0i=we.EPh();Object(b.a)(we,"RequestStatisticsData",null,[]);class vc{constructor(za,Aa,xc){this.$=za;this.xI=Aa;this.Xka=xc}ssc(za,Aa,xc,zd,de,pe,$e,Df,Sf,Bf,kg,wf,lg,ng){wf=Ce.a(wf);za=new we(za,Aa,xc,zd,de,pe,$e,Df,Sf,wf,Bf,kg,Wd.a.bD(Aa),this.Qdd(null),lg,this.Xka.E3a(),ng);this.KJd(za)}ni(za,Aa){za="UnknownMethodName";let xc=
-1;void 0!==Aa.context&&null!==Aa.context&&(za=Aa.context.methodName,xc=Aa.context.communicationErrorRetryCount);let zd,de={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};Aa.dd?(zd=Aa.dd.Errors||[],this.xI.Odj(Aa.dd.EditSessionIsDirty),void 0!==Aa.dd.RequestTelemetryData&&null!==Aa.dd.RequestTelemetryData&&(de=Aa.dd.RequestTelemetryData)):zd=[];const pe=Aa.duration,$e=Ce.a(Aa.url);Aa=new we(za,pe,Aa.totalOperationDuration,Aa.FUd,
Aa.pF,de,Aa.RMd,zd,Aa.httpStatus,$e,xc,!0,Wd.a.bD(pe),this.Qdd(Aa.dd),Aa.responseSize,this.Xka.E3a(),Aa.responseToCallbackTime);this.KJd(Aa)}Un(za,Aa){za="UnknownMethodName";let xc=-1;void 0!==Aa.context&&null!==Aa.context&&(za=Aa.context.methodName,xc=Aa.context.communicationErrorRetryCount);const zd=Aa.duration,de=Ce.a(Aa.url);Aa=new we(za,zd,Aa.totalOperationDuration,Aa.FUd,Aa.pF,{EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},
Aa.RMd,Aa.errors||[],Aa.httpStatus,de,xc,!1,Wd.a.bD(zd),this.Qdd(null),-1,this.Xka.E3a(),Aa.responseToCallbackTime);this.KJd(Aa)}KJd(za){this.xI.gIg(za);if(sb.EwaSettings.ma(229)){var Aa=za.requestName;if(Aa!==Rb.a.O3a&&"SetCell"!==Aa&&"FindRange"!==Aa&&"FindAll"!==Aa&&"FindCell"!==Aa)return}Aa=sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===za.requestName||null===za.requestName)&&za.isPromotedUTRRequest;vc.Hhh(za,Aa);this.xI.Iyg(za)}Qdd(za){var Aa;if(null===
(Aa=null===za||void 0===za?void 0:za.CollaborationResult)||void 0===Aa?0:Aa.Users)return za.CollaborationResult.Users.length;za=this.$.ea.Jm.length;return 0<za?za:1}static Hhh(za,Aa){Aa?db.b().nuc(388829456,0,15,za):(Aa=Sys.Serialization.JavaScriptSerializer.serialize(za),d.ULS.sendTraceTag(388829456,0,50,Aa));if(sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==za.requestName&&null!==za.requestName&&za.isFullyLoggedKPIRequest){Aa=new Map;Aa.set("isUserTriggeredRequest",
za.isUserTriggeredRequest.toString());Aa.set("requestDuration",za.requestDuration.toString());Aa.set("totalOperationDuration",za.totalOperationDuration.toString());Aa.set("requestTimeInQueue",za.requestTimeInQueue.toString());Aa.set("requestInvokedTime",za.requestInvokedTime.toString());Aa.set("ecsOperationDuration",za.ecsOperationDuration.toString());Aa.set("ecsRequestDuration",za.EcsRequestDuration.toString());Aa.set("wfeRequestDuration",za.WfeRequestDuration.toString());Aa.set("timeFromLastEcsFreeze",
za.TimeFromLastEcsFreeze.toString());Aa.set("duringLoadOnDemand",za.DuringLoadOnDemand.toString());Aa.set("correlationID",za.correlationID);Aa.set("errors",za.errors.toString());Aa.set("httpStatus",za.httpStatus.toString());if(za.networkInfoData){var xc=za.networkInfoData;Aa.set("networkInfoData_bandwidthMps",void 0===xc.bandwidthMps||null===xc.bandwidthMps?"NA":xc.bandwidthMps.toString());Aa.set("networkInfoData_rttMs",void 0===xc.rttMs||null===xc.rttMs?"NA":xc.rttMs.toString());Aa.set("networkInfoData_effectiveConnection",
void 0===xc.effectiveConnection||null===xc.effectiveConnection?"NA":xc.effectiveConnection)}za.requestResourceTiming&&(xc=za.requestResourceTiming,Aa.set("requestResourceTiming_fetchStart",void 0===xc.downloadDuration||null===xc.downloadDuration?"NA":xc.downloadDuration.toString()));Aa.set("communicationErrorRetryCount",za.communicationErrorRetryCount.toString());Aa.set("successfulCall",za.successfulCall.toString());Aa.set("isDocumentHidden",za.isDocumentHidden.toString());Aa.set("coauthorsCount",
za.coauthorsCount.toString());Aa.set("responseSize",za.responseSize.toString());Aa.set("responseToCallbackTime",za.responseToCallbackTime.toString());db.b().psc(za.requestName,za.successfulCall,Aa)}}}Object(b.a)(vc,"RequestStatistics",null,[]);var ed=a(206),Id=a(61),Ld=a(309);class ce{constructor(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=null}}Object(b.a)(ce,
"OperationTypeStatisticsData",null,[]);class la{constructor(za,Aa){this.data=new ce;this.data.operationName=za;this.data.isUserOperation=Aa;this.data.totalCount=0;this.u5f=[];this.v5f=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}Cd(za){this.data.totalCount<la.i6c&&(this.u5f.push(za.startToNextFrame),this.v5f.push(za.startToResponseRenderEnd));this.data.totalCount++;this.data.longestStartToNextFrame<
za.startToNextFrame&&(this.data.longestStartToNextFrame=za.startToNextFrame);this.data.longestStartToResponse<za.startToResponseRenderEnd&&(this.data.longestStartToResponse=za.startToResponseRenderEnd)}j$c(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.L_e(this.u5f),this.data.startToResponsePercentiles=this.L_e(this.v5f))}L_e(za){za.sort(Uc.HelperMethods.iD);let Aa;Aa="("+Wd.a.Fua(za,25).toString();Aa=Aa+", "+Wd.a.Fua(za,50).toString();Aa=Aa+", "+Wd.a.Fua(za,75).toString();
Aa=Aa+", "+Wd.a.Fua(za,95).toString();return Aa+")"}}la.i6c=1E3;Object(b.a)(la,"OperationTypeStatistics",null,[]);class jb{constructor(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=this.requestDurationPercentile50=
this.requestDurationPercentile25=0}}Object(b.a)(jb,"RequestTypeStatisticsData",null,[]);class ra{constructor(za){this.data=new jb;this.data.requestName=za;this.data.totalCount=0;this.kbb=[];this.JVd=this.BVd=this.CVd=this.GVd=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=-1;this.data.requestDurationPercentile95=
-1}sej(za){this.data.totalCount<ra.i6c&&this.kbb.push(za.requestDuration);this.data.totalCount++;this.GVd+=za.requestDuration;this.CVd+=ra.Cbd(za.ecsOperationDuration);this.BVd+=ra.Cbd(za.EcsRequestDuration);this.JVd+=ra.Cbd(za.WfeRequestDuration);0<za.TimeFromLastEcsFreeze&&za.TimeFromLastEcsFreeze<ra.dDh&&this.data.callsDuringEcsFreeze++;za.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;za.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;if(void 0===this.data.longestRequest||
null===this.data.longestRequest||this.data.longestRequest.requestDuration<za.requestDuration)this.data.longestRequest=za}j$c(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.GVd/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.CVd/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.BVd/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.JVd/this.data.successfulCalls)):(this.data.averageEcsOperationDuration=
0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.kbb.sort(Uc.HelperMethods.iD),this.data.requestDurationPercentile25=Wd.a.Fua(this.kbb,25),this.data.requestDurationPercentile50=Wd.a.Fua(this.kbb,50),this.data.requestDurationPercentile75=Wd.a.Fua(this.kbb,75),this.data.requestDurationPercentile95=Wd.a.Fua(this.kbb,95))}static Cbd(za){return 0>za?0:za}}ra.dDh=3E3;ra.i6c=1E3;Object(b.a)(ra,"RequestTypeStatistics",null,[]);class hb{constructor(za,Aa,xc,zd,de,pe,$e,Df){this.mode=null;
this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=za;this.ocsCapable=Aa;this.endedBySplashScreen=xc;this.dirtySessionOnLastRecordedRequest=zd;this.loadOnDemandCount=de;this.maxCoauthorsCount=pe;this.everConnectedToOcs=$e;za=[];for(let Sf in Df)Aa=Df[Sf],Aa.j$c(),za.push(Aa.data);this.requests=za}}Object(b.a)(hb,"SessionStatisticsData",null,[]);class Eb{constructor(za){this.dirtySessionOnLastRecordedRequest=
this.wSd=!1;this.jkf=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=za;this.Glb={};this.Flb={};this.Y3c={}}Ec(){var za=this.G$g();if(ma.a.kda()){var Aa={};Aa.xlendJson=za;this.$.Kma(ed.a.OXj,Aa,!1)}else Id.N(this.$.oa.va,za,null,null,null,null,null);za=this.H$g();ma.a.kda()?(Aa={},Aa.xlenoJson=za,this.$.Kma(ed.a.PXj,Aa,!1)):d.ULS.sendTraceTag(388776782,0,50,za);sb.EwaSettings.ma(69)&&(za=this.a5g(),ma.a.kda()?(Aa={},Aa.xlencJson=za,this.$.Kma(ed.a.NXj,Aa,!1)):d.ULS.sendTraceTag(388776770,
0,50,za));this.Yej()}hhc(){this.everConnectedToOcs=this.$.ea.W6a||this.everConnectedToOcs;X.Health.instance&&X.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.everConnectedToOcs.toString())}xg(){const za=new Ld.a;let Aa="";const xc=!this.$.isAnonymousUser(),zd=za.If();if(zd){if(xc){za.YNd("UMI_Linkable","true");return}Aa=za.Yub("UMI_Linkable")}xc||d.ULS.sendTraceTag(537153870,0,50,`SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:${zd}, UMIIsLinkable:${!!Aa}`)}hbb(){this.wSd=
!0}Odj(za){this.dirtySessionOnLastRecordedRequest=za}gIg(za){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,za.coauthorsCount);X.Health.instance&&X.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())}Iyg(za){if(!(za.requestName in this.Glb)){const Aa=new ra(za.requestName);this.Glb[za.requestName]=Aa}this.Glb[za.requestName].sej(za)}Hyg(za){if(!(za.name in this.Flb)){const Aa=new la(za.name,za.isUserOperation);this.Flb[za.name]=Aa}this.Flb[za.name].Cd(za)}FX(za){this.Y3c[za.reportName]=
za}Yej(){this.dirtySessionOnLastRecordedRequest=this.wSd=!1;this.jkf=this.$.ea.xsd;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.Glb={};this.Flb={};this.Y3c={}}G$g(){const za=new hb(this.$.isEditMode?"edit":"view",this.$.ea.ocsCapable,this.wSd,this.dirtySessionOnLastRecordedRequest,this.$.ea.xsd-this.jkf,this.maxCoauthorsCount,this.everConnectedToOcs,this.Glb);return Sys.Serialization.JavaScriptSerializer.serialize(za)}H$g(){var za=new Bc.a;const Aa=this.Flb;for(let xc in Aa){const zd=
Aa[xc];zd.j$c();za.add(zd.data)}za=za.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(za)}a5g(){return Sys.Serialization.JavaScriptSerializer.serialize(this.Y3c)}}Object(b.a)(Eb,"SessionStatistics",null,[]);class fc extends Ob.a{constructor(za){super();this.vma=this.Ila=null;this.KEe=Array(1);this.GLc=this.Ltd=null;this.ni=(Aa,xc)=>{sb.EwaSettings.ma(40)&&(this.vma=this.vma||new vc(this.$,this.xI,this.Xka),this.vma.ni(Aa,xc))};this.Un=(Aa,xc)=>{sb.EwaSettings.ma(40)&&(this.vma=this.vma||
new vc(this.$,this.xI,this.Xka),this.vma.Un(Aa,xc))};this.Ec=(Aa,xc)=>{sb.EwaSettings.ma(40)&&this.xI.Ec(Aa,xc)};this.xg=(Aa,xc)=>{sb.EwaSettings.ma(40)&&this.xI.xg(Aa,xc)};this.hhc=(Aa,xc)=>{sb.EwaSettings.ma(40)&&this.xI.hhc(Aa,xc)};this.$=za;sb.EwaSettings.ma(40)&&(Wd.a.Z8h(this.$),this.gN=new Be(this.$),this.U6g(),sb.EwaSettings.ma(580)&&this.T7a&&(this.Ltd=new wc(this.$,this.T7a)),this.xI=new Eb(this.$),this.Xka=new Zb(this.$),this.$.kk(this.Ec),this.$.oa.Ir(this.ni),this.$.oa.Ly(this.Un),this.$.ea.ome(this.hhc),
sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.El(this.xg))}get T7a(){return this.GLc}dispose(){this.$&&sb.EwaSettings.ma(40)&&(this.$.zl(this.Ec),this.$.oa.qt(this.ni),this.$.oa.Oz(this.Un),this.$.ea.MPf(this.hhc),sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.Wn(this.xg));cd.a.Ia(this.Xka);cd.a.Ia(this.T7a);this.GLc=null;cd.a.Ia(this.gN);this.gN=null;cd.a.Ia(this.Ltd);this.$=this.Ltd=null;super.dispose()}hbb(){sb.EwaSettings.ma(40)&&
this.xI.hbb()}ssc(za,Aa,xc,zd,de,pe,$e,Df,Sf,Bf,kg,wf,lg,ng){sb.EwaSettings.ma(40)&&(this.vma=this.vma||new vc(this.$,this.xI,this.Xka),this.vma.ssc(za,Aa,xc,zd,de,pe,$e,Df,Sf,Bf,kg,wf,lg,ng))}jIb(za,Aa){sb.EwaSettings.ma(40)&&(this.Ila=this.Ila||new ze(this.$,this.xI,this,this.gN),this.Ila.jIb(za,Aa))}gsc(){sb.EwaSettings.ma(40)&&(this.Ila=this.Ila||new ze(this.$,this.xI,this,this.gN),this.Ila.gsc())}osc(){sb.EwaSettings.ma(40)&&(this.Ila=this.Ila||new ze(this.$,this.xI,this,this.gN),this.Ila.osc())}FX(za){sb.EwaSettings.ma(40)&&
this.xI.FX(za)}wcd(za){return sb.EwaSettings.ma(40)?this.KEe[za]:null}wYf(za){za&&(this.KEe[za.type]=za)}E3a(){return this.Xka.E3a()}U6g(){l.a.jp&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&(this.GLc=new Sb(this.$,this.gN))}}Object(b.a)(fc,"SessionStatisticsManager",Ob.a,[14]);var Mc=a(101),xd=a(1110),Hd=a(118),Md=a(127);class ae{constructor(za,Aa){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=
!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=za;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=
this.dialogPromptedOnUnload=!1;this.wacSessionId=Aa}NJj(){return od.a.Ac(this)}}Object(b.a)(ae,"AppUnloadInfo",null,[]);var me=a(690),Re=a(120),Xe=a(561);class qf{constructor(za){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=za.Mye+za.Eag;this.dataLossReason=za.Sue;this.MSg(za.CYd)}MSg(za){const Aa=new me.a(Xe.a.cK());let xc=0,zd=0;for(const de of za)Aa.mb(de)||Aa.ia(de,0),za=Aa.ia(de,Aa.na(de)+1),za>
xc&&(xc=za,zd=de);xc>this.mostCommonOperationCount&&(this.mostCommonOperationName=Re.a(zd),this.mostCommonOperationCount=xc)}}Object(b.a)(qf,"DataLossInfo",null,[]);var uf=a(57);class Cf{constructor(za){this.kVc="AppUnloadInfo";this.tm=this.$=this.workbookHashedId=this.My=null;this.H0d=this.X3d=!1;this.jf=null;this.P8e=0;this.tOa=(Aa,xc)=>{this.P8e=xc.Vyc};this.zDf=(Aa,xc)=>{xc.CYd.length&&this.$.aD&&(this.My.dataLossInfo=new qf(xc),this.My.wasDataLostDuringUnload=!0,this.Lbb())};this.xg=()=>{this.WWf();
this.$.ea.Wn(this.xg)};this.WNa=()=>{this.My.wasUpdatedOnBeforeUnload=!0;this.My.inactivityDurationBeforeUnloadSeconds=this.jf.JMb<Cf.Oyi?this.P8e:this.jf.JMb;this.Wcg()};this.JEb=()=>{this.My.wasUpdatedOnUnload=!0;this.Wcg();Sys.Application.remove_unload(this.JEb)};this.pRi=()=>{this.My.lastSilentReopenStartTime=pb.a.Wa.Nb;this.My.lastSilentReopenEndTime=null;this.Lbb();this.$.el(this.wCf)};this.wCf=()=>{this.My.lastSilentReopenEndTime=pb.a.Wa.Nb;this.Lbb();this.$.Al(this.wCf)};this.localStorage=
new Ld.a;this.localStorage.If()&&(this.$=za,this.workbookHashedId=uf.a(this.$),this.My=new ae(this.workbookHashedId,this.$.ya.UserSessionId),this.tm=Md.a.instance.aH(),this.tm.ka("beforeunload",this.WNa),this.$.userOperationManager.ZGg(this.zDf),za.ea.Fg?this.WWf():this.$.ea.El(this.xg),this.jf=this.$.ea.jf,this.jf.ora(this.tOa),Sys.Application.add_unload(this.JEb),this.$.ea.sUc(this.pRi))}get dialogPromptedOnUnload(){return this.X3d}set dialogPromptedOnUnload(za){this.X3d=za;this.My?(this.My.dialogPromptedOnUnload=
za,this.Lbb()):this.localStorage.If()&&d.ULS.sendTraceTag(537151058,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.If()}`)}get apiBeforeCloseNotificationEnabledOnUnload(){return this.H0d}set apiBeforeCloseNotificationEnabledOnUnload(za){this.H0d=za;this.My?(this.My.apiBeforeCloseNotificationEnabledOnUnload=za,this.Lbb()):this.localStorage.If()&&d.ULS.sendTraceTag(537151057,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.If()}`)}dispose(){this.$&&
this.$.userOperationManager&&this.$.userOperationManager.Fcj(this.zDf);this.jf&&(this.jf.SPa(this.tOa),this.jf=null);this.tm.JC();this.$=this.tm=null}Wcg(){this.btj();this.Lbb()}btj(){this.My.wasOfflineDuringUnload=this.$.Rf.tZ;this.My.timeFromLastConnectivity=Hd.a(pb.a.Wa,this.$.Rf.ijf);this.My.timeFromLastDisconnectionStart=Hd.a(pb.a.Wa,this.$.Rf.Api);this.My.disconnectionSource=Enum.toString(xd.a,this.$.Rf.disconnectionSource);this.My.hadConnectivityIssuesDuringUnload=this.$.Rf.Wja;this.My.timeFromLastStatusCode0=
Hd.a(pb.a.Wa,this.$.Rf.hjf)}Lbb(){this.My.timestamp=Date.now();this.localStorage.YNd(this.kVc,this.My.NJj())}WWf(){const za=this.localStorage.Yub(this.kVc);if(za)try{const Aa=od.a.Vh(za);this.localStorage.JHd(this.kVc);const xc=this.kxi(Aa);d.ULS.sendTraceTag(574677456,0,50,xc)}catch(Aa){d.ULS.sendTraceTag(537151056,0,15,`AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: ${Aa.message}`)}else d.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")}kxi(za){const Aa=
{};Aa.WACSessionID=za.wacSessionId;Aa.wasRefreshed=this.sWg(za,this.$.ya.MaxAppReloadDurationIndicatingRefresh);Aa.closedWithDialogConfirmation=za.dialogPromptedOnUnload;Aa.wasOfflineDuringUnload=za.wasOfflineDuringUnload;Aa.TimeFromLastConnectivityMs=za.timeFromLastConnectivity;Aa.TimeFromLastDisconnectionStart=za.timeFromLastDisconnectionStart;Aa.wasDataLostDuringUnload=za.wasDataLostDuringUnload;Aa.DataLossInfo=za.dataLossInfo;Aa.flushedOnUnload=za.wasUpdatedOnUnload;Aa.flushedOnBeforeUnload=za.wasUpdatedOnBeforeUnload;
Aa.InactivityDurationBeforeUnload=za.inactivityDurationBeforeUnloadSeconds;Aa.DisconnectionSource=za.disconnectionSource;Aa.hadConnectivityIssuesDuringUnload=za.hadConnectivityIssuesDuringUnload;Aa.TimeFromLastStatusCode0=za.timeFromLastStatusCode0;Aa.LastSilentReopenStartTime=za.lastSilentReopenStartTime;Aa.LastSilentReopenEndTime=za.lastSilentReopenEndTime;sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&(Aa.ApiBeforeCloseNotificationEnabledOnUnload=
za.apiBeforeCloseNotificationEnabledOnUnload);return H.c(Aa)}sWg(za,Aa){const xc=window.performance.timing.navigationStart-za.timestamp;(za=this.workbookHashedId===za.workbookHashedId&&xc<Aa)&&d.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return za}static ka(za){za.ea.jc.inWebPart||za.da.Ga(410,new Cf(za))}}Cf.Oyi=10;Object(b.a)(Cf,"AppUnloadTelemetryManager",null,[686,2]);var Jf=a(172),Uf=a(109);class cg{constructor(za,Aa){this.stopped=!1;this.chainedCallsTracer=
za;this.Glg=Aa}get call(){return this.Glg}T5f(){d.ULS.shipAssertTag(537151050,1,!this.stopped,"ChainedCallsTracer.CallMeasureContext.StopMeasuring: Calling stop after object was already stopped.");this.stopped||(this.stopped=!0,this.chainedCallsTracer.gFj(this))}dispose(){this.T5f()}}Object(b.a)(cg,"CallMeasureContext",null,[704,2]);class wg{constructor(za,Aa){this.e9c=0;this.QPe=this.startTime=Uc.HelperMethods.Tb();this._name=za;this.cC=Aa}get name(){return this._name}get type(){return this.cC}M1g(){this.QPe=
Uc.HelperMethods.Tb()}Q5f(){this.e9c+=Uc.HelperMethods.Tb()-this.QPe}kPh(){return Uc.HelperMethods.Tb()-this.startTime}$Ej(){this.Q5f();return this.e9c}}Object(b.a)(wg,"MeasuredCall",null,[]);class Vf{constructor(za){this.Yra=[];this.pZc=null;this.Gzi=100;this.documentVisibilityObserver=null;this.Fzi=za}j5f(za,Aa){this.o7g();this.cFj();za=new wg(za,Aa);this.Yra.push(za);return new cg(this,za)}o7g(){0<this.Yra.length?d.ULS.shipAssertTag(537151054,1,!!this.pZc,"ChainedCallsTracer.CreateNewChainIdIfNeeded: callsChain has items but chainId is null or empty."):
this.pZc=Jf.a.create().toString()}gFj(za){const Aa=this.Yra.pop();if(za.call!==Aa)d.ULS.sendTraceTag(537151053,0,10,"ChainedCallsTracer.StopMeasuringCall: Popped call is not the same as the topmost call in the chain. Popped call ID: {0} Topmost in the chain: {1}",za.call.name,Aa?Aa.name:"null"),this.Yra=[];else{za=Aa.kPh();var xc=Aa.$Ej();d.ULS.shipAssertTag(537151052,1,!!this.documentVisibilityObserver,"ChainedCallsTracer.IsInProximityToDocumentHidden: documentVisibilityObserver is null");var zd=
this.documentVisibilityObserver?this.documentVisibilityObserver.bD(za+this.Gzi):null;this.Kti(Aa,za,xc,zd);this.N1g()}}cFj(){const za=this.hZe();za&&za.Q5f()}N1g(){const za=this.hZe();za&&za.M1g()}hZe(){return this.Yra.length?this.Yra[this.Yra.length-1]:null}Kti(za,Aa,xc,zd){if(!(Aa<this.Fzi)){var de=Uf.f(this.Yra,pe=>pe.name).join();d.ULS.sendTraceTag(537151051,0,50,`ChainedCallsTracer: Inclusive duration: ${Aa.toFixed(2)} Exclusive duration: ${xc.toFixed(2)} Chain ID: ${this.pZc} Call ID: ${za.name} Type: ${za.type} Document hidden: ${zd} Call chain: ${de}`)}}static ka(za){if(sb.EwaSettings.ma(676)){var Aa=
new Vf(za.ya.ChainedCallsTracerMinThresholdToLogInMs);za.da.Za(291,xc=>{Aa.documentVisibilityObserver=xc});za.da.Ga(425,Aa);Fe.a.uoj(Aa)}}}Object(b.a)(Vf,"ChainedCallsTracer",null,[683]);var Da=a(516);class Fb{constructor(za){this.Me=null;this.MKj=Aa=>{const xc={["TaskName"]:Aa.TN,["TotalRunInMs"]:Aa.TRT,["TotalDelayInMs"]:Aa.TDT,["TotalQueueInMs"]:Aa.TQT,["TaskPriority"]:Aa.TP,["CoauthorsCount"]:this.ea.Jm.length};Aa.TDT>this.NUd||Aa.TRT>this.LUd?d.ULS.sendTraceTag(321938518,0,15,D.a.toJSON(xc)):
(Aa.TDT>this.MUd||Aa.TRT>this.KUd)&&d.ULS.sendTraceTag(321938508,0,50,D.a.toJSON(xc))};this.ezh=Aa=>this.Me.bD(Aa.TRT+Aa.TQT+3E3)?!1:Aa.TDT>Math.min(this.MUd,this.NUd)||Aa.TRT>Math.min(this.KUd,this.LUd);this.NUd=za.ya.TimeToReportOnLongWaitingTaskInMsAsWarning;this.MUd=za.ya.TimeToReportOnLongWaitingTaskInMsAsMedium;this.LUd=za.ya.TimeToReportOnLongRunningTaskInMsAsWarning;this.KUd=za.ya.TimeToReportOnLongRunningTaskInMsAsMedium;this.ea=za.ea;za.da.Za(291,Aa=>{this.Me=Aa});d.ULS.sendTraceTag(537151046,
0,50,`TaskEventProcessor initialized with TimeToReportOnLongWaitingTaskInMsAsMedium = ${this.MUd}, TimeToReportOnLongWaitingTaskInMsAsWarning = ${this.NUd}, TimeToReportOnLongRunningTaskInMsAsMedium = ${this.KUd}, TimeToReportOnLongRunningTaskInMsAsWarning = ${this.LUd}`)}}Object(b.a)(Fb,"TaskEventProcessor",null,[]);const Fc=za=>{d.ULS.sendTraceTag(537151049,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: Starting RegisterCpuMeterTaskEvent");Qb.TaskExtensions.Aa(Da.a.Uq(bb.a.instance.Wb("Common.ICpuMeterProvider")),
Aa=>{d.ULS.sendTraceTag(537151048,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeterProvider resolved");Qb.TaskExtensions.Aa(Aa.result.hk.task,xc=>{d.ULS.sendTraceTag(537151047,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeter resolved");const zd=new Fb(za);xc.result.ZSc(0,zd.ezh,zd.MKj)},za.la,3)},za.la,3)};var jd=a(14);class Ad{constructor(za){this.uFe=!1;this.wFe=null;this.Vc=()=>{this.tij();bd.g(this.$).ha&&bd.g(this.$).ha.nI(this.Vc)};
this.Gh=(Aa,xc)=>{xc.pa&&!this.tUd.has(xc.pa.name)&&(this.tUd.add(xc.pa.name),bd.g(this.$).ha&&(bd.g(this.$).ha.nI(this.Vc),bd.g(this.$).ha.lE(this.Vc)))};this.$=za;this.r8f=new Set;this.tUd=new Set;this.$.xa&&this.$.xa.pa&&this.tUd.add(this.$.xa.pa.name);bd.g(this.$).ha.lE(this.Vc);this.$.xa.Pf(this.Gh)}dispose(){this.$=null}tij(){this.wFe||this.VSg();const za=bd.c(bd.g(this.$));if(!this.uFe){const Aa=jd.a.instance.Xa(281).split(",");za.push(...Aa);this.uFe=!0}for(const Aa of za)Aa&&!this.r8f.has(Aa)&&
(this.Uti(Aa),this.r8f.add(Aa))}Uti(za){this.PTg(za)}VSg(){this.wFe=Ad.u3a("monospace");Ad.u3a("sans-serif");Ad.u3a("serif")}PTg(za){Ad.u3a(`${za},${"monospace"}`);Ad.u3a(`${za},${"sans-serif"}`);Ad.u3a(`${za},${"serif"}`)}static ka(za){if(sb.EwaSettings.ma(62)){const Aa=new Ad(za);za.da.Ga(210,Aa)}}static u3a(za){const Aa=document.createElement("div"),xc=document.createElement("div");Aa.style.cssText="position: absolute; overflow: auto; visibility: hidden;";Ad.Nsj(xc,za);document.body.appendChild(Aa);
Aa.appendChild(xc);xc.innerHTML="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";za=xc.offsetWidth+"x"+xc.offsetHeight;document.body.removeChild(xc.parentNode);return za}static Nsj(za,Aa){za.style.cssText="display: inline; visibility: hidden;";za.style.fontSize="100px";za.style.fontWeight="normal";za.style.fontStyle="normal";za.style.letterSpacing="normal";za.style.lineHeight="normal";za.style.whiteSpace="nowrap";za.style.fontFamily=Aa}}Object(b.a)(Ad,"FontTelemetryManager",
null,[2]);var Ud=a(233),ue=a(160),re;(function(za){za[za.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";za[za.reactSingleLineRibbon=1]="reactSingleLineRibbon";za[za.reactMultiLineRibbon=2]="reactMultiLineRibbon";za[za.invalid=3]="invalid"})(re||(re={}));Object(b.b)("RibbonMode",re);var Ue=a(105);class Ie extends Fe.a{constructor(){super();this.ML=!1;this.t9d=this.s9d=null;this.Yyd=()=>{this.Ncg()};this.DOi=()=>{cd.a.Ia(this.qY);cd.a.Ia(this.tm)};this.qY=Md.a.instance.eHa();this.tm=Md.a.instance.aH();
this.qY.ka("visibilitychange",this.Yyd);this.tm.ka("pagehide",this.DOi);this.Ncg()}get Ii(){return this.ML}get Aif(){return this.s9d}get Nhc(){return this.t9d}ZXa(za){this.addHandler("ekdh",za)}Oab(za){this.removeHandler("ekdh",za)}Cmb(za){this.addHandler("ekduh",za)}Pab(za){this.removeHandler("ekduh",za)}bD(za){return this.Ii?!0:this.Nhc?Ta.getElapsedMilliseconds(this.Nhc,pb.a.Wa.Nb)<za:!1}dispose(){cd.a.Ia(this.qY);cd.a.Ia(this.tm);super.dispose()}Ncg(){this.ML="hidden"===window.document.visibilityState;
this.Ii?(this.raiseEvent("ekdh"),this.s9d=pb.a.Wa.Nb):(this.raiseEvent("ekduh"),this.t9d=pb.a.Wa.Nb)}}Object(b.a)(Ie,"DocumentVisibilityObserver",Fe.a,[772,2]);class bf{constructor(){this.longFramesOverThresholdOpsPercentage=this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;this.maxLongFrameDuration=-1}}Object(b.a)(bf,"FramePerformanceData",null,[]);class Ee{constructor(za){this.name=null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=
new bf;this.l2FramePerformanceData=new bf;this.l3FramePerformanceData=new bf;this.name=za}}Object(b.a)(Ee,"FramePerformanceDataGroup",null,[]);class zf{constructor(){this._reportName=null;this.operationsGroups=[];this._reportName="FramePerformanceCanvas"}get reportName(){return this._reportName}}Object(b.a)(zf,"FramePerformanceSessionEndsReport",null,[734]);class Af{constructor(za){this.tBd={};this.pga=null;this.Neb=(Aa,xc)=>{Aa.longFramesOverThresholdOps++;Aa.maxLongFrameDuration=Math.max(Aa.maxLongFrameDuration,
xc)};this.ef=new zf;this.F7g();za.da.Za(276,()=>{bc.a(za).FX(this.ef)})}F7g(){this.pga=new Ee("AllGridOperationsData");this.ef.operationsGroups.push(this.pga);this.Dqb("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.Dqb("DragScroll",["DragScroll"]);this.Dqb("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.Dqb("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.Dqb("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])}lej(za,Aa,xc,zd){const de=this.fOh(za);de&&(Uf.b(this.ef.operationsGroups,pe=>Ua.a.equals(pe.name,de.name,!1))||this.ef.operationsGroups.push(de),de.count++,this.PAc(Aa,de),this.LAc(xc,de),this.pga.count++,
this.PAc(Aa,this.pga),this.LAc(xc,this.pga),0<zd&&this.XRj(zd,de),0<=Aa&&this.qRj(Aa,de))}zSj(){for(const za of this.ef.operationsGroups)Af.uRj(za)}Dqb(za,Aa){za=new Ee(za);for(const xc of Aa)this.tBd[xc]=za}fOh(za){return za in this.tBd?this.tBd[za]:null}qRj(za,Aa){30>za&&this.iXd(xc=>{xc.l1FramePerformanceData.fpsUnderThresholdOps++},Aa);15>za&&this.iXd(xc=>{xc.l2FramePerformanceData.fpsUnderThresholdOps++},Aa);5>za&&this.iXd(xc=>{xc.l3FramePerformanceData.fpsUnderThresholdOps++},Aa)}XRj(za,Aa){100<=
za&&(this.Oeb(Aa.l1FramePerformanceData,za,this.Neb),this.Oeb(this.pga.l1FramePerformanceData,za,this.Neb));300<=za&&(this.Oeb(Aa.l2FramePerformanceData,za,this.Neb),this.Oeb(this.pga.l2FramePerformanceData,za,this.Neb));600<=za&&(this.Oeb(Aa.l3FramePerformanceData,za,this.Neb),this.Oeb(this.pga.l3FramePerformanceData,za,this.Neb))}iXd(za,Aa){Aa&&(za(Aa),za(this.pga))}Oeb(za,Aa,xc){za&&xc(za,Aa)}PAc(za,Aa){Aa.minFPS=-1===Aa.minFPS?za:Math.min(Aa.minFPS,za)}LAc(za,Aa){Aa.maxFPS=Math.max(Aa.maxFPS,
za)}static uRj(za){Af.IXd(za.l1FramePerformanceData,za.count);Af.IXd(za.l2FramePerformanceData,za.count);Af.IXd(za.l3FramePerformanceData,za.count)}static IXd(za,Aa){za.fpsUnderThresholdOpsPercentage=100*za.fpsUnderThresholdOps/Aa;za.longFramesOverThresholdOpsPercentage=100*za.longFramesOverThresholdOps/Aa}}Object(b.a)(Af,"FramePerformanceSessionEndsReportManager",null,[]);class Mf{constructor(){this.f=null}}Object(b.a)(Mf,"FpsDataWrapper",null,[]);class mg{constructor(za=-1,Aa=-1){this.duration=
this.startSecond=0;this.startSecond=za;this.duration=Aa}}Object(b.a)(mg,"LongFrameData",null,[]);var Qa=a(341);class xb{constructor(za=null,Aa=0,xc=-1,zd=-1,de=0,pe=-1,$e=0,Df=-1,Sf=-1,Bf=null){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=za;this.count=Aa;this.start=xc;this.end=zd;this.Avg=de;this.Max=pe;this.Min=Qa.a.lig;this.longFrameCount=$e;this.coauth=Df||1;this.tfAppInt=Sf;this.Props=
Bf;this.LFrame=null}}Object(b.a)(xb,"OperationFPSData",null,[]);var ac=a(34),zc=a(786);class Yc extends Ob.a{constructor(za){super();this.dnb=-1;this.ord=0;this.bxa=new Date(0);this.TX=null;this.Cha={};this.Ita=new Bc.a;this.MKd=this.s7a=!1;this.E2a=null;this.Myc=this.J8a=0;this.isSynthetic=!1;this.NTe=()=>{const Aa=new Date;var xc=Aa.getMinutes();const zd=Aa.getSeconds();this.HAb&&Aa.getTime()-this.HAb.getTime()>this.vIj?(this.stop(),this.W$c(Aa)):(xc!==this.ord&&(this.W$c(Aa),this.ord=xc),this.s7a&&
(this.Me.Ii?this.TX[zd]=Yc.q5b:(this.PGe(zd),this.s7a=!1,this.Ita.clear(),this.Cha={})),this.TX[zd]!==Yc.q5b&&(this.TX[zd]++,xc=Aa.getTime()-this.bxa.getTime(),xc>this.qmf&&this.sui(this.bxa,xc)),this.dnb=window.requestAnimationFrame(this.NTe),this.bxa=Aa)};this.t5=()=>{this.s7a=!0};this.ltf=()=>{this.pause()};this.ntf=()=>{this.MKd&&this.resume()};this.Li=()=>{this.Ea.kZ()&&this.fSj()};this.HAb=new Date;this.Me=new Ie;this.Me.ZXa(this.t5);k.AFrameworkApplication.FTc(this.ltf);k.AFrameworkApplication.GTc(this.ntf);
this.$=za;this.qmf=za.ya.LongFrameThresholdMs;this.$vi="MoreThan_"+this.qmf.toString()+"_Ms";this.uIj=za.ya.ThresholdToEndOperationTrackingSeconds;this.vIj=za.ya.ThresholdToStopFPSTrackingMS;this.Ea=bd.g(this.$).Ea;k.AFrameworkApplication.Qb&&k.AFrameworkApplication.Qb.IsSynthetic&&(this.isSynthetic=Ua.a.compare(k.AFrameworkApplication.Qb[Rb.a.isSynthetic],"True",!0)?!1:!0);this.Ea.kx(this.Li);this.hKd();this.tui=this.$.cka&&sb.EwaSettings.ma(579)}start(){this.MKd=!0;this.resume()}stop(){this.MKd=
!1;this.pause()}dispose(){this.stop();this.Me.Oab(this.t5);k.AFrameworkApplication.fPf(this.ltf);k.AFrameworkApplication.gPf(this.ntf);cd.a.Ia(this.Me);this.Ea.sv(this.Li);super.dispose()}pEj(za,Aa){const xc=za in this.Cha?this.Cha[za]:null;this.HAb=new Date;this.start();const zd=this.HAb.getSeconds(),de=zd+this.uIj;xc&&zd<=xc.end?(xc.count++,xc.end=de):(xc&&zd>xc.end&&this.Ita.add(xc),this.Cha[za]=new xb(za,1,zd,de,void 0,void 0,void 0,this.$.ea.Jm.length,tc.PageLoadTrackingInfo.instance.TJa(this.HAb),
Aa))}V5g(){this.E2a||(this.W$c(new Date),this.E2a=new Af(this.$))}resume(){this.jcf()||!this.Ea.TK||this.isSynthetic||(this.s7a=this.Me.Ii,this.bxa=new Date,this.ord=this.bxa.getMinutes(),this.hKd(),this.PGe(this.bxa.getSeconds()),this.dnb=window.requestAnimationFrame(this.NTe))}jcf(){return 0<=this.dnb}pause(){this.jcf()&&(this.s7a||(this.QGe((new Date).getSeconds()),d.ULS.sendTraceTag(21280654,0,50,`FPS : ${this.TX.toString()}`)),window.cancelAnimationFrame(this.dnb),this.dnb=-1)}W$c(za){if(za.getTime()-
this.bxa.getTime()<Yc.Dzi&&(this.s7a&&this.QGe(this.bxa.getSeconds()),this.Ujh(),0<this.Ita.count&&(za={},za.NonEmptyCellsCount=this.J8a,za.TextCellsCount=this.Myc,za.xlfpsJson=Object(wb.a)(new Mf,{f:this.Ita.toArray()}),za.memoryInfo=this.bzi(),za.zoom=ac.a(this.$)?ac.a(this.$).zoom:1,za.RibbonMode=ue.a(this.$)?re[ue.a(this.$).uR]:Yc.invalid,za.deviceMemory=navigator.deviceMemory||0,za.hardwareConcurrency=navigator.hardwareConcurrency||0,za=JSON.stringify(za),d.ULS.sendTraceTag(537151044,0,50,`FPS : ${this.TX.toString()}`),
!this.isSynthetic))){if(ma.a.kda()){var Aa={};Aa.xlfpsJson=za;this.$.Kma(ed.a.QXj,Aa,!1)}else d.ULS.sendTraceTag(388781010,0,50,`${za}`);if(this.tui)for(let xc of this.Ita){Aa=1E3>=this.J8a?"0_1000":3E3>=this.J8a?"1000_3000":"3000_inf";const zd=new Map;zd.set("Operation",xc.Op);zd.set("BucketOfRenderedCells",Aa);X.Health.instance.recordKpiUsage(Wa.a.longFrame,0,se.a.canvas,zd);0<xc.longFrameCount&&X.Health.instance.recordKpiFailure(Wa.a.longFrame,"LongFrame",!1,!0,Object(wb.a)(new J.a,{extendedProperties:zd}));
3E4<xc.tfAppInt&&(0<xc.longFrameCount?db.b().wRf(0,this.$vi,zd):db.b().xRf(0,zd))}d.ULS.sendTraceTag(537151043,0,50,`Operations message length: ${za.length}`)}this.reset()}bzi(){const za={};if(window.performance){const Aa=window.performance.memory;Aa&&(za.jsHeapSizeLimit=Aa.jsHeapSizeLimit,za.usedJSHeapSize=Aa.usedJSHeapSize,za.totalJSHeapSize=Aa.totalJSHeapSize)}return za}reset(){this.Ita.clear();this.Cha={};this.hKd()}Ujh(){if(this.TX){for(const za of zc.a(this.Cha)){const Aa=this.Cha[za];Aa.end=
Math.min(this.TX.length-1,Aa.end);this.Ita.add(Aa)}this.gTg(this.Ita,this.TX)}}gTg(za,Aa){for(let xc of za){let zd=za=0;if(xc.end<Aa.length){for(let de=xc.start;de<=xc.end;de++){const pe=Aa[de];0<=pe&&(xc.Max=Math.round(Math.max(xc.Max,pe)),xc.Min=Math.round(Math.min(xc.Min,pe)),za+=pe,zd++)}0<zd&&(xc.Avg=Math.round(za/zd));this.E2a&&this.E2a.lej(xc.Op,xc.Min,xc.Max,xc.LFrame?xc.LFrame.duration:-1);xc.Props&&(this.hNj(xc),xc.Props=null)}}this.E2a&&this.E2a.zSj()}hKd(){this.TX=[0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}PGe(za){za++;for(let Aa=0;Aa<za;Aa++)this.TX[Aa]=Yc.q5b}QGe(za){for(;60>za;za++)this.TX[za]=Yc.q5b}sui(za,Aa){za=za.getSeconds();var xc=zc.a(this.Cha);if(0<xc.length)for(const zd of xc)if(xc=this.Cha[zd],za>=xc.start&&za<xc.end)xc.LFrame?xc.LFrame.duration<Aa&&(xc.LFrame.startSecond=za,xc.LFrame.duration=Aa,xc.longFrameCount++):(xc.LFrame=new mg(za,Aa),xc.longFrameCount++)}fSj(){this.Myc=this.J8a=
0;for(const za of bd.g(this.$).tn){const Aa=za.wBa;for(let xc in Aa){const zd=this.Ea.Jl(Aa[xc].hashCode);if(null===zd||void 0===zd?0:zd.Dk)this.J8a+=zd.pe.NonEmptyCellsCount,this.Myc+=zd.pe.TextValueCellsCount}}}hNj(za){const Aa=za.Props;if(va.a.WKb in Aa&&Aa[va.a.WKb]&&va.a.CMb in Aa){let xc;(xc=Object(F.a)(Ud.a,Aa[va.a.CMb]))&&xc.continueWith(zd=>{Ue.TextEditorTelemetry.instance.WAg(za.Op,za.Min,!!za.LFrame,za.LFrame?za.LFrame.duration:0,zd.result)})}}}Yc.q5b=-1;Yc.Dzi=6E4;Yc.invalid="Invalid";
Object(b.a)(Yc,"FramePerformanceTracker",Ob.a,[767,2]);class md extends rb.a{constructor(za){super();this.$=za;this.Fb()}create(){let za=this.$.da.za(263);za||(za=this.$.da.Ga(263,new Yc(this.$)));this.qb(za)}static ka(za){za.da.Ga(264,new md(za))}}Object(b.a)(md,"FramePerformanceTrackerFactory",rb.a,[]);var sd=a(1273),h=a(936);class Ib{Og(za,Aa){return new h.a(za,Aa)}Bc(za,Aa){za=this.Og(za,Aa);za.start();return za}}Object(b.a)(Ib,"DefaultStopwatchBuilder",null,[160]);class ec{constructor(){this.spa=
new Ib}Og(za,Aa){return this.spa.Og(za,Aa)}Bc(za,Aa){return this.spa.Bc(za,Aa)}}Object(b.a)(ec,"StopwatchBuilder",null,[160]);var Ec=a(412),fd=a(1027),Cd=a(922),Gd;(function(za){za[za.actions=0]="actions";za[za.correlationStart=1]="correlationStart";za[za.reorderSheetOp=2]="reorderSheetOp";za[za.formatCellOp=3]="formatCellOp";za[za.copyOp=4]="copyOp";za[za.pasteOp=5]="pasteOp";za[za.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";za[za.instantaneousSetData=7]="instantaneousSetData";za[za.immediateSetData=
8]="immediateSetData";za[za.dependentCellsCalc=9]="dependentCellsCalc";za[za.dependentCellsGraphStat=10]="dependentCellsGraphStat";za[za.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";za[za.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";za[za.gridBlockUpdates=13]="gridBlockUpdates";za[za.browserAppStart=14]="browserAppStart";za[za.linkedObjects=15]="linkedObjects";za[za.longFrames=16]="longFrames";za[za.task=17]="task";za[za.conflictInEditing=18]="conflictInEditing";
za[za.incomingPresenceData=19]="incomingPresenceData";za[za.editorTableDelay=20]="editorTableDelay";za[za.presenceStartup=21]="presenceStartup";za[za.presenceDelete=22]="presenceDelete";za[za.editorEvent=23]="editorEvent";za[za.editorTime=24]="editorTime";za[za.gridScreenReaderOps=25]="gridScreenReaderOps";za[za.sendPresenceToService=26]="sendPresenceToService";za[za.IME=27]="IME";za[za.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";za[za.customizeStatusBar=29]="customizeStatusBar";za[za.clientWebRequests=
30]="clientWebRequests";za[za.showCommentTaskPane=31]="showCommentTaskPane";za[za.applyThreadedCommentChange=32]="applyThreadedCommentChange";za[za.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";za[za.findNextOrPreviousComment=34]="findNextOrPreviousComment";za[za.goto=35]="goto";za[za.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";za[za.richApiInvocation=37]="richApiInvocation";za[za.fxLibrary=38]="fxLibrary";za[za.embeddedApiSession=39]="embeddedApiSession";za[za.numberFormattingCalculator=
40]="numberFormattingCalculator";za[za.requestDataAfterSend=41]="requestDataAfterSend";za[za.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";za[za.copy=43]="copy";za[za.paste=44]="paste";za[za.dragDrop=45]="dragDrop";za[za.clearCopyState=46]="clearCopyState";za[za.webWorkerRecalcStats=47]="webWorkerRecalcStats";za[za.dataValidationEditOpenDialog=48]="dataValidationEditOpenDialog";za[za.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";za[za.customSort=50]="customSort";
za[za.namedSheetViewUserAction=51]="namedSheetViewUserAction";za[za.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";za[za.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";za[za.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";za[za.namedSheetViewTempViewApplyDialog=55]="namedSheetViewTempViewApplyDialog";za[za.namedSheetViewTempViewSaveDialog=56]="namedSheetViewTempViewSaveDialog";za[za.temporaryViewStartedDataRestore=57]="temporaryViewStartedDataRestore";
za[za.temporaryViewFetchedVersion=58]="temporaryViewFetchedVersion";za[za.raiseEventsAndGenerateBlockRequests=59]="raiseEventsAndGenerateBlockRequests";za[za.launchMakerCodeEditor=60]="launchMakerCodeEditor"})(Gd||(Gd={}));Object(b.b)("UsageTable",Gd);var Yd=a(419),fe=a(469),Le=a(595),te=a(644),rf=a(267);class Fa extends Sys.EventArgs{constructor(){super();this.cCi=0;this.operation="DOMUpdate";this.sender=this.target=null}}Object(b.a)(Fa,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,[]);class Mb{constructor(za,
Aa=1){this.wLd=Aa;this.total=za}get average(){return this.total/this.wLd}vZg(za){return new Mb(this.total+za.total,this.wLd+za.wLd)}static lQg(za,Aa){return`${za}_${Aa}`}}Object(b.a)(Mb,"StopwatchAverage",null,[]);var gc;(function(za){za[za.longFrame=0]="longFrame";za[za.longGetRange=1]="longGetRange";za[za.longJsTask=2]="longJsTask";za[za.viewportCalculationLoops=3]="viewportCalculationLoops"})(gc||(gc={}));Object(b.b)("UtrKpiVeto",gc);class Qc{static $3a(za){return Enum.toString(gc,za)}}Qc.yTa=
"UTR";Object(b.a)(Qc,"KpiConstants",null,[]);class Sc{}Sc.Ieg="UTRVetoName";Sc.Aeg="UTRErrorName";Sc.IUj="UTROperationName";Sc.GYd="UTRDuration";Sc.JUj="UTREndedInPhase";Sc.Feg="UTRMessage";Sc.Heg="UtrUnavailabilityType";Sc.operationName="OperationName";Sc.duration="Duration";Sc.message="Message";Object(b.a)(Sc,"UtrAdditionalData",null,[]);class ud{}ud.QVj="VetoLike";ud.Whh="E2EOperationPerf";ud.Pej="RequestPerf";ud.bOj="UnavailabilityDurations";Object(b.a)(ud,"UtrTypes",null,[]);class Zd{iIb(za,
Aa,xc=null){sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(xc=xc?Object(wb.a)(new J.a,{extendedProperties:xc}):null,za=Qc.$3a(za),X.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+za,Aa,!1,!0,"",xc))}KJb(za,Aa,xc,zd,de,pe){pe[Qc.yTa]=ud.QVj;pe[Sc.Ieg]=Qc.$3a(zd);pe[Sc.Aeg]=de;d.ULS.sendTraceTag(za,Aa,xc,od.a.Ac(pe));delete pe[Qc.yTa];delete pe[Sc.Ieg];delete pe[Sc.Aeg]}}Object(b.a)(Zd,"UtrKpiVetoReporter",null,[]);class ne{HJd(za,Aa=null){sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
X.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+Qc.$3a(za),0,"",Aa)}iIb(za,Aa,xc=null){sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(za=Qc.$3a(za),X.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+za,Aa,!1,!0,this.$1c(xc)))}aej(za,Aa=null){sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||X.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+Qc.$3a(za),"",this.$1c(Aa))}$dj(za,Aa,xc=null){sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
(za=Qc.$3a(za),X.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+za,Aa,!1,!0,"",this.$1c(xc)))}$1c(za){return za?Object(wb.a)(new J.a,{extendedProperties:za}):null}}Object(b.a)(ne,"UtrKpiVetoUsageReporter",null,[]);class Rd{hsc(za,Aa,xc=null){sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||X.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+za,"",Object(wb.a)(new J.a,{extendedProperties:xc,durationMs:Aa}))}psc(za,Aa,xc=null){sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
(Aa?X.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+za,"",Object(wb.a)(new J.a,{extendedProperties:xc})):X.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+za,"",!1,!1,"",Object(wb.a)(new J.a,{extendedProperties:xc})))}HJb(za,Aa,xc,zd,de,pe,$e,...Df){$e=String.format($e,...Df);Df={};Df[Qc.yTa]=ud.Whh;Df[Sc.IUj]=zd;Df[Sc.JUj]=de;Df[Sc.GYd]=pe;Df[Sc.Feg]=$e;d.ULS.sendTraceTag(za,Aa,xc,od.a.Ac(Df))}JJb(za,Aa,xc,zd,de,pe){this.H_f(pe,zd,de);d.ULS.sendTraceTag(za,Aa,xc,od.a.Ac(pe));
this.Rch(pe)}IJb(za,Aa,xc,zd,de,pe,...$e){pe=String.format(pe,...$e);$e={};this.H_f($e,zd,de,pe);d.ULS.sendTraceTag(za,Aa,xc,od.a.Ac($e))}nuc(za,Aa,xc,zd){zd[Qc.yTa]=ud.Pej;d.ULS.sendTraceTag(za,Aa,xc,od.a.Ac(zd));delete zd[Qc.yTa]}H_f(za,Aa,xc,zd=null){za[Qc.yTa]=ud.bOj;za[Sc.Heg]=Aa;za[Sc.GYd]=xc;zd&&(za[Sc.Feg]=zd)}Rch(za){delete za[Qc.yTa];delete za[Sc.Heg];delete za[Sc.GYd]}}Object(b.a)(Rd,"UtrOperationPerfReporter",null,[]);class ie extends Fe.a{constructor(za,Aa=null,xc=null,zd=null,de=null,
pe=!1){super();this.cwh=[va.a.Vse,va.a.qLe,va.a.rLe,va.a.udc,va.a.Jic,va.a.vkf,va.a.renderCachedContent,va.a.renderServerContent,va.a.F3b,va.a.xjj,va.a.jVf,va.a.kVf,va.a.dnj];this.wkb=this.vCa=this.fOb=this.Zeb=this.y$d=this.ase=this.oWa=this.rge=null;this.LFf=this.Tse=!1;this.Eeg=this.Deg=this.Geg=this.UJd=this.Nfg=null;this.QAf=($e,Df)=>{for($e=0;$e<Df.entries.length;$e++){const wf=Df.entries[$e];wf.url=w.a.removeParameter(wf.url,k.AFrameworkApplication.aP);var Sf=w.a.Jca(wf.url);!sb.EwaSettings.ma(489)&&
this.Cki(wf.url,Sf)&&(wf.behavior=1);if("img"===wf.yt.initiatorType&&Sf.endsWith(fd.a.FIe)){var Bf=w.a.SY(wf.url,fd.a.EIe),kg=w.a.SY(wf.url,fd.a.GIe);wf.n$=`${wf.n$}imageID=${Bf}, imgStateID=${kg}`}Bf=wf.yt.transferSize;let lg;kg=wf.yt.decodedBodySize;void 0!==Bf&&null!==Bf&&void 0!==kg&&null!==kg?lg=0===Bf&&0<kg:void 0!==Bf&&null!==Bf&&(lg=0===Bf);tc.PageLoadTrackingInfo.instance.$Bg(Sf,Math.round(wf.yt.fetchStart),Math.round(wf.yt.responseEnd),lg,this.bmi);Ua.a.contains(Sf,va.a.richTextEditor,!0)&&
(Sf=Ue.TextEditorTelemetry.instance,Sf.jE(va.a.ogj,Math.round(wf.yt.fetchStart)),Sf.jE(va.a.qgj,Math.round(wf.yt.responseEnd)))}};this.t5=()=>{const $e=this.V6;for(let Df in $e)$e[Df].h=!0};this.userSessionId=za;this.a0a=Aa=Aa||new Le.a;this.Lh=xc||pb.a.Wa;this.nFj=zd||this;this.Me=de;this.bmi=pe;this.pFe=Aa.e8a();this.Me&&this.Me.ZXa(this.t5)}get V6(){return this.rge||(this.rge={})}get zEe(){return this.Zeb||this.pFe}get GEe(){return this.vCa||ie.nrf}get gTd(){return this.ase=this.ase||{}}get xoc(){return this.oWa||
"undefined"===typeof Stw?this.oWa:this.oWa=Stw.swpc}get nmf(){return this.y$d=this.y$d||{}}get dQa(){return this.wkb||(this.wkb=bb.a.instance.Wb("Common.NetworkTiming.IResourceTimingLogger"))}get Ceg(){return this.Deg||(this.Deg=new Zd)}get dfb(){return this.Geg||(this.Geg=new Rd)}get uBc(){return this.Eeg||(this.Eeg=new ne)}OSd(za,Aa,xc){this.SLb(za,Aa,xc,pb.a.XBb(pb.a.Wa.Nb.getTime()))}SLb(za,Aa,xc,zd,de=null){if(this.V6[xc])throw Error.invalidOperation("The specified stopwatchId is already in use.");
this.V6[xc]=this.UDe(za,Aa,xc,zd,de)}d7c(za){this.psb(za,pb.a.XBb(pb.a.Wa.Nb.getTime()))}psb(za,Aa){const xc=this.V6[za];xc&&(this.Tze(xc,Aa),this.UPj(xc),delete this.V6[za])}UOf(za){delete this.V6[za]}w5f(za,Aa){this.Zeb||this.l5f(za,Aa)}g5f(){this.w5f(ie.Bgd,this.Lh.je)}eKe(za,Aa=!1){if(this.Zeb){if(this.vCa===ie.LBd||this.vCa===ie.Bgd){const xc=z.a.instance;xc.userSessionId=this.userSessionId;if(this.vCa===ie.LBd){this.Tse||(this.Fka(za.m,Object(W.a)(xc,xc.G5i,"recordContentFetchEnd")),this.Tse=
!0);if(Aa){this.LFf||(this.Fka(za.m,Object(W.a)(xc,xc.U5i,"recordPerceivedContentDisplayed")),this.LFf=!0);return}this.Fka(za.m,Object(W.a)(xc,xc.F5i,"recordContentDisplayed"))}else this.vCa===ie.Bgd&&(Aa=this.V6[this.fOb])&&this.Fka(rf.a(za,Aa.s),Object(W.a)(xc,xc.R5i,"recordInteractivityContentDisplayed"),!1)}this.psb(this.fOb,za);this.fOb=this.vCa=this.Zeb=null}}Fka(za,Aa,xc=!0){z.a.oP&&Object(Ec.a)(te.PerformanceClock,pb.a.Wa)&&xc&&(za+=window.performance.timing.navigationStart);Aa(za)}nj(za){return Yd.a(za)}Le(za,
Aa,xc=!1){try{if(this.nmf[Gd[za]]=!0,xc){var zd=d.ULS,de=zd.sendTraceTag;const Tc={};let Ef=null;switch(za){case 0:Ef="Actions";var pe=Aa.a;null!=pe&&(Tc.Id=pe);var $e=null==Aa.b?null:Aa.b;null!=$e&&(Tc.Operation=$e);var Df=Aa.c;null!=Df&&(Tc.Target=Df);var Sf=null==Aa.d?null:Aa.d.toString();null!=Sf&&(Tc.StartTime=Sf);var Bf=null==Aa.e?null:Aa.e.toString();null!=Bf&&(Tc.Duration=Bf);var kg=Aa.f;null!=kg&&(Tc.CorrelationId=kg);var wf=Aa.g;null!=wf&&(Tc.ParentAction=wf);var lg=null==Aa.h?null:Aa.h.toString();
null!=lg&&(Tc.DocumentHidden=lg);break;case 1:Ef="CorrelationStart";var ng=Aa.a;null!=ng&&(Tc.CorrelationId=ng);var If=Aa.b;null!=If&&(Tc.UserSessionId=If);var Qf=Aa.c;null!=Qf&&(Tc.UserAction=Qf);break;case 2:Ef="ReorderSheetOp";var dg=Aa.a;null!=dg&&(Tc.UserSessionId=dg);var ph=null==Aa.b?null:Aa.b.toString();null!=ph&&(Tc.IsDragReorder=ph);var Ag=null==Aa.c?null:Aa.c.toString();null!=Ag&&(Tc.DocumentUp=Ag);var Sg=null==Aa.d?null:Aa.d.toString();null!=Sg&&(Tc.OldIndex=Sg);var ch=null==Aa.e?null:
Aa.e.toString();null!=ch&&(Tc.NewIndex=ch);var ah=null==Aa.f?null:Aa.f.toString();null!=ah&&(Tc.TotalSheets=ah);break;case 3:Ef="FormatCellOp";var ih=Aa.a;null!=ih&&(Tc.UserSessionId=ih);var Bg=null==Aa.b?null:Aa.b.toString();null!=Bg&&(Tc.TaskId=Bg);var xg=null==Aa.c?null:Aa.c.toString();null!=xg&&(Tc.NumberOfRanges=xg);var dh=Aa.d;null!=dh&&(Tc.Ranges=dh);var $g=Aa.e;null!=$g&&(Tc.ActiveCell=$g);var of=null==Aa.f?null:Aa.f.toString();null!=of&&(Tc.ActionId=of);var ka=Aa.g;null!=ka&&(Tc.CommandParameters=
ka);var qb=Aa.h;null!=qb&&(Tc.UserActionStopwatchId=qb);break;case 4:Ef="CopyOp";var pc=Aa.a;null!=pc&&(Tc.UserSessionId=pc);var Ic=null==Aa.b?null:Aa.b.toString();null!=Ic&&(Tc.IsChrome=Ic);var Bd=null==Aa.c?null:Aa.c.toString();null!=Bd&&(Tc.IsIE=Bd);var Sd=null==Aa.d?null:Aa.d.toString();null!=Sd&&(Tc.IsFromUI=Sd);var je=null==Aa.e?null:Aa.e.toString();null!=je&&(Tc.IsCopyInLoadedRange=je);var Ke=null==Aa.f?null:Aa.f.toString();null!=Ke&&(Tc.IsRepeatedCopy=Ke);var gf=null==Aa.g?null:Aa.g.toString();
null!=gf&&(Tc.IsClipboarAccessSupported=gf);var ba=null==Aa.h?null:Aa.h.toString();null!=ba&&(Tc.IsClipboarAccessInstallationSupported=ba);var cb=null==Aa.i?null:Aa.i.toString();null!=cb&&(Tc.RibbonCommand=cb);var Vb=null==Aa.j?null:Aa.j.toString();null!=Vb&&(Tc.CutCopyPasteFlags=Vb);var E=null==Aa.k?null:Aa.k.toString();null!=E&&(Tc.IsDrag=E);var ha=null==Aa.l?null:Aa.l.toString();null!=ha&&(Tc.IsIeBeforeAlowDenyPopUp=ha);var Ia=Aa.m;null!=Ia&&(Tc.IsPasteMatchCopy=Ia);var Gb=Aa.n;null!=Gb&&(Tc.WaitMessageInClipboard=
Gb);var mc=null==Aa.o?null:Aa.o.toString();null!=mc&&(Tc.CallCount=mc);break;case 5:Ef="PasteOp";var kc=Aa.a;null!=kc&&(Tc.UserSessionId=kc);var lc=null==Aa.b?null:Aa.b.toString();null!=lc&&(Tc.IsChrome=lc);var ad=null==Aa.c?null:Aa.c.toString();null!=ad&&(Tc.IsIE=ad);var vd=null==Aa.d?null:Aa.d.toString();null!=vd&&(Tc.IsCopyActive=vd);var td=null==Aa.e?null:Aa.e.toString();null!=td&&(Tc.IsFromUI=td);var Xd=null==Aa.f?null:Aa.f.toString();null!=Xd&&(Tc.IsClipboarAccessSupported=Xd);var $d=null==
Aa.g?null:Aa.g.toString();null!=$d&&(Tc.IsClipboarAccessInstallationSupported=$d);var He=null==Aa.h?null:Aa.h.toString();null!=He&&(Tc.RibbonCommand=He);var De=null==Aa.i?null:Aa.i.toString();null!=De&&(Tc.CutCopyPasteFlags=De);var Ge=Aa.j;null!=Ge&&(Tc.WaitMessageInClipboard=Ge);var jf=Aa.k;null!=jf&&(Tc.PopupDialog=jf);var df=Aa.l;null!=df&&(Tc.SimplePopupMessage=df);var nf=Aa.m;null!=nf&&(Tc.DialogCloseButton=nf);var sf=Aa.n;null!=sf&&(Tc.UserPressedInstallLink=sf);var pf=null==Aa.o?null:Aa.o.toString();
null!=pf&&(Tc.CallCount=pf);break;case 6:Ef="GetNumberViewModelDataOp";var Lf=Aa.a;null!=Lf&&(Tc.UserSessionId=Lf);var vf=Aa.b;null!=vf&&(Tc.NumberFormatOptionsPreviousOutputJson=vf);var Hg=Aa.c;null!=Hg&&(Tc.NumberFormatOptionsNewInputJson=Hg);break;case 7:Ef="InstantaneousSetData";var Ig=Aa.a;null!=Ig&&(Tc.Id=Ig);var Cg=null==Aa.b?null:Aa.b.toString();null!=Cg&&(Tc.WasEmpty=Cg);var Tg=null==Aa.c?null:Aa.c.toString();null!=Tg&&(Tc.ValueNotChanged=Tg);var eh=Aa.d;null!=eh&&(Tc.Source=eh);var ef=null==
Aa.e?null:Aa.e.toString();null!=ef&&(Tc.ProcessingCompleted=ef);break;case 8:Ef="ImmediateSetData";var Mg=Aa.a;null!=Mg&&(Tc.ClientStopwatchId=Mg);var og=Aa.b;null!=og&&(Tc.Operation=og);var Qg=Aa.c;null!=Qg&&(Tc.Parameters=Qg);var Qh=null==Aa.d?null:Aa.d.toString();null!=Qh&&(Tc.WasUpdatedByImmediate=Qh);var Fi=null==Aa.e?null:Aa.e.toString();null!=Fi&&(Tc.areHtmlElementsEqualClientComparison=Fi);var Eh=null==Aa.f?null:Aa.f.toString();null!=Eh&&(Tc.WasDecisionMadeByHtmlComparison=Eh);var $h=null==
Aa.g?null:Aa.g.toString();null!=$h&&(Tc.IsNumeric=$h);var Rh=null==Aa.h?null:Aa.h.toString();null!=Rh&&(Tc.IsDateTime=Rh);var Eg=null==Aa.i?null:Aa.i.toString();null!=Eg&&(Tc.HasCurrencySymbol=Eg);var kh=null==Aa.j?null:Aa.j.toString();null!=kh&&(Tc.HasPercentSymbol=kh);var Gi=null==Aa.k?null:Aa.k.toString();null!=Gi&&(Tc.IsFunc=Gi);var Wi=null==Aa.l?null:Aa.l.toString();null!=Wi&&(Tc.DiffInWrappingWhitespace=Wi);var Hi=Aa.m;null!=Hi&&(Tc.ImmediatePattern=Hi);var Xi=null==Aa.n?null:Aa.n.toString();
null!=Xi&&(Tc.TextAlignmentMatch=Xi);var Ii=null==Aa.o?null:Aa.o.toString();null!=Ii&&(Tc.FontColorMatch=Ii);var ai=null==Aa.p?null:Aa.p.toString();null!=ai&&(Tc.FormulaTextMatch=ai);var bi=null==Aa.q?null:Aa.q.toString();null!=bi&&(Tc.isFormula=bi);var ci=Aa.r;null!=ci&&(Tc.FormulaText=ci);var Sh=Aa.s;null!=Sh&&(Tc.InstantaneousPattern=Sh);var ui=null==Aa.t?null:Aa.t.toString();null!=ui&&(Tc.AreHtmlInnerTextElementsEqualClientComparison=ui);var vi=Aa.u;null!=vi&&(Tc.HtmlComparisonDecision=vi);break;
case 9:Ef="DependentCellsCalc";var Fh=Aa.a;null!=Fh&&(Tc.CalcStatus=Fh);var fh=null==Aa.b?null:Aa.b.toString();null!=fh&&(Tc.SuccessfullyCalculatedRanges=fh);var di=null==Aa.c?null:Aa.c.toString();null!=di&&(Tc.RangesSkipped=di);var Th=null==Aa.d?null:Aa.d.toString();null!=Th&&(Tc.TotalErrors=Th);var yg=null==Aa.e?null:Aa.e.toString();null!=yg&&(Tc.Partial=yg);var ei=null==Aa.f?null:Aa.f.toString();null!=ei&&(Tc.Canceled=ei);var lh=null==Aa.g?null:Aa.g.toString();null!=lh&&(Tc.Aggregate=lh);var Ji=
null==Aa.h?null:Aa.h.toString();null!=Ji&&(Tc.Unknown=Ji);var Uh=null==Aa.i?null:Aa.i.toString();null!=Uh&&(Tc.UnavailableData=Uh);var dd=null==Aa.j?null:Aa.j.toString();null!=dd&&(Tc.Cycle=dd);var Fd=null==Aa.k?null:Aa.k.toString();null!=Fd&&(Tc.NotImplemented=Fd);var Nf=null==Aa.l?null:Aa.l.toString();null!=Nf&&(Tc.InvalidInput=Nf);var Yi=null==Aa.m?null:Aa.m.toString();null!=Yi&&(Tc.AreDepCells=Yi);break;case 10:Ef="DependentCellsGraphStat";var Ah=null==Aa.a?null:Aa.a.toString();null!=Ah&&(Tc.ParsedFormulas=
Ah);var fi=null==Aa.b?null:Aa.b.toString();null!=fi&&(Tc.GraphNodes=fi);var gi=null==Aa.c?null:Aa.c.toString();null!=gi&&(Tc.GraphArcs=gi);var Vh=null==Aa.d?null:Aa.d.toString();null!=Vh&&(Tc.AnalyzedBlocks=Vh);var Ki=null==Aa.e?null:Aa.e.toString();null!=Ki&&(Tc.IterationId=Ki);var wi=Aa.f;null!=wi&&(Tc.UniqueId=wi);var xh=null==Aa.g?null:Aa.g.toString();null!=xh&&(Tc.Aborted=xh);break;case 11:Ef="DependentCellsGraphSectionStat";var xi=null==Aa.a?null:Aa.a.toString();null!=xi&&(Tc.IterationId=xi);
var Pg=Aa.b;null!=Pg&&(Tc.BlockHash=Pg);var Li=Aa.c;null!=Li&&(Tc.Functions=Li);var Gh=Aa.d;null!=Gh&&(Tc.Operators=Gh);var hi=null==Aa.e?null:Aa.e.toString();null!=hi&&(Tc.CrossDocRefs=hi);var Hh=null==Aa.f?null:Aa.f.toString();null!=Hh&&(Tc.CrossSheetRefs=Hh);var sg=null==Aa.g?null:Aa.g.toString();null!=sg&&(Tc.ErrRefs=sg);var yh=null==Aa.h?null:Aa.h.toString();null!=yh&&(Tc.LargeRanges=yh);var ii=null==Aa.i?null:Aa.i.toString();null!=ii&&(Tc.NameRefs=ii);var qh=null==Aa.j?null:Aa.j.toString();
null!=qh&&(Tc.ParserErrors=qh);var Wh=null==Aa.k?null:Aa.k.toString();null!=Wh&&(Tc.RowRefs=Wh);var zh=null==Aa.l?null:Aa.l.toString();null!=zh&&(Tc.ColumnRefs=zh);var Ug=null==Aa.m?null:Aa.m.toString();null!=Ug&&(Tc.TableRefs=Ug);var Ih=Aa.n;null!=Ih&&(Tc.UniqueId=Ih);var mf=null==Aa.o?null:Aa.o.toString();null!=mf&&(Tc.UnreachableReferences=mf);break;case 12:Ef="GetRangeContentPrefetchFailures";var gh=Aa.a;null!=gh&&(Tc.UserSessionId=gh);var Dg=Aa.b;null!=Dg&&(Tc.ClientStopwatchId=Dg);var gg=null==
Aa.c?null:Aa.c.toString();null!=gg&&(Tc.StateId=gg);break;case 13:Ef="GridBlockUpdates";var Rg=Aa.a;null!=Rg&&(Tc.UserSessionId=Rg);var Jh=Aa.b;null!=Jh&&(Tc.CorrelationId=Jh);var Kh=Aa.c;null!=Kh&&(Tc.Operation=Kh);var Mi=null==Aa.d?null:Aa.d.toString();null!=Mi&&(Tc.PerformanceType=Mi);var yi=Aa.e;null!=yi&&(Tc.BlockHash=yi);var Gg=null==Aa.f?null:Aa.f.toString();null!=Gg&&(Tc.DurationInMs=Gg);break;case 14:Ef="BrowserAppStart";var zi=null==Aa.a?null:Cd.a.Asa(Aa.a.getTime());null!=zi&&(Tc.ScriptExecutionStart=
zi);var ji=Aa.b;null!=ji&&(Tc.UserSessionId=ji);var Lh=Aa.c;null!=Lh&&(Tc.ClockMechanism=Lh);var Ni=null==Aa.d?null:Aa.d.toString();null!=Ni&&(Tc.ScreenDPI=Ni);var Oi=null==Aa.e?null:Aa.e.toString();null!=Oi&&(Tc.NavigationToScriptExecutionDelta=Oi);break;case 15:Ef="LinkedObjects";var Ai=Aa.a;null!=Ai&&(Tc.ChildId=Ai);var ki=Aa.b;null!=ki&&(Tc.ParentId=ki);var Jg=Aa.c;null!=Jg&&(Tc.ChildTable=Jg);var Pi=Aa.d;null!=Pi&&(Tc.ParentTable=Pi);break;case 16:Ef="LongFrames";var Vg=null==Aa.a?null:Cd.a.Asa(Aa.a.getTime());
null!=Vg&&(Tc.StartTime=Vg);var Wg=null==Aa.b?null:Aa.b.toString();null!=Wg&&(Tc.DurationInMs=Wg);break;case 17:Ef="Task";var Bi=Aa.a;null!=Bi&&(Tc.StopwatchId=Bi);var vh=null==Aa.b?null:Aa.b.toString();null!=vh&&(Tc.Status=vh);var li=null==Aa.c?null:Aa.c.toString();null!=li&&(Tc.CreateTime=li);var Bh=null==Aa.d?null:Aa.d.toString();null!=Bh&&(Tc.TaskId=Bh);break;case 18:Ef="ConflictInEditing";var Ch=Aa.a;null!=Ch&&(Tc.OtherUserState=Ch);var Qi=Aa.b;null!=Qi&&(Tc.UserSessionId=Qi);var Ri=null==Aa.c?
null:Cd.a.Asa(Aa.c.getTime());null!=Ri&&(Tc.ConflictTime=Ri);break;case 19:Ef="IncomingPresenceData";var Tf=Aa.a;null!=Tf&&(Tc.UserSessionId=Tf);var pg=Aa.b;null!=pg&&(Tc.UserId=pg);var Si=null==Aa.c?null:Aa.c.toString();null!=Si&&(Tc.Disconnected=Si);var Ci=null==Aa.d?null:Cd.a.Asa(Aa.d.getTime());null!=Ci&&(Tc.ReceivedTime=Ci);break;case 20:Ef="EditorTableDelay";var mi=Aa.a;null!=mi&&(Tc.UserSessionId=mi);var jh=Aa.b;null!=jh&&(Tc.UserId=jh);var sh=null==Aa.c?null:Aa.c.toString();null!=sh&&(Tc.Received=
sh);var Ti=null==Aa.d?null:Aa.d.toString();null!=Ti&&(Tc.DurationInMs=Ti);var Xg=null==Aa.e?null:Aa.e.toString();null!=Xg&&(Tc.NotAloneAtLogTime=Xg);var th=null==Aa.f?null:Cd.a.Asa(Aa.f.getTime());null!=th&&(Tc.Time=th);break;case 21:Ef="PresenceStartup";var ni=Aa.a;null!=ni&&(Tc.UserSessionId=ni);var oi=null==Aa.b?null:Aa.b.toString();null!=oi&&(Tc.EverReceived=oi);var pi=null==Aa.c?null:Aa.c.toString();null!=pi&&(Tc.NotAloneOnOpen=pi);var xf=null==Aa.d?null:Aa.d.toString();null!=xf&&(Tc.NotAloneAtLogTime=
xf);var qi=null==Aa.e?null:Aa.e.toString();null!=qi&&(Tc.EditorCount=qi);var Di=null==Aa.f?null:Aa.f.toString();null!=Di&&(Tc.WorkbookOpenToFirstReceivedInMs=Di);break;case 22:Ef="PresenceDelete";var mh=Aa.a;null!=mh&&(Tc.UserSessionId=mh);var Xh=Aa.b;null!=Xh&&(Tc.UserId=Xh);var Ui=Aa.c;null!=Ui&&(Tc.Context=Ui);var hg=Aa.d;null!=hg&&(Tc.Reason=hg);var Mh=null==Aa.e?null:Cd.a.Asa(Aa.e.getTime());null!=Mh&&(Tc.Time=Mh);break;case 23:Ef="EditorEvent";var rh=Aa.a;null!=rh&&(Tc.UserSessionId=rh);var Nh=
Aa.b;null!=Nh&&(Tc.UserId=Nh);var Yh=Aa.c;null!=Yh&&(Tc.Context=Yh);var ri=null==Aa.d?null:Cd.a.Asa(Aa.d.getTime());null!=ri&&(Tc.Time=ri);break;case 24:Ef="EditorTime";var Oh=Aa.a;null!=Oh&&(Tc.UserSessionId=Oh);var Ph=Aa.b;null!=Ph&&(Tc.UserId=Ph);var Q=null==Aa.c?null:Aa.c.toString();null!=Q&&(Tc.DurationInMs=Q);break;case 25:Ef="GridScreenReaderOps";var La=Aa.a;null!=La&&(Tc.UserSessionId=La);var kb=Aa.b;null!=kb&&(Tc.CommandTaskId=kb);var $b=null==Aa.c?null:Aa.c.toString();null!=$b&&(Tc.CommandId=
$b);var qc=null==Aa.d?null:Aa.d.toString();null!=qc&&(Tc.ClientSideOnly=qc);var Rc=null==Aa.e?null:Aa.e.toString();null!=Rc&&(Tc.DurationInMS=Rc);var Jc=null==Aa.f?null:Aa.f.toString();null!=Jc&&(Tc.ReachedMaxReadoutCells=Jc);var Hc=null==Aa.g?null:Aa.g.toString();null!=Hc&&(Tc.RequstedCellCount=Hc);var rc=null==Aa.h?null:Aa.h.toString();null!=rc&&(Tc.NonEmptyCellCount=rc);var Wc=null==Aa.i?null:Aa.i.toString();null!=Wc&&(Tc.Succeeded=Wc);var $c=null==Aa.j?null:Aa.j.toString();null!=$c&&(Tc.Canceled=
$c);var rd=Aa.k;null!=rd&&(Tc.ErrorType=rd);break;case 26:Ef="SendPresenceToService";var Pd=Aa.a;null!=Pd&&(Tc.UserSessionId=Pd);var ee=null==Aa.b?null:Aa.b.toString();null!=ee&&(Tc.TotalCount=ee);var ye=null==Aa.c?null:Aa.c.toString();null!=ye&&(Tc.SendCount=ye);break;case 27:Ef="IME";var Me=Aa.a;null!=Me&&(Tc.UserSessionId=Me);break;case 28:Ef="FreezePaneFloatingObjects";var cf=Aa.a;null!=cf&&(Tc.UserSessionId=cf);var Te=null==Aa.b?null:Aa.b.toString();null!=Te&&(Tc.ObjectType=Te);var Hf=Aa.c;null!=
Hf&&(Tc.ObjectID=Hf);var Ye=null==Aa.d?null:Aa.d.toString();null!=Ye&&(Tc.SpannedPanesCount=Ye);break;case 29:Ef="CustomizeStatusBar";var ig=Aa.a;null!=ig&&(Tc.UserSessionId=ig);var eg=Aa.b;null!=eg&&(Tc.UIControlName=eg);var Kf=null==Aa.c?null:Aa.c.toString();null!=Kf&&(Tc.IsControlVisible=Kf);break;case 30:Ef="ClientWebRequests";var zg=Aa.a;null!=zg&&(Tc.Path=zg);var Fg=Aa.b;null!=Fg&&(Tc.ProxyStopwatchId=Fg);var Yg=Aa.c;null!=Yg&&(Tc.RequestStatus=Yg);var nh=null==Aa.d?null:Aa.d.toString();null!=
nh&&(Tc.ResponseSizeInBytes=nh);var yf=Aa.e;null!=yf&&(Tc.ClientRequestId=yf);var kf=null==Aa.f?null:Aa.f.toString();null!=kf&&(Tc.StateId=kf);break;case 31:Ef="ShowCommentTaskPane";var hf=Aa.a;null!=hf&&(Tc.UserSessionId=hf);var Of=null==Aa.b?null:Aa.b.toString();null!=Of&&(Tc.IsFromKeyboardShortcut=Of);var jg=null==Aa.c?null:Aa.c.toString();null!=jg&&(Tc.IsShowPane=jg);var fg=null==Aa.d?null:Aa.d.toString();null!=fg&&(Tc.ShowForDeepLink=fg);var Yf=null==Aa.e?null:Aa.e.toString();null!=Yf&&(Tc.DeepLinkFound=
Yf);break;case 32:Ef="ApplyThreadedCommentChange";var Pf=Aa.a;null!=Pf&&(Tc.UserSessionId=Pf);var Zf=null==Aa.b?null:Aa.b.toString();null!=Zf&&(Tc.Operation=Zf);var Gf=Aa.c;null!=Gf&&(Tc.CommentId=Gf);var vg=null==Aa.d?null:Aa.d.toString();null!=vg&&(Tc.CommentsCount=vg);break;case 33:Ef="UpgradeLegacyCommentsChange";var bh=Aa.a;null!=bh&&(Tc.UserSessionId=bh);var Wf=null==Aa.b?null:Aa.b.toString();null!=Wf&&(Tc.OperationSuccessful=Wf);break;case 34:Ef="FindNextOrPreviousComment";var si=Aa.a;null!=
si&&(Tc.UserSessionId=si);var oh=null==Aa.b?null:Aa.b.toString();null!=oh&&(Tc.Succeeded=oh);break;case 35:Ef="Goto";var Ei=Aa.a;null!=Ei&&(Tc.UserSessionId=Ei);var Vi=null==Aa.b?null:Aa.b.toString();null!=Vi&&(Tc.IsSucceeded=Vi);var tg=null==Aa.c?null:Aa.c.toString();null!=tg&&(Tc.IsNOVMode=tg);break;case 36:Ef="LaunchOfficeAddInDialog";var ug=Aa.a;null!=ug&&(Tc.UserSessionId=ug);var Zg=Aa.b;null!=Zg&&(Tc.SourceId=Zg);var Xf=Aa.c;null!=Xf&&(Tc.SourceLabel=Xf);var Kg=Aa.d;null!=Kg&&(Tc.Flight=Kg);
var hh=Aa.e;null!=hh&&(Tc.Experiment=hh);var uh=Aa.f;null!=uh&&(Tc.UICultureTag=uh);var wh=null==Aa.g?null:Aa.g.toString();null!=wh&&(Tc.UICultureTagLcid=wh);var ti=null==Aa.h?null:Aa.h.toString();null!=ti&&(Tc.WacHostId=ti);break;case 37:Ef="RichApiInvocation";var bj=Aa.a;null!=bj&&(Tc.UserSessionId=bj);var cj=null==Aa.b?null:Aa.b.toString();null!=cj&&(Tc.Succeeded=cj);var ij=Aa.c;null!=ij&&(Tc.ErrorType=ij);var dj=Aa.d;null!=dj&&(Tc.ResultInfo=dj);var Zi=Aa.e;null!=Zi&&(Tc.Source=Zi);break;case 38:Ef=
"FxLibrary";var jj=Aa.a;null!=jj&&(Tc.EntityName=jj);var ej=null==Aa.b?null:Aa.b.toString();null!=ej&&(Tc.EntryPoint=ej);var fj=null==Aa.c?null:Aa.c.toString();null!=fj&&(Tc.Action=fj);var gj=null==Aa.d?null:Aa.d.toString();null!=gj&&(Tc.InsertLocation=gj);break;case 39:Ef="EmbeddedApiSession";var kj=Aa.a;null!=kj&&(Tc.UserSessionId=kj);break;case 40:Ef="NumberFormattingCalculator";var hj=Aa.a;null!=hj&&(Tc.Id=hj);var lj=Aa.b;null!=lj&&(Tc.CounterName=lj);var $i=Aa.c;null!=$i&&(Tc.Values=$i);break;
case 41:Ef="RequestDataAfterSend";var mj=Aa.a;null!=mj&&(Tc.ClientStopwatchId=mj);var nj=Aa.b;null!=nj&&(Tc.RequestStatus=nj);var oj=null==Aa.c?null:Aa.c.toString();null!=oj&&(Tc.SendDuration=oj);var pj=null==Aa.d?null:Aa.d.toString();null!=pj&&(Tc.RequestId=pj);break;case 42:Ef="FloatingObjectsStopwatchData";var qj=Aa.a;null!=qj&&(Tc.StopMessage=qj);var rj=null==Aa.b?null:Aa.b.toString();null!=rj&&(Tc.Type=rj);var sj=Aa.c;null!=sj&&(Tc.GUID=sj);var tf=null==Aa.d?null:Aa.d.toString();null!=tf&&(Tc.Pane=
tf);var aj=null==Aa.e?null:Aa.e.toString();null!=aj&&(Tc.IsAboveGrid=aj);var N=Aa.f;null!=N&&(Tc.StartCorrelation=N);var Ka=Aa.g;null!=Ka&&(Tc.LoadImageCorrelation=Ka);var Cb=null==Aa.h?null:Aa.h.toString();null!=Cb&&(Tc.SkippedGetEffectsExtents=Cb);var jc=null==Aa.i?null:Aa.i.toString();null!=jc&&(Tc.Version=jc);break;case 43:Ef="Copy";var Kc=Aa.a;null!=Kc&&(Tc.UserSessionId=Kc);var kd=Aa.b;null!=kd&&(Tc.Trigger=kd);var qd=Aa.c;null!=qd&&(Tc.RibbonCommandName=qd);var yd=Aa.d;null!=yd&&(Tc.SourceItem=
yd);var Jd=null==Aa.e?null:Aa.e.toString();null!=Jd&&(Tc.SourceRangeCellCount=Jd);var Vd=Aa.f;null!=Vd&&(Tc.ClientSideStopwatchId=Vd);var Oe=Aa.g;null!=Oe&&(Tc.CopyOperationId=Oe);var Qe=null==Aa.h?null:Aa.h.toString();null!=Qe&&(Tc.IsAsync=Qe);var lf=null==Aa.i?null:Aa.i.toString();null!=lf&&(Tc.IsFromCache=lf);var qg=null==Aa.j?null:Aa.j.toString();null!=qg&&(Tc.IsSuccessiveCopy=qg);var ag=null==Aa.k?null:Aa.k.toString();null!=ag&&(Tc.IsSelectionAllowed=ag);var bg=null==Aa.l?null:Aa.l.toString();
null!=bg&&(Tc.IsSuccess=bg);var Rf=null==Aa.m?null:Aa.m.toString();null!=Rf&&(Tc.IsExpectedError=Rf);var rg=Aa.n;null!=rg&&(Tc.ExpectedErrorReason=rg);var Ng=Aa.o;null!=Ng&&(Tc.ErrorMessage=Ng);var Lg=null==Aa.p?null:Aa.p.toString();null!=Lg&&(Tc.ClientSideCopyTimeInMs=Lg);var Og=null==Aa.q?null:Aa.q.toString();null!=Og&&(Tc.TotalTimeInMs=Og);var Dh=null==Aa.r?null:Aa.r.toString();null!=Dh&&(Tc.PlainTextPayloadSize=Dh);var Zh=Aa.s;null!=Zh&&(Tc.CopyPasteTargetType=Zh);var gk=null==Aa.t?null:Aa.t.toString();
null!=gk&&(Tc.ShadowWorkbookPayloadSize=gk);var hk=null==Aa.u?null:Aa.u.toString();null!=hk&&(Tc.HtmlPayloadSize=hk);var ik=null==Aa.v?null:Aa.v.toString();null!=ik&&(Tc.HtmlSizeExceedsLimit=ik);var jk=null==Aa.w?null:Aa.w.toString();null!=jk&&(Tc.CopyTotalSizeExceedsLimit=jk);var kk=null==Aa.x?null:Aa.x.toString();null!=kk&&(Tc.ErrorReason=kk);var lk=Aa.y;null!=lk&&(Tc.ErrorName=lk);var mk=null==Aa.z?null:Aa.z.toString();null!=mk&&(Tc.IsSucceededWithAlert=mk);var nk=null==Aa.ba?null:Aa.ba.toString();
null!=nk&&(Tc.EncounteredDeploymentErrors=nk);var ok=null==Aa.bb?null:Aa.bb.toString();null!=ok&&(Tc.ShadowWorkbookSizeExceedsLimit=ok);var pk=Aa.bc;null!=pk&&(Tc.CopyPasteTargetName=pk);var qk=Aa.bd;null!=qk&&(Tc.CCPSliceName=qk);var rk=Aa.be;null!=rk&&(Tc.SyncClipboardItemsKeys=rk);var sk=Aa.bf;null!=sk&&(Tc.AsyncClipboardItemsKeys=sk);var tk=Aa.bg;null!=tk&&(Tc.CopyPasteHandlerName=tk);var uk=Aa.bh;null!=uk&&(Tc.SucceededPopulatingSystemClipboardSync=uk);var vk=Aa.bi;null!=vk&&(Tc.SucceededPopulatingSystemClipboardAsync=
vk);var wk=Aa.bj;null!=wk&&(Tc.Location=wk);var xk=Aa.bk;null!=xk&&(Tc.CopyContextId=xk);var yk=null==Aa.bl?null:Aa.bl.toString();null!=yk&&(Tc.ServerRequestTimeInMs=yk);var zk=null==Aa.bm?null:Aa.bm.toString();null!=zk&&(Tc.EcsOperationDuration=zk);var Ak=null==Aa.bn?null:Aa.bn.toString();null!=Ak&&(Tc.EcsRequestDuration=Ak);var Bk=null==Aa.bo?null:Aa.bo.toString();null!=Bk&&(Tc.WfeRequestDuration=Bk);var Ck=null==Aa.bp?null:Aa.bp.toString();null!=Ck&&(Tc.OriginalSourceRangesCountExceedsLimit=Ck);
var Dk=null==Aa.bq?null:Aa.bq.toString();null!=Dk&&(Tc.UploadToClipServiceAttempted=Dk);var Ek=null==Aa.br?null:Aa.br.toString();null!=Ek&&(Tc.FloatingObjectType=Ek);break;case 44:Ef="Paste";var Fk=Aa.a;null!=Fk&&(Tc.UserSessionId=Fk);var Gk=Aa.b;null!=Gk&&(Tc.Trigger=Gk);var Hk=Aa.c;null!=Hk&&(Tc.RibbonCommandName=Hk);var Ik=null==Aa.d?null:Aa.d.toString();null!=Ik&&(Tc.PasteTypeFlagValue=Ik);var Jk=Aa.e;null!=Jk&&(Tc.PasteOperationId=Jk);var Kk=Aa.f;null!=Kk&&(Tc.CopyOperationId=Kk);var Lk=Aa.g;
null!=Lk&&(Tc.ClientSideStopwatchId=Lk);var Mk=Aa.h;null!=Mk&&(Tc.OriginalDestinationRange=Mk);var Nk=Aa.i;null!=Nk&&(Tc.ExpandDestinationRange=Nk);var Ok=Aa.j;null!=Ok&&(Tc.SourceItem=Ok);var Pk=null==Aa.k?null:Aa.k.toString();null!=Pk&&(Tc.SourceRangeCellCount=Pk);var Qk=null==Aa.l?null:Aa.l.toString();null!=Qk&&(Tc.IsSuccess=Qk);var Rk=null==Aa.m?null:Aa.m.toString();null!=Rk&&(Tc.IsExpectedError=Rk);var Sk=Aa.n;null!=Sk&&(Tc.ClipboardFormatReadTimeInMs=Sk);var Tk=Aa.o;null!=Tk&&(Tc.ClipboardFormatReadStatus=
Tk);var Uk=null==Aa.p?null:Aa.p.toString();null!=Uk&&(Tc.ClipboardReadPermissionPromptShown=Uk);var Vk=null==Aa.q?null:Aa.q.toString();null!=Vk&&(Tc.AsyncApiReadTimedOut=Vk);var Wk=Aa.r;null!=Wk&&(Tc.ExpectedErrorReason=Wk);var Xk=Aa.s;null!=Xk&&(Tc.ErrorMessage=Xk);var Yk=null==Aa.t?null:Aa.t.toString();null!=Yk&&(Tc.TotalTimeInMs=Yk);var Zk=null==Aa.u?null:Aa.u.toString();null!=Zk&&(Tc.PlainTextPayloadSize=Zk);var $k=null==Aa.v?null:Aa.v.toString();null!=$k&&(Tc.ShadowWorkbookPayloadSize=$k);var al=
null==Aa.w?null:Aa.w.toString();null!=al&&(Tc.HtmlPayloadSize=al);var bl=Aa.x;null!=bl&&(Tc.CopyPasteTargetType=bl);var cl=null==Aa.y?null:Aa.y.toString();null!=cl&&(Tc.IsLastCopyWasExternal=cl);var dl=null==Aa.z?null:Aa.z.toString();null!=dl&&(Tc.IsClipboardDataContainShadowWorkbook=dl);var el=null==Aa.ba?null:Aa.ba.toString();null!=el&&(Tc.IsShadowWorkbookParsedSuccessfully=el);var fl=Aa.bb;null!=fl&&(Tc.ActiveSelectionType=fl);var gl=Aa.bc;null!=gl&&(Tc.PasteResult=gl);var hl=null==Aa.bd?null:
Aa.bd.toString();null!=hl&&(Tc.ErrorReason=hl);var il=Aa.be;null!=il&&(Tc.ErrorName=il);var jl=null==Aa.bf?null:Aa.bf.toString();null!=jl&&(Tc.IsSucceededWithAlert=jl);var kl=null==Aa.bg?null:Aa.bg.toString();null!=kl&&(Tc.IsAfterCut=kl);var Pj=null==Aa.bh?null:Aa.bh.toString();null!=Pj&&(Tc.EncounteredDeploymentErrors=Pj);var ll=null==Aa.bi?null:Aa.bi.toString();null!=ll&&(Tc.IsCrossSession=ll);var ml=null==Aa.bj?null:Aa.bj.toString();null!=ml&&(Tc.ShadowWorkbookSizeExceedsLimit=ml);var nl=null==
Aa.bk?null:Aa.bk.toString();null!=nl&&(Tc.ClipboardContainXLOPayload=nl);var ol=Aa.bl;null!=ol&&(Tc.CopyPasteTargetName=ol);var pl=Aa.bm;null!=pl&&(Tc.ChromeExtensionId=pl);var ql=Aa.bn;null!=ql&&(Tc.PayloadOrigin=ql);var rl=Aa.bo;null!=rl&&(Tc.PayloadType=rl);var sl=Aa.bp;null!=sl&&(Tc.CCPSliceName=sl);var tl=Aa.bq;null!=tl&&(Tc.ClipboardItemsKeys=tl);var ul=Aa.br;null!=ul&&(Tc.CopyPasteHandlerName=ul);var vl=null==Aa.bs?null:Aa.bs.toString();null!=vl&&(Tc.IsSourceItemOriginSameSession=vl);var mm=
Aa.bt;null!=mm&&(Tc.Location=mm);var tj=Aa.bu;null!=tj&&(Tc.ExternalAppSource=tj);var uj=Aa.bv;null!=uj&&(Tc.PasteContextId=uj);var vj=null==Aa.bw?null:Aa.bw.toString();null!=vj&&(Tc.ServerRequestTimeInMs=vj);var wj=null==Aa.bx?null:Aa.bx.toString();null!=wj&&(Tc.IndicationDisplayScheduled=wj);var xj=Aa.by;null!=xj&&(Tc.PasteIndicationDisplayStatus=xj);var yj=null==Aa.bz?null:Aa.bz.toString();null!=yj&&(Tc.PasteRecoveryUIDisplayed=yj);var zj=null==Aa.ca?null:Aa.ca.toString();null!=zj&&(Tc.IsFromPasteRecoveryUI=
zj);var wl=null==Aa.cb?null:Aa.cb.toString();null!=wl&&(Tc.EcsOperationDuration=wl);var xl=null==Aa.cc?null:Aa.cc.toString();null!=xl&&(Tc.EcsRequestDuration=xl);var Qj=null==Aa.cd?null:Aa.cd.toString();null!=Qj&&(Tc.WfeRequestDuration=Qj);var Rj=null==Aa.ce?null:Aa.ce.toString();null!=Rj&&(Tc.OriginalSourceRangesCountExceedsLimit=Rj);var Sj=Aa.cf;null!=Sj&&(Tc.PasteRecoveryUndoStopwatchId=Sj);var Tj=null==Aa.cg?null:Aa.cg.toString();null!=Tj&&(Tc.PasteRecoveryUndoTimeInMs=Tj);var yl=null==Aa.ch?
null:Aa.ch.toString();null!=yl&&(Tc.PasteCSEPerformed=yl);var Aj=null==Aa.ci?null:Aa.ci.toString();null!=Aj&&(Tc.CSEStatus=Aj);var Bj=null==Aa.cj?null:Aa.cj.toString();null!=Bj&&(Tc.IsFromEnterShortcut=Bj);var Cj=null==Aa.ck?null:Aa.ck.toString();null!=Cj&&(Tc.pasteDestinationHasMergedCells=Cj);break;case 45:Ef="DragDrop";var Dj=Aa.a;null!=Dj&&(Tc.UserSessionId=Dj);var Ej=Aa.b;null!=Ej&&(Tc.Trigger=Ej);var Fj=Aa.c;null!=Fj&&(Tc.RibbonCommandName=Fj);var Gj=Aa.d;null!=Gj&&(Tc.OperationId=Gj);var Hj=
Aa.e;null!=Hj&&(Tc.ClientSideStopwatchId=Hj);var Ij=Aa.f;null!=Ij&&(Tc.SourceRange=Ij);var Jj=Aa.g;null!=Jj&&(Tc.DestinationRange=Jj);var Kj=Aa.h;null!=Kj&&(Tc.CutCopyType=Kj);var Lj=null==Aa.i?null:Aa.i.toString();null!=Lj&&(Tc.IsShiftKeyDown=Lj);var Mj=null==Aa.j?null:Aa.j.toString();null!=Mj&&(Tc.IsDragInsert=Mj);var Nj=null==Aa.k?null:Aa.k.toString();null!=Nj&&(Tc.IsSuccess=Nj);var Oj=null==Aa.l?null:Aa.l.toString();null!=Oj&&(Tc.IsExpectedError=Oj);var zl=Aa.m;null!=zl&&(Tc.ExpectedErrorReason=
zl);var Al=Aa.n;null!=Al&&(Tc.ErrorMessage=Al);var Bl=null==Aa.o?null:Aa.o.toString();null!=Bl&&(Tc.TotalTimeInMs=Bl);var Cl=Aa.p;null!=Cl&&(Tc.ErrorName=Cl);var Dl=null==Aa.q?null:Aa.q.toString();null!=Dl&&(Tc.IsSucceededWithAlert=Dl);var El=Aa.r;null!=El&&(Tc.CopyPasteTargetType=El);var Fl=null==Aa.s?null:Aa.s.toString();null!=Fl&&(Tc.EncounteredDeploymentErrors=Fl);break;case 46:Ef="ClearCopyState";var Gl=Aa.a;null!=Gl&&(Tc.UserSessionId=Gl);var Hl=Aa.b;null!=Hl&&(Tc.ClientSideStopwatchId=Hl);
var Il=Aa.c;null!=Il&&(Tc.Trigger=Il);var Jl=null==Aa.d?null:Aa.d.toString();null!=Jl&&(Tc.IsClearClipboard=Jl);var Kl=null==Aa.e?null:Aa.e.toString();null!=Kl&&(Tc.IsExplicit=Kl);var Ll=null==Aa.f?null:Aa.f.toString();null!=Ll&&(Tc.IsSuccess=Ll);var Ml=Aa.g;null!=Ml&&(Tc.ErrorMessage=Ml);var Nl=Aa.h;null!=Nl&&(Tc.ErrorName=Nl);var Ol=null==Aa.i?null:Aa.i.toString();null!=Ol&&(Tc.TotalTimeInMs=Ol);var Pl=Aa.j;null!=Pl&&(Tc.CopyPasteTargetType=Pl);break;case 47:Ef="WebWorkerRecalcStats";var Ql=null==
Aa.a?null:Aa.a.toString();null!=Ql&&(Tc.SuccessCount=Ql);var Rl=null==Aa.b?null:Aa.b.toString();null!=Rl&&(Tc.FailureCount=Rl);var Sl=null==Aa.c?null:Aa.c.toString();null!=Sl&&(Tc.ValueTypeMismatchCount=Sl);var Tl=null==Aa.d?null:Aa.d.toString();null!=Tl&&(Tc.CellValueMismatchCount=Tl);var Ul=null==Aa.e?null:Aa.e.toString();null!=Ul&&(Tc.IfmtMismatchCount=Ul);var Vl=null==Aa.f?null:Aa.f.toString();null!=Vl&&(Tc.FormattedTextMismatchCount=Vl);var Wl=null==Aa.g?null:Aa.g.toString();null!=Wl&&(Tc.CellValueStringMismatchCount=
Wl);var Xl=null==Aa.h?null:Aa.h.toString();null!=Xl&&(Tc.CellValueNumberMismatchCount=Xl);var Yl=null==Aa.i?null:Aa.i.toString();null!=Yl&&(Tc.CellValueBooleanMismatchCount=Yl);var Zl=null==Aa.j?null:Aa.j.toString();null!=Zl&&(Tc.CellValueBlankMismatchCount=Zl);var $l=null==Aa.k?null:Aa.k.toString();null!=$l&&(Tc.CellValueErrorMismatchCount=$l);var am=null==Aa.l?null:Aa.l.toString();null!=am&&(Tc.FormattedTextStringMismatchCount=am);var bm=null==Aa.m?null:Aa.m.toString();null!=bm&&(Tc.FormattedTextNumberMismatchCount=
bm);var cm=null==Aa.n?null:Aa.n.toString();null!=cm&&(Tc.FormattedTextBooleanMismatchCount=cm);var dm=null==Aa.o?null:Aa.o.toString();null!=dm&&(Tc.FormattedTextBlankMismatchCount=dm);var em=null==Aa.p?null:Aa.p.toString();null!=em&&(Tc.FormattedTextErrorMismatchCount=em);var fm=null==Aa.q?null:Aa.q.toString();null!=fm&&(Tc.StringMismatchCount=fm);var gm=null==Aa.r?null:Aa.r.toString();null!=gm&&(Tc.NumericMismatchCount=gm);var hm=null==Aa.s?null:Aa.s.toString();null!=hm&&(Tc.ErrorMismatchCount=hm);
var im=null==Aa.t?null:Aa.t.toString();null!=im&&(Tc.StringValuesCount=im);var jm=null==Aa.u?null:Aa.u.toString();null!=jm&&(Tc.NumericValuesCount=jm);var km=null==Aa.v?null:Aa.v.toString();null!=km&&(Tc.BooleanValuesCount=km);var lm=null==Aa.w?null:Aa.w.toString();null!=lm&&(Tc.BlankValuesCount=lm);var Uj=null==Aa.x?null:Aa.x.toString();null!=Uj&&(Tc.ErrorValuesCount=Uj);var Vj=null==Aa.y?null:Aa.y.toString();null!=Vj&&(Tc.NumericValuesDiffAverage=Vj);var Wj=Aa.z;null!=Wj&&(Tc.NumericEvaluatedValuesMismatchSamples=
Wj);var Xj=Aa.ba;null!=Xj&&(Tc.NumericFormattedTextMismatchSamples=Xj);var Yj=Aa.bb;null!=Yj&&(Tc.NumericMismatchSamples=Yj);var Zj=Aa.bc;null!=Zj&&(Tc.CellValueTypeMismatchSamples=Zj);var nm=Aa.bd;null!=nm&&(Tc.IfmtMismatchSamples=nm);var ak=Aa.be;null!=ak&&(Tc.BlockHashCode=ak);break;case 48:Ef="DataValidationEditOpenDialog";var bk=Aa.a;null!=bk&&(Tc.ServerCommand=bk);var ck=null==Aa.b?null:Aa.b.toString();null!=ck&&(Tc.SubDialogOpened=ck);var dk=Aa.c;null!=dk&&(Tc.SubDialogButtonClicked=dk);var ek=
null==Aa.d?null:Aa.d.toString();null!=ek&&(Tc.DialogOpened=ek);var fk=Aa.e;null!=fk&&(Tc.RuleType=fk);var tm=Aa.f;null!=tm&&(Tc.ConditionType=tm);var um=null==Aa.g?null:Aa.g.toString();null!=um&&(Tc.LowerBoundaryFilled=um);var vm=null==Aa.h?null:Aa.h.toString();null!=vm&&(Tc.UpperBoundaryFilled=vm);var wm=null==Aa.i?null:Aa.i.toString();null!=wm&&(Tc.IgnoreBlank=wm);var xm=null==Aa.j?null:Aa.j.toString();null!=xm&&(Tc.InCellDropdown=xm);var ym=null==Aa.k?null:Aa.k.toString();null!=ym&&(Tc.ShowInputMessage=
ym);var zm=null==Aa.l?null:Aa.l.toString();null!=zm&&(Tc.InputTitleFilled=zm);var Am=null==Aa.m?null:Aa.m.toString();null!=Am&&(Tc.InputMessageFilled=Am);var Bm=null==Aa.n?null:Aa.n.toString();null!=Bm&&(Tc.ShowErrorAlert=Bm);var Cm=null==Aa.o?null:Aa.o.toString();null!=Cm&&(Tc.AlertBlocking=Cm);var Dm=null==Aa.p?null:Aa.p.toString();null!=Dm&&(Tc.AlertTitleFilled=Dm);var Em=null==Aa.q?null:Aa.q.toString();null!=Em&&(Tc.AlertMessageFilled=Em);var Fm=Aa.r;null!=Fm&&(Tc.StopWatchId=Fm);break;case 49:Ef=
"DataValidationEditSubmitRule";var Gm=Aa.a;null!=Gm&&(Tc.RuleType=Gm);var Hm=Aa.b;null!=Hm&&(Tc.ConditionType=Hm);var Im=null==Aa.c?null:Aa.c.toString();null!=Im&&(Tc.LowerBoundaryFilled=Im);var Jm=null==Aa.d?null:Aa.d.toString();null!=Jm&&(Tc.UpperBoundaryFilled=Jm);var Km=null==Aa.e?null:Aa.e.toString();null!=Km&&(Tc.IgnoreBlank=Km);var Lm=null==Aa.f?null:Aa.f.toString();null!=Lm&&(Tc.InCellDropdown=Lm);var Mm=null==Aa.g?null:Aa.g.toString();null!=Mm&&(Tc.ShowInputMessage=Mm);var Nm=null==Aa.h?
null:Aa.h.toString();null!=Nm&&(Tc.InputTitleFilled=Nm);var Om=null==Aa.i?null:Aa.i.toString();null!=Om&&(Tc.InputMessageFilled=Om);var Pm=null==Aa.j?null:Aa.j.toString();null!=Pm&&(Tc.ShowErrorAlert=Pm);var Qm=null==Aa.k?null:Aa.k.toString();null!=Qm&&(Tc.AlertBlocking=Qm);var Rm=null==Aa.l?null:Aa.l.toString();null!=Rm&&(Tc.AlertTitleFilled=Rm);var Sm=null==Aa.m?null:Aa.m.toString();null!=Sm&&(Tc.AlertMessageFilled=Sm);var Tm=null==Aa.n?null:Aa.n.toString();null!=Tm&&(Tc.ClearAllPressed=Tm);var Um=
Aa.o;null!=Um&&(Tc.ActionStatus=Um);var Vm=Aa.p;null!=Vm&&(Tc.Error=Vm);var Wm=Aa.q;null!=Wm&&(Tc.StopWatchId=Wm);break;case 50:Ef="CustomSort";var Xm=Aa.a;null!=Xm&&(Tc.RangeType=Xm);var Ym=null==Aa.b?null:Aa.b.toString();null!=Ym&&(Tc.HasHeaders=Ym);var Zm=null==Aa.c?null:Aa.c.toString();null!=Zm&&(Tc.SortTopToBottom=Zm);var $m=null==Aa.d?null:Aa.d.toString();null!=$m&&(Tc.ColumnCount=$m);var an=null==Aa.e?null:Aa.e.toString();null!=an&&(Tc.RowCount=an);var bn=null==Aa.f?null:Aa.f.toString();null!=
bn&&(Tc.RangeLimitExceeded=bn);var cn=null==Aa.g?null:Aa.g.toString();null!=cn&&(Tc.CaseSensitive=cn);var dn=null==Aa.h?null:Aa.h.toString();null!=dn&&(Tc.GetSortInfoDuration=dn);var en=null==Aa.i?null:Aa.i.toString();null!=en&&(Tc.LevelCount=en);var fn=null==Aa.j?null:Aa.j.toString();null!=fn&&(Tc.SortOnValuesCount=fn);var gn=null==Aa.k?null:Aa.k.toString();null!=gn&&(Tc.SortOnCellColorCount=gn);var hn=null==Aa.l?null:Aa.l.toString();null!=hn&&(Tc.SortOnFontColorCount=hn);var jn=null==Aa.m?null:
Aa.m.toString();null!=jn&&(Tc.SortOnIconCount=jn);var kn=null==Aa.n?null:Aa.n.toString();null!=kn&&(Tc.CustomOrderCount=kn);var ln=null==Aa.o?null:Aa.o.toString();null!=ln&&(Tc.AvgCellColorCount=ln);var mn=null==Aa.p?null:Aa.p.toString();null!=mn&&(Tc.MaxCellColorCount=mn);var nn=null==Aa.q?null:Aa.q.toString();null!=nn&&(Tc.AvgFontColorCount=nn);var on=null==Aa.r?null:Aa.r.toString();null!=on&&(Tc.MaxFontColorCount=on);var pn=null==Aa.s?null:Aa.s.toString();null!=pn&&(Tc.AvgIconsCount=pn);var qn=
null==Aa.t?null:Aa.t.toString();null!=qn&&(Tc.MaxIconsCount=qn);var rn=null==Aa.u?null:Aa.u.toString();null!=rn&&(Tc.Executed=rn);break;case 51:Ef="NamedSheetViewUserAction";var sn=Aa.a;null!=sn&&(Tc.UserSessionId=sn);var tn=Aa.b;null!=tn&&(Tc.UserActionName=tn);var un=null==Aa.c?null:Aa.c.toString();null!=un&&(Tc.UserActionSource=un);var vn=Aa.d;null!=vn&&(Tc.UserActionData=vn);var wn=Aa.e;null!=wn&&(Tc.OtherData=wn);break;case 52:Ef="NamedSheetViewTeachingCallout";var xn=Aa.a;null!=xn&&(Tc.UserSessionId=
xn);var yn=null==Aa.b?null:Aa.b.toString();null!=yn&&(Tc.TeachingCalloutSequence=yn);var zn=null==Aa.c?null:Aa.c.toString();null!=zn&&(Tc.TeachingCalloutIndex=zn);var An=null==Aa.d?null:Aa.d.toString();null!=An&&(Tc.UserActionName=An);var Bn=Aa.e;null!=Bn&&(Tc.UserActionData=Bn);var Cn=null==Aa.f?null:Aa.f.toString();null!=Cn&&(Tc.DurationInMs=Cn);break;case 53:Ef="NamedSheetViewTeachingDialog";var Dn=Aa.a;null!=Dn&&(Tc.UserSessionId=Dn);var En=Aa.b;null!=En&&(Tc.UserActionName=En);var Fn=Aa.c;null!=
Fn&&(Tc.ButtonClicked=Fn);var Gn=null==Aa.d?null:Aa.d.toString();null!=Gn&&(Tc.DurationInMs=Gn);var Hn=null==Aa.e?null:Aa.e.toString();null!=Hn&&(Tc.IsNewTeachingDialog=Hn);break;case 54:Ef="NamedSheetViewOptionsDialog";var In=Aa.a;null!=In&&(Tc.UserSessionId=In);var Jn=null==Aa.b?null:Aa.b.toString();null!=Jn&&(Tc.OptionsAction=Jn);var Kn=Aa.c;null!=Kn&&(Tc.OptionsActionData=Kn);var Ln=Aa.d;null!=Ln&&(Tc.OptionsOtherData=Ln);var Mn=null==Aa.e?null:Aa.e.toString();null!=Mn&&(Tc.DurationInMs=Mn);break;
case 55:Ef="NamedSheetViewTempViewApplyDialog";var Nn=Aa.a;null!=Nn&&(Tc.UserSessionId=Nn);var On=Aa.b;null!=On&&(Tc.TriggeredFrom=On);var Pn=Aa.c;null!=Pn&&(Tc.ButtonClicked=Pn);var Qn=null==Aa.d?null:Aa.d.toString();null!=Qn&&(Tc.DurationInMs=Qn);break;case 56:Ef="NamedSheetViewTempViewSaveDialog";var Rn=Aa.a;null!=Rn&&(Tc.UserSessionId=Rn);var Sn=Aa.b;null!=Sn&&(Tc.TriggeredFrom=Sn);var Tn=Aa.c;null!=Tn&&(Tc.ButtonClicked=Tn);var Un=null==Aa.d?null:Aa.d.toString();null!=Un&&(Tc.NameUpdated=Un);
var Vn=null==Aa.e?null:Aa.e.toString();null!=Vn&&(Tc.DurationInMs=Vn);break;case 57:Ef="TemporaryViewStartedDataRestore";var Wn=Aa.a;null!=Wn&&(Tc.UserSessionId=Wn);var Xn=null==Aa.b?null:Aa.b.toString();null!=Xn&&(Tc.CountOfTempViews=Xn);break;case 58:Ef="TemporaryViewFetchedVersion";var Yn=Aa.a;null!=Yn&&(Tc.UserSessionId=Yn);var Zn=null==Aa.b?null:Aa.b.toString();null!=Zn&&(Tc.NumberOfBytes=Zn);break;case 59:Ef="RaiseEventsAndGenerateBlockRequests";var $n=null==Aa.a?null:Aa.a.toString();null!=
$n&&(Tc.ReturnContentStatus=$n);var ao=null==Aa.b?null:Aa.b.toString();null!=ao&&(Tc.CacheState=ao);var bo=null==Aa.c?null:Aa.c.toString();null!=bo&&(Tc.FromXhrCallback=bo);var co=null==Aa.d?null:Aa.d.toString();null!=co&&(Tc.AreGeneralErrorsPresent=co);var eo=Aa.e;null!=eo&&(Tc.BlockCacheItemHash=eo);var fo=Aa.f;null!=fo&&(Tc.StopwatchId=fo);var go=Aa.g;null!=go&&(Tc.BlockCacheItemProcessingStopwatchId=go);var ho=null==Aa.h?null:Aa.h.toString();null!=ho&&(Tc.StateId=ho);var io=null==Aa.i?null:Aa.i.toString();
null!=io&&(Tc.IsHighPriority=io);var jo=null==Aa.j?null:Aa.j.toString();null!=jo&&(Tc.CalcComplete=jo);var ko=null==Aa.k?null:Aa.k.toString();null!=ko&&(Tc.EditedCellsUpdatedByCse=ko);var lo=null==Aa.l?null:Aa.l.toString();null!=lo&&(Tc.DependentCellsUpdatedByCse=lo);var mo=null==Aa.m?null:Aa.m.toString();null!=mo&&(Tc.Revision=mo);var no=null==Aa.n?null:Aa.n.toString();null!=no&&(Tc.SheetProcessedDataVersion=no);var oo=null==Aa.o?null:Aa.o.toString();null!=oo&&(Tc.RefCount=oo);var po=null==Aa.p?
null:Aa.p.toString();null!=po&&(Tc.ExistsInView=po);var qo=null==Aa.q?null:Aa.q.toString();null!=qo&&(Tc.ContentSource=qo);break;case 60:Ef="LaunchMakerCodeEditor";var ro=Aa.a;null!=ro&&(Tc.SessionId=ro);var so=Aa.b;null!=so&&(Tc.Command=so);var to=null==Aa.c?null:Aa.c.toString();null!=to&&(Tc.IsPreviewGallery=to);var uo=Aa.d;null!=uo&&(Tc.MenuItemId=uo);var vo=Aa.e;null!=vo&&(Tc.ScriptId=vo);var wo=Aa.f;null!=wo&&(Tc.ShareId=wo);var xo=null==Aa.g?null:Aa.g.toString();null!=xo&&(Tc.IsOwner=xo);var yo=
null==Aa.h?null:Aa.h.toString();null!=yo&&(Tc.PublishedScriptCount=yo);var zo=null==Aa.i?null:Aa.i.toString();null!=zo&&(Tc.RecentScriptCount=zo);var Ao=null==Aa.j?null:Aa.j.toString();null!=Ao&&(Tc.WorkbookScriptCount=Ao)}Tc.Table=Ef;var Fo=Sys.Serialization.JavaScriptSerializer.serialize(Tc);de.call(zd,3704927,0,50,Fo)}}catch(Tc){d.ULS.sendTraceTag(3704928,0,10,`Error when serializing usage table: ${za} exception: ${Tc}`)}}a7c(za,Aa,xc){if(this.xoc){const zd=this.oWa[za+Aa];zd&&(zd.e=xc,this.k$c(zd));
delete this.oWa[za+Aa]}}Osd(za,Aa){Gd[za]in this.nmf||this.Le(za,Aa)}cXi(){this.Lh.appStart&&this.l5f(ie.LBd,this.Lh.appStart)}Avi(za){const Aa={};Aa.a=za.i;Aa.b=za.o;Aa.c=za.t;Aa.d=rf.a(za.s,za.p||this.Lh.appStart);Aa.e=rf.a(za.e,za.s);Aa.f=za.c;Aa.g=za.a;Aa.h=za.h;this.Le(0,Aa,this.lji(Aa.b,Aa.c))}lji(za,Aa){return["CommandTask","QueuedTask","Task"].includes(za)&&!this.cwh.includes(Aa)?!1:!0}DA(za,Aa,xc,zd,de=!0){if(za&&Aa){const pe={};pe.a=za;pe.b=Aa;pe.c=xc.toString();pe.d=zd.toString();this.Le(15,
pe,de)}}Ylf(za,Aa,xc,zd){const de={};za&&(de.c=rf.a(za,this.Lh.appStart));de.b=Aa;de.a=xc;de.d=zd;this.Le(17,de)}dispose(){this.dQa.execute(za=>{za.deactivate(!0);za.vaj(this.QAf)});this.Me&&this.Me.Oab(this.t5);super.dispose()}U2e(){return this.Nfg=this.Nfg||new ec}UDe(za,Aa,xc=null,zd=null,de=null){const pe={};pe.o=za;pe.t=Aa;pe.p=de;pe.s=zd||this.Lh.je;this.wkd(pe,xc);return pe}Tze(za,Aa=null){za&&(za.e=Aa||this.Lh.je,za.i=za.i||this.a0a.e8a(),za.c=za.c||this.zEe,za.a=za.a||this.GEe,za.h=void 0!==
za.h&&null!==za.h?za.h:this.Me?this.Me.Ii:!1,this.k$c(za))}fmf(za){const Aa=za.context;za.duration>ie.Ohh&&(Aa.methodName===Rb.a.yac||Aa.methodName===Rb.a.O3a)&&this.msc(1,ie.hUh);if("GetSessionStatus"!==Aa.methodName){const xc={};xc.a=Aa.methodName;xc.b=Aa.stopwatch.id;xc.c=za.xsc;xc.d=za.responseSize;xc.e=Aa.w1b;xc.f=za.dd?za.dd.StateId:Rb.a.IWd;this.Le(30,xc,!0);this.DA(xc.b,za.dd.ServerCorrelationId,"clientWebRequests","ServerActions")}}f6f(){if(this.xoc){const za=this.oWa.LoadingUIShownSplashScreen;
za&&tc.PageLoadTrackingInfo.instance.Nqj(za.s)}}msc(za,Aa){this.Ceg.iIb(za,Aa,null)}xRf(za,Aa=null){this.uBc.aej(za,Aa)}wRf(za,Aa,xc=null){this.uBc.$dj(za,Aa,xc)}yRf(za){this.uBc.HJd(za,null)}zRf(za,Aa){this.uBc.iIb(za,Aa,null)}hsc(za,Aa,xc=null){this.dfb.hsc(za,Aa,xc)}psc(za,Aa,xc=null){this.dfb.psc(za,Aa,xc)}sendDNMTraceTag(za,Aa,xc,zd,...de){sb.EwaSettings.ma(218)&&d.ULS.sendTraceTag.apply(null,[za,Aa,xc,zd].concat(de))}HJb(za,Aa,xc,zd,de,pe,$e,...Df){this.dfb.HJb(za,Aa,xc,zd,de,pe,$e,...Df)}JJb(za,
Aa,xc,zd,de,pe){this.dfb.JJb(za,Aa,xc,zd,de,pe)}IJb(za,Aa,xc,zd,de,pe,...$e){this.dfb.IJb(za,Aa,xc,zd,de,pe,...$e)}KJb(za,Aa,xc,zd,de,pe){this.Ceg.KJb(za,Aa,xc,zd,de,pe)}nuc(za,Aa,xc,zd){this.dfb.nuc(za,Aa,xc,zd)}k$c(za){this.nFj.Avi(za)}dXi(){if(this.xoc){Stw.swpc=null;const za=this.xoc;for(let Aa in za)this.wkd(za[Aa])}}mzh(){const za=window[fe.a.namespace];if(za){const Aa=za[fe.a.aze];Aa&&(delete za[fe.a.aze],Aa.forEach(xc=>{this.wkd(xc);this.k$c(xc)}))}}Cki(za,Aa){if("about:blank"===za||"renamehandler.ashx"===
Aa&&"2"===w.a.gz(za,"u"))return!0;for(za=0;za<this.UJd.length;za++)if(Aa.endsWith(this.UJd[za]))return!0;return!1}dti(){this.dQa.execute(za=>{za.Rh(ie.FMg,0);za.jEg(this.QAf);za.activate()})}Xsi(){const za={};za.a=new Date(P.EcmaDateClock.instance.appStart.m);za.b=this.userSessionId;za.c=this.Lh.d9f;za.d=ie.Hbh*m.devicePixelRatio;za.e=pb.a.Wa.appStart.m;this.Le(14,za,!0);this.Fka(pb.a.Wa.appStart.m,Object(W.a)(z.a.instance,z.a.instance.x5i,"recordAppInitStart"))}l5f(za,Aa){this.Zeb=this.a0a.e8a();
this.fOb=this.a0a.e8a();this.vCa=za;this.SLb("UserAction",za,this.fOb,Aa);this.Ykf(za,this.Zeb)}wHj(){const za=window[fe.a.namespace];za&&!ie.gCe&&(za[fe.a.jEj]=(Aa,xc)=>this.UDe(Aa,xc),za[fe.a.Wjh]=Aa=>{this.Tze(Aa)},ie.gCe=!0)}UPj(za){const Aa=Mb.lQg(za.o,za.t),xc=new Mb(rf.a(za.e,za.s)),zd=Aa in this.gTd?this.gTd[Aa].vZg(xc):xc;this.gTd[Aa]=zd;if(xc===zd||xc.average!==zd.average)za=Object(wb.a)(new Fa,{operation:za.o,target:za.t,cCi:zd.average,sender:this}),this.raiseEvent(Aa,za)}Ykf(za,Aa){const xc=
{};xc.a=Aa;xc.b=this.userSessionId;xc.c=za;this.Le(1,xc,!0)}U9h(){this.UJd=[Rb.a.d9i,Rb.a.getSessionStatus,Rb.a.O3a,Rb.a.hZg,Rb.a.bWg,Rb.a.Reb,Rb.a.kac,Rb.a.getObjectMetadata,Rb.a.setRichTextCell,Rb.a.ZJa,Rb.a.YTj,Rb.a.pollSessionStatus,Rb.a.aXh,Rb.a.kVh,Rb.a.wPh]}wkd(za,Aa=null){za.i=Aa||this.a0a.e8a();za.a=this.GEe;za.c=this.zEe;za.h=this.Me?this.Me.Ii:!1}static ka(za){var Aa=new Ie;za.da.Ga(291,Aa);Aa=new ie(za.ya.UserSessionId,void 0,void 0,void 0,Aa,!0);Aa.Ykf(ie.nrf,Aa.pFe);d.ULS.sendTraceTag(524166239,
0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");Aa.dti();Aa.wHj();Aa.cXi();Aa.Xsi();Aa.mzh();Aa.dXi();Aa.U9h();ie.Doj(za);Mc.a.sl.Ga(41,Aa)}static Doj(za){const Aa=m.devicePixelRatio;1<Aa&&za.jc.Kw(!0,2<=Aa?8388608:4194304)}}ie.nrf="UnassignedUserAction";ie.LBd="PageLoad";ie.Bgd="GridUpdateOperation";ie.Ohh=5E3;ie.hUh="MoreThan_5000_Ms";ie.Hbh=96;ie.FMg=30;ie.gCe=!1;Object(b.a)(ie,"TelemetryManager",Fe.a,[12,13,679,680]);var Ae=a(198),Se=a(104);class Ff{constructor(za,Aa,
xc){this.tVj=za;this.oU=Aa;this.name=xc}}Object(b.a)(Ff,"Validation",null,[]);class $f{constructor(za){this.U8a=()=>{this.QFf(this.ISe)};this.Li=()=>{this.QFf(this.PNg)};this.$=za;this.PNg=new Bc.a;this.ISe=new Bc.a;bd.g(this.$).Ea.kx(this.Li);bd.g(this.$).Ea.Hle(this.U8a)}iTc(za,Aa,xc,zd,de){if(za&&zd){const pe=Ae.a.cz(Aa,xc);this.IXb(()=>!!Se.a(za).vq(pe),zd.StateId,de)}}IXb(za,Aa,xc){this.ZCg(this.ISe,za,Aa,xc)}ZCg(za,Aa,xc,zd){za&&Aa&&xc!==Rb.a.Ce&&za.add(new Ff(Aa,xc,zd))}QFf(za){if(za){var Aa=
new Bc.a;for(let xc of za){if(xc.oU===this.$.ea.Ke)try{xc.tVj()||d.ULS.sendTraceTag(537151010,0,15,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [${xc.name}]`)}catch(zd){d.ULS.sendTraceTag(537151009,0,10,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [${xc.name}]. Exception: [${zd}]`)}Aa.add(xc)}for(let xc of Aa)za.remove(xc)}else d.ULS.shipAssertTag(537151011,0,!!za,
"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")}dispose(){bd.g(this.$)&&bd.g(this.$).Ea&&(bd.g(this.$).Ea.sv(this.Li),bd.g(this.$).Ea.cId(this.U8a));this.$=null}static ka(za){const Aa=new $f(za);za.da.Ga(277,Aa)}}Object(b.a)($f,"ValidationTelemetryManager",null,[678,2]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.BrowserInfoLogger");n.main();Type.registerNamespace("CNT");V.main();Type.registerNamespace("CACPU");mb.main();Type.registerNamespace("Common.App.EventsCacheManager");
$a.main();(()=>{Kb.a.Fa(za=>{za.da.Ga(137,new Va(za))})})();(()=>{Kb.a.Fa(za=>{za.da.Ga(37,new zb(za))})})();(()=>{Kb.a.Fa(za=>{yc.ka(za)})})();(()=>{Kb.a.Fa(za=>{Dd.ka(za)})})();(()=>{Kb.a.Fa(za=>{ke.ka(za)})})();(()=>{Kb.a.Fa(za=>{za.da.Ga(40,new Kd(za,new ja.a(()=>ic.GetServiceTaskFactory.create(za.da,137,za.la,1))))})})();(()=>{Kb.a.Fa(za=>{za.da.Ga(276,new fc(za))})})();(()=>{Kb.a.Fa(za=>{Mc.a.sl.Za(135,()=>{ie.ka(za);Ad.ka(za);$f.ka(za);md.ka(za);sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnregisterCpuMeter",
!1)||Fc(za);Cf.ka(za);Vf.ka(za);sd.RenderingFidelityTracker.ka(za)})})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.tm.js.map/07eab138b4ed5af3b52ace2dd4b7dc91/EwaDSEsNext.tm.js.map