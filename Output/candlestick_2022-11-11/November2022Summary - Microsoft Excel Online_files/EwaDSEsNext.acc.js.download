'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[25],{1116:function(t,C,a){a.d(C,"a",function(){return b});var c=a(508);const b=()=>{c.a.Hi(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}")}},
1117:function(t,C,a){a.d(C,"a",function(){return b});var c=a(508);const b=()=>{c.a.Hi('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}')}},
1118:function(t,C,a){a.d(C,"a",function(){return b});var c=a(508);const b=()=>{c.a.Hi(".ewa-svg-icon{height:100%;width:100%}")}},1119:function(t,C,a){function c(m,v){this.ID=m;this.type=v}function b(m,v){this.value=m;this.contextId=v}function d(m,v,n,w,r,u,y,x){this.type=m;this.startTime=null==n||void 0==n.value?new b(n,null):n;this.endTime=null==w||void 0==w.value?new b(w,null):w;null!=r&&void 0!=r.value||new b(r,null);null!=u&&void 0!=u.value||new b(u,null);this.operationType=x}function f(m){this.ID=
m}function e(){this.Le=[];this.enb=[];this.dVc=0;this.duration=this.startTime=null;this.o6b={};this.Zud=this.Dvd=this.AWc=-1}function k(m){var v;return(null!=document.body.style.msTransform?v=m.style.msTransform:null!=document.body.style.webkitTransform?v=m.style.webkitTransform:null!=document.body.style.mozTransform?v=m.style.DZj:null!=document.body.style.oTransform?v=m.style.FZj:null!=document.body.style.transform&&(v=m.style.transform),v)?(v=v.replace("rotate(",""),v=v.replace("deg)",""),parseFloat(v)):
0}a.d(C,"a",function(){return k});new c(0,0,0,0,0,0);new c(1,1,0,0,0,0);new c(2,2,0,0,0,0);new c(3,3,0,0,0,1);new c(4,3,1,0,1,1);new c(5,3,0,0,.42,1);new c(6,3,.83,0,1,1);new c(7,3,0,0,.58,1);new c(8,3,.42,0,.58,1);new c(9,3,.1,.25,.75,.9);new c(10,3,.1,.9,.2,1);new c(11,3,.1,.9,.2,1);new c(12,3,.9,.1,.2,1);new c(13,3,.4,0,0,1);new c(14,3,.13,.21,.1,.7);new c(15,3,.02,.33,.38,.77);new c(16,3,.57,.17,.95,.75);new c(17,3,0,.19,.07,.72);new c(18,3,0,0,.95,.37);new c(19,3,.66,0,.34,1);new c(20,3,.8,0,
.2,1);new c(21,3,.8,0,.2,1);d.prototype={type:0,startTime:new b(0,null),endTime:new b(0,null),RZj:new b(0,null),iZj:new b(0,null),operationType:0};t=Array(1);t[0]=new b(0,0);new f(0,[new d(5,0,0,0,null,1,1,0)]);new f(1,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,50,null,1,1,0)]);new f(2,[new d(1,3,0,167,null,0,1,1),new d(2,3,0,167,null,0,1,1)]);new f(3,[new d(3,3,0,167,null,0,1,1),new d(4,3,0,167,null,0,1,1)]);new f(4,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,167,null,1,1,0)]);new f(5,[new d(5,2,0,167,null,
0,1,0)]);new f(6,[new d(1,3,0,100,null,0,1,1),new d(2,3,0,100,null,0,1,1)]);new f(7,[new d(3,3,0,100,null,0,1,1),new d(4,3,0,100,null,0,1,1)]);new f(8,[new d(5,2,0,100,null,1,1,0)]);new f(9,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,100,null,1,1,0)]);new f(10,[new d(5,2,0,100,null,0,1,0)]);new f(11,[new d(1,3,0,267,null,0,1,1),new d(2,3,0,267,null,0,1,1)]);new f(12,[new d(3,3,0,267,null,0,1,1),new d(4,3,0,267,null,0,1,1)]);new f(13,[new d(5,2,0,267,null,1,1,0)]);new f(14,[new d(5,2,0,0,null,0,2,0),new d(5,
2,0,267,null,1,1,0)]);new f(15,[new d(5,2,0,267,null,0,1,0)]);new f(16,[new d(6,3,0,267,null,0,1,1),new d(7,3,0,267,null,0,1,1)]);new f(17,[new d(1,3,0,750,null,0,1,1),new d(2,3,0,750,null,0,1,1)]);new f(18,[new d(3,3,0,750,null,0,1,1),new d(4,3,0,750,null,0,1,1)]);new f(19,[new d(5,2,0,750,null,1,1,0)]);new f(20,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,750,null,1,1,0)]);new f(21,[new d(6,3,0,1E3,null,0,1,1),new d(7,3,0,1E3,null,0,1,1)]);new f(22,[new d(1,3,0,367,null,0,1,1),new d(2,3,0,367,null,0,
1,1)]);new f(23,[new d(3,3,0,367,null,0,1,1),new d(4,3,0,367,null,0,1,1)]);new f(24,[new d(5,2,0,367,null,1,1,0)]);new f(25,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,367,null,1,1,0)]);new f(26,[new d(5,2,0,367,null,0,1,0)]);new f(27,[new d(6,2,0,t[0],null,0,1,1),new d(7,2,0,t[0],null,0,1,1)]);new f(28,[new d(5,2,0,0,null,1,1,0),new d(5,2,0,50,null,0,1,0)]);new f(29,[new d(1,3,0,433,null,0,1,1),new d(2,3,0,433,null,0,1,1)]);new f(30,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,50,null,1,1,0),new d(2,3,0,0,
null,40,1,1),new d(2,3,0,100,null,0,1,1)]);new f(31,[new d(2,0,0,0,null,32,1,1),new d(2,0,0,100,null,32,1,1),new d(2,3,101,350,null,0,1,1),new d(3,0,0,0,null,0,2,1),new d(3,0,0,100,null,0,2,1),new d(3,3,101,350,null,0,1,1),new d(5,0,0,0,null,0,2,0),new d(5,0,0,100,null,1,1,0)]);new f(32,[new d(2,3,0,267,null,32,1,1),new d(3,3,0,267,null,0,2,1),new d(5,2,0,0,null,1,0,0),new d(5,2,0,267,null,0,2,0)]);new f(33,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,100,null,0,2,0),new d(5,2,101,267,null,1,1,0)]);new f(34,
[new d(1,10,0,300,null,0,1,1),new d(2,10,0,300,null,0,1,1)]);new f(35,[new d(3,10,0,300,null,0,1,1),new d(4,10,0,300,null,0,1,1)]);new f(36,[new d(1,8,0,750,null,0,1,1),new d(2,8,0,750,null,0,1,1)]);new f(37,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,200,null,0,2,0),new d(5,3,201,500,null,1,1,0)]);new f(38,[new d(1,2,0,0,null,0,2,1),new d(2,2,0,0,null,0,2,1),new d(1,2,0,200,null,0,2,1),new d(2,2,0,200,null,0,2,1),new d(1,3,201,267,null,0,1,1),new d(2,3,201,267,null,0,1,1)]);new f(39,[new d(1,3,0,267,
null,0,1,1),new d(2,3,0,267,null,0,1,1)]);new f(40,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,267,null,1,1,0)]);new f(41,[new d(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(m){window.setTimeout(m,16)}}();e.prototype={Le:null,ZIg:5,enb:null,dVc:0,startTime:null,
duration:null,o6b:null,AWc:-1,Dvd:-1,Zud:-1};e.prototype.Start=function(){this.startTime=new Date;this.o6b={}};e.prototype.GetRecentAnimationStats=function(){var m,v=[],n=0;for(m=l.dVc;m<l.ZIg;m++)null!=l.enb[m]&&(v[n]=l.enb[m],n++);for(m=0;m<l.dVc;m++)null!=l.enb[m]&&(v[n]=l.enb[m],n++);return v};e.prototype.GetAnimationSqmStats=function(){var m=[];return m[0]=0>l.AWc?0:l.AWc,m[1]=0>l.Dvd?0:l.Dvd,m[2]=0>l.Zud?0:l.Zud,m};var l=new e},1120:function(t,C,a){a.d(C,"a",function(){return k});t=a(0);C=a(38);
var c=a(215),b=a(357),d=a(184),f=a(43),e=a(605);class k extends C.a{constructor(l){super();this.ES=[];this.nf=(v,n)=>{var w,r=n.fd.block;v=!1;if(r.Dk&&r.state&1&&(w=this.view.Lf(n.fd.block.se.BlockCachePosition.PaneType).pG(n.fd.hash))){r=this.wFd(r.pe);if(w=w.rf)for(let u=this.ES.length-1;0<=u;u--)w.contains(this.ES[u].bottomRight)&&(this.ES.splice(u,1),v=!0);if(r)for(let u=0,y=r.length;u<y;u++)this.rangeList.push(d.a.bQ(r[u])),v=!0;v&&(n=this.view.boc(n.fd.block.se.BlockCachePosition.PaneType).pG(n.fd.hash),
this.raiseEvent(k.xFd,new e.a(n)))}};this.Lm=()=>{this.mHb()};this.yo=()=>{this.ES=[]};this.eie=l;var m=l.Ea;m.Ks(this.nf);m.jga(this.nf);m.$Xb(this.nf);m.MG(this.Lm);l.$.xa.qJ(this.yo);l.$.zb.qJ(this.yo);for(const v of l.tn)for(let n of v)for(let w of n)m=l.Ea.Jl(w.hashCode),this.nf(this,new b.a(new c.a(m,w.hashCode),null))}get rangeList(){return this.ES}get view(){return this.eie}dispose(){this.view&&(this.view.Ea.Nq(this.nf),this.view.Ea.mI(this.Lm),this.view.Ea.Mab(this.nf),this.view.Ea.EHb(this.nf),
this.view.$.xa.SK(this.yo),this.view.$.zb.SK(this.yo));this.ES=this.eie=null;super.dispose()}TXb(l){l=this.wFd(l);const m=this.view.nH;if(l&&0<l.length&&m)for(let v=0,n=l.length;v<n;v++)m.contains(this.ES[v])||this.ES.push(d.a.bQ(l[v]))}mHb(){const l=this.view.nH;if(this.ES.length&&l)for(let m=this.ES.length-1;0<=m;m--)l.contains(this.ES[m])||this.ES.splice(m,1)}n0e(l){return this.F_e(l)}F_e(l){l=f.I(l,this.ES,!0);return 0<l.length?l[0]:null}}k.xFd="lrc";Object(t.a)(k,"LoadedRangeCollection",C.a,
[])},1121:function(t,C,a){a.d(C,"a",function(){return b});var c=a(508);const b=()=>{c.a.Hi(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}")}},
1135:function(t,C,a){var c=a(10),b=a(0),d=a(221),f=a(38);class e extends f.a{constructor(Ma){super();Ma.da.Ga(376,this)}LGg(Ma){this.addHandler("TAF",Ma)}vcj(Ma){this.removeHandler("TAF",Ma)}B2i(){this.raiseEvent("TAF")}}Object(b.a)(e,"GridHighlightBehaviorEventManager",f.a,[332,2]);class k extends d.a{constructor(Ma){super();this.$=Ma;this.Fb()}create(){this.qb(this.$.da.za(376)||new e(this.$))}static ka(Ma){Ma.da.Ga(377,new k(Ma))}}Object(b.a)(k,"GridHighlightBehaviorEventManagerFactory",d.a,[]);
var l=a(50),m=a(37),v=a(27),n=a(78),w=a(15),r=a(236),u=a(13),y=a(154),x=a(5),B=a(113),z=a(12);class A extends Sys.EventArgs{constructor(Ma,Tb){super();this.start=Ma;this.c5a=Tb}}Object(b.a)(A,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var I=a(33);class F extends f.a{constructor(Ma){super();this.Hjc=[3];this.zpa=void 0;this.gridView=Ma;this.Jzc=I.a.TU(this.gridView.$);this.rz=I.a.rz(this.gridView.$)}get coloredReferencesManager(){const Ma=this.gridView.$.da.za(281);Ma||w.ULS.sendTraceTag(537159395,
0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return Ma}get ez(){if(this.zpa)return this.zpa;const Ma=this.gridView.$.da.za(464);Ma||w.ULS.sendTraceTag(0,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
Ma.ez||w.ULS.sendTraceTag(0,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.zpa=Ma.ez}kFg(Ma){this.addHandler("mrek",Ma)}Gw(Ma,Tb,zb){for(const ic of this.gridView.tn)r.a.instance.ra(u.a.zj,ic.domElement,Ma);r.a.instance.ra(u.a.Mf,document.documentElement,Tb);this.gridView.hc.v6b(!0);zb&&r.a.instance.ra(u.a.ky,this.gridView.tj,Tb)}XWd(Ma,Tb,zb){for(const ic of this.gridView.tn)r.a.instance.Ba(u.a.zj,ic.domElement,Ma);r.a.instance.Ba(u.a.Mf,document.documentElement,
Tb);this.gridView.hc.v6b(!1);zb&&r.a.instance.Ba(u.a.ky,this.gridView.tj,Tb)}D7i(Ma,Tb){for(const zb of this.gridView.tn)y.a.instance.ra(u.a.Xf,zb.domElement,Ma);y.a.instance.ra(u.a.te,document.documentElement,Tb)}SOj(Ma,Tb){for(const zb of this.gridView.tn)y.a.instance.Ba(u.a.Xf,zb.domElement,Ma);y.a.instance.Ba(u.a.te,document.documentElement,Tb)}oCe(Ma,Tb,zb,ic){const Qb=document.createElement("div");Qb.className=Tb;for(const wb of zb)Qb.classList.add(wb);Ma.appendChild(Qb);r.a.instance.ra(u.a.pointerDown,
Qb,ic);return Qb}b1e(Ma){Ma=Ma.Cb.parentNode;if(!Ma)return w.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;Ma=parseInt(Ma.getAttribute(x.a.c5a),10);return isNaN(Ma)?(w.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.lb.dv(3,1,Ma)}pKb(Ma,Tb,zb=!0){Ma=zb&&(this.rz?!!this.ez&&this.ez.xii(Ma):!!this.coloredReferencesManager&&
this.coloredReferencesManager.wii(Ma));for(const ic of Tb)z.DOMElementExtensions.setVisible(ic,Ma)}D9b(){return this.gridView.lm?B.a(this.gridView.$):this.gridView.Xb}aMf(){if(this.rz){var Ma=this.D9b();Ma&&this.ez?this.Jzc?Ma.IB(null):this.ez.ueb(Ma,null):(w.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.lb.Mg(this.Hjc),this.gridView.lb.oi(null,this.Hjc))}else this.k5i()}k5i(){const Ma=
this.D9b();Ma&&this.coloredReferencesManager?this.Jzc?Ma.IB(null):this.coloredReferencesManager.IB(Ma,null):(w.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.lb.Mg(this.Hjc),this.gridView.lb.oi(null,this.Hjc))}kKf(Ma,Tb){this.raiseEvent("mrek",new A(Ma,Tb))}}Object(b.a)(F,"BehaviorHelperMethods",f.a,[]);var U=a(86),X=a(39),S=a(93);class H extends S.a{constructor(Ma,Tb=null){super(Ma,
Tb)}rYa(){}}Object(b.a)(H,"HighlightFlyweightBehavior",S.a,[]);var D=a(19),J=a(458),M=a(77),G=a(11),T=a(116),K=a(222),L=a(44),V=a(235),W=a(8),da=a(72),qa=a(1),O=a(34);class ea extends V.a{constructor(Ma,Tb,zb){super(document.createElement("div"));this.b4b=null;this.FOb=!1;this.onPointerDown=ic=>{ic=O.a(this.$)?O.a(this.$).Td(ic):ic;this.FOb=!1;if(3===(M.a.Eb=ic.tb)){const Qb=ic.Ca.rawEvent,wb=Qb.srcElement||Qb.target;z.DOMElementExtensions.vf(this.domElement,wb)&&z.DOMElementExtensions.vf(Qb.currentTarget,
wb)&&(this.FOb=!0,this.b4b=ic.clientPoint)}return!1};this.Kf=ic=>{ic=O.a(this.$)?O.a(this.$).Td(ic):ic;this.raiseEvent("GrPointerUp",ic);return this.FOb=!1};this.Hh=ic=>{ic=O.a(this.$)?O.a(this.$).Td(ic):ic;3===ic.tb&&this.FOb&&this.l4h(ic.clientPoint)&&(this.raiseEvent("GrDrag"),this.FOb=!1);return!1};this.ed=ic=>{O.a(this.$)&&O.a(this.$).Td(ic);return!0};this.$=zb;zb=!qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.domElement.classList.add(zb?da.a.nPe:da.a.mPe);this.domElement.classList.add(da.a.x7b);
Ma.appendChild(this.domElement);z.DOMElementExtensions.setVisible(this.domElement,!1);this.nKa=document.createElement("div");this.nKa.classList.add(da.a.w7b);this.nKa.style.borderColor=Tb;this.domElement.appendChild(this.nKa);r.a.instance.ra(u.a.pointerDown,this.domElement,this.onPointerDown);r.a.instance.ra(u.a.Mf,this.domElement,this.Kf);y.a.instance.ra(u.a.te,this.domElement,this.Kf);r.a.instance.ra(u.a.zj,this.domElement,this.Hh);y.a.instance.ra(u.a.Xf,this.domElement,this.Hh);K.a.instance.ra(u.a.click,
this.domElement,this.ed)}mme(Ma){this.addHandler("GrDrag",Ma)}KPf(Ma){this.removeHandler("GrDrag",Ma)}lme(Ma){this.addHandler("GrContxt",Ma)}JPf(Ma){this.removeHandler("GrContxt",Ma)}nme(Ma){this.addHandler("GrPointerUp",Ma)}LPf(Ma){this.removeHandler("GrPointerUp",Ma)}dispose(){L.a.jma(this.domElement);super.dispose()}bdg(Ma){this.domElement.parentNode.removeChild(this.domElement);Ma.appendChild(this.domElement)}OXf(){this.domElement.classList.remove(da.a.x7b);this.nKa.classList.remove(da.a.w7b);
this.nKa.classList.add(da.a.oPe)}rbg(){this.nKa.classList.remove(da.a.oPe);this.nKa.classList.add(da.a.w7b);this.domElement.classList.add(da.a.x7b)}l4h(Ma){return!!this.b4b&&(3<Math.abs(Ma.x-this.b4b.x)||3<Math.abs(Ma.y-this.b4b.y))}static pub(Ma){return qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?(Ma=O.a(Ma.$)?O.a(Ma.$).zoom:W.a.XZ,Math.round(9/Math.max(Ma,1))):9}}ea.Jud=0;Object(b.a)(ea,"TouchGrippie",V.a,[]);class R extends H{constructor(Ma,Tb,zb,ic){super(Tb);this.fqd=
this.DVc=this.qnb=!1;this.Lob=null;this.Yaa=this.bqd=!1;this.xw=()=>{this.qnb&&this.bqd?this.mna():this.O3()};this.uxf=wb=>{3===wb.tb&&(this.bqd=!0,this.mna());return!1};this.vxf=wb=>{if(3===wb.tb){if(!wb.Cb||this.ugi(wb))return!1;this.bqd=!1;this.O3()}return!1};this.yg=()=>{this.Yaa&&this.aXd();this.mna();this.fqd=!1};this.yp=()=>{this.O3();this.fqd=!0};this.jya=(wb,hc)=>{hc.S3===this.S3&&(hc.visible?this.fqd||this.mna():this.O3())};this.iDf=()=>{this.wxf(this.vO.domElement,!1)};this.Rtf=()=>{this.wxf(this.eM.domElement,
!0)};this.imc=(wb,hc)=>{this.ha.Uya(hc)};this.jmc=(wb,hc)=>{this.ha.Uya(J.b(hc))};this.ZDb=()=>{3===M.a.Eb?this.mna():this.O3();this.Yaa&&1===M.a.Eb&&this.aXd()};this.jDf=()=>{this.coj()};this.NIe=()=>{this.O3()};this.sn=()=>{this.ha.Pa.$b&&this.O3()};this.Ftf=()=>{this.O3()};this.nxf=(wb,hc)=>{this.aXd();3===hc.tb?this.mna():this.O3()};this.$pc=()=>{this.qnb&&(this.O3(),this.mna())};const Qb=zb.$;this.fq=zb;this.ha=zb.ha;this.Baa=Ma;this.ylj=Tb;this.paneType=ic;Ma=this.domElement.currentStyle;Tb=
"#000000";Ma&&(Tb=Ma.borderTopColor);this.vO=new ea(this.v$c(),Tb,Qb);this.eM=new ea(this.v$c(),Tb,Qb);this.sef=Qb.ea.isNamedObjectViewMode&&1===Qb.workbookContext.NovMode;this.vO.mme(this.iDf);this.vO.lme(this.imc);this.vO.nme(this.jmc);this.eM.mme(this.Rtf);this.eM.lme(this.imc);this.eM.nme(this.jmc);for(const wb of this.gridView.tn)y.a.instance.ra(u.a.Af,wb.domElement,this.vxf),y.a.instance.ra(u.a.te,wb.domElement,this.uxf);zb.view.Ls(this.xw);zb.Xb.Nk(this.NIe);zb.lb.Lmb(this.jya);zb.HTc(this.Ftf);
Qb.EA(this.$pc);zb.Ku(this.$pc);this.ha.IX(this.yg);this.ha.N1(this.yp);zb.hC(this.sn);this.ha.dYb(this.nxf);M.a.vme(this.ZDb);m.TaskExtensions.Aa(l.GetServiceTaskFactory.Ra(Qb.da,376,377,0),wb=>{wb.result.LGg(this.jDf)},Qb.la,3)}get gridView(){return this.fq}dispose(){U.a.qc([this.vO,this.eM]);this.vO.KPf(this.iDf);this.vO.JPf(this.imc);this.vO.LPf(this.jmc);this.eM.KPf(this.Rtf);this.eM.JPf(this.imc);this.eM.LPf(this.jmc);for(var Ma of this.gridView.tn)y.a.instance.Ba(u.a.Af,Ma.domElement,this.vxf),
y.a.instance.Ba(u.a.te,Ma.domElement,this.uxf);this.gridView.view.Pq(this.xw);this.gridView.Xb.tk(this.NIe);this.gridView.lb.SHb(this.jya);this.gridView.dId(this.Ftf);this.gridView.$.zD(this.$pc);this.gridView.py(this.$pc);this.ha.RV(this.yg);this.ha.m6(this.yp);this.gridView.AD(this.sn);this.ha.orc(this.nxf);M.a.SPf(this.ZDb);this.Yaa&&w.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(Ma=this.gridView.$.da.za(376))&&Ma.vcj(this.jDf);super.dispose()}DRa(){if(!this.Baa.range||
!this.Baa.range.equals(this.Ubb))return!1;const Ma=!this.gridView.TLa();return this.gridView.eb&&Ma&&(this.Ubb.isRow||this.Ubb.Ze)?!1:this.Yaa?!0:3===M.a.Eb}O3(){this.qnb&&(this.vO.set_visible(!1),this.eM.set_visible(!1),this.qnb=!1)}mna(){if(this.DRa()){this.uSj();var Ma=z.DOMElementExtensions.getBoundingClientRect(this.Lob);Ma||w.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",
this.gridView.$.ea.isNamedObjectViewMode,this.sef,this.DVc,this.gridView.tj,this.gridView.ib.mj);var Tb=z.DOMElementExtensions.getBoundingClientRect(this.ylj),zb=new Sys.UI.Bounds(Tb.x-Ma.x,Tb.y-Ma.y,Tb.width,Tb.height),ic=this.Ubb,Qb=ic.topLeft,wb=ic.bottomRight,hc=ic.isRow||ic.Ze;if(ic.Ze){var Za=this.Lzh();ic=zb.x-2*ea.pub(this.gridView);var ub=Za;var uc=zb.x+Tb.width}else ic.isRow?(ic=uc=this.Kzh(),ub=zb.y-2*ea.pub(this.gridView),Za=zb.y+Tb.height):(ub=zb.y,Za=zb.y+Tb.height,this.gridView.rtl?
(ic=zb.x+Tb.width,uc=zb.x):(ic=zb.x,uc=zb.x+Tb.width));Tb=ea.Jud+(hc?0:ea.pub(this.gridView));this.vO.style.left=G.HelperMethods.pc(ic-Tb);this.vO.style.top=G.HelperMethods.pc(ub-Tb);this.eM.style.left=G.HelperMethods.pc(uc-Tb);this.eM.style.top=G.HelperMethods.pc(Za-Tb);this.vO.set_visible(this.Ncf(ub,ic,Qb,hc,Ma));this.eM.set_visible(this.Ncf(Za,uc,wb,hc,Ma));this.qnb=!0}}Ncf(Ma,Tb,zb,ic,Qb){const wb=z.DOMElementExtensions.getBoundingClientRect(this.gridView.Lf(this.paneType).domElement);Qb=new Sys.UI.Bounds(wb.x-
Qb.x-3,wb.y-Qb.y-3,wb.width+6,wb.height+6);return(this.gridView.ib.Vi(zb)===this.paneType||ic)&&X.a.XM(Qb,new Sys.UI.Point(Tb,Ma))}uSj(){if(this.sef!==this.DVc){this.Lob=null;const Ma=this.v$c();this.vO.bdg(Ma);this.eM.bdg(Ma)}}Lzh(){return(this.gridView.view.visibleArea.height+this.gridView.ib.height+ea.Jud-ea.pub(this.gridView))/2}Kzh(){return(this.gridView.view.visibleArea.width+this.gridView.ib.width+ea.Jud-ea.pub(this.gridView))/2}uBf(){this.mna()}ugi(Ma){return z.DOMElementExtensions.Jbb(Ma.Cb,
D.a.Zo)&&(this.shi(Ma)||this.thi(Ma))}thi(Ma){if(this.gridView.rtl)Ma=Ma.clientPoint.x;else{const Tb=z.DOMElementExtensions.getBoundingClientRect(Ma.Cb);Ma=Ma.clientPoint.x-(Tb.x+Tb.width-T.a.mu)}return 0<Ma&&Ma<=T.a.mu}shi(Ma){const Tb=z.DOMElementExtensions.getBoundingClientRect(Ma.Cb);Ma=Ma.clientPoint.y-(Tb.y+Tb.height-T.a.mu);return 0<Ma&&Ma<=T.a.mu}wxf(Ma,Tb){this.Yaa&&w.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.TYc(Ma,Tb,this.Yaa);
this.O3()}coj(){this.Yaa||(w.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.Yaa=!0,this.vO.OXf(),this.eM.OXf(),this.gridView.ha.sourceRange=this.gridView.ha.sa.Wc,this.mna())}aXd(){this.Yaa&&(w.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.Yaa=!1,this.vO.rbg(),this.eM.rbg())}v$c(){this.Lob||(this.DVc=!1,this.Lob=this.gridView.tj);return this.Lob}}Object(b.a)(R,"SelectionTouchGrippiesBehaviorBase",H,[]);class oa extends R{constructor(Ma,
Tb,zb,ic){super(Ma,Tb,zb,ic)}get S3(){return 19}get Ubb(){return this.gridView.ha.sa.activeRange}DRa(){const Ma=this.gridView.xi||this.gridView.eb;return!this.gridView.ha.sa.wg&&!Ma&&super.DRa()}}Object(b.a)(oa,"DiscontinuousSelectionTouchGrippiesBehavior",R,[]);var pa=a(175);class Pa extends H{constructor(Ma){super(Ma);const Tb=document.createElement("div");Tb.className=da.a.Suh;Ma.appendChild(Tb)}}Object(b.a)(Pa,"SelectionBorderBehavior",H,[]);class Z{}Z.xuh="ewr-selection-draghandle";Z.Cuh="ewr-selection-draghandle-grab";
Z.Nuh="ewr-selection-draghandle-top-ie";Z.Ouh="ewr-selection-draghandle-top-ie-enhanced";Z.Luh="ewr-selection-draghandle-top";Z.Muh="ewr-selection-draghandle-top-enhanced";Z.Auh="ewr-selection-draghandle-bottom-ie";Z.Buh="ewr-selection-draghandle-bottom-ie-enhanced";Z.yuh="ewr-selection-draghandle-bottom";Z.zuh="ewr-selection-draghandle-bottom-enhanced";Z.Fuh="ewr-selection-draghandle-left-ie";Z.Guh="ewr-selection-draghandle-left-ie-enhanced";Z.Duh="ewr-selection-draghandle-left";Z.Euh="ewr-selection-draghandle-left-enhanced";
Z.Juh="ewr-selection-draghandle-right-ie";Z.Kuh="ewr-selection-draghandle-right-ie-enhanced";Z.Huh="ewr-selection-draghandle-right";Z.Iuh="ewr-selection-draghandle-right-enhanced";Z.uPe="ewr-selection-dragtooltip";Z.vPe="ewr-selection-dragtooltip-updated";Z.Zuh="ewr_selection_rearrangeleft";Z.$uh="ewr_selection_rearrangeright";Z.avh="ewr_selection_rearrangetop";Z.Yuh="ewr_selection_rearrangebottom";Z.selecting="selecting";Z.bvh="ewr-selection-resizemarqueehandle";Z.evh="ewr-selection-resizemarqueehandle-topleft";
Z.fvh="ewr-selection-resizemarqueehandle-topright";Z.cvh="ewr-selection-resizemarqueehandle-bottomleft";Z.dvh="ewr-selection-resizemarqueehandle-bottomright";Z.nuh="ewr-marquee-thick";Z.ruh="ewr-resizemarqueehandle-thick";Object(b.a)(Z,"CssClassNames",null,[]);var Ra=a(248),Ga=a(21);class Ba extends Pa{constructor(Ma,Tb,zb,ic){super(Ma);this.mSa=!1;this.ije=this.jje=null;this.bra=0;this.Uh=qa.EwaSettings.getBooleanFeatureGate(pa.a.X5b,!1);this.Sfi=qa.EwaSettings.getBooleanFeatureGate(pa.a.jhh,!1);
this.EBc=this.Mcc=this.BE=0;this.Aw=this.gb=this.sourceRange=this.Zla=null;this.Kf=Qb=>{Qb=O.a(this.$).Td(Qb);return this.nAd(Qb)};this.onPointerDown=Qb=>{Qb=O.a(this.$).Td(Qb);if(2===Qb.tb&&Qb.Tn===Sys.UI.MouseButton.leftButton&&!this.mSa){var wb=this.Hac(Qb);if(!wb)return w.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.gb=wb.clone();this.sourceRange=this.gb.clone();this.Zla=this.gb;if(wb=this.mRh(Qb))this.lh=5,this.EBc=wb.top-this.sourceRange.top,
this.Mcc=wb.left-this.sourceRange.left,Ga.g(this.$).Df.Wl(this.Uh?Ba.cIa:Ba.Y5c),this.Umc(Qb),this.mSa=!0,Ra.b(this.$,!0)}return!1};this.Hh=Qb=>{Qb=O.a(this.$).Td(Qb);if(this.Uh&&this.Xmc(Qb))return!0;if(Qb=this.ha.Vn(Qb.clientPoint,Qb.Cb,5,void 0,void 0,!0)){Qb=this.Vga(Qb);if(this.gb.equals(Qb))return!0;this.gb=Qb;if(!this.By())return w.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.btb(!0),!1}return!0};this.$c=(Qb,wb)=>{wb.aN||
(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")?this.Tza(this.$.isEditMode&&this.jna()):this.Tza(this.$.isEditMode))};this.Or=[];this.$=Tb;this.ha=Ga.g(this.$).ha;this.paneType=zb;this.io=ic;Tb=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");Tb=this.Sfi?Tb?[Z.Muh,Z.zuh,Z.Euh,Z.Iuh]:[Z.Ouh,Z.Buh,Z.Guh,Z.Kuh]:Tb?[Z.Luh,Z.yuh,Z.Duh,Z.Huh]:[Z.Nuh,Z.Auh,Z.Fuh,Z.Juh];for(const Qb of Tb)Tb=this.io.oCe(Ma,Qb,this.Uh?[Z.Cuh]:[Z.xuh],this.onPointerDown),
this.Or.push(Tb);this.$.el(this.$c);qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")||this.Tza(this.$.isEditMode)}get lb(){return Ga.g(this.$).lb}get lh(){return this.ha.selectionType}set lh(Ma){this.ha.selectionType=Ma}dispose(){this.Or.forEach(Ma=>{r.a.instance.Ba(u.a.pointerDown,Ma,this.onPointerDown)});this.Or.length=0;this.Zla=this.sourceRange=this.gb=null;w.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.bra}, EwaControl is null : ${!this.$}`);
this.$&&(this.$.Al(this.$c),1===this.bra&&(w.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.Ss(this.ije,this.jje,!1)));super.dispose()}nAd(Ma){if(5!==this.lh)return!1;(Ma=this.hya(Ma))||this.btb(!1);Ra.b(this.$,!1);return Ma}Gw(Ma,Tb){w.ULS.shipAssertTag(537159377,0,!this.bra,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.bra+=1;this.ije=Ma;this.jje=Tb;this.io.Gw(Ma,
Tb,this.vzc())}Vga(Ma){if(!Ma||!this.gb)return w.ULS.shipAssertTag(537159376,0,!!Ma,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),w.ULS.shipAssertTag(537159375,0,!!this.gb,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const Tb=this.gb.clone();1!==this.BE&&(Tb.left=Math.max(Ma.left-this.Mcc,1),Tb.right=Tb.left+this.sourceRange.width-1);2!==this.BE&&(Tb.top=Math.max(Ma.top-this.EBc,1),Tb.bottom=Tb.top+this.sourceRange.height-1);return this.sYa(Tb)}Ss(Ma,
Tb,zb=!0,ic=!0){w.ULS.shipAssertTag(537159374,0,1===this.bra,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.bra;this.Uh||Ga.g(this.$).Df.Wl(x.a.jQ);this.io.XWd(Ma,Tb,this.vzc());zb&&this.ZZc(ic);this.BE=0;this.mSa=!1}sYa(Ma){var Tb=Ga.g(this.$);let zb=Ma;if(Tb.ib.J3){if(!Tb.Vb(Ma.topLeft)){Tb=Tb.mk("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",Tb.nH,this.Zla.top!==Ma.top?1:2);try{Tb.Fk=this.Zla.top<Ma.top||this.Zla.left<Ma.left,Tb.es(Ma.topLeft),
zb=Tb.$$cu().range}finally{Tb&&Tb.dispose()}}zb.right=zb.left+Ma.width-1;zb.bottom=zb.top+Ma.height-1}return this.Zla=zb}Tza(Ma){this.Or.forEach(Tb=>{z.DOMElementExtensions.setVisible(Tb,Ma)})}mRh(Ma){const Tb=Ma.Cb;Ma=Ma.clientPoint;if(!Tb||!Ma)return w.ULS.shipAssertTag(537159373,0,!!Tb,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),w.ULS.shipAssertTag(537159372,0,!!Ma,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;Ma.y+=Tb===this.Or[Ba.bIa]?
2:Tb===this.Or[Ba.a6c]?-2:0;Ma.x+=Tb===this.Or[Ba.b6c]?2:Tb===this.Or[Ba.aIa]?-2:0;return this.ha.Vn(Ma,Tb,5,void 0,void 0,!0)}}Ba.Y5c="move";Ba.$_a="copy";Ba.cIa="grabbing";Ba.bIa=0;Ba.a6c=1;Ba.b6c=2;Ba.aIa=3;Object(b.a)(Ba,"DragSelectionClickBehaviorBase",Pa,[]);class fa extends Ba{constructor(Ma,Tb,zb,ic,Qb,wb){super(Ma,Tb,zb,Qb);this.Ya=this.WF=null;this.H4e=()=>{this.btb(!0)};qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.Tza(this.jna()&&this.$.isEditMode);
this.gridView=Ga.g(this.$);this.AF=ic;this.coloredReferencesManager=this.$.da.za(281);w.ULS.shipAssertTag(537159391,0,!!this.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.rz=I.a.rz(this.$))Ma=this.$.da.za(464),w.ULS.shipAssertTag(512312961,0,!!Ma,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.ez=Ma.ez;
for(const hc of this.Or)r.a.instance.ra(u.a.yV,hc,this.AF.Z7e),r.a.instance.ra(u.a.ky,hc,this.AF.$7e);this.rYa(wb)}rYa(Ma){this.io.pKb(Ma,this.Or);this.AF.vza()}Umc(Ma){w.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.ZKa=!0;this.Ya.rC(!1);this.lh=5;this.AF.qIe(Ma.Cb);this.Ya.textBox.removeSelection();this.Ya.nYb(this.H4e);this.Gw(this.Hh,this.Kf);this.BE=this.sourceRange.isRow?1:this.sourceRange.Ze?2:0}hya(){const Ma=
this.ZF();this.lh=-1;this.Ss(this.Hh,this.Kf);return Ma}ZZc(){this.gridView.ZKa=!1;this.AF.rIe(this.Or[0]);this.Ya.textBox.setCaretPositionToEnd();this.Ya.Arc(this.H4e);this.io.aMf()}btb(Ma){w.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");Ma&&this.Ss(this.Hh,this.Kf)}Hac(Ma){this.Ya=this.io.D9b();this.WF=this.io.b1e(Ma);return this.Ya&&this.WF&&this.WF.range?this.WF.range:(w.ULS.shipAssertTag(537159388,
0,!!this.Ya,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),w.ULS.shipAssertTag(537159387,0,!!this.WF,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),w.ULS.shipAssertTag(537159386,0,!!this.WF.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}ZF(){return this.WF?this.rz?this.ez.uCb(this.Ya,this.WF,this.gb):this.coloredReferencesManager.uCb(this.Ya,this.WF,this.gb):(w.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),
!1)}By(){return this.ZF()}vzc(){return!0}Xmc(){return!1}jna(){return!0}}Object(b.a)(fa,"DragMarqueeClickBehavior",Ba,[]);var Y=a(85),ja=a(108),ca=a(172),aa=a(412),ta=a(14),xa=a(223),ia=a(24),ya=a(759),ib=a(43),wa=a(513),sa=a(170),Ya=a(704),bb=a(121),mb=a(29),Ca=a(280),$a=a(61);const Kb=(Ma,Tb,zb,ic,Qb,wb,hc,Za=null)=>{Za=Ma.Na(41,Za);Za.sourceRange=Tb;Za.destinationRange=zb;return $a.g(Ma,"RearrangeRowColumn",Za,ic,Qb,wb,hc,0)},rb=(Ma,Tb,zb,ic,Qb,wb,hc=null)=>{hc=Ma.Na(1,hc);hc.moveRange=Tb;return $a.g(Ma,
"MoveLineItems",hc,zb,ic,Qb,wb,0)};class cc{constructor(Ma,Tb){this.destinationRange=this.sourceRange=null;this.sourceRange=Ma;this.destinationRange=Tb}}Object(b.a)(cc,"MacroRecorderTableRowColumnRearrangedPayload",null,[101]);var nc=a(42);class Wb extends Ba{constructor(Ma,Tb,zb,ic,Qb){super(Ma,Tb,zb,Qb);this.Oha=ta.a.instance.ga(2266);this.Xrb=ta.a.instance.ga(2267);this.gna=ta.a.instance.ga(2268);this.MKb=ta.a.instance.ga(2269);this.Yz=this.Mh=null;this.Dq=this.Ze=this.isRow=this.Eq=!1;this.fO=
this.sM=null;this.Jn=this.lAb=0;this.onKeyDown=wb=>{if(this.Uh){if(this.c4(wb)||wb.Ca.keyCode===Y.a.hea)return this.l4||(ja.KeyInputManager.instance.ra(u.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.l4=!0),!this.du&&this.c4(wb)&&(Ga.g(this.$).Df.Wl(Wb.$_a),this.du=!0),this.eu||wb.Ca.keyCode!==Y.a.hea||(Ga.g(this.$).Df.Wl(Ba.cIa),this.eu=!0,2===this.Jn?(this.tx(!1),this.BE=0,this.Mh=this.Dq?[11]:[12],this.Eq=this.Dq,this.CPa(),this.NI()):3===this.Jn?(this.l2(!1),this.BE=this.isRow?1:
2,this.ON(),this.By()):1===this.Jn&&(this.aha(!1),this.ON(),this.By())),!0}else if(!this.du&&(wb.Ca.keyCode===Y.a.r7||v.a.isMac&&wb.Ca.keyCode===Y.a.joa))return ja.KeyInputManager.instance.ra(u.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),Ga.g(this.$).Df.Wl(Wb.$_a),this.du=!0;return!1};this.onKeyUp=wb=>{if(this.Uh){if(this.c4(wb)||wb.Ca.keyCode===Y.a.hea)return this.lAb=this.c4(wb)?0:1,this.kp&&Ga.g(this.$).Df.Wl(Ba.cIa),wb.Ca.keyCode===Y.a.hea&&(2===this.Jn?(this.l2(!1),this.BE=0,this.ON(!0),
this.By(!0)):3===this.Jn?(this.tx(!1),this.BE=this.isRow?1:2,this.Mh=this.isRow?[11]:[12],this.CPa(!0),this.NI(!0)):1===this.Jn&&(this.tx(!1),this.Mh=this.Dq?[11]:[12],this.gza(!0),this.NI(!0))),this.aoa(this.lAb),!0}else if(wb.Ca.keyCode===Y.a.r7||v.a.isMac&&wb.Ca.keyCode===Y.a.joa)return this.aoa(),this.kp&&Ga.g(this.$).Df.Wl(Ba.Y5c),!0;return!1};this.GK=wb=>{wb=O.a(this.$).Td(wb);5===this.lh?this.nAd(wb):(this.kp=!1,this.lb.Mg(this.Mh),!this.$.rq([this.gb],!1)||this.dGd()||this.Xyb()||(this.ha.sourceRange=
this.sourceRange.clone(),this.Uh?this.CEd():this.Usb(),this.Yx()?this.gb.top>this.sourceRange.top&&(wb=this.gb.height,this.gb.top-=wb,this.gb.bottom-=wb):this.gb.left>this.sourceRange.left&&(wb=this.gb.width,this.gb.left-=wb,this.gb.right-=wb),this.ZF()));this.Ss(this.FK,this.GK);this.tableRange=null;this.lh=-1;this.Uh&&(this.Yz=null,this.Jn=0);return!0};this.D5=()=>{this.kp=!1;this.Jn=0;this.lb.Mg(this.Mh);if(!this.$.rq([this.gb],!1))return this.Ss(this.C5,this.D5),this.lh=-1,!0;if(!(this.ha.sa.Wc.equals(this.gb)||
this.Oaa(this.gb)||this.Oaa(this.sourceRange)||this.Xyb()||(this.ZF(),this.ha.sourceRange=this.sourceRange.clone(),this.$.ud(-694765314,2,30,{[x.a.u$]:this.du,[x.a.Y5b]:!0,[x.a.Z5b]:this.Eq,[x.a.cU]:this.ha.sourceRange,[x.a.bU]:this.ha.sa.Wc,[x.a.$Ha]:this.eu}),this.du))){if(this.gb.top>this.sourceRange.top&&(this.isRow||this.gb.left===this.sourceRange.left&&this.Eq)){var wb=this.gb.height;this.gb.top-=wb;this.gb.bottom-=wb}else this.gb.left>this.sourceRange.left&&(this.Ze||this.gb.top===this.sourceRange.top&&
!this.Eq)&&(wb=this.gb.width,this.gb.left-=wb,this.gb.right-=wb);this.ZF()}this.Ss(this.C5,this.D5);this.Yz=this.tableRange=null;this.lh=-1;this.Eq=!1;return!0};this.FK=wb=>{var hc=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");hc&&(wb=O.a(this.$).Td(wb));var Za=wb.clientPoint;hc||(wb=O.a(this.$).Td(wb));this.Uh&&(this.Aw=wb);if(wb=this.ha.Vn(Za,wb.Cb,5,void 0,void 0,!0)){if(this.tableRange.contains(wb.topLeft)){hc=Ga.g(this.$);const uc=hc.mg(wb);var ub=hc.Lf(this.paneType);
Za=Ya.a.xs(ub.view.Ph,this.domElement.parentNode,Za,hc.rtl);ub=!1;let Oc=2;this.Yx()&&Za.y-uc.topLeft.y>uc.height/2?(ub=!0,Oc=1):!this.Yx()&&Za.x-uc.topLeft.x>uc.width/2&&(ub=!0);if(ub){hc=hc.mk("DragSelectionClickBehavior.OnPointerMoveRearrange",hc.nH,Oc);try{hc.es(wb),hc.$$mn(),wb=hc.$$cu().range}finally{hc&&hc.dispose()}}this.gb=this.d2(wb);this.ha.sourceRange=this.gb;this.lb.oi(this.gb,this.Mh);this.lb.zn(this.Mh);this.lb.Mg(this.bB());if(6!==this.lh){for(wb=1;4>=wb;wb++)hc=this.Oh[wb.toString()],
hc.parentNode.removeChild(hc),this.lb.dv(this.Yx()?11:12,wb).uf.appendChild(hc);this.lh=6}}else if(this.gb=this.Vga(wb),this.Uh)this.Wvb(!1);else if(this.lb.oi(this.gb,this.bB()),this.lb.zn(this.bB()),this.lb.Mg(this.Mh),5!==this.lh){for(wb=1;4>=wb;wb++)hc=this.Oh[wb.toString()],hc.parentNode.removeChild(hc),this.lb.dv(this.haa(),wb).uf.appendChild(hc);this.lh=5}this.xy()}return!0};this.C5=wb=>{var hc=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");hc&&(wb=O.a(this.$).Td(wb));
var Za=wb.clientPoint;hc||(wb=O.a(this.$).Td(wb));this.Aw=wb;if(hc=this.ha.Vn(Za,wb.Cb,5,void 0,void 0,!0)){if(this.kwb(hc))return this.gb=this.Vga(hc),this.Vvb(!1),!0;var ub=Ga.g(this.$),uc=ub.mg(hc),Oc=ub.Lf(this.paneType);Za=Ya.a.xs(Oc.view.Ph,this.domElement.parentNode,Za,ub.rtl);Oc=!1;let Bb=2;this.Eq=!1;if(this.isRow||this.Ze){this.isRow&&Za.y-uc.topLeft.y>uc.height/2?(Oc=!0,Bb=1):this.Ze&&Za.x-uc.topLeft.x>uc.width/2&&(Oc=!0);if(Oc){wb=ub.mk("DragSelectionClickBehavior.OnPointerMoveDragInsert",
ub.nH,Bb);try{wb.es(hc),wb.$$mn(),hc=wb.$$cu().range}finally{wb&&wb.dispose()}}this.gb=this.Vga(hc)}else{Za.x-uc.topLeft.x===uc.width?(this.Eq=!1,Oc=!0):Za.y-uc.topLeft.y>uc.height/2&&(this.Eq=Oc=!0,Bb=1);this.Yz&&(this.Eq=this.Dq);if(Oc){ub=ub.mk("DragSelectionClickBehavior.OnPointerMoveDragInsert",ub.nH,Bb);try{ub.es(hc),ub.$$mn(),hc=ub.$$cu().range}finally{ub&&ub.dispose()}}this.lb.Mg(this.Mh);this.Mh=this.Eq?[11]:[12];for(ub=1;4>=ub;ub++)(uc=this.Oh[ub.toString()])&&uc.parentNode.removeChild(uc),
this.Oh[ub.toString()]=null;this.Uz(wb.clientPoint,wb.Cb,this.Eq?11:12,!0);this.gb=this.d2(hc)}this.ha.sourceRange=this.gb;this.lb.oi(this.gb,this.Mh);this.lb.zn(this.Mh);this.lb.Mg(this.bB());if(6!==this.lh){for(wb=1;4>=wb;wb++)hc=this.Oh[wb.toString()],hc.parentNode.removeChild(hc),this.lb.dv(this.isRow||this.Eq?11:12,wb).uf.appendChild(hc);this.lh=6}this.xy()}return!0};this.yg=()=>{this.domElement.classList.remove(Z.selecting)};this.yp=()=>{this.domElement.classList.add(Z.selecting)};this.Vc=()=>
{if(this.$.isEditMode){const wb=this.jna();this.Tza(wb)}};this.oOa=()=>{this.Uh?this.kp&&5<=this.lh&&(this.tableRange?this.eu?this.tx(!0):this.aha(!0):this.eu?this.isRow||this.Ze?this.tx(!0):this.l2(!0):this.isRow||this.Ze?this.l2(!0):this.tx(!0)):this.kp&&5<=this.lh&&(this.tableRange?(this.lb.Mg(this.Mh),this.Ss(this.FK,this.GK)):(this.lb.Mg(this.bB()),this.Ss(this.Hh,this.Kf)))};this.tableManager=ic;qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.Tza(this.jna()&&
this.$.isEditMode);this.tableRange=null;this.Oh={};this.l4=this.eu=this.du=this.kp=!1;this.ha.N1(this.yp);this.ha.IX(this.yg);this.ha.EYb(this.oOa);this.ha.lE(this.Vc)}dispose(){this.ha&&(this.ha.m6(this.yp),this.ha.RV(this.yg),this.ha.KId(this.oOa),this.ha.nI(this.Vc));if(this.Oh)for(let Ma=1;4>=Ma;Ma++)z.DOMElementExtensions.pf(this.Oh[Ma.toString()]);this.Oh=this.Mh=null;this.du&&this.aoa();this.Uh&&this.eu&&this.aoa(1);super.dispose()}Umc(Ma){this.Uh&&(this.Aw=Ma,this.Yz=null,this.Dq=this.isRow=
this.Ze=this.Eq=!1,ja.KeyInputManager.instance.ra(u.a.Kb,this.domElement.ownerDocument.body,this.onKeyDown));this.kp=!0;this.tableRange=this.mYc(this.tableManager.Fm(this.sourceRange.topLeft));Ga.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Uh?(this.Yz=this.tableRange,this.Jn=1,this.Mh=(this.Dq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.lh=6,this.Gw(this.FK,this.GK),this.sM=this.Oha,this.fO=this.gna,this.Uz(Ma.clientPoint,
Ma.Cb,this.Dq?11:12,!0,!0),this.NI(!0)):(this.Mh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.lh=6,this.Gw(this.FK,this.GK),this.Uz(Ma.clientPoint,Ma.Cb,this.isRow?11:12,!0)):(this.tableRange=null,this.Uh?(this.isRow=this.sourceRange.isRow,this.Ze=this.sourceRange.Ze,this.isRow||this.Ze?(this.Jn=3,this.BE=this.isRow?1:2,this.lh=6,this.Mh=this.isRow?[11]:[12],this.Gw(this.C5,this.D5),this.sM=this.Oha,this.fO=this.gna,this.Uz(Ma.clientPoint,
Ma.Cb,this.isRow?11:12,!0,!0),this.NI(!0)):(this.Jn=2,this.BE=0,this.Gw(this.Hh,this.Kf),this.sM=this.Xrb,this.fO=this.MKb,this.Uz(Ma.clientPoint,Ma.Cb,this.haa(),!1,!0),this.By(!0))):(this.Gw(this.Hh,this.Kf),ja.KeyInputManager.instance.ra(u.a.Kb,this.domElement.ownerDocument.body,this.onKeyDown),this.BE=this.sourceRange.isRow?1:this.sourceRange.Ze?2:0,this.Uz(Ma.clientPoint,Ma.Cb,this.haa(),!1),this.By()))}hya(){this.kp=!1;this.Uh&&(this.Jn=0);this.lb.Mg(this.bB());if(!this.$.rq([this.gb],!1))return this.Ss(this.Hh,
this.Kf),this.lh=-1,!0;if(this.ha.sa.Wc.equals(this.gb)||this.Oaa(this.gb)||this.Oaa(this.sourceRange))this.lh=-1;else{this.ZF();this.ha.sourceRange=this.sourceRange.clone();const Ma=this.ha.sourceRange,Tb=this.ha.sa.Wc;this.Uh?this.$.ud(-694765314,2,30,{[x.a.u$]:this.du,[x.a.cU]:Ma,[x.a.bU]:Tb,[x.a.$Ha]:this.eu}):this.$.ud(-694765314,2,30,{[x.a.u$]:this.du,[x.a.cU]:Ma,[x.a.bU]:Tb})}!this.Uh&&this.tableRange||this.Ss(this.Hh,this.Kf);return!0}ZZc(Ma){Ma&&(ja.KeyInputManager.instance.Ba(u.a.Kb,this.domElement.ownerDocument.body,
this.onKeyDown),this.Uh&&Ga.g(this.$).Df.Wl(x.a.jQ),this.kp=!1);for(Ma=1;4>=Ma;Ma++){const Tb=this.Oh[Ma.toString()];Tb&&Tb.parentNode.removeChild(Tb);this.Oh[Ma.toString()]=null}this.Mh=null}Xmc(Ma){const Tb=this.ha.Vn(Ma.clientPoint,Ma.Cb,5,void 0,void 0,!0);this.Aw=Ma;return this.kwb(Tb)?(this.gb=this.d2(Tb),this.Vvb(!0),!0):this.Chd(Tb)?(this.gb=this.Vga(Tb),this.Wvb(!0),!0):!1}kwb(Ma){return!!this.Yz&&1!==this.Jn&&!!Ma&&this.Yz.contains(Ma.topLeft)}Chd(Ma){return!!this.Yz&&1===this.Jn&&!!Ma&&
!this.Yz.contains(Ma.topLeft)}Vvb(Ma){this.tableRange=this.Yz;this.Jn=1;const Tb=!this.eu;Ma?(this.tx(!1),this.Mh=this.Dq?[11]:[12],this.gza(Tb),this.NI(Tb)):(this.l2(!1),this.ON(Tb),this.By(Tb))}Wvb(Ma){this.tableRange=null;this.Jn=2;const Tb=!this.eu;Ma?(this.tx(!1),this.Mh=this.Dq?[11]:[12],this.Eq=this.Dq,this.CPa(Tb),this.NI(Tb)):(this.aha(!1),this.ON(Tb),this.By(Tb))}Hac(){return this.ha.sa.Wc}ZF(){this.ha.updateSelection(this.gb,this.gb.topLeft,0);return!0}By(Ma=!1){this.lb.oi(this.gb,this.bB());
this.lb.zn(this.bB());this.xy(Ma);return!0}NI(Ma=!1){this.lb.oi(this.gb,this.Mh);this.lb.zn(this.Mh);this.xy(Ma)}btb(){w.ULS.sendTraceTag(537159384,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")}vzc(){return!1}jna(){if(!Ga.g(this.$).ha.sa.wg)return!1;const Ma=Ga.g(this.$).getRangeInformation(this.ha.sa.Wc);for(const Tb of Ma)if(Object(aa.a)(xa.PivotTableRange,Tb))return!1;return!0}mYc(Ma){if(Ma&&Ma.contains(this.sourceRange)&&!Ma.equals(this.sourceRange)){if(Ma.yaa&&
this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===Ma.top){const Tb=new ia.Range(this.sourceRange.top,this.sourceRange.left,Ma.bottom,this.sourceRange.right,!1,!1);if(!Tb.equals(Ma))return this.sourceRange=Tb,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),Ma}this.Uh?this.Dq=Ma.left===this.sourceRange.left&&Ma.right===this.sourceRange.right:this.isRow=Ma.left===this.sourceRange.left&&Ma.right===this.sourceRange.right;if(Ma.top===this.sourceRange.top&&Ma.bottom===
this.sourceRange.bottom||this.Yx())return Ma}return null}d2(Ma){const Tb=Ma.clone();this.Yx()?Tb.left=Math.max(Ma.left-this.Mcc,1):Tb.top=Math.max(Ma.top-this.EBc,1);Tb.right=Tb.left+this.sourceRange.width-1;Tb.bottom=Tb.top+this.sourceRange.height-1;return this.sYa(Tb)}Xyb(){const Ma=this.gb.topLeft.Dd(this.sourceRange);return Ma||this.Uh&&!this.tableRange?Ma:this.Yx()?this.gb.top===this.sourceRange.bottom+1:this.gb.left===this.sourceRange.right+1}dGd(){if(this.Yx()&&this.gb.left!==this.tableRange.left||
!this.Yx()&&this.gb.top!==this.tableRange.top){const Ma=mb.a.Yc(1,1,0,917,0,2065438552,"RearrangeInvalidDest");nc.a(this.$).vr([Ma]);return!0}return!1}CEd(){const Ma=this.$.Ib.Bc("UserAction","RearrangeRowColumnClientSide"),Tb={["CopyPasteTargetType"]:1,["OperationId"]:ca.a.create().toString(),["Stopwatch"]:Ma,["DragDropIsShiftKeyDown"]:this.eu,["EncounteredDeploymentErrors"]:!1},zb=this.du?2:1,ic=this.$.da.za(254);(new Promise((Qb,wb)=>{this.Usb(hc=>{hc.Errors&&0<hc.Errors.length?wb(new ya.a(22,
hc.Errors)):Qb(!0)},hc=>{hc=bb.a.lf(hc.data);wb(new ya.a(22,hc))})})).then(()=>{w.ULS.sendTraceTag(537159383,0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="1"');ic&&ic.Glf(Tb,zb,this.sourceRange,this.gb);return Promise.resolve(!0)},Qb=>{w.ULS.sendTraceTag(537159382,0,10,`DragSelectionClickBehavior.RearrangeRowColumn: ${Qb?copyPasteInfra.getStringifiedError(Qb):"null"}, copyPasteTargetType="${1}"`);return ic?ic.BAf(Qb,Tb,zb,this.sourceRange,this.gb):Promise.reject(Qb)})}Usb(Ma=
null,Tb=null){const zb={};this.Yx()?(zb.FirstRow=this.gb.top-1,zb.FirstColumn=0,zb.DeltaColumn=0,zb.DeltaRow=this.gb.bottom-this.gb.top+1):(zb.FirstRow=0,zb.FirstColumn=this.gb.left-1,zb.DeltaColumn=this.gb.right-this.gb.left+1,zb.DeltaRow=0);zb.LastRow=W.a.Az;zb.LastColumn=W.a.rw;zb.SheetName=this.$.xa.pa?this.$.xa.pa.name:this.$.zb.getItemByName(this.$.zb.pa.name).sheetName;const ic=ib.v(this.sourceRange,this.$),Qb=(hc,Za,ub)=>Kb(this.$.oa.va,ic,zb,Ma?Ca.b(hc,Ma):hc,Tb?Ca.a(Za,Tb):Za,ub,null),wb=
()=>new cc(ic,zb);qa.EwaSettings.dc()?this.$.userOperationManager.Ub(new sa.a(514,0,Qb,64,wb),null):this.$.userOperationManager.Ub(new wa.a(514,0,Qb,void 0,wb),null)}Oaa(Ma){Ma=Ga.g(this.$).getRangeInformation(Ma);for(let Tb=0,zb=Ma.length;Tb<zb;++Tb)if(Object(aa.a)(xa.PivotTableRange,Ma[Tb]))return Ma=mb.a.Yc(1,0,0,904,0,2105176604,"InsDelCellsPivotTable"),nc.a(this.$).vr([Ma]),!0;return!1}Uz(Ma,Tb,zb,ic,Qb=!1){var wb=z.DOMElementExtensions.getBoundingClientRect(Tb);let hc=Tb===this.Or[Ba.bIa]||
Tb===this.Or[Ba.a6c];if(this.Uh){var Za=Tb===this.Or[Ba.b6c]||Tb===this.Or[Ba.aIa];this.isRow&&Za||this.Ze&&hc?Za="100px":(hc=this.isRow||hc,Za=(hc?Qb?Wb.rVd:Wb.xVd:Qb?Wb.qVd:Wb.uVd)+"px");Tb=hc?Tb===this.Or[Ba.bIa]?"top":"bottom":Tb===this.Or[Ba.aIa]?"right":"left";Ma=100*(hc?Ma.x-wb.x:Ma.y-wb.y)/(hc?wb.width:wb.height);for(wb=1;4>=wb;wb++){ic=document.createElement("div");var ub=document.createElement("div");const uc=document.createElement("div");ic.appendChild(ub);ic.appendChild(uc);Qb&&(ub=document.createElement("div"),
ic.appendChild(ub),uc.style.fontWeight="bold");ic.className=Z.vPe;this.Oh[wb.toString()]=ic;this.lb.dv(zb,wb).uf.appendChild(ic);ic=this.Oh[wb.toString()];ic.style[Tb]=Za;ic.style[hc?"left":"top"]=Ma+"%"}}else for(Qb=(hc?-Wb.wVd:-Wb.tVd)+"px",Za=hc?Tb===this.Or[Ba.bIa]?"top":"bottom":Tb===this.Or[Ba.aIa]||ic?"right":"left",Tb=100*(hc?ic?0:Ma.x-wb.x:Ma.y-wb.y)/(hc?wb.width:wb.height),Ma=1;4>=Ma;Ma++)wb=document.createElement("div"),wb.className=Z.uPe,this.Oh[Ma.toString()]=wb,this.lb.dv(zb,Ma).uf.appendChild(wb),
wb=this.Oh[Ma.toString()],wb.style[Za]=Qb,wb.style[hc?"left":"top"]=Tb+"%"}xy(Ma=!1){const Tb=this.gb.toString();if(this.Uh)for(let zb=1;4>=zb;zb++)this.Oh[zb.toString()].childNodes[0].innerText=Tb,this.Oh[zb.toString()].childNodes[1].innerText=this.sM,Ma&&(this.Oh[zb.toString()].childNodes[2].innerText=this.fO);else for(Ma=1;4>=Ma;Ma++)this.Oh[Ma.toString()].innerText=Tb}aoa(Ma=0){0===Ma?this.du=!1:1===Ma&&(this.eu=!1);this.Uh&&(this.du||this.eu)||(ja.KeyInputManager.instance.Ba(u.a.Fd,this.domElement.ownerDocument.body,
this.onKeyUp),this.l4=!1)}tx(Ma){this.lb.Mg(this.bB());this.Ss(this.Hh,this.Kf,void 0,Ma)}l2(Ma){this.lb.Mg(this.Mh);this.Ss(this.C5,this.D5,void 0,Ma)}aha(Ma){this.lb.Mg(this.Mh);this.Ss(this.FK,this.GK,void 0,Ma)}ON(Ma=!1){this.lh=5;this.Gw(this.Hh,this.Kf);this.sM=this.Xrb;this.fO=this.MKb;this.Uz(this.Aw.clientPoint,this.Aw.Cb,this.haa(),!1,Ma)}CPa(Ma=!1){this.lh=6;this.Gw(this.C5,this.D5);this.sM=this.Oha;this.fO=this.gna;this.Uz(this.Aw.clientPoint,this.Aw.Cb,this.isRow||this.Dq?11:12,!0,Ma)}gza(Ma=
!1){this.lh=6;this.Gw(this.FK,this.GK);this.sM=this.Oha;this.fO=this.gna;this.Uz(this.Aw.clientPoint,this.Aw.Cb,this.Yx()?11:12,!0,Ma)}c4(Ma){return Ma.Ca.keyCode===Y.a.r7||v.a.isMac&&Ma.Ca.keyCode===Y.a.joa}Yx(){return!this.Uh&&this.isRow||this.Uh&&this.Dq}haa(){return this.Uh?47:6}bB(){return this.Uh?Wb.$5c:Wb.c6c}}Wb.tVd=50;Wb.wVd=25;Wb.uVd=-85;Wb.xVd=-40;Wb.qVd=-120;Wb.rVd=-50;Wb.$_a="copy";Wb.c6c=[6];Wb.$5c=[47];Object(b.a)(Wb,"DragSelectionClickBehavior",Ba,[]);var Ea=a(82);class ua extends Ba{constructor(Ma,
Tb,zb,ic,Qb){super(Ma,Tb,zb,Qb);this.Mh=null;this.Ze=this.isRow=!1;this.yg=()=>{this.domElement.classList.remove(Z.selecting)};this.yp=()=>{this.domElement.classList.add(Z.selecting)};this.Vc=()=>{if(this.$.isEditMode){const wb=this.jna();this.Tza(wb)}};this.tableManager=ic;qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.Tza(this.jna()&&this.$.isEditMode);this.Oh={};this.kp=!1;this.ha.N1(this.yp);this.ha.IX(this.yg);this.ha.lE(this.Vc)}dispose(){this.ha&&(this.ha.m6(this.yp),
this.ha.RV(this.yg),this.ha.KId(this.oOa),this.ha.nI(this.Vc));if(this.Oh)for(let Ma=1;4>=Ma;Ma++)z.DOMElementExtensions.pf(this.Oh[Ma.toString()]);this.Oh=this.Mh=null;super.dispose()}ZZc(Ma){Ma&&(this.Uh&&Ga.g(this.$).Df.Wl(x.a.jQ),ja.KeyInputManager.instance.Ba(u.a.Kb,this.domElement.ownerDocument.body,this.onKeyDown),this.kp=!1);for(Ma=1;4>=Ma;Ma++){const Tb=this.Oh[Ma.toString()];Tb&&Tb.parentNode.removeChild(Tb);this.Oh[Ma.toString()]=null}this.Mh=null}Hac(){return this.ha.sa.Wc}ZF(){this.ha.updateSelection(this.gb,
this.gb.topLeft,0);return!0}By(Ma=!1){this.lb.oi(this.gb,this.bB());this.lb.zn(this.bB());this.xy(Ma);return!0}NI(Ma=!1){this.lb.oi(this.gb,this.Mh);this.lb.zn(this.Mh);this.xy(Ma)}btb(){w.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")}vzc(){return!1}Uz(Ma,Tb,zb,ic,Qb=!1){var wb=z.DOMElementExtensions.getBoundingClientRect(Tb);let hc=Tb===this.Or[Ba.bIa]||Tb===this.Or[Ba.a6c];if(this.Uh){var Za=Tb===
this.Or[Ba.b6c]||Tb===this.Or[Ba.aIa];this.isRow&&Za||this.Ze&&hc?Za="100px":(hc=this.isRow||hc,Za=(hc?Qb?ua.rVd:ua.xVd:Qb?ua.qVd:ua.uVd)+"px");Tb=hc?Tb===this.Or[Ba.bIa]?"top":"bottom":Tb===this.Or[Ba.aIa]?"right":"left";Ma=100*(hc?Ma.x-wb.x:Ma.y-wb.y)/(hc?wb.width:wb.height);for(wb=1;4>=wb;wb++){ic=document.createElement("div");var ub=document.createElement("div");const uc=document.createElement("div");ic.appendChild(ub);ic.appendChild(uc);Qb&&(ub=document.createElement("div"),ic.appendChild(ub),
uc.style.fontWeight="bold");ic.className=Z.vPe;this.Oh[wb.toString()]=ic;this.lb.dv(zb,wb).uf.appendChild(ic);ic=this.Oh[wb.toString()];ic.style[Tb]=Za;ic.style[hc?"left":"top"]=Ma+"%"}}else for(Qb=(hc?-ua.wVd:-ua.tVd)+"px",Za=hc?Tb===this.Or[Ba.bIa]?"top":"bottom":Tb===this.Or[Ba.aIa]||ic?"right":"left",Tb=100*(hc?ic?0:Ma.x-wb.x:Ma.y-wb.y)/(hc?wb.width:wb.height),Ma=1;4>=Ma;Ma++)wb=document.createElement("div"),wb.className=Z.uPe,this.Oh[Ma.toString()]=wb,this.lb.dv(zb,Ma).uf.appendChild(wb),wb=
this.Oh[Ma.toString()],wb.style[Za]=Qb,wb.style[hc?"left":"top"]=Tb+"%"}Vcg(Ma,Tb,zb){const ic=Ga.g(this.$),Qb=ic.mg(Ma);var wb=ic.Lf(this.paneType);zb=Ya.a.xs(wb.view.Ph,this.domElement.parentNode,zb,ic.rtl);wb=!1;let hc=2;Tb&&zb.y-Qb.topLeft.y>Qb.height/2?(wb=!0,hc=1):!Tb&&zb.x-Qb.topLeft.x>Qb.width/2&&(wb=!0);if(wb){Tb=ic.mk("DragSelectionClickBehaviorTemporary.updateMouseSelectionRange",ic.nH,hc);try{Tb.es(Ma),Tb.$$mn(),Tb.$$cu()}finally{Tb&&Tb.dispose()}}}aha(Ma){this.lb.Mg(this.Mh);this.Ss(this.FK,
this.GK,void 0,Ma)}tx(Ma){this.lb.Mg(this.bB());this.Ss(this.Hh,this.Kf,void 0,Ma)}haa(){return this.Uh?47:6}bB(){return this.Uh?ua.$5c:ua.c6c}c4(Ma){return Ma.Ca.keyCode===Y.a.r7||v.a.isMac&&Ma.Ca.keyCode===Y.a.joa}Oaa(Ma){Ma=Ga.g(this.$).getRangeInformation(Ma);for(let Tb=0,zb=Ma.length;Tb<zb;++Tb)if(Object(aa.a)(xa.PivotTableRange,Ma[Tb]))return Ma=mb.a.Yc(1,0,905,904,0,2105176604,"InsDelCellsPivotTable"),nc.a(this.$).vr([Ma]),!0;return!1}}ua.tVd=50;ua.wVd=25;ua.uVd=-85;ua.xVd=-40;ua.qVd=-120;
ua.rVd=-50;ua.c6c=[6];ua.$5c=[47];Object(b.a)(ua,"DragSelectionClickBehaviorTemporary",Ba,[]);class ma extends ua{constructor(Ma,Tb,zb,ic,Qb){super(Ma,Tb,zb,ic,Qb);this.Yz=null;this.Dq=this.Eq=!1;this.lAb=0;this.fO=this.sM=null;this.Jn=0;this.Oha=ta.a.instance.ga(2266);this.Xrb=ta.a.instance.ga(2267);this.gna=ta.a.instance.ga(2268);this.MKb=ta.a.instance.ga(2269);this.onKeyDown=wb=>{if(this.Uh){if(this.c4(wb)||wb.Ca.keyCode===Y.a.hea)return this.l4||(ja.KeyInputManager.instance.ra(u.a.Fd,this.domElement.ownerDocument.body,
this.onKeyUp),this.l4=!0),!this.du&&this.c4(wb)&&(Ga.g(this.$).Df.Wl(Ba.$_a),this.du=!0),this.eu||wb.Ca.keyCode!==Y.a.hea||(Ga.g(this.$).Df.Wl(Ba.cIa),this.eu=!0,2===this.Jn?(this.tx(!1),this.BE=0,this.Mh=this.Dq?[11]:[12],this.Eq=this.Dq,this.CPa(),this.NI()):3===this.Jn?(this.l2(!1),this.BE=this.isRow?1:2,this.ON(),this.By()):1===this.Jn&&(this.aha(!1),this.ON(),this.By())),!0}else if(!this.du&&(wb.Ca.keyCode===Y.a.r7||v.a.isMac&&wb.Ca.keyCode===Y.a.joa))return ja.KeyInputManager.instance.ra(u.a.Fd,
this.domElement.ownerDocument.body,this.onKeyUp),Ga.g(this.$).Df.Wl(Ba.$_a),this.du=!0;return!1};this.onKeyUp=wb=>{if(this.Uh){if(this.c4(wb)||wb.Ca.keyCode===Y.a.hea)return this.lAb=this.c4(wb)?0:1,this.kp&&Ga.g(this.$).Df.Wl(Ba.cIa),wb.Ca.keyCode===Y.a.hea&&(2===this.Jn?(this.l2(!1),this.BE=0,this.ON(!0),this.By(!0)):3===this.Jn?(this.tx(!1),this.BE=this.isRow?1:2,this.Mh=this.isRow?[11]:[12],this.CPa(!0),this.NI(!0)):1===this.Jn&&(this.tx(!1),this.Mh=this.Dq?[11]:[12],this.gza(!0),this.NI(!0))),
this.aoa(this.lAb),!0}else if(wb.Ca.keyCode===Y.a.r7||v.a.isMac&&wb.Ca.keyCode===Y.a.joa)return this.aoa(),this.kp&&Ga.g(this.$).Df.Wl(Ba.Y5c),!0;return!1};this.GK=wb=>{wb=O.a(this.$).Td(wb);5===this.lh?this.nAd(wb):(this.kp=!1,this.lb.Mg(this.Mh),!this.$.rq([this.gb],!1)||this.dGd()||this.Xyb()||(this.ha.sourceRange=this.sourceRange.clone(),this.Uh?this.CEd():this.Usb(),this.Yx()?this.gb.top>this.sourceRange.top&&(wb=this.gb.height,this.gb.top-=wb,this.gb.bottom-=wb):this.gb.left>this.sourceRange.left&&
(wb=this.gb.width,this.gb.left-=wb,this.gb.right-=wb),this.ZF()),this.Qsd());this.Ss(this.FK,this.GK);this.tableRange=null;this.lh=-1;this.Uh&&(this.Yz=null,this.Jn=0);return!0};this.D5=()=>{this.kp=!1;this.Jn=0;this.lb.Mg(this.Mh);if(!this.$.rq([this.gb],!1))return this.Ss(this.C5,this.D5),this.lh=-1,!0;if(!(this.ha.sa.Wc.equals(this.gb)||this.Oaa(this.gb)||this.Oaa(this.sourceRange)||this.Xyb()||(this.ZF(),this.ha.sourceRange=this.sourceRange.clone(),this.$.ud(-694765314,2,30,{[x.a.u$]:this.du,
[x.a.Y5b]:!0,[x.a.Z5b]:this.Eq,[x.a.cU]:this.ha.sourceRange,[x.a.bU]:this.ha.sa.Wc,[x.a.$Ha]:this.eu}),this.du))){if(this.gb.top>this.sourceRange.top&&(this.isRow||this.gb.left===this.sourceRange.left&&this.Eq)){var wb=this.gb.height;this.gb.top-=wb;this.gb.bottom-=wb}else this.gb.left>this.sourceRange.left&&(this.Ze||this.gb.top===this.sourceRange.top&&!this.Eq)&&(wb=this.gb.width,this.gb.left-=wb,this.gb.right-=wb);this.ZF()}this.Ss(this.C5,this.D5);this.Yz=this.tableRange=null;this.lh=-1;this.Eq=
!1;this.Qsd();return!0};this.FK=wb=>{const hc=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");hc&&(wb=O.a(this.$).Td(wb));var Za=wb.clientPoint;hc||(wb=O.a(this.$).Td(wb));this.Uh&&(this.Aw=wb);if(wb=this.ha.Vn(Za,wb.Cb,5,void 0,void 0,!0)){if(this.tableRange.contains(wb.topLeft)){if(this.Vcg(wb,this.Yx(),Za),this.gb=this.d2(wb),this.ha.sourceRange=this.gb,this.lb.oi(this.gb,this.Mh),this.lb.zn(this.Mh),this.lb.Mg(this.bB()),6!==this.lh){for(Za=1;4>=Za;Za++)wb=
this.Oh[Za.toString()],wb.parentNode.removeChild(wb),this.lb.dv(this.Yx()?11:12,Za).uf.appendChild(wb);this.lh=6}}else if(this.gb=this.Vga(wb),this.Uh)this.Wvb(!1);else if(this.lb.oi(this.gb,this.bB()),this.lb.zn(this.bB()),this.lb.Mg(this.Mh),5!==this.lh){for(Za=1;4>=Za;Za++)wb=this.Oh[Za.toString()],wb.parentNode.removeChild(wb),this.lb.dv(this.haa(),Za).uf.appendChild(wb);this.lh=5}this.xy()}return!0};this.C5=wb=>{var hc=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");
hc&&(wb=O.a(this.$).Td(wb));var Za=wb.clientPoint;hc||(wb=O.a(this.$).Td(wb));this.Aw=wb;if(hc=this.ha.Vn(Za,wb.Cb,5,void 0,void 0,!0)){if(this.kwb(hc))return this.gb=this.Vga(hc),this.Vvb(!1),!0;var ub=Ga.g(this.$),uc=ub.mg(hc),Oc=ub.Lf(this.paneType);Za=Ya.a.xs(Oc.view.Ph,this.domElement.parentNode,Za,ub.rtl);Oc=!1;let Bb=2;this.Eq=!1;if(this.isRow||this.Ze){this.isRow&&Za.y-uc.topLeft.y>uc.height/2?(Oc=!0,Bb=1):this.Ze&&Za.x-uc.topLeft.x>uc.width/2&&(Oc=!0);if(Oc){wb=ub.mk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",
ub.nH,Bb);try{wb.es(hc),wb.$$mn(),hc=wb.$$cu().range}finally{wb&&wb.dispose()}}this.gb=this.Vga(hc)}else{Za.x-uc.topLeft.x===uc.width?(this.Eq=!1,Oc=!0):Za.y-uc.topLeft.y>uc.height/2&&(this.Eq=Oc=!0,Bb=1);this.Yz&&(this.Eq=this.Dq);if(Oc){ub=ub.mk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",ub.nH,Bb);try{ub.es(hc),ub.$$mn(),hc=ub.$$cu().range}finally{ub&&ub.dispose()}}this.lb.Mg(this.Mh);this.Mh=this.Eq?[11]:[12];for(ub=1;4>=ub;ub++)(uc=this.Oh[ub.toString()])&&uc.parentNode.removeChild(uc),
this.Oh[ub.toString()]=null;this.Uz(wb.clientPoint,wb.Cb,this.Eq?11:12,!0);this.gb=this.d2(hc)}this.ha.sourceRange=this.gb;this.lb.oi(this.gb,this.Mh);this.lb.zn(this.Mh);this.lb.Mg(this.bB());if(6!==this.lh){for(wb=1;4>=wb;wb++)hc=this.Oh[wb.toString()],hc.parentNode.removeChild(hc),this.lb.dv(this.isRow||this.Eq?11:12,wb).uf.appendChild(hc);this.lh=6}this.xy()}return!0};this.oOa=()=>{this.Uh?this.kp&&5<=this.lh&&(this.tableRange?this.eu?this.tx(!0):this.aha(!0):this.eu?this.isRow||this.Ze?this.tx(!0):
this.l2(!0):this.isRow||this.Ze?this.l2(!0):this.tx(!0)):this.kp&&5<=this.lh&&(this.tableRange?(this.lb.Mg(this.Mh),this.Ss(this.FK,this.GK)):(this.lb.Mg(this.bB()),this.Ss(this.Hh,this.Kf)))};this.tableRange=null;this.l4=this.du=this.eu=!1;this.ha.EYb(this.oOa)}dispose(){this.du&&this.aoa();this.Uh&&this.eu&&this.aoa(1);super.dispose()}Umc(Ma){this.Uh&&(this.Aw=Ma,this.Yz=null,this.Dq=this.isRow=this.Ze=this.Eq=!1,ja.KeyInputManager.instance.ra(u.a.Kb,this.domElement.ownerDocument.body,this.onKeyDown));
this.kp=!0;this.tableRange=this.mYc(this.tableManager.Fm(this.sourceRange.topLeft));Ga.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Uh?(this.Yz=this.tableRange,this.Jn=1,this.Mh=(this.Dq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.lh=6,this.Gw(this.FK,this.GK),this.sM=this.Oha,this.fO=this.gna,this.Uz(Ma.clientPoint,Ma.Cb,this.Dq?11:12,!0,!0),this.NI(!0)):(this.Mh=(this.isRow=this.tableRange.left===this.sourceRange.left&&
this.tableRange.right===this.sourceRange.right)?[11]:[12],this.lh=6,this.Gw(this.FK,this.GK),this.Uz(Ma.clientPoint,Ma.Cb,this.isRow?11:12,!0)):(this.tableRange=null,this.Uh?(this.isRow=this.sourceRange.isRow,this.Ze=this.sourceRange.Ze,this.isRow||this.Ze?(this.Jn=3,this.BE=this.isRow?1:2,this.lh=6,this.Mh=this.isRow?[11]:[12],this.Gw(this.C5,this.D5),this.sM=this.Oha,this.fO=this.gna,this.Uz(Ma.clientPoint,Ma.Cb,this.isRow?11:12,!0,!0),this.NI(!0)):(this.Jn=2,this.BE=0,this.Gw(this.Hh,this.Kf),
this.sM=this.Xrb,this.fO=this.MKb,this.Uz(Ma.clientPoint,Ma.Cb,this.haa(),!1,!0),this.By(!0))):(this.Gw(this.Hh,this.Kf),ja.KeyInputManager.instance.ra(u.a.Kb,this.domElement.ownerDocument.body,this.onKeyDown),this.BE=this.sourceRange.isRow?1:this.sourceRange.Ze?2:0,this.Uz(Ma.clientPoint,Ma.Cb,this.haa(),!1),this.By()))}hya(){this.kp=!1;this.Uh&&(this.Jn=0);this.lb.Mg(this.bB());if(!this.$.rq([this.gb],!1))return this.Ss(this.Hh,this.Kf),this.lh=-1,!0;if(this.ha.sa.Wc.equals(this.gb)||this.Oaa(this.gb)||
this.Oaa(this.sourceRange))this.lh=-1;else{this.ZF();this.ha.sourceRange=this.sourceRange.clone();const Ma=this.ha.sourceRange,Tb=this.ha.sa.Wc;this.Uh?this.$.ud(-694765314,2,30,{[x.a.u$]:this.du,[x.a.cU]:Ma,[x.a.bU]:Tb,[x.a.$Ha]:this.eu}):this.$.ud(-694765314,2,30,{[x.a.u$]:this.du,[x.a.cU]:Ma,[x.a.bU]:Tb})}!this.Uh&&this.tableRange||this.Ss(this.Hh,this.Kf);this.Qsd();return!0}Xmc(Ma){const Tb=this.ha.Vn(Ma.clientPoint,Ma.Cb,5,void 0,void 0,!0);this.Aw=Ma;return this.kwb(Tb)?(this.gb=this.d2(Tb),
this.Vvb(!0),!0):this.Chd(Tb)?(this.gb=this.Vga(Tb),this.Wvb(!0),!0):!1}xy(Ma=!1){const Tb=this.gb.toString();if(this.Uh)for(let zb=1;4>=zb;zb++)this.Oh[zb.toString()].childNodes[0].innerText=Tb,this.Oh[zb.toString()].childNodes[1].innerText=this.sM,Ma&&(this.Oh[zb.toString()].childNodes[2].innerText=this.fO);else for(Ma=1;4>=Ma;Ma++)this.Oh[Ma.toString()].innerText=Tb}kwb(Ma){return!!this.Yz&&1!==this.Jn&&!!Ma&&this.Yz.contains(Ma.topLeft)}Chd(Ma){return!!this.Yz&&1===this.Jn&&!!Ma&&!this.Yz.contains(Ma.topLeft)}Vvb(Ma){this.tableRange=
this.Yz;this.Jn=1;const Tb=!this.eu;Ma?(this.tx(!1),this.Mh=this.Dq?[11]:[12],this.gza(Tb),this.NI(Tb)):(this.l2(!1),this.ON(Tb),this.By(Tb))}Wvb(Ma){this.tableRange=null;this.Jn=2;const Tb=!this.eu;Ma?(this.tx(!1),this.Mh=this.Dq?[11]:[12],this.Eq=this.Dq,this.CPa(Tb),this.NI(Tb)):(this.aha(!1),this.ON(Tb),this.By(Tb))}jna(){if(!Ga.g(this.$).ha.sa.wg)return!1;const Ma=Ga.g(this.$).getRangeInformation(this.ha.sa.Wc);for(const Tb of Ma)if(Object(aa.a)(xa.PivotTableRange,Tb))return!1;return!0}mYc(Ma){if(Ma&&
Ma.contains(this.sourceRange)&&!Ma.equals(this.sourceRange)){if(Ma.yaa&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===Ma.top){const Tb=new ia.Range(this.sourceRange.top,this.sourceRange.left,Ma.bottom,this.sourceRange.right,!1,!1);if(!Tb.equals(Ma))return this.sourceRange=Tb,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),Ma}this.Uh?this.Dq=Ma.left===this.sourceRange.left&&Ma.right===this.sourceRange.right:this.isRow=Ma.left===this.sourceRange.left&&Ma.right===
this.sourceRange.right;if(Ma.top===this.sourceRange.top&&Ma.bottom===this.sourceRange.bottom||this.Yx())return Ma}return null}d2(Ma){const Tb=Ma.clone();this.Yx()?Tb.left=Math.max(Ma.left-this.Mcc,1):Tb.top=Math.max(Ma.top-this.EBc,1);Tb.right=Tb.left+this.sourceRange.width-1;Tb.bottom=Tb.top+this.sourceRange.height-1;return this.sYa(Tb)}Xyb(){const Ma=this.gb.topLeft.Dd(this.sourceRange);return Ma||this.Uh&&!this.tableRange?Ma:this.Yx()?this.gb.top===this.sourceRange.bottom+1:this.gb.left===this.sourceRange.right+
1}dGd(){if(this.Yx()&&this.gb.left!==this.tableRange.left||!this.Yx()&&this.gb.top!==this.tableRange.top){const Ma=mb.a.Yc(1,1,0,917,0,2065438552,"RearrangeInvalidDest");nc.a(this.$).vr([Ma]);return!0}return!1}CEd(){const Ma=this.$.Ib.Bc("UserAction","RearrangeRowColumnClientSide"),Tb={["CopyPasteTargetType"]:1,["OperationId"]:ca.a.create().toString(),["Stopwatch"]:Ma,["DragDropIsShiftKeyDown"]:this.eu,["EncounteredDeploymentErrors"]:!1},zb=this.du?2:1,ic=this.$.da.za(254);(new Promise((Qb,wb)=>{this.Usb(hc=>
{hc.Errors&&0<hc.Errors.length?wb(new ya.a(22,hc.Errors)):Qb(!0)},hc=>{hc=bb.a.lf(hc.data);wb(new ya.a(22,hc))})})).then(()=>{w.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');ic&&ic.Glf(Tb,zb,this.sourceRange,this.gb);return Promise.resolve(!0)},Qb=>{w.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${Qb?copyPasteInfra.getStringifiedError(Qb):"null"}, copyPasteTargetType="${1}"`);
return ic?ic.BAf(Qb,Tb,zb,this.sourceRange,this.gb):Promise.reject(Qb)})}Usb(Ma=null,Tb=null){const zb={};this.Yx()?(zb.FirstRow=this.gb.top-1,zb.FirstColumn=0,zb.DeltaColumn=0,zb.DeltaRow=this.gb.bottom-this.gb.top+1):(zb.FirstRow=0,zb.FirstColumn=this.gb.left-1,zb.DeltaColumn=this.gb.right-this.gb.left+1,zb.DeltaRow=0);zb.LastRow=W.a.Az;zb.LastColumn=W.a.rw;zb.SheetName=this.$.xa.pa?this.$.xa.pa.name:this.$.zb.getItemByName(this.$.zb.pa.name).sheetName;const ic=ib.v(this.sourceRange,this.$),Qb=
(hc,Za,ub)=>Kb(this.$.oa.va,ic,zb,Ma?Ca.b(hc,Ma):hc,Tb?Ca.a(Za,Tb):Za,ub,null),wb=()=>new cc(ic,zb);qa.EwaSettings.dc()?this.$.userOperationManager.Ub(new sa.a(514,0,Qb,64,wb),null):this.$.userOperationManager.Ub(new wa.a(514,0,Qb,void 0,wb),null)}aoa(Ma=0){0===Ma?this.du=!1:1===Ma&&(this.eu=!1);this.Uh&&(this.du||this.eu)||(ja.KeyInputManager.instance.Ba(u.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.l4=!1)}ON(Ma=!1){this.lh=5;this.Gw(this.Hh,this.Kf);this.sM=this.Xrb;this.fO=this.MKb;
this.Uz(this.Aw.clientPoint,this.Aw.Cb,this.haa(),!1,Ma)}CPa(Ma=!1){this.lh=6;this.Gw(this.C5,this.D5);this.sM=this.Oha;this.fO=this.gna;this.Uz(this.Aw.clientPoint,this.Aw.Cb,this.isRow||this.Dq?11:12,!0,Ma)}gza(Ma=!1){this.lh=6;this.Gw(this.FK,this.GK);this.sM=this.Oha;this.fO=this.gna;this.Uz(this.Aw.clientPoint,this.Aw.Cb,this.Yx()?11:12,!0,Ma)}Yx(){return!this.Uh&&this.isRow||this.Uh&&this.Dq}l2(Ma){this.lb.Mg(this.Mh);this.Ss(this.C5,this.D5,void 0,Ma)}Qsd(){const Ma=Ea.a.instance.Wb("Common.ISystemInitiatedFeedback");
Ma&&Ma.execute(Tb=>{Tb.logActivity("DragDrop",null)})}}Object(b.a)(ma,"DragSelectionClickBehaviorCellRangeAndTable",ua,[]);var fb=a(314),sb=a(145);class Ua extends ua{constructor(Ma,Tb,zb,ic,Qb){super(Ma,Tb,zb,ic,Qb);this.oOa=()=>{this.kp&&this.aha(!0);5===this.lh&&this.tx(!0)};this.GK=wb=>{O.a(this.$).Td(wb);this.kp=!1;this.lb.Mg(this.Mh);this.ha.sourceRange=this.sourceRange.clone();this.fgf?this.$.ud(927125067,M.a.Eb,30,null):this.D5a?(this.ZF(),this.ha.sourceRange=this.sourceRange.clone(),this.$.ud(-694765314,
2,30,{[x.a.u$]:!0,[x.a.cU]:this.ha.sourceRange,[x.a.bU]:this.ha.sa.Wc,[x.a.$Ha]:!1}),Ga.g(this.$).Df.Wl(x.a.jQ),this.D5a=!1):this.u0i();this.Ss(this.FK,this.GK);this.lh=-1;return!0};this.FK=wb=>{wb=O.a(this.$).Td(wb);const hc=wb.clientPoint;this.Aw=wb;let Za=this.ha.Vn(hc,wb.Cb,5,void 0,void 0,!0);if(Za){if(!this.Mod(Za))return this.g1h(wb),!0;this.Vcg(Za,this.isRow,hc);if(this.isRow||this.Ze)this.gb=this.d2(Za);this.ha.sourceRange=this.gb;this.lb.oi(this.gb,this.Mh);this.lb.zn(this.Mh);this.lb.Mg(this.bB());
this.xy()}return!0};this.onKeyDown=wb=>this.c4(wb)?(this.l4||(ja.KeyInputManager.instance.ra(u.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.l4=!0),this.D5a||(Ga.g(this.$).Df.Wl(Ba.$_a),this.D5a=!0),!0):!1;this.onKeyUp=wb=>{this.c4(wb)&&(ja.KeyInputManager.instance.Ba(u.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.l4=!1,this.kp?Ga.g(this.$).Df.Wl(Ba.cIa):Ga.g(this.$).Df.Wl(x.a.jQ),this.D5a=!1);return!0};this.hzf=wb=>{wb.Errors&&0<wb.Errors.length?(w.ULS.sendTraceTag(521410185,
0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${mb.a.yc(wb.Errors)}]`),this.gb.left=this.sourceRange.left,this.gb.right=this.sourceRange.right,this.gb.top=this.sourceRange.top,this.gb.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.gb.top&&this.sourceRange.bottom>=this.gb.top-1?(this.gb.top=this.sourceRange.top,this.gb.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.gb.top||(this.gb.top-=this.sourceRange.height),this.gb.bottom=this.gb.top+
this.sourceRange.height-1):this.sourceRange.left<=this.gb.left&&this.sourceRange.right>=this.gb.left-1?(this.gb.left=this.sourceRange.left,this.gb.right=this.sourceRange.right):(this.sourceRange.left>this.gb.left||(this.gb.left-=this.sourceRange.width),this.gb.right=this.gb.left+this.sourceRange.width-1);this.ZF();this.lh=-1};this.gzf=wb=>{wb=bb.a.lf(wb.data);w.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${mb.a.yc(wb)}]`)};this.ha.EYb(this.oOa);
this.D5a=this.l4=!1}Umc(Ma){this.Aw=Ma;this.isRow=this.Ze=!1;this.kp=!0;ja.KeyInputManager.instance.ra(u.a.Kb,this.domElement.ownerDocument.body,this.onKeyDown);(this.kc=this.tableManager.eja(this.sourceRange))||w.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",this.sourceRange);this.fgf=(new sb.a(this.$.xa)).li;Ga.g(this.$);Ga.g(this.$).Df.Wl(Ba.cIa);this.Mod(this.gb)?(this.isRow=this.Yki(),this.Ze=this.$ei(),this.isRow||
this.Ze?(this.m6a=!1,this.gza(Ma),this.gb=this.d2(this.gb),this.NI()):(this.m6a=!0,this.ON(Ma),this.By())):(this.m6a=!0,this.ON(Ma),this.By())}hya(){return this.fgf?(this.$.ud(927125067,M.a.Eb,30,null),this.tx(!0),this.m6a=!1,this.lh=-1,!0):this.D5a?(this.ZF(),this.ha.sourceRange=this.sourceRange.clone(),this.$.ud(-694765314,2,30,{[x.a.u$]:!0,[x.a.cU]:this.ha.sourceRange,[x.a.bU]:this.ha.sa.Wc,[x.a.$Ha]:!1}),Ga.g(this.$).Df.Wl(x.a.jQ),this.tx(!0),this.kp=this.m6a=!1,this.lh=-1,!0):5===this.lh?(this.tx(!0),
this.m6a=!1,this.gzj(),this.lh=-1,!0):!1}Xmc(Ma){const Tb=this.ha.Vn(Ma.clientPoint,Ma.Cb,5,void 0,void 0,!0);this.Aw=Ma;return this.m6a?!1:this.Mod(Tb)?(this.h1h(Ma),!0):!1}xy(){let Ma=new ia.Range(this.gb.top,this.gb.left,this.gb.bottom,this.gb.right,!1,!0);6===this.lh&&(this.isRow?(--Ma.top,Ma.bottom=Ma.top+this.gb.height-1):(--Ma.left,Ma.right=Ma.left+this.gb.width-1));for(let Tb=1;4>=Tb;Tb++)this.Oh[Tb.toString()].childNodes[0].innerText=Ma.toString()}jna(){if(!Ga.g(this.$).ha.sa.wg)return!1;
var Ma=Ga.g(this.$).getRangeInformation(this.ha.sa.Wc);for(var Tb of Ma)if(Object(aa.a)(xa.PivotTableRange,Tb)&&(Ma=this.tableManager.eja(Tb)))return Tb=!Ma.isOlap||!Ma.rMa(!0),w.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",Ma),Ma.isActionable&&Tb;return!1}d2(Ma){Ma=Ma.clone();this.isRow?(Ma.left=this.sourceRange.left,Ma.right=this.kc.right,Ma.bottom=Ma.top+this.sourceRange.height-1):this.Ze?(Ma.top=this.sourceRange.top,
Ma.bottom=this.kc.ZK.bottom,Ma.right=Ma.left+this.sourceRange.width-1):w.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.sYa(Ma)}u0i(){const Ma={},Tb=ib.v(this.sourceRange,this.$);Ga.g(this.$).getRangeInformation(this.gb);if(this.isRow){Tb.FirstColumn=Ma.FirstColumn=this.gb.left-1;Tb.LastColumn=Ma.LastColumn=this.gb.right-1;if(this.sourceRange.top<=this.gb.top&&this.sourceRange.bottom>=this.gb.top-1){w.ULS.sendTraceTag(520176345,
0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.gb.top?Ma.LastRow=Ma.FirstRow=this.gb.top-1:(Ma.FirstRow=this.gb.top-this.sourceRange.height-1,Ma.LastRow=Ma.FirstRow+this.sourceRange.height-1)}else{Ma.FirstRow=this.gb.top;Ma.LastRow=this.gb.bottom-1;if(this.sourceRange.left<=this.gb.left&&this.sourceRange.right>=this.gb.left-1){w.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}Ma.LastColumn=
this.sourceRange.left>this.gb.left?Ma.FirstColumn=this.gb.left-1:Ma.FirstColumn=this.gb.left-this.sourceRange.width-1}const zb={};zb.SheetName=this.$.xa.pa?this.$.xa.pa.name:this.$.zb.getItemByName(this.$.zb.pa.name).sheetName;zb.Ranges=Array(2);zb.Ranges[0]=Tb;zb.Ranges[1]=Ma;this.rwh(zb)}rwh(Ma){const Tb=(zb,ic,Qb)=>rb(this.$.oa.va,Ma,this.hzf?Ca.b(zb,this.hzf):zb,this.gzf?Ca.a(ic,this.gzf):ic,Qb,null);qa.EwaSettings.dc()?this.$.userOperationManager.Ub(new sa.a(265,0,Tb,64),null):this.$.userOperationManager.Ub(new wa.a(265,
0,Tb,void 0),null)}Mod(Ma){return null!==this.kc&&(null===this.kc.ZK||Ma.left>=this.kc.ZK.left)&&(null===this.kc.AE||Ma.right<=this.kc.AE.right)&&(null===this.kc.AE||Ma.top>=this.kc.AE.top)&&(null===this.kc.ZK||Ma.bottom<=this.kc.ZK.bottom)}Yki(){return null!==this.kc&&null!==this.kc.ZK&&this.kc.ZK.top<=this.gb.top&&this.kc.ZK.left<=this.gb.left&&this.kc.ZK.right>=this.gb.left}$ei(){return null!==this.kc&&null!==this.kc.AE&&this.kc.AE.top===this.gb.top&&this.kc.AE.left<=this.gb.left&&this.kc.AE.right>=
this.gb.right}gza(Ma){this.lh=6;this.Mh=this.isRow?[11]:[12];this.Gw(this.FK,this.GK);this.Uz(Ma.clientPoint,Ma.Cb,this.isRow?11:12,!0,!1)}ON(Ma){this.lh=5;this.Gw(this.Hh,this.Kf);this.Uz(Ma.clientPoint,Ma.Cb,this.haa(),!1,!1)}h1h(Ma){this.tx(!1);this.gza(Ma);this.gb=this.d2(this.gb);this.NI()}g1h(Ma){this.aha(!1);this.ON(Ma);this.By()}gzj(){if(!this.Oaa(this.gb)){var Ma=mb.a.Yc(1,0,907,906,0,2069074184,"PivotTableInvalidMove");Ma.HelpTopicId=fb.a.NCj;Ma.HelpDescription=ta.a.instance.ga(912);nc.a(this.$).vr([Ma])}}}
Object(b.a)(Ua,"DragSelectionClickBehaviorPivotTableRange",ua,[]);var ab=a(369);class na extends Pa{constructor(Ma,Tb){super(Ma);this.yg=()=>{this.domElement.classList.remove(Z.selecting);ab.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.yp=()=>{this.domElement.classList.add(Z.selecting)};this.onPointerDown=zb=>{2===zb.tb&&zb.Tn===Sys.UI.MouseButton.leftButton&&(this.gridView.ha.selectionType=4,this.gridView.ha.sourceRange=this.gridView.ha.sa.Wc,ab.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));
return!1};this.Wba=()=>{this.gridView.$.ud(1983983164,2,30,null);return!0};this.$c=()=>{z.DOMElementExtensions.setVisible(this.Q$,this.gridView.$.isEditMode)};this.L5=()=>{z.DOMElementExtensions.setVisible(this.Q$,!1)};this.K5=()=>{z.DOMElementExtensions.setVisible(this.Q$,!0)};this.pxf=()=>{z.DOMElementExtensions.setVisible(this.Q$,!1)};this.oxf=()=>{z.DOMElementExtensions.setVisible(this.Q$,!0)};this.FDb=(zb,ic)=>{z.DOMElementExtensions.setVisible(this.Q$,!ic.mje)};this.gridView=Tb;Tb=document.createElement("div");
Tb.className=da.a.Ruh;this.Q$=Tb;this.$c(null,null);Ma.appendChild(Tb);r.a.instance.ra(u.a.pointerDown,this.Q$,this.onPointerDown);K.a.instance.ra(u.a.qk,this.Q$,this.Wba);this.gridView.ha.N1(this.yp);this.gridView.ha.IX(this.yg);this.gridView.$.el(this.$c);this.gridView.$.rb.MYb(this.L5);this.gridView.$.rb.LYb(this.K5);this.gridView.Ple(this.FDb);this.gridView.hc.Nk(this.pxf);this.gridView.hc.em(this.oxf)}dispose(){r.a.instance.Ba(u.a.pointerDown,this.Q$,this.onPointerDown);K.a.instance.Ba(u.a.qk,
this.Q$,this.Wba);this.gridView.$&&(this.gridView.ha.m6(this.yp),this.gridView.ha.RV(this.yg),this.gridView.$.Al(this.$c),this.gridView.$.rb.Trc(this.L5),this.gridView.$.rb.Rrc(this.K5),this.gridView.rPf(this.FDb),this.gridView.hc.tk(this.pxf),this.gridView.hc.yl(this.oxf));super.dispose()}}Object(b.a)(na,"FillHandleClickBehavior",Pa,[]);class Na extends H{constructor(Ma,Tb){super(Ma);this.EQi=zb=>{const ic=G.HelperMethods.Qn(zb);var Qb=this.hva.hZd(zb.clientPoint);if(!Qb)return!1;var wb=Qb.Fe,hc=
this.hva.Ea.Qub(wb.hashCode).Bua(Qb.OI);if(!hc)return!1;zb=wb.rj.domElement;Qb=G.HelperMethods.Uke(G.HelperMethods.lvb(wb.domElement,zb),Qb.OI);wb=0;hc=this.hva.Vb(hc.getRange());for(let ub=0,uc=Na.hwe.length;ub<uc;++ub){const Oc=Na.hwe[ub];if((128===Oc||64===Oc)&&this.hva.$.isEditMode)continue;var Za=hc.KJa(Oc);if(!Za||!Za.l5a||"none"===Za.l5a.style.display)continue;Za=Za.l5a;const Bb=G.HelperMethods.lvb(Za,zb);Za=new Sys.UI.Bounds(Bb.x,Bb.y,Za.offsetWidth,Za.offsetHeight);if(X.a.XM(Za,Qb)){wb=Oc;
break}}return 0!==wb?(hc.invoke(wb,ic),!0):!1};this.hpg=Tb;K.a.instance.ra(u.a.click,Ma,this.EQi)}get hva(){return this.hpg}}Na.hwe=[1,2,32,256,128,64];Object(b.a)(Na,"IPadSelectionClickThroughBehavior",H,[]);var Va=a(22);class Sa{constructor(Ma){this.Z7e=Tb=>{this.wAc(Tb.Cb,1);return!0};this.$7e=Tb=>{this.wAc(Tb.Cb,-1);return!0};this.yg=()=>{this.tnd=!1};this.yp=()=>{this.tnd=!0};this.gridView=Ma;this.M4a=0;this.tnd=this.wfc=!1;this.N4=Number.NaN;this.gridView.ha.N1(this.yp);this.gridView.ha.IX(this.yg);
this.gridView.ha.EYb(this.yg)}dispose(){this.gridView.ha.m6(this.yp);this.gridView.ha.RV(this.yg);this.gridView.ha.KId(this.yg)}vza(){this.M4a=0;this.wfc=!1;this.N4=Number.NaN}qIe(Ma){this.wfc=!0;this.wAc(Ma,1)}rIe(Ma){this.wfc=!1;this.wAc(Ma,-1)}wAc(Ma,Tb){if(Ma)if(Ma.parentNode)if(this.tnd)isNaN(this.N4)||(this.KAc(this.N4,!1),this.N4=Number.NaN);else if(Ma=parseInt(Ma.parentNode.getAttribute(x.a.c5a),10),isNaN(Ma))w.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");
else{if(!isNaN(this.N4)&&Ma!==this.N4){if(this.wfc)return;this.KAc(this.N4,!1)}if(isNaN(this.N4)||Ma!==this.N4)this.N4=Ma,this.M4a=0;!this.M4a&&0<Tb&&this.KAc(Ma,!0);this.M4a=Math.max(this.M4a+Tb,0);!this.M4a&&0>Tb&&(this.KAc(Ma,!1),this.N4=Number.NaN)}else w.ULS.shipAssertTag(537159367,0,!!Ma.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else w.ULS.shipAssertTag(537159368,0,!!Ma,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}KAc(Ma,Tb){for(let ic=
1;4>=ic;ic++){var zb=this.gridView.lb.dv(3,ic,Ma).uf;z.DOMElementExtensions.toggleCssClass(zb,Z.nuh,Tb);for(zb=zb.firstChild;zb;zb=zb.nextSibling)Va.a.contains(zb.className,"resizemarqueehandle",!0)&&z.DOMElementExtensions.toggleCssClass(zb,Z.ruh,Tb)}}}Object(b.a)(Sa,"MarqueeHoveringManager",null,[]);var vb=a(188),Oa=a(84),yb=a(817),Ob=a(1229);class Ja extends H{constructor(Ma,Tb){super(Ma);this.Vmc=()=>{if(!this.fv)return w.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),
!1;this.fv.CKf(this.zH,!1);this.fv.gKe(this.zH,!1);if(3===this.fv.model.state)return!0;this.fv.W7e(!0);return!0};this.b_=()=>{if(!this.fv)return!1;this.fv.v2i();this.fv.lKd(this.zH,!1);if(3===this.fv.model.state)return!0;this.fv.W7e(!1);return!0};this.onPointerDown=zb=>this.fv?2===zb.tb&&zb.Tn===Sys.UI.MouseButton.leftButton?!0:!1:!1;this.dEb=()=>{if(!this.fv)return!1;this.fv.lKd(this.zH,!0);this.fv.CKf(this.zH,!0);this.fv.gKe(this.zH,!0);this.fv.tJb(!0);return!0};this.onDoubleClick=zb=>{if(zb.Ca)return zb.Ca.stopPropagation(),
!0;w.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};this.fv=Object(Oa.a)(Ob.a,Tb.metadata);this.gK=document.createElement("div");this.gK.id=`${Ma.id}-${x.a.Yve}`;this.gK.className=yb.a.OUg;this.zH=document.createElement("div");this.zH.id=`${Ma.id}-${x.a.eZc}`;this.zH.className=yb.a.eZc;this.gK.appendChild(this.zH);Ma.appendChild(this.gK);w.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");
r.a.instance.ra(u.a.yV,this.gK,this.Vmc);r.a.instance.ra(u.a.ky,this.gK,this.b_);r.a.instance.ra(u.a.pointerDown,this.gK,this.onPointerDown);vb.a.instance.ra(u.a.click,this.gK,this.dEb);vb.a.instance.ra(u.a.qk,this.gK,this.onDoubleClick)}dispose(){r.a.instance.Ba(u.a.yV,this.gK,this.Vmc);r.a.instance.Ba(u.a.ky,this.gK,this.b_);r.a.instance.Ba(u.a.pointerDown,this.gK,this.onPointerDown);vb.a.instance.Ba(u.a.click,this.gK,this.dEb);vb.a.instance.Ba(u.a.qk,this.gK,this.onDoubleClick);z.DOMElementExtensions.pf(this.zH);
this.zH=null;z.DOMElementExtensions.pf(this.gK);this.fv=this.gK=null;super.dispose()}rYa(Ma){this.fv=Object(Oa.a)(Ob.a,Ma.metadata)}}Object(b.a)(Ja,"RangeCatchUpActivityHighlightBehavior",H,[]);class lb extends R{constructor(Ma,Tb,zb,ic){super(Ma,Tb,zb,ic)}get S3(){return 16}get Ubb(){return this.gridView.ha.rangePicker.Abd(!1)}DRa(){return(this.gridView.inRangePicker||this.gridView.xi)&&super.DRa()}}Object(b.a)(lb,"RangePickerTouchGrippiesBehavior",R,[]);class Pb extends H{constructor(Ma,Tb){super(Ma);
const zb=document.createElement("div"),ic=document.createElement("div");zb.className=Tb?Z.Zuh:Z.avh;ic.className=Tb?Z.$uh:Z.Yuh;Ma.appendChild(zb);Ma.appendChild(ic)}}Object(b.a)(Pb,"RearrangeHighlightBehavior",H,[]);var Jb;(function(Ma){Ma[Ma.topLeft=0]="topLeft";Ma[Ma.topRight=1]="topRight";Ma[Ma.bottomLeft=2]="bottomLeft";Ma[Ma.bottomRight=3]="bottomRight";Ma[Ma.error=4]="error"})(Jb||(Jb={}));Object(b.b)("Corner",Jb);class Lb extends H{constructor(Ma,Tb,zb,ic,Qb){super(Ma);this.Ya=this.WF=null;
this.D2=0;this.gb=this.sourceRange=null;this.mSa=!1;this.onPointerDown=wb=>{wb=O.a(this.$).Td(wb);if(this.l1f(wb)&&!this.mSa){this.Wlf();this.Ya=this.io.D9b();this.WF=this.io.b1e(wb);if(!this.Ya||!this.WF||!this.WF.range)return w.ULS.shipAssertTag(537159361,0,!!this.Ya,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),w.ULS.shipAssertTag(537159360,0,!!this.WF,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),w.ULS.shipAssertTag(537159331,0,!!this.WF.range,
"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.gb=this.WF.range.clone();this.sourceRange=this.gb.clone();this.D2=this.UXe(wb);if(4===this.D2)return w.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const hc=this.LZe(wb,!0);if(!hc)return w.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!this.eDe(hc))return w.ULS.shipAssertTag(537159328,
0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.gridView.ZKa=!0;this.Ya.rC(!1);this.AF.qIe(wb.Cb);this.io.kKf(!0,this.Baa.xT);this.Ya.textBox.removeSelection();this.Ya.nYb(this.I4e);this.ANf();this.mSa=!0;Ra.b(this.$,!0)}return!0};this.Hh=wb=>{wb=O.a(this.$).Td(wb);wb=this.LZe(wb,!1);if(!wb)return!0;wb=this.eDe(wb);if(!wb)return w.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.z8b(!0),!1;if(this.gb.equals(wb))return!0;
this.gb=wb;wb=this.By();wb||(w.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.z8b(!0));return wb};this.Kf=wb=>{O.a(this.$).Td(wb);wb=this.ZF();w.ULS.shipAssertTag(537159325,0,wb,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.z8b(!wb);return wb};this.I4e=()=>{this.z8b(!0)};this.gridView=Tb;this.$=Tb.$;this.XK=[];this.ha=this.gridView.ha;this.AF=zb;this.io=ic;this.Baa=Qb;this.coloredReferencesManager=this.$.da.za(281);
w.ULS.shipAssertTag(537159362,0,!!this.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.rz=I.a.rz(this.$))Tb=this.$.da.za(464),w.ULS.shipAssertTag(0,0,!!Tb,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.ez=Tb.ez;for(const wb of this.KSf())Tb=this.io.oCe(Ma,wb,this.Bne(),this.onPointerDown),this.XK.push(Tb);
for(const wb of this.XK)r.a.instance.ra(u.a.yV,wb,this.AF.Z7e),r.a.instance.ra(u.a.ky,wb,this.AF.$7e);this.rYa(Qb)}dispose(){this.XK.forEach(Ma=>{r.a.instance.Ba(u.a.pointerDown,Ma,this.onPointerDown)});this.XK.length=0;super.dispose()}rYa(Ma){this.Baa=Ma;this.Kne(Ma);this.io.pKb(Ma,this.XK,this.tQd());this.AF.vza()}LZe(Ma,Tb){const zb=Ma.Cb;Ma=Ma.clientPoint;if(!zb||!Ma)return w.ULS.shipAssertTag(537159324,0,!!zb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),w.ULS.shipAssertTag(537159323,
0,!!Ma,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;Tb&&(Ma=this.eqf(Ma));Tb=this.ha.Vn(Ma,zb,0,!0,!1,!0);Tb||(Ma=this.eqf(Ma),Tb=this.ha.Vn(Ma,zb,0,!0,!1,!0));return Tb}eqf(Ma){Ma.y+=0===this.D2||1===this.D2?2:-2;Ma.x+=0===this.D2||2===this.D2?2:-2;return Ma}eDe(Ma){if(!Ma||!this.sourceRange)return w.ULS.shipAssertTag(537159322,0,!!Ma,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),w.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),
null;if(0===this.D2)return new ia.Range(Ma.top,Ma.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.D2)return new ia.Range(Ma.top,this.sourceRange.left,this.sourceRange.bottom,Ma.right,!0,!1);if(2===this.D2)return new ia.Range(this.sourceRange.top,Ma.left,Ma.bottom,this.sourceRange.right,!0,!1);if(3===this.D2)return new ia.Range(this.sourceRange.top,this.sourceRange.left,Ma.bottom,Ma.right,!0,!1);w.ULS.shipAssertTag(537159320,0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${Jb[this.D2]}`);
return null}ZF(){return this.rz?this.ez.uCb(this.Ya,this.WF,this.gb):this.coloredReferencesManager.uCb(this.Ya,this.WF,this.gb)}By(){return this.ZF()}z8b(Ma){Ma&&w.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.AF.rIe(this.XK[0]);this.io.kKf(!1,this.Baa.xT);this.Ya.textBox.setCaretPositionToEnd();this.Ya.Arc(this.I4e);this.lbg();this.mSa=this.gridView.ZKa=!1;Ra.b(this.$,!1);this.io.aMf()}}
Object(b.a)(Lb,"ResizeMarqueeBehaviorBase",H,[]);class Ab extends Lb{constructor(Ma,Tb,zb,ic,Qb){super(Ma,Tb,zb,ic,Qb)}KSf(){return[Z.evh,Z.fvh,Z.cvh,Z.dvh]}Bne(){return[Z.bvh]}UXe(Ma){Ma=Ma.Cb;if(Ma===this.XK[0])return 0;if(Ma===this.XK[1])return 1;if(Ma===this.XK[2])return 2;if(Ma===this.XK[3])return 3;w.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}ANf(){this.io.Gw(this.Hh,this.Kf,!0)}lbg(){this.io.XWd(this.Hh,this.Kf,
!0)}l1f(Ma){return 2===(M.a.Eb=Ma.tb)&&Ma.Tn===Sys.UI.MouseButton.leftButton}tQd(){return!0}Wlf(){w.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}Kne(Ma){for(const Tb of this.XK)Tb.style.backgroundColor=Ma.uf.style.borderColor}}Object(b.a)(Ab,"ResizeMarqueeMouseBehavior",Lb,[]);class nb extends Lb{constructor(Ma,Tb,zb,ic,Qb){super(Ma,Tb,zb,ic,Qb);this.ZDb=()=>{const wb=3===M.a.Eb;this.nrd&&!wb?this.io.pKb(this.Baa,this.XK,
!1):!this.nrd&&wb&&this.io.pKb(this.Baa,this.XK,!0);this.nrd=wb};this.KPi=(wb,hc)=>{hc.c5a===this.Baa.xT&&this.io.pKb(this.Baa,this.XK,!hc.start&&this.tQd())};M.a.vme(this.ZDb);this.nrd=3===M.a.Eb;this.io.kFg(this.KPi)}dispose(){M.a.SPf(this.ZDb);super.dispose()}KSf(){return[da.a.guh,da.a.fuh]}Bne(){const Ma=!qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return[Ma?da.a.nPe:da.a.mPe,da.a.x7b,Ma?da.a.euh:da.a.w7b]}UXe(Ma){Ma=Ma.Cb;if(Ma===this.XK[0])return 0;if(Ma===this.XK[1])return 3;
w.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}ANf(){v.a.kv?this.io.Gw(this.Hh,this.Kf,!1):this.io.D7i(this.Hh,this.Kf)}lbg(){v.a.kv?this.io.XWd(this.Hh,this.Kf,!1):this.io.SOj(this.Hh,this.Kf)}l1f(Ma){return 3===(M.a.Eb=Ma.tb)}tQd(){return 3===M.a.Eb}Wlf(){w.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}Kne(){}}Object(b.a)(nb,"ResizeMarqueeTouchBehavior",
Lb,[]);class va extends H{constructor(Ma,Tb){super(Ma);va.xqb(Ma,D.a.wuh+" "+da.a.Tta,null===Tb||void 0===Tb?void 0:Tb.horizontal);va.xqb(Ma,D.a.vuh+" "+da.a.Tta,null===Tb||void 0===Tb?void 0:Tb.vertical);va.xqb(Ma,D.a.suh+" "+da.a.Tta,null===Tb||void 0===Tb?void 0:Tb.horizontal);va.xqb(Ma,D.a.uuh+" "+da.a.Tta,null===Tb||void 0===Tb?void 0:Tb.vertical);va.xqb(Ma,da.a.tuh)}static xqb(Ma,Tb,zb){const ic=document.createElement("div");ic.className=Tb;zb&&(ic.style.backgroundImage=`url("${zb}")`);Ma.appendChild(ic)}}
Object(b.a)(va,"SelectionCutCopyBehavior",H,[]);class db extends H{constructor(Ma){super(Ma);appChrome.renderSpinner(Ma)}}Object(b.a)(db,"SelectionPasteBehavior",H,[]);class Xa extends H{constructor(Ma,Tb){super(Ma);Xa.Nqb(Ma,D.a.Xuh+" "+da.a.Tta,null===Tb||void 0===Tb?void 0:Tb.horizontal);Xa.Nqb(Ma,D.a.Wuh+" "+da.a.Tta,null===Tb||void 0===Tb?void 0:Tb.vertical);Xa.Nqb(Ma,D.a.Tuh+" "+da.a.Tta,null===Tb||void 0===Tb?void 0:Tb.horizontal);Xa.Nqb(Ma,D.a.Vuh+" "+da.a.Tta,null===Tb||void 0===Tb?void 0:
Tb.vertical);Xa.Nqb(Ma,da.a.Uuh)}static Nqb(Ma,Tb,zb){const ic=document.createElement("div");ic.className=Tb;zb&&(ic.style.backgroundImage=`url("${zb}")`);Ma.appendChild(ic)}}Object(b.a)(Xa,"SelectionRangePickerBehavior",H,[]);class gb extends R{constructor(Ma,Tb,zb,ic){super(Ma,Tb,zb,ic)}get S3(){return 0}get Ubb(){return this.gridView.ha.sa.Wc}DRa(){const Ma=this.gridView.xi||this.gridView.eb;return this.gridView.ha.sa.wg&&!Ma&&super.DRa()}}Object(b.a)(gb,"SelectionTouchGrippiesBehavior",R,[]);
var Ha=a(54);class tb extends n.a{constructor(Ma,Tb){super();this.Mnb=(zb,ic)=>{zb=ic.S3;const Qb=this.gridView;ic=ic.Y5h;const wb=ic.uf,hc=ic.y9;v.a.Ug&&hc.push(new Na(wb,Qb));switch(zb){case 24:ic.y9.push(new Ja(wb,ic));break;case 0:ic.y9.push(new na(wb,Qb));v.a.np||(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6170982_UseDragSelectionClickBehaviorTableRange")?(hc.push(new ma(wb,this.gridView.$,ic.paneType,this.tableManager,this.io)),qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",
!1)&&hc.push(new Ua(wb,this.gridView.$,ic.paneType,this.tableManager,this.io))):hc.push(new Wb(wb,this.gridView.$,ic.paneType,this.tableManager,this.io)));hc.push(new gb(ic,wb,Qb,ic.paneType));break;case 3:hc.push(new Pa(wb));v.a.np||(hc.push(new fa(wb,this.gridView.$,ic.paneType,this.AF,this.io,ic)),hc.push(new Ab(wb,this.gridView,this.AF,this.io,ic)),hc.push(new nb(wb,this.gridView,this.AF,this.io,ic)));break;case 4:case 5:hc.push(new va(wb,this.Toe));break;case 30:hc.push(new db(wb));break;case 16:hc.push(new Xa(wb,
this.Toe));hc.push(new lb(ic,wb,Qb,ic.paneType));break;case 11:case 12:hc.push(new Pb(wb,11===zb));break;case 17:hc.push(new Pa(wb));break;case 19:hc.push(new Pa(wb)),hc.push(new oa(ic,wb,Qb,ic.paneType))}ic.q_b=!0};this.$=Ma;this.gridView=Ga.g(Ma);this.tableManager=Tb;this.AF=new Sa(this.gridView);this.io=new F(this.gridView);this.gridView.lb&&(this.gridView.lb.HEg(this.Mnb),this.gridView.lb.update(!1));Ma.da.Ga(64,this)}get Toe(){qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&
!this.Soe&&(this.Soe={vertical:Ha.a.current.Rn(105),horizontal:Ha.a.current.Rn(106)});return this.Soe}dispose(){this.gridView.lb.Naj(this.Mnb);this.AF&&(this.AF.dispose(),this.AF=null);super.dispose()}}Object(b.a)(tb,"GridHighlightsBehaviorManager",n.a,[]);class bc extends d.a{constructor(Ma){super();this.$=Ma;this.Fb()}create(){m.TaskExtensions.Aa(l.GetServiceTaskFactory.create(this.$.da,134,this.la,this.hb),Ma=>{this.qb(this.$.da.za(64)||new tb(this.$,Ma.result))},this.la,3)}static ka(Ma){Ma.da.Ga(149,
new bc(Ma))}}Object(b.a)(bc,"GridHighlightsBehaviorManagerFactory",d.a,[]);a.d(C,"a",function(){return tc});const tc=()=>{c.a.Fa(bc.ka);c.a.Fa(k.ka)}},1142:function(t,C,a){var c=a(10);t=a(0);var b=a(691),d=a(50),f=a(37),e=a(182),k=a(55);class l{constructor(Ha){this.Dhh=Ha}Nc(){return!1}executeCommand(Ha,tb){Ha=tb.command;tb=null;switch(Ha){case 1243860697:this.Dhh.gKj();break;default:tb=e.a(Ha)}return tb||k.Task.Ta(!0)}Cc(Ha,tb){return 1243860697===tb.command}Rc(){return!1}}Object(t.a)(l,"SheetDropdownMenuCommandHandler",
null,[195]);class m extends b.a{constructor(Ha){super(Ha)}yd(){this.$.Qx(Ha=>{Ha.qdc().then(()=>{f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ra(this.$.da,32,33,this.hb),tb=>{this.gd([new l(tb.result.Suj)])},this.$.la)})})}static ka(Ha){b.a.Nd(392,new m(Ha))}}Object(t.a)(m,"SheetDropdownMenuCommandHandlerFactory",b.a,[]);var v=a(221),n=a(5),w=a(74),r=a(33),u=a(1),y=a(15),x=a(27),B=a(188),z=a(13),A=a(86),I=a(44),F=a(236),U=a(154),X=a(108),S=a(39),H=a(412),D=a(84),J=a(14),M=a(35);class G{constructor(){this.YGe=
new M.a(!0);this.nGc=0}get t5c(){return this.nGc}get navigationButtonsDisabled(){return!!(this.t5c&1)}get operationButtonsDisabled(){return!!(this.t5c&2)}aKg(Ha,tb){this.YGe.add(Ha,tb);this.ZR()}ZR(){this.nGc=0;M.a.forEach(this.YGe.gu,Ha=>{this.nGc=this.t5c|Ha.value})}}Object(t.a)(G,"SheetTabBarDisabledStateManager",null,[]);var T=a(235),K=a(31);class L{}L.qrh="ewa-stb-uir";L.PMe="ewa-stb-drag";L.arh="ewa-stb-navarea";L.brh="ewa-stb-navarea-dimensions";L.drh="ewa-stb-navbutton";L.KT="cui-disabled";
L.crh="ewa-stb-navareaextra";L.Aha="cui-img-container";L.Vqh="ewa-stb-contentarea";L.QMe="ewa-stb-left-scrollable";L.aNe="ewa-stb-right-scrollable";L.orh="ewa-stb-tabarea";L.nrh="ewa-stb-sheettabmoveindicator";L.cNe="ewa-stb-tabs";L.QGj="tab-active";L.YGj="tab-inactive";L.XGj="tab-hover";L.prh="ewa-stb-tabs-ghost";L.SGj="tab-anchor-text";L.dark="dark";L.light="light";L.RGj="tab-active-text";L.VGj="tab-content-container";L.$Gj="tab-text";L.grh="ewa-stb-nsv-inactive";L.hrh="ewa-stb-nsv-inactive-svg";
L.erh="ewa-stb-nsv-active";L.frh="ewa-stb-nsv-active-svg";L.Kph="ewa_nsv_margin";L.Wqh="ewa-stb-disable-scrollbar";L.Oqi="leave-size-fixed-on-tab-hover-old";L.Nqi="leave-size-fixed-on-tab-hover";L.UMe="ewa-stb-locked-sheet";L.VMe="ewa-stb-locked-sheet-svg-16px";L.Xqh="ewa-stb-dropdown-menu-button";L.Klh="ewa-active-sheet-menu-item";Object(t.a)(L,"CssClassNames",null,[]);var V=a(553),W=a(19),da=a(258),qa=a(102),O=a(513),ea=a(170),R=a(245),oa=a(45),pa=a(284),Pa=a(54),Z=a(12),Ra=a(71),Ga=a(313),Ba=a(11),
fa=a(100),Y=a(342),ja=a(21),ca=a(189),aa=a(369),ta=a(366),xa=a(42),ia=a(222),ya=a(85);class ib extends T.a{constructor(Ha,tb,bc=!1){super(Ha);this.D$a=this.Vra=null;this.$=tb;this.ZW=bc}get disabled(){return this.ZW}dispose(){this.D$a=this.Vra=this.$=null;super.dispose()}yW(Ha){this.ZW=Ha;this.domElement.setAttribute(n.a.Era,Ha.toString());Z.DOMElementExtensions.toggleCssClass(this.domElement,V.a.KT,Ha)}}Object(t.a)(ib,"SheetBarButton",T.a,[]);var wa=a(709);class sa extends ib{constructor(Ha,tb,bc,
tc=!1){super(document.createElement("a"),tb,tc);this.ed=Ma=>{this.disabled||this.$.ud(-1935155518,Ma.tb,30,null);return!0};this.fEb=Ma=>{Ma="mouseover"===Ma.type||"focus"===Ma.type;const Tb=aa.a(this.$)?this.D$a:this.Vra;Ba.HelperMethods.eVd(Tb,this.Pga,this.Pga+n.a.Tcc,Ma&&!ja.g(this.$).inRangePicker)};this.nh=()=>{this.yW(!0)};this.Jf=()=>{this.yW(!1)};this.Pga=u.EwaSettings.ma(500)?W.a.o8c:W.a.LNe;this.Vra=bc.pb(this.domElement,J.a.instance.ga(514),0,this.Pga,J.a.instance.ga(515),wa.a.G0c,tc);
Ha.appendChild(this.domElement);this.Gc.ka("contextmenu",Ma=>{Ra.g(Ma)});u.EwaSettings.ma(500)||(this.Gc.ka("mouseover",this.fEb),this.Gc.ka("mouseout",this.fEb));ia.a.instance.ra(z.a.click,this.domElement,this.ed);this.xMa=X.KeyInputManager.instance.ms(this.domElement,this.ed,ya.a.$h,ya.a.A0);ja.g(this.$).hc.Nk(this.nh);ja.g(this.$).hc.em(this.Jf)}dispose(){ia.a.instance.Ba(z.a.click,this.domElement,this.ed);X.KeyInputManager.instance.Bv(this.domElement,this.xMa);ja.g(this.$)&&ja.g(this.$).hc&&(ja.g(this.$).hc.tk(this.nh),
ja.g(this.$).hc.yl(this.Jf));super.dispose()}yW(Ha){const tb=sa.j1f(this.$);super.yW(Ha||tb)}static j1f(Ha){return!Ha.isEditMode||!Ha.xa.count}}Object(t.a)(sa,"InsertSheetButton",ib,[]);class Ya extends ib{constructor(Ha,tb,bc){super(document.createElement("a"),tb);this.ed=tc=>{this.$.ud(-684145703,tc.tb,0,null);return!0};this.fEb=tc=>{Ba.HelperMethods.eVd(this.Zte,this.Pga,this.Pga+n.a.Tcc,("mouseover"===tc.type||"focus"===tc.type)&&!ja.g(this.$).inRangePicker)};this.$=tb;this.Pga=u.EwaSettings.ma(500)?
W.a.o8c:W.a.LNe;this.Zte=bc.pb(this.domElement,J.a.instance.ga(516),0,this.Pga,J.a.instance.ga(517),wa.a.G0c);Ha.appendChild(this.domElement);this.Gc.ka("contextmenu",tc=>{Ra.g(tc)});this.Gc.ka("mouseover",this.fEb);this.Gc.ka("mouseout",this.fEb);ia.a.instance.ra(z.a.click,this.domElement,this.ed);this.xMa=X.KeyInputManager.instance.ms(this.domElement,this.ed,ya.a.$h,ya.a.A0)}dispose(){ia.a.instance.Ba(z.a.click,this.domElement,this.ed);X.KeyInputManager.instance.Bv(this.domElement,this.xMa);this.Zte=
null;super.dispose()}}Object(t.a)(Ya,"InsertTemplateButton",ib,[]);class bb{constructor(Ha,tb){this.sheetName=null;this.newSheetIndex=0;this.sheetName=Ha;this.newSheetIndex=tb}getSheetName(){return this.sheetName}}Object(t.a)(bb,"MacroRecorderSheetReorderedPayload",null,[101]);var mb=a(90);class Ca extends T.a{constructor(Ha,tb){super(document.createElement("div"));this.cR=()=>{y.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.RQf(!1,"OnSheetsChanged")};this.xIi=()=>{this.Bj()};
this.wIi=()=>{this.ek()};this.$=Ha;this.xHj=tb;this.nU=!1;this.TMb=0}dispose(){this.ek();super.dispose()}gKj(){this.RQf(!0,"TogglerSheetDropdownMenu")}RQf(Ha,tb){y.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${tb}, toggle: ${Ha}, toggleStateId: ${this.TMb}`);Ha&&(this.TMb+=1);const bc=this.$.Ib.Bc("UserAction",`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${tb}, toggle: ${Ha}, toggleStateId: ${this.TMb}, sheetCount: ${this.$.xa.count}`);
Ha=this.t9g();appChrome.renderSheetDropdownMenu(this.domElement,this.xHj,Ha,this.TMb,this.xIi,this.wIi,()=>{bc.stop()},aa.a(this.$))}t9g(){const Ha=this.$.xa,tb=[];for(let tc=0;tc<Ha.count;tc++){var bc=Object(D.a)(fa.a,Ha.getItem(tc));0===bc.Wz&&(bc=this.s9g(bc),tb.push(bc))}return tb}s9g(Ha){const tb={};tb.key=Ha.name;tb.text=Ha.name;tb.onClick=this.u9g(Ha);Ha.active&&(tb.className=aa.a(this.$)?"ewa-active-sheet-menu-item-present-mode":L.Klh);return tb}u9g(Ha){return()=>{const tb=new mb.a(-1876836819,
0,this.$.Mc,30,null);this.$.Ka.Mb(tb,{[n.a.BPd]:Ha.name})}}Bj(){if(!this.nU){const Ha=this.$.xa;Ha.Pf(this.cR);Ha.LTc(this.cR);Ha.HX(this.cR);Ha.lga(this.cR);Ha.gFa(this.cR);Ha.sme(this.cR);Ha.eYa(this.cR);this.nU=!0}}ek(){if(this.nU){const Ha=this.$.xa;Ha.zg(this.cR);Ha.gId(this.cR);Ha.l6(this.cR);Ha.pma(this.cR);Ha.PPa(this.cR);Ha.QPf(this.cR);Ha.KHb(this.cR);this.nU=!1}}}Object(t.a)(Ca,"SheetDropdownMenu",T.a,[466,2]);var $a=a(346);class Kb extends ib{constructor(Ha,tb,bc){super(document.createElement("a"),
Ha,!0);this.xg=()=>{this.yW(!1);this.$.ea.Wn(this.xg)};this.ed=tc=>{this.w9f(tc.tb);return!0};this.onKeyDown=tc=>13===tc.Ca.keyCode||32===tc.Ca.keyCode?(this.w9f(tc.tb),!0):!1;this.Vra=tb.pb(this.domElement,J.a.instance.ga(518),0,W.a.Uqh,J.a.instance.ga(518),wa.a.E0h,this.disabled);this.domElement.classList.add(L.Xqh);bc.appendChild(this.domElement);this.$.ea.El(this.xg);this.l7i()}dispose(){this.OOj();super.dispose()}yW(Ha){super.yW(Ha||!this.$.ea.$va)}w9f(Ha){this.disabled||(y.ULS.sendTraceTag(537153793,
0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${$a.a[Ha]}`),this.$.Ka.Mb(new mb.a(1243860697,Ha,this.$.Mc,30,null)))}l7i(){ia.a.instance.ra(z.a.click,this.domElement,this.ed);X.KeyInputManager.instance.ra(z.a.Kb,this.domElement,this.onKeyDown)}OOj(){ia.a.instance.Ba(z.a.click,this.domElement,this.ed);X.KeyInputManager.instance.Ba(z.a.Kb,this.domElement,this.onKeyDown)}}Object(t.a)(Kb,"SheetDropdownMenuAnchor",ib,[]);var rb=a(61);const cc=(Ha,tb,bc,tc,Ma,Tb,zb,ic=null)=>{ic=Ha.Na(9,ic);ic.sheetName=
tb;ic.newSheetIndex=bc;return rb.g(Ha,"ReorderSheets",ic,tc,Ma,Tb,zb,0)};var nc=a(174),Wb=a(128),Ea=a(185),ua=a(131),ma=a(59),fb=a(209),sb=a(197),Ua=a(166),ab=a(132);class na{constructor(Ha,tb,bc){this.nm=tb;this.mw=bc;this.sheet=Ha;this.altText=J.a.instance.ga(1993)}$M(){return this.sheet.active}nnd(){return this.sheet.isLockPausedInSession}isa(){return this.nm?W.a.TMe:this.$M()?W.a.SMe:W.a.RMe}Cna(){return this.sheet.li?wa.a.jJf:wa.a.BOj}NTd(){return 16}$ga(){return null}jsa(){return this.nm?this.mw?
L.VMe:L.UMe:null}oVd(){return null}vs(){return null}xjd(){return 0}lVc(){return!0}}Object(t.a)(na,"LockPausedSheetIconDataSource",null,[392]);class Na{constructor(Ha,tb,bc){this.nm=tb;this.mw=bc;this.sheet=Ha;this.altText=J.a.instance.ga(1992)}$M(){return this.sheet.active}nnd(){return this.sheet.li}isa(){return this.nm?W.a.TMe:this.$M()?W.a.SMe:W.a.RMe}Cna(){return wa.a.jJf}NTd(){return 16}$ga(){return null}jsa(){return this.nm?this.mw?L.VMe:L.UMe:null}oVd(){return null}vs(){return null}xjd(){return 0}lVc(){return!0}}
Object(t.a)(Na,"LockedSheetIconDataSource",null,[392]);class Va{constructor(Ha,tb,bc,tc){this.sheet=Ha;this.altText=J.a.instance.ga(1905);this.uKj=tb;this.f2f=bc;this.mw=tc}$M(){return this.sheet.active}nnd(){return this.sheet.Ed.lv}$ga(){return this.mw?this.$M()?L.frh:L.hrh:this.$M()?L.erh:L.grh}isa(){return!this.$M()&&this.f2f()?W.a.Vsh:W.a.Ush}Cna(){return!this.$M()&&this.f2f()?wa.a.bvj:wa.a.avj}NTd(){return 14}jsa(){return L.Kph}oVd(){return this.sheet.Ed.Wlb}vs(){return this.uKj}xjd(){return 8}lVc(){return!1}}
Object(t.a)(Va,"NamedSeetViewSheetIconDataSource",null,[392]);var Sa=a(155),vb=a(127);class Oa{constructor(Ha,tb){this.Wpa=this.R0=this.AAa=this.ul=null;this.Sef=!1;this.cQc=this.Cna=this.jsa=this.$ga=this.isa=null;this.xN=()=>{this.dataSource.$M()&&f.TaskExtensions.Aa(this.nBb,()=>{dialogControls.renderToolTip(this.dataSource.vs(),"SheetIconTooltip",this.dataSource.oVd(),this.DI,10,!1,!1,1)},this.$.la,3)};this.wN=()=>{this.dataSource.$M()&&this.clearToolTip()};this.$=Ha;this.dataSource=tb;this.mw=
r.a.cpd()}get Gc(){return this.R0||(this.R0=vb.a.instance.Zd(this.DI))}get nBb(){if(this.Wpa)return this.Wpa;const Ha=new Sa.a;this.$.Qx(tb=>{f.TaskExtensions.Aa(tb.tsd(),()=>{Ha.setResult(!0)},this.$.la,3)});return this.Wpa=Ha.task}get DI(){return this.cQc}Hcg(){if(this.DI&&(this.ul||this.AAa)){if(this.mw){var Ha=this.dataSource.Cna();this.Cna!==Ha&&(this.AAa&&this.AAa.parentNode.removeChild(this.AAa),this.d$e(),this.Cna=Ha)}else Ha=this.dataSource.isa(),this.isa!==Ha&&(this.lJd(this.ul,this.isa,
Ha),this.isa=Ha);Ha=this.dataSource.$ga();this.$ga!==Ha&&(this.mw?this.jdj(this.AAa,this.$ga,Ha):this.lJd(this.ul,this.$ga,Ha),this.$ga=Ha);Ha=this.dataSource.jsa();this.jsa!==Ha&&(this.lJd(this.DI,this.jsa,Ha),this.jsa=Ha);this.dataSource.vs()&&!this.dataSource.$M()&&this.clearToolTip()}}Gzj(Ha,tb,bc){this.jai(Ha,tb,bc);Z.DOMElementExtensions.setVisible(this.DI,this.dataSource.nnd())}clearToolTip(){f.TaskExtensions.Aa(this.nBb,()=>{dialogControls.clearToolTip(this.dataSource.vs())},this.$.la,3)}jai(Ha,
tb,bc){this.DI&&this.Sef!==Ha&&(this.DI.parentNode.removeChild(this.DI),this.jsa=this.$ga=this.Cna=this.isa=this.cQc=null,this.dataSource.vs()&&(this.Gc.detach("mouseover",!0),this.Gc.detach("mouseout",!0)));this.DI||(this.cQc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.DI,V.a.Aha),Sys.UI.DomElement.addCssClass(this.DI,W.a.PA),u.EwaSettings.ma(500)?Ha===this.dataSource.lVc()?tb.appendChild(this.DI):tb.insertBefore(this.DI,bc):Ha?tb.insertBefore(this.DI,bc):tb.appendChild(this.DI),
this.mw?this.d$e():(this.ul=document.createElement("img"),this.ul.tabIndex=-1,this.ul.alt=this.dataSource.altText,this.DI.appendChild(this.ul),this.ul.src=Pa.a.hf(this.dataSource.xjd())),this.dataSource.vs()&&(this.Gc.ka("mouseover",this.xN,!0),this.Gc.ka("mouseout",this.wN,!0)),this.Sef=Ha)}jdj(Ha,tb,bc){Ha&&(Sys.UI.DomElement.removeCssClass(Ha,tb),Sys.UI.DomElement.addCssClass(Ha,bc))}lJd(Ha,tb,bc){tb&&Sys.UI.DomElement.removeCssClass(Ha,tb);bc&&Sys.UI.DomElement.addCssClass(Ha,bc)}dispose(){A.a.Ia(this.R0)}d$e(){const Ha=
this.$.da.za(388);Ha?(this.AAa=Ha.bva(this.dataSource.Cna(),this.dataSource.NTd()))?this.DI.appendChild(this.AAa):y.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.Cna()} was not found.`):y.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")}}Object(t.a)(Oa,"SheetIcon",null,[2]);var yb=a(347),Ob=a(93),Ja=a(152);class lb extends Ob.a{constructor(Ha,tb){super(Ha.domElement);this.onKeyDown=bc=>
{121===bc.keyCode&&bc.shiftKey&&!this.fna.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.fna.anchor),Ra.g(bc))};this.Wba=bc=>{if(!this.$.isEditMode||this.fna.disabled)return!0;this.rename(!1,bc.tb);return!0};this.Ql=bc=>this.fna.disabled?!0:this.showContextMenu(bc.clientPoint,bc.tb,bc.Cb);this.zfe=Ha;this.$=tb;ia.a.instance.ra(z.a.qk,Ha.domElement,this.Wba);yb.a.instance.ra(Ha.domElement,this.Ql);this.Gc.ka("keydown",this.onKeyDown)}get fna(){return this.zfe}dispose(){this.fna&&(ia.a.instance.Ba(z.a.qk,
this.fna.domElement,this.Wba),yb.a.instance.Ba(this.fna.domElement,this.Ql),this.zfe=null);this.$=null;super.dispose()}showContextMenu(Ha,tb,bc){this.fna.activate(tb,r.a.Rpd());tb=new mb.a(-1075099431,tb,this.$.Mc,30,null);let tc;return!Ja.a(tc=this.$.Ka.Mb(tb,{[n.a.N0f]:Ha,[lb.Tuj]:this.fna.sheet,[n.a.O0f]:bc}))&&(6!==tc.status||tc.result)}rename(Ha,tb){this.$.ud(817296323,tb,Ha?19:0,null)}}lb.Tuj="Sheet";Object(t.a)(lb,"SheetOpsSheetClickHelper",Ob.a,[]);var Pb=a(41);class Jb extends ib{constructor(Ha,
tb,bc,tc,Ma,Tb,zb){super(document.createElement("li"),Ha);this.f0c=this.e0c=this.L0f=this.K0f=0;this.B3c=.5;this.nU=this.zPd=!1;this.color=this.$Fc=this.CE=this.ECb=this.rO=null;this.mgc=this.Jdf=!1;this.g4b="#BEBBB8";this.xDc=null;this.onKeyDown=ic=>13!==ic.Ca.keyCode||this.disabled?!1:(this.activateSheet(1),!0);this.Fz=ic=>32!==ic.Ca.charCode||this.disabled?!1:(this.activateSheet(1),!0);this.xN=()=>{this.disabled||(this.IR.eRi(this),this.IR.uF||this.Yma(!0,void 0,"OnMouseOver"))};this.wN=()=>{this.disabled||
this.Yma(!1,void 0,"OnMouseOut")};this.eEb=()=>{this.IR.uF||(this.bEj(),this.sheet.a0||ja.g(this.$).nIb(this.sheet.sheetName));return!1};this.y5=()=>{this.WJe(!1);return!1};this.ed=ic=>{if(this.disabled)return!0;const Qb=ja.g(this.$);this.sheet.active||3!==ic.tb?this.nm?this.activateSheet(ic.tb):r.a.Rpd()&&Qb.focus():(!r.a.pMa(this.$)&&!this.Wzb||Qb.eb||Qb.xi||Qb.Frb(),this.activateSheet(ic.tb));return 3!==ic.tb};this.onPointerDown=ic=>{if(this.disabled)return!0;this.WJe(!0);ja.g(this.$).inRangePicker&&
y.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var Qb=3===ic.tb;if(2===ic.tb||Qb&&this.Bwa)this.nm?(this.Yma(!0,!Qb,"OnPointerDown"),Qb=k.Task.delay(Qb?this.L0f:this.K0f).Uo(()=>!0)):Qb=this.activateSheet(ic.tb),this.qzb&&(this.mgc=!0,this.IR.bsc=f.TaskExtensions.Aa(Qb,()=>{this.mgc&&this.IR.gRi(this,ic)},this.la,11));return!1};this.Kf=ic=>{if(this.disabled||!this.qzb&&u.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;
const Qb=this.IR.uF&&!r.a.bef();this.mgc=!1;this.nm&&this.Yma(2===ic.tb,void 0,"OnPointerUp");this.IR.bsc&&(f.TaskExtensions.Aa(this.IR.bsc,()=>{this.IR.fRi(this)},this.la,11),this.IR.bsc=null);return Qb};this.BN=()=>{this.mgc=!1;this.zPd||this.Yma(!1,void 0,"OnTouchMove");return!1};this.$xe=new lb(this,Ha);this.nm=Tb;this.mw=zb;this.Wzb=r.a.Wzb(Ha);this.hmd=u.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&!this.mw;this.nm?(this.K0f=Ha.ya.SheetDragReorderDelayInMilliseconds,
this.L0f=Ha.ya.SheetDragReorderDelayInMillisecondsForTouch,this.e0c=18,this.f0c=20):(this.e0c=19,this.f0c=22);this.$=Ha;this.pVb=tc;this.IR=Ma;this.qzb=Ma.ooe();this.E9g();this.B3g();this.Yid=Ha.Ib.Og("UserAction",this.name);this.mnd=!1;Z.DOMElementExtensions.nu(this.domElement,n.a.Ns,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.CE);this.dna=new Ea.a;Ha=new Na(this.sheet,this.nm,this.mw);this.dna.add(new Oa(this.$,Ha));this.$.ea.IKb&&(Ha=new na(this.sheet,this.nm,
this.mw),this.dna.add(new Oa(this.$,Ha)));this.hmd||(Ha=new Va(this.sheet,this.IR.Hvc,()=>this.color?Jb.FQd(this.color):!1,this.mw),this.ECb=new Oa(this.$,Ha),this.dna.add(this.ECb));this.Bwa=this.IR.Bwa;this.Web();this.C8i();this.ite=new pa.a(this.domElement,1);tb.insertBefore(this.domElement,bc);aa.a(this.$)&&this.ydg(!0)}get ech(){return this.$Fc||(this.$Fc=sb.a.cp("#F5F5F5"))}get name(){return this.rO.innerText}set name(Ha){this.rO&&(this.rO.innerText=Ha,this.kAc(),this.zdg())}get sheet(){return this.pVb}get anchor(){return this.xDc}get tabIndex(){return this.anchor.tabIndex}set tabIndex(Ha){this.anchor.tabIndex=
Ha}NNh(){return Z.DOMElementExtensions.kf(this.anchor)?this.anchor:null}dispose(){if(this.nU){F.a.instance.Ba(z.a.pointerDown,this.domElement,this.onPointerDown);X.KeyInputManager.instance.Ba(z.a.Kb,this.domElement,this.onKeyDown);X.KeyInputManager.instance.Ba(z.a.qp,this.domElement,this.Fz);ia.a.instance.Ba(z.a.click,this.domElement,this.ed);F.a.instance.Ba(z.a.yV,this.domElement,this.eEb);F.a.instance.Ba(z.a.ky,this.domElement,this.y5);if(this.qzb||u.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))F.a.instance.Ba(z.a.Mf,
this.domElement,this.Kf),this.Bwa&&(U.a.instance.Ba(z.a.te,this.domElement,this.Kf),U.a.instance.Ba(z.a.Xf,this.domElement,this.BN));this.nU=!1;this.g4b="#BEBBB8"}A.a.qc([this.$xe,this.ite]);this.rO=this.CE=this.xDc=this.IR=this.ite=this.$xe=null;if(this.dna){for(let Ha of this.dna)Ha.dispose();this.dna=null}this.color=this.pVb=null;super.dispose()}yW(Ha){Ha&&this.Yma(!1,!1);super.yW(Ha)}lRd(Ha){if(ma.a.tg.BQ){this.eHe();var tb=d.GetServiceTaskFactory.Ra(this.$.da,322,323,1);f.TaskExtensions.Aa(tb,
bc=>{nc.UISurfaces.tH().then(tc=>{const Ma=bc.result;Ma.arj(tc);Ma.show(Ha);return null},tc=>{y.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${tc}`);return null})},this.la,3)}}Yke(){if(this.sheet.active&&this.$.dr){var Ha=this.$.dr,tb=ja.g(this.$),bc=tb.Oj;if(this.sheet.Ed.lv){if(!this.ECb){var tc=new Va(this.sheet,this.IR.Hvc,()=>this.color?Jb.FQd(this.color):!1,this.mw);this.ECb=new Oa(this.$,tc);this.dna.add(this.ECb)}bc?(tb.Leb(1),
u.EwaSettings.tcf()&&Ha.classList.add(W.a.y7b)):Ha.classList.add(W.a.y7b);Ha=Jb.ded(n.a.Iqf);tb=Jb.ded(n.a.kwd);bc=Jb.ded(n.a.zqf);tc=this.sheet.Ed.rQd;this.sheet.Ed.rQd=!1;"true"===bc&&tc&&this.$.ea.uQd?(Wb.a.Mw(n.a.zqf,"false",Wb.a.hV),this.$.ea.uQd=!1,this.lRd(3)):"true"===Ha&&"true"===tb&&"true"===bc?this.$.ea.vQd&&this.$.ea.bLb&&(this.sheet.Ed.OH?(Ha=1,Wb.a.Mw(n.a.kwd,"false",Wb.a.hV),this.$.ea.bLb=!1):Ha=0,Wb.a.Mw(n.a.Iqf,"false",Wb.a.hV),this.$.ea.vQd=!1,this.lRd(Ha)):this.sheet.Ed.OH&&"true"===
tb&&"true"===bc&&this.$.ea.bLb&&(Wb.a.Mw(n.a.kwd,"false",Wb.a.hV),this.$.ea.bLb=!1,this.lRd(2))}else this.eHe(),bc?(tb.Leb(0),u.EwaSettings.tcf()&&Ha.classList.remove(W.a.y7b)):Ha.classList.remove(W.a.y7b)}}eHe(){const Ha=this.$.da.za(322);Ha&&Ha.dismiss()}Web(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.k6a()?L.QGj:L.YGj;u.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.rO.parentNode.classList.add(L.Nqi):this.rO.parentNode.classList.add(L.Oqi);
this.zdg();this.hmd&&this.Yke();this.Hzj();this.Fdg();this.kAc();this.hmd||this.Yke()}dRi(){this.zPd=!0;this.Yma(!0,!0,"OnSheetReorderStarted")}cRi(){this.zPd=!1;this.Yma(!1,void 0,"OnSheetReorderEnded")}activate(Ha=0,tb=!1){this.Y0b()||(this.sheet.activate(),tb&&ja.g(this.$).focus(),Ha={["InputMethod"]:$a.a[Ha],["AppMode"]:this.$.Mc,["Location"]:"canvas"},ab.b(this.$).Cd(ua.a.Puj,Ha))}ydg(Ha){this.g4b=Ha?"#797775":"#BEBBB8";this.B3c=Ha?-.5:.5;this.$Fc=Ha?sb.a.cp("#3B3A39"):sb.a.cp("#F5F5F5");this.Fdg()}Tnj(Ha){this.qzb=
Ha}Nyd(Ha){Ha.V0c();this.rwe(Ha)}rwe(Ha){Ha.M_a();this.sheet.activate()}dzg(Ha){Ha=new mb.a(-1876836819,Ha,this.$.Mc,30,null);return this.$.Ka.Mb(Ha,{[n.a.BPd]:this.sheet.name})}zdg(){this.rO.parentNode.setAttribute("sheet-title",this.rO.innerText)}kAc(){const Ha=this.qHh();this.anchor.setAttribute(n.a.Mt,Ha);this.anchor.setAttribute(n.a.wga,this.sheet.active.toString())}qHh(){const Ha=this.sheet.Ed.lv,tb=this.sheet.Ed.Wlb,bc=this.sheet.li,tc=this.sheet.isLockPausedInSession;return Ha&&bc?String.format(J.a.instance.ob(20),
this.name,tb):Ha&&tc?String.format(J.a.instance.ob(22),this.name,tb):Ha?String.format(J.a.instance.ob(19),this.name,tb):bc?String.format(J.a.instance.ob(18),this.name):tc?String.format(J.a.instance.ob(21),this.name):this.name}activateSheet(Ha=0){if(r.a.Rpd()){if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.Y0b())return k.Task.Ta(!1);Ua.a.current.AR="ActivateSheet";this.sheet.activate();return k.Task.Ta(!0)}return this.dzg(Ha)}Fdg(){const Ha=this.sheet.tabColor;
this.color=Ha?sb.a.cp(Ha):this.ech;this.Jdf=Jb.FQd(this.color);this.Yma(!1,void 0,"UpdateTabColor")}Yma(Ha,tb=!1,bc=null){if(this.sheet){bc=this.sheet.active;var tc=this.k6a(),Ma=!!this.sheet.tabColor,Tb=sb.a.hG(bc||tc?fb.a.white:this.color);this.CE.style.background="";bc||tc?(Ma?u.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.HKa?this.Ssj():this.nm?this.Rsj():this.Qsj():this.nm||(this.CE.style.backgroundColor=Tb),this.CE.style.height=this.e0c.toString()+
"px"):(this.CE.style.filter="",this.CE.style.backgroundColor=Tb,this.CE.style.height=this.f0c.toString()+"px");this.rO.className=bc?L.RGj:tc?L.dark:this.Jdf?L.light:L.dark;for(let zb of this.dna)zb.Hcg();this.nm&&(Ha&&!Ma&&(this.CE.style.backgroundColor="#E1DFDD"),Z.DOMElementExtensions.toggleCssClass(this.domElement,L.XGj,Ha),tb?(Ma||(this.CE.style.backgroundColor=this.g4b),this.domElement.style.backgroundColor=this.g4b):(Ma||(this.CE.style.backgroundColor=""),this.domElement.style.backgroundColor=
""));this.rO.style.fontWeight=bc||tc||!this.nm&&Ha?this.nm?"600":"bold":""}else y.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: ${bc}`)}Rsj(){const Ha=this.CE.style,tb=sb.a.hG(Jb.rZc(this.color,this.B3c));Ha.background=tb}Qsj(){const Ha=this.CE.style,tb=sb.a.hG(Jb.rZc(this.color,1)),bc=sb.a.hG(Jb.rZc(this.color,this.B3c));Ha.background=`$linear-gradient(${tb}, ${bc})`}Ssj(){this.CE.style.background=
"transparent"}B3g(){this.xDc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=L.SGj;Z.DOMElementExtensions.nu(this.anchor,n.a.znb,null,null);this.tabIndex=-1}E9g(){this.CE=document.createElement("span");this.CE.className=L.VGj;this.rO=document.createElement("span");this.rO.className=L.$Gj;this.rO.dir=this.sheet.rtlName?"rtl":"ltr";this.CE.appendChild(this.rO)}Hzj(){const Ha=this.$.mJ;for(let tb of this.dna)tb.Gzj(Ha,this.CE,this.rO)}k6a(){return ja.g(this.$).k6a(this.sheet)}bEj(){this.Yid.start();
this.mnd=!0}WJe(Ha){this.mnd&&(this.Yid.stop(),y.ULS.sendTraceTag(537153686,0,50,Pb.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.Yid.uc,["Has been clicked"]:Ha})),this.mnd=!1)}C8i(){F.a.instance.ra(z.a.pointerDown,this.domElement,this.onPointerDown);X.KeyInputManager.instance.ra(z.a.Kb,this.domElement,this.onKeyDown);X.KeyInputManager.instance.ra(z.a.qp,this.domElement,this.Fz);this.Gc.ka("mouseover",this.xN);this.Gc.ka("mouseout",this.wN);F.a.instance.ra(z.a.yV,
this.domElement,this.eEb);F.a.instance.ra(z.a.ky,this.domElement,this.y5);if(this.qzb||u.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))F.a.instance.ra(z.a.Mf,this.domElement,this.Kf),this.Bwa&&(U.a.instance.ra(z.a.te,this.domElement,this.Kf),U.a.instance.ra(z.a.Xf,this.domElement,this.BN));ia.a.instance.ra(z.a.click,this.domElement,this.ed);this.nU=!0}Y0b(){const Ha=this.$.da.za(65);return Ha&&Ha.Uja()?(Ha.utc(),this.rwe(Ha),!0):!1}static ded(Ha){let tb=Wb.a.get(Ha);
tb||(Wb.a.Mw(Ha,"true",Wb.a.hV),tb=Wb.a.get(Ha));return tb}static rZc(Ha,tb){if(1<tb||-1>tb)return Ha;let bc=Ha.r,tc=Ha.g;Ha=Ha.b;0<tb?(bc=bc*(1-tb)+255*tb,tc=tc*(1-tb)+255*tb,Ha=Ha*(1-tb)+255*tb):(bc*=1+tb,tc*=1+tb,Ha*=1+tb);return fb.a.Ptb(Math.round(bc),Math.round(tc),Math.round(Ha))}static FQd(Ha){return 128>=(222*Ha.r+707*Ha.g+71*Ha.b)/1E3}}Object(t.a)(Jb,"SheetTabButton",ib,[]);class Lb extends ib{constructor(Ha,tb,bc){super(document.createElement("a"),tb);this.Pga=u.EwaSettings.ma(500)?W.a.o8c:
W.a.nsh;bc.pb(this.domElement,J.a.instance.ga(718),0,this.Pga,J.a.instance.ga(718),wa.a.G0c,!0);Ha.appendChild(this.domElement);this.Gc.ka("contextmenu",tc=>{Ra.g(tc)})}}Object(t.a)(Lb,"WorkbookProtectionButton",ib,[]);var Ab=a(51),nb=a(46),va=a(57);class db extends T.a{constructor(Ha,tb,bc=null){super(tb);this.sheetTabActivatePreviousHidden=J.a.instance.ga(727);this.sheetTabActivateNextHidden=J.a.instance.ga(729);this.svgIconProvider=null;this.uh=[];this.CK=Array(6);this.uwd=Array(6);this.uRa=this.Dxb=
this.DH=this.Kvc=this.Hcb=this.Mvc=this.GPd=this.Yk=null;this.isRtl=!1;this.rK=this.Vu=0;this.T5b=this.asc=!1;this.Koc=this.Gma=0;this.tM=this.V2=this.w$=this.a6b=null;this.pbc=this.WC=0;this.jMb=null;this.sAb=-1;this.kY=null;this.Snc=0;this.zxc=-1;this.bma=0;this.nta=new G;this.cKc=!1;this.bsc=this.Nvc=this.KKb=this.vfe=this.TZ=null;this.J8d=!1;this.Vjd=null;this.Nvd=!1;this.ufe=null;this.nD=(tc,Ma)=>{this.gCf(Ma.item)};this.mya=(tc,Ma)=>{tc=this.$.xa.pa.index;for(let Tb=0,zb=this.uh.length;Tb<zb;Tb++){const ic=
this.iQ(Tb);if(ic.name===Ma.oldName){ic.name=Ma.newName;this.v_();Tb===tc&&this.J_(6);break}}};this.kCf=(tc,Ma)=>{(tc=this.k2a(Ma.item))&&tc.Web()};this.lCf=(tc,Ma)=>{Ma.visible?(this.lRa(!1),this.hCf(Ma.item)):this.gCf(Ma.item)};this.qN=tc=>{this.uF?(this.kY=tc,this.HNb()):(this.kY&&(this.Koc+=this.kY.clientPoint.x-tc.clientPoint.x),this.kY=tc,Math.abs(this.Koc)>=this.phh&&this.HNb());return!0};this.BN=tc=>{tc.Ca.preventDefault();return!1};this.bWf=tc=>{this.YVf(tc,!0)};this.aWf=tc=>{this.YVf(tc,
!1)};this.u5=tc=>{if(this.uF&&(this.uz||this.ggf(tc)))if(this.T5b=this.bcf(tc),this.uz){let Ma;tc=(Ma=this.iQ(this.WC+1))?Ma.sheet:null;this.reorderSheets(tc,this.WC+1===this.EPd,!0)}else tc=this.Nvd?null:this.Vjd,this.reorderSheets(tc,this.Nvd,!0);this.UP();return!0};this.Gh=(tc,Ma)=>{Ma.tD&&this.gYd(Ma.tD);this.Suc(!1);this.v_();Ma.pa&&(this.gYd(Ma.pa),this.J_(6),this.ea.Gla())};this.Wsf=(tc,Ma)=>{this.$Ac(Ma.item)};this.Xsf=(tc,Ma)=>{this.$Ac(Ma.item)};this.Ysf=(tc,Ma)=>{this.$Ac(Ma.item)};this.gOa=
(tc,Ma)=>{this.$Ac(Ma.item)};this.Wxa=()=>{this.s_c()};this.$c=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;this.s_c();this.n3c();u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(va.d(this.$)||va.e(this.$))&&(nb.PageLoadTrackingInfo.instance.VV(n.a.bAa,["sheetTabBar"]),nb.PageLoadTrackingInfo.instance.UV(n.a.bAa,["sheetTabBar"]));this.W2c();this.v_();this.lRa(!0);this.J_(6)};this.Yi=()=>{this.isVisible&&(this.v_(),this.J_(6))};this.Uf=()=>{Object(H.a)(sa,this.DH)===
qa.k(this.$.pg)&&this.W2c();for(const tc of this.uh)tc.Tnj(!qa.k(this.$.pg))};this.jCf=(tc,Ma)=>{this.adj(Ma.item,Ma.isUserOperation)};this.yEb=(tc,Ma)=>{this.hCf(Ma.item)};this.onKeyDown=tc=>{switch(tc.keyCode){case 9:var Ma=this.domElement.querySelectorAll(Z.DOMElementExtensions.qr);const Tb=Z.DOMElementExtensions.Kl(Ma);Ma=Z.DOMElementExtensions.fz(Ma);Z.DOMElementExtensions.Sma(tc,Tb,Ma);break;case 39:case 37:Z.DOMElementExtensions.$Yf(tc,this.domElement.querySelectorAll(Z.DOMElementExtensions.qr),
39===tc.keyCode?!this.isRtl:this.isRtl)}y.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${tc.keyCode}`)};this.onScroll=()=>{this.Yk.scrollLeft!==this.Gma&&this.AIj()};this.zN=tc=>{if(tc.ctrlKey||tc.q2)return!1;this.Yk.scrollLeft+=Math.floor(30*tc.EBa);if(this.uz&&this.uF){const Ma=this.nYe("OnMouseWheel");Ma&&this.QTd(0<tc.EBa,Ma.x+Ma.width/2)}return!0};this.GF=(tc,Ma)=>{if(this.nta)this.W4e("PartialInteractivity",Ma.UL?3:0);else{this.UP(!1);this.jOd(Ma.UL);for(const Tb of this.fse)Tb&&
Tb.yW(Ma.UL);for(const Tb of this.uh)Tb&&Tb.yW(Ma.UL)}};this.FDb=(tc,Ma)=>{tc=0;Ma.mje&&(tc=2|(Ma.Uuj?1:0));this.W4e("ComponentRangePicker",tc)};this.$=Ha;this.ea=this.$.ea;this.i6b=(this.uz=r.a.bef())&&!u.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.nm=u.EwaSettings.ma(500);this.mw=r.a.cpd();this.dgf=this.nm&&!this.$.sz;this.uz&&(this.J8d=this.nm&&!x.a.kv);this.CBi=this.$.ya.SheetTabNavigateButtonLongKeyPressPeriodMS;this.BBi=this.$.ya.SheetTabNavigateButtonIntervalPeriodMS;
this.phh=this.$.ya.SheetTabDragStartPixelThreshold;this.ROa=this.SOa=-1;this.s1c=!1;this.mw&&(this.svgIconProvider=bc);this.nC=new pa.a(this.domElement,3);this.nm&&this.domElement.classList.add(L.qrh);this.m7g();this.O4g();this.n7g();u.EwaSettings.YM()&&document.getElementById(n.a.xaa)||this.r8g();this.Suc(!0);this.$c(null,null);Ha=this.$.xa;Ha.Pf(this.Gh);Ha.LTc(this.Wxa);Ha.HX(this.nD);Ha.lga(this.yEb);Ha.gFa(this.mya);Ha.sme(this.jCf);Ha.eYa(this.lCf);Ha.TEg(this.kCf);Ha.WTc(this.Wsf);Ha.pme(this.Xsf);
Ha.qme(this.Ysf);Ha.rme(this.gOa);this.$.el(this.$c);this.$.EA(this.Yi);da.a(this.$).Xh(this);this.$.da.Ga(32,this);u.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.Lu(this.Uf);this.Lvc=this.ue.Zd(this.domElement);this.Lvc.ka("keydown",this.onKeyDown);xa.a(this.$).Sp()&&this.GF(null,new ta.a(!0));xa.a(this.$).Vf.a9(this.GF);ja.g(this.$).Ple(this.FDb);this.Lvc.ka("mousedown",tc=>{tc.preventDefault()});B.a.instance.ra(z.a.hD,this.domElement,this.zN);
this.FPd=this.ue.Zd(this.Yk);this.FPd.ka("scroll",this.onScroll);this.AIj=Ga.a(()=>{this.v_()},200,this.$.la,oa.a.Zuj,!0);this.$.YC(n.a.JBj);this.dgf&&(this.ufe=new Ca(this.$,this.uRa.domElement));u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&nb.PageLoadTrackingInfo.instance.A_(n.a.bAa,["sheetTabBar"])}get mc(){return this.domElement}get kf(){return this.isVisible}get $d(){return R.a.DPd}get uF(){return this.cKc}get EPd(){return this.uh.length}get Hvc(){return this.vfe}get Bwa(){return this.J8d}get navigationButtonsDisabled(){return!!this.nta&&
this.nta.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.nta&&this.nta.operationButtonsDisabled}get twd(){return this.nm?this.$.mJ?[W.a.g7b,W.a.YMe,W.a.$Me,W.a.f7b,W.a.Qta,W.a.Qta]:[W.a.f7b,W.a.$Me,W.a.YMe,W.a.g7b,W.a.Qta,W.a.Qta]:this.$.mJ?[W.a.g7b,W.a.XMe,W.a.ZMe,W.a.f7b,W.a.Qta,W.a.Qta]:[W.a.f7b,W.a.ZMe,W.a.XMe,W.a.g7b,W.a.Qta,W.a.Qta]}get vwd(){return this.$.mJ?[null,wa.a.Kze,wa.a.Ize]:[null,wa.a.Ize,wa.a.Kze]}get IHf(){return this.$.mJ?[null,wa.a.Lze,wa.a.Jze]:[null,wa.a.Jze,
wa.a.Lze]}get ZAb(){if(this.isRtl){if(x.a.wF)return 0;if(x.a.Tf)return-1*(this.Yk.scrollWidth-this.Yk.clientWidth);if(x.a.kv)return this.Yk.scrollWidth-this.Yk.clientWidth;y.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get HIb(){if(this.isRtl){if(x.a.wF)return this.Yk.scrollWidth-this.Yk.clientWidth;if(x.a.Tf||x.a.kv)return 0;y.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Yk.scrollWidth-
this.Yk.clientWidth}get fse(){return this.nta?[this.DH,this.Dxb]:[this.DH,this.Dxb,this.uRa]}get ZGj(){return this.uh.concat(this.uRa)}get Suj(){return this.ufe}pb(Ha,tb,bc,tc,Ma,Tb,zb=!1){Ha.removeAttribute("Href");Ha.setAttribute(n.a.Kd,n.a.Ms);Ha.className=L.drh;Ha.title=tb;Ha.tabIndex=0;this.mw&&Tb?bc=this.svgIconProvider.Jaa(Tb,12,12,Ha,24,24):(tb=document.createElement("span"),tb.className=this.nm?W.a.kYg:W.a.PA,tb.classList.add(V.a.Aha),tb.tabIndex=-1,Ha.appendChild(tb),Tb=document.createElement("img"),
Tb.src=Pa.a.hf(bc),Tb.className=tc,Tb.alt=Ma,Tb.tabIndex=-1,tb.appendChild(Tb),bc=Tb);zb&&Ha.classList.add(V.a.KT);return bc}dispose(){if(this.$){var Ha=this.$.xa;Ha.zg(this.Gh);Ha.gId(this.Wxa);Ha.l6(this.nD);Ha.pma(this.yEb);Ha.PPa(this.mya);Ha.QPf(this.jCf);Ha.KHb(this.lCf);Ha.Uaj(this.kCf);Ha.tId(this.Wsf);Ha.NPf(this.Xsf);Ha.OPf(this.Ysf);Ha.PPf(this.gOa);this.$.Al(this.$c);this.$.zD(this.Yi);xa.a(this.$)&&xa.a(this.$).Vf.Pca(this.GF);this.nta&&ja.g(this.$).rPf(this.FDb);B.a.instance.Ba(z.a.hD,
this.domElement,this.zN)}A.a.qc(this.uwd);this.uwd=null;if(this.CK)for(Ha=0;Ha<this.CK.length;Ha++){const tb=Z.DOMElementExtensions.ZJ(this.CK[Ha],this.domElement,!1,"a");tb&&I.a.jma(tb)}A.a.Ia(this.nC);A.a.Ia(this.Lvc);A.a.Ia(this.FPd);this.FPd=this.Lvc=this.Dxb=this.DH=this.nC=null;this.$&&this.uz&&this.UP(!1);this.w$=null;this.BNd(null,"Dispose");this.jMb=this.tM=this.a6b=null;this.s_c();this.Hcb=this.Mvc=this.GPd=this.Yk=this.CK=this.$=this.ea=null;super.dispose()}hg(Ha,tb){if(!tb){y.ULS.shipAssertTag(537153760,
0,0<this.uh.length,"There is no sheet tab button.");if(!this.uh.length)return!1;Ha=null;for(const bc of this.uh)if(Ha=bc.NNh())break;if(!Ha)return y.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;Z.DOMElementExtensions.setFocus(Ha)}return!tb}kh(Ha){return Z.DOMElementExtensions.vf(this.mc,Ha)}lj(){}Nj(){}reorderSheets(Ha,tb,bc){if(this.TZ&&this.TZ!==Ha){const tc=this.TZ.index;this.$cj(this.TZ,Ha,tb);Ha=Ha?Ha.index-1:tb?this.$.xa.count-1:0;tc!==Ha&&(this.fvi(tc,Ha,bc),this.jkh(this.TZ.name,
Ha))}}MZh(Ha){Ha=this.oia(Ha);return-1!==Ha&&this.Vu<=Ha&&Ha<=this.rK?this.uh[Ha].domElement:null}cTj(Ha){if(this.mw){for(var tb=0;tb<this.CK.length;tb++){const bc=this.CK[tb];if(bc&&this.svgIconProvider){const tc=bc.parentNode;this.VOf(bc);tc&&(this.CK[tb]=this.svgIconProvider.Jaa(Ha?this.IHf[tb]:this.vwd[tb],12,12,tc,24,24))}}for(tb=0;tb<this.uh.length;tb++)this.uh[tb].ydg(Ha);this.uRa&&this.uRa.Vra&&this.xdg(wa.a.F0h,this.uRa,Ha);this.DH&&this.DH.Vra&&this.xdg(wa.a.r_g,this.DH,Ha)}}xdg(Ha,tb,bc){tb.D$a||
(tb.D$a=this.svgIconProvider.Jaa(Ha,12,12,tb.Vra.parentNode,24,24));tb.D$a&&(Z.DOMElementExtensions.setVisible(tb.Vra,!bc),Z.DOMElementExtensions.setVisible(tb.D$a,bc))}gRi(Ha,tb){var bc=ja.g(this.$);const tc=bc.inRangePicker,Ma=Ba.HelperMethods.Qn(tb);if(bc.eb&&!tc){const Tb=bc.lm?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";let zb=void 0;u.EwaSettings.n6a&&(zb=[Object(ca.a)(bc.hc.textBox.HAa)]);ca.b(this.$).TAa(Ma.rawEvent,Tb,zb);bc.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}bc=
this.Bwa&&3===tb.tb;!(2===tb.tb&&Ma.button===Sys.UI.MouseButton.leftButton||bc)||tc||this.uF||xa.a(this.$).Sp()||(bc&&Ha.dRi(),this.sAb=tb.clientPoint.x,this.kY=tb,this.wNg(Ha))}eRi(Ha){!this.uz&&this.uF&&this.uRd(Ha.sheet,!1)}fRi(Ha){this.uz||(this.uF&&this.reorderSheets(Ha.sheet,!1,!0),this.UP());this.v_()}ooe(){return this.$.isEditMode&&!qa.k(this.$.pg)}v_(){const Ha=Ba.HelperMethods.Lba(()=>{this.bRj();this.nm&&this.ssj();this.jOd()});y.ULS.sendTraceTag(537153757,0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${Ha}`)}ssj(){const Ha=
this.rK===this.uh.length-1;Z.DOMElementExtensions.toggleCssClass(this.Hcb,this.$.mJ?L.aNe:L.QMe,!!this.Vu);Z.DOMElementExtensions.toggleCssClass(this.Hcb,this.$.mJ?L.QMe:L.aNe,!Ha)}jOd(Ha=!1){const tb=!this.Vu,bc=this.rK===this.uh.length-1;this.FZf(4,this.sheetTabActivatePreviousHidden,!tb);this.FZf(5,this.sheetTabActivateNextHidden,!bc);this.evc(0,tb||Ha);this.evc(1,tb||Ha);this.evc(2,bc||Ha);this.evc(3,bc||Ha)}FZf(Ha,tb,bc){if(Ha=this.CK[Ha]){Z.DOMElementExtensions.setVisible(Ha,bc);var tc=this.VZe(Ha);
tc.title="img"===Ha.nodeName?Ha.alt=0<this.uh.length&&bc?tb:"":Ha.title=0<this.uh.length&&bc?tb:"";tc.tabIndex=bc?0:-1}}VZe(Ha){return this.mw?Ha.parentNode:Ha.parentNode.parentNode}evc(Ha,tb){if(Ha=this.CK[Ha])Ha=this.VZe(Ha),void 0!==Ha&&null!==Ha&&(!this.uh.length||tb?(Ha.classList.add(V.a.KT),Ha.setAttribute(n.a.Era,"true")):(Ha.classList.remove(V.a.KT),Ha.setAttribute(n.a.Era,"false")))}lRa(Ha){const tb=this.$.mJ?this.uh.length-1:0;let bc=this.t1e(this.$.mJ?0:this.uh.length-1);bc&&(bc.borderRightWidth=
Ha?"1px":"0");this.Vu!==this.rK&&(bc=this.t1e(tb))&&(bc.borderRightWidth="0")}kle(Ha,tb){this.uh||(this.uh=[]);-1===tb?this.uh.push(Ha):this.uh.splice(tb,0,Ha)}y3b(Ha,tb){let bc=-1,tc=null;tb||(bc=this.ORh(Ha.index),-1!==bc&&(tc=this.$Ja(bc)));Ha=new Jb(this.$,this.Yk,tc,Ha,this,this.nm,this.mw);this.kle(Ha,bc);Z.DOMElementExtensions.setVisible(Ha.domElement,!0)}uRd(Ha,tb){var bc=this.k2a(Ha);if(bc){this.Vjd=Ha;this.Nvd=tb;Ha=bc.domElement;bc=this.isRtl?Ha.offsetLeft+(this.Yk.scrollWidth-this.Yk.clientWidth-
this.Yk.scrollLeft):Ha.offsetLeft-this.Yk.scrollLeft;if(!this.isRtl&&tb||this.isRtl&&!tb)bc+=Ha.offsetWidth;this.Kvc.style.left=Ba.HelperMethods.pc(bc-4);Z.DOMElementExtensions.setVisible(this.Kvc,!0)}}j7e(){Z.DOMElementExtensions.setVisible(this.Kvc,!1)}J_(Ha){const tb=Ba.HelperMethods.Lba(()=>{switch(Ha){case 0:this.Jtc(0);break;case 1:this.Jtc(this.Vu-1);break;case 2:this.Jtc(this.Vu+1);break;case 3:this.scrollIntoView(this.uh.length-1);break;case 4:this.Vu&&1<=this.uh.length&&(this.Yie(this.Vu-
1),this.XLd());break;case 5:this.rK!==this.uh.length-1&&1<=this.uh.length&&(this.Yie(this.rK+1),this.XLd());break;case 6:this.XLd()}});this.i6b&&this.uF&&this.HNb();y.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${Ha}, duration = ${tb}`)}Yie(Ha){(Ha=this.iQ(Ha))&&Ha.activate()}jAh(Ha){if(0===Ha.Wz){const tb=this.$.xa;let bc=0;for(let tc=0,Ma=tb.count;tc<Ma;tc++){const Tb=Object(D.a)(fa.a,tb.getItem(tc));if(Tb===Ha)return bc;0===Tb.Wz&&bc++}}return-1}Xzh(Ha){const tb=
this.$.xa;for(let bc=Ha.index+1,tc=tb.count;bc<tc;bc++)if(Ha=Object(D.a)(fa.a,tb.getItem(bc)),0===Ha.Wz)return Ha;return null}oia(Ha){for(let tb=0;tb<this.uh.length;tb++){const bc=this.iQ(tb);if(!bc)y.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${tb}] is null even though index is not out of bounds!`);else if(bc.sheet===Ha)return tb}return-1}k2a(Ha){Ha=this.oia(Ha);return this.iQ(Ha)}fvi(Ha,tb,bc){const tc={};tc.a=this.$.ya.UserSessionId;tc.b=bc;tc.c=
this.T5b;tc.d=Ha;tc.e=tb;tc.f=this.$.xa.count;Ab.b().Le(2,tc,bc)}$cj(Ha,tb,bc){const tc=Object(D.a)(Y.a,this.$.xa);tb?(tb=tb.index,tb=Ha.index<tb?tb-1:tb):tb=bc?tc.count-1:0;tc.reorderSheet(Ha,tb,!0)}dZf(Ha){ja.g(this.$).Df.Wl(Ha)}wNg(Ha){if(!this.asc){const tb=this.domElement.ownerDocument.body;this.uz?(F.a.instance.ra(z.a.zj,document.documentElement,this.qN),this.Bwa&&(U.a.instance.ra(z.a.Xf,document.documentElement,this.qN),U.a.instance.ra(z.a.Xf,this.domElement,this.BN))):(F.a.instance.ra(z.a.zj,
tb,this.qN),U.a.instance.ra(z.a.Xf,tb,this.qN));F.a.instance.ra(z.a.Mf,document.documentElement,this.u5);U.a.instance.ra(z.a.te,tb,this.u5);this.asc=!0}this.TZ=Ha.sheet;this.T5b=!1;this.uz?(this.tM=null,this.a6b=Ha,this.w$=Ha.domElement,this.BNd(Z.DOMElementExtensions.getBoundingClientRect(this.w$),"BeginSheetTabButtonDrag")):(y.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),this.domElement.classList.add(L.PMe),this.domElement.style.cursor=
"",this.dZf("pointer"))}UP(Ha=!0){if(this.asc){this.dZf(n.a.jQ);const tb=this.domElement.ownerDocument.body;this.uz?(F.a.instance.Ba(z.a.zj,document.documentElement,this.qN),this.Bwa&&(U.a.instance.Ba(z.a.Xf,document.documentElement,this.qN),U.a.instance.Ba(z.a.Xf,this.domElement,this.BN))):(F.a.instance.Ba(z.a.zj,tb,this.qN),U.a.instance.Ba(z.a.Xf,tb,this.qN));F.a.instance.Ba(z.a.Mf,document.documentElement,this.u5);U.a.instance.Ba(z.a.te,tb,this.u5);this.cKc=this.asc=!1}this.Koc=0;this.T5b=!1;this.Vjd=
this.TZ=null;this.uz?(this.w$&&(this.w$.style.visibility="visible",this.w$=null),this.a6b=null,this.BNd(null,"EndSheetTabButtonDrag"),this.tM&&(this.tM.parentNode&&this.tM.parentNode.removeChild(this.tM),this.tM=null),this.jfj(Ha)):(this.domElement.classList.remove(L.PMe),this.j7e())}jfj(Ha){this.eTd(Ha);this.WC=this.sAb=-1}jkh(Ha,tb){var bc=this.$.oa;const tc=bc?bc.va:null;bc=()=>new bb(Ha,tb);const Ma=(Tb,zb,ic)=>cc(tc,Ha,tb,Tb,zb,ic,null);u.EwaSettings.dc()?this.$.userOperationManager.Ub(new ea.a(557,
0,Ma,64,bc),null):this.$.userOperationManager.Ub(new O.a(557,0,Ma,void 0,bc),null)}iQ(Ha){return 0<=Ha&&Ha<this.uh.length?this.uh[Ha]:null}s1e(Ha){return(Ha=this.iQ(Ha))?Ha.sheet:null}$Ja(Ha){return(Ha=this.iQ(Ha))?Ha.domElement:null}t1e(Ha){return(Ha=this.$Ja(Ha))?Ha.style:null}ORh(Ha){const tb=this.$.xa;Ha+=1;let bc=-1;const tc=this.uh?this.uh.length:0;for(;Ha<tb.count;){const Ma=Object(D.a)(fa.a,tb.getItem(Ha));if(0===Ma.Wz){for(bc=0;bc<tc&&this.s1e(bc)!==Ma;bc++);break}Ha++}return-1===bc||bc===
tc?-1:bc}gCf(Ha){var tb=this.k2a(Ha);tb&&(this.uz&&this.uF&&(y.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),u.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.UP()),this.Yk.removeChild(tb.domElement),tb=Array.indexOf(this.uh,tb),this.uh.splice(tb,1),this.v_(),(!this.isRtl&&tb===this.uh.length||this.isRtl&&!tb)&&this.lRa(!0),this.i6b&&this.uF?Ha===
this.TZ?(this.UP(),this.J_(6)):this.HNb():this.J_(6))}hCf(Ha){const tb=Object(D.a)(fa.a,Ha);this.uz&&this.uF&&(y.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),u.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.UP());if(0===tb.Wz){this.lRa(!1);var bc=this.oia(Ha);-1===bc&&(y.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),
this.y3b(tb,!1),bc=this.oia(Ha));this.f5e(bc,!0)}}adj(Ha,tb){const bc=this.k2a(Ha);bc&&(this.uz&&this.uF&&!tb&&(y.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),u.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.UP()),Ha=this.MGj(Ha,bc),!u.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.uz&&Ha&&tb&&Ha.cRi())}MGj(Ha,
tb){var bc=Array.indexOf(this.uh,tb);const tc=this.jAh(Object(D.a)(fa.a,Ha));if(-1===tc||-1===bc)return null;bc!==tc||this.uz?(this.lRa(!1),{JAh:this.Vu,Npi:this.rK}=db.Xcj(bc,tc,this.Vu,this.rK),tb&&tb.domElement.parentNode===this.Yk&&(this.Yk.removeChild(tb.domElement),this.uh.splice(bc,1)),tb=this.Xzh(Ha),bc=this.oia(tb),tb=new Jb(this.$,this.Yk,this.$Ja(bc),Object(D.a)(fa.a,Ha),this,this.nm,this.mw),this.kle(tb,bc),bc=this.oia(Ha),this.f5e(bc,!1,!this.nm)):tb=null;return tb}Vkh(){const Ha=this.uh?
this.uh.length:0,tb=this.Vu,bc=this.rK;for(let tc=0;tc<Ha;tc++){const Ma=this.iQ(tc),Tb=tc>=tb;Ma&&(Ma.tabIndex=Tb&&tc<=bc?0:-1)}}NPj(){const Ha=this.uh?this.uh.length:0;for(let tb=0;tb<Ha;tb++){const bc=this.iQ(tb);bc&&bc.Web()}}f5e(Ha,tb,bc=!0){tb&&Ha<=this.Vu&&this.Vu++;this.Vkh();this.lRa(!0);this.v_();this.i6b&&this.uF?this.HNb():bc&&this.J_(6)}Suc(Ha){const tb=this.$.mJ;if(Ha||this.isRtl!==tb)this.isRtl=tb,this.domElement.classList.remove(this.isRtl?W.a.WMe:W.a.bNe),this.domElement.classList.add(this.isRtl?
W.a.bNe:W.a.WMe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.NPj();Ha||this.lRa(!0);for(Ha=0;Ha<this.CK.length;Ha++)0!==Ha&&3!==Ha&&(!this.nm||4!==Ha&&5!==Ha)&&this.GZf(Ha)}m7g(){const Ha=this.GPd=document.createElement("div");Ha.className=L.arh;this.nm&&Ha.classList.add(L.brh);this.domElement.appendChild(Ha);this.s3b(Ha,1,722,721);this.s3b(Ha,2,724,723);this.dgf&&(this.uRa=new Kb(this.$,this,Ha));this.nm||this.s3b(Ha,4,728,727)}n7g(){const Ha=this.Mvc=document.createElement("div");Ha.className=
L.crh;this.domElement.appendChild(Ha);this.nm||this.s3b(Ha,5,730,729);this.W2c()}r8g(){var Ha=document.getElementById(n.a.Quj),tb=document.getElementById(n.a.Ruj);Ha&&!tb&&y.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${Ha.parentNode.id}. progressBar div has child: ${!!Ha.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(n.a.wPd)}`);if(r.a.kgf(this.$)&&Ha&&tb)this.domElement.appendChild(Ha),
this.KKb=Ha.firstChild,this.Nvc=document.getElementById(n.a.wPd),tb.style.visibility="visible";else{Ha=document.createElement("div");tb=document.createElement("div");Ha.className=W.a.lrh;tb.className=W.a.jrh;tb.style.display="none";const bc=document.createElement("div");bc.className=W.a.mrh;const tc=document.createElement("div");tc.className=W.a.krh;const Ma=document.createElement("div");Ma.className=W.a.irh;tb.appendChild(bc);tb.appendChild(tc);tb.appendChild(Ma);Ha.appendChild(tb);this.domElement.appendChild(Ha);
this.KKb=tb;this.Nvc=tc}}GZf(Ha){var tb=this.CK[Ha];if(tb)if(this.mw){const bc=tb.parentNode;this.VOf(tb);tb=aa.a(this.$)?this.IHf[Ha]:this.vwd[Ha];this.CK[Ha]=this.svgIconProvider.Jaa(tb,12,12,bc,24,24)}else tb.className=this.twd[Ha]}VOf(Ha){(null===Ha||void 0===Ha?0:Ha.parentNode)&&Ha.parentNode.removeChild(Ha)}O4g(){const Ha=this.Hcb=document.createElement("div");Ha.className=L.Vqh;this.domElement.appendChild(Ha);this.v9g(Ha)}v9g(Ha){const tb=document.createElement("div");tb.className=L.orh;tb.classList.add(L.Wqh);
this.$.printingEnabled||tb.classList.add(K.a.lPe);Ha.appendChild(tb);this.Yk=document.createElement("ul");Z.DOMElementExtensions.nu(this.Yk,n.a.QVc,null,null);this.Yk.className=K.a.cNe;tb.appendChild(this.Yk);this.f7g();this.vfe=document.createElement("div");this.Hvc.id="SheetIconTooltipContainer";tb.appendChild(this.Hvc)}f7g(){const Ha=document.createElement("div"),tb="<div class='"+W.a.oYg+"'>{0}</div>",bc=Pa.a.bcd(W.a.msh,0,"55_16_N","");Ha.innerHTML=String.format(tb,bc);Ha.className=L.nrh;Z.DOMElementExtensions.setVisible(Ha,
!1);this.Kvc=Ha;this.Yk.appendChild(Ha)}n3c(){const Ha=this.$.xa;for(let tb=0,bc=Ha.count;tb<bc;tb++){const tc=Object(D.a)(fa.a,Ha.getItem(tb));0===tc.Wz&&(this.y3b(tc,!0),tc.active&&tc.activate())}}s_c(){A.a.qc(this.uh);this.uh=[];this.rK=this.Vu=0}s3b(Ha,tb,bc,tc){const Ma=document.createElement("a");Ha.appendChild(Ma);Ha=this.vwd[tb];this.CK[tb]=this.pb(Ma,J.a.instance.ga(tc),0,this.twd[tb],J.a.instance.ga(bc),Ha);if(5===tb||4===tb)Z.DOMElementExtensions.ZJ(this.CK[tb],Ma,!1,"span").style.marginTop=
"10px";this.GZf(tb);bc=this.uwd[tb]=this.ue.Zd(Ma);F.a.instance.ra(z.a.pointerDown,Ma,zb=>zb.ctrlKey&&this.PHi(tb)?!0:this.ozf(tb));F.a.instance.ra(z.a.Mf,Ma,()=>this.pzf());U.a.instance.ra(z.a.te,Ma,()=>this.pzf());F.a.instance.ra(z.a.pointerOut,Ma,()=>this.k_c());X.KeyInputManager.instance.ra(z.a.Kb,Ma,zb=>13!==zb.Ca.keyCode&&32!==zb.Ca.keyCode||this.s1c?!1:(this.s1c=!0,this.ozf(tb)));X.KeyInputManager.instance.ra(z.a.Fd,Ma,zb=>13===zb.Ca.keyCode||32===zb.Ca.keyCode?(this.s1c=!1,this.k_c()):!1);
const Tb=this.ooe();tc=zb=>{"mouseup"===zb.type&&this.uz&&this.uF||Ra.g(zb);Ma.classList.contains(V.a.KT)||(Tb?this.TNi(zb,tb):this.nm||this.qzf(zb,tb))};bc.ka("mouseover",tc);bc.ka("mouseout",tc);bc.ka("focus",tc);bc.ka("blur",tc);Tb&&bc.ka("mouseup",tc)}bcf(Ha){let tb=!1;const bc=this.$.Cf;bc&&(tb=S.a.XM(Z.DOMElementExtensions.getBoundingClientRect(bc),Ha.clientPoint));return tb}ggf(Ha){return S.a.XM(Z.DOMElementExtensions.getBoundingClientRect(this.domElement),Ha.clientPoint)||this.bcf(Ha)}fAh(Ha){let tb=
null;const bc=Ha.clientPoint;let tc=this.Vu;if(this.ggf(Ha))for(tc=this.Vu;tc<=this.rK;tc++)if(tb=this.iQ(tc))if(Ha=Z.DOMElementExtensions.getBoundingClientRect(tb.domElement),!this.isRtl&&bc.x<Ha.x+Ha.width||this.isRtl&&bc.x>Ha.x)break;return{returnValue:tb,vyj:tc>this.rK}}HNb(){if(this.uz){if(!this.tM){y.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.tM=this.w$.cloneNode(!0);if(!this.AUf(this.tM,this.w$,!0,"UpdateDragAndDropState"))return;
this.w$.style.visibility="hidden";this.tM.classList.add(L.prh);this.tM.style.borderRightWidth="";this.pbc=this.kY.clientPoint.x-this.V2.width/2;this.tM.style.left=this.pbc+"px";this.WC=this.oia(this.TZ);0>this.WC&&y.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.i6b&&(this.WC=this.oia(this.TZ));var Ha=Z.DOMElementExtensions.getBoundingClientRect(this.Yk),tb=Ha.x;Ha=Ha.x+Ha.width;let bc=this.kY.clientPoint.x-this.V2.width/2;bc=Math.min(bc,Ha-this.V2.width);
bc=Math.max(bc,tb);this.tM.style.transform="translateX("+Math.abs(bc-this.pbc)*(this.pbc<bc?1:-1)+"px)";const tc=this.kY.clientPoint.x>this.sAb;let Ma=this.kY.clientPoint.x;bc>=Ha-this.V2.width?(Ma=Ha-this.V2.width/2,this.ULd()||this.bma||(y.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.Snc=this.Yk.scrollLeft,this.bma=window.requestAnimationFrame(this.bWf))):bc<=tb?(Ma=tb+this.V2.width/2,this.TLd()||
this.bma||(y.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.Snc=this.Yk.scrollLeft,this.bma=window.requestAnimationFrame(this.aWf))):this.bma&&(y.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.eTd());this.kY.clientPoint.x!==this.sAb&&(this.QTd(tc,Ma),this.sAb=this.kY.clientPoint.x)}else(Ha=({vyj:tb}=this.fAh(this.kY)).returnValue)?
this.uRd(Ha.sheet,tb):this.j7e();this.cKc=!0}QTd(Ha,tb){let bc;for(;({z0b:bc}=this.qhh(tb,Ha)).returnValue;)this.jMb=bc,this.TIg(Ha)}TIg(Ha){if(this.jMb){var tb=(Ha?1:-1)*this.V2.width;if(Ha&&!this.$.mJ||!Ha&&this.$.mJ){var bc=this.w$;var tc=this.WC+1;var Ma=!0}else bc=(tc=this.iQ(this.WC+1))?tc.domElement:null,tc=this.WC-1,Ma=!1;if(this.AUf(this.jMb,bc,Ma,"AnimateSheetSwap")){y.ULS.sendTraceTag(537153738,0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.WC} and other sheet-index ${tc}. amount of sheets in the bar: ${this.EPd} isMovingRight: ${Ha}`);
0<=this.WC&&this.WC<this.uh.length&&0<=tc&&tc<this.uh.length?(Ha=this.uh[tc],this.uh[tc]=this.uh[this.WC],this.uh[this.WC]=Ha):(y.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.uh.length}, ghostIndex: ${this.WC}, swappedSheetIndex: ${tc}`),this.UP());this.WC=tc;var Tb=this.jMb;Tb.style.transform="translateX("+tb+"px)";window.requestAnimationFrame(()=>{Tb.style.transform="translateX(0px)"})}}}AUf(Ha,tb,bc,tc){const Ma=Tb=>Tb?`Node ID: ${Tb.id} , Node class: ${Tb.className}, Node name: ${Tb.nodeName},`:
null;try{return this.Yk.insertBefore(Ha,tb),!0}catch(Tb){return Ha=this.k2a(this.TZ),y.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",Ha?Ha!==this.a6b?"Changed":"NoChange":"Removed",tc,Ma(tb),
Ma(tb.parentNode),Ma(this.Yk),bc,this.WC,this.EPd,Tb),this.UP(),!1}}qhh(Ha,tb){var bc=this.$.mJ===tb?this.iQ(this.WC-1):this.iQ(this.WC+1);if(!bc)return{returnValue:!1,z0b:null};bc=bc.domElement;const tc=Z.DOMElementExtensions.getBoundingClientRect(bc);return this.V2?tb?{returnValue:Ha+this.V2.width/2>=tc.x+.5*tc.width,z0b:bc}:{returnValue:Ha-this.V2.width/2<=tc.x+.5*tc.width,z0b:bc}:(y.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.UP(),{returnValue:!1,z0b:bc})}YVf(Ha,tb){let bc;bc=tb?this.bWf:this.aWf;if(-1===this.zxc)this.zxc=Ha,this.bma=window.requestAnimationFrame(bc);else{Ha=Math.floor((Ha-this.zxc)/1E3*300);var tc=this.HIb>this.ZAb?1:-1;this.scrollLeft(Math.abs(this.Yk.scrollLeft-(tb?this.Snc+Ha*tc:this.Snc-Ha*tc))*(tb?-1:1));if(Ha=this.nYe("ScrollStep"))this.QTd(tb,Ha.x+Ha.width/2),tb&&!this.ULd()||!tb&&!this.TLd()?this.bma=window.requestAnimationFrame(bc):(y.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.eTd())}}ULd(){const Ha=this.HIb>this.ZAb;return Ha&&this.Gma>=this.HIb||!Ha&&this.Gma<=this.HIb}TLd(){const Ha=this.HIb>this.ZAb;return Ha&&this.Gma<=this.ZAb||!Ha&&this.Gma>=this.ZAb}eTd(Ha=!0){this.Yk&&(this.Gma=this.Yk.scrollLeft);window.cancelAnimationFrame(this.bma);this.bma=0;this.zxc=-1;Ha&&this.v_()}BNd(Ha,tb){Ha||y.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${tb}`);this.V2=Ha}PHi(Ha){return 2===Ha?(this.J_(3),
!0):1===Ha?(this.J_(0),!0):!1}ozf(Ha){y.ULS.shipAssertTag(537153732,0,-1===this.SOa&&-1===this.ROa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.SOa&&(window.clearTimeout(this.SOa),this.SOa=-1);-1!==this.ROa&&(window.clearInterval(this.ROa),this.ROa=-1);this.J_(Ha);this.SOa=window.setTimeout(()=>{this.rEj(Ha)},this.CBi);return!0}rEj(Ha){this.ROa=window.setInterval(()=>{this.J_(Ha)},this.BBi)}pzf(){this.k_c();
return!this.uz||!this.uF}k_c(){window.clearTimeout(this.SOa);window.clearInterval(this.ROa);this.ROa=this.SOa=-1;return!0}qzf(Ha,tb){const bc=this.twd[tb];Ba.HelperMethods.eVd(this.CK[tb],bc,bc+n.a.Tcc,"mouseover"===Ha.type||"focus"===Ha.type)}TNi(Ha,tb){const bc=this.ufc(tb),tc=5===tb;if("mouseup"===Ha.type){if(tc||4===tb)bc||this.reorderSheets(null,tc,!1),this.UP()}else!this.uz&&this.uF?(bc||this.uRd(this.s1e(tc?this.rK:this.Vu),tc),this.J_(tc?2:1)):this.nm||this.qzf(Ha,tb)}ufc(Ha){return!!Z.DOMElementExtensions.Zcd(this.CK[Ha],
"a").title}$Ac(Ha){this.gYd(Ha);this.v_()}gYd(Ha){(Ha=this.k2a(Ha))&&Ha.Web()}XLd(){var Ha=this.$.xa;if(Ha.pa&&(!va.e(this.$)||Ha.count))if(Ha=this.oia(Ha.pa),-1===Ha)y.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var tb=this.$Ja(Ha);Ha<this.Vu?this.Jtc(Ha):Ha>this.Vu&&!this.Spd(tb)&&this.scrollIntoView(Ha)}}bRj(){this.Vu=0;this.rK=this.uh.length-1;let Ha=!1;for(let tb=0;tb<this.uh.length;tb++){const bc=this.iQ(tb);if(!bc)break;
const tc=this.Spd(bc.domElement);bc.tabIndex=tc?0:-1;if(!Ha&&tc)this.Vu=tb,Ha=!0;else if(Ha&&!tc){this.rK=tb-1;break}}}Jtc(Ha){this.$.xa.count&&(this.uh.length||this.n3c(),this.SXf(this.$Ja(Math.max(0,Math.min(Ha,this.uh.length-1)))),this.v_())}scrollIntoView(Ha){y.ULS.shipAssertTag(537153697,0,Ha>=this.Vu,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!");if(this.$.xa.count){this.uh.length||this.n3c();var tb=this.$Ja(Math.max(0,Math.min(Ha,
this.uh.length-1))),bc=this.$Ja(this.Vu);if(!this.Spd(tb)){tb=Z.DOMElementExtensions.getBoundingClientRect(tb);var tc=Z.DOMElementExtensions.getBoundingClientRect(this.Hcb);tb=this.isRtl?tc.x-tb.x:tb.x+tb.width-(tc.x+tc.width);for(tc=0;bc&&tc<tb;){const Ma=Z.DOMElementExtensions.getBoundingClientRect(bc);tc+=Ma.width;bc=bc.nextSibling}bc?this.SXf(bc):y.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.Vu}, lastVisibleSheetTabIndex = ${this.rK}, scroll to index: ${Ha}`)}this.v_()}}SXf(Ha){const tb=
Z.DOMElementExtensions.getBoundingClientRect(this.Yk);Ha=Z.DOMElementExtensions.getBoundingClientRect(Ha);this.isRtl?this.scrollLeft(Math.floor(tb.x+tb.width-(Ha.x+Ha.width+.5))):this.scrollLeft(Math.ceil(tb.x-Ha.x-.5))}scrollLeft(Ha){(0>Ha&&this.ULd()||0<Ha&&this.TLd())&&y.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const tb=this.Yk.scrollLeft;if(this.isRtl){if(x.a.wF||x.a.Tf){this.Yk.scrollLeft=this.Gma=tb-Ha;return}if(x.a.JH){this.Yk.scrollLeft=
this.Gma=tb+Ha;return}y.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Yk.scrollLeft=this.Gma=tb-Ha}Spd(Ha){Ha=Z.DOMElementExtensions.getBoundingClientRect(Ha);const tb=Z.DOMElementExtensions.getBoundingClientRect(this.Hcb);return Ha&&tb?Ha.x>=tb.x-1&&Ha.x+Ha.width<=tb.x+tb.width+1:(y.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}H7g(){const Ha=this.Mvc;if(sa.j1f(this.$))this.nm?
(A.a.Ia(this.DH),this.DH=new sa(Ha,this.$,this,!0)):(A.a.Ia(this.DH),this.DH=null);else if(!this.DH||this.nm)A.a.Ia(this.DH),qa.k(this.$.pg)?this.DH=new Lb(Ha,this.$,this):this.DH=new sa(Ha,this.$,this)}kDe(Ha,tb){var bc=this.$.xa;if(!this.$.isEditMode||!bc.count)A.a.Ia(tb),tb=null;else if(!tb)if(bc=this.nm?this.GPd:this.Mvc,qa.k(this.$.pg))tb=new Lb(bc,this.$,this);else switch(Ha){case 0:tb=new sa(bc,this.$,this);break;case 1:tb=new Ya(bc,this.$,this);break;default:y.ULS.sendTraceTag(537153692,0,
10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return tb}W2c(){u.EwaSettings.ma(424)?(this.DH=this.kDe(0,this.DH),this.Dxb=this.kDe(1,this.Dxb)):this.H7g()}nYe(Ha){const tb=Z.DOMElementExtensions.getBoundingClientRect(this.tM);tb||(y.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${Ha}: GetBoundingClientRect returned null for the dragged sheet.`),this.UP());
return tb}W4e(Ha,tb){this.nta.aKg(Ha,tb);this.UP(!1);this.jOd(this.navigationButtonsDisabled);for(const bc of this.ZGj)bc&&bc.yW(this.navigationButtonsDisabled);for(const bc of this.fse)bc&&bc.yW(this.operationButtonsDisabled)}static Xcj(Ha,tb,bc,tc){Ha<bc?(tb>bc&&bc--,tb>tc&&tc--):Ha>tc?(tb<bc&&bc++,tb<tc&&tc++):tb<bc&&bc++;return{JAh:bc,Npi:tc}}}Object(t.a)(db,"SheetTabBarControl",T.a,[371,2,102]);class Xa extends v.a{constructor(Ha){super();this.$=Ha;this.Fb()}create(){const Ha=this.$.Bb;if(w.a(this.$.ya,
1))nb.PageLoadTrackingInfo.instance.Sca(n.a.bAa,["sheetTabBar"]);else{var tb=document.getElementById(Ha+n.a.t4c);tb?(u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&nb.PageLoadTrackingInfo.instance.Pza(n.a.bAa),r.a.cpd()?f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ra(this.$.da,388,387,this.hb),bc=>{this.qb(this.$.da.za(32)||new db(this.$,tb,bc.result))},this.$.la,3):this.qb(this.$.da.za(32)||new db(this.$,tb))):nb.PageLoadTrackingInfo.instance.Sca(n.a.bAa,["sheetTabBar"])}}static ka(Ha){Ha.da.Ga(33,
new Xa(Ha))}}Object(t.a)(Xa,"SheetTabBarFactory",v.a,[]);a.d(C,"a",function(){return gb});const gb=()=>{c.a.Fa(Ha=>{Xa.ka(Ha);m.ka(Ha)})}},1144:function(t,C,a){var c=a(10);t=a(0);var b=a(691),d=a(50),f=a(37),e=a(15),k=a(4),l=a(31),m=a(5),v=a(24),n=a(77),w=a(58);class r{constructor(mb,Ca){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=mb;this.sortType=Ca}yU(){return this.autoFilterOptions}}Object(t.a)(r,"MacroRecorderRangeColumnSortedOrFilteredPayload",null,[101]);class u{constructor(mb){this.autoFilterOptions=
null;this.autoFilterOptions=mb}yU(){return this.autoFilterOptions}}Object(t.a)(u,"MacroRecorderRangeItemFilteredPayload",null,[101]);var y=a(925),x=a(43),B=a(368),z=a(170),A=a(61),I=a(162),F=a(239),U=a(47),X=a(45),S=a(12),H=a(281),D=a(1),J=a(182),M=a(22),G=a(280),T=a(21);class K{constructor(mb,Ca){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=mb;this.tableRange=x.l(mb.Ranges[0],mb.SheetName);this.styleIndex=Ca}}Object(t.a)(K,"MacroRecorderTableStyleAppliedPayload",null,
[101]);class L extends K{constructor(mb,Ca,$a,Kb){super(mb,$a);this.isCreation=this.hasHeaders=!1;this.hasHeaders=Ca;this.isCreation=Kb}}Object(t.a)(L,"MacroRecorderRangeFormatedAsTablePayload",K,[]);class V{constructor(mb,Ca,$a){this.description=this.title=this.tableRange=null;this.tableRange=mb;this.title=Ca;this.description=$a}Fm(){return this.tableRange}getTitle(){return this.title}getDescription(){return this.description}}Object(t.a)(V,"MacroRecorderTableAltTextEditedPayload",null,[101]);class W{constructor(mb,
Ca){this.newName=this.oldName=null;this.oldName=mb;this.newName=Ca}}Object(t.a)(W,"MacroRecorderTableRenamedPayload",null,[101]);class da{constructor(mb){this.originalRange=null;this.originalRange=mb}}Object(t.a)(da,"MacroRecorderTableResizedPayload",null,[101]);class qa{constructor(mb,Ca,$a){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=mb;this.optionType=Ca;this.isPivotTable=$a}}Object(t.a)(qa,"MacroRecorderTableStyleOptionToggledPayload",null,[101]);class O{constructor(mb,
Ca){this.tableRange=null;this.templateId=-1;this.tableRange=mb;this.templateId=Ca}Fm(){return this.tableRange}}Object(t.a)(O,"MacroRecorderSampleTableCreatedPayload",null,[101]);var ea=a(29),R=a(42);class oa{constructor(mb){this.tableName=null;this.tableName=mb}}Object(t.a)(oa,"MacroRecorderTableConvertedToRangePayload",null,[101]);var pa=a(741);class Pa{constructor(mb,Ca,$a){this.Hod=!1;this.sharedSheetRange=Ca;this.$=mb;this.Yh=this.$.Ib.Og("UserAction","ConvertToRangeManager");this.tableName=$a}o$a(){this.Yh.start();
const mb=this.$.oa.va.Sb();return pa.i(this.$.oa.va,this.sharedSheetRange,Ca=>{this.showDialog(Ca)},null,null,null,mb)}showDialog(mb){e.ULS.sendTraceTag(537151193,0,50,`ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is ${this.Yh.uc} milliseconds`);mb&&!H.a(mb)&&((this.Hod=mb.Result)?(mb=ea.a.Yc(3,2,0,743,0,-66108047,"ConvertToRange"),f.TaskExtensions.Aa(R.a(this.$).oj(mb),Ca=>{e.ULS.sendTraceTag(537151192,0,50,`ConvertToRangeManager.ShowDialog: Time taken for User Input is ${this.Yh.uc} milliseconds`);
0===Ca.result&&this.G2g()},this.$.la,11)):this.H2g());this.Yh.stop();e.ULS.sendTraceTag(537151191,0,50,`ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is ${this.Yh.uc} milliseconds`)}ste(){const mb={};mb.IsQueryTable=this.Hod;mb.Range=this.sharedSheetRange;return mb}G2g(){const mb=this.$.oa.va;e.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");this.faf(194,(Ca,$a,Kb)=>pa.d(mb,this.ste(),Ca,$a,Kb,null));e.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")}H2g(){const mb=
this.$.oa.va;e.ULS.sendTraceTag(537151188,0,50,"Convert To Range initiated for Normal Table");this.faf(193,(Ca,$a,Kb)=>pa.c(mb,this.ste(),Ca,$a,Kb,null),()=>new oa(this.tableName));e.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")}faf(mb,Ca,$a=null){B.a(this.$.userOperationManager,Ca,Kb=>new z.a(mb,0,Kb,void 0,$a),null)}}Object(t.a)(Pa,"ConvertToRangeManager",null,[]);var Z=a(1123),Ra=a(1122),Ga=a(1255),Ba=a(14);class fa extends Ga.a{constructor(mb,Ca){super(mb,Ba.a.instance.ga(737));
this.DAa=Ca}get oc(){return"FormatAsTableDialog"}get Rw(){return 215}jj(){const mb=x.s(this.DC.TableRange);return()=>new L(mb,this.w4a.checked,this.DAa,!0)}KA(){const mb=x.s(this.DC.TableRange);return(Ca,$a,Kb)=>pa.h(this.$.oa.va,mb,this.w4a.checked,!1,this.DC.HasTotalRow,this.DAa,Ca,$a,Kb,null)}dy(mb,Ca,$a){super.dy(mb,Ca,$a)}}Object(t.a)(fa,"FormatAsTableDialogDeprecated",Ga.a,[]);Ga=a(946);class Y extends Ga.a{constructor(mb,Ca){super(mb);this.DAa=Ca}get oc(){return"FormatAsTableDialog"}get Rw(){return 215}get Gl(){return Ba.a.instance.ga(737)}jj(){const mb=
x.s(this.DC.TableRange);return()=>new L(mb,this.hasHeaders,this.DAa,!0)}KA(){const mb=x.s(this.DC.TableRange),Ca=this.DC.HasTotalRow;return($a,Kb,rb)=>pa.h(this.$.oa.va,mb,this.hasHeaders,!1,Ca,this.DAa,$a,Kb,rb,null)}}Object(t.a)(Y,"FormatAsTableReactDialog",Ga.a,[]);Ga=a(282);var ja=a(96);class ca extends Ga.a{constructor(mb){super(mb);this.nHj=(Ca,$a)=>{1===Ca&&this.YLj(x.D(this.rFf($a[ca.OKf])))};this.Xub=Ca=>{Ca=this.Kdd(Ca);return this.hbd(Ca)};this.gridView=T.g(mb);this.sa=this.gridView.ha.sa;
this.Tnc=this.gridView.Db.Yj(this.sa.activeCell).usedRange;mb=this.KM(this.Tnc.toString());this.initializeAndShow(Ba.a.instance.ga(738),this.nHj,mb)}get oc(){return"ResizeTableDialog"}rFf(mb){mb=mb.startsWith("=")?mb.substring(1,mb.length):mb;if(({sheetName:mb,range:Ca}=x.Z(mb,this.$.xa)).returnValue&&Ca){var Ca=x.v(Ca,this.$);Ca.SheetName=M.a.equals(mb,"",!0)?this.$.pa.name:mb;return Ca}return null}KM(mb){return{[ca.U3]:"ResizeTableDialog",[ca.OKf]:mb,["getInputErrorIfInvalid"]:this.Xub}}Kdd(mb){mb=
this.rFf(mb);if(!mb)return 1;const Ca=x.D(mb);return M.a.equals(mb.SheetName,this.$.pa.sheetName,!0)&&this.Tnc.top===Ca.top&&this.Tnc.Dd(Ca)?0:2}hbd(mb){let Ca="";switch(mb){case 1:Ca=Ba.a.instance.ga(75);break;case 2:Ca=ja.a.Ah(Ba.a.instance.ga(74))}return Ca}YLj(mb){this.$.ud(-1400250766,n.a.Eb,8,{["ResizeTableRange"]:mb,["OriginalTableRange"]:this.Tnc})}}ca.U3="id";ca.OKf="range";Object(t.a)(ca,"ResizeTableDialog",Ga.a,[]);class aa extends Ga.a{constructor(mb){super(mb);mb=T.g(this.$);mb=mb.Db.Yj(mb.ha.sa.activeCell);
M.a.Dh(mb.zSa)?this.yBd="":this.yBd=mb.zSa;M.a.Dh(mb.ASa)?this.xBd="":this.xBd=mb.ASa;mb=this.KM(this.yBd,this.xBd);this.initializeAndShow(Ba.a.instance.ga(747),this.dHj,mb)}get oc(){return"TableAltTextDialog"}dHj(mb,Ca){1===mb&&(mb=Ca[aa.GJj],Ca=Ca[aa.bdh],mb===this.yBd&&Ca===this.xBd||this.$.ud(868579142,n.a.Eb,8,{["Title"]:mb,["Description"]:Ca}))}KM(mb,Ca){return{["id"]:"AltTextDialog",["title"]:mb,["description"]:Ca}}}aa.U3="id";aa.GJj="title";aa.bdh="description";Object(t.a)(aa,"TableAltTextDialog",
Ga.a,[]);var ta=a(767),xa=a(768),ia=a(112),ya=a(68),ib=a(55),wa=a(33);class sa{constructor(mb,Ca,$a,Kb){this.menuId=null;this.KQa=-1;this.QCf=()=>{this.Hca()};this.ySi=rb=>{if(!(this.sa.lLa()||(!D.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||H.a(rb)||this.CLa())&&H.a(rb)&&this.CLa())){rb=this.sa.activeCell;var cc=this.sa.activeRange;const nc=this.tableManager.Jg.usedRange;2===this.KQa&&I.g(this.tableManager.Jg)&&rb.bottom===nc.bottom&&(cc=cc.D4?new v.Range(cc.top-
1,cc.left,cc.bottom-1,cc.right,!1,!0):new v.Range(cc.top,cc.left,cc.bottom-1,cc.right,!1,!0),rb=cc.contains(rb)?rb:v.Range.Uc(cc.bottom,rb.left),T.g(this.$).ha.updateSelection(cc,rb,0,3))}};this.QRi=rb=>{H.a(rb)?(e.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),this.$.qf()):e.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};this.PRi=()=>{e.ULS.sendTraceTag(594130060,0,
15,"TableManager.OnTableRenameFailure-Rename table failed");this.$.qf()};this.RRi=(rb,cc)=>{cc&&this.sL(cc);H.b(rb,-569193796)&&(ya.a(this.$).jd.XL(-569193796),this.Cqi(rb.Errors[0]))};this.$=mb;this.tableManager=Ca;this.namedSheetViewPublic=$a;this.frame=this.$.frame;this.ha=T.g(this.$).ha;this.sa=this.ha.sa;this.nz=D.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.tableStyleManager=Kb;this.tableStyleManager.hGg(this.QCf)}Nc(mb,Ca){switch(Ca){case -544558380:return!(this.tableManager&&
this.sa.FH()&&!this.CLa()&&I.d(this.tableManager.Jg));case 1544516694:return!(this.tableManager&&(this.sa.FH()?!this.CLa():this.sa.lLa()));case -697806646:case 323142015:return!this.sa.FH();case 341449783:case 2128797448:return D.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.sa.FH()?!this.CLa():this.sa.lLa())):!(this.tableManager&&this.tableManager.Tpd(this.sa.activeCell));case -123538519:return!(this.sa.FH()&&this.tableStyleManager&&
this.tableStyleManager.Upd());case 756677940:return!(D.EwaSettings.ma(407)&&this.ddi());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&this.edi());case 844144422:return!this.sa.FH();case -723113214:return!(D.EwaSettings.isChangeGateEnabled("OfficeVSO:6680193_FlighRemovalTableAltText")&&this.sa.FH());case 1371713064:case -605127244:return this.sa.FH()}return!1}executeCommand(mb,Ca,$a){var Kb;mb=f.TaskExtensions.fk();const rb=this.$.oa.va;let cc=null,nc=1;const Wb=Ca.command,
Ea=this.$.oa.va.Sb();let ua=null;switch(Wb){case -2058042992:const fb=w.a.Vh($a[n.a.Zf]);D.EwaSettings.isChangeGateEnabled("OfficeVSO:7010744_RegressionFix_MacroRecording_ClearFilterInAFMenu")&&!fb.CriteriaType&&(fb.CriteriaType=0);sa.PXf(this.$,fb);cc=(nb,va,db)=>pa.a(rb,fb,null,null,!1,!1,!1,ta.a.ava(ia.a.Lra,xa.a.clearAutoFilter,nb),va,db,null);nc=176;ua=()=>new u(fb);break;case 504133448:case -798968736:case 477776686:const sb=w.a.Vh($a[n.a.Zf]),Ua=$a.TopCellAddress;sa.PXf(this.$,sb);const ab=
504133448===Ca.command?1:-798968736===Ca.command?2:3;if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")&&Ua){$a=this.tableManager.Fm(Ua);if(!$a&&D.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")){var ma=this.$.xa.pa;(null===(Kb=x.D(ma.$_))||void 0===Kb?0:Kb.contains(Ua))?$a=x.D(ma.$_):e.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(!D.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||
$a&&!this.$.GVc([$a],!0,1))break}else if($a&&!this.$.rq([$a],!0,1))break}cc=(nb,va,db)=>A.H(rb,sb,ab,G.b(nb,this.RRi),va,db,Ua,Ea);nc=177;ua=()=>new r(sb,ab);break;case 341449783:case 2128797448:this.KQa=341449783===Wb?0:2;({ABa:cc,operationName:nc,jj:ua}=this.toggleTableStyleOption(rb,Ea));break;case -712419744:this.nz?this.R$e($a[m.a.event]):this.R$e(null);break;case 1371713064:Kb=$a[n.a.Pc];let na=x.r(this.sa.selectedRanges,this.$);if(!Kb||!na)break;const Na=Number.parseInvariant(Kb);cc=(nb,va,
db)=>pa.e(rb,na,Na,nb,va,db,null,Ea);ua=()=>new O(na,Na);nc=1025;break;case 1868184698:if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({byb:Kb,ABa:cc,jj:ua}=this.G$f(null,Ea),Kb)){nc=206;break}D.EwaSettings.isChangeGateEnabled("OfficeVSO:6690600_FlightRemovalTableDialogMigration")?new Ra.a(this.$):(Kb=new Z.a(this.$),Kb.initialize(),Kb.Ff());break;case 844144422:new ca(this.$);break;case 1544516694:case -544558380:if(Kb=$a[n.a.Pc])this.KQa=this.OXh(Kb),-1!==this.KQa&&
({ABa:cc,operationName:nc,jj:ua}=this.toggleTableStyleOption(rb,Ea));break;case 756677940:if(this.CLa()&&this.Tef()){e.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");break}const Va=$a.Text,Sa=this.ZPh();if(Sa){cc=(va,db,Xa)=>pa.j(rb,Va,Sa,G.b(va,this.QRi),G.a(db,this.PRi),Xa,Ea);nc=217;let nb=null;this.tableManager.Jg?nb=this.tableManager.Jg.name:this.tableManager.dEd?
nb=this.tableManager.dEd.name:e.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");nb&&(ua=()=>new W(nb,Va))}else return e.ULS.sendTraceTag(537151175,0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),ib.Task.Ta(!1);break;case 323142015:if(this.CLa())break;return(new Pa(this.$,this.ybd(),this.tableManager.Jg.name)).o$a();case -1400250766:nc=
211;cc=this.Zfj($a,rb,Ea);const vb=x.m($a.OriginalTableRange,this.$.xa.pa);ua=()=>new da(vb);break;case 1872288872:this.tableManager.n2i();break;case -123538519:const Oa=this.NXh($a);Kb=M.a.contains($a[n.a.Pc],m.a.bGb,!0)||M.a.contains($a[m.a.bG],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";e.ULS.sendTraceTag(51181323,0,50,`TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from ${Kb} with style index ${Oa.toString()}`);let yb=this.f1e();yb&&(cc=(nb,va,db)=>pa.b(rb,
yb,Oa,nb,va,db,null,Ea),ua=()=>new K(yb,Oa),nc=212);break;case 753331043:Kb=$a[n.a.Pc];if(!Kb)break;const Ob=Number.parseInvariant(Kb);if(this.sa.FH()){e.ULS.sendTraceTag(51181321,0,50,`TableCommandHandler.FormatAsTable invoked on existing table with style index: ${Ob}`);let nb=this.f1e();nb&&(cc=(va,db,Xa)=>pa.h(rb,nb,!1,!1,!1,Ob,va,db,Xa,null,Ea),ua=()=>new L(nb,!1,Ob,!1),nc=215);break}if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({byb:$a,ABa:cc,jj:ua}=this.G$f(Ob,
Ea),$a)){nc=215;break}e.ULS.sendTraceTag(51181322,0,50,`TableCommandHandler.FormatAsTable invoked on newly created table with style index: ${Ob}`);D.EwaSettings.isChangeGateEnabled("OfficeVSO:6690600_FlightRemovalTableDialogMigration")?new Y(this.$,Number.parseInvariant(Kb)):(Kb=new fa(this.$,Number.parseInvariant(Kb)),Kb.initialize(),Kb.Ff());break;case 71074531:const Ja=$a.HasHeader,lb=$a.TableRange;cc=(nb,va,db)=>pa.f(rb,lb,Ja,!1,!1,nb,va,db,null);ua=()=>new y.a(Ja,lb);nc=206;break;case -723113214:new aa(this.$);
break;case 868579142:e.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");nc=1022;const Pb=$a.Title,Jb=$a.Description,Lb=this.ybd();cc=(nb,va,db)=>pa.g(rb,Pb,Jb,Lb,nb,va,db,null);let Ab;this.tableManager.Jg&&(ma=M.a.Dh(this.tableManager.Jg.zSa)?"":this.tableManager.Jg.zSa,Ab=M.a.Dh(this.tableManager.Jg.ASa)?"":this.tableManager.Jg.ASa);ua=Pb==ma?()=>new V(Lb,void 0,Jb):Jb==Ab?()=>new V(Lb,Pb,void 0):()=>new V(Lb,Pb,Jb);break;default:return J.a(Wb)}if(cc){const fb=sb=>new z.a(nc,0,sb,void 0,
ua);mb=!this.namedSheetViewPublic||-2058042992!==Wb&&504133448!==Wb&&-798968736!==Wb&&477776686!==Wb?B.a(this.$.userOperationManager,cc,fb,Ca):this.namedSheetViewPublic.ORa().continueWith(sb=>{sb.result&&B.a(this.$.userOperationManager,cc,fb,Ca)})}return mb}toggleTableStyleOption(mb,Ca){const $a=this.sa.lLa();e.ULS.sendTraceTag(41996800,0,50,`TableCommandHandler: The selected ${$a?"PivotTable":"table"} style option ${this.KQa} was toggled.`);const Kb=this.ybd();return{ABa:(rb,cc,nc)=>pa.l(mb,Kb,this.KQa,
G.b(rb,this.ySi),cc,nc,null,Ca),operationName:196,jj:()=>new qa(Kb,this.KQa,$a)}}Zfj(mb,Ca,$a){const Kb=mb.OriginalTableRange,rb=x.m(mb.ResizeTableRange,this.$.xa.pa),cc=()=>{this.tableManager.I7f(Kb)},nc=Wb=>{Wb.Errors&&this.tableManager.I7f(Kb)};return(Wb,Ea,ua)=>pa.k(Ca,rb,G.b(Wb,nc),G.a(Ea,cc),ua,null,$a)}NXh(mb){var Ca=-1;mb[n.a.Pc]&&(Ca=mb[n.a.Pc],Ca=M.a.contains(Ca,m.a.bGb,!0)?this.tableStyleManager.Wub(Ca):Number.parseInvariant(mb[n.a.Pc]));return Ca}Cc(mb,Ca){mb=!1;switch(Ca.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:mb=
!0;break;case 756677940:mb=D.EwaSettings.ma(407);break;case -723113214:case 868579142:mb=D.EwaSettings.isChangeGateEnabled("OfficeVSO:6680193_FlighRemovalTableAltText");break;case 1371713064:mb=D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateSampleTable",!1)}return mb}Rc(mb,Ca,$a){mb=!1;switch(Ca){case "PopulateTableMoreStylesMenu":this.menuId=$a.MenuId;this.tableStyleManager.Upd()||this.tableStyleManager.Y3a("formatAsTableMenu");mb=this.tableStyleManager.LGf(Ca,$a);break;case "PopulateTableAccessibleStylesMenu":this.menuId=
$a.MenuId,this.tableStyleManager.Upd()||this.tableStyleManager.Y3a("accessibilityTab"),mb=this.tableStyleManager.LGf(Ca,$a)}return mb}dispose(){this.tableStyleManager.Tbj(this.QCf)}Hca(){(M.a.contains(this.menuId,"Format",!0)||M.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.Qw(this.menuId)}ybd(){return x.v(this.sa.activeCell,this.$)}ZPh(){const mb=this.tableManager.grd;return mb?x.v(mb,this.$):null}R$e(mb){if(this.tableManager){var Ca=T.g(this.$),$a=this.sa.activeCell,Kb=this.tableManager.Fm($a),
rb=null;if(!Kb||Kb.aSa)for(let cc of Ca.iha)for(let nc of cc)Ca=nc.Sn,$a.left>=Ca[0]&&$a.left<=Ca[Ca.length-1]&&(rb=(Ca=nc.Tr($a).ZJ())?S.DOMElementExtensions.Kj(Ca,l.a.aoe):null);else{const cc=Ca.Vb(v.Range.Uc(Kb.top,$a.left));if(this.nz){U.a.instance.create(()=>{cc.invoke(8,mb)},0,X.a.z7f,!0,!0);return}rb=cc.KJa(56).l5a}rb&&U.a.instance.create(()=>{S.DOMElementExtensions.Vdc(rb,null)},0,X.a.z7f,!0,!0)}}OXh(mb){mb=Number.parseInvariant(mb);return-1<mb&&8>=mb?mb:-1}CLa(){return!this.tableManager.Jg}Tef(){return this.tableManager.dEd?
!1:(e.ULS.sendTraceTag(537151173,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)}edi(){const mb=this.sa.FH(),Ca=this.sa.wg&&!T.g(this.$).Db.u4(this.sa.Wc);return mb||Ca}ddi(){return this.sa.FH()||!this.Tef()}QXh(mb){const Ca=[];for(const $a of mb)if(mb=F.b(this.$,$a),null===mb||void 0===mb?0:mb.length)for(const Kb of mb)Kb.usedRange&&!Ca.includes(Kb.usedRange)&&Ca.push(Kb.usedRange);return Ca}f1e(){const mb=this.sa.selectedRanges;let Ca=[];if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))Ca=
this.QXh(mb);else for(const $a of mb)T.g(this.$).Db.u4($a)&&Ca.push($a);return Ca&&Ca.length?x.r(Ca,this.$):null}sL(mb){wa.a.gba(this.$)&&f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ra(this.$.da,430,431,1),Ca=>{Ca.result.g7(mb);e.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)}Cqi(mb){f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ra(this.$.da,446,447,0),Ca=>{Ca.result.D9g(this.$,mb)},this.$.la,3)}static PXf(mb,Ca){Ca.SheetName=
mb.pa.name;Ca.NamedObjectView=mb.ea.isNamedObjectViewMode}G$f(mb,Ca){let $a,Kb;if(!this.sa.wg||1!=this.sa.Wc.WG)return{byb:!1,ABa:$a,jj:Kb};let rb=x.v(this.sa.Wc,this.$);rb.LastColumn=rb.FirstColumn+3-1;rb.LastRow=rb.FirstRow+4-1;const cc=x.D(rb),nc=T.g(this.$);if(!cc.xz||!nc.Db.zwa(cc))return{byb:!1,ABa:$a,jj:Kb};k.AFrameworkApplication.XH("XLS-CreateTableInEmptyCell-Treatment;XLS-CreateTableInEmptyCell-Control");if(!D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateTableInEmptyCell",
!1))return{byb:!1,ABa:$a,jj:Kb};if(null==mb)$a=(Wb,Ea,ua)=>pa.f(this.$.oa.va,rb,!1,!1,!1,Wb,Ea,ua,Ca),Kb=()=>new y.a(!1,rb);else{const Wb=x.s(rb);$a=(Ea,ua,ma)=>pa.h(this.$.oa.va,Wb,!1,!1,!1,mb,Ea,ua,ma,Ca);Kb=()=>new L(Wb,!1,mb,!0)}return{byb:!0,ABa:$a,jj:Kb}}}Object(t.a)(sa,"TableCommandHandler",null,[195]);class Ya extends b.a{constructor(mb){super(mb)}dispose(){super.dispose()}yd(){const mb=d.GetServiceTaskFactory.create(this.$.da,134,this.la,this.hb),Ca=d.GetServiceTaskFactory.create(this.$.da,
330,this.la,this.hb),$a=d.GetServiceTaskFactory.Ra(this.$.da,309,310,this.hb);f.TaskExtensions.Aa(ib.Task.zL(mb,$a,Ca),()=>{this.gd([new sa(this.$,mb.result,$a.result,Ca.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)}static ka(mb){b.a.Nd(86,new Ya(mb))}}Object(t.a)(Ya,"TableCommandHandlerFactory",b.a,[]);a.d(C,"a",function(){return bb});const bb=()=>{c.a.Fa(mb=>{Ya.ka(mb)})}},1150:function(t,C,a){var c=a(10),b=a(1);t=a(0);var d=a(221),f=a(15),e=
a(31),k=a(5),l=a(12),m=a(22),v=a(14),n=a(253),w=a(21),r=a(30);class u{constructor(Y){this.ptc=Y||""}static get FJe(){return u.I4d||(u.I4d=new u(""))}static get Gtd(){return u.D$d||(u.D$d=u.Qad(2).ptc)}static F2a(Y){Y=r.a.Eg(Y||"");return new u(Y)}static n9b(Y){return u.F2a(v.a.instance.ga(Y))}static Qad(Y){return new u(v.a.instance.Xa(Y))}static iDh(Y,...ja){return u.hDh(v.a.instance.ob(Y),...ja)}static hDh(Y,...ja){const ca=ja.length,aa=Array(ca);for(let ta=0;ta<ca;ta++)aa[ta]=(ja[ta]||u.FJe).ptc;
return new u(String.format(Y,aa))}}u.I4d=null;u.D$d=null;Object(t.a)(u,"SafeHtml",null,[384]);const y=(Y,ja)=>{ja&&(Y.append(ja),Y.append(u.Gtd))};class x{constructor(Y,ja,ca){this.Juf=(aa,ta)=>{this.vLf(ta.Jd.command)};this.$=Y;this.sea=document.createElement("div");this.sea.setAttribute(k.a.jP,k.a.lk);this.sea.className=e.a.g8c;ja.insertBefore(this.sea,ca);this.Efa=document.createElement("div");this.Efa.setAttribute(k.a.jP,k.a.lk);this.Efa.className=e.a.g8c;ja.insertBefore(this.Efa,this.sea);this.Srg=
v.a.instance.Xa(2);this.Cga=document.createElement("div");this.Cga.setAttribute(k.a.Kd,k.a.Dra);this.Cga.setAttribute(k.a.Fra,k.a.vnb);this.Cga.className=e.a.g8c;ja.insertBefore(this.Cga,this.Efa);this.register();this.$.da.Ga(211,this)}get kxa(){return this.Srg}get isActive(){return!0}get activeCell(){return w.g(this.$).Vb(null)}dispose(){this.$&&this.unregister();l.DOMElementExtensions.pf(this.Cga);l.DOMElementExtensions.pf(this.sea);l.DOMElementExtensions.pf(this.Efa);this.Efa=this.sea=this.Cga=
this.$=null}setEnabled(Y){this.EYf(this.Efa,Y)}opj(){this.EYf(this.sea,!0)}readText(Y){this.JGb(u.F2a(Y),!0)}pPa(Y){this.JGb(u.F2a(Y),!1)}yLf(Y,ja){if(1>ja||!Y)f.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var ca=new Sys.StringBuilder;Y=String.format(v.a.instance.ob(34),ja,Y);y(ca,Y);y(ca,v.a.instance.ga(861));this.JGb(u.F2a(ca.toString()),!1)}}Q4i(Y,ja,ca){if(1>ca||1>ja||ja>ca||!Y)f.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var aa=new Sys.StringBuilder;
y(aa,Y);aa.append(String.format(v.a.instance.ob(55),ja,ca));this.JGb(u.F2a(aa.toString()),!1)}}vLf(Y){Y=this.fVh(Y);this.JGb(Y,!1)}JGb(Y,ja){if(Y=Y?Y.ptc:null)ja=ja?this.Efa:this.sea,m.a.equals(ja.innerHTML,Y,!1)&&(Y+=u.Gtd),ja.innerHTML=Y}mab(Y,ja){this.Cga.getAttribute(k.a.Fra)!==ja&&this.Cga.setAttribute(k.a.Fra,ja);Y=Y?u.F2a(Y).ptc:"";this.Cga.innerHTML=Y}R4i(Y,ja,ca,aa){const ta=v.a.instance.ob(54);f.ULS.shipAssertTag(537153949,0,!(void 0===Y||null===Y));f.ULS.shipAssertTag(537153948,0,!(void 0===
ja||null===ja));f.ULS.shipAssertTag(537153947,0,!(void 0===ca||null===ca));f.ULS.shipAssertTag(537153946,0,!(void 0===aa||null===aa));f.ULS.shipAssertTag(537153945,0,!(void 0===ta||null===ta));Y=String.format(ta,Y||"",ja||"",ca||"",aa||"");this.mab(Y,k.a.TYa)}RPj(Y){var ja=this.Efa.style;Y?(Y=n.a.R_b(Y.cell,ja),ja=Y.FB,ja.top=ja.left=ja.bottom=ja.right=null,Y.P1()):ja.cssText=""}fVh(Y){switch(Y){case -1985798686:return u.n9b(12);case -911352779:return u.n9b(11);case 237279923:return u.n9b(13);case -1502853784:return u.Qad(81);
case -111689794:return u.Qad(78);case -287251124:return this.Yed(1335,ja=>ja.bold);case -1925065947:return this.Yed(1336,ja=>ja.italic);case 1764140053:return this.Yed(1337,ja=>ja.underline)}return null}register(){f.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(f.ULS.shipAssertTag(537153943,0,!!this.$.Ka,"Can't register to CommandHandlerManager's event"),this.$.Ka&&this.$.Ka.fFa(this.Juf))}unregister(){this.$&&this.$.Ka.mza(this.Juf)}EYf(Y,ja){const ca=Y===
this.sea;ja?(Y.setAttribute(k.a.Fra,k.a.TYa),ca&&Y.setAttribute(k.a.Kd,k.a.Dra),Y.setAttribute(k.a.jP,k.a.fr),Y.removeAttribute(k.a.jP),Y.innerHTML+=" "):(Y.removeAttribute(k.a.Fra),ca&&Y.removeAttribute(k.a.Kd),Y.setAttribute(k.a.jP,k.a.lk))}Yed(Y,ja){const ca=this.activeCell;if(!ca)return null;ja=ja(ca)?7:8;return u.iDh(ja,u.n9b(Y))}}Object(t.a)(x,"AriaLiveNotifier",null,[356,344,2]);class B extends d.a{constructor(Y){super();this.$=Y;this.Fb()}create(){this.qb(this.$.da.za(211)||new x(this.$,this.$.Qu,
this.$.Cf))}static ka(Y){Y.da.Ga(212,new B(Y))}}Object(t.a)(B,"AriaLiveNotifierFactory",d.a,[]);var z=a(27),A=a(213),I=a(137),F=a(67);class U{constructor(Y,ja){this.u_=this.NV=this.MN=null;this.Aia=ja;this.I8g(Y);this.MZi();b.EwaSettings.xb()&&Y.da.Ga(244,this)}get isActive(){return!!this.Aia&&document.activeElement===this.Aia}readText(Y){Y=String.format(v.a.instance.ob(30),Y);this.MN.setAttribute(k.a.Mt,Y);this.NV.setAttribute(k.a.Mt,Y);this.JGj()}dispose(){this.u_&&this.u_.parentNode&&this.u_.parentNode.removeChild(this.u_);
this.NV=this.MN=this.u_=this.Aia=null}I8g(Y){var ja=Y.Bb+"readoutElementWrapper";const ca=Y.Bb+"readoutElement1",aa=Y.Bb+"readoutElement2";this.u_=document.getElementById(ja);this.u_||(this.u_=document.createElement(A.a.div),this.u_.id=ja,this.MN=document.createElement(A.a.label),this.MN.id=ca,this.MN.setAttribute(I.a.contentEditable,F.a.wOb),this.MN.setAttribute(k.a.Kd,k.a.UYa),this.NV=document.createElement(A.a.label),this.NV.id=aa,this.NV.setAttribute(I.a.contentEditable,F.a.wOb),this.NV.setAttribute(k.a.Kd,
k.a.UYa),this.MN.style.width="0px",this.MN.style.height="0px",this.NV.style.width="0px",this.NV.style.height="0px",this.MN.tabIndex=-1,this.NV.tabIndex=-1,this.u_.appendChild(this.MN),this.u_.appendChild(this.NV),Y=Y.Bb+k.a.x2b,ja=document.getElementById(Y),f.ULS.shipAssertTag(537153942,3,!!ja,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${Y}`),ja&&ja.appendChild(this.u_))}MZi(){this.Aia&&this.MN&&this.NV&&(this.Aia.setAttribute(k.a.T1,this.MN.id),this.Aia.setAttribute(k.a.NVc,
`${this.MN.id} ${this.NV.id}`))}JGj(){if(this.isActive){let Y="";l.DOMElementExtensions.hasAttribute(this.Aia,k.a.T1)&&(Y=this.Aia.getAttribute(k.a.T1).toString());this.Aia.setAttribute(k.a.T1,Y===this.MN.id?this.NV.id:this.MN.id)}else f.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static P5a(){if(null==U.Btb)if(b.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1)&&!z.a.cMa)U.Btb=!0,f.ULS.sendTraceTag(537153940,
0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(U.Btb=!1,z.a.JH||z.a.Tf)U.Btb=!0,f.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return U.Btb}static ka(Y){U.P5a()&&Y.da.Ga(244,new U(Y,w.g(Y).hc.textBox.Se))}}U.Btb=null;Object(t.a)(U,"FocusBasedReadout",null,[344,2]);class X extends d.a{constructor(Y){super();this.$=Y;this.Fb()}create(){U.P5a()?w.g(this.$).hc.textBox.sT(()=>
{const Y=this.$.da.za(244)||new U(this.$,w.g(this.$).hc.textBox.Se);this.qb(Y)}):this.qb(null)}static ka(Y){Y.da.Ga(315,new X(Y))}}Object(t.a)(X,"FocusBasedReadoutFactory",d.a,[]);var S=a(50),H=a(37),D=a(7),J=a(86),M=a(84);const G=Y=>{switch(Y){case 1:return 1458;case 2:return 1459;case 3:return 1460;case 4:return 1461;case 5:return 1462;case 6:return 1463;case 7:return 1464;case 8:return 1465;case 9:return 1466;case 10:return 1467;case 11:return 1468;case 12:return 1469;case 13:return 1470;case 14:return 1471;
case 15:return 1472;case 16:return 1473;case 17:return 1474;case 18:return 1475;case 19:return 1476;case 20:return 1477;case 21:return 1478;case 22:return 1481;case 23:return 1479;case 24:return 1480;case 25:return 1482;case 26:return 1483;case 27:return 1484;case 28:return 1485;default:return 1486}};var T=a(24),K=a(43),L=a(239),V=a(47),W=a(45),da=a(122);class qa{static get G3i(){return qa.kde||(qa.kde=RegExp("([A-Z]+)","g"))}static get F3i(){return qa.jde||(qa.jde=RegExp("([A-Z])","g"))}static get rWg(){return qa.h2d||
(qa.h2d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static Ned(Y){return qa.k0e(Y.toString())}static k0e(Y){return qa.rWg.test(Y)?Y.replace(qa.G3i,"$1 ").replace(qa.F3i,' "$1"').trim():Y}static tdj(Y){const ja=Y.lastIndexOf("!");return Y.substring(0,-1<ja?ja+1:0)+qa.k0e(Y.substring(-1<ja?ja+1:0,Y.length))}}qa.kde=null;qa.jde=null;qa.h2d=null;Object(t.a)(qa,"RangeAriaExtensions",null,[]);class O{constructor(){this.activeItemName=
null;this.Qff=!1;this.tableName=null;this.C_a=0;this.oyc=!1}}Object(t.a)(O,"SelectionReadoutState",null,[]);a(65);var ea=a(77);class R{constructor(Y,ja,ca,aa,ta){this.gridReadoutNotifier=null;this.hab=!1;this.Xra=this.Gnb=null;this.Aca=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?f.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):w.g(this.$).eb||this.PZb.Rq()};this.SEi=()=>{if(!w.g(this.$).ha.Pa.mod){var xa,
ia=({activeCell:xa}=this.qGh()).returnValue;this.readText(ia,xa)}};this.xp=()=>{const xa=this.activeCell;this.readText("Editing",xa);b.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||xa&&xa.ccc&&!w.g(this.$).F5e||this.PZb.cancel()};this.Vc=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?f.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):(this.Aca(),this.hab&&w.g(this.$).inRangePicker&&
1===ea.a.Eb&&(null===this.Gnb?this.Gnb=V.a.instance.create(this.WFd,R.rSc,"readSelectedRanges"):this.Gnb.Rq()))};this.$=ja;this.ariaLiveNotifier=Y;this.sparklineManager=aa;this.tableManager=ca;this.vD=new O;this.P5a=U.P5a();this.hab=b.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.P5a&&(b.EwaSettings.xb()?this.gridReadoutNotifier=ta:this.gridReadoutNotifier=ja.da.za(244),f.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),
R.rSc=700);this.PZb=V.a.instance.create(this.SEi,R.rSc,W.a.Olj,!1);this.Bj()}get activeCell(){return w.g(this.$).Vb(null)}dispose(){this.$&&this.ek();J.a.Ia(this.PZb);this.sparklineManager=this.$=this.PZb=null}WVe(Y,ja,ca=!0){if(!Y)return"";var aa=this.$.da;const ta=new Sys.StringBuilder;this.QJg(ta,Y,ja);if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var xa=this.tableManager.eja(Y.range);(null===xa||void 0===xa?0:xa.RQd)&&this.qpe(ta,xa);xa=this.tableManager.Fm(Y.range);
(null===xa||void 0===xa?0:xa.yaa)&&this.qpe(ta,xa)}xa=Y.waa?this.LYe(Y):Y.text;y(ta,xa);xa=this.$.activeItemName;this.vD.activeItemName!==xa&&(y(ta,xa),this.vD.activeItemName=xa);xa=1===ja.length?K.K(ja).isSingle?"":v.a.instance.ga(857):String.format(v.a.instance.ob(31),ja.length);y(ta,xa);for(var ia of ja)y(ta,qa.Ned(ia)),1===ja.length&&R.Zmi(ia)&&(xa=w.g(this.$).Ea.Sr(ia.bottomRight),void 0!==xa&&null!==xa&&xa.text&&(xa=xa.waa?this.KYe(xa,xa.text):xa.text,y(ta,xa)));ia=Y.cell;ia=this.DSh(ia.Yhj,
ia.rZg);y(ta,ia);this.yJg(ta,Y);ca&&(Y.r6a?y(ta,v.a.instance.ga(845)):Y.ywa&&y(ta,v.a.instance.ga(846)));if(Y.hasAutoFilter||Y.K3)this.RJg(ta,Y.hasAutoFilter?Y.cell.autoFilterType:Y.cell.nXi),ca&&y(ta,v.a.instance.ga(848));L.c(this.$,Y.range)&&y(ta,v.a.instance.ga(852));this.vJg(ta,Y);ca=(ca=aa.za(14))?ca.pHh():"";y(ta,ca);Y.gF&&(ca=w.g(this.$).Ea.Sr(Y.range),ca=!!ca&&ca.V5e,R.ovj(Y)?R.wJg(ta,Y):b.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&ca?y(ta,v.a.instance.ga(850)):
y(ta,v.a.instance.ga(849)));Y.vaa&&(y(ta,v.a.instance.ga(851)),Y.jwb&&y(ta,String.format(v.a.instance.ob(16),Y.Vah)),y(ta,Y.iconName));Y.hasRichValueIcon&&(ia=this.$.da.za(271),ca="",ia&&Y.cell.Qjf&&(ia=ia.PP(Y.cell.Qjf))&&ia.DomainId.Id!==R.$Wj&&(ca=ia.Name),Y.cell.Idi?(y(ta,String.format(v.a.instance.ob(186),ca)),y(ta,v.a.instance.ga(1809))):(y(ta,String.format(v.a.instance.ob(184),ca)),y(ta,v.a.instance.ga(1808))));this.Z3h(Y)&&y(ta,R.gOh(Y));(aa=aa.za(231))&&y(ta,aa.ZYe(ja,!0));1===ja.length&&
ja[0].isSingle&&R.nvj(Y,ja[0],this.$)&&(ja=this.$.da.za(271))&&y(ta,ja.CHh());Y.WMb&&Y.XMb&&y(ta,Y.XMb);(ja=Y.cell.hVg)&&y(ta,ja);Y.SLa&&Y.FFb&&(Y=Y.BCd)&&(y(ta,v.a.instance.ga(1984)),y(ta,Y));return ta.toString()}nue(Y){this.Xra=this.vD;this.vD=Object(D.a)(new O,{activeItemName:this.Xra.activeItemName,oyc:Y?this.Xra.oyc:!1,tableName:Y?this.Xra.tableName:"",C_a:Y?this.Xra.C_a:-1})}cTf(){this.Xra&&(this.vD=this.Xra,this.Xra=null)}DSh(Y,ja){return 2===Y||2===ja?v.a.instance.ga(878):1===Y||1===ja?v.a.instance.ga(879):
""}LYe(Y){return this.KYe(Y.cell,Y.text)}QJg(Y,ja,ca){if(ca&&1===ca.length&&ca[0].isSingle){ca="";var aa=this.tableManager.eja(ja.range);if(aa){ca=aa.pivotTableName;this.mVc(Y,ca);var ta=aa.Yec?v.a.instance.ga(840):"";b.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(ta+=(aa.altText?aa.altText+" . ":"")+(aa.altTextSummary?aa.altTextSummary:""));this.spe(Y,!0,ca,ta);y(Y,this.tableManager.Wki(aa,ja.range)?v.a.instance.ga(842):"");y(Y,this.tableManager.Zei(aa,
ja.range)?v.a.instance.ga(841):"")}else if(aa=this.tableManager.Fm(ja.range)){ca=(ta=w.g(this.$).Db.Yj(ja.range))?ta.name:"";this.mVc(Y,ca);let xa="";ta&&b.EwaSettings.isChangeGateEnabled("OfficeVSO:6680193_FlighRemovalTableAltText")&&(xa=(ta.zSa?ta.zSa+" . ":"")+(ta.ASa?ta.ASa:""));this.spe(Y,!1,ca,xa);y(Y,this.tableManager.Pcf(aa,ja.range)?v.a.instance.ga(841):"")}else this.mVc(Y,ca),this.vD.tableName="",this.vD.C_a=-1}}mVc(Y,ja){ja!==this.vD.tableName&&this.vD.tableName&&(Y.append(v.a.instance.ga(this.vD.oyc?
839:838)),y(Y," "+this.vD.tableName))}spe(Y,ja,ca,aa){ca!==this.vD.tableName&&(Y.append(v.a.instance.ga(ja?837:836)),y(Y," "+ca),y(Y,aa),this.vD.tableName=ca,this.vD.oyc=ja,this.vD.C_a=-1)}qpe(Y,ja){const ca=w.g(this.$).ha.sa.activeCell;if(ca.top!==ja.top&&ca.left!==this.vD.C_a){Y.append(v.a.instance.ga(841));ja=new T.Range(ja.top,ca.left,ja.top,ca.left,!0,!0);y(Y,qa.Ned(ja));if(ja=w.g(this.$).Vb(ja))ja=ja.waa?this.LYe(ja):ja.text,y(Y,ja);this.vD.C_a=ca.left}}KYe(Y,ja){const ca=Y.O4a;return Y.lwb?
String.format(v.a.instance.ob(14),ja,ca):String.format(v.a.instance.ob(13),ja,qa.tdj(ca))}Bj(){f.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var Y=w.g(this.$);f.ULS.shipAssertTag(537153929,0,!!Y,"Can't register to grid's events");Y&&(Y.Xb.Nk(this.xp),Y.Ea.kx(this.Aca),Y.hC(this.Aca),this.hab&&Y.Xb.em(this.Jf.bind(this)),Y=Y.ha,f.ULS.shipAssertTag(537153928,0,!!Y,"Can't register to selectionManager's events"),Y&&(Y.NG(this.Vc),Y.pJ(this.Aca),Y.Pa.K1(this.Aca),
this.hab&&(this.WFd=this.WFd.bind(this))))}}ek(){if(this.$){var Y=w.g(this.$);Y&&(Y.Xb.tk(this.xp),Y.Ea.sv(this.Aca),Y.AD(this.Aca),this.hab&&Y.Xb.yl(this.Jf),Y=Y.ha)&&(Y.RF(this.Aca),Y.RK(this.Aca),Y.Pa.oma(this.Aca))}}readText(Y,ja){this.P5a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(Y):(b.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(Y),this.hab&&
!ja||this.ariaLiveNotifier.RPj(ja))}Jf(){this.Gnb&&this.Gnb.cancel()}WFd(){this.readText(this.RVh())}RVh(){let Y="";w.g(this.$).ha.rangePicker.LK.forEach(()=>{Y+=void 0});return Y+=" selected"}qGh(){let Y;Y=null;var ja=w.g(this.$).ha;if(1!==ja.Je&&!ja.Pa.$b)return f.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${ja.Je} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:Y};switch(ja.Je){case 2:return{returnValue:this.pJh(ja),activeCell:Y};
case 64:var ca=ja.Pa.$b.floatingObject,aa="";if(ja=ja.Pa.$b.zs||ja.Pa.$b.Gd)aa=(aa=ja.firstChild)?l.DOMElementExtensions.getTextContent(aa):"";return{returnValue:String.format(v.a.instance.ob(53),R.B9b(ca.altText,ca.altTextDescription,ca.name),aa,ca.altTextDescription),activeCell:Y};case 4:return{returnValue:R.GIg(ja.Pa.$b.floatingObject),activeCell:Y};case 512:return{returnValue:da.a.uXe(ja.Pa.$b.floatingObject.n6c),activeCell:Y};case 8:return ca=ja.Pa.$b.floatingObject,{returnValue:String.format(v.a.instance.ob(51),
ca?ca.name:""),activeCell:Y};case 1:return Y=this.activeCell,{returnValue:this.WVe(Y,ja.sa.selectedRanges),activeCell:Y}}return{returnValue:"",activeCell:Y}}pJh(Y){const ja=new Sys.StringBuilder;ja.append(R.LVg(Y));const ca=this.$.da.za(231);ca&&y(ja,ca.ZYe(Y.Pa.$b.floatingObject,!1));return ja.toString()}Z3h(Y){Y=Y.Uaf();let ja=!1;this.vD.Qff!==Y&&(this.vD.Qff=Y,ja=!0);return ja}yJg(Y,ja){if(ja.vwb)if(ja=this.sparklineManager.PWh(ja)){var ca=v.a.instance,aa=ca.ga;a:switch(ja.type){case 0:var ta=
833;break a;case 1:ta=834;break a;default:ta=835}ca=aa.call(ca,ta);y(Y,String.format(v.a.instance.ob(25),ca));ja=String.format(v.a.instance.ob(24),qa.Ned(ja.eDj));y(Y,ja)}else f.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),y(Y,String.format(v.a.instance.ob(25),""))}RJg(Y,ja){switch(ja){case 1:case 11:y(Y,v.a.instance.ga(853));break;case 6:y(Y,v.a.instance.ga(853));y(Y,v.a.instance.ga(855));break;case 7:y(Y,v.a.instance.ga(853));y(Y,v.a.instance.ga(856));
break;case 2:y(Y,v.a.instance.ga(854));y(Y,v.a.instance.ga(855));break;case 3:y(Y,v.a.instance.ga(854));y(Y,v.a.instance.ga(856));break;default:y(Y,v.a.instance.ga(854))}}vJg(Y,ja){var ca;const aa=this.$.da.za(65);ja=aa?aa.uJa(ja.range):null;let ta="";const xa=Object(M.a)(353,ja);if(ja)ta=!ja.Y5a&&xa&&xa.Ami?String.format(v.a.instance.ob(29),xa.zHj):String.format(v.a.instance.ob(23),ja.author);else if(null===(ca=null===aa||void 0===aa?void 0:aa.Km)||void 0===ca?0:ca.hF)ta=String.format(v.a.instance.ob(28),
aa.Km.kN.author);y(Y,ta)}static GIg(Y){return String.format(v.a.instance.ob(52),R.B9b(Y.altText,Y.altTextDescription,Y.name),Y.altTextDescription)}static gOh(Y){return v.a.instance.ga(Y.Uaf()?843:844)}static B9b(Y,ja,ca){return Y||ja?Y:ca}static LVg(Y){var ja=Y.Pa.$b;Y=ja.floatingObject;const ca=Y.Tc,aa=ca.ChartTitle,ta=Y.altText,xa=Y.altTextDescription,ia=!!(ca.Attributes&4);return(ja=ja.getSelectionDescription())?ja:ca.DataRangeForDisplay?String.format(v.a.instance.ob(ia?49:47),R.B9b(ta,xa,Y.name),
xa,aa,v.a.instance.ga(G(ca.ChartCategory)),ca.DataRangeForDisplay):String.format(v.a.instance.ob(ia?50:48),R.B9b(ta,xa,Y.name),xa,aa,v.a.instance.ga(G(ca.ChartCategory)))}static ovj(Y){return b.EwaSettings.ma(102)&&(Y.I5a||Y.Wec)}static wJg(Y,ja){ja.fSa?ja.I5a?y(Y,String.format(v.a.instance.ob(26),ja.fSa.topLeft.toString())):ja.Wec&&(ja=ja.fSa.WR(),y(Y,String.format(v.a.instance.ob(27),(ja.LastColumn-ja.FirstColumn+1).toString(),(ja.LastRow-ja.FirstRow+1).toString()))):f.ULS.shipAssertTag(537153924,
0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static nvj(Y,ja,ca){return Y.gF||!b.EwaSettings.ma(138)?!1:(Y=ca.da.za(271))?Y.vec(ja):!1}static Zmi(Y){return Y.top===Y.bottom&&Y.left+1===Y.right||Y.top+1===Y.bottom&&Y.left===Y.right}}R.$Wj=268435712;R.rSc=500;Object(t.a)(R,"SelectionReadoutHandler",null,[354,2]);var oa=a(55),pa=a(696);class Pa extends d.a{constructor(Y){super();this.$=Y;this.Fb()}create(){const Y=
this.$.da,ja=S.GetServiceTaskFactory.Ra(Y,211,212,this.hb),ca=S.GetServiceTaskFactory.Ra(Y,66,134,this.hb),aa=S.GetServiceTaskFactory.Ra(Y,240,239,this.hb);let ta=oa.Task.Ta(null);b.EwaSettings.xb()&&(ta=S.GetServiceTaskFactory.Ra(Y,244,315,this.hb));H.TaskExtensions.Aa(H.TaskExtensions.Wd([ja,ca,aa,ta],this.la),()=>{const xa=Object(pa.a)(this.$.da,226,()=>new R(ja.result,this.$,ca.result,aa.result,ta.result));this.qb(xa)},this.$.la,3)}static ka(Y){Y.da.Ga(227,new Pa(Y))}}Object(t.a)(Pa,"SelectionReadoutHandlerFactory",
d.a,[]);class Z{constructor(Y,ja){this.$=ja;this.ariaLiveNotifier=Y}ELf(){const Y=this.rHh();this.ariaLiveNotifier.mab(Y,k.a.vnb)}rHh(){const Y=new Sys.StringBuilder;this.$.workbookContext&&y(Y,this.$.workbookContext.WorkbookFileName);y(Y,v.a.instance.ga(859));y(Y,this.tHh());y(Y,this.sHh());y(Y,v.a.instance.ga(860));return Y.toString()}tHh(){return this.$.isEditMode?v.a.instance.ga(864):v.a.instance.ga(865)}sHh(){var Y=this.lWj();const ja=this.$.xa.pa;Y=1!==Y?String.format(v.a.instance.ob(32),Y):
v.a.instance.ga(858);Y=new Sys.StringBuilder(Y);ja&&ja.sheetName&&(Y.append(u.Gtd),Y.append(String.format(v.a.instance.ob(33),ja.sheetName)));return Y.toString()}lWj(){let Y=0;for(const ja of this.$.xa.items)ja.visible&&Y++;return Y}}Object(t.a)(Z,"WorkbookReadout",null,[]);class Ra{constructor(Y,ja,ca){this.kyf=()=>{this.UZd.ELf();this.ariaLiveNotifier.setEnabled(!0)};this.$=ja;this.ariaLiveNotifier=Y;this.UZd=new Z(Y,ja);this.V8b=ca.ued(this.$);this.V8b.$Eg(this.kyf)}dispose(){this.V8b&&this.V8b.abj(this.kyf);
this.V8b=this.ariaLiveNotifier=this.$=null}}Object(t.a)(Ra,"EmbeddedWorkbookReadoutHandler",null,[2]);class Ga{constructor(Y,ja){this.nV=()=>{this.zd||this.Poe()};this.zd=!1;this.mY=ja.MT;this.ariaLiveNotifier=Y;this.UZd=new Z(Y,ja);this.mY&&this.mY.wQ?this.Poe():this.Bj()}dispose(){this.ek();this.ariaLiveNotifier=this.mY=null;this.zd=!0}Bj(){if(this.mY){this.mY.Ku(this.nV);this.mY.Ea.kx(this.nV);this.mY.hC(this.nV);var Y=Object(M.a)(230,this.mY);Y&&(Y.Xb.Nk(this.nV),Y.ha.NG(this.nV),Y.ha.pJ(this.nV),
Y.ha.Pa.K1(this.nV))}else f.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}ek(){if(this.mY){this.mY.Ea.sv(this.nV);this.mY.AD(this.nV);const Y=Object(M.a)(230,this.mY);Y&&(Y.Xb.tk(this.nV),Y.ha.RF(this.nV),Y.ha.RK(this.nV),Y.ha.Pa.oma(this.nV))}}Poe(){this.UZd.ELf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.opj();this.dispose()}}Object(t.a)(Ga,"WorkbookReadoutHandler",null,[2]);class Ba extends d.a{constructor(Y){super();this.$=
Y;this.Fb()}create(){const Y=S.GetServiceTaskFactory.Ra(this.$.da,211,212,this.hb);if(this.$.mK){const ja=S.GetServiceTaskFactory.Ra(this.$.da,12,477,this.hb);H.TaskExtensions.Aa(H.TaskExtensions.Wd([Y,ja],this.$.la),()=>{const ca=Object(pa.b)(this.$.da,228,()=>new Ra(Y.result,this.$,ja.result));this.qb(ca)},this.$.la,3)}else H.TaskExtensions.Aa(Y,ja=>{const ca=Object(pa.b)(this.$.da,228,()=>new Ga(ja.result,this.$));this.qb(ca)},this.$.la,3)}static ka(Y){Y.da.Ga(229,new Ba(Y))}}Object(t.a)(Ba,"WorkbookReadoutHandlerFactory",
d.a,[]);a.d(C,"a",function(){return fa});const fa=()=>{c.a.Fa(Y=>{B.ka(Y);b.EwaSettings.xb()?X.ka(Y):U.ka(Y);Pa.ka(Y);Ba.ka(Y)})}},1157:function(t,C,a){t=a(0);var c=a(83),b=a(550),d=a(15);class f{constructor(){this.$Cc={}}Vyg(Z){this.$Cc[Z.id.toString()]=Z}ZCi(Z){const Ra=this.$Cc;for(let Ga in Ra)Ra[Ga].notify(Z,!1);this.$Cc={}}B1i(Z,Ra){Ra&&this.Vyg(Ra);return this.WAf(Z,Ra)}N6c(Z){this.ZCi(Z)}AJe(Z,Ra){Z.notify(Ra,!0)}}Object(t.a)(f,"AEventEmitter",null,[298]);var e;(function(Z){Z[Z.notStarted=
0]="notStarted";Z[Z.waiting=1]="waiting";Z[Z.shouldRetry=2]="shouldRetry";Z[Z.complete=3]="complete"})(e||(e={}));Object(t.b)("EventResultState",e);class k{constructor(){this._state=0}get state(){return this._state}set state(Z){d.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:e[this._state],["NewState"]:e[Z]},"ResultType",this.H0e());this._state=Z}}Object(t.a)(k,"AEventResult",null,[323]);class l extends k{constructor(){super();this.oQc=this.Wjb=null;this.state=0;
this.iJc=this.p7d=!1}get fR(){return this.Wjb}get yna(){return this.oQc}get Abi(){return this.p7d}H0e(){return"GetMoreInfo Result"}}Object(t.a)(l,"GetMoreInfoResult",k,[322,323]);var m=a(4),v=a(80),n=a(39),w=a(684),r=a(370),u=a(163),y=a(640),x=a(574),B=a(106),z=a(25);class A{constructor(Z,Ra,Ga,Ba,fa,Y,ja,ca){this.La=Z;this.wh=Ra;this.zkg=Ga;this.F0=Ba;this.fe=fa;this.NHc=Y;this.npg=ja;this.VVb=ca}$6i(){this.F8a.Ob(z.a.openUrlInNewTab,B.a.frame,Object(c.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));
this.F8a.Ob(z.a.zOa,B.a.frame,Object(c.a)(this,this.zOa,"openDocumentUrl"));m.AFrameworkApplication.rM?this.vlf():this.F8a.Ie(z.a.S5b,B.a.frame,Object(c.a)(this,this.S5b,"documentLoaded"),96)}openUrlInNewTab(Z,Ra,Ga,Ba,fa){fa&&fa.MenuItemId&&(d.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:fa.SourceControlId,["AppType"]:x.a[this.Pba]}),n.a.Ve(fa.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}zOa(Z,Ra,Ga,Ba,fa){if(fa&&fa.MenuItemId){const Y=
m.AFrameworkApplication.fa.qa("WacInTabOpenMRUIsEnabledForUiHost"),ja=m.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");d.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",Y,ja);if(Y&&ja){d.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:fa.SourceControlId,["AppType"]:x.a[this.Pba]});Z=fa.MenuItemId.toString();const ca={};ca[r.a.tPa]="1";ca[r.a.documentUrl]=Z;ca[r.a.reason]=y.a.open;d.ULS.sendTraceTag(592237460,
202,50,"Send PostMessage to the Ui host to reboot a document");m.AFrameworkApplication.GU().execute(aa=>{aa.Fj(u.a.tta,ca)})}else this.openUrlInNewTab(Z,Ra,Ga,Ba,fa)}return 32}S5b(){this.vlf();return 32}Cba(Z,Ra,Ga=""){if(Ra&&Ra.pF){const Ba=w.a[Ra.status];Ra=Ra.pF.getTime();const fa=this.ew()-Ra;d.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:Z,["RequestStatus"]:Ba,["ElapsedMs"]:fa,["StartTime"]:Ra,["Notes"]:Ga})}else d.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",
{["Caller"]:Z})}vlf(){var Z=m.AFrameworkApplication.fa.qa("QPGVCI"),Ra=v.a.gz(document.URL,"wdNewAndOpenCt",Z);if(Ra){Ra=parseInt(Ra);var Ga=v.a.gz(document.URL,"wdPreviousSession",Z);Z=v.a.gz(document.URL,"wdPreviousCorrelation",Z);var Ba=m.AFrameworkApplication.fa.qa("NAOPLP");if(m.AFrameworkApplication.rM){var fa=m.AFrameworkApplication.rM.getTime();!Ra||Ra>fa?d.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:Ra,["DocumentLoadedTime"]:fa,
["SessionId"]:Ga,["Correlation"]:Z}):d.ULS.sendTraceTag(5849683,202,Ba?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:fa-Ra,["ClickTimestamp"]:Ra,["SessionId"]:Ga,["Correlation"]:Z})}else d.ULS.sendTraceTag(5849681,202,Ba?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:Ra,["SessionId"]:Ga,["Correlation"]:Z})}}get F8a(){return this.La.value}get KCb(){return this.wh.value}get Wqf(){return this.zkg.value}get Pba(){return this.F0.value}get Fkc(){return this.fe.value}get ew(){return this.NHc}get iV(){return this.npg.value}get supportsGetMoreInfoForPersonalStorage(){return this.VVb.value}static get instance(){return A.Ma||
(A.Ma=A.DM())}static DM(){return new A(new b.a(()=>m.AFrameworkApplication.wb),new b.a(()=>m.AFrameworkApplication.vd),new b.a(()=>m.AFrameworkApplication.ta),new b.a(()=>m.AFrameworkApplication.ta.Oa.xj),new b.a(()=>m.AFrameworkApplication.zi),()=>(new Date).getTime(),new b.a(()=>m.AFrameworkApplication.ta.Oa.iV),new b.a(()=>m.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage))}}A.Ma=null;Object(t.a)(A,"NewAndOpenCommonHelpers",null,[297]);var I=a(107);class F{constructor(Z,Ra,Ga){this.gVb=
this.Pi=null;this.AOc=0;this.dvg=Z;this.fe=Ra;this.N3d=Ga}THg(){this.AOc=this.zbb+1}pKd(Z){this.Pi&&(this.fe.Xo(this.Pi),this.Pi=null);Z&&(this.AOc=0)}lEj(Z){const Ra=this.vJj;0<=Ra?(this.THg(),this.pKd(!1),this.Pi=new I.a(4,1,Ra,Z,107),this.fe.Ag(this.Pi)):(this.pKd(!0),d.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.N3d}))}get zbb(){return this.AOc}get vJj(){return this.zbb>=this.sXf.length?-1:this.sXf[this.zbb]}get sXf(){if(!this.gVb){const Z=(this.dvg.value||"0").split(",");
this.gVb=[];for(let Ra=0;Ra<Z.length;Ra++){const Ga=parseInt(Z[Ra]);isNaN(Ga)?d.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.N3d,["Entry"]:Z[Ra]}):Array.add(this.gVb,Ga)}}return this.gVb}}Object(t.a)(F,"RetryHelper",null,[]);var U=a(41),X=a(30);class S extends f{constructor(Z,Ra){super();this.f1=Z;this.ykb=new F(Ra,this.qCb.Fkc,"GetMoreInfo");this.Mo=new l}fxi(){this.Aud("Document opened")}W6g(Z){return()=>{this.Aud(Z,!0)}}WAf(Z,Ra=null){d.ULS.sendTraceTag(5849617,
202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:Z});3===this.Mo.state?(Ra&&this.AJe(Ra,this.Mo),d.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:Z})):this.Aud(Z);return this.Mo}Aud(Z,Ra=!1){this.ykb.pKd(!Ra);1===this.Mo.state?d.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:Z,["RetryIndex"]:this.ykb.zbb}):(d.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:Z,
["RetryIndex"]:this.ykb.zbb}),this.Mo.state=1,Ra=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.qCb.iV,m.AFrameworkApplication.ij),this.qCb.KCb.V8(Ra,1,null,null,[S.uce,S.sge],!1,5,this.$5g(),this.Z5g(Z),null))}$5g(){return Z=>{var Ra=!1;let Ga=!1;var Ba=!1,fa;m.AFrameworkApplication.fa.qa("GetMoreInfoDataFromResponseBody")&&(Z.data.Vd?({Ut:fa}=U.d(Z.data.Vd)).returnValue?fa?(Ba=!0,this.Mo.oQc=fa.StorageServiceDisplayName,this.Mo.Wjb=S.mhf(fa.PersonalFileStorageUrl)?fa.PersonalFileStorageUrl:
"",""===this.Mo.fR&&"SharePointOnlineConsumer"===m.AFrameworkApplication.fa.Va("FileSource")&&(this.Mo.Wjb=v.a.Jca(m.AFrameworkApplication.breadcrumbFolderUrl)),Ra=""===this.Mo.fR&&""!==this.Mo.yna):d.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):d.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):d.ULS.sendTraceTag(25298083,
202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));Ba||((fa=Z.data.responseHeaders)?(this.Mo.oQc=(fa[S.sge]||"").toString(),Ra=(fa[S.uce]||"").toString(),this.Mo.Wjb=S.mhf(Ra)?Ra:"",""===this.Mo.fR&&"SharePointOnlineConsumer"===m.AFrameworkApplication.fa.Va("FileSource")?(this.Mo.Wjb=v.a.Jca(m.AFrameworkApplication.breadcrumbFolderUrl),Ra=""===this.Mo.fR&&""!==this.Mo.yna):Ra=""===Ra&&""!==this.Mo.yna):(d.ULS.sendTraceTag(5849622,202,
50,"Null response headers received."),Ga=!0));Ba=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.ykb.zbb,Ga,Ra,Ba);this.qCb.Cba("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",Z.data,Ba);this.JXf(3,Ra,Ga)}}Z5g(Z){return Ra=>{this.qCb.Cba("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",Ra.data,"Failure");this.JXf(2);this.ykb.lEj(this.W6g(Z))}}JXf(Z,Ra=!1,Ga=!1){this.Mo.state=Z;this.Mo.p7d=
Ra;this.Mo.iJc=Ga;this.N6c(this.Mo)}get qCb(){return this.f1.value}static get instance(){return S.Ma||(S.Ma=S.DM())}static DM(){return new S(new b.a(()=>A.instance),new b.a(()=>m.AFrameworkApplication.kRh))}static mhf(Z){if(!Z)return d.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(X.a.ll(Z).startsWith("https://"))return!0;d.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}S.uce="PersonalFileStorageUrl";S.sge="StorageServiceDisplayName";
S.Ma=null;Object(t.a)(S,"GetMoreInfoActor",f,[]);var H=a(103),D=a(95);class J{constructor(Z,Ra,Ga,Ba,fa){this.Tpg=6E4;this.O8e="inactive";this.bje="active";this.wS=!0;this.fe=Z;this.Uog=Ra;this.NHc=Ga;this.hWb=Ba;this.$a=new D.a;fa&&this.dEj();this.n9d=this.jZe()}TSc(Z){this.$a.addHandler(this.bje,Z)}rBg(Z){this.$a.addHandler(this.O8e,Z)}dEj(){const Z=new I.a(5,2,this.Tpg,Object(c.a)(this,this.C7h,"inactiveLoop"),108);this.D7h.Ag(Z)}C7h(){const Z=this.jZe(),Ra=this.ew()-Z;Ra>this.Xyc&&this.wS&&(d.ULS.sendTraceTag(5849626,
202,50,"User went inactive {0}",{["TimeSinceLastActive"]:Ra}),this.wS=!1,this.$a.raiseEvent(this.O8e));Z-this.n9d>this.Xyc&&(this.wS=!0,this.$a.raiseEvent(this.bje));this.n9d=Z}get D7h(){return this.fe.value}get jZe(){return this.Uog}get ew(){return this.NHc}get Xyc(){return this.hWb.value}static get instance(){return J.Ma||(J.Ma=J.DM())}static DM(){return new J(new b.a(()=>H.a.instance),()=>m.AFrameworkApplication.Hrd.getTime(),()=>(new Date).getTime(),new b.a(()=>m.AFrameworkApplication.Xyc),!0)}}
J.Ma=null;Object(t.a)(J,"InactivityManager",null,[]);var M=a(84),G=a(903);class T extends k{constructor(){super();this.uae=this.wae=this.vae=null;this.state=this.lhe=0;this.iJc=!1}get Wvd(){return this.vae}get iqf(){return this.wae}get Vvd(){return this.uae}get BJj(){return this.lhe}H0e(){return"MruActor Result"}}Object(t.a)(T,"MruResult",k,[324,323]);var K=a(237);class L{constructor(Z,Ra,Ga){this.task=null;this.wdc=Z;this.Kyi=Ra;this.taskManager=Ga;this.retryCount=this.Gxb=0;this.INc=this.AAb=null}Cji(Z,
Ra){return Z===K.a.qad||20===Ra||18===Ra||3===Ra}Oki(Z){return 3===Z||5===Z||6===Z||7===Z||9===Z||10===Z||11===Z||12===Z||13===Z||14===Z||15===Z||16===Z||23===Z||26===Z||27===Z||28===Z}get tpc(){return this.INc}reset(){this.Gxb=this.retryCount=0;this.INc=this.AAb=null;this.task&&(this.taskManager.Xo(this.task),this.task=null)}Dai(Z,Ra,Ga,Ba){this.INc=String.format("{0}_{1}",Ga,Ba);if(this.retryCount>=this.Kyi)return d.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.Cji(Ga,Ba))return d.ULS.sendTraceTag(562656908,
202,50,"Encountered permanent error. Not retrying"),!1;if(this.Oki(Ba)&&1<=this.Gxb)return this.AAb=Ga,!1;Ra=Math.max(Ra,this.wdc*Math.pow(2,this.Gxb));if(26===Ba)Ra=Math.max(Ra,3E4);else if(27===Ba||28===Ba)Ra=Math.max(Ra,6E4);9===Ba||412===Ga&&(null==this.AAb||412!==this.AAb)?Ra=500:this.Gxb+=1;this.AAb=Ga;this.retryCount+=1;this.task&&this.taskManager.Xo(this.task);d.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",Ra);this.task=new I.a(2,1,Ra,Z,107);this.taskManager.Ag(this.task);
return!0}}Object(t.a)(L,"RetryManager",null,[]);var V=a(98),W=a(134),da=a(159);class qa{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(t.a)(qa,"WriteOptions",null,[]);var O=a(555),ea=a(186);class R extends f{constructor(Z,Ra,Ga,Ba,fa,Y,ja){super();this.f1=Z;this.Jrg=Ra;this.xqa=new L(m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",
3),this.yw.Fkc);this.Zqa=new L(m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.yw.Fkc);this.$tg=Ga;this.yie=Ba;this.myg={};this.AS=new T;this.Qog=fa;this.uTb="";this.Gv=Y;this.L4d=ja;this.aug=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",25)}get nCc(){return this.myg}R8i(){this.yw.F8a.Ob(z.a.renameMostRecentlyUsedFileEntry,
B.a.frame,Object(c.a)(this,this.Lcj,"renameMruEntry"))}Lcj(){return this.a_d("Rename")}pxi(){this.eof("File Opened")}qxi(){this.eof("IntervalUpdate")}eof(Z){d.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:Z});this.a_d(Z)}t3(Z){(Z=X.a.t3(Z))&&Z.startsWith(".")&&(Z=Z.substring(1,Z.length));return Z}rVe(){switch(this.yw.Pba){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}vZh(Z){var Ra=
this.Qog();if(!Ra)return null;const Ga=new qa;Ga.documentUrl=this.L4d.value?encodeURI(Ra):Ra;Ga.mruItemId=this.uTb;Ga.app=this.rVe();if(Ra=this.Gv())Ga.folderName=Ra.breadcrumbFolderName,Ra=Ra.Zm,Ga.documentName=X.a.uq(Ra),Ga.documentExt=this.t3(Ra);Z&&(Ga.documentName?Ga.documentName.length?255<=Ga.documentName.length?Z.set("DocumentNameLength","Long"):2084<=Ga.documentName.length&&Z.set("DocumentNameLength","VeryLong"):Z.set("DocumentNameLength","0"):Z.set("DocumentNameLength","Null"));return JSON.stringify(Ga)}a_d(Z,
Ra=!1){if(4===this.yw.Pba&&!m.AFrameworkApplication.sta)return 2;var Ga=W.a.Lr();Ga&&(Ga.set("Trigger",Z),Ga.set("IsRetry",Ra?"true":"false"),Ga.set("MruIdSent",this.uTb?"true":"false"),Ga.set("URLEncoded",this.L4d.value?"true":"false"));V.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",Ga);Z=this.vZh(Ga);if(!Z)return Ra=!m.AFrameworkApplication.webEditingEnabled,Ga&&(Ga.set("WebEditingIsEnabled",m.AFrameworkApplication.webEditingEnabled?"true":"false"),Ga.set("ProtectedFile",m.AFrameworkApplication.Gpc?
"true":"false")),V.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",Ra,!1,Object.assign(new ea.a,{extendedProperties:Ga})),2;this.Zqa&&!Ra&&this.Zqa.reset();Ga=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.yw.iV,this.localeName);this.yie?this.nCc["X-FileId"]=m.AFrameworkApplication.ij:Ga+=String.format("&{0}",m.AFrameworkApplication.ij);m.AFrameworkApplication.Qb&&(this.nCc["X-Office-AudienceGroup"]=Object(M.a)(String,m.AFrameworkApplication.Qb.AudienceGroup)||"");this.nCc["X-Timeout"]=
15E3;return this.yw.KCb.Bm(Ga,2,Z,this.nCc,!0,5,Object(c.a)(this,this.HXj,"writeMruV2EntryOnServerSuccessCallback"),Object(c.a)(this,this.F$g,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}HXj(Z){this.N4e(Z.data)}N4e(Z){const Ra=W.a.Lr();this.Zqa&&(Ra&&this.Zqa.tpc&&(Ra.set("LastError",this.Zqa.tpc),Ra.set("NumRetries",this.Zqa.retryCount.toString())),this.Zqa.reset());const Ga=G.c(Z.Vd);Ga&&Ga.diagnostics_data&&(this.uTb=Ga.diagnostics_data.mru_id);Z=+Z.t2-
+Z.pF;Ra&&Ra.set("RequestDuration",Z.toString());V.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new ea.a,{extendedProperties:Ra}))}F$g(Z){if(Z.data.httpStatus===K.a.Sqb)this.N4e(Z.data);else{var Ra=Z.data.httpStatus===K.a.VFb,Ga=W.a.Lr();this.Z4e(this.Zqa,Z,this.t$g(),Ga);Ga&&(Ga.set("StatusCode",Z.data.httpStatus.toString()),Ra||this.aTc(Z.data,Ga));V.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",Z.data.httpStatus),Ra,!1,Object.assign(new ea.a,{extendedProperties:Ga}))}}t$g(){return()=>
{this.a_d("Retry",!0)}}rRh(){this.f8a("Polling")}qRh(){this.f8a("Retry",!0)}jxi(){this.f8a("Open")}ixi(){this.f8a("Activity")}hxi(){this.f8a("OpenRecentLinks",!1,!0)}gxi(){this.f8a("ActivityRecentLinks",!1,!0)}f8a(Z,Ra=!1,Ga=!1){d.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:Z});const Ba=W.a.Lr();Ba&&(Ba.set("Trigger",Z),Ba.set("IsRetry",Ra?"true":"false"),Ga&&Ba.set("RecentLinks","true"));V.Health.instance.recordKpiUsage("GetMru",0,"smartfio",Ba);this.xqa&&!Ra&&this.xqa.reset();
Ga?this.JCe(Object(c.a)(this,this.sRh,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(c.a)(this,this.oRh,"getMruForRecentLinksFromServerFailureCallback"),!0):this.JCe(Object(c.a)(this,this.tRh,"getMruV2FromServerSuccessCallback"),Object(c.a)(this,this.pRh,"getMruFromServerFailureCallback"))}aTc(Z,Ra){Z&&Z.responseHeaders&&(Z=Z.responseHeaders["X-CorrelationId"])&&Ra.set("ServerCorrelationId",Z)}Zti(Z,Ra){Z&&(Ra&&Ra.set("RequestDuration",(+Z.t2-+Z.pF).toString()),V.Health.instance.recordKpiSuccess("GetMru",
Object.assign(new ea.a,{extendedProperties:Ra})))}tRh(Z){this.NZe(Z)}NZe(Z,Ra=!1){var Ga="";let Ba=null,fa=null,Y=null;const ja=G.c(Z.data.Vd);ja&&(Ba=ja.places?ja.places.items:[],fa=ja.documents?ja.documents.items:[],(Y=G.a(ja,Ra))&&(Ga=U.c(Y)));m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Oa.vZ&&da.c()&&!Ra&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Ga,!0));Ga=W.a.Lr();this.xqa&&(Ga&&this.xqa.tpc&&(Ga.set("LastError",this.xqa.tpc),Ga.set("NumRetries",this.xqa.retryCount.toString())),
this.xqa.reset());Ra&&Ga&&Ga.set("RecentLinks","true");Y||Ba||fa?(Ra?this.yw.Cba("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",Z.data,"Success"):this.yw.Cba("MruActor.GetMruV2FromServerSuccessCallback",Z.data,"Success"),this.QAc(3,Y,Ba,fa),this.Zti(Z.data,Ga)):(Ra?this.yw.Cba("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",Z.data,"Failure: Invalid JSON"):this.yw.Cba("MruActor.GetMruV2FromServerSuccessCallback",Z.data,"Failure: Invalid JSON"),Ga&&this.aTc(Z.data,Ga),V.Health.instance.recordKpiFailure("GetMru",
"JsonParseFailed",!1,!1,Object.assign(new ea.a,{extendedProperties:Ga})),this.QAc(3,null,null,null,!0));this.N6c(this.AS)}sRh(Z){this.NZe(Z,!0)}Z4e(Z,Ra,Ga,Ba){let fa=0,Y=0;const ja=G.c(Ra.data.Vd);ja&&(null!=ja.response_code&&(fa=ja.response_code,Ba&&Ba.set("MruResponseCode",fa.toString()),9===fa&&(this.uTb="")),ja.error_data&&null!=ja.error_data.retry_after_ms&&(Y=ja.error_data.retry_after_ms,Ba&&Ba.set("ExpectedRetryAfter",Y.toString())));Z&&(Ra=Z.Dai(Ga,Y,Ra.data.httpStatus,fa),Ba&&(Ba.set("CurrentRetryCount",
Z.retryCount.toString()),Ba.set("RetryScheduled",Ra?"true":"false")))}pRh(Z){this.MZe(Z)}MZe(Z,Ra=!1){const Ga=Z.data.httpStatus===K.a.VFb,Ba=W.a.Lr();Ba&&(Ba.set("StatusCode",Z.data.httpStatus.toString()),Ra&&Ba.set("RecentLinks","true"),Ga||this.aTc(Z.data,Ba));Ra?this.yw.Cba("MruActor.GetMruForRecentLinksFromServerFailureCallback",Z.data,"Failure"):this.yw.Cba("MruActor.GetMruFromServerFailureCallback",Z.data,"Failure");this.QAc(2);this.Z4e(this.xqa,Z,Object(c.a)(this,this.qRh,"getMruFromServerRetryTask"),
Ba);V.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",Z.data.httpStatus),Ga,!1,Object.assign(new ea.a,{extendedProperties:Ba}));this.N6c(this.AS);m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Oa.vZ&&da.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),Ra||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}oRh(Z){this.MZe(Z,!0)}QAc(Z,Ra=null,Ga=null,Ba=null,fa=!1){if(3!==this.AS.state||3===Z)this.AS.vae=Ra,this.AS.wae=Ga,
this.AS.uae=Ba,this.AS.state=Z,this.AS.iJc=fa,this.AS.lhe=this.yw.ew()}WAf(Z,Ra){d.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:Z,["ResultState"]:this.AS.state});Ra&&3===this.AS.state&&this.AJe(Ra,this.AS);return this.AS}JCe(Z,Ra,Ga=!1){this.QAc(1);let Ba;const fa={};Ba=Ga?String.format(this.yw.iV+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.aug,"OfficeSuite",this.localeName,"ClassicMru"):String.format(this.yw.iV+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",
10,this.rVe(),this.localeName);this.$tg.value||(Ba+="&entity=docs");m.AFrameworkApplication.Qb&&(fa["X-Office-AudienceGroup"]=Object(M.a)(String,m.AFrameworkApplication.Qb.AudienceGroup)||"");Ga&&(fa["X-Office-Application"]="147");this.yie?fa["X-FileId"]=m.AFrameworkApplication.ij:Ba+=String.format("&{0}",m.AFrameworkApplication.ij);this.yw.KCb.Bm(Ba,1,null,fa,!0,5,Z,Ra,null)}get yw(){return this.f1.value}get localeName(){return this.Jrg.value}static get instance(){return R.Ma||(R.Ma=R.DM())}static DM(){return new R(new b.a(()=>
A.instance),new b.a(()=>O.a.YJ(m.AFrameworkApplication.lcid).name),new b.a(()=>m.AFrameworkApplication.ta.Oa.mv),m.AFrameworkApplication.fa.qa("MruWriteFileIdInHeader"),()=>m.AFrameworkApplication.ta.Oa.vx,()=>m.AFrameworkApplication.hm,new b.a(()=>m.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")))}}R.Ma=null;Object(t.a)(R,"MruActor",f,[]);class oa{constructor(){this.vlb=this.tde=this.fb=null;this.xm=!1}get name(){return"Common.App.NewAndOpen.Core"}Rh(Z){this.fb=Z;Z.register(297,"Common.INewAndOpenCommonHelpers").tc().Fc(()=>
A.instance);Z.register(298,"Common.IEventEmitter<Common.IGetMoreInfoResult>").tc().Fc(()=>S.instance);Z.register(298,"Common.IEventEmitter<Common.IMruResult>").tc().Fc(()=>R.instance)}init(){m.AFrameworkApplication.fa.gv(()=>{this.rxb()})}rxb(){this.fb.resolve("Common.INewAndOpenCommonHelpers");this.fb.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.fb.resolve("Common.IEventEmitter<Common.IMruResult>");var Z=!1;A.instance.$6i();m.AFrameworkApplication.Yka&&(Z=!0);m.AFrameworkApplication.xLf&&
(R.instance.jxi(),m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&R.instance.hxi(),0<m.AFrameworkApplication.jqf&&this.vke(),this.huj(),Z=!0);m.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&Z&&S.instance.fxi();m.AFrameworkApplication.aSj&&(Z=R.instance,Z.R8i(),Z.pxi(),H.a.instance.Ag(this.bSj))}huj(){J.instance.TSc(Object(c.a)(R.instance,R.instance.ixi,"makeGetMruRequestActivityTrigger"));m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",
!1)&&J.instance.TSc(Object(c.a)(R.instance,R.instance.gxi,"makeGetMruForRecentLinksRequestActivityTrigger"));J.instance.TSc(Object(c.a)(this,this.vke,"addGetMruFromServerTask"));J.instance.rBg(Object(c.a)(this,this.Ich,"deleteGetMruFromServerTask"))}Ich(){H.a.instance.Xo(this.kqf)}vke(){H.a.instance.Ag(this.kqf)}get kqf(){return this.tde||(this.tde=new I.a(5,2,m.AFrameworkApplication.jqf,Object(c.a)(R.instance,R.instance.rRh,"getMruFromServerTask"),109))}get bSj(){return this.vlb||(this.vlb=new I.a(2,
2,6E4*m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(c.a)(R.instance,R.instance.qxi,"makeUpdateMruTask"),197))}dispose(){this.xm||(this.xm=!0,this.vlb&&(H.a.instance.Xo(this.vlb),this.vlb=null))}}Object(t.a)(oa,"CorePackageManager",null,[4,5,2]);var pa=a(246);a.d(C,"a",function(){return Pa});const Pa=()=>{Type.registerNamespace("Common.App.NewAndOpen.Core");pa.a.instance.yi(new oa)}},1161:function(t,C,a){t=a(0);var c=a(4),b=a(221),
d=a(15),f=a(83),e=a(53),k=a(193);class l{constructor(){this.jfe=this.sPc=!1;const mb=c.AFrameworkApplication.ik;0>=mb||(this.ik=mb,d.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.ik,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Iga}),k.a.instance.oUc(Object(f.a)(this,this.pOa,"onSessionExpiredDetected")),k.a.instance.mUc(Object(f.a)(this,this.SBf,"onSessionExpiringDetected")))}pOa(){k.a.instance.OId(Object(f.a)(this,
this.pOa,"onSessionExpiredDetected"));d.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.c3h()}SBf(){k.a.instance.NId(Object(f.a)(this,this.SBf,"onSessionExpiringDetected"));this.jfe||this.sPc||(d.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.jfe=!0,this.WAj())}c3h(){this.sPc||(c.AFrameworkApplication.TF(e.a.wuc),this.sPc=!0,this.VAj())}}Object(t.a)(l,"ASessionExpirationManager",null,[]);var m=a(86),v=a(38),n=a(29),w=a(14),r=a(42),u=a(249),
y=a(6),x=a(81),B=a(252),z=a(68);class A extends l{constructor(mb){super();this.Qa=new v.a;this.hH=this.rlb=!1;this.$=mb}Pme(mb){this.Qa.addHandler("SessionExpired",mb)}uYb(mb){this.Qa.addHandler("TokenRefreshed",mb)}BId(mb){this.Qa.removeHandler("TokenRefreshed",mb)}get accessTokenExpiringMessage(){const mb=(new Date(this.ik)).format(this.$.ya.ShortTimeFormat);return String.format(w.a.instance.ob(78),mb)}get tokenExpired(){return this.rlb}get Lcb(){return!1}get mba(){return!1}get LGd(){return!1}get K4(){return!1}ecc(){return k.a.instance.DQ(c.AFrameworkApplication.ik)}dispose(){m.a.Ia(this.Qa);
this.$=null}WAj(){this.$.isEditMode&&this.Fbc(!1)}VAj(){this.rlb=!0;this.Fbc(!0);this.Qa.raiseEvent("SessionExpired")}Fbc(mb){d.ULS.sendTraceTag(537170715,0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${mb}, GotDeploymentOrTimedOutError ${this.$.ea.D3}`);const Ca=this.$.rb.Vo;mb&&Ca&&Ca.isVisible&&1299163859===Ca.error.MessageId&&this.$.rb.Vo.Pu();const $a=this.Yc(mb);r.a(this.$).ls(new u.a(y.a.Mx,5,()=>{const Kb=z.a(this.$),rb=Kb.jd.activityState;rb[x.a.z1]=this.$.uob(this.$.isEditMode);
rb[x.a.WL]=x.a.D8a;rb[B.a.oq]=y.a.accessTokenExpiringWarning;Kb.jd.$q([$a])}))}Yc(mb){return mb?n.a.NDe():this.p9g()}p9g(){const mb=n.a.Yc(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");mb.Description=this.accessTokenExpiringMessage;return mb}}Object(t.a)(A,"EwaAccessTokenExpirationManager",l,[404,405,2]);var I=a(7),F=a(172),U=a(80),X=a(638),S=a(28);class H{constructor(mb,Ca){this.ZGb=!1;this.correlationID=mb;this.w3c=Ca;this.hzc=!1;this.creationTime=S.a.Wa.Nb}}Object(t.a)(H,"RefreshAccessTokenContext",
null,[]);var D=a(58),J=a(61),M=a(173),G=a(45),T=a(111),K=a(118),L=a(1),V=a(22),W=a(140),da=a(36),qa=a(115);class O{}Object(t.a)(O,"Error",null,[]);class ea{}Object(t.a)(ea,"NamedResult",null,[]);class R extends ea{}Object(t.a)(R,"ErrorInfo",ea,[]);class oa{constructor(mb,Ca){this.kWb=mb;this.zG=Ca}get tokens(){return this.kWb}get errors(){return this.zG}}Object(t.a)(oa,"TokenRefreshArgs",null,[408]);class pa{constructor(mb,Ca){this.documentVisibilityObserver=null;this.Qa=new v.a;this.rx=null;this.wdb=
this.qkb=!1;this.Aqc=null;this.fHb=!1;this.Ctd=!0;this.y9d=this.Y8d=this.hH=this.rlb=!1;this.nS=null;this.O4e=()=>{if(this.$.ea.fc)this.o5e(!1);else if(this.Ctd){this.Ctd=!1;const $a=z.a(this.$);d.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${$a.di?$a.di.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.$8f()}]`)}};this.Xc=($a,Kb)=>{this.context&&($a=this.$.ea,Kb.EH&&this.context.ZGb&&
!this.context.hzc?(this.context.hzc=!0,Kb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},Kb.IsUserActive=$a.jf.cs,Kb.RefreshAccessTokenCorrelationID=this.context.correlationID,Kb=D.a.Ac(Kb),d.ULS.sendTraceTag(537170708,0,50,Kb)):!this.qkb||$a.fc||this.context.w3c||(Kb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.rx&&(this.rx.cancel(),Kb.Aborted=!0,Kb.ResetStopRefreshRetriesUntilTokenExpired=!0,
this.wdb=!1),Kb.TimeUntilTokenExpirationInMin=this.$8f(),Kb.RefreshAccessTokenCorrelationID=this.context.correlationID,Kb=D.a.Ac(Kb),d.ULS.sendTraceTag(572019856,0,50,Kb)))};this.gya=()=>{if(this.context&&this.context.ZGb&&!this.context.hzc){var $a={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};$a.CreatedForExpired=this.context.w3c;$a.RefreshAccessTokenCorrelationID=this.context.correlationID;$a.OpenWorkbookErrors=n.a.yc(this.$.ea.JF);$a.ExecutionContextErrors=n.a.yc(z.a(this.$).jd.errors);
$a.accesstokenTTL=c.AFrameworkApplication.ik;$a=D.a.Ac($a);d.ULS.sendTraceTag(537170707,0,15,$a)}};this.n5e=()=>{this.wdb=!1;this.o5e(!0)};this.$Ad=()=>{this.fHb&&(this.$.ea.jf.SPa(this.$Ad),this.fHb=!1);this.t5f()};this.$=mb;this.iVd=Ca;this.JGd=mb.Ib.Og("WebServiceCall","refreshToken");k.a.instance.oUc(this.n5e);k.a.instance.mUc(this.O4e);Ca=this.$.ea;Ca.jk(this.Xc);Ca.wYb(this.gya);this.Nzi=this.$.ya.MinTokenLifetimeForRegularExpirationPromptInMin;this.R0f=this.$.ya.ShortAccessTokenExpirationPromptSeconds;
this.KMf=this.$.ya.RefreshAccessTokenDurationLimitInSec;this.Idg(mb.ea.SEf,c.AFrameworkApplication.ik);mb=JSON.stringify({["AccessTokenTtl"]:c.AFrameworkApplication.ik,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Iga,["WopiTokenExpiresAfterMinutes"]:c.AFrameworkApplication.PZd,["WopiTokenTaskItemPriority"]:c.AFrameworkApplication.RZd});d.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${mb}`);this.$.da.Za(291,$a=>{this.documentVisibilityObserver=
$a})}Pme(mb){this.Qa.addHandler("SessionExpired",mb)}uYb(mb){this.Qa.addHandler("TokenRefreshed",mb)}BId(mb){this.Qa.removeHandler("TokenRefreshed",mb)}get tokenExpired(){return this.rlb}get mba(){return this.Y8d}get K4(){return this.y9d}get context(){return this.nS}get Lcb(){return this.K4?!1:this.$.ea.jf.cs?1>qa.a.l5:6>qa.a.m5}get LGd(){return this.qkb}ecc(){return k.a.instance.DQ(c.AFrameworkApplication.ik)}dispose(){k.a.instance.OId(this.n5e);k.a.instance.NId(this.O4e);const mb=this.$.ea;mb&&
(mb.Ik(this.Xc),mb.Irc(this.gya));m.a.Ia(this.Qa);this.documentVisibilityObserver=this.$=null}$8f(){return this.ecc()?0:(c.AFrameworkApplication.ik-(new Date).getTime())/6E4}Idg(mb,Ca){if(0<Ca&&!this.ecc()){const $a=c.AFrameworkApplication.fa.nd("AccessTokenExpirationPromptSeconds",c.AFrameworkApplication.yX),Kb=(Ca-mb.getTime())/6E4;d.ULS.shipAssertTag(537170713,0,0<=Kb,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${Ca}] creationTime [${mb.getTime()}] tokenLifetimeInMin [${Kb}]`);
Kb<this.Nzi?(d.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.R0f}] tokenLifetimeInMin [${Kb}]`),c.AFrameworkApplication.yX=this.R0f):c.AFrameworkApplication.yX!==$a&&(d.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${$a}] tokenLifetimeInMin [${Kb}]`),c.AFrameworkApplication.yX=$a)}}K3g(mb){return!this.context||
this.context.ZGb||this.context.w3c!==mb?(mb=new H(F.a.create().toString(),mb),this.context&&!this.context.hzc&&d.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${mb.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.ZGb}] `),this.nS=mb,!0):!1}kfj(mb){mb&&this.hH&&!this.mba&&this.$.ea.jf.cs&&!this.K4&&(this.hH=!1)}o5e(mb){this.kfj(mb);if(!(this.qkb||this.wdb&&!mb||this.hH)&&
this.Lcb){this.qkb=!0;var Ca=this.context?this.context.creationTime:null,$a=this.K3g(mb);this.Ctd=!0;var Kb=this.$.ea,rb={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};rb.newContextCreated=$a;rb.IsUserActive=Kb.jf.cs;rb.IsSessionActive=Kb.fc;rb.ContainsChangesWorkbookOperations=this.$.userOperationManager.SGa();rb.isSessionExpired=mb;rb.stopRefreshRetriesUntilTokenExpired=this.wdb;rb.FailedToRefreshExpiredToken=this.hH;rb.numOfFailuresWhileUserIsActive=qa.a.l5;rb.numOfFailuresWhileUserIsInActive=
qa.a.m5;rb.numOfFailuresWhileOffline=qa.a.Oxa;rb.RefreshAccessTokenCorrelationID=this.context.correlationID;$a&&Ca&&(rb.TimeInMinFromPreviosContextCreation=Math.round(K.b(S.a.Wa,Ca)/60));Ca=D.a.Ac(rb);d.ULS.sendTraceTag(40416199,0,50,Ca);this.JGd.start();this.Y8d=Kb.jf.cs;this.rx=new X.a;this.pri(mb);var cc=this.iVd.I6i(!mb,this.rx?this.rx.token:null);cc.continueWith(()=>{this.pXg();const nc=this.iVd.L0i(cc);this.JGd.stop();const Wb=this.ecc();if(!nc||L.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&
Wb){const Ea=cc.result.errors;nc&&Wb&&this.yAg(Ea);this.K2h(Ea,mb)}else this.wdb=!1,this.M2h(cc.result.tokens,mb);this.qkb=!1},8)}}yAg(mb){const Ca=[Object(I.a)(new O,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];mb.add(Object(I.a)(new R,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:Ca}))}pri(mb){mb&&(this.$.ea.jf.cs?this.t5f():(this.$.ea.jf.ora(this.$Ad),this.fHb=!0))}t5f(){this.Aqc=M.AsyncMethodContext.lr(()=>{this.H6i()},1E3*this.KMf,G.a.o6i,this.Aqc)}pXg(){this.Aqc&&
this.Aqc.cancel();this.fHb&&(this.$.ea.jf.SPa(this.$Ad),this.fHb=!1);this.rx=null}H6i(){d.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.KMf}]`);this.rx.cancel()}K2h(mb,Ca){this.wdb=!0;Ca&&(this.hH||(this.rlb=this.hH=!0),this.iVd.gzb(mb)&&(this.y9d=!0));const $a=!Ca||this.Lcb&&!qa.a.ewc?40380379:39982555;Ca=this.mCe(Ca);Ca.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";Ca.FailedToRefreshExpiredToken=
this.hH;Ca.LastErrorIsPermanent=this.K4;if(0<mb.count){var Kb=mb.na(0);Ca.errorName=Kb.Name;0<Kb.Errors.length&&(Ca.ErrorId=Kb.Errors[0].Id,Kb=Kb.Errors[0].Details,Ca.ErrorDetails=this.Qgh(Kb.toString())?"PiiScrubbed":Kb)}Ca=D.a.Ac(Ca);d.ULS.sendTraceTag($a,0,15,Ca);this.Qa.raiseEvent("TokenRefreshed",new oa(null,mb))}Qgh(mb){return V.a.contains(mb,"makes the internet safe for businesses",!0)}mCe(mb){const Ca={},$a=this.$.ea;Ca.Name="";Ca.IsUserActive=$a.jf.cs;Ca.IsSessionActive=$a.fc;Ca.GotDeploymentOrTimedOutError=
$a.D3;Ca.TimeInSecFromLastStatefulSuccessfulRequest=$a.o0;Ca.TimeFromLastUserActivityInMs=$a.jf.JMb;Ca.calledFromSessionExpiredFlow=mb;Ca.RefreshTokenDurationInMS=this.JGd.uc;Ca.numOfFailuresWhileUserIsActive=qa.a.l5;Ca.numOfFailuresWhileUserIsInActive=qa.a.m5;Ca.numOfFailuresWhileOffline=qa.a.Oxa;Ca.RefreshAccessTokenCorrelationID=this.context.correlationID;Ca.accessTokenTTL=c.AFrameworkApplication.ik;Ca.ContainsChangesWorkbookOperations=this.$.userOperationManager.SGa();Ca.IsDocumentHidden=this.documentVisibilityObserver?
this.documentVisibilityObserver.Ii.toString():"Unknown";Ca.TimeFromFirstOpenInHr=Math.floor(K.b(S.a.Wa,T.toUtc($a.SEf))/3600);return Ca}M2h(mb,Ca){this.hH=!1;this.FTj();this.Idg(new Date,c.AFrameworkApplication.ik);const $a=this.$.ea,Kb=!Ca&&$a.jf.cs,rb=!this.$.isEditMode&&$a.pab;Ca=this.mCe(Ca);Ca.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";Ca.shouldTriggerSilentReloadAfterExpiring=Kb;Ca.WopiTokenTaskItemPriority=c.AFrameworkApplication.RZd;Ca.isDirtyViewSession=rb;Ca=D.a.Ac(Ca);
d.ULS.sendTraceTag(39982556,0,15,Ca);this.Qa.raiseEvent("TokenRefreshed",new oa(mb,null));rb?$a.jf.cs&&(d.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),$a.vad()):$a.jf.cs?Kb&&(mb=z.a(this.$).jd.activityState,mb[qa.a.neb]=!0,mb[W.a.CX]=!0,mb[da.a.Fr]=this.$.isEditMode,r.a(this.$).ls(new u.a(y.a.Qma,2,null))):$a.fc&&J.j(this.$.oa.va,!0,!1,!1,null,null,null,null,
null)}FTj(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=U.a.YS(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.aP,c.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=U.a.YS(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.zX,c.AFrameworkApplication.ik.toString()),this.$.ea.Hnc()):d.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");
this.$.ya.AccessToken=c.AFrameworkApplication.accessToken;this.$.ya.AccessTokenValidTo=c.AFrameworkApplication.ik;void 0!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=U.a.YS(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.aP,c.AFrameworkApplication.accessToken),this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=U.a.YS(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,
c.AFrameworkApplication.zX,c.AFrameworkApplication.ik.toString()));void 0!==this.$.ya.EmbedConfiguratorUrl&&null!==this.$.ya.EmbedConfiguratorUrl&&(this.$.ya.EmbedConfiguratorUrl=U.a.YS(this.$.ya.EmbedConfiguratorUrl,c.AFrameworkApplication.aP,c.AFrameworkApplication.accessToken),this.$.ya.EmbedConfiguratorUrl=U.a.YS(this.$.ya.EmbedConfiguratorUrl,c.AFrameworkApplication.zX,c.AFrameworkApplication.ik.toString()));this.context.ZGb=!0}}Object(t.a)(pa,"EwaAccessTokenExpirationRefreshManager",null,[404,
405,2]);var Pa=a(185),Z=a(155),Ra=a(84),Ga=a(412);class Ba{}Ba.oXb="ActivityDuration";Ba.error="Error";Ba.L7c="Errors";Ba.failed="Failed";Ba.wAh="FirstActivity";Ba.initialized="Initialized";Ba.xpi="LastActivity";Ba.mTf="RetryOverride";Ba.Lej="RequestGroups";Ba.requests="Requests";Ba.$Sf="Responses";Ba.xuc="SessionDuration";Ba.status="Status";Ba.success="Success";Ba.Ana="Successful";Ba.tokens="Tokens";Object(t.a)(Ba,"SessionExpirationStrings",null,[]);var fa=a(107);class Y{constructor(mb){this.Lo=
{};this.RW={};this.wtg={};this.plf=15;this.T8d=!1;this.hvg=new Date;this.TSb=new Date;this.fe=mb;this.aWb=new fa.a(2,2,6E4*this.plf,Object(f.a)(this,this.Agg,"writeMeasures"),135,"SL",!1);this.fe.Ag(this.aWb);this.E$h()}Agg(){d.ULS.sendTraceTag(41964821,217,50,d.ULS.Ac({["Aggregate"]:this.RW,["Current"]:this.Lo}))}E$h(){this.RW[Ba.Lej]=0;this.RW[Ba.requests]=0;this.RW[Ba.$Sf]=0;this.RW[Ba.status]=Ba.initialized;this.RW[Ba.wAh]=new Date;this.RW[Ba.xuc]=0;this.RW[Ba.oXb]=0;this.RW[Ba.xuc]=0;this.Lo[Ba.xuc]=
0;this.RW[Ba.oXb]=0;this.Lo[Ba.oXb]=0}Ojd(mb,Ca){var $a=mb[Ca];$a=$a?$a:0;$a++;mb[Ca]=$a;this.ZNd(mb)}ZNd(mb){const Ca=new Date;mb[Ba.oXb]=+Ca-+this.TSb;this.TSb=Ca;mb[Ba.xuc]=+this.TSb-+this.hvg;mb[Ba.xpi]=this.TSb}W_(mb,Ca){this.Lo[mb]=Ca;this.ZNd(this.Lo)}wNd(mb,Ca){this.Lo[mb]=Ca;this.ZNd(this.Lo)}incrementCounter(mb){this.Ojd(this.Lo,mb);this.Ojd(this.RW,mb);this.Ojd(this.wtg,mb)}flush(){this.T8d||(this.RW[Ba.status]=this.Lo[Ba.status],this.Agg(this.aWb),this.fe.wma(this.aWb,6E4*this.plf))}stop(){d.ULS.sendTraceTag(41964822,
217,100,"Stopping logger. Flushing one last time");this.flush();this.T8d=!0;this.fe.Xo(this.aWb)}}Object(t.a)(Y,"SessionLogger",null,[441]);var ja=a(98),ca=a(639),aa=a(370),ta=a(163),xa=a(936),ia=a(186),ya=a(165);class ib{constructor(mb,Ca,$a,Kb=null,rb=!1,cc=null,nc=!1,Wb=!1){this.Bqa=0;this.B8=this.Pi=null;this.kWb=new Pa.a;this.zG=new Pa.a;this.hk=null;this.NSb=!1;this.dRc=this.eRc=null;this.fe=mb;this.Jce=Ca;this.Jce.execute(Ea=>{Ea.Tl(ta.a.Vid,Object(f.a)(this,this.VLi,"onHostResponseReceived"))});
this.HG=$a;this.mhe=new xa.a("WebServiceCall","TokenRefresh");this.hh=Kb||new Y(mb);this.cvg=rb;this.LS=cc?cc:ca.SessionStatusManager.instance;this.K4d=nc;this.nRb=Wb}VLi(mb){if(mb.MessageId!==ta.a.Vid)ya.a(39408099,306,15,"Unexpected message.");else{var Ca=new Pa.a,$a=new Pa.a;this.hh.incrementCounter(Ba.$Sf);var Kb=mb.Values[aa.a.yXf];if(!Kb||0>=Kb.length)ya.a(40122317,306,15,"Found no tokens in the dictionary"),Kb=mb.Values;ya.a(40122318,306,100,"The Tokens array contains {0} tokens",Kb.length);
this.hh.W_("Correlation",mb.CorrelationId);var rb="";for(let Wb=0;Wb<Kb.length;Wb++){this.hh.wNd(Ba.tokens,Kb.length);var cc=Kb[Wb],nc=cc;if(!nc||!nc.Name)continue;this.hh.incrementCounter(nc.Name);const Ea=cc;if(Ea&&Ea.Value)ya.a(39408128,306,100,"Received token with name: {0}",Ea.Name),Ca.add(Ea),this.kWb.add(Ea),this.nRb||this.hh.W_(Ba.status,Ba.success),this.K4d&&this.LS&&this.LS.Lfj();else if(cc=this.KVh(cc),ya.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",
nc.Name,JSON.stringify(cc),this.B8),$a.add(cc),this.nRb||(this.zG.add(cc),rb=JSON.stringify(cc),this.hh.W_(Ba.error,JSON.stringify(cc)),this.hh.W_(Ba.status,Ba.failed)),this.K4d)for(const ua of cc.Errors)nc=this.IMh(ua),this.LS&&this.LS.TCg(nc)}this.nRb?(0<$a.count?this.dRc&&this.dRc(new oa(Ca,$a)):this.eRc&&this.eRc(new oa(Ca,$a)),ya.a(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",Ca.count,$a.count,mb.CorrelationId,this.B8)):(0<$a.count&&
""!==rb?(Kb=Object.assign(new ia.a,{extendedProperties:new Map}),Kb.extendedProperties.set("Errors",rb),ja.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Kb)):ja.Health.instance.recordKpiSuccess("WACTokenRefresh",null),ya.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",Ca.count,$a.count,mb.CorrelationId,this.B8),0<$a.count&&!this.gzb($a)?(mb=this.HG.I0e($a),mb!==this.HG.Abb&&(this.hh.wNd(Ba.mTf,mb),this.fe.wma(this.Pi,
mb))):(this.hh.flush(),this.Pi&&(ya.a(39408131,306,100,"Deleting task {0} from task manager",this.Pi.name),this.fe.Xo(this.Pi)),this.hk&&!this.hk.task.isCompleted&&this.hk.setResult(new oa(Ca,$a))))}}KVh(mb){if(!mb)return null;const Ca=Object.assign(new R,{Name:mb.Name,Errors:[]});for(const $a of mb.Errors)mb=new O,mb.Id=$a.Id,mb.Details=this.JVh($a.Details),Ca.Errors.push(mb);return Ca}JVh(mb){if(!mb)return"";const Ca=mb.toString().toLowerCase();return 0<Ca.indexOf("<!doctype")?this.Ted("Seems to contain HTML - Contains <!DOCTYPE"):
0<Ca.indexOf("<html")?this.Ted("Seems to contain HTML - Contains <html>"):500<Ca.length?this.Ted(String.format("Error details content too long: Length: {0}",Ca.length)):mb}Ted(mb){return String.format("{0} - Reason: [{1}]","### REDACTED ###",mb)}requestTokensOnce(){this.hSf()}hSf(){c.AFrameworkApplication.$ic("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.Bqa>=this.HG.Nof?(ya.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.B8),this.sCe(this.hk,
"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(ja.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.KWf())}KWf(){const mb={};mb[aa.a.yXf]=this.HG.tokens;const Ca=F.a.create().toString();ya.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.HG.tokens),this.Bqa+1,Ca,this.B8);this.Jce.execute($a=>{$a.Fj(ta.a.fpe,mb,Ca)});this.Bqa++;this.hh.incrementCounter(Ba.requests)}sCe(mb,
Ca,$a){const Kb=new Pa.a;for(let rb=0;rb<this.HG.tokens.length;rb++){const cc=Object.assign(new R,{Name:this.HG.tokens[rb],Errors:[Object.assign(new O,{Id:Ca,Details:$a})]});Kb.add(cc);this.zG.add(cc)}this.fe.Xo(this.Pi);this.hh.W_(Ba.L7c,JSON.stringify(this.zG));this.hh.W_(Ba.status,Ba.failed);mb&&!mb.task.isCompleted&&mb.setResult(new oa(new Pa.a,this.zG))}I6i(mb,Ca=null){this.mhe.start();this.NSb=mb;this.B8=F.a.create().toString();ya.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",
this.B8,this.NSb);this.Bqa=0;this.zG.clear();this.kWb.clear();const $a=new Z.a;this.hk=$a;Ca&&Ca.R(()=>{const Kb=!!$a&&!$a.task.isCompleted;ya.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.B8,this.NSb,Kb);Kb&&this.sCe($a,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.nRb?this.iSf(this.HG.Nof).then(Kb=>{this.hk&&!this.hk.task.isCompleted&&this.hk.setResult(Kb);this.hh.W_(Ba.L7c,JSON.stringify(this.zG));this.hh.W_(Ba.status,
Ba.success);this.hh.flush()}).catch(Kb=>{this.hk&&!this.hk.task.isCompleted&&this.hk.setResult(Object(Ra.a)(408,Kb));this.hh.W_(Ba.L7c,JSON.stringify(this.zG));this.hh.W_(Ba.status,Ba.failed);this.hh.flush()}):(this.Pi=new fa.a(this.HG.priority,2,this.HG.Abb,Object(f.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,ta.a.fpe,!0),this.cvg&&this.hSf(),this.fe.Ag(this.Pi));return this.hk.task}iSf(mb){const Ca=this,$a=new Promise((Wb,Ea)=>{Ca.eRc=Wb;Ca.dRc=Ea;ja.Health.instance.recordKpiUsage("WACTokenRefresh",
1,"wwrelfc",null);Ca.KWf()}),Kb=this,rb=new Promise((Wb,Ea)=>{window.setTimeout(()=>{Ea(Kb.xCe("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},Kb.HG.Abb)});let cc=mb;const nc=this;return new Promise((Wb,Ea)=>{cc--;Promise.race([$a,rb]).then(ua=>{ja.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Wb(ua)}).catch(ua=>{var ma=nc.HG.Abb;if(Object(Ga.a)(408,ua)&&(ua=Object(Ra.a)(408,ua),0<ua.errors.count)){nc.dlf(ua.errors);nc.$q(ua.errors);if(nc.gzb(ua.errors)){Ea(ua);
return}const fb=nc.HG.I0e(ua.errors);fb!==nc.HG.Abb?(nc.hh.wNd(Ba.mTf,fb),ma=fb):nc.Tmi(ua.errors)&&(ma=0)}cc?window.setTimeout(()=>{nc.iSf(cc).then(Wb).catch(Ea)},ma):(ma=nc.xCe("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),nc.dlf(ma.errors),nc.$q(ma.errors),Ea(ma))})})}$q(mb){for(let Ca of mb)this.zG.add(Ca)}Tmi(mb){if(!mb.count)return!1;mb=mb.na(mb.count-1);return mb.Errors.length?"TIMEOUT"==mb.Errors[0].Id:!1}xCe(mb,Ca){const $a=
new Pa.a;for(let Kb=0;Kb<this.HG.tokens.length;Kb++){const rb=this.x5g(this.HG.tokens[Kb],mb,Ca);$a.add(rb)}return new oa(new Pa.a,$a)}x5g(mb,Ca,$a){return Object.assign(new R,{Name:mb,Errors:[Object.assign(new O,{Id:Ca,Details:$a})]})}dlf(mb){if(mb.count){mb=mb.na(mb.count-1);mb=JSON.stringify(mb);var Ca=Object.assign(new ia.a,{extendedProperties:new Map});Ca.extendedProperties.set("Errors",mb);ja.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Ca);this.hh.W_(Ba.error,
mb);this.hh.W_(Ba.status,Ba.failed)}}L0i(mb){this.mhe.stop();const Ca=this.V3h(mb.result.errors);d.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!Ca,this.B8,this.NSb,this.Bqa,this.zG.count,0<mb.result.errors.count?mb.result.errors.na(0).Name:"",0<mb.result.errors.count&&0<mb.result.errors.na(0).Errors.length?mb.result.errors.na(0).Errors[0].Id:
"",0<mb.result.errors.count&&0<mb.result.errors.na(0).Errors.length?mb.result.errors.na(0).Errors[0].Details:"");return Ca?!1:this.K0i(mb.result.tokens)}gzb(mb){return this.HG.gzb(mb)}K0i(mb){for(let Ca=0;Ca<mb.count;Ca++){const $a=mb.na(Ca);if($a.Name===aa.a.accessToken){const Kb=(new Date).getTime();$a.Expiry>c.AFrameworkApplication.ik?(d.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:$a.Expiry,["NowGetTime"]:Kb,["BootTime"]:c.AFrameworkApplication.Iga},"PreviousAccessTokenTtl",
c.AFrameworkApplication.ik),c.AFrameworkApplication.accessToken=$a.Value,c.AFrameworkApplication.ik=Math.floor($a.Expiry),c.AFrameworkApplication.QZd=Kb,c.AFrameworkApplication.wXa=Math.floor($a.Expiry)):d.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:$a.Expiry,["NowGetTime"]:Kb,["BootTime"]:c.AFrameworkApplication.Iga},"PreviousAccessTokenTtl",c.AFrameworkApplication.ik)}}return!0}V3h(mb){let Ca=!1;for(let $a=0;$a<
mb.count;$a++){Ca=!0;const Kb=mb.na($a);d.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",Kb.Name,JSON.stringify(Kb.Errors),this.B8)}return Ca}IMh(mb){let Ca=e.a.wuc;mb=parseInt(mb.Id);if(isNaN(mb))Ca=e.a.dXj;else{switch(mb){case 401:Ca=e.a.gXj;break;case 403:Ca=e.a.bXj;break;case 500:Ca=e.a.cXj;break;case 503:Ca=e.a.fXj}Ca===e.a.wuc&&(Ca=500<mb?e.a.eXj:e.a.aXj)}return Ca}}Object(t.a)(ib,"TokenRefreshManager",null,[409]);class wa{constructor(){this.Abb=c.AFrameworkApplication.jXj;
this.Nof=c.AFrameworkApplication.hXj;this.tokens=c.AFrameworkApplication.C_h();this.priority=c.AFrameworkApplication.RZd;this.Vde=this.Prj();this.QRc=c.AFrameworkApplication.B_h()}gzb(mb){mb=JSON.stringify(mb);if(this.QRc&&0<this.QRc.length)for(const Ca of this.QRc)if(0<Ca.length&&0<=mb.indexOf(Ca))return!0;return!1}I0e(mb){try{if(mb)for(let Ca of mb)if(Ca.Errors)for(const $a of Ca.Errors)if($a.Id in this.Vde)return Number.parseInvariant(this.Vde[$a.Id].toString())}catch(Ca){d.ULS.sendTraceTag(41501720,
217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",Ca.toString())}return this.Abb}Prj(){const mb={};try{if(!c.AFrameworkApplication.obc()||0>=c.AFrameworkApplication.obc().length||""===c.AFrameworkApplication.obc()[0])return mb;for(const Ca of c.AFrameworkApplication.obc())0<Ca.length&&(mb[Ca]=c.AFrameworkApplication.iXj)}catch(Ca){d.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",Ca.toString())}return mb}}Object(t.a)(wa,"TokenRefreshPolicy",
null,[407]);class sa extends b.a{constructor(mb){super();this.$=mb;this.Fb()}create(){c.AFrameworkApplication.fN("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");c.AFrameworkApplication.fa.qa("RefreshAccessTokenSilently")?this.qb(this.C5g()):this.qb(this.$.da.za(38)||this.$.da.Ga(38,new A(this.$)))}C5g(){var mb=this.$.da.za(38);if(mb)return mb;mb=new ib(c.AFrameworkApplication.zi,c.AFrameworkApplication.GU(),new wa);return this.$.da.Ga(38,new pa(this.$,
mb))}static ka(mb){mb.da.Ga(39,new sa(mb))}}Object(t.a)(sa,"AccessTokenExpirationManagerFactory",b.a,[]);var Ya=a(10);a.d(C,"a",function(){return bb});const bb=()=>{Ya.a.Fa(sa.ka)}},1193:function(t,C,a){t=a(0);var c=a(83),b=a(144);class d extends b.a{constructor(z){super(!1,!1,!0);this.iPb=z}start(){const z={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.iPb.Zid}};this.initializeAndShow("",Object(c.a)(this,this.Kgj,"resultHandler"),z)}Kgj(z,A){1===z&&(this.iPb.Zid=
A.tooltipPersistenceEnabled)}}Object(t.a)(d,"AccessibilitySettingsDialog",b.a,[]);var f=a(106),e=a(25);class k{constructor(z,A){this.La=z;this.iPb=A}Gg(){this.La.Ob(e.a.ryj,f.a.frame,Object(c.a)(this,this.syj,"showAccessibilitySettingsDialogHandler"))}syj(){(new d(this.iPb)).start();return 32}}Object(t.a)(k,"AccessibilitySettingsDialogActor",null,[360]);var l=a(155),m=a(4);const v=z=>{const A=new l.a;m.AFrameworkApplication.vd.Bm(n(z),1,null,null,!0,2,I=>{200===I.data.httpStatus?A.setResult("true"===
I.data.Vd.toLowerCase()):A.setResult(!1)},()=>{A.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return A.task},n=z=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",m.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",z,m.AFrameworkApplication.ij);var w=a(159);class r{constructor(){this.tVa=null}get Zid(){return!!this.tVa}set Zid(z){z!==this.tVa&&(this.tVa=z,w.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(z),this.Cff()&&
m.AFrameworkApplication.vd.Bm(n("saveHoverableRibbonTooltipIsEnabled"),2,z.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}Wri(){const z=new l.a;if(this.tVa)z.setResult(this.tVa);else if(this.Cff()){const A=v("getHoverableRibbonTooltipIsEnabled");A.continueWith(()=>{this.tVa=A.result;w.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(A.result);z.setResult(A.result)},8)}else z.setResult(!1)}Cff(){const z=m.AFrameworkApplication.fa.qa("IsRoamingServiceEnabled"),
A=m.AFrameworkApplication.fa.qa("IsAnonymousUser");return z&&!A}}Object(t.a)(r,"AccessibilitySettingsInfo",null,[357]);var u=a(246),y=a(165);class x{constructor(){this.fb=null}get name(){return"Common.App.AccessibilitySettings"}Rh(z){this.fb=z;this.fb.register(r,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Fc(()=>new r).tc();this.fb.register(k,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Fc(()=>
new k(m.AFrameworkApplication.wb,this.fb.vh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).tc()}init(){const z=this.fb.vh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),A=this.fb.vh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");z&&A?(A.Gg(),z.Wri()):y.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){u.a.instance.yi(new x)}}Object(t.a)(x,
"AccessibilitySettingsPackage",null,[4,5]);a.d(C,"a",function(){return B});const B=()=>{Type.registerNamespace("Common.App.AccessibilitySettings");x.main()}},1194:function(t,C,a){var c=a(10);t=a(0);var b=a(221),d=a(15),f=a(86),e=a(27),k=a(412),l=a(1120),m=a(519),v=a(184),n=a(223),w=a(24),r=a(65),u=a(43),y=a(162),x=a(239),B=a(47),z=a(45),A=a(12),I=a(71),F=a(127),U=a(1),X=a(11),S=a(21),H=a(338),D=a(236),J=a(13),M=a(154),G=a(93),T=a(5),K=a(248),L=a(77),V=a(97),W=a(42),da=a(34);class qa extends G.a{constructor(ta,
xa,ia,ya){super(ta);this.J7f=[6];this.B7f=[26];this.Jr=null;this.Wyb=this.fhc=!1;this.Yr=this.uaa=null;this.o4=!1;this.onPointerDown=ib=>{if(1!==this.$.Ka.qH())return!0;ib=da.a(this.$).Td(ib);if(this.gB)return!0;var wa=W.a(this.$).qnd||W.a(this.$).Sp();if(this.spd||wa)return this.nbb(),!0;this.Yr=this.Xl;this.BHd();this.Eid();wa=2===ib.tb&&ib.Tn===Sys.UI.MouseButton.leftButton;const sa=3===ib.tb;if(wa||sa)ib=this.ha.Vn(ib.clientPoint,ib.Cb,5,void 0,void 0,!0),ib||(ib=this.Yr),this.Wyb=wa,this.fhc=
sa,this.Yr=this.F2e(ib),this.Eid(),wa?this.T7i():sa&&this.K8i(),K.b(this.$,!0);return!0};this.Hh=ib=>{ib=da.a(this.$).Td(ib);if(!this.gB)return!1;let wa=this.Wyb?this.ha.Vn(ib.clientPoint,ib.Cb,5,void 0,void 0,!0):this.ha.Vn(ib.clientPoint,ib.Cb,5,!0,!1,!0);this.o4&&!wa&&(wa=this.ha.nnb(ib.clientPoint,ib.Cb,5));wa&&(ib=this.F2e(this.sYa(wa)),this.J_b(ib.bottomRight),this.Yr.equals(ib)||(this.Yr=ib,this.tHb(!1),this.BHd(!1),this.Eid(!1),this.R5h(),this.lb.update(!1)),this.JQj(this.Yr));return!0};this.Kf=
ib=>{da.a(this.$).Td(ib);if(!this.gB)return!1;this.resizeTable();this.nbb();return!0};this.IEb=ib=>{da.a(this.$).Td(ib);if(!this.gB)return d.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.nbb();return!0};this.b_=ib=>{da.a(this.$).Td(ib);this.nbb();return!0};this.$tf=()=>{this.gB&&this.nbb()};this.gridView=xa;this.$=xa.$;this.tableManager=ya;this.ha=xa.ha;this.lb=xa.lb;this.parentElement=ta;this.mRg();e.a.np||
e.a.dba||D.a.instance.ra(J.a.pointerDown,this.uaa,this.onPointerDown);this.Xl=ia;this.pKc=this.spd=!1;this.tableManager.BDg(this.$tf);this.o4=U.EwaSettings.isChangeGateEnabled("OfficeVSO:7030316_NewTableResizeExperience")}get gB(){return this.Wyb||this.fhc}get Bgf(){return this.pKc}dispose(){this.nbb();this.tableManager.Q$i(this.$tf);this.Bgf||e.a.np||e.a.dba||D.a.instance.Ba(J.a.pointerDown,this.uaa,this.onPointerDown);if(this.gB){K.b(this.$,!1);try{this.Cv()}catch(ta){d.ULS.sendTraceTag(537151236,
0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${ta}`)}}this.parentElement&&this.parentElement.contains(this.uaa)&&this.parentElement.removeChild(this.uaa);this.uaa=this.parentElement=null;super.dispose()}F2e(ta){const xa=ta.bottom-this.Xl.topLeft.bottom-1;return 0<=ta.right-this.Xl.topLeft.right+1&&0<=xa&&ta.bottom>=this.Xl.top&&ta.right>=this.Xl.left?new w.Range(this.Xl.top,this.Xl.left,ta.bottom,ta.right,!1,!1):this.Yr}Eid(ta=!0){this.Zuc([this.Yr],6,ta);this.lb.zn(this.J7f)}tHb(ta=
!0){this.lb.Mg(this.J7f);this.Zuc([null],6,ta)}BHd(ta=!0){this.lb.Mg(this.B7f);this.Zuc([null],26,ta)}R5h(){const ta=this.mHj();0<ta.length&&(this.Zuc(ta,26,!1),this.lb.zn(this.B7f))}mHj(){const ta=[];this.Xl.contains(this.Yr)&&(this.Xl.right!==this.Yr.right&&ta.push(new w.Range(this.Xl.top,this.Yr.right+1,this.Yr.bottom,this.Xl.right,!1,!1)),this.Xl.bottom!==this.Yr.bottom&&ta.push(new w.Range(this.Yr.bottom+1,this.Xl.left,this.Xl.bottom,this.Xl.right,!1,!1)));return ta}resizeTable(){if(!this.Yr.equals(this.Xl)){const ta=
new w.Range(this.Xl.top,this.Xl.left,this.Yr.bottom,this.Yr.right,!1,!1);this.dMj(ta);this.spd=!0}}onKeyDown(ta){da.a(this.$).Td(ta);return!0}h9a(){this.Bgf&&(e.a.np||e.a.dba||(D.a.instance.ra(J.a.pointerDown,this.uaa,this.onPointerDown),this.uaa.classList.remove("ewr-table-resize-default-cursor"),this.pKc=this.uaa.disabled=!1),this.pKc=!1)}mRg(){const ta=document.createElement("div");ta.className="ewr-table-resize-handle";const xa=document.createElement("div");xa.className="ewr-table-resize-fillhandle-higher";
const ia=document.createElement("div");ia.className="ewr-table-resize-fillhandle-broader";ta.appendChild(xa);ta.appendChild(ia);this.uaa=ta;this.parentElement.appendChild(this.uaa)}J_b(ta){const xa=this.o4?2:5;let ia=60;const ya=this.Yr.contains(ta);let ib=ta.top,wa=ta.bottom,sa=ta.left,Ya=ta.right,bb=null;if(ya){if(this.gridView.nK(this.Xl.topLeft)&&!this.Xl.aSa)return;this.o4?ta.bottom<this.Yr.bottom?(ib=Math.max(1,wa-xa,this.Xl.top),ia=16):(sa=Math.max(1,Ya-xa,this.Xl.left),ia=4):(ib=Math.max(1,
wa-xa,this.Xl.top),sa=Math.max(1,Ya-xa,this.Xl.left));wa=ib;Ya=sa;bb=new w.Range(ib,sa,ib,sa,!1,!1)}else this.o4?ta.right>=this.Xl.right?(Ya+=xa,ia=8):ta.bottom>=this.Xl.bottom&&(wa+=xa,ia=32):(wa+=xa,Ya+=xa),ib=wa,sa=Ya,bb=new w.Range(wa,Ya,wa,Ya,!1,!1),ia=16;this.gridView.nK(bb)||(this.Jr?this.Jr.Bq||(this.Jr=B.a.instance.create(()=>{this.gridView.dt(bb,ia,V.a.G7f)},40,z.a.H7f)):this.Jr=B.a.instance.create(()=>{this.gridView.dt(bb,ia,V.a.G7f)},40,z.a.H7f))}sYa(ta){let xa=ta;if(this.gridView.ib.J3){if(!this.gridView.Vb(ta.topLeft)){const ia=
this.gridView.mk("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.nH,this.Yr.top!==ta.top?1:2);try{ia.Fk=this.Yr.top<ta.top||this.Yr.left<ta.left,ia.es(ta.topLeft),xa=ia.$$cu().range}finally{ia&&ia.dispose()}}xa.right=xa.left+ta.width-1;xa.bottom=xa.top+ta.height-1}return xa}Zuc(ta,xa,ia=!0){const ya=[];for(const ib of ta)ya.push(new H.a(ib,r.d(this.$.pa)));this.lb.vv(ya,[xa],!0,void 0,ia)}T7i(){this.o4&&D.a.instance.ra(J.a.zj,document.documentElement,this.Hh);for(const ta of this.gridView.tn)D.a.instance.ra(J.a.zj,
ta.domElement,this.Hh);D.a.instance.ra(J.a.Mf,document.documentElement,this.Kf);this.RGe()}K8i(){this.o4&&M.a.instance.ra(J.a.Xf,document.documentElement,this.Hh);for(const ta of this.gridView.tn)M.a.instance.ra(J.a.Xf,ta.domElement,this.Hh);M.a.instance.ra(J.a.te,document.documentElement,this.IEb);this.RGe()}Cv(){this.Wyb&&this.WOj();this.fhc&&this.gPj()}WOj(){this.o4&&D.a.instance.Ba(J.a.zj,document.documentElement,this.Hh);for(const ta of this.gridView.tn)D.a.instance.Ba(J.a.zj,ta.domElement,this.Hh);
D.a.instance.Ba(J.a.Mf,document.documentElement,this.Kf);this.IMf()}gPj(){this.o4&&M.a.instance.Ba(J.a.Xf,document.documentElement,this.Hh);for(const ta of this.gridView.tn)M.a.instance.Ba(J.a.Xf,ta.domElement,this.Hh);M.a.instance.Ba(J.a.te,document.documentElement,this.IEb);this.IMf()}RGe(){this.o4||D.a.instance.ra(J.a.ky,document.documentElement,this.b_);this.gridView.hc.v6b(!0)}IMf(){this.o4||D.a.instance.Ba(J.a.ky,document.documentElement,this.b_);this.gridView.hc.v6b(!1)}dMj(ta){this.$.ud(-1400250766,
L.a.Eb,30,{["ResizeTableRange"]:ta,["OriginalTableRange"]:this.Xl})}JQj(ta){if(!this.Xl.contains(ta)){ta=this.lHj();for(const xa of ta)if(this.tableManager.Tpd(xa)){this.gridView.Df.Wl(T.a.OCi);return}}this.gridView.rtl?this.gridView.Df.Wl(T.a.VBi):this.gridView.Df.Wl(T.a.cEi)}nbb(){if(this.gB){K.b(this.$,!1);try{this.Cv()}catch(ta){d.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${ta}`)}}this.Jr&&(this.Jr.cancel(),this.Jr.dispose());
this.fhc=this.Wyb=!1;this.tHb();this.BHd();K.b(this.$,!1);this.gridView.Df.Wl(T.a.jQ)}lHj(){const ta=[];this.Xl.right!==this.Yr.right&&ta.push(new w.Range(this.Xl.top,this.Xl.right+1,this.Yr.bottom,this.Yr.right,!1,!1));this.Xl.bottom!==this.Yr.bottom&&ta.push(new w.Range(this.Xl.bottom+1,this.Xl.left,this.Yr.bottom,this.Xl.right,!1,!1));return ta}static createInstance(ta,xa,ia,ya){if(!xa)return null;const ib=ta.lb;ib.vv(ia,[27],!0);ib.zn(qa.gHj);ia=ib.dv(27,ta.ib.Vi(xa.bottomRight),qa.$Lh(xa,ia)).uf;
return new qa(ia,ta,xa,ya)}static $Lh(ta,xa){var ia;for(let ya=0;ya<xa.length;ya++)if((null===(ia=xa[ya])||void 0===ia?0:ia.range)&&xa[ya].range.equals(ta))return ya;return 0}}qa.gHj=[27];Object(t.a)(qa,"TableResizeBehavior",G.a,[]);var O=a(7);G=a(235);class ea{}ea.Brh="ewa-ttrd-buttonarea";Object(t.a)(ea,"CssClassNames",null,[]);var R=a(48),oa=a(131),pa=a(90),Pa=a(22),Z=a(14),Ra=a(253),Ga=a(132),Ba=a(261);class fa extends G.a{constructor(ta){super(document.createElement("div"));this.uSc=this.tmd=
this.mFf=this.lQ=!1;this.wJb=null;this.Fh=()=>{x.c(this.$,this.gridView.ha.sa.activeCell)?(this.mLa=!0,this.tqb(!1)):(this.nZ=this.mLa=!1,this.xbg())};this.mt=()=>{this.mLa?this.tqb(!0):this.nZ=!1};this.duf=()=>{this.uSc=!0;this.mLa&&(this.nZ=!1)};this.onContentReady=()=>{this.$.isEditMode?x.c(this.$,this.gridView.ha.sa.activeCell)&&(this.mLa=!0,this.tqb(!1)):this.nZ=!1};this.Vxa=()=>{this.uSc=!1;this.mLa?this.tqb(!1):this.nZ=!1};this.nf=(xa,ia)=>{this.mLa&&(xa=this.gridView.boc(ia.fd.block.se.BlockCachePosition.PaneType).pG(ia.fd.hash))&&
(xa.TId(this.zKa),xa.vUc(this.zKa))};this.zKa=()=>{this.MQf()};this.$=ta;this.gridView=S.g(this.$);this.parentElement=this.domElement;this.parentElement.className=ea.Brh;this.iKa=this.gridView.tj;this.mLa=!0;this.l$h();this.FLg();this.tqb(!1);d.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get nZ(){return this.tmd}set nZ(ta){this.tmd!==ta&&(this.tmd=this.isVisible=ta)}get Ozb(){return!!(this.$.Bd&16)}get kii(){const ta=this.gridView.ha.sa.activeCell;return ta.right===
ta.maxColumns}get Qlb(){const ta=this.gridView.Vb(null);return ta&&this.gridView.t4(ta.range)?this.Tua(ta):(ta&&d.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}dispose(){this.$&&this.wdh();this.$=this.gridView=this.parentElement=this.iKa=null;super.dispose()}TJh(ta){const xa=this.IYh(this.gridView.Vb(null).range);return xa?`=SUBTOTAL(${ta},${xa})`:null}IYh(ta){var xa=S.g(this.$).Db.Yj(ta);if(!xa)return null;xa=y.a(xa,!1);xa.right=
xa.left=ta.left;return xa.toString()}l$h(){fa.bM={};fa.bM["100"]=Z.a.instance.ga(1103);fa.bM["101"]=Z.a.instance.ga(1106);fa.bM["102"]=Z.a.instance.ga(1105);fa.bM["103"]=Z.a.instance.ga(1110);fa.bM["104"]=Z.a.instance.ga(1107);fa.bM["105"]=Z.a.instance.ga(1108);fa.bM["109"]=Z.a.instance.ga(1104);fa.bM["107"]=Z.a.instance.ga(1111);fa.bM["110"]=Z.a.instance.ga(1113);fa.bM["111"]=Z.a.instance.ga(1164)}FVi(){var ta=this.gridView.Vb(null);if(ta&&(ta=ta.gF?ta.formulaBarText:null))if("=SUBTOTAL("===ta.substring(0,
10)){if(ta=ta.substring(10,13),ta in fa.bM)return ta}else return"111";return"100"}FLg(){this.gridView.Ea.Ks(this.nf);this.gridView.ha.pJ(this.Fh);this.gridView.Ku(this.onContentReady);this.gridView.hc.Nk(this.duf);this.gridView.hc.em(this.Vxa)}wdh(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.RK(this.Fh),this.gridView.Ea.Nq(this.nf)),this.gridView.py(this.onContentReady),this.gridView.hc&&(this.gridView.hc.tk(this.duf),this.gridView.hc.yl(this.Vxa)),this.xbg())}tqb(ta){this.UQj(ta);this.Ozb&&
(this.MFj(),this.Qlb?(this.mFf||this.PLg(),this.uSc?this.nZ=!1:(this.nZ=!0,this.MQf())):(d.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.nZ=!1))}MQf(){appChrome.renderTableTotalRowOptions(this.parentElement,fa.bM,fa.bM[this.FVi()].toString(),Math.round(da.a(this.$).si(17)),ta=>{d.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${ta}`);let xa={["SelectedOption"]:fa.bM[ta],
["FunctionKeyCode"]:ta,["Location"]:"canvas"};Ga.b(this.$).Cd(oa.a.qHj,xa,null,!0);if("111"===ta)return this.Jci(),!0;if("100"!==ta){this.wJb=this.TJh(ta);if(!this.wJb)return d.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.WQa(this.wJb)}else this.WQa("");A.DOMElementExtensions.setFocus(this.gridView.Xb.textBox.domElement);return!0})}Jci(){d.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");
const ta=new pa.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ka.Mb(ta)}Tua(ta){if(!ta)return null;var xa=this.gridView.hc.textBox.domElement;var ia=0<A.DOMElementExtensions.getHeight(xa)&&0<A.DOMElementExtensions.getWidth(xa)&&0<=xa.offsetTop&&0<=xa.offsetLeft;if(ia)xa=A.DOMElementExtensions.Tua(xa,this.gridView.tj);else{xa=this.gridView.getCellBounds(ta.cell);var ya=A.DOMElementExtensions.getBoundingClientRect(this.gridView.tj);xa=new Sys.UI.Bounds(xa.x-ya.x,xa.y-ya.y,xa.width,xa.height)}if(xa)if(ia)2<
xa.height&&2<xa.height&&(xa.x+=1,xa.y+=1,xa.height-=2,xa.width-=2);else if(ia=S.g(this.$).WJ(ta.cell))ia=ia.width,ya=Pa.a.equals(Ra.a.yub(ta.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&ya&&(xa.x=xa.x+xa.width-ia),ta.oka&&this.gridView.rtl===ya&&(xa.width=ia);else return null;return xa}UQj(ta){var xa=this.Qlb;if(xa){var ia=17>=xa.height?xa.y:xa.y+xa.height-17-2;xa=this.kii?this.gridView.rtl?xa.x:xa.x+xa.width-(17<xa.height?17:xa.height):this.gridView.rtl?xa.x-(17<xa.height?17:xa.height):
xa.x+xa.width;var ya=da.a(this.$).gja(new Sys.UI.Point(xa,ia));this.parentElement.style.top=X.HelperMethods.pc(ya.y);this.parentElement.style.left=X.HelperMethods.pc(ya.x);da.a(this.$).irj(this.parentElement);ta&&(this.nZ=this.gridView.nhc(new R.a(xa,ia)))}else this.nZ=!1}PLg(){this.iKa.insertBefore(this.parentElement,this.iKa.firstChild);this.mFf=!0}MFj(){this.lQ||(this.gridView.view.Ls(this.mt),this.lQ=!0)}xbg(){this.lQ&&this.gridView.view&&(this.gridView.view.Pq(this.mt),this.lQ=!1)}WQa(ta){const xa=
this.gridView.Xb,ia=this.gridView.Vb(null);ia&&(ta=Object(O.a)(new Ba.a,{Text:ta}),this.gridView.setCell(ta,ia.range,0,127,null),xa.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}fa.pHj="TableTotalRowDropDownIconButtonId";fa.bM=null;Object(t.a)(fa,"TableTotalRowOptions",G.a,[2]);class Y extends l.a{constructor(ta){super(S.g(ta));this.Pob=this.l0=this.ryc=this.Nob=null;this.Yoe=!1;this.m9d=null;this.FQb=0;this.i4b=null;this.a_b=()=>{const xa={},ia=this.Sed();for(let ib in ia){const wa=ia[ib];
if(!wa)continue;const sa=this.LXh(wa);if(sa){if(sa in this.VEa){var ya=this.VEa[sa];if(ya.gB){ya.Xl.equals(wa)||(ya.Xl=wa);delete this.VEa[sa];xa[sa]=ya;continue}}(ya=qa.createInstance(S.g(this.$),wa,this.OGh(),this))?xa[sa]=ya:d.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${wa.hz(!1)}`)}}this.d1b(null,null);this.mPb=xa};this.d1b=()=>{const xa=this.VEa;for(let ib in xa){var ia=ib,ya=xa[ib];ya&&(ya.dispose(),delete this.VEa[ia])}this.mPb=
{}};this.TKf=()=>{this.d1b(null,null);this.a_b(null,null)};this.onFocus=()=>{this.m9d=S.g(this.$).ha.sa.activeCell};this.XQ=()=>{this.$.isEditMode&&this.Fh(null,null)};this.Fh=()=>{!this.Yoe&&x.c(this.$,this.gridView.ha.sa.activeCell)&&this.gsi()};this.kV=()=>{this.xxb(1);this.$.ea.Wn(this.kV)};this.RFb=()=>{this.Yoe=!0;this.ryc=new fa(this.$)};this.$=ta;this.gridView=S.g(this.$);this.$.da.Ga(66,this);this.mPb={};this.a_b(null,null);this.$.xa&&this.$.xa.Pf(this.TKf);this.Sme(this.a_b);this.$.ea.GX(this.XQ);
this.gridView.ha.pJ(this.Fh);this.$.isEditMode&&this.Fh(null,null)}Sme(ta){this.addHandler(l.a.xFd,ta)}cQf(ta){this.removeHandler(l.a.xFd,ta)}BDg(ta){this.addHandler("tce",ta)}Q$i(ta){this.removeHandler("tce",ta)}get VEa(){return this.mPb}get grd(){return this.m9d}get AHa(){return this.FQb}get Jg(){const ta=S.g(this.$);return ta.Db.Yj(ta.ha.sa.activeCell,!1)}get dEd(){return this.grd?S.g(this.$).Db.Yj(this.grd,!1):null}Tpd(ta){return!!this.F_e(ta)}Fm(ta){return this.kUh(this.n0e(ta))}eub(ta){return this.n0e(ta)}H8i(ta){ta?
(this.Pob?this.Pob!==ta&&(f.a.Ia(this.l0),this.l0=null,this.Pob=ta):this.Pob=ta,this.l0||(this.l0=F.a.instance.Zd(this.Pob)),this.l0.ln("focusin")||this.l0.ka("focusin",this.onFocus)):d.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")}Pcf(ta,xa){return ta?ta.yaa&&ta.top===xa.top:(d.ULS.shipAssertTag(537151244,0,!!ta,"autofilterRange can't be null"),!1)}eja(ta){ta=this.Nob?u.I(ta,this.Nob):this.view.getRangeInformation(ta);return 0<ta.length&&
Object(k.a)(n.PivotTableRange,ta[0])?ta[0]:null}Zei(ta,xa){return ta?!ta.Yec&&!!ta.AE&&ta.AE.Dd(xa):(d.ULS.shipAssertTag(537151243,0,!!ta,"Pivot table can't be null"),!1)}Wki(ta,xa){return ta?!ta.Yec&&!!ta.ZK&&ta.ZK.Dd(xa):(d.ULS.shipAssertTag(537151242,0,!!ta,"Pivot table can't be null"),!1)}TXb(ta){super.TXb(ta);if((ta=X.HelperMethods.Q_e(ta))&&0<ta.length){this.Nob=Array(ta.length);for(let xa=0;xa<ta.length;xa++)this.Nob[xa]=v.a.bQ(ta[xa])}}mHb(){super.mHb();this.Nob=null}g3g(ta,xa){return this.wBe(ta,
xa).returnValue}wBe(ta,xa){var ia=!1;if(!ta||!xa)return{returnValue:!1,PX:ia};ta=ta.clone();ta.right+=1;ta.left=ta.right;return!ta.xz||ta.top<xa.ib.Ui&&(ia=ta.clone(),ia.bottom>=xa.ib.Ui&&(ia.bottom=xa.ib.Ui-1),!({PX:ia}=this.vBe(ia,xa)).returnValue)||ta.bottom>=xa.ib.Ui&&(ia=ta.clone(),ia.top<=xa.ib.Ui&&(ia.top=xa.ib.Ui),!({PX:ia}=this.vBe(ia,xa)).returnValue)?{returnValue:!1,PX:ia}:{returnValue:!0,PX:ia}}I7f(ta){(ta=this.Fm(ta.topLeft))&&ta.toString()in this.VEa&&(this.VEa[ta.toString()].spd=!1)}n2i(){this.raiseEvent("tce")}Th(ta,
xa){if(!this.ryc)return!1;switch(xa){case -569786022:case 541421805:if(this.ryc.nZ){const ia=document.getElementById(fa.pHj);ia&&B.a.instance.create(()=>{A.DOMElementExtensions.Vdc(ia,null)},0,z.a.jHj,!0,!0)}return!0;default:return!1}}dispose(){this.d1b(null,null);this.cQf(this.a_b);this.$.xa.zg(this.TKf);this.$.zl(this.d1b);this.mPb=null;this.$.ea&&this.$.ea.z_(this.XQ);this.gridView.ha.RK(this.Fh);this.ryc=null;U.EwaSettings.ma(407)&&this.l0&&(f.a.Ia(this.l0),this.l0=null);super.dispose()}r3h(ta,
xa,ia,ya){const ib=this.gridView.Db.Yj(new w.Range(xa,ia,xa,ia,!1,!1));if(this.i4b=ib){var wa=ib.usedRange,sa=ta.ctrlKey||e.a.isMac&&I.b(ta),Ya=!ta.shiftKey&&sa;ta=ta.shiftKey&&!sa;U.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(S.g(this.$).ha.selectionType=3);switch(ya){case 0:this.FQb=0;U.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(xa=this.s3c(ta,wa.top,ia,wa.bottom,ia),this.BOd(xa,Ya,ta)):this.COd(wa.top,ia,wa.bottom,
ia,y.d(ib),y.g(ib),Ya);break;case 1:this.FQb=1;U.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(xa=this.s3c(ta,xa,wa.left,xa,wa.right),this.BOd(xa,Ya,ta)):this.COd(xa,wa.left,xa,wa.right,!1,!1,Ya);break;case 2:this.FQb=2;U.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(xa=this.s3c(ta,wa.top,wa.left,wa.bottom,wa.right),this.BOd(xa,Ya,ta)):this.COd(wa.top,wa.left,wa.bottom,wa.right,y.d(ib),y.g(ib),Ya);break;default:d.ULS.shipAssertTag(537151240,
0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${ya.toString()}`);return}U.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&(S.g(this.$).ha.selectionType=3);d.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else d.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}Mvj(ta){const xa=
this.i4b.usedRange;return this.Zef(ta)||1!==this.AHa&&this.Zef(new w.Range(xa.top,ta.left,xa.bottom,ta.right,!1,!1))?!0:!1}wFd(ta){return ta.Autofilters}vBe(ta,xa){let ia;ia=!1;const ya=xa.ib.Vi(ta),ib=xa.Lf(ya).gi;if(!ib)return d.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${ya}`),{returnValue:!1,PX:ia};if(!ib.Ge(ta))return{returnValue:!0,PX:ia};ta=xa.mk("TableManager.CouldExpandImpl",ta,2);try{for(;ta.$$mn();){if(ta.$$cu().text||ta.Hn.W5e)return ia=
!0,{returnValue:!1,PX:ia};if(ta.$$cu().KH)return{returnValue:!1,PX:ia}}}finally{ta&&ta.dispose()}return{returnValue:!0,PX:ia}}kUh(ta){if(!ta)return null;const xa=new m.AutofilterRange(ta.top,ta.left,ta.bottom,ta.right,null,null,null,ta.id,ta.yaa);xa.aSa=ta.aSa;const ia=this.gridView.Db.Yj(ta,!0);if(!ia)return null;for(let ya=0,ib=this.rangeList.length;ya<ib;ya++){const wa=this.rangeList[ya],sa=this.gridView.Db.Yj(wa,!0);sa&&sa.name===ia.name&&wa!==ta&&this.cki(wa)&&(xa.union(wa),wa.aSa&&(xa.aSa=!0))}return xa}cki(ta){return!!S.g(this.$).Db.Yj(ta)}OGh(){const ta=
[];for(const xa of this.rangeList){const ia=new H.a(this.Fm(xa.topLeft),r.d(this.$.pa));ta.push(ia)}return ta}Sed(){const ta={};for(const xa of this.rangeList){if(!xa)continue;const ia=this.Fm(xa.topLeft);ia&&(ta[ia.toString()]=this.Fm(xa.topLeft))}return ta}gsi(){this.$.ea.Fg?this.xxb(0):this.$.ea.El(this.kV)}xxb(ta){this.$.Qx(xa=>{xa.aaa(ta).then(this.RFb)})}LXh(ta){const xa=this.gridView.Db.Yj(ta);return xa?xa.name:ta.toString()}COd(ta,xa,ia,ya,ib,wa,sa){const Ya=ta+(ib?1:0),bb=ia-(wa?1:0),mb=
this.gridView.inRangePicker||this.gridView.xi;let Ca=!1;const $a=new w.Range(Ya,xa,bb,ya,!1,!1);if(ib||wa){ib=mb?H.a.Mqb(this.gridView.ha.rangePicker.LK):this.gridView.ha.sa.selectedRanges;for(const Kb of ib){Ca=this.Spb(Kb,Ya,xa,bb,ya);ib=this.Spb(Kb,ta,xa,ia,ya);if(mb&&Ca)break;if(!mb&&(Ca||ib)){this.gridView.ha.updateSelection(Kb,Kb.topLeft,0,1);if(sa&&ib)return;break}}}Ca&&($a.top=ta,$a.bottom=ia);ta=$a.topLeft;sa?this.gridView.ha.updateSelection($a,ta,0,1):mb?this.gridView.ha.Lw([$a],0,ta,0):
this.gridView.ha.updateSelection($a,ta,0,3)}BOd(ta,xa,ia){ta&&(ia=ia?S.g(this.$).ha.sa.activeCell:ta.topLeft,xa?this.gridView.ha.updateSelection(ta,ia,0,1):this.gridView.ha.Lw([ta],0,ia,0))}s3c(ta,xa,ia,ya,ib){const wa=y.d(this.i4b),sa=y.g(this.i4b),Ya=xa+(1!==this.AHa&&wa?1:0),bb=ya-(1!==this.AHa&&sa?1:0),mb=this.gridView.inRangePicker||this.gridView.xi;if(ta){var Ca=U.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&mb&&!H.a.Mqb(this.gridView.ha.rangePicker.LK).length?
new w.Range(Ya,ia,bb,ib,!1,!1):mb?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.sa.activeCell;Ca=new w.Range(Ca.top<Ya?Ca.top:Ya,Ca.left<ia?Ca.left:ia,Ca.bottom>bb?Ca.bottom:bb,Ca.right>ib?Ca.right:ib,!1,!1)}else Ca=new w.Range(Ya,ia,bb,ib,!1,!1);if(1!==this.AHa&&(wa||sa)&&(!ta||ta&&this.Spb(Ca,Ya,ia,bb,ib))){ta=mb?H.a.Mqb(this.gridView.ha.rangePicker.LK):this.gridView.ha.sa.selectedRanges;for(const $a of ta)if(this.Spb($a,Ya,ia,bb,ib)){Ca.top=xa;Ca.bottom=ya;break}}return Ca}Zef(ta){const xa=
this.gridView.inRangePicker||this.gridView.xi?H.a.Mqb(this.gridView.ha.rangePicker.LK):this.gridView.ha.sa.selectedRanges;for(const ia of xa)if(this.Spb(ia,ta.top,ta.left,ta.bottom,ta.right))return!0;return!1}Spb(ta,xa,ia,ya,ib){return!!ta&&ta.top===xa&&ta.bottom===ya&&ta.left===ia&&ta.right===ib}}Object(t.a)(Y,"TableManager",l.a,[260,2]);class ja extends b.a{constructor(ta){super();this.tableManager=null;this.$=ta;this.Fb()}create(){this.qb(this.tableManager||(this.tableManager=new Y(this.$)))}}
Object(t.a)(ja,"TableManagerFactory",b.a,[]);var ca=a(1209);a.d(C,"a",function(){return aa});const aa=()=>{c.a.Fa(ta=>{ta.da.Ga(134,new ja(ta));ta.da.Ga(330,new ca.a(ta))})}},1209:function(t,C,a){t=a(0);var c=a(221),b=a(50),d=a(37),f=a(7),e=a(15),k=a(110),l=a(811),m=a(1452),v=a(722),n=a(1383),w=a(38),r=a(5),u=a(160),y=a(77),x=a(61),B=a(162),z=a(47),A=a(45),I=a(111);a(28);var F=a(191),U=a(29),X=a(281),S=a(1),H=a(22),D=a(14);a(30);class J{}Object(t.a)(J,"TableStyleElement",null,[]);var M=a(748),G=a(209),
T=a(87),K=a(524);class L{static wmf(ea,R){return L.L7f[ea.Type]-L.L7f[R.Type]}static y3a(ea,R){try{return appChrome.buildTableStyleGalleryIconNew(L.BAa,L.Fna,ea,R)}catch(oa){return null}}static Dgf(ea){return ea&&y.a.Pc in ea&&(ea=ea[y.a.Pc])?H.a.jL(ea,r.a.bGb):!1}static zsa(ea){const R=[];let oa=0;for(const pa of ea){R[oa]={};R[oa].backgroundColor="white";R[oa].color="black";for(let Pa in pa)switch(ea=pa[Pa],Pa){case "background-color":R[oa].backgroundColor=ea;break;case "color":R[oa].color=ea;break;
case "font-size":R[oa].fontSize=ea;break;case "border-bottom":R[oa].borderBottom=ea;break;case "border-right":R[oa].borderRight=ea;break;case "border-left":R[oa].borderLeft=ea;break;case "border-top":R[oa].borderTop=ea}oa++}return R}static L2b(ea,R){const oa=[];if(null===ea||void 0===ea?0:ea.TableStyleElementsList){var pa=0===ea.Category;for(let Pa=0;Pa<L.Fna;Pa++)oa.push(...L.PKh(ea,R,pa,Pa))}else{if(L.R4c)return L.R4c;ea={color:"black","background-color":"white"};for(R=0;R<L.Fna;R++)for(pa=0;pa<
L.BAa;pa++)oa.push(ea);L.R4c=oa}return oa}static MXh(ea,R){if(!ea.TableStyleElementsList)return"";let oa="";for(const pa of ea.TableStyleElementsList)if(pa.BackgroundColor&&"#000000"!==pa.BackgroundColor)switch(pa.Type){case 0:oa=pa.BackgroundColor;break;case 5:case 7:if(R.hha||R.xR)oa=pa.BackgroundColor;break;case 3:case 4:if(R.firstCol||R.lastCol)oa=pa.BackgroundColor;break;case 2:R.totalRow&&(oa=pa.BackgroundColor);break;case 1:R.headerRow&&(oa=pa.BackgroundColor)}return oa}static M1b(ea){ea=new G.a(parseInt(String("0x"+
ea.substr(1,2)),16),parseInt(String("0x"+ea.substr(3,2)),16),parseInt(String("0x"+ea.substr(5,2)),16));return M.a.NJa(ea)}static b2e(ea,R){if(!ea||!R)return"";R=(R=L.MXh(ea,R))?L.M1b(R)+", ":D.a.instance.ga(2069)+", ";switch(ea.Index){case 0:return R+D.a.instance.ga(2003);case 1:return R+D.a.instance.ga(2004);case 2:return R+D.a.instance.ga(2005);case 3:return R+D.a.instance.ga(2006);case 4:return R+D.a.instance.ga(2007);case 5:return R+D.a.instance.ga(2008);case 6:return R+D.a.instance.ga(2009);
case 7:return R+D.a.instance.ga(2010);case 8:return R+D.a.instance.ga(2011);case 9:return R+D.a.instance.ga(2012);case 10:return R+D.a.instance.ga(2013);case 11:return R+D.a.instance.ga(2014);case 12:return R+D.a.instance.ga(2015);case 13:return R+D.a.instance.ga(2016);case 14:return R+D.a.instance.ga(2017);case 15:return R+D.a.instance.ga(2018);case 16:return R+D.a.instance.ga(2019);case 17:return R+D.a.instance.ga(2020);case 18:return R+D.a.instance.ga(2021);case 19:return R+D.a.instance.ga(2022);
case 20:return R+D.a.instance.ga(2023);case 21:return R+D.a.instance.ga(2024);case 22:return R+D.a.instance.ga(2025);case 23:return R+D.a.instance.ga(2026);case 24:return R+D.a.instance.ga(2027);case 25:return R+D.a.instance.ga(2028);case 26:return R+D.a.instance.ga(2029);case 27:return R+D.a.instance.ga(2030);case 28:return R+D.a.instance.ga(2031);case 29:return R+D.a.instance.ga(2032);case 30:return R+D.a.instance.ga(2033);case 31:return R+D.a.instance.ga(2034);case 32:return R+D.a.instance.ga(2035);
case 33:return R+D.a.instance.ga(2036);case 34:return R+D.a.instance.ga(2037);case 35:return R+D.a.instance.ga(2038);case 36:return R+D.a.instance.ga(2039);case 37:return R+D.a.instance.ga(2040);case 38:return R+D.a.instance.ga(2041);case 39:return R+D.a.instance.ga(2042);case 40:return R+D.a.instance.ga(2043);case 41:return R+D.a.instance.ga(2044);case 42:return R+D.a.instance.ga(2045);case 43:return R+D.a.instance.ga(2046);case 44:return R+D.a.instance.ga(2047);case 45:return R+D.a.instance.ga(2048);
case 46:return R+D.a.instance.ga(2049);case 47:return R+D.a.instance.ga(2050);case 48:return R+D.a.instance.ga(2051);case 49:return R+D.a.instance.ga(2052);case 50:return R+D.a.instance.ga(2053);case 51:return R+D.a.instance.ga(2054);case 52:return R+D.a.instance.ga(2055);case 53:return R+D.a.instance.ga(2056);case 54:return R+D.a.instance.ga(2057);case 55:return R+D.a.instance.ga(2058);case 56:return R+D.a.instance.ga(2059);case 57:return R+D.a.instance.ga(2060);case 58:return R+D.a.instance.ga(2061);
case 59:return R+D.a.instance.ga(2062);default:return ea.Name?ea.Name:""}}static PRh(ea){return(ea+1)%L.M6h}static Ivb(ea,R,oa=""){return ea||!oa?`${L.m8e}, ${ea.Index.toString()}, -version, ${R.toString()}`:`${L.m8e}, ${oa}, -version, ${R.toString()}`}static PKh(ea,R,oa,pa){const Pa=[];for(let Z=0;Z<L.BAa;Z++)Pa.push(L.scd(ea,R,oa,pa,Z));return Pa}static scd(ea,R,oa,pa,Pa){ea=ea.TableStyleElementsList;let Z=new J;const Ra={};if(!ea)return Ra;for(var Ga of ea)if(0===Ga.Type){Z=Ga;break}Ga=!!Z.BackgroundColor;
let Ba="";!oa&&Z.TableStyleBorderFromatList&&0<Z.TableStyleBorderFromatList.length&&(Ba=Z.TableStyleBorderFromatList[0].Color);Ra["background-color"]=Ga?Z.BackgroundColor:"#FFFFFF";Z.FontColor||(Z.FontColor="#000000");Ra.color=Z.FontColor;L.Iwe(pa,Pa,Ra,Z,Ba,oa,Ga);for(const fa of ea)fa&&0!==fa.Type&&(2!==fa.Type||Ga||(fa.BackgroundColor=Z.BackgroundColor),L.Kpd(fa,pa,Pa,R)&&(fa.BackgroundColor&&(Ra["background-color"]=fa.BackgroundColor),Ra.color=fa.FontColor||Z.FontColor,L.Iwe(pa,Pa,Ra,fa,Ba,oa,
Ga)));return Ra}static CU(ea,R,oa,pa,Pa,Z){oa&&(oa.Color&&!oa.Style&&(oa.Style=1),oa.Style&&!oa.Color&&(oa.Color=Pa?"#000000":pa?pa:Z?"#FFFFFF":"#000000"),R[L.borders[ea]]="1px "+L.dV[oa.Style]+" "+oa.Color)}static Kpd(ea,R,oa,pa){return-1===ea.Type?!1:L.Mpd(ea,R,oa,pa)||L.gmi(ea,R,oa,pa)||L.Npd(ea,R,oa,pa)}static gmi(ea,R,oa,pa){return!R&&pa.headerRow||R===L.Fna-1&&pa.totalRow?!1:1===R%2&&5===ea.Type&&pa.xR&&pa.headerRow||1<R&&!!((R-1)%(ea.BandSize+1))&&6===ea.Type&&pa.xR&&pa.headerRow||!(R%2)&&
5===ea.Type&&pa.xR&&!pa.headerRow||!!(R%(ea.BandSize+1))&&6===ea.Type&&pa.xR&&!pa.headerRow||!(oa%2)&&7===ea.Type&&pa.hha||!!(oa%(ea.BandSize+1))&&8===ea.Type&&pa.hha}static Npd(ea,R,oa,pa){return R===L.Fna-1&&2===ea.Type&&pa.totalRow||oa===L.BAa-1&&R===L.Fna-1&&12===ea.Type&&pa.totalRow&&pa.lastCol||!oa&&R===L.Fna-1&&11===ea.Type&&pa.totalRow&&pa.firstCol||oa===L.BAa-1&&4===ea.Type&&pa.lastCol}static Mpd(ea,R,oa,pa){return!R&&1===ea.Type&&pa.headerRow||!oa&&3===ea.Type&&pa.firstCol||!oa&&!R&&9===
ea.Type&&pa.headerRow&&pa.firstCol||oa===L.BAa-1&&!R&&10===ea.Type&&pa.headerRow&&pa.lastCol}static Iwe(ea,R,oa,pa,Pa,Z,Ra){if(pa.TableStyleBorderFromatList)for(const Ga of pa.TableStyleBorderFromatList)if(Ga.Style)switch(Ga.Position){case 0:ea&&12!==pa.Type&&11!==pa.Type&&2!==pa.Type&&5!==pa.Type&&6!==pa.Type||L.CU(0,oa,Ga,Pa,Z,Ra);break;case 1:ea!==L.Fna-1&&1!==pa.Type&&10!==pa.Type&&9!==pa.Type&&5!==pa.Type&&6!==pa.Type||L.CU(1,oa,Ga,Pa,Z,Ra);break;case 2:R&&12!==pa.Type&&10!==pa.Type&&7!==pa.Type&&
8!==pa.Type&&4!==pa.Type||L.CU(2,oa,Ga,Pa,Z,Ra);break;case 3:R!==L.BAa-1&&9!==pa.Type&&11!==pa.Type&&3!==pa.Type&&7!==pa.Type&&8!==pa.Type||L.CU(3,oa,Ga,Pa,Z,Ra);break;case 5:R!==L.BAa-1&&3!==pa.Type&&4!==pa.Type&&7!==pa.Type&&8!==pa.Type&&L.CU(3,oa,Ga,Pa,Z,Ra);break;case 6:ea!==L.Fna-1&&2!==pa.Type&&1!==pa.Type&&5!==pa.Type&&6!==pa.Type&&L.CU(1,oa,Ga,Pa,Z,Ra)}}static PXh(){const ea=Array(12);ea[0]=0;ea[7]=1;ea[8]=2;ea[5]=3;ea[6]=4;ea[4]=5;ea[3]=6;ea[1]=7;ea[2]=8;ea[9]=9;ea[10]=10;ea[11]=11;ea[12]=
13;return ea}}L.Fna=5;L.BAa=5;L.M6h=5;L.m8e="TableStyleIcon";L.dV=[null,T.a.solid,T.a.dashed,T.a.dotted,T.a.dashed,T.a.dotted,T.a.dashed,T.a.double];L.borders=[K.a.borderTop,K.a.borderBottom,K.a.borderLeft,K.a.borderRight];L.L7f=L.PXh();L.R4c=null;Object(t.a)(L,"TableStyleHelper",null,[]);class V{constructor(ea,R,oa,pa,Pa,Z){this.headerRow=ea;this.totalRow=R;this.firstCol=oa;this.lastCol=pa;this.xR=Pa;this.hha=Z}equals(ea){return ea?this.headerRow===ea.headerRow&&this.totalRow===ea.totalRow&&this.firstCol===
ea.firstCol&&this.lastCol===ea.lastCol&&this.hha===ea.hha&&this.xR===ea.xR:!1}}Object(t.a)(V,"TableStyleOptions",null,[]);var W=a(786);class da extends w.a{constructor(ea,R,oa){super();this.y_i={["height"]:"100%"};this.dHb={};this.rHa=this.Ffd=0;this.lastSyncTime=new Date;this.ida=-1;this.IN=null;this.Yla={};this.lL=null;this.FI={};this.BSa={};this.yqc=null;this.Jzb=this.T5a=this.isInitialized=this.Qef=!1;this.Etc=null;this.Qxc=this.XLb=this.tTe=!1;this.xLi=(pa,Pa,Z)=>{let Ra=!1;if(X.a(pa))-315732528!==
pa.Errors[0].MessageId&&(e.ULS.sendTraceTag(42821707,0,10,`TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : ${U.a.yc(pa.Errors)}`),this.ixf(null,Pa,Z));else if(e.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(pa=pa.Result)&&pa.TableStyleItems.length){Z=60<pa.TableStyleItems.length;var Ga=!1,Ba=!1;if(this.lL)for(var fa=0;60>fa;++fa){const Y=pa.TableStyleItems[fa],ja=this.lL.TableStyleItems[fa];if(Y.HasStyleViolations!==
ja.HasStyleViolations){Ra=Ba=!0;break}for(let ca=0;9>ca&&!(ca>=Y.TableStyleElementsList.length);ca++)if(!H.a.equals(Y.TableStyleElementsList[ca].BackgroundColor,ja.TableStyleElementsList[ca].BackgroundColor,!1)){Ra=Ga=!0;break}}else{this.rHa=0;for(fa of pa.TableStyleItems)fa.TableStyleElementsList&&fa.TableStyleElementsList.sort(L.wmf),this.FI[fa.Name]=fa}if(Ga||Ba)for(Ga=0;60>Ga;++Ga)Ba=pa.TableStyleItems[Ga],this.FI[Ba.Name]=Ba;if(Z&&this.lL)for(e.ULS.sendTraceTag(42821700,0,50,`TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - ${pa.TableStyleItems.length-
60}`),Ra=!0,Z=60;Z<pa.TableStyleItems.length;++Z)Ga=pa.TableStyleItems[Z],Ga.Name in this.FI||Ga.TableStyleElementsList&&Ga.TableStyleElementsList.sort(L.wmf),this.FI[Ga.Name]=Ga;if(W.a(this.FI).length!==pa.TableStyleItems.length)for(Ra=!0,Ga=Z=60;Ga<this.lL.TableStyleItems.length;)Z>=pa.TableStyleItems.length?delete this.FI[this.lL.TableStyleItems[Ga].Name]:Z>=pa.TableStyleItems.length||!H.a.equals(pa.TableStyleItems[Z].Name,this.lL.TableStyleItems[Ga].Name,!1)?delete this.FI[this.lL.TableStyleItems[Ga].Name]:
++Z,++Ga;this.lL=pa;this.dNf(Ra);Ra&&this.JXc();Pa&&("accessibility"===Pa?(this.XLb=!1,this.Qxc=!0):this.Qxc=!1);this.Qef||(this.wmi()&&this.$.qf(),this.Qef=!0);this.Ffd=0;this.Jzb||this.tTe?this.Qxc&&this.raiseEvent("RefreshTableStyleGallery"):(this.raiseEvent("RefreshTableStyleGallery"),this.tTe=!0)}};this.ixf=()=>{e.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");this.Ffd++;5>this.Ffd&&z.a.instance.create(()=>{this.Y3a("getTableStylesFailed")},
1E3,A.a.K7f,!0,!0)};this.PCf=()=>{this.Jzb&&(this.Jzb=!1,this.Etc&&this.Etc(),z.a.instance.create(()=>{this.Y3a("galleryMenuClosed")},1E3,A.a.K7f,!0,!0))};this.$=ea;this.Sa=R;this.tableManager=oa;this.$.da.Ga(329,this);this.fYc=this.Bub();this.$.Ka.fYa(this.PCf)}k5e(ea){const R=this.tableManager.Jg;if(!R)return!1;ea=ea[y.a.Pc];if(!ea)return!1;switch(Number.parseInvariant(ea)){case 0:return B.d(R);case 1:return B.c(R);case 2:return B.g(R);case 3:return B.e(R);case 4:return B.f(R);case 5:return B.b(R);
case 6:return R.hasAutoFilter}return!1}LGf(ea,R){if(k.a.isEmpty(this.FI))return!0;if("PopulateTableMoreStylesMenu"!==ea&&"PopulateTableAccessibleStylesMenu"!==ea)return!1;if("PopulateTableAccessibleStylesMenu"===ea&&!this.Qxc)return this.XLb||(this.XLb=!0,this.Y3a("accessibilityTab")),!0;this.Jzb=!0;const oa=this.Sa.sq("TableStylesMenu"),pa=this.Sa.FC("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),Pa=this.Sa.FC("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),Z=this.Sa.FC("Ribbon.TableTools.TableStyles.Gallery.Medium",
7,"Size48by48"),Ra=this.Sa.FC("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48");let Ga=-123538519,Ba;if(R.MenuId)if(H.a.contains(R.MenuId,"FormatAsTable",!0))Ga=753331043,this.T5a=!0;else{Ba=D.a.instance.ga(2002);var fa=L.Ivb(null,1,"-1");S.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?Ra.Kt("-1",Ga,"QueryTableStyle",0,"-1",fa,void 0,void 0,Ba):Ra.Kt("-1",Ga,"QueryTableStyle",0,"-1",void 0,void 0,void 0,Ba);this.T5a=!1}fa=0;const Y=this.FI;for(let ja in Y){const ca=
Y[ja];if("PopulateTableAccessibleStylesMenu"===ea&&ca.HasStyleViolations)continue;let aa;Ba=L.b2e(ca,this.Bub());aa=L.Ivb(ca,this.rHa);if(ca)switch(ca.Category){case 0:pa.Kt(ca.Index.toString(),Ga,"QueryTableStyle",0,ca.Index.toString(),aa,void 0,void 0,Ba);fa++;break;case 3:Pa.Kt(ca.Index.toString(),Ga,"QueryTableStyle",0,ca.Index.toString(),aa,void 0,void 0,Ba);break;case 2:Z.Kt(ca.Index.toString(),Ga,"QueryTableStyle",0,ca.Index.toString(),aa,void 0,void 0,Ba);break;case 1:Ra.Kt(ca.Index.toString(),
Ga,"QueryTableStyle",0,ca.Index.toString(),aa,void 0,void 0,Ba)}}0<fa&&this.I1(oa,pa,1970);this.I1(oa,Ra,1971);this.I1(oa,Z,1972);this.I1(oa,Pa,1973);R.MenuItems=oa.rE();this.isInitialized||(this.isInitialized=!0);return!0}ohd(ea){ea[l.a.On]=!1;let R=ea[y.a.Pc];if(R&&!k.a.isEmpty(this.FI)){H.a.contains(ea.ParentMenuId,"FormatAsTable",!0)?this.T5a=!0:this.T5a=!1;this.T5a||this.jcg();L.Dgf(ea)&&(R=this.Wub(R).toString());var oa=this.Bub();ea[l.a.Alt]="-1"===R?D.a.instance.ga(2002):L.b2e(this.Efd(R),
oa);if(R in this.BSa&&oa.equals(this.fYc))this.NGf(ea,R,oa,!0);else{if(!this.yqc||this.yqc&&!this.yqc.Bq)this.Yla={},this.yqc=z.a.instance.create(()=>{this.dNf();this.fYc=this.Bub()},0,A.a.oHj,!0,!0);this.YCd(oa,ea,R)}}}getTableStyleIndexFromName(ea){if(!ea||k.a.isEmpty(this.FI))return-1;if(ea in this.FI)return this.FI[ea].Index;this.Y3a("getTableStyleIndexFromName");return-1}Upd(){return!!this.lL}Wub(ea){this.IN||this.JXc();return ea in this.IN?this.IN[ea]:-1}Y3a(ea){if(this.$.isEditMode){var R=
new Date;if(30<I.getElapsedSeconds(this.lastSyncTime,R)||k.a.isEmpty(this.FI)||this.XLb){let oa=this.$.oa.va.Sb();this.lastSyncTime=R;ea=this.XLb&&"accessibilityTab"===ea||"galleryMenuClosed"===ea;x.m(this.$.oa.va,ea,this.xLi,this.ixf,null,ea?"accessibility":"normal",oa)}}}dispose(){this.IN=this.BSa=this.lL=this.FI=null;this.$.Ka.NHb(this.PCf);super.dispose()}hGg(ea){this.addHandler("RefreshTableStyleGallery",ea)}Tbj(ea){this.removeHandler("RefreshTableStyleGallery",ea)}JXc(){const ea={};this.tableManager.Jg&&
(this.ida=this.getTableStyleIndexFromName(this.tableManager.Jg.qyc));for(let R=1;7>=R;R++)ea["preview"+R]=this.TQh(R);this.IN=ea}TQh(ea){var R=this.lL.TableStyleItems.length;R=4>=this.ida?this.ida+ea-1:4<this.ida&&this.ida<R-4?4===ea?this.ida:Math.floor(this.ida+ea-4):this.ida+ea-1;-1===R||R.toString()in this.BSa||(R=ea-3);return R}jcg(){if(this.tableManager.Jg){let ea=!1;const R=this.getTableStyleIndexFromName(this.tableManager.Jg.qyc);if(R!==this.ida){if(this.IN){const oa=this.IN;for(let pa in oa)oa[pa]===
R&&(ea=!0)}this.ida=R;ea||k.a.isEmpty(this.BSa)||this.JXc()}}}I1(ea,R,oa){const pa=this.Sa.zc();pa.Lp="Thin";pa.title=D.a.instance.ga(oa);pa.buttons.push(R);ea.nc.push(pa)}Bub(){const ea=this.tableManager.Jg;return this.T5a||!ea?new V(!0,!1,!1,!1,!0,!1):new V(B.d(ea),B.g(ea),B.c(ea),B.e(ea),B.f(ea),B.b(ea))}dNf(ea=!1){const R={},oa={},pa=this.Bub();if(!k.a.isEmpty(this.FI)&&(this.tableManager.Jg&&this.jcg(),!pa.equals(this.fYc)||ea||k.a.isEmpty(this.BSa))){this.rHa=L.PRh(this.rHa);ea=this.FI;for(var Pa in ea){const Z=
ea[Pa],Ra=L.Ivb(Z,this.rHa);R[Z.Index.toString()]=L.y3a(L.zsa(L.L2b(Z,pa)),Ra);oa[Ra]=R[Z.Index.toString()];this.cHb(oa)}Pa=L.Ivb(null,this.rHa,"-1");R["-1"]=L.y3a(L.zsa(L.L2b(null,pa)),Pa);oa[Pa]=R["-1"];this.cHb(oa);F.c(this.BSa,R,!1)}}wmi(){const ea=u.a(this.$);return ea?ea.Vl.Tz===r.a.Yya:!1}YCd(ea,R,oa){Number.parseInvariant(oa);"-1"===oa&&H.a.contains(R.ParentMenuId,"FormatAsTable",!0)||this.NGf(R,oa,ea,!1)}NGf(ea,R,oa,pa){const Pa=L.Ivb(null,this.rHa,R);L.Dgf(ea)?(Pa in this.Yla?oa=this.Yla[Pa]:
(oa=L.zsa(L.L2b(this.Efd(R),oa)),this.Yla[Pa]=oa),ea[l.a.GalleryButtonProps]=Object(f.a)(new m.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:Pa,Alt:ea[l.a.Alt],MenuItemId:R,TableCellStyles:oa,TableStyles:this.y_i})):(ea[v.a.Icon]=Pa,ea[l.a.GalleryButtonProps]=Object(f.a)(new n.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:Pa,Alt:ea[l.a.Alt],MenuItemId:R}),pa||(pa=[],this.Efd(R),"-1"===R||H.a.contains(ea.ParentMenuId,"FormatAsTable",!0)||(pa=L.L2b(this.lL.TableStyleItems[Number.parseInvariant(R)],
oa)),this.BSa[R]=L.y3a(L.zsa(pa),Pa)))}cHb(ea){if(this.Jzb)this.Etc=()=>{this.cHb(ea)};else{this.Etc=null;var R=[];for(let pa in ea){var oa=pa;oa in this.dHb?R.push(oa):this.dHb[oa]=!0}try{0<R.length&&appChrome.api.unregisterIcons(R),k.a.isEmpty(ea)||appChrome.api.registerIconProvider(()=>ea)}catch(pa){}}}Efd(ea){ea=Number.parseInvariant(ea);if(-1===ea||!this.lL)return null;if(60<ea)for(let R=60;R<this.lL.TableStyleItems.length;++R){const oa=this.lL.TableStyleItems[R];if(oa.Index===ea)return oa}return this.lL.TableStyleItems[ea]}}
Object(t.a)(da,"TableStyleManager",w.a,[261,2]);var qa=a(55);a.d(C,"a",function(){return O});class O extends c.a{constructor(ea){super();this.tableStyleManager=null;this.$=ea;this.Fb()}create(){const ea=b.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb),R=b.GetServiceTaskFactory.Ra(this.$.da,66,134,this.hb);d.TaskExtensions.Aa(qa.Task.zL(ea,R),()=>{this.qb(this.tableStyleManager||(this.tableStyleManager=new da(this.$,ea.result,R.result)))},this.$.la,8)}}Object(t.a)(O,"TableStyleManagerFactory",
c.a,[])},1224:function(t,C,a){t=a(0);var c=a(221),b=a(15),d=a(163),f=a(245),e=a(370),k=a(4),l=a(641),m=a(88),v=a(93),n=a(258),w=a(160),r=a(74),u=a(416),y=a(50),x=a(37),B=a(90),z=a(71),A=a(1),I=a(571),F=a(21);class U extends v.a{constructor(T,K){super(T);this.zS=[];this.h9d=null;this.yIb=L=>{let V="forward";L.Values[e.a.direction]?V=L.Values[e.a.direction].toLowerCase():b.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");L=0;let W=!0;"backward"===V?(L=this.drd.length-1,W=!1):
"forward"===V?(L=0,W=!0):b.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${V}`);this.cqf(W,L,!1)};this.jyf=()=>{this.zS=[]};this.hOa=L=>{-411645385===this.$.shortcutKeyManager.Xs(L,!0)&&this.xdf()&&(this.$.Ka.Mb(new B.a(-411645385,1,this.$.Mc,6,null),{["event"]:L},L),L.stopPropagation())};this.TMi=L=>{this.zla(L)};this.jb=K;this.fq=F.g(this.jb);this.Gc.ka("keydown",this.TMi);this.Gc.ka("keyup",this.hOa);n.a(K).tGg(this.jyf);r.a(K.ya,27)&&x.TaskExtensions.Aa(y.GetServiceTaskFactory.Ra(K.da,
21,137,1),L=>{L=L.result;L.eo(d.a.D7e);L.Tl(d.a.D7e,this.yIb)},K.la)}get $(){return this.jb}get drd(){this.zS.length||(this.zS=this.fZe());return this.zS}get xka(){return this.h9d}set xka(T){this.h9d=T;this.zS=this.fZe()}dispose(){this.$&&n.a(this.$).gcj(this.jyf);this.jb=null;this.zS.length=0;super.dispose()}n0i(T){this.zla(T)}cqf(T,K,L=!0,V=null){var W=this.EGj(T,K,L,V);if(!W){L=K;var da=T?1:-1,qa=this.drd;do{W=!1;if(r.a(this.$.ya,27)){if(L+=da,L>=qa.length||0>L)W=!0}else L=(L+da+qa.length)%qa.length;
if(W){this.fwi(T,K,V);break}else if(W=this.o7f(T,K,L,!1,V))break}while(L!==K)}}EGj(T,K,L=!0,V=null){let W=null;0<=K&&(W=this.zS[K]);return(null===W||void 0===W?0:W.kf)&&W.hg(T,L)?(V&&z.g(V),b.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${W.$d} into a sub region`),W.lj(),!0):!1}o7f(T,K,L,V,W=null){L=this.zS[L];if(A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){const da=n.a(this.jb).dB(f.a.WIa),qa=n.a(this.jb).dB(f.a.Rvb),O=this.fq.ha.Pa.pZ;
if(L===qa&&O||L===da&&!V&&!O)return!1}if((null===L||void 0===L?0:L.kf)&&L.hg(T,!1)){W&&z.g(W);L.lj();if(T=this.zS[K])T.Nj(),b.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${T.$d} to ${L.$d}`);return!0}return!1}fwi(T,K,L=null){L&&z.g(L);if(K=this.zS[K])K.Nj(),b.ULS.sendTraceTag(537166666,0,50,`Lost focus from section ${K.$d}`);x.TaskExtensions.Aa(y.GetServiceTaskFactory.Ra(this.$.da,21,137,0),V=>{V.result.Fj(d.a.Elb,{[e.a.direction]:T?"forward":"backward"})},this.$.la)}zla(T){var K=
this.$.isEditMode?w.a(this.$):null;if(!this.$.rb.uwa||U.Ohi(K))if(117===T.keyCode&&(T.ctrlKey||z.b(T))){K=this.Y0e(T.target);var L=!T.shiftKey;b.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${K}`);if(A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){var V=n.a(this.jb).dB(f.a.DIb);V=this.zS.indexOf(V);k.AFrameworkApplication.ta.Oa.lw&&this.$.wZ&&-1!==V&&K===V&&1===this.$.hdb&&l.ShyRibbon.xJ(1,0)}else k.AFrameworkApplication.ta.Oa.lw&&
this.$.wZ&&1===K&&1===this.$.hdb&&l.ShyRibbon.xJ(1,0);this.cqf(L,K,!0,T)}else 117!==T.keyCode||U.FQe?-411645385===this.$.shortcutKeyManager.Xs(T)?this.xdf()&&(this.$.Ka.Mb(new B.a(-411645385,1,this.$.Mc,6,null),{["event"]:T},T),T.stopPropagation()):1588554917===this.$.shortcutKeyManager.Xs(T)?0===this.mode?(I.a(this.$)||this.$.Ka.Mb(new B.a(1588554917,1,this.$.Mc,6,null),{["event"]:T},T),T.preventDefault(),T.stopPropagation()):3===this.mode&&(T.preventDefault(),T.stopPropagation()):A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",
!1)&&1058684758===this.$.shortcutKeyManager.Xs(T)?(K=this.Y0e(T.target),V=n.a(this.jb).dB(f.a.DIb),L=n.a(this.jb).dB(f.a.WIa),V=this.zS.indexOf(V),L=this.zS.indexOf(L),k.AFrameworkApplication.ta.Oa.lw&&this.$.wZ&&-1!==V&&K===V&&1===this.$.hdb&&l.ShyRibbon.xJ(1,0),-1!==L&&K!==L&&this.o7f(!0,K,L,!0,T)):this.y1h(T):(T=u.a.fC.notificationBar.A2(m.a.UMh(),!1),T.image=0,u.a.fC.notificationBar.gC(T),U.FQe=!0)}Y0e(T){const K=this.drd;for(let L=0,V=K.length;L<V;++L){const W=K[L];if(W&&W.kh(T))return L}return-1}fZe(){const T=
[];for(let K=0,L=this.xka.length;K<L;K++){const V=n.a(this.$).dB(this.xka[K]);V&&T.push(V)}return T}xdf(){return 0===this.mode||4===this.mode}static Ohi(T){return T?T.inKeytipMode:!1}}U.FQe=!1;Object(t.a)(U,"AccessibilityManager",v.a,[285,2]);var X=a(148),S=a(22),H=a(14);class D extends U{constructor(T){super(document.documentElement,T);this.VB=0;this.fNg=[f.a.kBe,f.a.kxd,f.a.mcc,f.a.mVd,f.a.DIb,f.a.LXc,f.a.Dad,f.a.G3e,f.a.TWc,f.a.xyc,f.a.SBj,f.a.Rvb,f.a.aZc,f.a.WIa,f.a.DPd,f.a.hZc,f.a.F5f,f.a.Zjf,
f.a.oXc];this.MVj=[f.a.mcc,f.a.kfg,f.a.jfg,f.a.lfg];this.O_i=[f.a.mcc,f.a.mIf,f.a.nIf,f.a.qIf];this.bVg=[f.a.ETe,f.a.F3e,f.a.Bad,f.a.zad];this.p_i=[f.a.kBe,f.a.kxd,f.a.LXc,f.a.Dad,f.a.TWc,f.a.xyc,f.a.Rvb,f.a.aZc,f.a.WIa,f.a.DPd,f.a.KHf,f.a.hZc,f.a.oXc];this.z_i=[f.a.Rvb,f.a.KTe];const K=H.a.instance.Xa(253);this.Upj=this.$.shortcutKeyManager.IJa(K);this.mode=0;T.da.Ga(15,this);x.TaskExtensions.Aa(y.GetServiceTaskFactory.Ra(T.da,21,137,1),L=>{L=L.result;L.eo(d.a.Elb);L.Tl(d.a.Elb,this.yIb)},T.la)}get mode(){return this.VB}set mode(T){this.VB=
T;switch(T){case 0:this.xka=this.fNg;break;case 2:this.xka=this.MVj;break;case 3:this.xka=this.O_i;break;case 4:this.xka=this.bVg;break;case 5:this.xka=this.p_i;break;case 6:this.xka=this.z_i;break;default:b.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}zla(T){this.$.Bd&65536&&super.zla(T)}y1h(T){if(S.a.equals(this.Upj,this.$.shortcutKeyManager.udd(T),!1)){const K=X.b(this.$);if(null===K||void 0===K?0:K.kf)z.g(T),K.hg(!0,!1)}}}Object(t.a)(D,"EwaAccessibilityManager",
U,[]);class J extends c.a{constructor(T){super();this.$=T;this.Fb()}create(){this.qb(this.$.da.za(15)||new D(this.$))}static ka(T){T.da.Ga(157,new J(T))}}Object(t.a)(J,"AccessibilityManagerFactory",c.a,[]);var M=a(10);a.d(C,"a",function(){return G});const G=()=>{M.a.Fa(J.ka)}},1225:function(t,C,a){var c=a(10);t=a(0);var b=a(15),d=a(221),f=a(37),e=a(54),k=a(287),l=a(213);class m{}m.dNe="ewa-svg-icon";Object(t.a)(m,"CssClassNames",null,[]);var v=a(50),n=a(12),w=a(310),r=a(196);class u{constructor(B){this.xg=
()=>{this.dkf();this.$.ea.Wn(this.xg)};this.$=B;this.n7f={};this.OTd={};const z=this.NYe("excelInitialAppSprite");z?(this.ole(z),this.$.ea.Fg?this.dkf():B.ea.El(this.xg),this.$.da.Ga(388,this)):b.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.OTd=null;this.$.ea.Wn(this.xg)}bva(B,z,A=null,I=null){let F;(F=this.OTd[B])||(this.OTd[B]=F=this.gWi(this.n7f[B]));if(!F)return b.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${B} was not found in loaded SVG sprites.`),
null;const U=F.cloneNode(!0);if(!U.style){const X=w.b(F),S=w.b(U),H={};H.iconId=B;H.isOriginalNodeStyleNull=void 0===F.style||null===F.style;H.isOriginalNodeCurrentStyleNull=void 0===F.currentStyle||null===F.currentStyle;H.isClonedNodeCurrentStyleNull=void 0===U.currentStyle||null===U.currentStyle;H.originalNode=X.substring(0,X.indexOf(">")+1);H.clonedNode=S.substring(0,S.indexOf(">")+1);b.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(H)}`)}U.setAttribute("style",
`height: ${z}px; width: ${z}px;`);I&&(B=document.createElement("title"),B.innerHTML=I,U.insertBefore(B,U.childNodes[0]));if(A)for(const X of A)Sys.UI.DomElement.addCssClass(U,X);return U}Jaa(B,z,A,I,F=0,U=0,X=null,S=null){F&&U||(U=n.DOMElementExtensions.getBoundingClientRect(I),F=U.height,U=U.width);if(X=this.bva(B,z,X,S))I.appendChild(X),(I=n.DOMElementExtensions.HY(X,"style",null))?X.setAttribute("style",I+` margin: ${(F-z)/2}px ${(U-A)/2}px;`):b.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${B}`);
return X}dkf(){f.TaskExtensions.Aa(v.GetServiceTaskFactory.Ra(this.$.da,283,284,0),B=>{B=r.c(B.result.Zn.loadScript("excel-uiSlice20-sprite"));f.TaskExtensions.Aa(B,()=>{const z=this.NYe("excelUiSlice20Sprite");z?this.ole(z):b.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")},this.$.la,3)},this.$.da.la,3)}ole(B){for(const z of B)z.type===l.a.MTd&&(this.n7f[z.id]=z)}gWi(B){if(!B)return null;const z=B.viewBox;B=B.children;const A=document.createElementNS(k.a.PTd,
l.a.MTd);Sys.UI.DomElement.addCssClass(A,m.dNe);A.setAttribute("focusable","false");A.setAttribute("viewBox",z);this.ACg(A,B);return A}ACg(B,z){for(const I of z){const F=document.createElementNS(k.a.PTd,I.type);for(let U in I){z=U;var A=I[U];"className"===z?F.setAttribute("class",A):F.setAttribute(z,A)}B.appendChild(F)}}NYe(B){return(B=window[B])?B.icons:null}}Object(t.a)(u,"SvgIconProvider",null,[372,2]);class y extends d.a{constructor(B){super();this.$=B;this.Fb()}create(){f.TaskExtensions.Aa(e.a.LQ([130],
4,this.hb,void 0,void 0,void 0,387),()=>{window.excelInitialAppSprite?this.qb(this.$.da.za(388)||new u(this.$)):b.ULS.sendTraceTag(537151258,0,50,"window.[excelInitialAppSprite] returned null.")},this.la,3)}static ka(B){B.da.Ga(387,new y(B))}}Object(t.a)(y,"SvgIconProviderFactory",d.a,[]);a.d(C,"a",function(){return x});const x=()=>{c.a.Fa(y.ka)}},1249:function(t,C,a){var c=a(10);t=a(0);var b=a(221),d=a(21),f=a(1120);class e extends f.a{constructor(m,v){super(m);v.Ga(240,this)}PWh(m){for(const v of this.rangeList)if(m.range.contains(v))return v;
return null}wFd(m){return m.GridBlockModel&&(m=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(m.GridBlockModel))?m.getSparklineRanges():null}}Object(t.a)(e,"SparklineManager",f.a,[352]);class k extends b.a{constructor(m){super();this.sparklineManager=null;this.$=m;this.Fb()}create(){this.qb(this.sparklineManager||(this.sparklineManager=new e(d.g(this.$),this.$.da)))}static ka(m){m.da.Ga(239,new k(m))}}Object(t.a)(k,"SparklineManagerFactory",b.a,[]);a.d(C,"a",function(){return l});const l=
()=>{c.a.Fa(k.ka)}},1270:function(t,C,a){t=a(0);var c=a(142),b=a(596);class d extends b.a{constructor(){super()}dispose(){c.WacAirSpace.pld()&&c.WacAirSpace.bzc()}animate(k,l,m,v,n){l&&c.WacAirSpace.cL(k.element,l);c.WacAirSpace.animate(k,v,n);m&&c.WacAirSpace.m9i(k.element,m)}}Object(t.a)(d,"AnimationManager",b.a,[2]);var f=a(101);a.d(C,"a",function(){return e});const e=()=>{f.a.sl.Ga(141,new d)}},1443:function(t,C,a){a.r(C);t=a(1193);C=a(1157);var c=a(1116),b=a(1117),d=a(1118),f=a(1121);a(1119);
var e=a(1224),k=a(1270),l=a(10),m=a(0),v=a(221),n=a(185),w=a(550),r=a(15),u=a(805),y=a(516),x=a(82),B=a(4),z=a(78),A=a(903);class I extends z.a{constructor(D){super();this.Zrd=null;this.$=D;r.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created")}Ugj(){const D=new n.a,J=y.a.Uq(x.a.instance.Wb("Common.IEventEmitter<Common.IMruResult>")),M=new w.a(()=>J.result);this.Zrd=new w.a(()=>new u.a(M.value,null));if(!this.Zrd)return D;var G=this.Zrd.value.TY("NewAndOpenCoreManager",!1);if(!G||3!==
G.state||!G.Vvd)return G?r.ULS.sendTraceTag(544289226,0,50,`NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: ${G.state}, mruResult MruDocuments is null: ${!G.Vvd}`):r.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;G=G.Vvd;const T=["xlsx","xlsb","xlsm"];for(let L=0;L<G.length;L++){var K=G[L];if(0>Array.indexOf(T,K.extension))continue;const V=`${K.title}.${K.extension}`,W=A.b(K,B.AFrameworkApplication.isRtl);K=K.url;V&&W&&K?D.add({[I.fileName]:V,
[I.friendlyPath]:W,[I.section]:"mru",[I.absoluteUrl]:K}):K||r.ULS.sendTraceTag(537155200,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}return D}dispose(){super.dispose()}}I.fileName="FileName";I.friendlyPath="FriendlyPath";I.section="Section";I.absoluteUrl="AbsoluteUrl";Object(m.a)(I,"NewAndOpenCoreManager",z.a,[716,2]);class F extends v.a{constructor(D){super();this.$=D;this.Fb()}create(){this.qb(this.$.da.za(451)||this.$.da.Ga(451,new I(this.$)))}static ka(D){D.da.Ga(164,
new F(D))}}Object(m.a)(F,"NewAndOpenCoreFactory",v.a,[]);m=a(1150);v=a(1249);z=a(1225);var U=a(1194),X=a(1144),S=a(1142),H=a(1161);a=a(1135);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");Type.registerNamespace("_Ewa");Object(t.a)();Type.registerNamespace("Common.App.AltTextDialog");
Object(C.a)();Object(c.a)();Object(b.a)();Object(d.a)();Object(e.a)();l.a.Fa(F.ka);Object(k.a)();Object(m.a)();Object(v.a)();Object(z.a)();Object(f.a)();Object(U.a)();Object(X.a)();Object(S.a)();Type.registerNamespace("Common.App.SessionExpiration");Object(H.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.acc.js.map/ea8b31a908959c8006f6ee679b697c9e/EwaDSEsNext.acc.js.map