'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[26],{1125:function(t,C,a){a.d(C,"a",function(){return b});var c=a(508);const b=()=>{c.a.Hi(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}")}},
1441:function(t,C,a){a.r(C);var c=a(10);t=a(0);var b=a(691),d=a(15),f=a(819),e=a(8),k=a(77),l=a(182),m=a(369),v=a(34),n=a(55);class w{constructor(pa){this.$=pa}Nc(){return!1}executeCommand(pa,Pa,Z){let Ra=!1;pa=Pa.command;const Ga=v.a(this.$);11!==Pa.Re&&7!==Pa.Re&&6!==Pa.Re&&2!==Pa.Re&&14!==Pa.Re&&15!==Pa.Re&&16!==Pa.Re&&d.ULS.sendTraceTag(537149787,0,15,`ZoomCommandHandler.ExecuteCommand - unsupported zoom origin ${Pa.Re}`);const Ba=6===Pa.Re;switch(Pa.command){case -1365094462:case -1441674458:Ga.vCc(Math.floor(10*
Ga.zoom)/10+.1,Ba);Ra=!0;break;case 1056010365:case 1664364901:Ga.vCc(Math.ceil(10*Ga.zoom)/10-.1,Ba);Ra=!0;break;case 346087880:Ga.vCc(e.a.XZ,Ba);Ra=!0;break;case -1918142559:case 1517993347:k.a.Pc in Z?(Z=parseFloat(Z[k.a.Pc]),Z!==Ga.zoom&&Ga.uCc(Z,1517993347===Pa.command),Ra=!0):d.ULS.shipAssertTag(537149786,0,!1,"ZoomCommandHandler.ExecuteCommand - no MenuItemIdKey");break;case -2096586688:case -581733362:Pa=parseFloat(Z[f.a.Value]);isNaN(Pa)||Ga.uCc(Pa/100,!0);Ra=!0;break;case 1409187195:Ga.zoomFitToScreen();
Ra=!0;break;case -1836771825:Ga.zoomFitToScreenUndo(),Ra=!0}return Ra?n.Task.Ta(!0):l.a(pa)}Cc(pa,Pa){switch(Pa.command){case -1441674458:case 1664364901:case -1918142559:case 346087880:case 1517993347:case -581733362:case 1409187195:case -1836771825:return v.a(this.$).JW();case -1365094462:case 1056010365:case -2096586688:return m.a(this.$);default:return!1}}Rc(){return!1}}Object(t.a)(w,"ZoomCommandHandler",null,[195]);class r extends b.a{constructor(pa){super(pa)}yd(){this.gd([new w(this.$)])}static ka(pa){b.a.Nd(370,
new r(pa))}}Object(t.a)(r,"ZoomCommandHandlerFactory",b.a,[]);C=a(221);var u=a(86),y=a(27),x=a(82),B=a(542),z=a(48),A=a(5),I=a(160),F=a(65),U=a(289),X=a(131),S=a(43),H=a(33),D=a(12),J=a(11),M=a(104),G=a(97),T=a(21),K=a(304),L=a(132);class V{constructor(pa){this.e5a=this.ydc=0;this.M0b=null;this.xcf=!1;this.$=pa;this.xcf=pa.phc}lhi(){return T.g(this.$).eb?(d.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.rb.Zx?(d.ULS.sendTraceTag(537149794,
0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0}RJi(pa){this.M0b=new Sys.UI.Point(Math.round(pa.sua.center.x),Math.round(pa.sua.center.y));this.ydc=v.a(this.$).zoom;this.e5a=pa.sua.scale;let Pa={["InitialZoom"]:this.ydc,["Location"]:"canvas",["InputMethod"]:pa.tb};L.b(this.$).Cd(X.a.lXi,Pa);d.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.M0b.x},${this.M0b.y}), initial zoom ${this.ydc}, initial scale ${this.e5a}`);
this.g8a(pa,"onGestureStart");return!0}QJi(pa){if(!this.e5a)return d.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.g8a(pa,"OnGestureEvent"),!0;if(!isFinite(this.e5a))return d.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.e5a}`),this.g8a(pa,"OnGestureEvent"),!0;const Pa=pa.sua.scale/this.e5a*this.ydc;v.a(this.$).Mgg(Pa,this.M0b);d.ULS.sendTraceTag(537149790,
0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${Pa}. Current scale ${pa.sua.scale}`);this.g8a(pa,"OnGestureEvent");return!0}PJi(pa){v.a(this.$).Ngg();d.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.g8a(pa,"OnGestureEnd")}OJi(pa){d.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.g8a(pa,"OnGestureCancel")}g8a(pa,Pa){var Z,Ra,Ga;this.xcf&&(d.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${Pa},        eventArgs non-null: ${isNullOrUndefined(pa)}, gestureData non-null: ${isNullOrUndefined(null===
pa||void 0===pa?void 0:pa.sua)},        srcEvent non-null: ${isNullOrUndefined(null===(Z=null===pa||void 0===pa?void 0:pa.sua)||void 0===Z?void 0:Z.srcEvent)}`),null===(Ga=null===(Ra=null===pa||void 0===pa?void 0:pa.sua)||void 0===Ra?void 0:Ra.srcEvent)||void 0===Ga?void 0:Ga.preventDefault())}}Object(t.a)(V,"PinchToZoomAdapter",null,[438]);var W=a(38);class da extends W.a{constructor(){super()}rne(pa){this.addHandler("ZCIEK",pa)}vQf(pa){this.removeHandler("ZCIEK",pa)}qne(pa){this.addHandler("ZCUIK",
pa)}uQf(pa){this.removeHandler("ZCUIK",pa)}fHg(pa){this.addHandler("ZCEK",pa)}Jcj(pa){this.removeHandler("ZCEK",pa)}C3i(){this.raiseEvent("ZCIEK")}B3i(){this.raiseEvent("ZCUIK")}D3i(){this.raiseEvent("ZCEK")}}Object(t.a)(da,"ZoomEventManager",W.a,[436]);var qa=a(22);class O extends W.a{constructor(pa){super();this.statusBarManager=null;this.MTe=!1;this.$=pa;this.$.da.Za(29,Pa=>{this.statusBarManager=Pa;Pa.oJ(this)})}qq(pa){this.addHandler("Zoom",pa)}Oq(pa){this.removeHandler("Zoom",pa)}Dz(){this.nn("QueryZoomStatus")&&
this.raiseEvent("Zoom")}Rr(pa,Pa){return"QueryZoomStatus"!==pa?!1:this.H2h(Pa)}nn(){return v.a(this.$).JW()}dispose(){this.statusBarManager&&(this.statusBarManager.PF(this),this.statusBarManager=null);this.$=null;super.dispose()}$2e(pa){pa=this.$Zh(pa);if(!pa)return null;pa=pa.getElementsByClassName("cui-ctl-mediumlabel");return 1!==pa.length?(d.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):pa[0]}H2h(pa){if(!this.$)return!1;const Pa=
v.a(this.$).UOb,Z=this.$2e("HandleQueryZoomStatusCommand");Z?qa.a.equals(pa.LabelText.toString(),Pa,!1)||(Z.innerText="",this.xZf(pa,Pa)):this.xZf(pa,Pa);return!0}xZf(pa,Pa){pa.LabelText=Pa}$Zh(pa){var Pa=D.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!Pa)return Pa=(Pa=this.$.ea.jc)?Pa.inEmbedView:!1,y.a.np||Pa||d.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${pa}`),null;this.MTe||
(this.MTe=!0,d.ULS.sendTraceTag(537149762,0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${pa}`));return Pa}}Object(t.a)(O,"ZoomStatusBarManager",W.a,[2,191,192]);class ea extends B.a{constructor(pa){super(pa);this.zoomEventManager=this.Ywa=this.JAb=null;this.OAb=-1;this.scf=!1;this.Vc=()=>{this.OAb=-1};d.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");this.ufb=new O(pa);this.mXi()&&(d.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),
this.DLg());this.S8i()}dispose(){this.ufb&&(u.a.Ia(this.ufb),this.ufb=null);this.zoomEventManager&&(this.$.da.XT(419),this.zoomEventManager=null);this.scf&&this.Xdh();super.dispose()}JW(){return!0}Mgg(pa,Pa){pa=this.eua(pa);if(T.g(this.$).rtl){const Z=Math.round(D.DOMElementExtensions.getBounds(this.$.Cf).width*v.a(this.$).zoom);this.JAb=new Sys.UI.Point(Z-Pa.x,Pa.y)}else this.JAb=Pa;this.Wza(pa,!1,"ZoomWithPinch")}tCc(){return!0}sCc(pa,Pa){var Z=y.a.isMac?.07:.15;pa=this.zoom+(pa?Z:-Z);pa=this.eua(pa);
T.g(this.$).rtl?(Z=Math.round(D.DOMElementExtensions.getBounds(this.$.Cf).width*v.a(this.$).zoom),this.Ywa=new Sys.UI.Point(Z-Pa.x,Pa.y)):this.Ywa=Pa;Pa=this.zoom;this.Wza(pa,!0,"ZoomWithMouse");Pa={["InitialZoom"]:Pa,["FinalZoom"]:pa,["Location"]:"canvas"};L.b(this.$).Cd(X.a.gYj,Pa)}Ngg(){this.JAb=null}uCc(pa,Pa){this.Wza(this.eua(pa),!1,Pa?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}Ogg(pa){isNaN(pa)?d.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):
this.Wza(this.eua(pa),!1,"ZoomToLevelInExcelLive")}Pgg(pa){this.Wza(this.eua(pa),!1,"ZoomWithActionPen")}vCc(pa,Pa){this.Wza(this.eua(pa),!0,Pa?"ZoomWithShortcuts":"ZoomWithButtons")}U0e(pa,Pa){const Z=T.g(this.$).rtl,[Ra,Ga]=this.yed(Z),[Ba,fa]=this.fgd(pa,Ga);return this.Ywa?(pa=this.fed(this.Ywa,pa,Pa,Ga,Ra,"ZoomWithMouse"),this.Ywa=null,pa):this.JAb?this.fed(this.JAb,pa,Pa,Ga,Ra,"ZoomWithPinch"):T.g(this.$).ha.Pa.pZ?this.fYj(pa,Pa,Ga,Ra,Ba,fa,T.g(this.$).rtl):this.hYj(pa,Pa,Ga,Ra,Ba,fa,T.g(this.$).rtl)}ZVf(pa,
Pa,Z){if(pa){d.ULS.sendTraceTag(537149782,0,50,`Zoom To: (${pa.x} ${pa.y}) (new top-left) from zoom:${Pa} to zoom:${Z}`);pa=new z.a(pa.x,pa.y);Z=T.g(this.$).rtl;[,Z]=this.yed(Z);const [Ra,Ga]=this.fgd(Pa,Z);T.g(this.$).Vne(pa,Ra,Ga,G.a.iqe)}else d.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${Pa} to zoom:${Z}`)}zoomFitToScreen(){const pa=this.zoom;var Pa=T.g(this.$).rtl;const [Z,Ra]=this.yed(Pa),[Ga,Ba]=this.fgd(pa,Ra);var fa=T.g(this.$).ha.Pa.pZ;(Pa=fa?this.ZXe(this.U9a,Ga,Ba,!1):
this.c1e(this.U9a,Ra,Z,Ga,Ba,Pa,!1))?(Pa=Math.min(Ga/(Pa.width+100),Ba/(Pa.height+100)),Pa=this.QAh(Pa),this.Wza(Pa,!0,"ZoomWithFitToScreen"),fa?T.g(this.$).ha.Pa.fsa(T.g(this.$).ha.Pa.$b,!1):(fa=S.v(T.g(this.$).ha.sa.activeRange,this.$),T.g(this.$).Dg(fa,null,null,null,3,G.a.Jgg)),this.OAb=pa,this.scf||this.ALg()):d.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${fa}`)}zoomFitToScreenUndo(){this.Wza(this.OAb,!1,"ZoomWithFitToScreen")}zQd(){return-1!==
this.OAb}ALg(){const pa=T.g(this.$);pa&&(pa.ha.NG(this.Vc),pa.hC(this.Vc))}Xdh(){const pa=T.g(this.$);pa&&(pa.ha.RF(this.Vc),pa.AD(this.Vc))}QAh(pa){pa=Math.min(pa,e.a.Wyi);pa=Math.max(pa,e.a.Pzi);return Math.round(100*pa)/100}Wza(pa,Pa,Z){if(this.qCc()){var Ra=T.g(this.$).view.visibleArea.toString();pa=this.eua(pa);var Ga=F.d(this.$.xa.pa);Ga||(Ga=B.a.srf);T.g(this.$).Gi.T6(5,K.a.pCc,Z);T.g(this.$).Gi.Pka(K.a.pCc,this.$.ea.Ke);d.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${pa} to sheet ${Ga} origin ${Z} prevZoom ${this.zoom}`);
this.stj(Ga,pa);this.zoomEventManager.D3i();this.LLj(Z);this.WLj(Pa);this.OAb=-1;m.b(this.$,Z);pa=T.g(this.$).view.visibleArea.toString();d.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${Ra}, NewGridVisibleArea: ${pa}, IsShyRibbonActive: ${this.$.wZ}`)}}lKh(pa){return(pa=J.HelperMethods.VC(this.$.Cf,this.$.domElement,pa))?pa:new Sys.UI.Point(0,0)}yed(pa){const Pa=this.lKh(pa);pa=this.VOh(Pa,pa);return[Pa,pa]}fgd(pa,Pa){const Z=D.DOMElementExtensions.getBounds(this.$.Cf);
return[Math.round((Z.width-Pa.x)*pa),Math.round((Z.height-Pa.y)*pa)]}VOh(pa,Pa){Pa=J.HelperMethods.VC(T.g(this.$).domElement,this.$.domElement,Pa);return Pa?(pa=new Sys.UI.Point(Math.round(Pa.x-pa.x),Math.round(Pa.y-pa.y)),pa):new Sys.UI.Point(0,0)}hYj(pa,Pa,Z,Ra,Ga,Ba,fa){return(fa=this.c1e(pa,Z,Ra,Ga,Ba,fa))?this.S_e(fa,pa,Pa,Z,Ra,Ga,Ba):null}c1e(pa,Pa,Z,Ra,Ga,Ba,fa=!0){var Y=S.F(T.g(this.$).ha.sa.selectedRanges);if(fa&&(Y=Y.Ge(S.F(T.g(this.$).fbc())),!Y))return d.ULS.sendTraceTag(537149777,0,50,
"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),null;const ja=T.g(this.$).Vb(Y.topLeft);Y=T.g(this.$).Vb(Y.bottomRight);if(!ja||!Y)return d.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;pa=ja.cell.rQ===Y.cell.rQ&&ja.cell.qQ===Y.cell.qQ?this.dJh(pa,Y,Pa,Z,Ra,Ba):this.PYh(pa,ja,Y,Pa,Z,Ra,Ba);return pa?fa?this.CSe(pa,Ra,Ga):pa:(d.ULS.sendTraceTag(537149775,
0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}CSe(pa,Pa,Z){if(0>pa.x||pa.x>Pa)pa.x=0;if(0>pa.y||pa.y>Z)pa.y=0;pa.x+pa.width>Pa&&(pa.width=Pa-pa.x);pa.y+pa.height>Z&&(pa.height=Z-pa.y);return pa}PYh(pa,Pa,Z,Ra,Ga,Ba,fa){Pa=T.g(this.$).getCellBounds(Pa.cell);if(!Pa)return null;const Y=T.g(this.$).getCellBounds(Z.cell);if(!Y)return null;let ja=Ga.x;fa&&(ja=0,Pa.x=Math.round(Ba/pa)-Pa.x-Math.round(Pa.width),Y.x=Math.round(Ba/pa)-Y.x-Math.round(Y.width));pa=new Sys.UI.Bounds(Math.round((Pa.x-
Ra.x)*pa)-ja,Math.round((Pa.y-Ra.y)*pa-Ga.y),Math.round((Y.x+Y.width-Pa.x)*pa),Math.round((Y.y+Y.height-Pa.y)*pa));Z=Z.cell.getRange();d.ULS.sendTraceTag(537149774,0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${Z.top}, b:${Z.bottom}, r:${Z.right}, l:${Z.left}) in bounds (${pa.x}, ${pa.y}, ${pa.width}, ${pa.height})`);return pa}dJh(pa,Pa,Z,Ra,Ga,Ba){const fa=T.g(this.$).getCellBounds(Pa.cell);if(!fa)return null;let Y=Ra.x;Ba&&(Y=0,
fa.x=Math.round(Ga/pa)-fa.x-Math.round(fa.width));pa=new Sys.UI.Bounds(Math.round((fa.x-Z.x)*pa)-Y,Math.round((fa.y-Z.y)*pa-Ra.y),Math.round(fa.width*pa),Math.round(fa.height*pa));Pa=Pa.cell.getRange();d.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${Pa.top}, l:${Pa.left}) in bounds (${pa.x}, ${pa.y}, ${pa.width}, ${pa.height})`);return pa}fYj(pa,Pa,Z,Ra,Ga,Ba){const fa=this.ZXe(pa,Ga,Ba);return fa?this.S_e(fa,pa,Pa,Z,Ra,Ga,Ba):
null}S_e(pa,Pa,Z,Ra,Ga,Ba,fa){pa=new Sys.UI.Point(this.x0e(Ba,pa.x,pa.width),this.x0e(fa,pa.y,pa.height));return this.fed(pa,Pa,Z,Ra,Ga)}x0e(pa,Pa,Z){return pa===Z?(d.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),pa/2):pa*Pa/(pa-Z)}ZXe(pa,Pa,Z,Ra=!0){const Ga=T.g(this.$).ha.Pa.$b.domElement;var Ba=J.HelperMethods.VC(Ga,T.g(this.$).domElement,T.g(this.$).rtl);if(!Ba)return d.ULS.sendTraceTag(537149771,0,50,
"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const fa=T.g(this.$).Mvb();Ba=new Sys.UI.Point(Math.round((Ba.x-fa.topLeft.x)*pa),Math.round((Ba.y-fa.topLeft.y)*pa));pa=new Sys.UI.Bounds(Ba.x,Ba.y,Math.round(Ga.offsetWidth*pa),Math.round(Ga.offsetHeight*pa));return Ra?this.CSe(pa,Pa,Z):pa}Prf(){this.ufb.Dz()}wDi(pa){"ZoomToLevelInExcelLive"===pa?this.zoomEventManager.C3i():this.zoomEventManager.B3i()}S8i(){this.zoomEventManager=this.$.da.Ga(419,new da)}fed(pa,Pa,
Z,Ra,Ga,Ba=""){var fa=T.g(this.$).rtl?0:Ga.x;Ga="ZoomWithPinch"===Ba||"ZoomWithMouse"===Ba?new Sys.UI.Point(pa.x-fa-Math.round(Ra.x*Pa),pa.y-Ga.y-Math.round(Ra.y*Pa)):pa;Ga=new Sys.UI.Point(Math.round(Ga.x/Pa),Math.round(Ga.y/Pa));d.ULS.shipAssertTag(537149770,0,!!Pa,"Original zoom level must be different than 0");fa=Z/Pa;Ga=new Sys.UI.Point(Math.round(Ga.x*(1-1/fa)),Math.round(Ga.y*(1-1/fa)));"ZoomWithMouse"===Ba||"ZoomWithPinch"===Ba?(Ga.x+=Math.round((Ra.x-T.g(this.$).CD)*(fa-1)),Ga.y+=Math.round((Ra.y-
T.g(this.$).BJ)*(fa-1))):(fa=Math.round(Ra.x*(Z-Pa)),0<fa&&Ga.x>fa&&(Ga.x+=fa),Pa=Math.round(Ra.y*(Z-Pa)),0<Pa&&Ga.y>Pa&&(Ga.y+=Pa));"ZoomWithMouse"===Ba&&(pa.x||(Ga.x=0),pa.y||(Ga.y=0));pa=T.g(this.$).Mvb();return new Sys.UI.Point(Ga.x+pa.topLeft.x,Ga.y+pa.topLeft.y)}DLg(){const pa=[];x.a.instance.Wb("Common.IGestureInputManager").execute(Pa=>{0===Pa.tOh()&&Pa.x7i(document.body,new V(this.$),pa)})}mXi(){return this.qCc()&&(y.a.jp&&y.a.wLa(67)||this.$.phc)}stj(pa,Pa){m.a(this.$)?this.setZoomLevel(pa,
Pa,this.f_d,e.a.HHf):this.setZoomLevel(pa,Pa,this.zoomPerSheetId,this.U9a)}setZoomLevel(pa,Pa,Z,Ra){Z.remove(pa);Pa!==Ra&&Z.add(pa,Pa)}LLj(pa){this.m_f();this.$.Tya(U.a.NY("TriggerImmediateZoomOperations"));this.PTj();this.wDi(pa)}PTj(){this.Qki()?this.$.qf():this.ufb.Dz();const pa=this.ufb.$2e("UpdateZoomStatusBar");pa&&(pa.innerText=this.UOb)}Qki(){const pa=I.a(this.$);return pa?pa.Vl.Tz===(H.a.Awa(this.$)?A.a.dqc:this.$.Bb+A.a.ETf):!1}WLj(pa){T.g(this.$).eYj(pa);this.OHg()}OHg(){const pa=M.a(this.$);
if(pa)for(const Pa of T.g(this.$).Ea.cF()){if(!Pa){d.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");continue}if(!Pa.Dk)continue;const Z=Pa.Fi;if(Z)for(let Ra=0;Ra<Z.count;Ra++)if(2===Z.dg(Ra).type){const Ga=pa.vq(Z.dg(Ra).Lg());Ga?(Ga.Wda(!1),d.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):d.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else d.ULS.sendTraceTag(537149769,
0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}}Object(t.a)(ea,"ZoomManager",B.a,[]);var R=a(1);class oa extends C.a{constructor(pa){super();this.$=pa;this.Fb()}create(){const pa=new ea(this.$);this.RTj(pa);R.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")&&this.$.da.Ga(368,pa);this.qb(pa)}RTj(pa){const Pa=v.a(this.$);if(Pa){var Z=Pa.kgd("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");pa.MOd(Z);pa.ytc(Pa.dAc)}else d.ULS.shipAssertTag(537149765,
0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")}static ka(pa){pa.da.Ga(369,new oa(pa))}}Object(t.a)(oa,"ZoomManagerFactory",C.a,[]);a=a(1125);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Zoom");Type.registerNamespace("_Ewa");(()=>{c.a.Fa(pa=>{oa.ka(pa);r.ka(pa)})})();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.zoom.js.map/f1a1b30b6b00db732da6a6e418c86d32/EwaDSEsNext.zoom.js.map