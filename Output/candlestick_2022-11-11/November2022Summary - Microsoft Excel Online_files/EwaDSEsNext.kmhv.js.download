'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1046:function(t,C,a){a.d(C,"a",function(){return b});var c=a(508);const b=()=>{c.a.Hi(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}")}},
1047:function(t,C,a){a.d(C,"a",function(){return k});t=a(0);var c=a(15),b=a(83);C=a(144);var d=a(4),f=a(44),e=a(30);class k extends C.a{constructor(l,m,v,n,w,r,u=null){super();this.ZI=null;this.La=m;this.QW=n;this.Vfa=r;this.nb=l;this.Cs=w;this.We=v;this.yhb=this.nb.qa("SaveToHostWithExtraCharsInFileName");this.Kh=u;this.rc(1,CommonUIStrings.l_SaveButtonLabel)}get ta(){return this.We}VGe(l,m){this.dL(1,!!l&&l!==m);this.ZI=document.getElementById(k.jRe);f.a.addHandler(this.ZI,"change",Object(b.a)(this,
this.$lc,"onFileNameChange"));f.a.addHandler(this.ZI,"input",Object(b.a)(this,this.$lc,"onFileNameChange"));this.ZI.focus()}h8b(l){return this.yhb?(new RegExp("["+this.R6b('\\/:*?"<>|')+"]")).test(l):(new RegExp("["+this.R6b('\\/:*?"<>|#{}%~&')+"]")).test(l)}R6b(l){return l.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}Pgd(){const l=e.a.uq(d.AFrameworkApplication.hm.Zm);this.dL(1,!!this.ZI&&""!==this.ZI.value&&this.ZI.value!==l)}$lc(){this.ZI&&window.setTimeout(()=>{this.Pgd()},0)}g8b(l,m){if(1!==
l)c.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{l=m[k.jRe];m=k.LEf in m?m[k.LEf]:!1;c.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",e.a.sqc(l),m);const v=e.a.t3(d.AFrameworkApplication.fileName);(l=l?l.trim():null)&&""!==l&&""!==v||1===this.ta.state?this.h8b(l)?this.Cs.create().displayError(1,l,m):this.Vfa.una(l+v,m,this.Kh):this.Cs.create().displayError(2,l,m)}}dispose(){this.ZI&&
(f.a.removeHandler(this.ZI,"change",Object(b.a)(this,this.$lc,"onFileNameChange")),f.a.removeHandler(this.ZI,"input",Object(b.a)(this,this.$lc,"onFileNameChange")),this.ZI=null);super.dispose()}}k.jRe="txtFileName";k.LEf="chkOverwrite";Object(t.a)(k,"FileNameDialogBase",C.a,[])},1048:function(t,C,a){a.d(C,"a",function(){return n});t=a(0);var c=a(15),b=a(155),d=a(83),f=a(4),e=a(639),k=a(831),l=a(371),m=a(106),v=a(25);class n{constructor(w,r,u,y){this.NUb=null;this.Uug=w;this.nb=u;this.Bbe=r;this.k$d=
new b.a;this.zh=y}V6a(){return this.nb.qa("SaveToCloudStorageUIIsEnabled")}UUe(){return v.a.saveToCloudStorage}l0b(){l.a.TGd(Object(d.a)(this,this.hVf,"saveToCloudActionDispatcher"));l.a.g7c([new k.a(v.a.saveToCloudStorage,m.a.frame,0)],this.Bbe.F3a())}Gg(){const w=this.Bbe.F3a();w?(w.Z8(()=>{this.k$d.setResult(!0)}),this.l0b()):c.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}uMf(){c.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}hVf(w,
r,u,y,x){return r.contextId!==m.a.frame||w!==this.UUe()?2:this.V6a()?1===u?e.SessionStatusManager.instance.u4a||f.AFrameworkApplication.m4?8:32:2===u?(this.uMf(),x&&x.FileDownloadUrl&&c.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.zh&&(this.NUb=this.zh.Bc("DialogShown","SaveToOneDriveReponseTime")),this.k$d.task.continueWith(()=>{this.NUb&&(this.NUb.stop(),this.NUb=null);this.Uug.start(x)}),32):8:8}}Object(t.a)(n,"SaveToCloudStorageActor",null,[325])},
1049:function(t,C,a){a.d(C,"a",function(){return w});t=a(0);var c=a(15),b=a(83),d=a(1050),f=a(4),e=a(41),k=a(39),l=a(237),m=a(370),v=a(163),n=a(762);class w{constructor(r,u,y,x,B){this.V7=this.zm=this.fCa=null;this.OCa=!1;this.Kh=this.Ufa=null;this.rRc=r;this.ekb=u;this.Cs=y;this.We=x;this.zh=B}yLb(){this.We&&1===this.We.state||(this.zm=this.ekb(),this.zm.message=CommonUIStrings.l_CommentProgressTooltip,this.zm.Rb=5,this.zm.ft=!1,this.zm.lAa(CommonUIStrings.l_DefaultDialogTitle,null,null))}UHa(){this.zm&&
(this.zm.close(),this.zm=null)}KR(){1!==f.AFrameworkApplication.ta.state&&this.Cs().displayError(d.a.default)}zPa(){c.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");k.a.Ve(this.V7,k.a.GW(3),void 0,"UploadToCloudManager.RedirectToFolder")}yPa(r){let u=!1,y=!1;f.AFrameworkApplication.fa&&(u=f.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),y=f.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));c.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",
r,u);if(u&&y){c.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const x={};x[m.a.tPa]="1";x[m.a.documentUrl]=r;f.AFrameworkApplication.GU().execute(B=>{B.Fj(v.a.tta,x)})}else k.a.Ve(r,k.a.GW(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}una(r,u,y=null,x=null){c.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.zh&&(this.Ufa=this.zh.Bc("DialogShown","SaveToOneDriveUploadTime"));this.yLb();this.V7=u;this.fCa=this.rRc.create(r,
y,x);this.Kh=x;this.WP()}WP(){c.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.fCa.execute(Object(b.a)(this,this.jQi,"onSaveToCloudUploadFinished"),Object(b.a)(this,this.iQi,"onSaveToCloudUploadFailed"))}jQi(r){this.UHa();this.OCa=!1;if(r&&r.data&&r.data.Vd){var u;if(({Ut:u}=e.d(r.data.Vd)).returnValue)if(r=u,r.StatusCode!==l.a.FO&&r.StatusCode!==l.a.Sqb)c.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.KR();else{c.ULS.sendTraceTag(6590603,
216,50,"UploadToCloudManager upload success.");try{r.NewDocumentUrl&&""!==r.NewDocumentUrl?this.yPa(r.NewDocumentUrl):this.zPa()}catch(y){c.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",y.toString())}this.CFb()}else c.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:n.a.qeb(r.data.Vd)}),this.KR()}else c.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.KR()}iQi(r){5!==r.data.status&&12!==r.data.status||
this.OCa?(c.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",r.data.status),this.UHa(),this.KR(),this.CFb()):(c.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.OCa=!0,this.WP())}CFb(){this.Ufa&&(this.Ufa.stop(),this.Ufa=null)}}Object(t.a)(w,"UploadToCloudManager",null,[269])},1050:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.default=0;Object(t.a)(c,"SaveToCloudErrorCodes",null,[])},1051:function(t,C,a){a.d(C,"a",
function(){return e});t=a(0);var c=a(15),b=a(83),d=a(1050),f=a(82);class e{constructor(k,l,m,v,n,w){this.Kh=null;this.Ovg=k;this.m1=l;this.wlb=m;this.nb=v;this.APb=n;this.Cs=w}start(k){this.Kh=k;if("SharePointOnlineConsumer"===this.nb.Va("FileSource")){const l=f.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(l){l.start(null,k);return}}this.m1.qLa?(c.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.tTg()):(c.ULS.sendTraceTag(6590560,
216,50,"User is not signed in. We will show sign in dialog."),this.showSignInDialog())}showSignInDialog(){this.Ovg.create().OP()}oj(){this.Cs().displayError(d.a.default)}tTg(){try{c.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let k={["client_id"]:this.nb.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.APb||2===this.APb)k={["client_id"]:this.nb.appSettings.UploadToSkyDriveClientId};WL.init(k);c.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(b.a)(this,this.onSuccess,"onSuccess"),Object(b.a)(this,this.v5,"onFailure"))}catch(k){c.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",k,k.stack),this.oj()}}onSuccess(k){c.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");k&&k.data&&k.data.folders&&this.wlb.una(k.data.folders[0].id,k.data.folders[0].urls.viewInBrowser,null,this.Kh)}v5(k){if(k&&
k.error){if("user_canceled"===k.error.code){c.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}c.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",k.error.code,k.error.message)}else c.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.oj()}}Object(t.a)(e,"SaveToCloudManager",null,[327])},1052:function(t,C,a){a.d(C,"a",function(){return f});t=a(0);var c=a(15),b=a(39),d=a(80);a=a(705);class f extends a.a{constructor(e,
k){super(e,k);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=f.oxa;this.rva=!0}get linkText(){return f.ynf}Ala(e){super.Ala(e);b.a.openWindow(4,d.a.sH(f.xnf))}kD(e){super.kD(e);f.Ztd&&f.Ztd(null)}static initialize(e,k,l,m){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");f.oxa=e;f.ynf=k;f.xnf=l;f.Ztd=m}}f.oxa=null;f.ynf=null;f.xnf=null;f.Ztd=null;Object(t.a)(f,"WacGdprNoticeBusinessBarEntry",
a.a,[])},1053:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.Qlh="ewa-bb";c.Slh="ewa-bb-entry";c.$lh="ewa-bb-react";c.Tlh="ewa-bb-entry-body";c.Zlh="ewa-bb-icon";c.Vlh="ewa-bb-entry-icon";c.Ylh="ewa-bb-entry-title";c.Xlh="ewa-bb-entry-message";c.tLe="ewa-bb-entry-button";c.Wlh="ewa-bb-entry-link";c.Ulh="ewa-bb-entry-close";c.uLe="ewa-bb-entry-button-holder";c.Rlh="ewa-bb-content";Object(t.a)(c,"CssClassNames",null,[])},1054:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);
a=a(705);class c extends a.a{constructor(b,d){super(b,d);this.ev=!0;this.title=c.yoa;this.message=c.woa}get actionButton(){return c.voa}xo(b){super.xo(b);(b=c.xoa)&&b(null)}static initialize(b,d,f,e){c.yoa=b;c.woa=d;c.voa=f;c.xoa=e}}c.yoa=null;c.woa=null;c.voa=null;c.xoa=null;Object(t.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1055:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);a=a(705);class c extends a.a{constructor(b,d){super(b,d);this.ev=!0;this.title=c.yoa;this.message=
c.woa}get actionButton(){return c.voa}xo(b){super.xo(b);(b=c.xoa)&&b(null)}static initialize(b,d,f,e){c.yoa=b;c.woa=d;c.voa=f;c.xoa=e}}c.yoa=null;c.woa=null;c.voa=null;c.xoa=null;Object(t.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1056:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);a=a(705);class c extends a.a{constructor(b,d){super(b,d);this.ev=!0;this.title=c.yoa;this.message=c.woa}get actionButton(){return c.voa}xo(b){super.xo(b);(b=c.xoa)&&b(null)}static initialize(b,
d,f,e){c.yoa=b;c.woa=d;c.voa=f;c.xoa=e}}c.yoa=null;c.woa=null;c.voa=null;c.xoa=null;Object(t.a)(c,"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1057:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);a=a(705);class c extends a.a{constructor(b,d){super(b,d);this.ev=!0;this.title=c.UBb;this.message=c.oxa}get actionButton(){return c.Y7a}xo(b){super.xo(b);c.qxa&&c.qxa(null)}static initialize(b,d,f,e){c.UBb=b;c.oxa=d;c.Y7a=f;c.qxa=e}}c.UBb=null;c.oxa=null;c.Y7a=null;c.qxa=null;Object(t.a)(c,
"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1058:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);a=a(705);class c extends a.a{constructor(b,d){super(b,d);c.Y7a&&c.qxa&&(this.ev=!0);this.title=c.UBb;this.message=c.oxa}get actionButton(){return c.Y7a}xo(b){super.xo(b);c.qxa&&c.qxa(null)}static initialize(b,d,f,e){c.UBb=b;c.oxa=d;c.Y7a=f;c.qxa=e}}c.UBb=null;c.oxa=null;c.Y7a=null;c.qxa=null;Object(t.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1059:function(t,
C,a){a.d(C,"a",function(){return c});var c;"undefined"==typeof c&&(c={});window.MSOJS=c;c.yfb=function(){function b(){return m()&&(B()||3<=(u()?z("version/"):0))}function d(){return 0<=window.navigator.userAgent.indexOf("Windows")}function f(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function e(){ma||(ma=!0,fb=k("Windows Phone"))}function k(Va){Va=(new RegExp(Va+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Sa=-1;return null!=Va&&2<=Va.length&&(Sa=parseFloat(Va[1]),
isNaN(Sa)&&(Sa=-1)),Sa}function l(){return"function"==typeof navigator.msLaunchUri&&!f()&&!x()&&!v()}function m(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function v(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function n(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function w(){return n()?8==window.document.documentMode:!1}function r(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function u(){return 0<=
window.navigator.userAgent.indexOf(" AppleWebKit/")}function y(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function x(){var Va=window.navigator.userAgent.toLowerCase();return 0<=Va.indexOf("android")&&0<=Va.indexOf("chrome")}function B(){return 3<=(r()?z("firefox/"):0)}function z(Va){var Sa=window.navigator.userAgent.toLowerCase(),vb=Sa.indexOf(Va),Oa,yb;return 0<=vb?(Oa=vb+Va.length,yb=Sa.length,parseInt(Sa.substring(Oa,yb))):0}function A(Va,Sa,vb,Oa,yb){if(Oa&&null!=Sa)Sa();
else if(l())navigator.msLaunchUri(Va,Sa,vb);else if(!(y()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&m())||v())F(Va,Sa,vb);else if(y()&&yb)a:{try{window.open(Va,"_self")}catch(Ob){null!=vb&&vb();break a}null!=Sa&&Sa()}else I(Va,Sa,vb)}function I(Va,Sa,vb){var Oa=document.getElementById("OICLinkTag"),yb;null==Oa&&(Oa=document.createElement("a"),Oa.id="OICLinkTag",Oa.style.visibility="hidden",Oa.href="",Oa.target=0==(Wb.Options&
Ua.SupportsTopTargetNavigation)||Wb.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(Oa),null!=Oa.addEventListener&&Oa.addEventListener("click",function(Ob){null!=Ob.stopPropagation&&Ob.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(yb=function(Ob){var Ja=document.createEvent("MouseEvent");return Ja.initMouseEvent(Ob,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),Ja},yb.prototype=Event.prototype,window.MouseEvent=yb),Oa.href=Va,Oa.dispatchEvent(new MouseEvent("click"))}catch(Ob){null!=
vb&&vb();return}null!=Sa&&Sa()}function F(Va,Sa,vb){var Oa=document.getElementById("OICFrame");null==Oa&&(Oa=document.createElement("iframe"),Oa.className="ObjectInDialog",Oa.style.visibility="hidden",Oa.src="about:blank",document.body.appendChild(Oa),Oa.id="OICFrame");try{Oa.contentWindow.location.href=Va}catch(yb){null!=vb&&vb();return}null!=Sa&&Sa()}function U(Va){return 0!=(Va.Options&Ua.SkipProtocolHandler)||w()}function X(Va){return Va===sb.ReadOnly||Va===sb.ReadWrite}function S(Va,Sa,vb,Oa){var yb,
Ob;try{if(yb=new ActiveXObject(Ra),yb)return Ob=yb.ViewDocument3(window.self,Va,Sa,Oa),Ob?(R(na.O14ActiveX),ab.None):ab.Failed}catch(Ja){}if(Ua.O14Only===(vb&Ua.O14Only))return Wb.DescriptiveUnattemptedEnums?ab.O14AttemptFailure:ab.Unattempted;try{if(yb=new ActiveXObject(Ga),yb)return Ob=yb.ViewDocument3(window.self,Va,Sa,Oa),Ob?(R(na.O12ActiveX),ab.None):ab.Failed}catch(Ja){}if(Ua.O12UpOnly===(vb&Ua.O12UpOnly))return Wb.DescriptiveUnattemptedEnums?ab.O12UpOnlyFail:ab.Unattempted;try{if(yb=new ActiveXObject(Ba),
yb)return Ob=X(Sa)?yb.ViewDocument2(window.self,Va,Oa):yb.EditDocument2(window.self,Va,Oa),Ob?(R(na.O11ActiveX),ab.None):ab.Failed}catch(Ja){}return Wb.DescriptiveUnattemptedEnums?ab.ActiveXUnattempted:ab.Unattempted}function H(Va,Sa,vb,Oa,yb){var Ob,Ja,lb;Va==Na.Visio&&vb==sb.ReadWrite&&(vb=sb.WriteOnly);Va=yb;(Oa=Oa||f()&&!(e(),8<=fb))||(Ob="",Ob+=X(vb)?ya+ib:wa,Ob+=sa,Va+=J(Ob));Va+=J(Sa);Wb.NewTelemetryDataIsEnabled&&(Ja=Wb.SessionOrigin?"|or|"+Wb.SessionOrigin:"",Ja+=Wb.ClickTime?"|ct|"+Wb.ClickTime:
"",Ja+=Wb.CorrelationId?"|cid|"+Wb.CorrelationId:"",Va+=J(Ja),Wb.CorrelationIdForWinClient&&(Va+=J(Wb.CorrelationIdForWinClient)));Sa=window.location.href;vb=bb;Oa=Sa.toLowerCase().indexOf("&"+vb+"=");var Pb;vb=-1==Oa?void 0:(lb=Oa+(vb.length+2),Pb=Sa.indexOf("&",lb),-1==Pb)?Sa.substr(lb):Sa.substring(lb,Pb);if(null!=vb&&"undefined"!=typeof vb){lb="";try{lb=decodeURIComponent(vb)}catch(Jb){}0<lb.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(lb)&&(Va+=Ya,Va+=lb)}return Va}
function D(Va,Sa,vb,Oa,yb,Ob){var Ja=qa(Va),lb;return null==Ja?(oa(Wb.DescriptiveUnattemptedEnums?ab.ProtocolHandlerIsNull:ab.Unattempted,Wb.Application),!1):(lb=H(Va,Sa,vb,Oa,Ja),A(lb,M,G,yb,Ob),!0)}function J(Va){if(m()&&y()){var Sa="";try{Sa=decodeURI(Va)}catch(vb){}if(Sa==Va)return encodeURI(Va)}return Va}function M(){R(na.ProtocolHandler)}function G(){Wb.Options|=Ua.SkipProtocolHandler;ea(Wb,Kb,rb)}function T(){null!=cc&&cc(na.RoamingProtocolHandler)}function K(){null!=nc&&nc(ab.ControlNeeded)}
function L(){var Va=document.getElementById(ta),Sa;if(null==Va){if(Sa=fa,m()&&3<=(u()?z("version/"):0)&&V(Y,!0)&&(Sa=Y),!V(Sa,!0))if(m()&&V(aa,!0))Sa=aa;else return null;Va=document.createElement("object");Va.id=ta;Va.type=Sa;Va.style.width="0px";Va.style.height="0px";Va.style.setProperty("visibility","hidden","");document.body.appendChild(Va);Va=document.getElementById(ta)}return Va}function V(Va,Sa){var vb=window.navigator.mimeTypes,Oa;return null==vb?!1:(Oa=vb[Va],Oa)?Sa&&!Oa.enabledPlugin?!1:
!0:!1}function W(Va){try{if(null!=new ActiveXObject(Va))return!0}catch(Sa){}return!1}function da(Va){switch(Va){case Na.OneNote:return ia;default:return""}}function qa(Va){if(Va!=Na.OneNote&&f()&&!(e(),8<=fb))return"office:";switch(Va){case Na.Excel:return"ms-excel:";case Na.OneNote:return"onenote:";case Na.PowerPoint:return"ms-powerpoint:";case Na.Visio:return"ms-visio:";case Na.Word:return"ms-word:";case Na.Project:return"ms-project:";case Na.Publisher:return"ms-publisher:";case Na.Infopath:return"ms-infopath:";
case Na.Access:return"ms-access:";default:return""}}function O(Va){switch(Va){case Na.Excel:return"root\\office15\\excel.exe";case Na.PowerPoint:return"root\\office15\\powerpnt.exe";case Na.Visio:return"root\\office15\\visio.exe";case Na.Word:return"root\\office15\\winword.exe";case Na.Project:return"root\\office15\\winproj.exe";case Na.Publisher:return"root\\office15\\mspub.exe";case Na.Infopath:return"root\\office15\\infopath.exe";case Na.Access:return"root\\office15\\msaccess.exe";default:return null}}
function ea(Va,Sa,vb){if(Wb=Va,Kb=Sa,rb=vb,Va.DocumentUrl){var Oa=vb=Sa=Va.DocumentUrl;try{Oa=decodeURIComponent(Va.DocumentUrl)}catch(Jb){}try{vb=encodeURI(Va.DocumentUrl)}catch(Jb){}Wb.NewTelemetryDataIsEnabled||(Sa=Sa+""+Va.CorrelationIdForWinClient,Oa+=Va.CorrelationIdForWinClient,vb+=Va.CorrelationIdForWinClient);Va.Mode===sb.ReadWrite&&Ua.CheckoutRequired===(Va.Options&Ua.CheckoutRequired)&&(Va.Mode=sb.ForceCheckout);Ua.HostIsEditOnly===(Va.Options&Ua.HostIsEditOnly)&&(Va.Mode=sb.WriteOnly);
if(U(Va)?0:m()&&(Va.Application==Na.OneNote||V(ja,!1)||V(ca,!1))||l()||x()||!(b()||B()||"ActiveXObject"in window&&!f()||y())||15<=pa())D(Va.Application,Va.EncodeUrl?vb:Sa,Va.Mode,Va.Application==Na.OneNote,Va.SilentExternalHandler,Va.NavigateUsingWindowOpen);else{var yb;if(yb=w())a:{var Ob=Va.EncodeUrl?Sa:Oa,Ja=Va.Mode,lb=da(Va.Application);try{yb=(new ActiveXObject(Z)).ViewDocument3(window.self,Ob,Ja,lb);break a}catch(Jb){}yb=!1}if(yb)R(na.O15ActiveX);else{if(b()||B()){var Pb=Va.EncodeUrl?Sa:Oa;
Oa=Va.Mode;yb=da(Va.Application);Ob=L();if(null==Ob)Pb=Wb.DescriptiveUnattemptedEnums?ab.PluginIsNull:ab.Unattempted;else{Ja=!1;try{Ja=Ob.ViewDocument3(window.self,Pb,Oa,yb)}catch(Jb){}if(!Ja)try{Ja=X(Oa)?Ob.ViewDocument2(window.self,Pb,yb):Ob.EditDocument2(window.self,Pb,yb)}catch(Jb){}Pb=Ja?(R(na.NpapiPlugin),ab.None):ab.Failed}}else{try{Pb=new ActiveXObject(xa),null!=Pb&&Pb.SaveSSOCreds()}catch(Jb){}Pb=S(Va.EncodeUrl?Sa:Oa,Va.Mode,Va.Options,da(Va.Application))}if(Pb!=ab.None){if(Oa=Va.CouldUseRoamingApps)Ea||
(Ea=!0,ua=k("Windows NT")),Oa=6.1<=ua&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(n()||B()||y());if(Oa&&Va.Application!=Na.OneNote){if(!c.yfb.pYj()){oa(ab.ControlNeeded,Wb.Application);return}if(Va.RoamingAppsLauncher){"undefined"==typeof Va.RoamingAppsLauncher||null==Va.RoamingAppsLauncher?oa(Wb.DescriptiveUnattemptedEnums?ab.RoamingLauncherIsNull:ab.Unattempted,Wb.Application):"undefined"==typeof Va.RoamingBitsUrl||null==Va.RoamingBitsUrl?c.yfb.AYj(Va.DocumentUrl,Va.RoamingAppsLauncher,
Va.Application,Va.ApplicationParameters,Kb,rb):c.yfb.Eig(Va.DocumentUrl,Va.RoamingAppsLauncher,Va.RoamingApplicationExe,Va.ApplicationParameters,Va.RoamingPlatform,Va.RoamingBitsUrl,Kb,rb);return}if(!Va.ContinueIfLauncherIsNull){oa(ab.LauncherNeeded,Wb.Application);return}}Ua.NoProtocolHandlerFallback==(Va.Options&Ua.NoProtocolHandlerFallback)||U(Va)||n()||m()&&!(Wb.DescriptiveUnattemptedEnums?Pb>=ab.O14Unattempted&&Pb<=ab.DocumentUrlIsNull:Pb==ab.Unattempted)?oa(Pb,Wb.Application):D(Va.Application,
Va.EncodeUrl?vb:Sa,Va.Mode,Va.Application==Na.OneNote,Va.SilentExternalHandler,Va.NavigateUsingWindowOpen)}}}}else oa(Wb.DescriptiveUnattemptedEnums?ab.DocumentUrlIsNull:ab.Unattempted,Wb.Application)}function R(Va){null!=Kb&&Kb(Va)}function oa(Va,Sa){"undefined"==typeof Sa&&(Sa=null);null!=rb&&rb(Va,Sa)}function pa(){var Va=0;if(b()||B()||y()){var Sa=L();try{null!=Sa&&(Va=Sa.GetOfficeVersion())}catch(vb){}}else W(Z)?Va=15:W(Ra)?Va=14:W(Ga)?Va=12:W(Ba)&&(Va=11);return Va}function Pa(){return m()&&
(V(fa,!0)||V(Y,!0))}var Z="SharePoint.OpenDocuments.5",Ra="SharePoint.OpenDocuments.4",Ga="SharePoint.OpenDocuments.3",Ba="SharePoint.OpenDocuments.2",fa="application/x-sharepoint",Y="application/x-sharepoint-webkit",ja="application/x-sharepoint-protocolhandler",ca="application/x-sharepoint-webkit-protocolhandler",aa="application/officelive",ta="npSharePointPlugin",xa="IDBHO.IDBHOCtrl",ia="OneNote.Notebook",ya="ofv|",ib="ofc|",wa="ofe|",sa="u|",Ya="|f|",bb="wdlor",mb="",Ca="",$a="",Kb,rb,cc,nc,Wb,
Ea,ua,ma,fb,sb={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Ua={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},ab={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},
na={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Na={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:sb,OpenDocumentOptions:Ua,OpenDocumentFailureType:ab,OpenDocumentControl:na,OfficeApplication:Na,EditDocumentInClient:ea,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=
0;this.Application=Na.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:pa,
IsO14MacPluginInstalled:Pa,OfferOfficeInDialog:function(){return d()&&11>=pa()},OfferOfficeNoIntrusive:function(){return d()&&15>pa()},OfferMacOffice:function(){return m()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!Pa()},InstallRoamingControl:function(){r()?window.InstallTrigger.install({Office:{URL:Ca}}):F($a,null,null)},CanUseRoamingControl:function(){var Va,Sa,vb;if(l())return!0;if(y())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];
if(r())return Va=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(Va),Sa=document.createEvent("Events"),Sa.initEvent("RoamingOfficeInstalled",!0,!1),Va.dispatchEvent(Sa),!!Va.getAttribute("installed");if(n())try{return vb=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),vb.HrExists()}catch(Oa){}return!1},InitUrls:function(Va,Sa,vb){mb=Va;Ca=vb;$a=Sa},LaunchRoamingApps:function(Va,Sa,vb,Oa,yb,Ob){c.yfb.Eig(Va,Sa,O(vb),Oa,"x86",mb,yb,Ob)},LaunchRoamingApps2:function(Va,
Sa,vb,Oa,yb,Ob,Ja,lb){var Pb="",Jb;if(null!=Oa&&(Pb+=" "+Oa),null!=Va&&(Pb+=' "'+Va+'"'),l()||y())cc=Ja,nc=lb,Ja='office: "'+(Ob+'" "')+(vb+'" "ROAMING"'),Ja+=' "'+Sa+'"',Ja+=' "'+yb+'"',Ja+=" "+Pb,A(Ja,T,K,!1,!1);else if(r())Va=document.createElement("RoamingExtensionElement"),Va.setAttribute("cabUrl",Ob),Va.setAttribute("app",vb),Va.setAttribute("licensingEntitlements",Sa),Va.setAttribute("platform",yb),Va.setAttribute("args",Pb),document.documentElement.appendChild(Va),Sa=document.createEvent("Events"),
Sa.initEvent("RoamingOfficeLaunch",!0,!1),Va.dispatchEvent(Sa),null!=Ja&&Ja(na.RoamingFFExtension);else if(n()){if(Jb=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Jb)try{Jb.HrConfigureSingle(Ob,vb,Sa,yb,Pb),null!=Ja&&Ja(na.RoamingActiveX)}catch(Lb){}}else null!=lb&&lb(ab.Failed)},ShouldShowDialog:function(){return!f()},NavigateToUrlUsingClickingOnATag:I,OpenDocumentWithProtocolHandler:D,OpenDocumentWithProtocolHandlerNoCallBack:function(Va,Sa,vb,Oa){var yb=qa(Va),Ob;return null==
yb?(oa(Wb.DescriptiveUnattemptedEnums?ab.ProtocolHandlerNoCallbackIsNull:ab.Unattempted,Wb.Application),!1):(Ob=H(Va,Sa,vb,Oa,yb),A(Ob,null,null,!1,!1),!0)}}}();c.ClientUtils=c.yfb},1060:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);var c=a(39);class b{constructor(d,f){this._url=d;this.Rsg=f}rre(){}M5c(){this.Rsg?c.a.downloadFile(this._url):c.a.Ve(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(t.a)(b,"OpenUrlInTabDialogDownloadBehavior",null,
[294,2])},1061:function(t,C,a){a.d(C,"a",function(){return b});var c=a(508);const b=()=>{c.a.Hi('.HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type="text"]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type="radio"]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type="radio"]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}')}},
1062:function(t,C,a){a.d(C,"a",function(){return e});t=a(0);var c=a(1188),b=a(4),d=a(53),f=a(82);class e{constructor(k,l,m,v,n,w){this.lX=k;this.mX=l;this.EIc=m;this.RD=v;this.SQb=n;this.jUa=w}get Q2f(){return!this.mX&&!this.EIc}get qsf(){return 2===this.jUa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get UKe(){return CommonUIStrings.l_OICErrorMessageNoOffice}get h8e(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get wva(){return CommonUIStrings.l_OICErrorHelpLink}get K6e(){return"OICFailure"}get icon(){return 3}get RWb(){return 2===
this.jUa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get Gl(){return CommonUIStrings.l_DefaultDialogTitle}r4i(k){this.Msf(k)}$qi(k){this.Msf(k)}Msf(k){let l=10;1===k?(f.a.instance.resolve("Common.IOfficeTrialExperience").pic(this.jUa),l=3):2===k&&((!this.EIc||this.EIc(this.RD))&&this.mX&&c.a.instance.B7g(this.mX,this.lX,this.RD),l=5);(0===k||1===k)&&this.lX&&this.lX(this.RD);b.AFrameworkApplication.isc(d.a.mEf,this.SQb,l);this.dispose()}dispose(){this.RD=
this.mX=this.lX=null}}Object(t.a)(e,"AOICErrorDialogWithTrial",null,[2])},1063:function(t,C,a){a.d(C,"a",function(){return e});t=a(0);var c=a(1349),b=a(4),d=a(41),f=a(80);class e{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}QMd(){return d.c([this.daa(),this])}execute(k,l,m){let v="RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(v=f.a.Dl(v,"wdEnableRoaming","1"));b.AFrameworkApplication.vd.Bm(v,2,this.QMd(),
{"Content-Type":"application/json; charset=utf-8"},!1,this.uvb(),k,l,m,void 0,void 0,void 0,void 0,"6")}}Object(t.a)(e,"ARoamingAppsRequest",null,[])},1064:function(t,C,a){a.d(C,"a",function(){return b});var c=a(508);const b=()=>{c.a.Hi(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}")}},
1065:function(t,C,a){a.d(C,"a",function(){return b});var c=a(508);const b=()=>{c.a.Hi('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}')}},
1066:function(t,C,a){a.d(C,"a",function(){return b});var c=a(508);const b=()=>{c.a.Hi(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}")}},1072:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);var c=a(15);class b{constructor(d){this.isEnabled=Boolean.parse(d.DirectPrintIsEnabled||"false");Boolean.parse(d.DirectPrintProbeIsEnabled||"false");this.Whi=Boolean.parse(d.DirectPrintEnabledForInternetExplorer||"false");this.xSa=(d.DirectPrintSupportedMimeTypes||
"").split(b.q5c);this.ySa=(d.DirectPrintSupportedPlugins||"").split(b.q5c);this.s7h=(d.DirectPrintImmersivePreviewPlugins||"").split(b.q5c);this.Sbf=Boolean.parse(d.DirectPrintEnabledForEdge||"false");this.Mei=Boolean.parse(d.ChromePrintLayoutFixIsEnabled||"false");this.PWg=parseInt(d.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Bvd=14;this.Fpf=14394;if(d=d.DirectPrintMinimalSupportedEdgeVersion){const f=d.split(".");2===f.length?(this.Bvd=parseInt(f[0]),this.Fpf=parseInt(f[1])):c.ULS.sendTraceTag(20734112,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",d)}else c.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}b.q5c=",";Object(t.a)(b,"DirectPrintBrsSettings",null,[])},1073:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(){this.isExportPdfMode=this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=
this.logger=this.printPreviewPaneCallbacks=this.backActionButtonText=null}}Object(t.a)(c,"PrintPreviewPaneProps",null,[])},1074:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.H_i="PrintDialogBody";c.printDialogTitle="PrintDialogTitle";c.$6b="ewa-dlg-elements-container-rtl";c.I_i="PrintDialogLeftContainer";c.J_i="PrintDialogRightContainer";c.N$a="PrintDialogRadioButtonContainer";c.pIf="PrintRadioButtonElementInnerDiv";c.P_i="PrintRadioButtonElementOuterDiv";c.O$a="PrintDialogTitleSection";
c.iEd="PrintDialogComboBoxContainer";c.Q_i="PrintRadioButtonIcon";c.G_i="PrintButtonArea";c.Cw="PrintPreviewerContainer";Object(t.a)(c,"CssClassNames",null,[])},1136:function(t,C,a){var c=a(10),b=a(0),d=a(15),f=a(4),e=a(1332),k=a(691),l=a(50),m=a(37),v=a(1),n=a(898),w=a(65),r=a(43),u=a(182),y=a(14),x=a(21),B=a(369),z=a(571),A=a(27),I=a(865),F=a(12);class U extends I.a{constructor(Rb,Dc,nd,od,wd,Pc=!1){super(Rb,Dc,nd,Pc);this.Yv=null;this.Nm=od;this.kQb=wd}get Jd(){return this.kQb}setFocus(){this.Yv.checked?
F.DOMElementExtensions.setFocus(this.Yv):F.DOMElementExtensions.setFocus(this.getButton(0).get_element())}}U.d4b="printCurrentSelection";Object(b.a)(U,"BasePrintDialog",I.a,[]);var X=a(117),S=a(5),H=a(208),D=a(121),J=a(11),M=a(231),G=a(61);const T=(Rb,Dc,nd,od,wd,Pc,Hb=null)=>{Hb=Rb.Na(1,Hb);Hb.printOptions=Dc;return G.g(Rb,"ValidatePrint",Hb,nd,od,wd,Pc,0)},K=(Rb,Dc,nd,od,wd,Pc,Hb,Nc=null)=>{Nc=Rb.Na(9,Nc);Nc.sheetName=Dc;Nc.printSettings=nd;return G.g(Rb,"SetSheetPrintSettings",Nc,od,wd,Pc,Hb,0)},
L=(Rb,Dc,nd,od,wd,Pc,Hb=null)=>{Hb=Rb.Na(1,Hb);Hb.ConvertInParameters=Dc;return G.g(Rb,"ConvertWorkbookToPrintPdf",Hb,nd,od,wd,Pc,4)},V=(Rb,Dc,nd,od,wd,Pc,Hb,Nc=null)=>{Nc=Rb.Na(1,Nc);Nc.sheetName=Dc;Nc.printOptions=nd;return G.g(Rb,"SetPrintOptions",Nc,od,wd,Pc,Hb,0)},W=(Rb,Dc,nd,od,wd,Pc,Hb,Nc=null)=>{Nc=Rb.Na(1,Nc);Nc.sheetName=Dc;Nc.locale=nd;return G.g(Rb,"GetPrintSettings",Nc,od,wd,Pc,Hb,4)},da=(Rb,Dc,nd,od,wd,Pc,Hb,Nc=null)=>{Nc=Rb.Na(1,Nc);Nc.selectedRanges=Dc;Nc.addToPrintArea=nd;return G.g(Rb,
"SetPrintArea",Nc,od,wd,Pc,Hb,0)},qa=(Rb,Dc,nd,od,wd,Pc,Hb=null)=>{Hb=Rb.Na(1,Hb);Hb.sheetName=Dc;return G.g(Rb,"ClearPrintArea",Hb,nd,od,wd,Pc,0)},O=(Rb,Dc,nd,od,wd,Pc,Hb=null)=>{Hb=Rb.Na(9,Hb);Hb.sheetCell=Dc;return G.g(Rb,"InsertPageBreak",Hb,nd,od,wd,Pc,0)},ea=(Rb,Dc,nd,od,wd,Pc,Hb=null)=>{Hb=Rb.Na(9,Hb);Hb.sheetCell=Dc;return G.g(Rb,"RemovePageBreak",Hb,nd,od,wd,Pc,0)},R=(Rb,Dc,nd,od,wd,Pc,Hb=null)=>{Hb=Rb.Na(9,Hb);Hb.sheetName=Dc;return G.g(Rb,"ResetAllPageBreaks",Hb,nd,od,wd,Pc,0)};class oa extends U{constructor(Rb,
Dc,nd,od,wd){super(Rb,Dc,nd,od,wd);this.xsb=null}get oc(){return"HtmlPrintDialog"}initialize(){d.ULS.sendTraceTag(537154316,0,50,"HtmlPrintDialog:Initialize - Preparing dialog for HTML Legacy print");this.f$h();this.rmb(1220);this.addButton(1);super.initialize()}Kga(){return(Rb,Dc,nd)=>T(this.$.oa.va,this.Nm,this.Pia(Rb),this.baa(Dc),nd,this.Jd)}commit(){this.m_g();return!0}dy(Rb,Dc,nd){var od;const wd=Rb.Result;if(wd&&Dc){let Pc=0,Hb=0;(null===(od=wd.SelectedRanges)||void 0===od?0:od.Ranges)&&0<
wd.SelectedRanges.Ranges.length&&wd.SelectedRanges.Ranges[0]&&(Pc=Math.min(oa.I0f(wd.SelectedRanges.Ranges[0]),65535));wd.UsedRange&&(Hb=Math.min(oa.I0f(r.j(r.D(wd.UsedRange))),65535));M.h(Dc,Pc);M.i(Dc,Hb)}this.Nm=wd;super.dy(Rb,Dc,nd)}setFocus(){this.xsb.checked?F.DOMElementExtensions.setFocus(this.xsb):super.setFocus()}f$h(){this.Lb.innerHTML=oa.LZi(this.$.ea.isNamedObjectViewMode);this.Yv=F.DOMElementExtensions.getElementById(this.Lb,U.d4b);this.xsb=F.DOMElementExtensions.getElementById(this.Lb,
"printEntireItem");0!==this.Nm.Type&&this.Nm.UseSelection?(this.Yv.checked=!0,this.xsb.disabled=!this.Nm.SheetName):(this.xsb.checked=!0,this.Yv.disabled=0===this.Nm.Type||!x.g(this.$).ha.sa.wg)}m_g(){d.ULS.sendTraceTag(51499290,0,50,"HtmlPrintDialog:CommitWithGenerateHtml - CommitWithGenerateHtml called");const Rb=new Sys.StringBuilder;this.tFh(Rb);J.HelperMethods.Ve(Rb.toString(),"",`location=0,scrollbars=1,resizable=1,menubar=1,toolbar=${A.a.Tf?0:1},status=0`,"PrintDialog.PrintViewUrl")||d.ULS.sendTraceTag(51499291,
0,10,"HtmlPrintDialog:CommitWithGenerateHtml - A browser blocked the xlprintview.aspx page!")}tFh(Rb){const Dc=this.$.ya;Rb.append(this.$.nda+Dc.LayoutsRelativeUri+"/xlprintview.aspx?");H.a.Zg(Rb,S.a.l1i,this.Nm.SessionId);H.a.Zg(Rb,S.a.n1i,this.Yv.checked?"1":"0");if(0===this.Nm.Type)H.a.Zg(Rb,S.a.i1i,this.Nm.ObjectId);else{if(!this.Nm.UsedRangeTooBig){var nd=r.D(this.Nm.UsedRange);(nd=r.x(nd,this.Nm.SheetName))&&H.a.Zg(Rb,S.a.o1i,nd)}1===this.Nm.Type?H.a.Zg(Rb,S.a.j1i,this.Nm.ObjectId):(nd=r.B(this.Nm.SelectedRanges.Ranges[0]),
nd=r.x(nd,this.Nm.SheetName),H.a.Zg(Rb,S.a.k1i,nd))}D.a.JYa(Rb,Dc);H.a.Zg(Rb,S.a.m1i,this.Nm.Title)}static LZi(Rb){return String.format("<div class='"+X.a.Mn+"'>{0}</div>\r\n\t<div class='"+X.a.Z6b+"'>\r\n\t\t<input type='radio' id='{1}' name='print' /> <label for='{1}'>{2}</label><br />\r\n\t\t<input type='radio' id='{3}' name='print' /> <label for='{3}'>{4}</label>\r\n\t</div>\r\n</div>",y.a.instance.ga(1221),U.d4b,y.a.instance.ga(1224),"printEntireItem",Rb?y.a.instance.ga(1223):y.a.instance.ga(1222))}static I0f(Rb){return(Rb.LastColumn-
Rb.FirstColumn+1)*(Rb.LastRow-Rb.FirstRow+1)}}Object(b.a)(oa,"HtmlPrintDialog",U,[]);var pa=a(172),Pa=a(552),Z=a(13),Ra=a(8),Ga=a(67),Ba=a(1074),fa=a(764),Y=a(58),ja=a(170),ca=a(290),aa=a(862),ta=a(210),xa=a(724),ia=a(29),ya=a(22),ib=a(280);class wa{constructor(Rb,Dc){this.printSettings=this.sheetName=null;this.sheetName=Rb;this.printSettings=Dc}getSheetName(){return this.sheetName}getPrintSettings(){return this.printSettings}}Object(b.a)(wa,"MacroRecorderSheetPrintSettingsSavedPayload",null,[101]);
var sa=a(151),Ya=a(55);class bb extends U{constructor(Rb,Dc,nd,od,wd,Pc,Hb,Nc){super(Rb,Dc,nd,od,wd,v.EwaSettings.ma(395));this.adc=this.E$=this.vca=null;this.dSd=!1;this.V4a=this.Fza=this.wya=this.x$a=this.Uwa=null;this.$la=this.Oya=1;this.m_=0;this.Y5=1;this.jGb=!1;this.ks=null;this.eJb=this.fJb=0;this.selectedRange=this.Gza=this.xya=null;this.n_=0;this.$8a=()=>{this.n_++;this.Y5=this.jYc();this.Q6c(this.E$.checked?!0:!1);this.P6&&(this.adc.disabled=this.Yv.checked);this.ANd(this.E$.checked?!0:
!1);d.ULS.sendTraceTag(595194762,0,50,`PdfPrintDialog:OnChangeWhatToPrint What to print option changed to ${this.Y5.toString()}`);return!0};this.guf=()=>{this.n_++;this.jGb=this.V4a.checked;d.ULS.sendTraceTag(537154311,0,50,`PdfPrintDialog:OnChangeIgnorePrintArea Setting Ignore print area changed to ${this.jGb.toString()}`)};this.Blc=()=>{this.n_++;this.Oya=this.Eue();d.ULS.sendTraceTag(595079450,0,50,`PdfPrintDialog:OnChangeOrienation orientation option changed to ${this.Oya.toString()}`);return!0};
this.huf=()=>{this.n_++;const Db=this.$la;this.$la=bb.paperSizeOptions[this.wya.selectedIndex];d.ULS.sendTraceTag(595079449,0,50,`PdfPrintDialog:OnChangePaperSize paperSize option changed from ${Db.toString()} to ${this.$la.toString()}`);return!0};this.iuf=()=>{this.n_++;const Db=this.m_;this.m_=bb.scalingOptions[this.Fza.selectedIndex];2===this.m_?(this.fJb=1,this.eJb=0):3===this.m_?(this.fJb=0,this.eJb=1):1===this.m_&&(this.eJb=this.fJb=1);d.ULS.sendTraceTag(595079448,0,50,`PdfPrintDialog:OnChangeScaling scaling option changed from ${Db.toString()} to ${this.m_.toString()}`);
return!0};this.izd=Db=>{let Cc;Db&&Db.data&&Db.data.Vd&&Db.data.responseHeaders&&Db.data.Vd.length?(Db.data.responseHeaders["Content-Type"]&&ya.a.contains(Db.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)?(d.ULS.sendTraceTag(51676164,0,50,"PdfPrintDialog:OnFileHandlerSuccessCallback - pdf converted successfully"),Cc={},this.HDb(Cc,null,null)):(Cc=Y.a.Vh(Db.data.Vd),d.ULS.sendTraceTag(51676165,0,15,`PdfPrintDialog:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: ${Cc.Errors[0].MessageId}`)),
Db=Db.data.state,Db.n8c(Cc,Db.userContext,Db.methodName)):d.ULS.sendTraceTag(51676163,0,10,`PdfPrintDialog:OnFileHandlerSuccessCallback - Invalid Parameter : ${Db?Db.data?Db.data.Vd?Db.data.responseHeaders?Db.data.Vd.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs"}`)};this.hzd=Db=>{var Cc=D.a.lf(Db.data);d.ULS.sendTraceTag(51676166,
0,15,`PdfPrintDialog:OnFileHandlerFailureCallback has failed - Errors: [${ia.a.yc(Cc)}]`);Cc=Db.data.state;Cc.M$(Db,Cc.userContext,Cc.methodName)};this.HDb=Db=>{Db.Errors&&0<Db.Errors.length?d.ULS.sendTraceTag(51499295,0,50,`PdfPrintDialog: Failed to convert workbook. Error message Id: ${Db.Errors[0].MessageId}`):(6===this.Jd.Re&&f.AFrameworkApplication.ta.Ee.Sj(x.g(this.$).KVf),d.ULS.shipAssertTag(537154309,0,!!this.$.xa.pa,"PdfPrintDialog.OnConvertWorkbookToPdfSucceeded: EwaControl.Sheets.ActiveItem should not be null"),
this.$.xa.pa&&this.Jha.q3f(this.fHa()))};this.Jha=Pc;this.activeCell=this.$.pa.activeCell.toString();this.Nm.SelectedRanges&&this.Nm.SelectedRanges.Ranges&&0<this.Nm.SelectedRanges.Ranges.length&&this.Nm.SelectedRanges.Ranges[0]&&(this.selectedRange=r.B(this.Nm.SelectedRanges.Ranges[0]).toString());this.sheetName=Hb;this.GN=Nc;this.UBd={};for(let Db=0,Cc=bb.paperSizeOptions.length;Db<Cc;++Db)this.UBd[bb.paperSizeOptions[Db].toString()]=Db;this.locale=window.navigator.browserLanguage||window.navigator.language||
this.$.ya.UICultureTag;this.P6=v.EwaSettings.isChangeGateEnabled("OfficeVSO:4738349_EnableIgnorePrintAreaSettingInPrintDialog")}get oc(){return"PdfPrintDialog"}initialize(){this.P6&&v.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")&&bb.A6g(this.Lb);this.Pe?this.jAe(1020,null):(this.hn(),this.rmb(1020));super.initialize()}dispose(){this.aOj();super.dispose()}close(Rb){d.ULS.sendTraceTag(591196544,0,50,`PdfPrintDialog.Close: User changed printSettings ${this.n_} times before exiting dialog ${0===
Rb?"with":"without"} printing done`);this.qjj();if(this.ks){const Dc=this.VKh();!this.dSd&&!this.E$.checked&&this.$.isEditMode&&this.Nhd(Dc)&&this.fjj(Dc)}super.close(Rb)}Kga(){return(Rb,Dc,nd)=>W(this.$.oa.va,this.$.xa.pa.name,this.locale,this.Pia(Rb),this.baa(Dc),nd,null)}dy(Rb,Dc,nd){this.ks=Rb.Result;this.fJb=this.ks.ScalingWidth;this.eJb=this.ks.ScalingHeight;this.O$c();this.N9h();super.dy(Rb,Dc,nd)}hn(){d.ULS.sendTraceTag(537154315,0,50,"PdfPrintDialog:InitializeDialogElements - Preparing dialog for Print Pdf");
this.g$h();super.hn()}commit(){this.l_g();return!0}setFocus(){this.Pe?ta.a.Izc(this.vca):this.vca.checked?F.DOMElementExtensions.setFocus(this.vca):super.setFocus()}zai(){switch(this.GN.zu){case 1:this.vca.checked=!0;break;case 0:this.Yv.disabled?this.vca.checked=!0:this.Yv.checked=!0;break;case 2:this.E$.checked=!0;break;default:d.ULS.sendTraceTag(537154314,0,10,`Invalid what to print state ${this.GN.zu}. Resetting to defaults.`),this.GN.zu=1,this.vca.checked=!0}}qjj(){this.GN.zu=this.jYc();this.P6&&
(this.GN.ignorePrintArea=this.V4a.checked)}O$c(){if(100!==this.ks.ScalingPercent||this.ks.FitToPage&&(1<this.ks.ScalingWidth||1<this.ks.ScalingHeight))this.dSd=!0,this.ks.ScalingWidth=bb.P4c,this.ks.ScalingHeight=bb.O4c,this.ks.ScalingPercent=bb.L4b,this.ks.FitToPage=bb.I4c;this.ks.PaperSize.toString()in this.UBd||(this.dSd=!0,this.ks.PaperSize=this.ks.PaperSize===bb.YMg?34:bb.srb)}N9h(){this.Oya=this.ks.IsLandscape?2:1;this.m_=this.ks.FitToPage?1===this.ks.ScalingWidth&&1===this.ks.ScalingHeight?
1:this.ks.ScalingWidth||1!==this.ks.ScalingHeight?2:3:0;this.$la=this.ks.PaperSize;this.Q6c(this.E$.checked?!0:!1);this.ANd(this.E$.checked?!0:!1)}u$h(){this.adc.disabled=this.Yv.checked;this.jGb=this.V4a.checked=this.GN.ignorePrintArea}g9g(Rb){this.Gza=document.createElement("select");this.Gza.style.width=224+Ga.a.df;this.Gza.style.height=32+Ga.a.df;this.Gza.setAttribute(S.a.pE,"scalingElementId");this.Fza=new xa.a(this.Gza,!0);for(let Dc=0,nd=bb.scalingOptions.length;Dc<nd;++Dc){const od=y.a.instance.ga(bb.Pjj[Dc]);
this.Fza.YL(od,bb.scalingOptions[Dc].toString(),!1)}Rb.appendChild(this.Gza)}vDe(Rb){this.xya=document.createElement("select");this.xya.style.width=224+Ga.a.df;this.xya.style.height=32+Ga.a.df;this.xya.setAttribute(S.a.pE,"paperSizeElementId");this.wya=new xa.a(this.xya,!0);for(let Dc=0,nd=bb.paperSizeOptions.length;Dc<nd;++Dc){const od=y.a.instance.ga(bb.sVi[Dc]);this.wya.YL(od,bb.paperSizeOptions[Dc].toString(),!1)}Rb.appendChild(this.xya)}VKh(){const Rb={};Rb.IsLandscape=2===this.Oya;Rb.PaperSize=
this.$la;Rb.ScalingWidth=this.fJb;Rb.ScalingHeight=this.eJb;Rb.ScalingPercent=100;Rb.FitToPage=0===this.m_?!1:!0;return Rb}fHa(){const Rb=new Sys.StringBuilder;Rb.append(aa.a(this.$,"Pdf",!0));this.Jha.qwc()&&H.a.Zg(Rb,Ra.a.deg,"1");H.a.Zg(Rb,Ra.a.aFd,""+this.Y5);H.a.Zg(Rb,Ra.a.HJf,this.$.xa.pa.name);0===this.Y5&&(H.a.Zg(Rb,Ra.a.GJf,this.selectedRange),H.a.Zg(Rb,Ra.a.AJf,this.activeCell));H.a.Zg(Rb,Ra.a.BJf,""+this.Oya);H.a.Zg(Rb,Ra.a.CJf,""+this.$la);H.a.Zg(Rb,Ra.a.FJf,""+this.m_);H.a.Zg(Rb,Ra.a.EJf,
"1");H.a.Zg(Rb,Ra.a.zJf,this.jGb?"1":"0");H.a.Zg(Rb,Ra.a.DJf,"1");d.ULS.sendTraceTag(51499296,0,50,`PdfPrintDialog: Print Pdf Url ${Rb.toString()}`);return Rb.toString()}Lxb(){let Rb=null;d.ULS.sendTraceTag(537154313,0,50,"PdfPrintDialog:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.$.userOperationManager.Ub(new ja.a(223,0,(Dc,nd,od)=>{Dc=new ca.a(Dc,null,nd,od,null,!0,!1,"GetFileCopyFileHandler","");Dc.correlationID=pa.a.create().toString();Rb=Dc;f.AFrameworkApplication.vd.V8(this.fHa(),
1,null,null,bb.b$c,!1,2,this.izd,this.hzd,Rb,void 0,void 0,void 0,12E4);return Ya.Task.Ta(!0)},16),null)}g$h(){d.ULS.sendTraceTag(537154312,0,50,"PdfPrintDialog:InitializeForPrintPdf - Preparing full print pdf dialog");this.KZi(this.Lb);this.Q6c(!0);this.ANd(!0);this.Yv=F.DOMElementExtensions.getElementById(this.Lb,U.d4b);this.vca=F.DOMElementExtensions.getElementById(this.Lb,"printActiveSheet");this.E$=F.DOMElementExtensions.getElementById(this.Lb,"printEntireWorkbook");this.P6&&(this.adc=F.DOMElementExtensions.getElementById(this.Lb,
"ignorePrintAreaCheckboxButtonId"),this.V4a=new fa.a(this.adc));this.Vvc()&&(this.Yv.disabled=!0,this.Nm.SheetName=this.sheetName);this.zai();this.P6&&this.u$h();this.L7i()}Vvc(){return!!this.Nm.ObjectId||!x.g(this.$).ha.sa.wg}L7i(){Pa.a.instance.ra(Z.a.change,this.vca,this.$8a);Pa.a.instance.ra(Z.a.change,this.E$,this.$8a);Pa.a.instance.ra(Z.a.change,this.Yv,this.$8a);Pa.a.instance.ra(Z.a.change,this.Uwa,this.Blc);Pa.a.instance.ra(Z.a.change,this.x$a,this.Blc);Pa.a.instance.ra(Z.a.change,this.xya,
this.huf);Pa.a.instance.ra(Z.a.change,this.Gza,this.iuf);this.P6&&this.V4a.zmb(this.guf)}aOj(){Pa.a.instance.Ba(Z.a.change,this.vca,this.$8a);Pa.a.instance.Ba(Z.a.change,this.E$,this.$8a);Pa.a.instance.Ba(Z.a.change,this.Yv,this.$8a);Pa.a.instance.Ba(Z.a.change,this.Uwa,this.Blc);Pa.a.instance.Ba(Z.a.change,this.x$a,this.Blc);Pa.a.instance.Ba(Z.a.change,this.xya,this.huf);Pa.a.instance.Ba(Z.a.change,this.Gza,this.iuf);this.P6&&this.V4a.Mca(this.guf)}KZi(Rb){Rb.classList.add(Ba.a.H_i);if(!this.Pe){document.getElementById("ewaDialogTitle").classList.add(Ba.a.printDialogTitle);
var Dc=document.getElementById("ewaDialogCloseButtonLink");Dc.style.top=32+Ga.a.df;this.rtl?Dc.style.left=32+Ga.a.df:Dc.style.right=32+Ga.a.df}Dc=bb.az(Ba.a.I_i);Rb.appendChild(Dc);var nd=bb.az(Ba.a.O$a,1228);nd.style.marginBottom=12+Ga.a.df;nd.id="whatToPrintTitleElementId";Dc.appendChild(nd);nd=bb.az(Ba.a.N$a);Dc.appendChild(nd);bb.Lqb(nd,this.rtl,"printActiveSheet",1232,"whatToPrintRbName","PrintWhatExcelActiveSheets_32x32x32","activeSheetRadioButtonInnerLabelElementId","whatToPrintTitleElementId");
Dc.appendChild(document.createElement("BR"));nd=bb.az(Ba.a.N$a);Dc.appendChild(nd);bb.Lqb(nd,this.rtl,"printEntireWorkbook",1225,"whatToPrintRbName","PrintWhatExcelEntireWorkbook_32x32x32","entireWorkbookRadioButtonInnerLabelElementId","whatToPrintTitleElementId");Dc.appendChild(document.createElement("BR"));nd=bb.az(Ba.a.N$a);Dc.appendChild(nd);bb.Lqb(nd,this.rtl,U.d4b,1224,"whatToPrintRbName","PrintWhatExcelSelection_32x32x32","currentSelectionRadioButtonInnerLabelElementId","whatToPrintTitleElementId");
this.P6?(nd=bb.az(Ba.a.O$a,1257),nd.style.marginTop=24+Ga.a.df,nd.id="printAreaElementId",Dc.appendChild(nd),v.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")?(nd.style.marginBottom=12+Ga.a.df,nd=bb.az(X.a.Y7c),nd.id="ignorePrintAreaCheckboxWarpperId",F.DOMElementExtensions.setVisible(nd,!0),Dc.appendChild(nd),Dc=this.getElementById("ignorePrintAreaCheckboxButtonId"),F.DOMElementExtensions.setVisible(Dc,!0),nd.appendChild(Dc),Dc=this.getElementById("ignorePrintAreaCheckboxLabelId"),
F.DOMElementExtensions.setVisible(Dc,!0),nd.appendChild(Dc)):(nd=bb.az(Ba.a.N$a),Dc.appendChild(nd),bb.u4g(nd,this.rtl))):(nd=bb.az(Ba.a.O$a,1230),nd.style.marginTop=24+Ga.a.df,nd.id="paperSizeElementId",Dc.appendChild(nd),nd=bb.az(Ba.a.iEd),this.vDe(nd),Dc.appendChild(nd));Dc=bb.az(Ba.a.J_i);Rb.appendChild(Dc);Rb=bb.az(Ba.a.O$a,1229);Rb.style.marginBottom=12+Ga.a.df;Rb.id="orientationTitleElementId";Dc.appendChild(Rb);Rb=bb.az(Ba.a.N$a);Dc.appendChild(Rb);bb.Lqb(Rb,this.rtl,"portraitRadioButtonId",
1235,"orientationRbName","Portrait_32x32x32","portraitRadioButtonInnerLabelElementId","orientationTitleElementId");Dc.appendChild(document.createElement("BR"));Rb=bb.az(Ba.a.N$a);Dc.appendChild(Rb);bb.Lqb(Rb,this.rtl,"landscapeRadioButtonId",1234,"orientationRbName","Landscape_32x32x32","landscapeRadioButtonInnerLabelElementId","orientationTitleElementId");this.P6&&(Rb=bb.az(Ba.a.O$a,1230),Rb.style.marginTop=12+Ga.a.df,Rb.id="paperSizeElementId",Dc.appendChild(Rb),Rb=bb.az(Ba.a.iEd),this.vDe(Rb),
Dc.appendChild(Rb));Rb=bb.az(Ba.a.O$a,1231);Rb.style.marginTop=(this.P6?10:74)+Ga.a.df;Rb.id="scalingElementId";Dc.appendChild(Rb);Rb=bb.az(Ba.a.iEd);this.g9g(Rb);Dc.appendChild(Rb);this.Pe||document.getElementById("buttonarea").classList.add(Ba.a.G_i);this.Uwa=F.DOMElementExtensions.getElementById(this.Lb,"landscapeRadioButtonId");this.x$a=F.DOMElementExtensions.getElementById(this.Lb,"portraitRadioButtonId")}l_g(){d.ULS.sendTraceTag(51499294,0,50,"PdfPrintDialog:CommitWithConvertPdf - CommitWithConvertPdf called");
this.Y5=this.jYc();2!==this.Y5&&(this.Oya=this.Eue(),this.wya&&(this.$la=bb.paperSizeOptions[this.wya.selectedIndex]),this.Fza&&(this.m_=bb.scalingOptions[this.Fza.selectedIndex]));if(this.$.bwa&&v.EwaSettings.isChangeGateEnabled("OfficeVSO:4445349_DisablePrintLatencyImprovementForCrossDomain")){const Rb=this.$.oa.va.Sb();this.$.userOperationManager.Ub(new ja.a(133,0,(Dc,nd,od)=>{const wd={};wd.WhatToPrint=this.Y5;wd.UseNamedAction=this.Jha.qwc();wd.SelectedSheetName=this.$.xa.pa.name;wd.ActiveCell=
this.activeCell;wd.SelectedRanges=[this.selectedRange];wd.IsPdfDocumentRequired=!1;wd.Orientation=this.Oya;wd.PaperSize=this.$la;wd.Scaling=this.m_;wd.RichValuesEnabled=!0;this.P6&&(wd.IgnorePrintArea=this.jGb);return L(this.$.oa.va,wd,ib.b(this.HDb,Dc),nd,od,Rb)},16),null)}else this.Lxb()}Q6c(Rb){this.x$a.disabled=Rb;this.Uwa.disabled=Rb;this.wya.Yp.disabled=Rb;this.Fza.Yp.disabled=Rb}ANd(Rb){Rb?(this.Uwa.checked=!1,this.x$a.checked=!1,this.wya.selectedIndex=-1,this.Fza.selectedIndex=-1):(2===this.Oya?
this.Uwa.checked=!0:this.x$a.checked=!0,this.wya.selectedIndex=this.UBd[this.$la.toString()],this.Fza.selectedIndex=this.m_)}fjj(Rb){d.ULS.sendTraceTag(537154310,0,50,"PdfPrintDialog:SavePrintSettingsToFile - We should make a set SheetPrintSettings call here to set print Settings.");const Dc=this.$.xa.pa.name,nd=this.$.oa.va.Sb();this.$.userOperationManager.Ub(new ja.a(226,0,(od,wd,Pc)=>K(this.$.oa.va,Dc,Rb,od,wd,Pc,nd),void 0,()=>new wa(Dc,Rb)),null)}Nhd(Rb){return this.ks.IsLandscape!==Rb.IsLandscape||
this.ks.PaperSize!==Rb.PaperSize||this.ks.FitToPage!==Rb.FitToPage||this.ks.ScalingHeight!==Rb.ScalingHeight||this.ks.ScalingWidth!==Rb.ScalingWidth?!0:!1}Eue(){return this.Uwa&&this.Uwa.checked?2:1}jYc(){return this.Yv.checked?0:this.vca.checked?1:this.E$.checked?2:1}static az(Rb=null,Dc=0){const nd=document.createElement("div");Rb&&(nd.className=Rb);0!==Dc&&(nd.innerHTML=y.a.instance.ga(Dc));return nd}static A6g(Rb){var Dc=document.createElement("input");Dc.setAttribute("type","checkbox");Dc.className=
X.a.JLe;Dc.id="ignorePrintAreaCheckboxButtonId";Dc.setAttribute("name","ignorePrintAreaCbName");Dc.style.height=16+Ga.a.df;Dc.style.width=16+Ga.a.df;F.DOMElementExtensions.setVisible(Dc,!1);const nd=y.a.instance.ga(1257),od=y.a.instance.ga(1258);Dc.setAttribute(S.a.Mt,nd+Ga.a.space+od);Rb.appendChild(Dc);Dc=document.createElement("label");Dc.setAttribute("for","ignorePrintAreaCheckboxButtonId");Dc.id="ignorePrintAreaCheckboxLabelId";Dc.innerHTML=od;Dc.setAttribute(S.a.jP,"true");Dc.style.position=
"relative";Dc.style.marginLeft=15+Ga.a.df;F.DOMElementExtensions.setVisible(Dc,!1);Rb.appendChild(Dc)}static u4g(Rb,Dc){const nd=document.createElement("input");nd.setAttribute("type","checkbox");nd.id="ignorePrintAreaCheckboxButtonId";nd.setAttribute("name","ignorePrintAreaCbName");nd.setAttribute(S.a.pE,"printAreaElementId"+Ga.a.space+"ignorePrintAreaCheckboxButtonInnerLabelElementId");nd.style.height=16+Ga.a.df;nd.style.width=16+Ga.a.df;Dc?nd.style.marginRight=0+Ga.a.df:nd.style.marginLeft=0+Ga.a.df;
Rb.appendChild(nd);Dc=document.createElement("label");Dc.setAttribute("for","ignorePrintAreaCheckboxButtonId");Dc.setAttribute(S.a.jP,"true");Dc.style.position="relative";Dc.style.marginLeft=15+Ga.a.df;Rb.appendChild(Dc);Rb=bb.az(Ba.a.pIf,1258);Rb.id="ignorePrintAreaCheckboxButtonInnerLabelElementId";Dc.appendChild(Rb)}static Lqb(Rb,Dc,nd,od,wd,Pc,Hb,Nc){const Db=document.createElement("input");Db.setAttribute("type","radio");Db.id=nd;Db.setAttribute("name",wd);Db.setAttribute(S.a.pE,Nc+Ga.a.space+
Hb);Db.style.height=16+Ga.a.df;Db.style.width=16+Ga.a.df;Dc?Db.style.marginRight=0+Ga.a.df:Db.style.marginLeft=0+Ga.a.df;Rb.appendChild(Db);Dc=document.createElement("label");Dc.setAttribute("for",nd);Dc.style.position="relative";Rb.appendChild(Dc);Rb=sa.createClusteredImage(32,32,Pc,Ba.a.Q_i,!0,y.a.instance.ga(od));od=bb.az(Ba.a.pIf,od);od.id=Hb;od.setAttribute(S.a.jP,"true");Hb=bb.az(Ba.a.P_i);Hb.appendChild(od);Dc.appendChild(Hb);Dc.appendChild(Rb)}}bb.P4c=1;bb.O4c=0;bb.L4b=100;bb.srb=9;bb.I4c=
!0;bb.YMg=13;bb.paperSizeOptions=[1,5,6,7,8,9,11,12,3,20,27,28,34,37,43,14];bb.sVi=[1237,1238,1245,1239,1240,1241,1242,1243,1236,1246,1247,1248,1249,1250,1251,1252];bb.scalingOptions=[0,1,2,3];bb.Pjj=[1253,1254,1255,1256];bb.b$c=["Content-Type"];Object(b.a)(bb,"PdfPrintDialog",U,[]);class mb{constructor(Rb,Dc){this.Y5=0;this.U6d=!1;this.zu=Rb;this.ignorePrintArea=Dc}get zu(){return this.Y5}set zu(Rb){0<=Rb&&2>=Rb?this.Y5=Rb:(d.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),
this.Y5=1)}get ignorePrintArea(){return this.U6d}set ignorePrintArea(Rb){Rb||!Rb?this.U6d=Rb:d.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}Object(b.a)(mb,"PdfPrintDialogBrowserSessionState",null,[]);var Ca=a(7),$a=a(133),Kb=a(98),rb=a(1387);class cc{constructor(Rb,Dc){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=Rb;this.addToPrintArea=Dc}}Object(b.a)(cc,"MacroRecorderPrintAreaSetPayload",null,[101]);var nc=a(513),Wb=a(368),Ea=a(75);class ua{constructor(Rb){this.sharedSheetCell=
null;this.sharedSheetCell=Rb}}Object(b.a)(ua,"MacroRecorderPageBreakInsertedPayload",null,[101]);class ma{constructor(Rb){this.sharedSheetCell=null;this.sharedSheetCell=Rb}}Object(b.a)(ma,"MacroRecorderPageBreakRemovedPayload",null,[101]);class fb{constructor(Rb){this.sheetName=null;this.sheetName=Rb}getSheetName(){return this.sheetName}}Object(b.a)(fb,"MacroRecorderPageBreaksAllResetPayload",null,[101]);class sb{constructor(Rb){this.sheetName=null;this.sheetName=Rb}getSheetName(){return this.sheetName}}
Object(b.a)(sb,"MacroRecorderPrintAreaClearedPayload",null,[101]);var Ua=a(125),ab=a(112),na=a(51),Na=a(186);class Va{constructor(){this.Col=this.Row=null}}Object(b.a)(Va,"PageBreaksInformation",null,[]);class Sa{constructor(){this.Max=this.Min=this.Index=0}}Object(b.a)(Sa,"RowColBreak",null,[]);class vb{constructor(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}}Object(b.a)(vb,"SharedRange",null,[]);var Oa=a(164);class yb{constructor(Rb){this.ribbonCommandInfo=this.UEb=null;this.GLj=
(Dc,nd,od)=>{nd=!!Dc&&!!Dc.RequestTelemetryData;x.g(this.$).Gi&&x.g(this.$).Gi.Pka(this.jKa.na(this.ribbonCommandInfo.command),Dc.StateId,nd?Dc.RequestTelemetryData.EcsOperationDuration:0,nd?Dc.RequestTelemetryData.EcsRequestDuration:0,nd?Dc.RequestTelemetryData.WfeRequestDuration:0);J.HelperMethods.rZ&&this.VVg(od)};this.$=Rb;this.jKa=new Oa.a;this.iva=new Oa.a;this.iva.add(78661008,12);this.iva.add(275604654,13);this.iva.add(-13332329,14);this.iva.add(-837651977,9);this.iva.add(-1778266776,10);
this.iva.add(845325699,11);this.Cod=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1)}executeCommand(Rb,Dc,nd,od,wd=null,Pc=null,Hb=null){this.$Vd();this.ribbonCommandInfo=Dc;this.KDj(Dc.command);Rb=ib.b(wd,this.GLj);d.ULS.sendTraceTag(543794888,0,50,`PrintCommandHandler.ExecuteCommand: ${Dc.command} command execution started`);switch(Dc.command){case 78661008:return this.b5e(Dc,Rb,Pc,Hb,!1);case 275604654:return this.b5e(Dc,Rb,Pc,Hb,!0);case -13332329:return this.b4e(Dc,
Rb,Pc,Hb);case -837651977:return this.S1h(Dc,Rb,Pc,Hb);case -1778266776:return this.P2h(Dc,Rb,Pc,Hb);case 845325699:return this.X4e(Dc,Rb,Pc,Hb)}return u.a(Dc.command)}Cc(Rb,Dc){switch(Dc.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===Rb;case 845325699:case -13332329:return!0}return!1}e_f(Rb,Dc,nd){const od=x.g(this.$);var wd=od.Ea;const Pc=r.r(od.ha.sa.selectedRanges,this.$);if((wd=wd.cF())&&wd.length){for(const Hb of wd){wd=Hb;const Nc=wd.tf;if(!Nc)continue;const Db=
r.j(wd.rf),Cc=[];for(const Xc of Pc.Ranges){if(Xc.FirstRow>Db.LastRow+1||Xc.LastRow<Db.FirstRow||Xc.FirstColumn>Db.LastColumn+1||Xc.LastColumn<Db.FirstColumn)continue;const ld=this.DTh(Db,Xc,Nc),Dd=this.CTh(Db,Xc,Nc);Cc.push(Object(Ca.a)(new vb,{FirstRow:ld.FirstRow,FirstColumn:Dd.FirstColumn,LastRow:ld.LastRow,LastColumn:Dd.LastColumn}))}0<Cc.length&&!nd?Nc.setPrintArea(Cc):0<Cc.length&&nd?Nc.addToPrintArea(Cc):!nd&&Nc.hasPrintArea()&&Nc.clearPrintArea();!Nc.isDirty()&&Nc.hasPageLayout()&&Nc.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+
wd.Od,4)}this.hNb(od,Rb,Dc)}}JXg(Rb,Dc){const nd=x.g(this.$);var od=x.g(this.$).Ea.cF();if(od&&od.length){for(const wd of od){od=wd;const Pc=od.tf;Pc&&(Pc.clearPrintArea(),!Pc.isDirty()&&Pc.hasPageLayout()&&Pc.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+od.Od,4))}this.hNb(nd,Rb,Dc)}}fbi(Rb,Dc){const nd=x.g(this.$);var od=nd.Ea;const wd=r.o(nd.ha.sa.activeCell,this.$);if(wd){var Pc=od.cF();if(Pc&&Pc.length){od=null;for(var Hb of Pc){let Nc=Hb,Db=Nc.tf;if(!Db)continue;let Cc=
r.j(Nc.rf);if(!(wd.FirstRow>Cc.LastRow||wd.FirstRow<Cc.FirstRow||wd.FirstColumn>Cc.LastColumn||wd.FirstColumn<Cc.FirstColumn)&&(od=this.N7g(Db,Cc,wd),Db.insertPageBreak(od),!Db.isDirty()&&Db.hasPageLayout()&&Db.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+Nc.Od,4),od))break}if(!od)for(const Nc of Pc)if(od=Nc,Hb=od.tf)od=r.j(od.rf),od=this.uDe(Hb,od,wd),Hb.insertPageBreak(od);this.hNb(nd,Rb,Dc)}}}i$i(Rb,Dc){const nd=x.g(this.$);var od=nd.Ea;const wd=r.o(nd.ha.sa.activeCell,
this.$);if(wd&&(od=od.cF())&&od.length){for(const Hb of od){od=Hb;const Nc=od.tf;if(Nc){var Pc=r.j(od.rf);(Pc=this.uDe(Nc,Pc,wd))&&Nc.removePageBreak(Pc);!Nc.isDirty()&&Nc.hasPageLayout()&&Nc.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+od.Od,4)}}this.hNb(nd,Rb,Dc)}}Zej(Rb,Dc){const nd=x.g(this.$);var od=nd.Ea.cF();if(od&&od.length){for(const wd of od){od=wd;const Pc=od.tf;Pc&&(Pc.resetAllPageBreak(),!Pc.isDirty()&&Pc.hasPageLayout()&&Pc.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+
od.Od,4))}this.hNb(nd,Rb,Dc)}}b5e(Rb,Dc,nd,od,wd){if(!wd){var Pc=this.$.zb.getItemByName("PRINT_AREA");if(Pc&&(d.ULS.sendTraceTag(537154306,0,15,`PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : ${Pc.type}`),2===Pc.type))return this.Kci(),Ya.Task.Ta(!0)}Pc=x.g(this.$).ha.sa;const Hb=r.r(Pc.selectedRanges,this.$);if(1===Hb.Ranges.length&&!wd){if(Pc.jba())return this.e3h(Rb,Hb,Dc,nd,od,wd),Ya.Task.Ta(!0);if(r.R(Hb.Ranges[0]))return this.$.xa.pa.hasPrintArea?
this.b4e(Rb,Dc,nd,od):Ya.Task.Ta(!0)}this.e_f(Rb.command,od,wd);return this.daf(Rb,Dc,nd,Hb,wd)}b4e(Rb,Dc,nd,od){this.JXg(Rb.command,od);return this.wci(Rb,Dc,nd)}S1h(Rb,Dc,nd,od){this.fbi(Rb.command,od);return this.Hci(Rb,Dc,nd)}P2h(Rb,Dc,nd,od){const wd=r.r(x.g(this.$).ha.sa.selectedRanges,this.$);if(r.R(wd.Ranges[0]))return this.X4e(Rb,Dc,nd,od);this.i$i(Rb.command,od);return this.Lci(Rb,Dc,nd)}X4e(Rb,Dc,nd,od){this.Zej(Rb.command,od);return this.Oci(Rb,Dc,nd)}daf(Rb,Dc,nd,od,wd){const Pc=this.$.oa.va,
Hb=(Db,Cc,Xc)=>da(Pc,od,wd,ib.b(Db,Dc),ib.a(Cc,nd),Xc,null),Nc=()=>new cc(od,wd);return v.EwaSettings.dc()?Wb.a(this.$.userOperationManager,Hb,Db=>new ja.a(241,0,Db,64,Nc),Rb):Wb.a(this.$.userOperationManager,Hb,Db=>new nc.a(241,0,Db,void 0,Nc),Rb)}wci(Rb,Dc,nd){const od=this.$.xa.pa.name,wd=this.$.oa.va,Pc=(Nc,Db,Cc)=>qa(wd,od,ib.b(Nc,Dc),ib.a(Db,nd),Cc,null),Hb=()=>new sb(od);return v.EwaSettings.dc()?Wb.a(this.$.userOperationManager,Pc,Nc=>new ja.a(243,0,Nc,64,Hb),Rb):Wb.a(this.$.userOperationManager,
Pc,Nc=>new nc.a(243,0,Nc,void 0,Hb),Rb)}Hci(Rb,Dc,nd){var od=x.g(this.$);const wd=r.o(od.ha.sa.activeCell,this.$);od=(Hb,Nc,Db)=>O(this.$.oa.va,wd,ib.b(Hb,Dc),ib.a(Nc,nd),Db,null);const Pc=()=>new ua(wd);return v.EwaSettings.dc()?Wb.a(this.$.userOperationManager,od,Hb=>new ja.a(244,0,Hb,64,Pc),Rb):Wb.a(this.$.userOperationManager,od,Hb=>new nc.a(244,0,Hb,void 0,Pc),Rb)}Lci(Rb,Dc,nd){var od=x.g(this.$);const wd=r.o(od.ha.sa.activeCell,this.$);od=(Hb,Nc,Db)=>ea(this.$.oa.va,wd,ib.b(Hb,Dc),ib.a(Nc,nd),
Db,null);const Pc=()=>new ma(wd);return v.EwaSettings.dc()?Wb.a(this.$.userOperationManager,od,Hb=>new ja.a(245,0,Hb,64,Pc),Rb):Wb.a(this.$.userOperationManager,od,Hb=>new nc.a(245,0,Hb,void 0,Pc),Rb)}Oci(Rb,Dc,nd){const od=this.$.xa.pa.name,wd=(Hb,Nc,Db)=>R(this.$.oa.va,od,ib.b(Hb,Dc),ib.a(Nc,nd),Db,null),Pc=()=>new fb(od);return v.EwaSettings.dc()?Wb.a(this.$.userOperationManager,wd,Hb=>new ja.a(246,0,Hb,64,Pc),Rb):Wb.a(this.$.userOperationManager,wd,Hb=>new nc.a(246,0,Hb,void 0,Pc),Rb)}DTh(Rb,
Dc,nd){if(!Rb||!Dc||!nd)return null;const od=new vb;od.FirstRow=Dc.FirstRow===Rb.LastRow+1?nd.getRowIndex(Rb.LastRow+1)+1:Dc.FirstRow<Rb.FirstRow?0:nd.getRowIndex(Dc.FirstRow+1);od.LastRow=Dc.FirstRow===Rb.LastRow+1||Dc.LastRow>Rb.LastRow?nd.getRowIndex(Rb.LastRow+1)+1:nd.getRowIndex(Dc.LastRow+1);return od}CTh(Rb,Dc,nd){if(!Rb||!Dc||!nd)return null;const od=new vb;od.FirstColumn=Dc.FirstColumn===Rb.LastColumn+1?nd.getColumnIndex(Rb.LastColumn+1)+1:Dc.FirstColumn<Rb.FirstColumn?0:nd.getColumnIndex(Dc.FirstColumn+
1);od.LastColumn=Dc.FirstColumn===Rb.LastColumn+1||Dc.LastColumn>Rb.LastColumn?nd.getColumnIndex(Rb.LastColumn+1)+1:nd.getColumnIndex(Dc.LastColumn+1);return od}N7g(Rb,Dc,nd){if(!Dc||!nd||!Rb)return null;const od=Rb.getPrintArea();if(!od||!od.length)return null;const wd=Rb.getRowIndex(nd.FirstRow+1),Pc=Rb.getColumnIndex(nd.FirstColumn+1);let Hb=null,Nc=null;for(const Db of od)if(wd>=Db.FirstRow&&wd<=Db.LastRow&&Pc>=Db.FirstColumn&&Pc<=Db.LastColumn){if(nd.FirstRow===Db.FirstRow&&nd.FirstColumn===
Db.FirstColumn)return new Va;wd>Db.FirstRow&&(Hb=Object(Ca.a)(new Sa,{Index:wd-1,Min:Db.FirstColumn-1,Max:Math.min(Db.LastColumn,Rb.getColumnIndex(Dc.LastColumn+1))}));Pc>Db.FirstColumn&&(Nc=Object(Ca.a)(new Sa,{Index:Pc-1,Min:Db.FirstRow-1,Max:Math.min(Db.LastRow,Rb.getRowIndex(Dc.LastRow+1))}));break}return Hb||Nc?Object(Ca.a)(new Va,{Row:Hb?[Hb]:null,Col:Nc?[Nc]:null}):null}c9g(Rb,Dc,nd){if(!Dc||!nd||!Rb)return null;let od=null;nd.FirstRow>Dc.FirstRow&&nd.FirstRow<=Dc.LastRow?od=Object(Ca.a)(new Sa,
{Index:Rb.getRowIndex(nd.FirstRow+1)-1,Min:-1,Max:-1}):nd.FirstRow===Dc.LastRow+1&&(od=Object(Ca.a)(new Sa,{Index:Rb.getRowIndex(Dc.LastRow+1),Min:-1,Max:-1}));return od}A4g(Rb,Dc,nd){if(!Dc||!nd||!Rb)return null;let od=null;nd.FirstColumn>Dc.FirstColumn&&nd.FirstColumn<=Dc.LastColumn?od=Object(Ca.a)(new Sa,{Index:Rb.getColumnIndex(nd.FirstColumn+1)-1,Min:-1,Max:-1}):nd.FirstColumn===Dc.LastColumn+1&&(od=Object(Ca.a)(new Sa,{Index:Rb.getColumnIndex(Dc.LastColumn+1),Min:-1,Max:-1}));return od}uDe(Rb,
Dc,nd){if(!nd||!Rb||!Dc)return null;const od=this.c9g(Rb,Dc,nd);Rb=this.A4g(Rb,Dc,nd);return od||Rb?Object(Ca.a)(new Va,{Row:od?[od]:null,Col:Rb?[Rb]:null}):null}Kci(){const Rb=new $a.StandardDialog;Rb.Rb=0;Rb.rc(1,y.a.instance.ga(4));Rb.wl(y.a.instance.ga(574),y.a.instance.ga(575),1,null)}KDj(Rb){if(this.iva.mb(Rb)&&(J.HelperMethods.rZ&&(this.UEb=this.$.Ib.Bc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.jKa.mb(Rb)&&this.jKa.remove(Rb),this.jKa.add(Rb,pa.a.create().toString()),x.g(this.$).Gi)){const Dc=
na.b()?na.b().nj(Rb):"";x.g(this.$).Gi.T6(this.iva.na(Rb),this.jKa.na(Rb),Dc)}}VVg(Rb){if(this.UEb&&Rb){const Dc=this.UEb.uc;this.UEb.stop();this.UEb=null;switch(Rb){case "SetPrintArea":this.kpb(Dc,1700,Rb);break;case "ClearPrintArea":this.kpb(Dc,1500,Rb);break;case "InsertPageBreak":this.kpb(Dc,1500,Rb);break;case "RemovePageBreak":this.kpb(Dc,1600,Rb);break;case "ResetAllPageBreaks":this.kpb(Dc,1700,Rb)}}}kpb(Rb,Dc,nd){Rb>Dc&&(Dc=Object(Ca.a)(new Na.a,{extendedProperties:new Map}),Dc.extendedProperties.set("OperationName",
nd),Dc.extendedProperties.set("OperationExecutionTime",Rb.toString()),Kb.Health.instance.recordQosError(Ua.a.yCj,[ab.a.uCj],!1,!0,!0,!1,Dc))}e3h(Rb,Dc,nd,od,wd,Pc){const Hb=new $a.StandardDialog,Nc=new rb.a(y.a.instance.ga(572),y.a.instance.ga(573),y.a.instance.ga(6),y.a.instance.ga(5));Hb.Rb=1;Hb.rc(1,Nc.confirmButton);Hb.rc(0,Nc.cancelButton);Hb.wl(Nc.title,Nc.body,3,Db=>{1===Db&&(this.e_f(Rb.command,wd,Pc),this.daf(Rb,nd,od,Dc,Pc))})}hNb(Rb,Dc,nd){nd();this.jKa.mb(Dc)&&Rb.Gi.e0(this.jKa.na(Dc),
Ea.BasicTelemetryCalculator.vQ)}$Vd(){this.Cod&&this.$.ud(-1753588160,-1,0,null)}}Object(b.a)(yb,"PrintAreaBreakManager",null,[798]);var Ob=a(380),Ja=a(86);class lb{constructor(){this.margin=this.F_=this.gca=this.orientation=this.zu=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.h1a=!1;this.NoColor=null}equals(Rb){return Rb?this.orientation===Rb.orientation&&this.gca===Rb.gca&&this.F_===Rb.F_&&this.margin===Rb.margin&&this.sheetPrintOptions===Rb.sheetPrintOptions&&this.h1a===Rb.h1a&&this.NoColor===
Rb.NoColor:!1}static oBe(Rb,Dc){Rb&&Dc&&(Dc.zu=Rb.zu,Dc.orientation=Rb.orientation,Dc.gca=Rb.gca,Dc.F_=Rb.F_,Dc.margin=Rb.margin,Dc.ignorePrintArea=Rb.ignorePrintArea,Dc.sheetPrintOptions=Rb.sheetPrintOptions,Dc.h1a=Rb.h1a,Dc.NoColor=Rb.NoColor)}}Object(b.a)(lb,"PrintSettingsContainer",null,[]);var Pb=a(153),Jb=a(340),Lb=a(38),Ab=a(810),nb=a(777),va=a(185),db=a(637),Xa=a(551);class gb{constructor(){this.marginValue=this.printSettingOption=null}}Object(b.a)(gb,"PrintSettingMarginOption",null,[]);class Ha{constructor(){this.footer=
this.header=this.bottom=this.top=this.right=this.left=0}}Object(b.a)(Ha,"PrintSettingMarginValue",null,[]);class tb{constructor(){this.printSettingOptionKey=0;this.printSettingOptionText=null}}Object(b.a)(tb,"PrintSettingOption",null,[]);class bc{constructor(Rb){this.KCi=[.75,.75,.7,.7,.3,.3];this.zBi=[.75,.75,.25,.25,.3,.3];this.WWj=[1,1,1,1,.5,.5];this.L$d=this.Gee=this.ace=this.Kbe=this.oie=this.X5=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.Qm=Rb;this.M$h();this.T$h()}get whatToPrintOptions(){return this.oie}get orientationOptions(){return this.Kbe}get paperSizeOptions(){return this.ace}get scalingOptions(){return this.Gee}get marginDetailedOptions(){return this.L$d}dispose(){}tvb(Rb){if(!Rb)return null;
const Dc=new Ha;Dc.left=Rb.Left;Dc.right=Rb.Right;Dc.top=Rb.Top;Dc.bottom=Rb.Bottom;Dc.header=Rb.Header;Dc.footer=Rb.Footer;return Dc}Y2c(Rb){d.ULS.shipAssertTag(537154186,0,6===Rb.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");const Dc={};Dc.Top=Rb[0];Dc.Bottom=Rb[1];Dc.Left=Rb[2];Dc.Right=Rb[3];Dc.Header=Rb[4];Dc.Footer=Rb[5];return Dc}T$h(){this.oie=[Object(Ca.a)(new tb,{printSettingOptionKey:1,printSettingOptionText:this.Qm.ga(1232)}),
Object(Ca.a)(new tb,{printSettingOptionKey:2,printSettingOptionText:this.Qm.ga(1225)}),Object(Ca.a)(new tb,{printSettingOptionKey:0,printSettingOptionText:this.Qm.ga(1224)})];this.Kbe=[Object(Ca.a)(new tb,{printSettingOptionKey:1,printSettingOptionText:this.Qm.ga(1235)}),Object(Ca.a)(new tb,{printSettingOptionKey:2,printSettingOptionText:this.Qm.ga(1234)})];this.ace=[Object(Ca.a)(new tb,{printSettingOptionKey:1,printSettingOptionText:this.Qm.ga(1237)}),Object(Ca.a)(new tb,{printSettingOptionKey:5,
printSettingOptionText:this.Qm.ga(1238)}),Object(Ca.a)(new tb,{printSettingOptionKey:6,printSettingOptionText:this.Qm.ga(1245)}),Object(Ca.a)(new tb,{printSettingOptionKey:7,printSettingOptionText:this.Qm.ga(1239)}),Object(Ca.a)(new tb,{printSettingOptionKey:8,printSettingOptionText:this.Qm.ga(1240)}),Object(Ca.a)(new tb,{printSettingOptionKey:9,printSettingOptionText:this.Qm.ga(1241)}),Object(Ca.a)(new tb,{printSettingOptionKey:11,printSettingOptionText:this.Qm.ga(1242)}),Object(Ca.a)(new tb,{printSettingOptionKey:12,
printSettingOptionText:this.Qm.ga(1243)}),Object(Ca.a)(new tb,{printSettingOptionKey:13,printSettingOptionText:this.Qm.ga(1244)}),Object(Ca.a)(new tb,{printSettingOptionKey:3,printSettingOptionText:this.Qm.ga(1236)})];this.Gee=[Object(Ca.a)(new tb,{printSettingOptionKey:0,printSettingOptionText:this.Qm.ga(1253)}),Object(Ca.a)(new tb,{printSettingOptionKey:1,printSettingOptionText:this.Qm.ga(1254)}),Object(Ca.a)(new tb,{printSettingOptionKey:2,printSettingOptionText:this.Qm.ga(1255)}),Object(Ca.a)(new tb,
{printSettingOptionKey:3,printSettingOptionText:this.Qm.ga(1256)})];this.L$d=[Object(Ca.a)(new gb,{printSettingOption:Object(Ca.a)(new tb,{printSettingOptionKey:0,printSettingOptionText:this.Qm.ga(1259)}),marginValue:this.tvb(this.normal)}),Object(Ca.a)(new gb,{printSettingOption:Object(Ca.a)(new tb,{printSettingOptionKey:1,printSettingOptionText:this.Qm.ga(1260)}),marginValue:this.tvb(this.wide)}),Object(Ca.a)(new gb,{printSettingOption:Object(Ca.a)(new tb,{printSettingOptionKey:2,printSettingOptionText:this.Qm.ga(1261)}),
marginValue:this.tvb(this.narrow)}),Object(Ca.a)(new gb,{printSettingOption:Object(Ca.a)(new tb,{printSettingOptionKey:3,printSettingOptionText:this.Qm.ga(1262)}),marginValue:this.tvb(this.X5)})]}M$h(){this.normal=this.Y2c(this.KCi);this.narrow=this.Y2c(this.zBi);this.wide=this.Y2c(this.WWj)}}bc.jch=1;bc.Xbh=1;bc.srb=9;bc.bch=2;bc.Vbh=0;bc.Obh=!1;bc.Lbh=!1;bc.FHa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(b.a)(bc,"PrintSettingsManagerBase",null,[2]);var tc=a(120),
Ma=a(281);class Tb{constructor(Rb,Dc){this.sheetPrintOptions=this.sheetName=null;this.sheetName=Rb;this.sheetPrintOptions=Dc}getSheetName(){return this.sheetName}}Object(b.a)(Tb,"MacroRecorderSheetPrintOptionsSavedPayload",null,[101]);class zb extends bc{constructor(Rb,Dc,nd,od,wd,Pc){super(wd);this.q4f=this.zd=!1;this.pAd=Hb=>{this.wD.pAd(Hb)};this.AAd=Hb=>{this.wD.AAd(Hb)};this.hQi=()=>{d.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};
this.gQi=Hb=>{Hb=D.a.lf(Hb.data);d.ULS.sendTraceTag(537154189,0,10,`PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: ${ia.a.yc(Hb)}.`)};this.Hz=(Hb,Nc)=>{2===Nc.Lq?this.ov.clear():1===Nc.Lq&&this.ov&&this.ov.contains(Nc.xf)&&(d.ULS.sendTraceTag(537154188,0,50,`PrintSettingsManager.OnQueueChanged: web method ${tc.a(Nc.xf.operation.operationName)} returned, it took ${Nc.xf.dequeueUtcTime.getTime()-Nc.xf.enqueueUtcTime.getTime()} milliseconds to complete.`),
this.ov.remove(Nc.xf))};this.wD=Rb;this.GN=nd;this.$=Dc;this.sheetName=od;this.locale=window.navigator.browserLanguage||window.navigator.language||this.$.ya.UICultureTag;this.rVi=this.m2g();this.$.userOperationManager.Hr(this.Hz);this.ov=new va.a;this.isUniversalPrintEnabled=Pc}Bci(Rb){this.Cci(Dc=>{Rb&&(Dc=this.ITh(Dc),Rb(Dc))})}ELd(Rb,Dc){if(Rb){var nd=new mb(Rb.zu,Rb.ignorePrintArea);this.ejj(nd);!Dc||this.q4f?d.ULS.sendTraceTag(593294034,0,50,`PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because ${Dc?
"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"}`):(Dc=this.KTh(Rb.F_),Dc.IsLandscape=2===Rb.orientation,Dc.PaperSize=Rb.gca,this.isUniversalPrintEnabled&&(Dc.NoColor=Rb.NoColor),Dc.PageMargin=this.Jed(Rb.margin),Dc.SheetPrintOptions=bc.FHa,Dc.SheetPrintOptions.PrintGrid=Rb.sheetPrintOptions.PrintGrid,Dc.SheetPrintOptions.HorizontalCenter=Rb.sheetPrintOptions.HorizontalCenter,Dc.SheetPrintOptions.VerticalCenter=Rb.sheetPrintOptions.VerticalCenter,Dc.SheetPrintOptions.PrintHeaders=
Rb.sheetPrintOptions.PrintHeaders,this.djj(Dc))}else d.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")}Jed(Rb){let Dc={};0===Rb?Dc=this.normal:1===Rb?Dc=this.wide:2===Rb?Dc=this.narrow:3===Rb&&(Dc=this.X5);return Dc}Sci(Rb){if(Rb){d.ULS.sendTraceTag(537154197,0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var Dc=()=>new Tb(this.$.xa.pa.name,Rb),nd=this.$.oa.va,
od=this.$.oa.va.Sb(),wd=(Pc,Hb,Nc)=>V(nd,this.$.xa.pa.name,Rb,ib.b(this.pAd,Pc),ib.a(this.AAd,Hb),Nc,od);Dc=v.EwaSettings.dc()?new ja.a(598,0,wd,64,Dc):new nc.a(598,0,wd,void 0,Dc);this.$.userOperationManager.Ub(Dc,null)}else d.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")}dispose(){this.zd||(this.zd=!0,this.$.userOperationManager.Co(this.Hz),this.xX())}ejj(Rb){this.GN.zu=Rb.zu;this.GN.ignorePrintArea=Rb.ignorePrintArea}Cci(Rb){const Dc=
Pc=>{Ma.a(Pc)?d.ULS.sendTraceTag(537154196,0,15,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${ia.a.yc(Pc.Errors)}.`):(d.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),Rb(Pc.Result))},nd=Pc=>{Pc=D.a.lf(Pc.data);d.ULS.sendTraceTag(537154194,0,10,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${ia.a.yc(Pc)}.`);Rb(null)},od=this.$.oa.va.Sb();
var wd=(Pc,Hb,Nc)=>W(this.$.oa.va,this.sheetName,this.locale,ib.b(Pc,Dc),ib.a(Hb,nd),Nc,od);wd=v.EwaSettings.dc()?new ja.a(247,0,wd,80):new nc.a(247,0,wd,16);wd=this.$.userOperationManager.Ub(wd,null);this.ov.add(wd)}djj(Rb){d.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");const Dc=this.$.oa.va.Sb();this.$.userOperationManager.Ub(new ja.a(226,0,(nd,od,wd)=>K(this.$.oa.va,this.sheetName,Rb,ib.b(nd,this.hQi),
ib.a(od,this.gQi),wd,Dc),void 0,()=>new wa(this.sheetName,Rb)),null)}Sji(Rb){return this.xbf(Rb)||!this.Hef(Rb.PaperSize)}O$c(Rb){this.xbf(Rb)&&(d.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),Rb.ScalingWidth=zb.P4c,Rb.ScalingHeight=zb.O4c,Rb.ScalingPercent=zb.L4b,Rb.FitToPage=zb.I4c);this.Hef(Rb.PaperSize)||(d.ULS.sendTraceTag(537154191,0,15,`PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size ${Rb.PaperSize.toString()} present in file which is unsupported by XLO.`),
Rb.PaperSize=zb.srb);return Rb}GTh(Rb){if(Rb.FitToPage){if(1===Rb.ScalingWidth&&1===Rb.ScalingHeight)return 1;if(!Rb.ScalingWidth&&1===Rb.ScalingHeight)return 3}else return 0;return 2}FTh(Rb){return this.jod(Rb,this.normal)?0:this.jod(Rb,this.wide)?1:this.jod(Rb,this.narrow)?2:3}jod(Rb,Dc){return Rb.Left===Dc.Left&&Rb.Right===Dc.Right&&Rb.Top===Dc.Top&&Rb.Bottom===Dc.Bottom&&Rb.Header===Dc.Header&&Rb.Footer===Dc.Footer}KTh(Rb){const Dc={};Dc.ScalingPercent=zb.L4b;Dc.FitToPage=0!==Rb;2===Rb?(Dc.ScalingWidth=
1,Dc.ScalingHeight=0):3===Rb?(Dc.ScalingWidth=0,Dc.ScalingHeight=1):1===Rb&&(Dc.ScalingWidth=1,Dc.ScalingHeight=1);return Dc}Hef(Rb){return this.rVi.contains(Rb.toString())}xbf(Rb){return 100!==Rb.ScalingPercent||Rb.FitToPage&&(1<Rb.ScalingWidth||1<Rb.ScalingHeight)}m2g(){const Rb=new db.a(Xa.a.Sk());for(let Dc=0;Dc<this.paperSizeOptions.length;Dc++)Rb.add(this.paperSizeOptions[Dc].printSettingOptionKey.toString());return Rb}ITh(Rb){let Dc=null;if(Rb){const nd=this.GN.zu,od=this.GN.ignorePrintArea;
this.Sji(Rb)&&(this.q4f=!0,Rb=this.O$c(Rb));Dc=new lb;Dc.zu=nd;Dc.ignorePrintArea=od;Dc.orientation=Rb.IsLandscape?2:1;Dc.gca=Rb.PaperSize;Dc.F_=this.GTh(Rb);Dc.sheetPrintOptions=bc.FHa;Dc.sheetPrintOptions.PrintGrid=Rb.SheetPrintOptions.PrintGrid;Dc.h1a=Rb.Draft;this.isUniversalPrintEnabled&&(Dc.NoColor=Rb.NoColor);Dc.sheetPrintOptions.HorizontalCenter=Rb.SheetPrintOptions.HorizontalCenter;Dc.sheetPrintOptions.VerticalCenter=Rb.SheetPrintOptions.VerticalCenter;Dc.sheetPrintOptions.PrintHeaders=Rb.SheetPrintOptions.PrintHeaders;
Dc.margin=this.FTh(Rb.PageMargin);v.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&d.ULS.sendTraceTag(553965398,0,50,`PageMargin received : ${Dc.margin}`);3===Dc.margin&&(this.X5={},this.X5.Left=Rb.PageMargin.Left,this.X5.Right=Rb.PageMargin.Right,this.X5.Top=Rb.PageMargin.Top,this.X5.Bottom=Rb.PageMargin.Bottom,this.X5.Header=Rb.PageMargin.Header,this.X5.Footer=Rb.PageMargin.Footer)}return Dc}xX(){if(this.ov){for(let Rb of this.ov)this.$&&this.$.userOperationManager&&(Rb.operation&&
d.ULS.sendTraceTag(537154187,0,50,`PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation ${tc.a(Rb.operation.operationName)}.`),this.$.userOperationManager.ita(Rb)),this.ov.remove(Rb);this.ov=null}}}zb.P4c=1;zb.O4c=0;zb.L4b=100;zb.srb=9;zb.I4c=!0;Object(b.a)(zb,"PrintSettingsManager",bc,[]);var ic=a(68);class Qb{constructor(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}}Object(b.a)(Qb,"PrintSettingsTaskPaneCallbacks",null,[]);class wb{constructor(){this.selectedColor=
this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}}Object(b.a)(wb,"SelectedPrintSettings",null,[]);class hc{constructor(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=
null}}Object(b.a)(hc,"PrintOperationCallbacks",null,[]);class Za{constructor(){this.onBackToSheet=null}}Object(b.a)(Za,"PrintPreviewPaneCallbacks",null,[]);var ub=a(1073);class uc{constructor(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}}Object(b.a)(uc,"UniversalPrintAppSettings",null,[]);var Oc=a(416);class Bb{constructor(Rb,Dc,nd,od){this.activeCell=this.selectedRange=this.ng=this.graphServiceEndpoint=null;
this.n_=0;this.Nm=this.pv=null;this.AH=new lb;this.Ak=new lb;this.uba=0;this.p7a=null;this.hMb=!1;this.G2a=this.jFb=null;this.Dod=!1;this.o6a=this.ezb=!0;this.Ola=this.uya=this.IMa=null;this.eyb=!1;this.m7a=null;this.G5a=this.$Jc=!1;this.izd=wd=>{if(!(wd&&wd.data&&wd.data.Vd&&wd.data.responseHeaders&&wd.data.Vd.length)){var Pc=wd?wd.data?wd.data.Vd?wd.data.responseHeaders?wd.data.Vd.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":
"requestSucceededEventArgs.Data":"requestSucceededEventArgs";this.ng&&(wd=this.xQa(y.a.instance.ga(1213)),this.kAa(wd,0));d.ULS.sendTraceTag(593266765,0,10,`PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : ${Pc}`);this.yJd&&(wd=Object(Ca.a)(new Na.a,{extendedProperties:new Map}),wd.extendedProperties.set("InvalidParameterName",Pc),Kb.Health.instance.recordQosError(Ua.a.jIf,[ab.a.kIf],!1,!0,!0,!1,wd))}else if(0<this.uba&&wd.data.id===this.uba){if(wd.data.responseHeaders["Content-Type"]&&
(ya.a.contains(wd.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||ya.a.contains(wd.data.responseHeaders["Content-Type"].toString(),"text/plain",!0))){d.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var Hb=null;ya.a.contains(wd.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(Hb=this.o4g(wd));Pc={};this.HDb(Pc,null,null,Hb);wd.data.responseHeaders["Total-Pdf-PageCount"]?(Hb=parseInt(wd.data.responseHeaders["Total-Pdf-PageCount"].toString(),
10),this.eyb||(this.lEd>=Hb?this.Ola=Hb:this.eyb=!0),this.o6a&&this.ng&&this.ng.setPageRangeSettings(Hb,this.lEd,this.eyb,this.uya,this.Ola)):d.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else Pc=Y.a.Vh(wd.data.Vd),ia.a.q9(Pc.Errors)||ic.a(this.$).jd.XL(Pc.Errors[0].MessageId),this.W5i(Pc.Errors),this.ng&&(Hb=this.xQa(Pc.Errors[0].Description),-1831476778===Pc.Errors[0].MessageId?(d.ULS.sendTraceTag(537154256,
0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),this.kAa(Hb,0,y.a.instance.ga(1216))):this.kAa(Hb,0)),297284985===Pc.Errors[0].MessageId?d.ULS.sendTraceTag(570716892,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: ${Pc.Errors[0].MessageId}`):d.ULS.sendTraceTag(593266763,0,15,`PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: ${Pc.Errors[0].MessageId}`);wd=wd.data.state;
wd.n8c(Pc,wd.userContext,wd.methodName)}};this.hzd=wd=>{if(0<this.uba&&wd.data.id===this.uba){var Pc=D.a.lf(wd.data);this.ng&&this.kAa(this.xQa(Pc[0].Description),1);d.ULS.sendTraceTag(593266762,0,15,`PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [${ia.a.yc(Pc)}]`);Pc=wd.data.state;Pc.M$(wd,Pc.userContext,Pc.methodName);this.$.userOperationManager.yka.operation.Xma(()=>this.hMb)}};this.IHi=(wd,Pc,Hb)=>{wd.Errors&&0<wd.Errors.length&&this.ng?(ia.a.q9(wd.Errors)||ic.a(this.$).jd.XL(wd.Errors[0].MessageId),
this.kAa(this.xQa(wd.Errors[0].Description),0),d.ULS.sendTraceTag(537154254,0,50,`PrintPreviewManager: Failed to convert workbook. Error message Id: ${wd.Errors[0].MessageId}`)):(d.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),this.HDb(wd,Pc,Hb,null))};this.HHi=wd=>{wd=D.a.lf(wd.data);this.ng&&this.kAa(this.xQa(wd[0].Description),1);d.ULS.sendTraceTag(537154252,0,15,`PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [${ia.a.yc(wd)}]`);
this.$.userOperationManager.yka.operation.Xma(()=>this.hMb)};this.yzf=(wd,Pc)=>{if(Pc)switch(Pc.M_i){case 1:if(this.Ak&&this.G2a)switch(wd=this.G2a.uc,this.G2a.stop(),this.G2a=null,this.Ak.zu){case 1:this.IZc(wd,4800,"ActiveSheet");break;case 0:this.IZc(wd,6100,"CurrentSelection");break;case 2:this.IZc(wd,7500,"EntireWorkbook")}break;case 0:this.jFb&&(wd=this.jFb.uc,this.jFb.stop(),2400<wd&&(Pc=Object(Ca.a)(new Na.a,{extendedProperties:new Map}),Pc.extendedProperties.set("PaneLoadTime",wd.toString()),
Kb.Health.instance.recordQosError(Ua.a.xCj,[ab.a.w4f],!1,!0,!0,!1,Pc)),this.pv.Bci(Hb=>{this.BAj(Hb)}))}};this.Hz=(wd,Pc)=>{(1===Pc.Lq&&this.IMa===Pc.xf||2===Pc.Lq)&&this.nKd()};this.$=Rb;this.Jha=Dc;this.n2=nd;this.eDb=od;this.yJd=J.HelperMethods.rZ;this.Qa=new Lb.a;this.lEd=this.$.ya.PrintPreviewerPaginationRange;this.useMSPdfViewer=this.lyj();this.v$h();this.Xdi=this.$Vg();this.Cod=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1);if(this.isUniversalPrintEnabled=
!!od&&od.t5a()&&v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.me.get(116))this.graphServiceEndpoint=this.$.ya.GraphServiceEndpoint;this.isExportPdfMode=!1}get Rji(){return this.$Jc}aGg(Rb){this.Qa.addHandler("ppocek",Rb)}Pbj(Rb){this.Qa.removeHandler("ppocek",Rb)}AAj(Rb,Dc,nd){this.wfj();this.$.userOperationManager.Hr(this.Hz);this.Nm=Rb;this.Qa.raiseEvent("ppocek");this.isExportPdfMode=nd;this.Nm.SelectedRanges&&this.Nm.SelectedRanges.Ranges&&0<this.Nm.SelectedRanges.Ranges.length&&
this.Nm.SelectedRanges.Ranges[0]&&(this.selectedRange=r.B(this.Nm.SelectedRanges.Ranges[0]).toString());d.ULS.shipAssertTag(537154268,0,!this.pv,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.pv=new zb(this,this.$,Dc,this.$.xa.pa.name,y.a.instance,this.isUniversalPrintEnabled);d.ULS.shipAssertTag(537154267,0,!this.ng,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.ng=new nb.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);
this.ng.Pfh();this.ng.CAj(this.isExportPdfMode);this.ng.tFg(this.yzf)}OQh(){this.pv.X5&&4<=this.pv.marginDetailedOptions.length&&(this.pv.marginDetailedOptions[3].marginValue=this.pv.tvb(this.pv.X5));return this.pv.marginDetailedOptions}Vvc(){return!!this.Nm&&!!this.Nm.ObjectId||!x.g(this.$).ha.sa.wg}LTh(){const Rb=Object(Ca.a)(new wb,{selectedWhatToPrint:bc.jch,selectedOrientation:bc.Xbh,selectedPaperSize:bc.srb,selectedScaling:bc.bch,selectedMargin:bc.Vbh,selectedIgnorePrintArea:bc.Obh,selectedPrintGridlines:bc.FHa.PrintGrid,
selectedDraft:bc.Lbh,selectedHorizontalCenter:bc.FHa.HorizontalCenter,selectedVerticalCenter:bc.FHa.VerticalCenter,selectedRowAndColumnHeadings:bc.FHa.PrintHeaders});this.AH?(Rb.selectedWhatToPrint=this.AH.zu,Rb.selectedOrientation=this.AH.orientation,Rb.selectedPaperSize=this.AH.gca,Rb.selectedScaling=this.AH.F_,Rb.selectedMargin=this.AH.margin,Rb.selectedIgnorePrintArea=this.AH.ignorePrintArea,Rb.selectedPrintGridlines=this.AH.sheetPrintOptions.PrintGrid,Rb.selectedDraft=this.AH.h1a,this.isUniversalPrintEnabled&&
(Rb.selectedColor=this.AH.NoColor?0:1),Rb.selectedHorizontalCenter=this.AH.sheetPrintOptions.HorizontalCenter,Rb.selectedVerticalCenter=this.AH.sheetPrintOptions.VerticalCenter,Rb.selectedRowAndColumnHeadings=this.AH.sheetPrintOptions.PrintHeaders):d.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return Rb}c0e(){return Object(Ca.a)(new Za,{onBackToSheet:()=>{this.nla()}})}HTh(){return Object(Ca.a)(new ub.a,{backActionButtonText:y.a.instance.ga(1212),
printPreviewPaneCallbacks:this.c0e(),logger:new Ob.a,disableTellMeControl:!0,isExportPdfMode:this.isExportPdfMode,printOperationCallbacks:Object(Ca.a)(new hc,{onClosePreviewer:()=>{this.nla()},getGraphServiceAuthorizationToken:this.M9b(),onLocalPrint:()=>{this.jAf()},onNotifyPrintJobStatus:this.onNotifyPrintJobStatus}),universalPrintAppSettings:Object(Ca.a)(new uc,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.dei()?"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,
appName:"Excel"})})}JTh(){return Object(Ca.a)(new Qb,{onSettingChange:Rb=>{this.$Oi(Rb)},onPrint:()=>{this.jAf()}})}$Oi(Rb){this.n_++;Rb?(this.ng&&this.ng.rBj(),this.Ak.zu=Rb.selectedWhatToPrint,this.Ak.F_=Rb.selectedScaling,this.Ak.orientation=Rb.selectedOrientation,this.Ak.gca=Rb.selectedPaperSize,this.Ak.margin=Rb.selectedMargin,this.isUniversalPrintEnabled&&(this.Ak.NoColor=!Rb.selectedColor),this.Ak.ignorePrintArea=Rb.selectedIgnorePrintArea,this.mrj(Rb.selectedPageStart,Rb.selectedPageEnd),
this.pv&&this.n4h(this.Ak,Rb)?(this.Ak.sheetPrintOptions=bc.FHa,this.Ak.sheetPrintOptions.PrintGrid=Rb.selectedPrintGridlines,this.Ak.sheetPrintOptions.HorizontalCenter=Rb.selectedHorizontalCenter,this.Ak.sheetPrintOptions.VerticalCenter=Rb.selectedVerticalCenter,this.Ak.sheetPrintOptions.PrintHeaders=Rb.selectedRowAndColumnHeadings,this.pv.Sci(this.Ak.sheetPrintOptions)):this.Lxb()):d.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")}nla(){this.G5a&&
(this.hMb=!0);d.ULS.sendTraceTag(591196513,0,50,`PrintPreviewManager.OnCloseButtonClick: User changed printSettings ${this.n_} times before clicking on backToWorkbook icon`);this.iAf();this.rxe()}jAf(){d.ULS.sendTraceTag(591196512,0,50,`PrintPreviewManager.OnPrintButtonClick: User changed printSettings ${this.n_} times before clicking on print button.`);v.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&d.ULS.sendTraceTag(543024129,0,50,`PrintPreviewManager.OnPrintButtonClick: Current margin value : ${this.Ak.margin}, Initial margin value : ${this.AH.margin}`);
if(this.useMSPdfViewer)this.lIf();else if(this.o6a)try{this.ng.printPdf(),this.R_c()}catch(Rb){d.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.lIf()}else this.Jha.q3f(this.fHa(!0)),this.R_c()}lIf(){const Rb=this.fHa(!0);this.R_c();J.HelperMethods.Ve(Rb,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")}dispose(){Ja.a.Ia(this.Qa)}Lxb(){if(this.$.bwa)this.yci();else{this.xX();this.tTf();var Rb=null;this.k$h();d.ULS.sendTraceTag(593266766,
0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");var Dc=(nd,od,wd)=>{nd=new ca.a(nd,null,od,wd,null,!0,!1,"GetFileCopyFileHandler","");nd.correlationID=pa.a.create().toString();Rb=nd;this.uba=this.n2.V8(this.fHa(this.o6a?!1:!0,this.Xdi?"Base64":"Pdf"),1,null,null,Bb.b$c,!1,2,this.izd,this.hzd,Rb,void 0,void 0,void 0,12E4);nd.requestId=this.uba;d.ULS.sendTraceTag(537154264,0,50,`PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: ${this.uba}.`);
return Ya.Task.Ta(!0)};this.IMa=v.EwaSettings.dc()?this.$.userOperationManager.Ub(new ja.a(223,0,Dc,80),null):this.$.userOperationManager.Ub(new nc.a(223,0,Dc,16),null)}}R_c(){this.iAf();this.rxe()}pAd(Rb){ia.a.er(Rb.Errors)?this.ng.showErrorMessageForPrintOptions(y.a.instance.ga(1263)):(d.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.Lxb(),this.ng&&this.ng.hideErrorMessageForPrintOptions())}AAd(Rb){this.ng&&this.ng.showErrorMessageForPrintOptions(y.a.instance.ga(1263));
Rb=D.a.lf(Rb.data);d.ULS.sendTraceTag(537154262,0,10,`PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: ${ia.a.yc(Rb)}.`)}yci(){d.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.xX();const Rb=this.$.oa.va.Sb(),Dc=(nd,od,wd)=>{const Pc={};Pc.WhatToPrint=this.Ak.zu;Pc.UseNamedAction=this.Jha.qwc();Pc.SelectedSheetName=this.$.xa.pa.name;Pc.ActiveCell=this.activeCell;Pc.SelectedRanges=
[this.selectedRange];Pc.IsPdfDocumentRequired=!1;Pc.Orientation=this.Ak.orientation;Pc.PaperSize=this.Ak.gca;Pc.Scaling=this.Ak.F_;Pc.RichValuesEnabled=!0;Pc.IgnorePrintArea=this.Ak.ignorePrintArea;Pc.Preview=!0;this.isUniversalPrintEnabled&&(Pc.NoColor=this.Ak.NoColor);this.Y0f()&&(Pc.PaginationStartPage=this.uya,Pc.PaginationEndPage=this.Ola,Pc.OutputTotalPdfPageCount=!0);const Hb=this.pv.Jed(this.Ak.margin);Hb&&(Pc.PageMargin={},Pc.PageMargin.Top=Hb.Top,Pc.PageMargin.Bottom=Hb.Bottom,Pc.PageMargin.Left=
Hb.Left,Pc.PageMargin.Right=Hb.Right,Pc.PageMargin.Header=Hb.Header,Pc.PageMargin.Footer=Hb.Footer);return this.p7a=L(this.$.oa.va,Pc,ib.b(this.IHi,nd),ib.a(this.HHi,od),wd,Rb)};v.EwaSettings.dc()?this.IMa=this.$.userOperationManager.Ub(new ja.a(133,0,Dc,80),null):this.IMa=this.$.userOperationManager.Ub(new nc.a(133,0,Dc,16),null)}rxe(){this.$.userOperationManager.Co(this.Hz);this.xX();this.tTf();d.ULS.shipAssertTag(537154261,0,!!this.ng,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");
this.isExportPdfMode=!1;this.ng&&(this.ng.sbj(this.yzf),this.ng.Yfh(),this.ng=null);this.Nm=null;this.pv&&(this.pv.dispose(),this.pv=null);this.G2a=this.jFb=null;this.$Jc=!1;this.Qa&&this.Qa.raiseEvent("ppocek")}jwj(){return this.$.isEditMode&&!!this.AH&&!!this.Ak&&2!==this.Ak.zu&&this.Nhd()}ELd(){d.ULS.shipAssertTag(537154260,0,!!this.pv,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.pv&&this.pv.ELd(this.Ak,this.jwj())}fHa(Rb,Dc="Pdf"){const nd=new Sys.StringBuilder;
nd.append(aa.a(this.$,Dc,!0));H.a.Zg(nd,Ra.a.aFd,""+this.Ak.zu);Rb&&this.Jha.qwc()&&H.a.Zg(nd,Ra.a.deg,"1");H.a.Zg(nd,Ra.a.HJf,this.$.xa.pa.name);0===this.Ak.zu&&(H.a.Zg(nd,Ra.a.GJf,this.selectedRange),H.a.Zg(nd,Ra.a.AJf,this.activeCell));H.a.Zg(nd,Ra.a.BJf,""+this.Ak.orientation);H.a.Zg(nd,Ra.a.CJf,""+this.Ak.gca);H.a.Zg(nd,Ra.a.FJf,""+this.Ak.F_);H.a.Zg(nd,Ra.a.EJf,"1");H.a.Zg(nd,Ra.a.zJf,this.Ak.ignorePrintArea?"1":"0");H.a.Zg(nd,Ra.a.DJf,"1");this.LJg(nd);this.isUniversalPrintEnabled&&H.a.Zg(nd,
Ra.a.M1i,this.Ak.NoColor?"1":"0");this.KJg(nd);ya.a.equals(Dc,"Pdf",!0)&&(nd.append("&#toolbar=0"),nd.append("&zoom=100"));Rb=nd.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");d.ULS.sendTraceTag(537154259,0,50,`PrintPreviewManager: Print Pdf Url ${Rb}`);return Rb}mrj(Rb,Dc){Rb||Dc?(this.eyb=!0,this.uya=Rb,this.Ola=Dc):this.FSf()}LJg(Rb){this.Y0f()&&(H.a.Zg(Rb,Ra.a.O1i,""+this.uya),H.a.Zg(Rb,Ra.a.N1i,""+this.Ola),H.a.Zg(Rb,Ra.a.P1i,"1"),d.ULS.sendTraceTag(537154258,
0,50,`PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from ${this.uya} to ${this.Ola}`))}Y0f(){return null!=this.uya&&0<this.uya&&null!=this.Ola&&0<this.Ola}KJg(Rb){if(this.pv&&this.Ak){const Dc=this.pv.Jed(this.Ak.margin);Dc&&H.a.Zg(Rb,Ra.a.L1i,""+Dc.Top+" "+Dc.Bottom+" "+Dc.Left+" "+Dc.Right+" "+Dc.Header+" "+Dc.Footer)}}HDb(Rb,Dc,nd,od){this.ng&&(d.ULS.shipAssertTag(537154255,0,!!this.$.xa.pa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),
this.$.xa.pa&&(this.o6a?(od||(od=this.fHa(!1)),this.ng.esi(od)):this.vAj()))}Nhd(){return!this.AH.equals(this.Ak)}iAf(){!this.hMb&&0<this.n_&&(this.Dod?this.ELd():d.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));d.ULS.shipAssertTag(537154250,0,!!this.ng,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.ng&&this.ng.z5h();this.$Vd()}oj(){d.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");
if(this.ng){var Rb=this.xQa(y.a.instance.ga(1));this.kAa(Rb,1)}else Rb=ia.a.Yc(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),v.EwaSettings.wz()?new Jb.a(this.$,Rb):(new Pb.ErrorDialog(this.$,Rb)).Ff()}BAj(Rb){Rb?(0===Rb.zu&&this.Vvc()&&(d.ULS.sendTraceTag(537154249,0,50,`PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a $${this.Nm.ObjectId?"floatingObject":"discontinuousRange"}.`),Rb.zu=1),lb.oBe(Rb,this.AH),lb.oBe(Rb,this.Ak),d.ULS.shipAssertTag(537154248,
0,!!this.ng,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),this.ng&&(this.Dod=!0,this.ng.DAj(),this.Lxb())):(d.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.oj())}IZc(Rb,Dc,nd){Rb>Dc&&(Dc=Object(Ca.a)(new Na.a,{extendedProperties:new Map}),Dc.extendedProperties.set("WtpSelectedValue",nd),Dc.extendedProperties.set("FullyRenderedPdfLoadTime",Rb.toString()),Kb.Health.instance.recordQosError(Ua.a.wCj,
[ab.a.w4f],!1,!0,!0,!1,Dc))}xX(){this.IMa&&(0<this.uba||this.p7a)&&(d.ULS.sendTraceTag(537154246,0,50,`PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: ${this.uba}.`),this.$.userOperationManager.ita(this.IMa),this.p7a?D.a.tu(this.p7a.Nt):this.n2.tu(this.uba),this.nKd())}nKd(){this.p7a=this.IMa=null}k$h(){this.yJd&&this.Ak&&(this.G2a=this.$.Ib.Bc("UserAction",(1===this.Ak.zu?"ActiveSheet":0===this.Ak.zu?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))}FSf(){this.eyb=
!1;this.uya=1;this.Ola=this.lEd}xQa(Rb){if(Rb)return Rb.replace("&#39;","'");d.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return Rb}vAj(){d.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.ezb)d.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{let Rb=this.xQa(y.a.instance.ga(1218));this.kAa(Rb,3)}}kAa(Rb,Dc,nd=
null){this.ng.Xz(Rb,Dc,nd)}v$h(){this.o6a=this.ezb=!0;d.ULS.sendTraceTag(557061534,0,50,`PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentHost: ${this.ezb}, isPdfPreviewSupportedInPreviewer: ${this.o6a}`)}wfj(){this.m7a=null;this.nKd();this.FSf();this.jFb=this.$.Ib.Bc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.pa.activeCell.toString();this.n_=0;this.Dod=this.G5a=this.hMb=!1;this.$Jc=!0}lyj(){const Rb=this.Dmi()||this.Qmi();d.ULS.sendTraceTag(537154242,
0,50,`PrintPreviewManager.ShouldUseMSPdfViewer : ${Rb}`);return Rb}$Vg(){let Rb=15;A.a.JH&&A.a.fsb&&(Rb=parseFloat(A.a.fsb));return 14<Rb&&this.ezb}Dmi(){var Rb;if(v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ModifyTeamsHostCheck",!1)){const Dc="teams"===(null===(Rb=f.AFrameworkApplication.fa.appSettings[f.AFrameworkApplication.j7])||void 0===Rb?void 0:Rb.toLowerCase());d.ULS.sendTraceTag(512350017,0,50,`PrintPreviewManager:isTeamsHost - isElectron: ${A.a.pz} isTeamsUIHost: ${Dc} isUnifiedHostMode: ${f.AFrameworkApplication.isUnifiedHostMode}`);
return A.a.pz||Dc}return A.a.pz||f.AFrameworkApplication.isUnifiedHostMode}Qmi(){return!this.$.me.get(111)}tTf(){this.m7a&&(URL.revokeObjectURL(this.m7a),this.m7a=null)}o4g(Rb){var Dc=Rb.data.Vd;Rb=this.$.Ib.Bc("UserAction","PrintPreviewBlobFileCreation");var nd=window.self.atob(Dc);Dc=new Uint8Array(Dc.length);for(let od=0;od<nd.length;od++)Dc[od]=nd.charCodeAt(od)&255;nd=new Blob([Dc],{type:"application/pdf"});this.m7a=URL.createObjectURL(nd);d.ULS.sendTraceTag(537154241,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : ${Rb.uc} ms. Blob size: ${nd.size}`);
Rb.stop();return this.m7a+"#toolbar=0&zoom=100"}W5i(Rb){if(this.yJd&&ia.a.jh(Rb,Bb.GWi)){const Dc=Object(Ca.a)(new Na.a,{extendedProperties:new Map});Dc.extendedProperties.set("ErrorMessageIdName",Rb[0].MessageIdName);Kb.Health.instance.recordQosError(Ua.a.jIf,[ab.a.kIf],!1,!0,!0,!1,Dc)}}n4h(Rb,Dc){return Rb.sheetPrintOptions.PrintGrid!==Dc.selectedPrintGridlines||Rb.sheetPrintOptions.HorizontalCenter!==Dc.selectedHorizontalCenter||Rb.sheetPrintOptions.VerticalCenter!==Dc.selectedVerticalCenter||
Rb.sheetPrintOptions.PrintHeaders!==Dc.selectedRowAndColumnHeadings}$Vd(){this.Cod&&this.$.ud(-1753588160,-1,0,null)}dei(){return!!this.$.ya&&!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier}getToken(){d.ULS.sendTraceTag(522314589,0,50,"PrintPreviewManager:GetToken: Token requested for universal print graph service");return this.eDb.wO("Print",this.graphServiceEndpoint).then(Rb=>Rb?(Rb.IsSuccess?d.ULS.sendTraceTag(522314588,0,50,"PrintPreviewManager:GetToken: successfully acquired token for universal print graph service"):
d.ULS.sendTraceTag(537154240,0,15,`PrintPreviewManager:GetToken: failed to get token. Error code: ${Rb.ErrorCode}, Error message : ${Rb.ErrorMessage}`),Rb):Object(Ca.a)(new Ab.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})).catch(Rb=>{let Dc=new Ab.a;Object.getType(Rb)===Object.getType(Dc)?Dc=Rb:(Dc.ErrorMessage=Rb.toString(),Dc.ErrorCode="exception");return Promise.resolve(Dc)})}M9b(){return()=>{const Rb=Promise.resolve("");try{if(this.eDb&&this.eDb.t5a())return this.getToken().then(Dc=>
Dc.IsSuccess?Promise.resolve(Dc.Token):Rb,()=>Rb)}catch(Dc){d.ULS.sendTraceTag(537154211,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token")}return Rb}}onNotifyPrintJobStatus(Rb,Dc){Rb=Oc.a.fC.notificationBar.A2(Rb,!1);"pending"==Dc&&(Rb.displayTimeoutSeconds=3);if(v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactToast",!1))switch(Dc){case "failure":Rb.image=1;break;case "success":Rb.image=3;break;default:Rb.image=0}else Rb.image=0;Oc.a.fC.notificationBar.gC(Rb)}}
Bb.GWi=[-953554093,1773721536,-1104435974,-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];Bb.b$c=["Content-Type","Total-Pdf-PageCount"];Object(b.a)(Bb,"PrintPreviewManager",null,[796,2,797]);class Nb{constructor(Rb,Dc,nd){this.ignorePrintArea=!1;this.zLj=()=>{const od=x.g(this.$).Ea;this.GPc=!0;od.uxd()};this.FOi=()=>{this.$gd()};this.EOi=(od,wd,Pc)=>{d.ULS.sendTraceTag(537154272,0,10,`PrintCommandHandler:OnPageLayoutCommandFailure Method : ${Pc} failed to execute`);
this.$gd()};this.$=Rb;this.ea=Rb.ea;this.Jha=Dc;this.GN=new mb(1,this.ignorePrintArea);this.wD=Dc=new Bb(Rb,Dc,f.AFrameworkApplication.vd,nd);this.$.da.Ga(418,Dc);this.hIf=new yb(Rb);this.$.da.Ga(384,this);this.GPc=!1}get e1f(){return this.GPc}Nc(){return!1}executeCommand(Rb,Dc,nd,od){const wd=Dc.command;return 1588554917===wd||1531172830===wd||-2050819419===wd?(Dc.pyb=!0,B.a(this.$)&&this.$.da.za(423).Jwc(!1),this.ygh(Dc)?Ya.Task.Ta(!0):u.a(wd)):this.hIf.executeCommand(Rb,Dc,nd,od,this.FOi,this.EOi,
this.zLj)}Cc(Rb,Dc){switch(Dc.command){case 1588554917:return d.ULS.shipAssertTag(537154305,0,this.$.Vja,"Command execute requested for Print operation when data duplication is disallowed."),!0;case 1531172830:return v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExportToPdf",!1)&&v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1);case -2050819419:return v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SaveAsPDF",!1)&&v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",
!1);default:return this.hIf.Cc(Rb,Dc)}}Rc(){return!1}ygh(Rb){return this.$.ea.fc?this.zgh(Rb):!1}zgh(Rb){d.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");const Dc=this.$.Ib.Bc("UserAction","DoPrintHtml");var nd=this.$,od=this.ea.isNamedObjectViewMode?nd.zb.pa.sheetName:nd.xa.pa.name;const wd=this.ea.isNamedObjectViewMode,Pc=!wd;nd=this.ETh(nd,od,Pc);let Hb=!0;!v.EwaSettings.isChangeGateEnabled("OfficeVSO:5315453_MoveWebpartsSessionsToPreviewer")&&this.$.bwa&&(Hb=!1);Pc?Hb?z.a(this.$)?
d.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened."):(od=1531172830===Rb.command||-2050819419===Rb.command,this.wD.AAj(nd,this.GN,od),d.ULS.sendTraceTag(591196515,0,50,`PrintCommandHandler:DoPrintHtml Print previewer opened. isExportPdfMode: ${od} Command: ${n.a[Rb.command]}`)):((new bb(this.$,y.a.instance.ga(1226),3,nd,Rb,this.Jha,od,this.GN)).Ff(),d.ULS.sendTraceTag(595194760,0,50,`PrintCommandHandler:DoPrintHtml Print dialog shown in pdf mode in ${Dc.uc} ms.`)):
((new oa(this.$,y.a.instance.ga(1226),3,nd,Rb)).Ff(),d.ULS.sendTraceTag(591196514,0,15,`PrintCommandHandler:DoPrintHtml Print dialog shown in html mode in ${Dc.uc} ms. isNamedObjectViewMode: ${wd}.`));Dc.stop();this.$gd();return!0}ETh(Rb,Dc,nd){const od={};od.SessionId=this.ea.sessionId;od.UsedRangeTooBig=!1;var wd=x.g(Rb);const Pc=wd.ha,Hb=Pc.Je;if(w.e(Rb.pa))od.Type=0,od.ObjectId=Rb.pa.name,od.UseSelection=!1;else if(w.g(Rb.pa))od.Type=1,od.ObjectId=Rb.pa.WKa,od.UseSelection=!0;else if(2===Hb||
4===Hb||64===Hb)wd=Pc.Pa.$b.floatingObject,od.Type=1,od.SheetName=Dc,od.ObjectId=wd.id,od.UseSelection=!0;else if(nd&&Hb&470)od.ObjectId=Pc.Pa.$b.floatingObject.id,od.SheetName=Dc;else if(w.i(Rb.pa)){od.Type=2;od.SheetName=Dc;if(Pc.sa.wg)if(nd=Pc.sa.Wc,od.SelectedRanges=r.q(nd,Rb),20<nd.WG)od.UseSelection=!0;else{Dc=0;wd=wd.mk("PrintCommandHandler.DoPrintHtml",nd);try{for(wd.$$rst();wd.$$mn()&&2>Dc;)wd.$$cu().text&&Dc++;od.UseSelection=2<=Dc}finally{wd&&wd.dispose()}}else od.UseSelection=!1,od.SelectedRanges=
r.q(Pc.sa.activeRange,Rb);this.ea.isNamedObjectViewMode&&(od.UsedRange=r.v(Rb.pa.usedRange,Rb))}od.Title=Rb.workbookContext.WorkbookFileName;return od}$gd(){x.g(this.$);if(!this.e1f){this.GPc=!0;const Rb=this.$.Ib.Bc("UserAction","HandlePageLayoutRendering");this.RLj();d.ULS.sendTraceTag(537154274,0,50,`PrintCommandHandler:HandlePageLayoutRendering rendering is done in ${Rb.uc} ms.`);Rb.stop()}}RLj(){const Rb=x.g(this.$).Ea,Dc=Rb.cF();let nd=!1,od=0;for(let wd=0;wd<Dc.length;wd++){const Pc=Dc[wd],
Hb=Pc.tf;Hb&&Hb.hasPageLayout()&&(nd=!0,Hb.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+Pc.Od,4),od++)}nd&&(d.ULS.sendTraceTag(537154273,0,50,`PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is ${Dc.length}, number of blocks that require re-rendering is ${od}`),Rb.uxd())}}Object(b.a)(Nb,"PrintCommandHandler",null,[195,782]);var dc=a(1072),sc=a(1279),yc=a(1280);class cd extends k.a{constructor(Rb){super(Rb)}yd(){var Rb=f.AFrameworkApplication.fa.appSettings,
Dc=this.$.ya.DirectPrintSetting;Rb.DirectPrintIsEnabled=Dc.DirectPrintIsEnabled.toString();Rb.DirectPrintProbeIsEnabled=Dc.DirectPrintProbeIsEnabled.toString();Rb.DirectPrintEnabledForInternetExplorer=Dc.DirectPrintEnabledForInternetExplorer.toString();Rb.DirectPrintSupportedMimeTypes=Dc.DirectPrintSupportedMimeTypes;Rb.DirectPrintSupportedPlugins=Dc.DirectPrintSupportedPlugins;Rb.DirectPrintImmersivePreviewPlugins=Dc.DirectPrintImmersivePreviewPlugins;Rb.DirectPrintMinimalSupportedEdgeVersion=Dc.DirectPrintMinimalSupportedEdgeVersion;
Rb.DirectPrintEnabledForEdge=Dc.DirectPrintEnabledForEdge.toString();Rb=new dc.a(Rb);let nd=null;Dc=null;try{Dc=window.navigator.mimeTypes}catch(wd){d.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}let od=null;try{od=window.navigator.plugins}catch(wd){d.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}nd=new yc.a(Rb,Dc,od,yc.a.Tbf,yc.a.ugf,new sc.a(f.AFrameworkApplication.ta.vW),f.AFrameworkApplication.ta.MD,yc.a.vgf,(wd,Pc)=>new e.a(wd,!1,Pc),
!1);if(v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.me.get(116)){const wd=l.GetServiceTaskFactory.Ra(this.$.da,349,350,this.hb);m.TaskExtensions.Aa(wd,()=>{const Pc=new Nb(this.$,nd,wd.result);this.gd([Pc])},this.$.la)}else this.gd([new Nb(this.$,nd,null)])}static ka(Rb){k.a.Nd(73,new cd(Rb))}}Object(b.a)(cd,"PrintCommandHandlerFactory",k.a,[]);a.d(C,"a",function(){return pd});const pd=()=>{c.a.Fa(cd.ka)}},1141:function(t,C,a){var c=a(10),b=a(0),d=a(221),
f=a(50),e=a(37),k=a(15),l=a(86),m=a(84),v=a(240),n=a(618),w=a(208),r=a(121),u=a(35),y=a(39),x=a(235),B=a(42),z=a(6),A=a(36),I=a(68),F=a(585);class U extends x.a{constructor(Ma,Tb){super(Ma);this.aUj=["id","sessionId","workbookType","workbookFileType","dataloss"];this.command=0;this.TDb=()=>{const zb=this.OMh();if(zb){this.$.kI(!0);if(-2028960985!==this.command&&1461300262!==this.command){const ic=I.a(this.$).jd.activityState;ic[A.a.LXa]=z.a.download;ic[F.a.FSc]=this.command}B.a(this.$).vr(zb.Errors)}};
this.iframe=Ma;this.$=Tb;this.Gc.ka("load",this.TDb)}get Z6h(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}downloadFile(Ma,Tb){const zb={};(Ma=this.nxh(Ma,zb))&&y.a.Woc("dlfr",Ma,zb);this.command=Tb}nxh(Ma,Tb){var zb=Ma.split("?");if(2!==zb.length)return Ma=null,k.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),Ma;zb=zb[1].split("&");for(const Qb of zb){var ic=
Qb.split("=",2);if(2!==ic.length){Ma=null;k.ULS.sendTraceTag(537154787,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}zb=ic[0];this.aUj.includes(zb)&&(ic=decodeURIComponent(ic[1]),Tb[zb]=ic,Ma=w.a.BHb(Ma,zb))}return Ma}reset(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262}OMh(){try{return this.iframe.contentWindow.ewaResult}catch(Ma){if(!this.$.ea.jc.isDivSyndicated){const Tb=window.document.referrer.match(RegExp("://(.[^/]+)/"));
k.ULS.sendTraceTag(537154785,0,50,`FileLoader.OnFrameLoad: parent domain: ${1<Tb.length?Tb[1]:""}, current domain: ${escape(window.location.host)}, iframe domain: ${escape(this.iframe.contentWindow.location.host)}. ewaControl IsCrossDomain: ${this.$.bwa}`);throw Ma;}return null}}static ure(Ma){let Tb=document.createElement("iframe");Tb.id="ewaFileLoader";Tb.style.cssText="height:0;width:0;display:none";Tb.src="about:blank";Tb.setAttribute("name","dlfr");Tb=Ma.domElement.appendChild(Tb);return new U(Tb,
Ma)}}Object(b.a)(U,"FileLoader",x.a,[]);var X=a(140),S=a(55);class H{constructor(Ma,Tb){this.Xc=()=>{u.a.og(I.a(this.$).jd.activityState,X.a.Wxd)||this.$ta.reset()};this.$=Tb;this.ojc=Ma;this.ea=Tb.ea;this.ea.jk(this.Xc);this.$ta=U.ure(this.$)}ehh(){const Ma=this.FRg(this.$),Tb=this.$.userOperationManager.operationCount;0<Tb&&k.ULS.sendTraceTag(537154822,0,15,`flushing queue in downloadcopy. Queue is ${Tb}`);this.$.userOperationManager.n3("DownloadACopyOperation.DownloadForkedFile");this.ojc&&k.ULS.sendTraceTag(537154821,
0,50,"DownloadACopyOperation - Dataloss scenario");this.$ta.downloadFile(Ma,-21742208);e.TaskExtensions.Aa(S.Task.delay(1),()=>{this.t8e()},this.$ta.la,3)}dispose(){this.ea&&this.ea.Ik(this.Xc);this.$=this.ea=null}t8e(Ma=null){Ma||(Ma=this.$.Ib.Bc("LoadResource","DownloadACopyOperation"));!this.$ta.Z6h&&Ma.uc<H.xof?window.setTimeout(()=>{this.t8e(Ma)},H.fhh):(Ma.uc>=H.xof&&k.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),I.a(this.$).jd.mM())}FRg(Ma){const Tb=new Sys.StringBuilder,
zb=Ma.workbookContext,ic=Ma.ya;Tb.append(Ma.nda);Tb.append(ic.FileHandlerRelativeUri);Tb.append("?id=");Tb.append(encodeURIComponent(w.a.BHb(zb.WorkbookUri,"sc")));Ma.ea.fc&&(Tb.append("&sessionId="),Tb.append(encodeURIComponent(Ma.ea.sessionId)));Tb.append("&workbookType=FullForkedWorkbook");Tb.append("&dataloss=");Tb.append(this.ojc?"true":"false");r.a.JYa(Tb,ic);return Tb.toString()}}H.xof=1E5;H.fhh=100;Object(b.a)(H,"DownloadACopyOperation",null,[2]);class D extends v.a{constructor(Ma,Tb,zb=!1){super(Ma,
Tb);this.LBb=null;this.qAd=ic=>{this.unsubscribe(Qb=>{ic.remove_disposing(Qb)});this.fh(z.a.Jj);this.vp()};this.ojc=zb}execute(Ma){const Tb=Object(m.a)(7,Ma.Ae);if(!Tb.Vja)return k.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.gld(Ma),this.fh(z.a.idle),1;this.LBb||(this.LBb=new H(this.ojc,Tb));this.LBb.ehh();k.ULS.shipAssertTag(537154817,0,3!==I.a(Tb).di.Zt,"The current activity should not be closed.");return 1}gld(Ma){const Tb=
Object(m.a)(7,Ma.Ae),zb=new n.a(Tb);this.subscribe(Ma,this.qAd,ic=>{zb.add_disposing(ic)});k.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");zb.initialize();zb.Ff()}dispose(){l.a.Ia(this.LBb);this.LBb=null;super.dispose()}}Object(b.a)(D,"DownloadAForkedCopyActivity",v.a,[]);class J extends d.a{constructor(Ma){super();this.$=Ma;this.Fb()}create(){e.TaskExtensions.Aa(f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),
()=>{this.qb(new D(z.a.g1a,z.a.Jj,!0))},this.la)}}Object(b.a)(J,"DownloadACopyPreDatalossActivityFactory",d.a,[]);class M extends d.a{constructor(Ma){super();this.$=Ma;this.Fb()}create(){e.TaskExtensions.Aa(f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),()=>{this.qb(new D(z.a.unmergeableDownloadCopy,z.a.Zna))},this.la)}}Object(b.a)(M,"DownloadAForkedCopyActivityFactory",d.a,[]);var G=a(83),T=a(4),K=a(80),L=a(27),V=a(106),W=a(25);class da{constructor(Ma,Tb,zb){this.La=Ma;this.Iqg=Tb;
this.b1=zb}Gg(){this.La.Ob(W.a.tryMacOffice,V.a.frame,Object(G.a)(this,this.DSi,"onTryMacOffice"));this.La.Ob(W.a.aag,V.a.frame,Object(G.a)(this,this.oDf,"onTryMacOfficeFromViewer"));this.La.Ob(W.a.$$f,V.a.frame,Object(G.a)(this,this.oDf,"onTryMacOfficeFromViewer"))}DSi(Ma,Tb,zb,ic,Qb){if(1===zb)return 32;Qb?(Ma=Qb.SourceControlId,"btnjTryMacOfficeForWordEditor"===Ma?y.a.Ve(K.a.MY(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===Ma&&y.a.Ve(K.a.MY(22),"_blank",
void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.vjf();return 32}oDf(Ma,Tb,zb){if(1===zb)return 32;switch(Ma){case W.a.aag:y.a.Ve(K.a.MY(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case W.a.$$f:y.a.Ve(K.a.MY(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}vjf(){y.a.Ve(da.Swi,"_blank",void 0,"LaunchMacTrialWindow")}get cwc(){return this.Iqg&&L.a.isMac&&!L.a.Kji&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get Iwj(){return this.cwc}static get Swi(){return K.a.sH("522401")}}
Object(b.a)(da,"MacOfficeOffer",null,[310]);var qa=a(82);class O{constructor(Ma,Tb,zb){this.La=Ma;this.Mqg=Tb;this.KDc=null;(this.uWb=T.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&qa.a.instance.Wb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ic=>{this.KDc=ic});this.b1=zb}Gg(){this.La.Ob(W.a.tryOffice,V.a.frame,Object(G.a)(this,this.ESi,"onTryOffice"));this.La.Ob(W.a.tryOfficeThroughTellMe,
V.a.frame,Object(G.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.Ob(W.a.dag,V.a.frame,Object(G.a)(this,this.eag,"tryOfficeThroughViewer"));this.La.Ob(W.a.cag,V.a.frame,Object(G.a)(this,this.eag,"tryOfficeThroughViewer"))}ESi(Ma,Tb,zb,ic,Qb){if(this.uWb&&1===zb)return this.isFreemiumUpsellEnabled&&this.XKb?32:8;2===zb&&(Qb?(Ma=Qb.SourceControlId,"btnjTryOfficeForWordEditor"===Ma?y.a.Ve(K.a.MY(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===
Ma?y.a.Ve(K.a.MY(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.pic()):this.pic());return 32}tryOfficeThroughTellMe(Ma,Tb,zb,ic,Qb){if(this.uWb&&1===zb)return this.isFreemiumUpsellEnabled&&this.XKb?32:8;2===zb&&(Qb?(Ma=Qb.SourceControlId,y.a.Ve(K.a.sH("862405")+this.JSh(Ma),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):y.a.Ve(K.a.sH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}eag(Ma,Tb,zb){if(this.uWb&&1===zb)return this.isFreemiumUpsellEnabled&&
this.XKb?32:8;if(2===zb)switch(Ma){case W.a.dag:y.a.Ve(K.a.MY(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case W.a.cag:y.a.Ve(K.a.MY(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get psf(){return this.XKb}get nEi(){return this.XKb&&MSOJS.ClientUtils.OfferOfficeInDialog()}get XKb(){return this.Mqg&&!L.a.isMac}get isFreemiumUpsellEnabled(){let Ma=!1;this.KDc&&(Ma=this.KDc.isFreemiumUpsellEnabled());return Ma}pic(Ma=null){let Tb=0;Ma&&(Tb=Ma);y.a.Ve(O.uQh(Tb),"_blank",void 0,
"LaunchOfficeOffer")}JSh(Ma){let Tb=0;switch(Ma){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":Tb=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":Tb=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":Tb=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":Tb=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":Tb=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":Tb=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":Tb=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":Tb=
8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":Tb=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":Tb=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":Tb=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":Tb=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":Tb=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":Tb=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":Tb=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":Tb=
26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":Tb=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":Tb=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":Tb=29}return 0===Tb?"":String.format("&pc={0:D}",Tb)}static uQh(Ma){if(L.a.Ug)switch(Ma){case 1:return K.a.sH("393806");case 2:return K.a.sH("393810");case 3:return K.a.sH("393809");case 5:return K.a.sH("393805")}else if(L.a.hp)switch(Ma){case 1:return K.a.sH("521979");case 3:return K.a.sH("521980");case 5:return K.a.sH("521978");
case 2:return K.a.sH("522490")}else{if(2===Ma)return K.a.sH("517778");if(1===Ma)return K.a.MY(30)}return K.a.sH("522402")}}Object(b.a)(O,"OfficeTrialExperience",null,[309]);class ea{Rh(Ma){Ma.register(O,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").tc().Fc(()=>new O(T.AFrameworkApplication.wb,T.AFrameworkApplication.azb,T.AFrameworkApplication.lcid));Ma.register(da,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").tc().Fc(()=>new da(T.AFrameworkApplication.wb,
T.AFrameworkApplication.Hfc,T.AFrameworkApplication.lcid))}}Object(b.a)(ea,"OpenInClientConfiguration",null,[5]);var R=a(550),oa=a(1349),pa=a(38),Pa=a(1188),Z=a(144),Ra=a(151),Ga=a(222),Ba=a(13),fa=a(85),Y=a(108),ja=a(88);const ca=Ma=>{for(let Tb=0;Tb<Ma.children.length;Tb++){const zb=Ma.children[Tb];zb.style.position="relative";zb.style.top=(zb.parentNode.offsetHeight-zb.offsetHeight)/2+"px"}},aa=Ma=>Ma.Ca.keyCode===fa.a.$h||Ma.Ca.keyCode===fa.a.moa?(Ma.Cb.click(),!0):!1,ta=(Ma,Tb,zb,ic,Qb,wb,hc)=>
{const Za=document.createElement("a");Za.className="ProtocolLaunchingDialogButtonAnchor";Za.className+=" OICDialog";Za.id=Ma;Za.setAttribute(ja.a.Kd,ja.a.Ms);Za.style.padding="0";Za.style.margin="0";ic&&xa(Qb,Tb,zb,ic,Za);Ma=document.createElement("span");Ma.className="ProtocolLaunchingDialogButtonLabel";Ma.innerText=Qb;Za.appendChild(Ma);Za.tabIndex=0;wb&&Ga.a.instance.ra(Ba.a.click,Za,wb);hc&&Y.KeyInputManager.instance.ra(Ba.a.Fd,Za,hc);return Za},xa=(Ma,Tb,zb,ic,Qb)=>{var wb=document.createElement("img");
wb.alt=Ma;wb.className=Ra.getImageClassWithCluster(zb,ic);wb.src=Tb;wb.setAttribute(ja.a.Kd,ja.a.Ns);Ma=document.createElement("span");Ma.className="ProtocolLaunchingDialogImg32Container";Ma.appendChild(wb);wb=document.createElement("span");wb.className="ProtocolLaunchingDialogIconContainer";wb.appendChild(Ma);Qb.appendChild(wb)};class ia{static get ag(){return Z.a.ap(ia.Bk,CommonUIStrings.l_OICLaunchDialogTitle)}}ia.Bk="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(ia,"OICLaunchDialogHtml",null,[]);class ya extends Z.a{constructor(Ma){super();this.oUa=this.bCa=null;this.ipa=!1;this.kq=Ma;this.ag=ia.ag;this.Rb=5;this.ze="OICLaunchDialog";this.showDialog("",Object(G.a)(this,this.GEi,"oicLaunchDialogResultHandler"));this.yZf();this.jW("ProtocolLaunchingDialogTitle");4!==T.AFrameworkApplication.ta.Oa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.yI(this.bCa);k.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}l9a(){this.bCa=ta("BtnRichClient",this.kq.Mrb,this.kq.hxb,this.kq.Ajd,CommonUIStrings.l_OICLaunchRichClient,Object(G.a)(this,this.cBf,"onRichClientButtonClick"),aa);document.getElementById("OICLaunchRichClient").appendChild(this.bCa);ca(this.bCa);this.oUa=ta("BtnReturn",this.kq.Mrb,this.kq.hxb,this.kq.G8e,CommonUIStrings.l_OICReturnToOnlineClient,Object(G.a)(this,this.$Af,"onReturnButtonClick"),
aa);document.getElementById("OICReturnToApp").appendChild(this.oUa);ca(this.oUa)}$Af(){this.hide();this.kq.xbb();return!0}cBf(){k.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();T.AFrameworkApplication.wb.processAction(W.a.jQa,2);return!0}GEi(){this.kq.xbb()}dispose(){this.ipa||(this.bCa&&(Ga.a.instance.Ba(Ba.a.click,this.bCa,Object(G.a)(this,this.cBf,"onRichClientButtonClick")),Y.KeyInputManager.instance.Ba(Ba.a.Fd,this.bCa,aa)),this.oUa&&(Ga.a.instance.Ba(Ba.a.click,
this.oUa,Object(G.a)(this,this.$Af,"onReturnButtonClick")),Y.KeyInputManager.instance.Ba(Ba.a.Fd,this.oUa,aa)),super.dispose(),this.ipa=!0)}}Object(b.a)(ya,"OICLaunchDialog",Z.a,[]);class ib{static get ag(){return Z.a.ap(ib.Bk,CommonUIStrings.l_OICDialogTitle)}}ib.Bk="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(ib,"ProtocolLaunchingDialogV2Html",null,[]);a(414);var wa=a(107);class sa extends Z.a{constructor(Ma){super();this.nUa=this.vea=null;this.ipa=!1;this.Moa=null;this.kq=Ma;this.ag=ib.ag;this.Rb=5;this.ze="ProtocolLaunchingDialog";this.PFc="OICRetryDialog";T.AFrameworkApplication.zi.B4a&&T.AFrameworkApplication.zi.Isc();T.AFrameworkApplication.zi.Ag(new wa.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(G.a)(this,this.QEd,"protocolLaunchingDialogResultHandler"));
this.yZf();this.jW("Issues");this.aTe();k.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}l9a(){const Ma=document.getElementById("Issues");if(Ma){xa("",this.kq.Mrb,this.kq.hxb,this.kq.Ajd,Ma);const Tb=document.createElement("span");Tb.className="WACDialogSectionTitle";Tb.innerText=5===this.kq.gEf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;Ma.appendChild(Tb);ca(Ma);Ma.style.display="none"}T.AFrameworkApplication.ta.Oa.qgd?
(this.nUa=ta("GiveFeedback",this.kq.Mrb,this.kq.hxb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(G.a)(this,this.fmc,"onGiveFeedbackClick"),Object(G.a)(this,this.kxf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.nUa),ca(this.nUa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===T.AFrameworkApplication.ta.Oa.editMode||T.AFrameworkApplication.Peh?document.getElementById("ButtonEdit").style.display="none":
(this.vea=ta("Edit",this.kq.Mrb,this.kq.hxb,"",2===T.AFrameworkApplication.ta.Oa.xj?4===T.AFrameworkApplication.ta.Oa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===T.AFrameworkApplication.ta.Oa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(G.a)(this,this.Tvf,"onEditClick"),Object(G.a)(this,this.Xvf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.vea),ca(this.vea));0===
T.AFrameworkApplication.ta.Oa.editMode&&!T.AFrameworkApplication.azb&&Ma&&(Ma.style.display="none")}cTe(){return this.Moa?(this.yI(this.Moa),!0):!1}aTe(){return this.vea?(this.yI(this.vea),!0):!1}Xvf(Ma){return this.uyd(Ma,0)}kxf(Ma){return this.uyd(Ma,2)}YAf(Ma){return this.uyd(Ma,1)}uyd(Ma,Tb){let zb=!1;if(Ma.Ca.keyCode===fa.a.$h||Ma.Ca.keyCode===fa.a.moa)Ma.Cb.click(),zb=!0;else if(Ma.Ca.keyCode===Sys.UI.Key.down||Ma.Ca.keyCode===Sys.UI.Key.up)switch(Tb){case 1:zb=this.aTe();break;case 0:zb=this.cTe()}return zb}Tvf(){this.hide();
4===T.AFrameworkApplication.ta.Oa.editMode?(k.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.kq.xbb()):(k.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.kq.Ngd());return!0}fmc(){k.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.kq.B4e();return!0}fnc(){k.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";T.AFrameworkApplication.wb.processAction(W.a.jQa,2);return!0}QEd(){this.kq.xbb()}switchToBackupMode(){var Ma=
document.getElementById("ProtocolLaunchingDialogTitle");if(Ma){Ma.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(Ma=document.getElementById("Issues"))Ma.style.display="block";(Ma=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!Ma.children.length&&(this.Moa=ta("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(G.a)(this,this.fnc,"onRetryOICClick"),Object(G.a)(this,this.YAf,"onRetryOICKeyUp")),Ma.appendChild(this.Moa),ca(this.Moa),this.vea||this.cTe())}}dispose(){this.ipa||(this.vea&&
(Ga.a.instance.Ba(Ba.a.click,this.vea,Object(G.a)(this,this.Tvf,"onEditClick")),Y.KeyInputManager.instance.Ba(Ba.a.Fd,this.vea,Object(G.a)(this,this.Xvf,"onEditKeyUp"))),this.nUa&&(Ga.a.instance.Ba(Ba.a.click,this.nUa,Object(G.a)(this,this.fmc,"onGiveFeedbackClick")),Y.KeyInputManager.instance.Ba(Ba.a.Fd,this.nUa,Object(G.a)(this,this.kxf,"onGiveFeedbackKeyUp"))),this.Moa&&(Ga.a.instance.Ba(Ba.a.click,this.Moa,Object(G.a)(this,this.fnc,"onRetryOICClick")),Y.KeyInputManager.instance.Ba(Ba.a.Fd,this.Moa,
Object(G.a)(this,this.YAf,"onRetryOICKeyUp"))),super.dispose(),this.ipa=!0)}}Object(b.a)(sa,"ProtocolLaunchingDialog",Z.a,[]);var Ya=a(133),bb=a(420);class mb extends Ya.StandardDialog{constructor(Ma){super();this.kq=Ma;this.ze="ProtocolLaunchingDialog";T.AFrameworkApplication.zi.B4a&&T.AFrameworkApplication.zi.Isc();T.AFrameworkApplication.ta.Oa.qgd&&this.qke(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(G.a)(this,this.fmc,"onGiveFeedbackClick"));mb.D5e?(this.Rb=12,this.rc(1,CommonUIStrings.l_CloseFile),
this.rc(2,CommonUIStrings.l_OICDialogContinueHere),this.rc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Rb=4,this.rc(1,CommonUIStrings.l_OICDialogContinueHere),this.rc(2,CommonUIStrings.l_OICDialogLaunchAgain));this.jCb(CommonUIStrings.l_OICDialog2ndTitle,5===this.kq.gEf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(G.a)(this,this.QEd,"protocolLaunchingDialogResultHandler"),null)}fmc(Ma){k.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");
this.mwf(Ma)}fnc(){k.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");T.AFrameworkApplication.wb.processAction(W.a.jQa,2)}QEd(Ma){mb.D5e?3===Ma?this.lTf():2===Ma||0===Ma?this.continueEditing():1===Ma&&this.CYg():2===Ma?this.lTf():(1===Ma||0===Ma)&&this.continueEditing()}CYg(){k.ULS.sendTraceTag(577783557,211,50,"Closing the document");T.AFrameworkApplication.wb.de(W.a.close,2,bb.a)}lTf(){k.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(G.a)(this,this.fnc,"onRetryOICClick"),
0)}continueEditing(){4===T.AFrameworkApplication.ta.Oa.editMode||T.AFrameworkApplication.fa.qa("WordConsumptionViewToEditRedirectIsEnabled")&&1===T.AFrameworkApplication.ta.mode?(k.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.kq.xbb()):(k.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.kq.Ngd())}static get D5e(){return T.AFrameworkApplication.fa.qa("OICDialogThreeActions")&&32===T.AFrameworkApplication.wb.processAction(W.a.close,1)}}Object(b.a)(mb,
"StandardProtocolLaunchingDialog",Ya.StandardDialog,[]);var Ca=a(1232);class $a{}Object(b.a)($a,"EditDocumentInClientParams",null,[]);class Kb{static x6c(Ma,Tb,zb,ic,Qb,wb,hc=!1,Za=!1,ub="",uc=!1,Oc=!1,Bb=!1,Nb="",dc="",sc="",yc=!1){const cd=new $a;cd.DocumentUrl=Ma;cd.Mode=Tb;cd.Options=zb;cd.Application=ic;cd.SilentExternalHandler=hc;cd.EncodeUrl=Za;cd.CorrelationIdForWinClient=ub;cd.NavigateUsingWindowOpen=uc;cd.DescriptiveUnattemptedEnums=Oc;cd.NoBrowserModalDialogs=Bb;cd.SessionOrigin=Nb;cd.CorrelationId=
dc;cd.ClickTime=sc;cd.NewTelemetryDataIsEnabled=yc;MSOJS.ClientUtils.EditDocumentInClient(cd,Qb,wb)}}Object(b.a)(Kb,"ClientUtils",null,[]);var rb=a(98),cc=a(171),nc=a(467),Wb=a(172),Ea=a(816),ua=a(370),ma=a(163),fb=a(69),sb=a(186);class Ua{constructor(Ma){this.pfa=this.o4d=this.uUa=null;this.Nhb=!1;this.ILc=this.lbe=null;this.eQb=this.UD=this.mVb="";this.application=this.VB=0;this.xGj=this.ITd=!1;this.eUj=Ma&&T.AFrameworkApplication.fa.qa("OICLaunchDialogIsEnabled");T.AFrameworkApplication.wb.s3(W.a.jQa)||
T.AFrameworkApplication.wb.Ob(W.a.jQa,V.a.frame,Object(G.a)(this,this.Zgj,"retryOpenInClientAction"));this.a4f=!!T.AFrameworkApplication.fa&&T.AFrameworkApplication.fa.qa("SilentExternalHandler")}get gEf(){return this.VB}qvc(Ma,Tb="",zb=""){this.UD=zb||Wb.a.create().toString();this.mVb=Tb||nc.a.h_e();this.eQb=Ma}Zgj(Ma,Tb,zb){return Tb.contextId!==V.a.frame?2:1===zb?32:this.jQa()}get options(){let Ma=0;T.AFrameworkApplication.Wej&&(Ma|=1);T.AFrameworkApplication.openInClientEditOnly&&(Ma|=4);this.uGj()&&
(Ma|=64);return Ma}uGj(){return!(2===this.application&&T.AFrameworkApplication.fa.qa("IsEmbeddedScenario"))}get Mrb(){return T.AFrameworkApplication.fB}get hxb(){return T.AFrameworkApplication.Y4a}get G8e(){return""}get Ajd(){return""}get i7f(){return T.AFrameworkApplication.fa.qa("OneNoteMobileViewerIsEnabled")}get Nyc(){return this.lbe||(this.lbe=qa.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.ITd||this.gwh()}xbb(){this.xGj||this.wwh()}YLf(Ma){this.eUj&&L.a.Ug?new ya(this):
this.a2b(Ma)}a2b(Ma){const Tb=({UAa:Ma}=this.Ypi(Ma)).returnValue;k.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===Tb,Ma);return Tb}SFa(Ma,Tb,zb,ic,Qb,wb){this.uUa=Ma;this.o4d=Tb;this.pfa=wb;this.application=zb;this.VB=ic;T.AFrameworkApplication.downloadCopyOnOpenInClient?this.sjf():T.AFrameworkApplication.limitedEdit&&!T.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?T.AFrameworkApplication.w3f():this.mNg(Qb)}get FEi(){return!!T.AFrameworkApplication.fa&&T.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",
!1)}jQa(){this.FEi&&this.Ysi();return this.a2b(this.Nhb)}$Wf(){const Ma=new Ea.a(ma.a.openInClient);Ma.Values["ui-language"]=T.AFrameworkApplication.lcid.toString();Ma.Values[Ca.a.I3c]=T.AFrameworkApplication.userSessionId;return this.pfa.value.send(Ma)?32:8}Ysi(){rb.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new sb.a,{inStaging:!0}))}Gmj(Ma){const Tb=new Ea.a(ma.a.oWj);Tb.Values["ui-language"]=T.AFrameworkApplication.lcid.toString();
Tb.Values[Ca.a.I3c]=T.AFrameworkApplication.userSessionId;Tb.Values[ua.a.nWj]=Ma;this.pfa.value.send(Tb)}Ypi(Ma){this.Nhb=Ma;this.Gmj(5===this.VB?Ua.bUi:Ua.dUi);return 5===this.VB?this.Xpi():this.bqi()}Xpi(){this.yjf();return{returnValue:32,UAa:"HostEditUrl,"}}bqi(){let Ma;var Tb=Ma="";T.AFrameworkApplication.hle&&(Tb="|f|"+T.AFrameworkApplication.userSessionId);const zb=T.AFrameworkApplication.fa.qa("IsAssignmentMode")&&T.AFrameworkApplication.fa.qa("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||
T.AFrameworkApplication.isUnifiedHostMode||L.a.Lwa,ic=T.AFrameworkApplication.fa.qa("UnattemptedEnumIsEnabled"),Qb=T.AFrameworkApplication.fa.qa("NoBrowserModalDialogs");if(T.AFrameworkApplication.wb.Jkc){var wb=T.AFrameworkApplication.wb.UY(3588168074);wb&&this.qvc(wb.epochClickTime,wb.sessionOrigin,wb.correlationId);this.Alf()}if(T.AFrameworkApplication.iHf){Ma+="NewOrder,";wb=8;this.pfa&&this.pfa.value&&this.pfa.value.isEnabled()&&T.AFrameworkApplication.sYd&&(Ma+="Post,",wb=this.$Wf());if(32===
wb)return{returnValue:wb,UAa:Ma};k.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return T.AFrameworkApplication.hm.P9a?(k.ULS.shipAssertTag(5566816,211,!!T.AFrameworkApplication.hm.P9a),Ma+="HostUrl,",{returnValue:T.AFrameworkApplication.ta.C8a(T.AFrameworkApplication.hm.P9a),UAa:Ma}):this.uUa?(k.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",T.AFrameworkApplication.userSessionId),Ma+="DocUrl,",Kb.x6c(this.uUa,this.VB,
this.options,this.application,Object(G.a)(this,this.Wvf,"onEditInClientSuccess"),Object(G.a)(this,this.Vvf,"onEditInClientFailure"),this.a4f,T.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),Tb,zb,ic,Qb,this.mVb,this.UD,this.eQb,T.AFrameworkApplication.wb.Jkc),{returnValue:32,UAa:Ma}):{returnValue:8,UAa:Ma}}Ma+="OldOrder,";if(!this.uUa&&T.AFrameworkApplication.hm.P9a)return this.pfa&&this.pfa.value&&this.pfa.value.isEnabled()&&T.AFrameworkApplication.sYd?(Ma+="Post,",Tb=this.$Wf()):(k.ULS.sendTraceTag(22595483,
211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),Tb=8),32!==Tb?(k.ULS.shipAssertTag(22595484,211,!!T.AFrameworkApplication.hm.P9a),Ma+="HostUrl,",{returnValue:T.AFrameworkApplication.ta.C8a(T.AFrameworkApplication.hm.P9a),UAa:Ma}):{returnValue:Tb,UAa:Ma};k.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",T.AFrameworkApplication.userSessionId);Ma+="DocUrl,";Kb.x6c(this.uUa,this.VB,this.options,this.application,Object(G.a)(this,this.Wvf,"onEditInClientSuccess"),
Object(G.a)(this,this.Vvf,"onEditInClientFailure"),this.a4f,T.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),Tb,zb,ic,Qb,this.mVb,this.UD,this.eQb,T.AFrameworkApplication.wb.Jkc);return{returnValue:32,UAa:Ma}}gRf(Ma){T.AFrameworkApplication.Bn.setDw(8981,Ma)}Wvf(Ma){this.gRf(Ma);k.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===Ma&&MSOJS.ClientUtils.ShouldShowDialog()?(this.i7f||this.yjf(),this.Alf()):this.ITd||this.closeApplication()}Vvf(Ma,Tb=0){k.ULS.sendTraceTag(18715407,
211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",Ma,Tb);if(5===Ma)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const zb=!!this.o4d&&!this.Nhb;let ic=0;1===Ma&&(ic=2);6<=Ma&&13>=Ma&&(ic=1,1===Tb&&(this.ITd=!0));this.Nyc.nEi?(k.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",ic),Pa.a.instance.C7g(this.Nhb?Object(G.a)(this,this.Ksf,"oicErrorDialogHandlerCloseForced"):Object(G.a)(this,this.Lsf,"oicErrorDialogHandlerNoCloseForced"),
zb?Object(G.a)(this,this.ryf,"onLaunchDownload"):null,this.JGe(!1)?Object(G.a)(this,this.E6h,"iHaveOfficeButtonHandler"):null,ic,Tb)):(k.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",ic),Pa.a.instance.A7g(this.Nhb?Object(G.a)(this,this.Ksf,"oicErrorDialogHandlerCloseForced"):Object(G.a)(this,this.Lsf,"oicErrorDialogHandlerNoCloseForced"),zb?Object(G.a)(this,this.ryf,"onLaunchDownload"):null,ic))}}Alf(){try{const Ma=[Object.assign(new fb.a,{name:"CorrelationId",string:this.UD}),
Object.assign(new fb.a,{name:"SessionOrigin",string:this.mVb}),Object.assign(new fb.a,{name:"ClickTime",string:this.eQb}),Object.assign(new fb.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];cc.a("OpenInClientCompleted",!0,0,Ma)}catch(Ma){k.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+Ma.toString())}}yjf(){T.AFrameworkApplication.ta&&T.AFrameworkApplication.ta.Oa.mv&&T.AFrameworkApplication.fa.qa("StandardProtocolDialogIsEnabled")?new mb(this):new sa(this)}Ksf(){this.closeApplication()}Lsf(){this.xbb()}ryf(){this.sjf()}E6h(){return this.JGe(!0)}JGe(Ma){const Tb=
(L.a.udf||L.a.JH)&&!!T.AFrameworkApplication.m5b;Tb&&Ma&&(y.a.Ve(T.AFrameworkApplication.m5b,"_blank",void 0,"OpenInClient"),this.closeApplication());return Tb}}Ua.dUi="OpenInDesktop";Ua.bUi="OpenInBrowser";Object(b.a)(Ua,"AOpenInClientOperation",null,[]);var ab=a(5),na=a(203),Na=a(77),Va=a(59),Sa=a(321),vb=a(47),Oa=a(45),yb=a(190),Ob=a(90),Ja=a(29),lb=a(11),Pb=a(21),Jb=a(471),Lb=a(249),Ab=a(252),nb=a(149),va=a(584);class db extends Ua{constructor(Ma,Tb,zb){super(!0);this.Qa=new pa.a;this.W5c=this.mTe=
!1;this.b2b=this.Dm=this.Hye=null;this.Xc=()=>{u.a.og(I.a(this.$).jd.activityState,X.a.Wxd)||this.$ta.reset()};this.FIi=ic=>{this.gRf(ic)};this.EIi=()=>{this.kzj()};this.$=Ma;this.ea=Ma.ea;this.$J=Tb;this.businessBar=zb;this.ea.jk(this.Xc);this.$ta=U.ure(this.$);this.t0g();Ma.da.Ga(55,this);this.Ifa=qa.a.instance.Wb("Common.ISystemInitiatedFeedback")}get G8e(){return"EditInExcelWebApp_32x32x32"}get la(){this.Dm=this.Dm||new yb.a;return this.Dm.token}get Ajd(){return"excel32"}get i7f(){return this.ea.jc.inWebPart}K_g(){this.YLf(this.mTe)}O1g(){const Ma=
this.$;e.TaskExtensions.Aa(this.$J.value,Tb=>{this.SFa(Ma.workbookContext.ClientUrl,T.AFrameworkApplication.sY,1,Ma.isEditMode?2:0,!0,new R.a(()=>Tb.result))},this.la,3)}Ngd(){0!==Va.a.tg.editMode&&(this.$.rb.Zx=!1)}B4e(){const Ma={};Ma[ab.a.b8b]=!1;Ma[ab.a.rU]="OpenInExcel";this.$.ud(802602464,Na.a.Eb,8,Ma)}q1c(){if(this.ea.fc){var Ma=this.$;Ma.isEditMode&&e.TaskExtensions.Aa(this.$J.value,Tb=>{this.SFa(Ma.workbookContext.ClientUrl,T.AFrameworkApplication.sY,1,2,!1,new R.a(()=>Tb.result))},this.la,
3)}}LAe(){this.ea.fc&&e.TaskExtensions.Aa(this.$J.value,Ma=>{this.SFa(this.$.workbookContext.ClientUrl,T.AFrameworkApplication.sY,1,this.$.isEditMode?2:0,!1,new R.a(()=>Ma.result))},this.la,3)}qvc(Ma){super.qvc(Ma)}openInExcelClient(){this.ea.fc&&(this.$.isEditMode||e.TaskExtensions.Aa(this.$J.value,Ma=>{this.SFa(this.$.workbookContext.ClientUrl,T.AFrameworkApplication.sY,1,0,!1,new R.a(()=>Ma.result))},this.la,3))}openInBrowser(){this.ea.fc&&e.TaskExtensions.Aa(this.$J.value,Ma=>{this.SFa(this.$.workbookContext.ClientUrl,
T.AFrameworkApplication.sY,1,5,!1,new R.a(()=>Ma.result))},this.la,3)}downloadFile(Ma){const Tb=this.Mte(Ma);this.$ta.downloadFile(Tb,Ma);this.zti()}zti(){T.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.Ifa&&this.Ifa.execute(Ma=>Ma.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}cEf(Ma,Tb=0){if(this.ea.fc){var zb=this.$;I.a(zb).rLa?this.dEf(Ma,zb):0<Tb?this.nEj(Ma,
zb,Tb):this.l2f(zb)}}SFa(Ma,Tb,zb,ic,Qb,wb){this.$.rb.Zx=!this.$.jc.inWebPart;this.mTe=Qb;this.b2b=null;this.W5c=!1;this.rNg(Ma,Tb,ic,Qb,wb)}a2b(Ma){const Tb=this.$.jc;k.ULS.sendTraceTag(537154775,0,50,`OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:${Tb.inEmbedView}, InWebPart:${Tb.inWebPart}, DivSyndicated:${Tb.isDivSyndicated}, Mode:${this.$.isEditMode?na.a.edit:na.a.view}`);return db.gef()?(this.A1b(),Kb.x6c(this.uUa,this.VB,this.options,1,this.FIi,this.EIi,!1,T.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")),
32):super.a2b(Ma)}gwh(){this.nSf();const Ma=this.$;if(!this.ea.jc.inWebPart&&this.ea.fc&&!Ma.isEditMode){const Tb=new Ob.a(2145659238,Na.a.Eb,this.$.Mc,0,null);this.Hye=vb.a.instance.create(()=>{Ma.Ka.Mb(Tb)},0,Oa.a.eUi)}}dispose(){this.ea&&this.ea.Ik(this.Xc);l.a.qc([this.Qa,this.Hye,this.Dm]);this.$=this.ea=null}wwh(){this.nSf()}sjf(){vb.a.instance.create(()=>{this.$.Ka.Mb(new Ob.a(-2028960985,Na.a.Eb,0,30,null))},0,Oa.a.fUi,!0,!0)}mNg(Ma){const Tb=this.$,zb=I.a(this.$).jd.activityState;zb[Jb.a.vje]=
!0;Tb.isEditMode&&this.ea.fc?(this.A1b(),B.a(Tb).ls(new Lb.a(z.a.Mx,5,()=>{Tb.kI(!1);zb[Ab.a.oq]=z.a.C1b;zb[Jb.a.nzg]=Ma;zb[X.a.L$c]=!0;Tb.isEditMode&&(zb[X.a.WS]=1,zb[X.a.CX]=!0,zb[nb.a.yXb]=!0,zb[nb.a.LSc]=!0);zb[Jb.a.yje]=1455037301}))):this.YLf(Ma)}$4f(){const Ma=T.AFrameworkApplication.sY;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.C8a(Ma,!0)){const Tb=this.$.ea.jc;k.ULS.sendTraceTag(537154773,0,50,`Url:[${Ma}] IsEmbedded:[${Tb.inEmbedView}] InWebPart:[${Tb.inWebPart}] DivSyndicated:[${Tb.isDivSyndicated}], Mode:[${this.$.isEditMode?
na.a.edit:na.a.view}]`)}}else this.$ta.downloadFile(Ma,-2028960985);this.W5c=!0;this.A1b()}vqi(){this.Nyc.psf&&this.Nyc.pic(1)}wqi(){this.Nyc.psf&&lb.HelperMethods.Ve(K.a.MY(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")}Fqi(){lb.HelperMethods.Ve(K.a.MY(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")}Gqi(){lb.HelperMethods.Ve(K.a.MY(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")}Mte(Ma){const Tb=new Sys.StringBuilder,zb=this.$.workbookContext,
ic=this.$.ya;Tb.append(this.$.nda);Tb.append(ic.FileHandlerRelativeUri);Tb.append("?id=");Tb.append(encodeURIComponent(w.a.BHb(zb.WorkbookUri,"sc")));this.$.ea.fc&&(Tb.append("&sessionId="),Tb.append(encodeURIComponent(this.$.ea.sessionId)));switch(Ma){case -974518828:Tb.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:Tb.append("&workbookType=FullWorkbook");break;case -1059172980:Tb.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:Tb.clear()}r.a.JYa(Tb,
ic);return Tb.toString()}t0g(){oa.a.instance.CWg();const Ma=this.$.ya;MSOJS.ClientUtils.InitUrls(Ma.RoamingAppsX86RootUrl,Ma.RoamingAppsControlInstallerUrl,Ma.RoamingAppsFirefoxExtensionUrl)}nSf(){const Ma=this.$;this.ea.fc||Sa.a.UEd(Ma,I.a(Ma).jd);this.A1b();this.b2b&&this.b2b(this,this.W5c);Ma.frame.xt.gm(this.$.frame.gaa());Ma.frame.vW.gm(this.$.frame.gaa());Ma.rb.Zx=!1;Pb.g(Ma).focus()}rNg(Ma,Tb,zb,ic,Qb){const wb=this.$;T.AFrameworkApplication.ta&&!db.gef()&&(wb.frame.xt.jn(wb.frame.gaa()),wb.frame.vW.jn(wb.frame.gaa()));
super.SFa(Ma,Tb,1,zb,ic,Qb)}A1b(){const Ma=this.$;I.a(Ma).di.activityName===z.a.openInExcelClient&&I.a(Ma).jd.mM()}kzj(){const Ma=Ja.a.Yc(1,0,686,687,0,1341525452,"OpenInExcelActiveXError");B.a(this.$).vr([Ma])}nEj(Ma,Tb,zb){let ic=null;const Qb=window.setTimeout(()=>{I.a(Tb).prc(ic);this.l2f(Tb)},zb);ic=()=>{I.a(Tb).rLa&&(I.a(Tb).prc(ic),window.clearTimeout(Qb),this.dEf(Ma,Tb))};I.a(Tb).OTc(ic)}l2f(Ma){const Tb=Ja.a.Yc(1,1,0,701,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");B.a(Ma).vr([Tb])}dEf(Ma,
Tb){B.a(Tb).ls(new Lb.a(z.a.Mx,5,()=>{Tb.kI(!1);const zb=I.a(Tb).jd,ic=zb.activityState;ic[Ab.a.oq]=z.a.eIe;ic[va.a.AXb]=Tb.ea.jc.hasUnsupportedFeaturesForEdit;ic[F.a.FSc]=Ma;zb.$q(Ja.a.L$(this.businessBar.K6c,[1437034227]))}))}static gef(){return 1<Va.a.getRegisteredEwaInstances().length}}Object(b.a)(db,"OpenInExcelOperation",Ua,[286,2]);class Xa extends d.a{constructor(Ma){super();this.$=Ma;this.Fb();Xa.s0g()}create(){if(this.$.da.za(55))this.qb(this.$.da.za(55));else{var Ma=f.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.hb),Tb=f.GetServiceTaskFactory.Ra(this.$.da,5,4,this.hb);e.TaskExtensions.Aa(S.Task.zL(Ma,Tb),()=>{this.qb(new db(this.$,new R.a(()=>f.GetServiceTaskFactory.create(this.$.da,137,this.la,this.hb)),Tb.result))},this.la,3)}}static s0g(){Xa.Nsf||(Xa.Nsf=!0,(new ea).Rh(qa.a.instance),qa.a.instance.resolve("Common.IOfficeTrialExperience").Gg(),qa.a.instance.resolve("Common.IMacOfficeOffer").Gg())}}Xa.Nsf=!1;Object(b.a)(Xa,"OpenInClientFactory",d.a,[]);var gb=a(114),Ha=a(384);class tb extends gb.a{constructor(Ma,
Tb){super(Ma,Tb)}execute(Ma){const Tb=Object(m.a)(7,Ma.Ae);e.TaskExtensions.Aa(f.GetServiceTaskFactory.create(Tb.da,56,Tb.la,0),zb=>{Tb.downloadCopyOnOpenInClient?(Ma.activityState[Ha.a.wje]=!0,zb.result.$4f()):zb.result.O1g()},Tb.la,3);return 1}}Object(b.a)(tb,"OpenInExcelClientActivity",gb.a,[]);class bc extends d.a{constructor(Ma){super();this.$=Ma;Ma.da.Ga(56,new Xa(Ma));this.Fb()}create(){e.TaskExtensions.Aa(f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),()=>{this.qb(new tb(z.a.openInExcelClient,
z.a.idle))},this.la)}}Object(b.a)(bc,"OpenInExcelClientActivityFactory",d.a,[]);a.d(C,"a",function(){return tc});const tc=()=>{c.a.Fa(Ma=>{Ma.da.Ga(57,new bc(Ma));Ma.da.Ga(60,new M(Ma));Ma.da.Ga(63,new J(Ma))})}},1145:function(t,C,a){a.r(C);t=a(0);var c=a(15),b=a(85),d=a(108),f=a(13),e=a(86),k=a(53),l=a(30),m=a(27),v=a(12),n=a(235),w=a(1053),r=a(5),u=a(258),y=a(1054),x=a(705),B=a(1254),z=a(90);class A extends x.a{constructor($a,Kb,rb){super($a,Kb);this.ev=!0;this.command=rb}xo($a){super.xo($a);this.businessBar.$.Ka.Mb(new z.a(this.command,
$a,this.businessBar.$.Mc,10,null))}}Object(t.a)(A,"CommandActionBusinessBarEntry",x.a,[]);class I extends A{constructor($a,Kb,rb){super($a,Kb,rb)}kD($a){super.kD($a)}}Object(t.a)(I,"EditAttemptReadOnlyBusinessBarEntry",A,[]);var F=a(42);class U extends x.a{constructor($a,Kb,rb,cc){super($a,Kb);this.error=rb;this.options=cc;this.error&&this.options&2&&(this.message=this.error.Description);this.error&&this.options&1&&(this.title=this.error.Caption);this.ev=!(cc&4)}xo($a){super.xo($a);this.error.Appearance&=
-33;F.a(this.businessBar.$).vr([this.error])}}Object(t.a)(U,"ErrorBusinessBarEntry",x.a,[]);class X extends U{constructor($a,Kb,rb,cc,nc){super($a,Kb,rb,cc);this.command=nc;this.YY=!0}YZ($a){super.YZ($a);this.businessBar.$.Ka.Mb(new z.a(this.command,$a,this.businessBar.$.Mc,10,null))}}Object(t.a)(X,"ErrorAndCommandBusinessBarEntry",U,[]);var S=a(14);class H{constructor($a,Kb,rb,cc,nc,Wb,Ea,ua,ma){this.dJ=this.x7=this.fS=0;this.wlg=$a;this.FJj=Kb;this.TO=rb;this.Jpg=Ea;this.$hb=l.a.Sv(ma);this.Mng=
ma;this.Blg=ua;0!==cc&&(this.fS=cc);0!==nc&&(this.x7=nc);0!==Wb&&(this.dJ=Wb)}get title(){return H.ga(this.FJj)}get message(){return H.ga(this.TO)}get messageId(){return this.TO}get $Fa(){return this.wlg}get actionButton(){return H.ga(this.fS)}get EFa(){return H.ga(this.x7)}get link(){return H.ga(this.dJ)}get Tk(){return this.Jpg}get NRg(){return this.Blg}get hash(){return this.$hb}get alt(){const {BusinessBarControl:$a}=a(1145);switch(this.Tk){case $a.Zha:return H.ga(26);case $a.eA:return H.ga(25);
case $a.wi:return H.ga(24);default:return H.ga(0)}}get B7c(){return this.Mng}static ga($a){return S.a.instance.ga($a)}}Object(t.a)(H,"EwaBusinessBarEntry",null,[]);class D extends H{constructor($a,Kb,rb,cc,nc,Wb,Ea,ua){super($a,0,Kb,rb,cc,nc,Wb,Ea,ua)}get title(){return""}}Object(t.a)(D,"EwaNoTitleBusinessBarEntry",H,[]);var J=a(71);class M extends x.a{constructor($a,Kb){super($a,Kb);this.YY=this.ev=!0}xo($a){super.xo($a);this.set_visible(!1);this.businessBar.$.oI();this.businessBar.$.Ka.Mb(new z.a(1038998010,
$a,this.businessBar.$.Mc,10,null))}YZ($a){super.YZ($a);this.businessBar.$.Ka.Mb(new z.a(-722953877,$a,this.businessBar.$.Mc,10,null))}kD($a){this.businessBar.removeEntry(55);J.g($a)}}Object(t.a)(M,"ExternalLinksEnableContentBusinessBarEntry",x.a,[]);class G extends x.a{constructor($a,Kb){super($a,Kb);this.ev=!0;this.YY=!1}xo($a){super.xo($a);this.businessBar.$.Ka.Mb(new z.a(-722953877,$a,this.businessBar.$.Mc,10,null))}kD($a){this.businessBar.removeEntry(5);J.g($a)}}Object(t.a)(G,"ExternalLinksShowErrorBusinessBarEntry",
x.a,[]);var T=a(11);class K extends x.a{constructor($a,Kb,rb){super($a,Kb);this.Iwb=rb;this.ev=!0}xo($a){super.xo($a);T.HelperMethods.pV(this.businessBar.$.mG,this.Iwb,this.businessBar.$.$R)}}Object(t.a)(K,"HelpButtonBusinessBarEntry",x.a,[]);class L extends x.a{constructor($a,Kb,rb){super($a,Kb);this.Iwb=rb;this.rva=!0}Ala($a){super.Ala($a);T.HelperMethods.pV(this.businessBar.$.mG,this.Iwb,this.businessBar.$.$R)}}Object(t.a)(L,"HelpTextBusinessBarEntry",x.a,[]);var V=a(77);class W extends x.a{constructor($a,
Kb,rb,cc){super($a,Kb);this.Iwb=rb;this.command=cc;this.rva=!0;this.ev=1461300262!==cc}xo($a){super.xo($a);this.businessBar.$.Ka.Mb(new z.a(this.command,$a,this.businessBar.$.Mc,10,null))}Ala($a){super.Ala($a);const Kb=new z.a(-859308420,$a,this.businessBar.$.Mc,12,null);this.businessBar.$.Ka.Mb(Kb,{[V.a.Zf]:"HelpID="+this.Iwb,["InputMethod"]:$a,[V.a.Pc]:r.a.oQ,[r.a.Hda]:!0})}}Object(t.a)(W,"HelpTextTaskPaneAndCommandBusinessBarEntry",x.a,[]);class da extends x.a{constructor($a,Kb){super($a,Kb);this.YY=
this.ev=!0}xo($a){super.xo($a);this.set_visible(!1);this.businessBar.$.oI();this.businessBar.$.Ka.Mb(new z.a(-1081442996,$a,this.businessBar.$.Mc,10,null))}YZ($a){super.YZ($a);this.businessBar.$.Ka.Mb(new z.a(1702917262,$a,this.businessBar.$.Mc,10,null))}kD($a){this.businessBar.removeEntry(59);J.g($a)}}Object(t.a)(da,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",x.a,[]);var qa=a(1056);class O extends x.a{constructor($a,Kb){super($a,Kb);(this.policyManager=$a.$.da.za(274))?(this.message=this.policyManager.Moc,
this.title=this.policyManager.title,this.rva=!0):c.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}Ala($a){super.Ala($a);($a=this.policyManager.kNi)&&$a(null)}}Object(t.a)(O,"PolicyBusinessBarEntry",x.a,[]);var ea=a(1055),R=a(1058),oa=a(1057);a(414);var pa=a(171),Pa=a(25);class Z extends x.a{constructor($a,Kb){super($a,Kb);this.ev=!0;this.title=""}xo($a){super.xo($a);pa.c(Pa.a.dCi);
window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(t.a)(Z,"UnsupportedBrowserBusinessBarEntry",x.a,[]);var Ra=a(1052),Ga=a(1278);class Ba extends x.a{constructor($a,Kb){super($a,Kb);this.FBa=Ga.a.E3b();this.ev=!0;this.YY=this.FBa.kUj;this.title=this.FBa.title;this.message=this.FBa.message}get actionButton(){return this.FBa.aue}get EFa(){return this.FBa.due}xo($a){super.xo($a);this.FBa.Utf(null)}YZ($a){super.YZ($a);this.FBa.Xtf(null)}kD($a){super.kD($a);this.FBa.cHe(null)}}
Object(t.a)(Ba,"WildFireMobileAppBusinessBarEntry",x.a,[]);var fa=a(245),Y=a(22),ja=a(216),ca=a(157),aa=a(46),ta=a(7),xa=a(172),ia=a(960),ya=a(69),ib=a(131);class wa extends x.a{constructor($a,Kb,rb,cc){super($a,Kb);this.automateCommandManager=rb.da.za(352);c.ULS.shipAssertTag(526787654,0,!!this.automateCommandManager);this.id=xa.a.create();this.$=rb;this.title=S.a.instance.ga(2279);this.message="";this.aTd=S.a.instance.ga(2275);this.bWj=S.a.instance.ga(2276);this.sfg=S.a.instance.ga(2277);this.$0g=
S.a.instance.ga(2278);this.update(cc)}update($a){this.scriptLink=$a.scriptLink;this.runStatus=$a.runStatus;this.buttonText=$a.buttonText||"";this.$si($a.clickId);this.dfj();"preparing"===this.runStatus?(this.message=String.format(S.a.instance.ob(207),this.buttonText),this.ev=!0,this.yXa=this.aTd,this.Cpb=this.REa=this.G9a):"running"===this.runStatus?(this.message=String.format(S.a.instance.ob(206),this.buttonText),this.ev=!0,this.yXa=this.aTd,this.Cpb=this.REa=this.G9a):"succeeded"===this.runStatus?
(this.message=String.format(S.a.instance.ob(209),this.buttonText),this.ev=!0,this.yXa=this.sfg,this.REa=this.CDf,this.YY=!0,this.VUc=this.bWj,this.WUc=this.fTi):"runFailed"===this.runStatus?(this.message=String.format(S.a.instance.ob(208),this.buttonText),this.Q4a=Ca.Zha,this.ev=!0,this.yXa=this.sfg,this.REa=this.CDf,"false"===$a.isOwner&&(this.YY=!0,this.VUc=this.$0g,this.WUc=this.qHi)):"fetchFailed"===this.runStatus?(this.Q4a=Ca.Zha,this.message=String.format(S.a.instance.ob(210),this.buttonText)):
"canceled"===this.runStatus?(this.Q4a=Ca.eA,this.message=String.format(S.a.instance.ob(212),this.buttonText)):"alreadyRunning"===this.runStatus?(this.Q4a=Ca.eA,this.message=String.format(S.a.instance.ob(211),this.buttonText),this.ev=!0,this.yXa=this.aTd,this.Cpb=this.REa=this.G9a):"initializing"===this.runStatus&&(this.Q4a=Ca.wi,this.message=S.a.instance.ga(2280))}get Tk(){return this.Q4a}get actionButton(){return this.yXa}get EFa(){return this.VUc}xo($a){super.xo($a);this.REa&&this.REa()}YZ($a){super.YZ($a);
this.EFa&&this.WUc()}kD($a){super.kD($a);this.Cpb&&this.Cpb()}dfj(){this.message="";this.Q4a=Ca.wi;this.ev=!1;this.yXa="";this.REa=void 0;this.YY=!1;this.VUc="";this.WUc=void 0;this.F4a=!1;this.Cpb=void 0}G9a(){const $a=xa.a.create().toString();this.automateCommandManager.O0h($a);this.Pic(-2186799,$a)}CDf(){const $a=xa.a.create().toString();this.automateCommandManager.N0h($a);this.Pic(1036446140,$a)}fTi(){const $a=xa.a.create();if(this.scriptLink){const Kb=new ia.b(this.scriptLink);this.automateCommandManager.d5e(this.id.toString(),
JSON.stringify(Kb),$a)}this.Pic(-585097204,$a.toString())}qHi(){const $a=xa.a.create().toString();this.automateCommandManager.M0h($a);this.Pic(-639858579,$a)}$si($a){const Kb=[];Kb.push(Object(ta.a)(new ya.a,{name:"id",string:this.id.toString()}));Kb.push(Object(ta.a)(new ya.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Kb.push(Object(ta.a)(new ya.a,{name:"runStatus",string:this.runStatus}));Kb.push(Object(ta.a)(new ya.a,{name:"clickId",string:$a}));Kb.push(Object(ta.a)(new ya.a,{name:"hasButtonText",
bool:!!this.buttonText&&""!==this.buttonText}));pa.a(ib.a.sEi,void 0,void 0,Kb)}Pic($a,Kb){const rb=[];rb.push(Object(ta.a)(new ya.a,{name:"id",string:this.id.toString()}));rb.push(Object(ta.a)(new ya.a,{name:"hasScriptLink",bool:!!this.scriptLink}));rb.push(Object(ta.a)(new ya.a,{name:"runStatus",string:this.runStatus}));rb.push(Object(ta.a)(new ya.a,{name:"clickId",string:Kb}));pa.d($a,void 0,void 0,void 0,void 0,void 0,rb)}}Object(t.a)(wa,"OfficeScriptsRunStatusBusinessBarEntry",x.a,[]);var sa=
a(47),Ya=a(1);class bb extends A{constructor($a,Kb,rb,cc,nc,Wb){super($a,Kb,rb);sa.a.instance.create(()=>{if(this.businessBar&&this.businessBar.FLa(Kb.$Fa)){const Ea=new z.a(-847286761,0,this.businessBar.$.Mc,0,null),ua={["CalloutName"]:cc,["Target"]:Ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.fS.domElement};this.businessBar.$.Ka.Mb(Ea,ua)}},nc,Wb,!0,!0)}}Object(t.a)(bb,"CalloutBusinessBarEntry",A,[]);var mb=
a(19);a.d(C,"BusinessBarControl",function(){return Ca});class Ca extends n.a{constructor($a,Kb){super(Kb);this.TBh=v.DOMElementExtensions.qr+",div";this.NT=Array(70);this.xm=!1;this.mV=rb=>{if(rb.Ca.keyCode===b.a.cA){var cc=this.mc.querySelectorAll(this.TBh);const nc=v.DOMElementExtensions.Kl(cc);cc=v.DOMElementExtensions.fz(cc);return v.DOMElementExtensions.Sma(rb.Ca,nc,cc)}return!1};this.jb=$a;this.set_visible(!1);this.addCssClass(w.a.Qlh);Ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",
!1)&&this.addCssClass(w.a.$lh);d.KeyInputManager.instance.ra(f.a.Kb,this.mc,this.mV);u.a($a).Xh(this)}get $d(){return fa.a.LXc}get mc(){return this.domElement}get kf(){return this.get_visible()}get $(){return this.jb}hg($a,Kb){Kb||v.DOMElementExtensions.setFocus(this.domElement.firstChild);return!Kb}kh($a){return v.DOMElementExtensions.vf(this.mc,$a)}lj(){}Nj(){}dispose(){this.xm||(d.KeyInputManager.instance.Ba(f.a.Kb,this.mc,this.mV),e.a.qc(this.NT),this.NT=Array(70),this.jb=null,super.dispose(),
this.xm=!0)}FLa($a){if(!this.get_visible())return!1;$a=this.NT[$a];return!!$a&&$a.isVisible}xE($a){return!!this.NT[$a]}INb($a,Kb){if($a=this.NT[$a])$a.update(Kb),$a.eQj()}gC($a,Kb,rb=null,cc=null){let nc=!1;if(this.xE($a))rb=this.NT[$a].get_visible();else{this.set_visible(!0);const Ea=Ca.d3e()[$a];this.NT[$a]=this.A2($a,Kb,rb,cc);rb=!1;nc=!0;cc="";let ua=0;Kb&&(cc=Kb.MessageIdName,ua=Kb.MessageId);const ma=Ea.B7c;var Wb=aa.PageLoadTrackingInfo.instance.TJa(new Date);c.ULS.sendTraceTag(537170258,0,
50,`BusinessBarControl.AddEntry of type: ${$a}, time from app interactive: ${Wb}`);Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:6069521_TelemetryForBusinessBar")&&(Wb=this.NT.filter(fb=>null!=fb).length,1<Wb&&c.ULS.sendTraceTag(525349006,0,50,`Total BizBars: ${Wb.toString()}`));ca.a(this.$).sJd(Ea.hash,cc,ua,k.a.Qzc,!0,1,Kb,ma)}rb||!B.a.ibc().includes($a)&&!nc||(this.NT[$a].set_visible(!0),this.$.oI())}removeEntry($a){return this.H9i($a)}uHd(){e.a.qc(this.NT);this.NT=Array(70);this.set_visible(!1)}H9i($a){if(!this.xE($a))return!1;
e.a.Ia(this.NT[$a]);this.NT[$a]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.oI();return!0}A2($a,Kb,rb=null,cc=null){const nc=Ca.d3e()[$a],Wb=!!(this.$.Bd&64);switch($a){case 2:case 4:case 23:case 25:case 26:case 36:case 35:$a=new x.a(this,nc);break;case 12:case 29:case 30:case 31:case 32:case 34:case 57:$a=Wb?new A(this,nc,-8805455):new x.a(this,nc);break;case 22:$a=new I(this,nc,-8805455);break;case 46:case 45:$a=Wb?new X(this,nc,Kb,0,-8805455):new U(this,nc,Kb,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:$a=
new U(this,nc,Kb,0);break;case 19:$a=new x.a(this,nc);break;case 47:$a=new U(this,nc,Kb,0);break;case 6:case 14:$a=new K(this,nc,Kb.HelpTopicId);break;case 68:case 66:$a=new L(this,nc,Kb.HelpTopicId);break;case 37:$a=new L(this,nc,r.a.Qah);break;case 38:$a=new x.a(this,nc);break;case 69:$a=new I(this,nc,924877417);break;case 16:$a=new x.a(this,nc);$a.title=l.a.Eg(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);$a.message=l.a.Eg(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);
break;case 18:$a=new A(this,nc,-1762562205);$a.F4a=!0;break;case 20:$a=new Ba(this,nc);break;case 21:case 56:$a=new x.a(this,nc);break;case 28:$a=new x.a(this,nc);break;case 24:$a=new Z(this,nc);break;case 27:$a=new O(this,nc);break;case 39:$a=new Ra.a(this,nc);break;case 40:$a=new y.a(this,nc);break;case 41:$a=new ea.a(this,nc);break;case 42:$a=new qa.a(this,nc);break;case 48:$a=new x.a(this,nc);break;case 49:$a=new x.a(this,nc);break;case 50:$a=new x.a(this,nc);break;case 51:$a=new x.a(this,nc);
break;case 52:$a=new x.a(this,nc);break;case 53:$a=new oa.a(this,nc);break;case 54:$a=new R.a(this,nc);break;case 55:$a=new M(this,nc);break;case 5:$a=new G(this,nc);break;case 58:$a=new A(this,nc,-1753056834);Kb?(Kb=Kb.Directive,Y.a.Aq(Kb)||"&nbsp;"===Kb||($a.message=Kb)):rb&&($a.message=rb);break;case 59:$a=new da(this,nc);break;case 60:$a=new x.a(this,nc);break;case 61:case 64:$a=new L(this,nc,r.a.CDi);break;case 62:$a=new W(this,nc,r.a.dNg,-8805455);break;case 67:$a=new W(this,nc,r.a.V4i,1461300262);
break;case 63:$a=Ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerBusinessBarTeachingCallout",!1)?new bb(this,nc,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout"):new A(this,nc,515196233);$a.message=rb;break;case 65:$a=new wa(this,nc,this.$,cc);break;default:$a=new U(this,nc,Kb,7)}$a.g2c();return $a}static d3e(){let $a;$a=ja.a.LLa()?263:262;return Ca.Rte||(Ca.Rte=[new H(0,278,279,280,0,0,Ca.Zha,1,"BB_UnableToRefreshLock"),new H(1,278,
279,280,0,0,Ca.Zha,1,"BB_UnableToRefreshLockExpected"),new H(2,270,271,0,0,0,Ca.eA,5,"BB_WorkbookAlmostTooLarge"),new H(3,272,273,274,0,0,Ca.Zha,1,"BB_WorkbookTooLarge"),new H(4,261,$a,0,0,0,Ca.eA,5,"BB_ExternalWorkbookLinksDisabled"),new H(5,265,264,266,0,0,Ca.Zha,1,"BB_ExternalWorkbookLinksShowError"),new H(6,267,268,269,0,0,Ca.wi,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new H(7,253,254,255,0,0,Ca.wi,5,"BB_UnsupportedFeatures"),new H(8,0,0,0,0,0,Ca.wi,0,"BB_CollabDataAndDataStringsLocaleMismatch"),
new H(9,0,0,0,0,0,Ca.wi,0,"BB_CollabDataStringsLocaleMismatch"),new H(10,0,0,0,0,0,Ca.wi,0,"BB_CollabDataLocaleMismatch"),new H(11,281,282,283,0,0,Ca.Zha,1,"BB_LastGenericStatusError"),new H(12,284,285,286,0,0,Ca.eA,5,"BB_ScratchPadWarning"),new H(13,287,288,289,0,0,Ca.Zha,1,"BB_AuthenticationLost"),new H(14,290,291,292,0,0,Ca.eA,5,"BB_OdfCompatibilityIssues"),new H(15,0,580,0,0,0,Ca.eA,5,"BB_PivotChartInteractivityMissingWarning"),new H(16,0,0,0,0,0,Ca.wi,2,"BB_WorkbookIsIrmProtected"),new H(17,
0,0,0,0,0,Ca.wi,0,"BB_BIFeatureNotAvailable"),new H(18,293,294,289,0,0,Ca.eA,5,"BB_AnonymousCreateMode"),new H(19,256,257,0,0,0,Ca.eA,5,"BB_UnsupportedInteractiveReportEditing"),new H(20,0,0,0,0,0,Ca.wi,0,"BB_MobileAppCampaignBizBar"),new H(21,299,300,0,0,0,Ca.wi,0,"BB_TransientServerCommunicationFailures"),new H(22,1644,1655,1656,0,0,Ca.wi,5,"BB_EditAttemptInReadOnly"),new H(23,1644,1655,0,0,0,Ca.wi,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),new H(24,0,T.HelperMethods.zPj(),1633,0,0,Ca.wi,3,
"BB_UnsupportedBrowser"),new H(25,302,303,0,0,0,Ca.wi,2,"BB_ReadOnlyPermissions"),new H(26,304,305,0,0,0,Ca.wi,2,"BB_DocumentIsIrmProtectedWarning"),new H(27,0,0,0,0,0,Ca.eA,5,"BB_PolicyWarningMessage"),new H(28,1287,301,0,0,0,Ca.wi,0,"BB_WorkingOnIt"),new H(29,1644,1642,1643,0,0,Ca.wi,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new H(30,1657,1658,1659,0,0,Ca.wi,5,"BB_WorkbookIsReadOnlyRecommended"),new H(31,1644,1660,1661,0,0,Ca.wi,5,"BB_WorkbookHasPasswordToModify"),new H(32,1644,1662,1665,0,
0,Ca.wi,3,"BB_LegacySharedWorkbookEditWarning"),new H(33,1652,1663,255,0,0,Ca.wi,5,"BB_LegacyConnectionsWarning"),new H(34,1644,1959,1656,0,0,Ca.wi,0,"BB_TooManyLoadBlockingFloatingObjects"),new H(35,1653,1654,0,0,0,Ca.wi,2,"BB_GroupedSlicers"),new H(36,315,316,0,0,0,Ca.eA,5,"BB_ThirdPartyAddinDisabled"),new H(37,1786,1787,0,0,1788,Ca.wi,5,"BB_FinanceLinkedEntityDisclaimerBar"),new H(38,1815,1816,0,0,0,Ca.eA,5,"BB_WolframDeprecationAlertBar"),new H(39,0,0,0,0,0,Ca.wi,0,"BB_WacGdprNotice"),new H(40,
0,0,0,0,0,Ca.wi,0,"BB_AutomaticSensitivityLabel"),new H(41,0,0,0,0,0,Ca.wi,0,"BB_RecommendedSensitivityLabel"),new H(42,0,0,0,0,0,Ca.wi,0,"BB_MandatorySensitivityLabel"),new H(43,317,318,319,0,0,Ca.wi,0,"BB_LocalStorageDisabled"),new H(44,637,638,0,0,0,Ca.wi,0,"BB_AutoRefreshDisabled"),new H(45,1013,1011,1015,1316,0,Ca.wi,4,"BB_CorruptedFileRepaired"),new H(46,1014,1012,1015,1316,0,Ca.wi,5,"CorruptedOdsFileRepaired"),new H(47,275,276,277,0,0,Ca.eA,5,"BB_MinorVersionLimitReached"),new H(48,306,307,
0,0,0,Ca.eA,5,"BB_SensitivityApplicationGenericError"),new H(49,308,310,0,0,0,Ca.eA,5,"BB_SensitivityApplicationTooLargeFileError"),new H(50,309,310,0,0,0,Ca.eA,5,"BB_SensitivityApplicationLabelNotSupportedError"),new H(51,311,312,0,0,0,Ca.eA,5,"BB_SensitivityApplicationLabelDisabledError"),new H(52,313,314,0,0,0,Ca.eA,5,"BB_SensitivityApplicationMandatoryConflictError"),new H(53,0,0,0,0,0,Ca.eA,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new H(54,0,0,0,0,0,Ca.eA,5,"BB_SensitivityApplicationSetLabelError"),
new H(55,2118,2119,2120,2123,0,Ca.wi,5,"BB_ExternalWorkbookLinksPromptEnableContent"),new H(56,299,300,0,0,0,Ca.wi,0,"BB_NetworkDown"),new H(57,320,321,322,0,0,Ca.wi,2,"BB_DefaultToViewDueToCogs"),new H(58,1812,1813,1814,0,0,Ca.wi,1,"BB_RefreshLinkedEntityErrorBar"),new H(59,1789,1790,1791,1792,0,Ca.wi,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new D(60,252,0,0,0,Ca.wi,5,"BB_CanvasHealth"),new H(61,323,324,0,0,325,Ca.wi,0,"BB_NovModeDepreciation"),new H(62,1016,1017,1316,0,1018,Ca.wi,5,"BB_MismatchedFileFormatConverted"),
new H(63,2235,0,2237,0,0,Ca.wi,5,"BB_OptimizeWorkbook"),new H(64,326,327,0,0,328,Ca.wi,0,"BB_NovModePostDepreciation"),new H(65,0,0,0,0,0,Ca.wi,0,"BB_OfficeScriptsRunning"),new H(66,2211,2212,0,0,2214,Ca.wi,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new H(67,329,330,0,0,331,Ca.wi,5,"BB_ReadOnlyPivotTable"),new H(68,2211,2213,0,0,2214,Ca.wi,0,"BB_PowerQueryRefreshHostNotSupported"),new H(69,1055,m.a.Zfc?1057:1056,1054,0,0,Ca.wi,4,"BB_RefreshPageAfterEnablingTheExtension")])}}Ca.Zha=mb.a.gph;Ca.eA=
mb.a.iph;Ca.wi=mb.a.hph;Ca.Rte=null;Object(t.a)(Ca,"BusinessBarControl",n.a,[102])},1147:function(t,C,a){var c=a(10);t=a(0);var b=a(691),d=a(50),f=a(37),e=a(15),k=a(1067),l=a(147),m=a(24),v=a(77),n=a(58);class w{constructor(na){this.options=null;this.options=na}}Object(t.a)(w,"MacroRecorderRangeCustomSortedPayload",null,[101]);var r=a(954),u=a(955),y=a(43),x=a(513),B=a(368),z=a(170),A=a(247),I=a(145),F=a(29),U=a(281),X=a(1),S=a(182),H=a(22),D=a(280),J=a(21),M=a(794),G=a(748),T=a(260),K=a(209),L=a(14),
V=a(133);class W{constructor(na){this.$v=Na=>{switch(Na){case 0:this.hNa("Cancel");break;case 1:this.hNa("Expand and sort");this.hQe(!0);break;case 2:this.hNa("Just sort"),this.hQe(!1)}};this.hQe=na}show(){const na=new V.StandardDialog;na.Rb=11;na.rc(1,L.a.instance.ga(2125));na.rc(2,L.a.instance.ga(2126));na.s3f(L.a.instance.ga(2124),L.a.instance.Xa(651),this.$v)}hNa(na){e.ULS.sendTraceTag(594125219,0,50,`ExpandSortSelectionDialog: user operation: ${na}`)}}Object(t.a)(W,"ExpandSortSelectionDialog",
null,[]);const da=(na,Na)=>{na=na.ColumnInfo;switch(Na){case 1:return na.CellColors&&na.CellColors.length?!0:(e.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1);case 2:return na.TextColors&&na.TextColors.length?!0:(e.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),
!1);case 3:return na.Icons&&na.Icons.length?!0:(e.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return e.ULS.sendTraceTag(537151628,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}},qa=(na,Na,Va,Sa)=>{na=na.HeaderColumnInfo;return Sa||na?2===Na&&Va?na.CellColors&&1!==na.CellColors.length?(e.ULS.sendTraceTag(537151626,
0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):na.TextColors&&1!==na.TextColors.length?(e.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),!1):na.Icons&&1!==na.Icons.length?(e.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),
!1):!0:na?(e.ULS.sendTraceTag(537151627,0,10,`SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize${Va} == 0.`),!1):!0:!0};var O=a(185);class ea{static isValid(na){return ea.Nwh.includes(na.Position)?!0:(e.ULS.shipAssertTag(537159826,0,!1,`FillGradientStopExtension.IsValid: unexpected position value [${na.Position}]`),!1)}}ea.Nwh=[0,.5,1];Object(t.a)(ea,"FillGradientStopExtension",null,[]);
class R{constructor(na,Na,Va,Sa){new Sys.UI.Point(na,Na);new Sys.UI.Point(Va,Sa)}}Object(t.a)(R,"GradientLine",null,[]);class oa{static isValid(na){if(!(na.Degree.toString()in oa.Lwh))return e.ULS.shipAssertTag(537159829,0,!1,`FillGradientExtension.IsValid: unexpected degree value [${na.Degree}]`),!1;if(!na.GradientStops)return e.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(na.GradientStops.length<oa.Hzi||na.GradientStops.length>oa.qyi)return e.ULS.shipAssertTag(537159827,
0,!1,`FillGradientExtension.IsValid: unexpected number of gradient stops [${na.GradientStops.length}]`),!1;for(const Na of na.GradientStops)if(!ea.isValid(Na))return!1;return!0}}oa.Hzi=2;oa.qyi=3;oa.Lwh={["0"]:new R(0,0,1,0),["180"]:new R(1,0,0,0),["90"]:new R(0,0,0,1),["270"]:new R(0,1,0,0),["45"]:new R(0,0,1,1),["225"]:new R(1,1,0,0),["135"]:new R(1,0,0,1),["315"]:new R(0,1,1,0)};Object(t.a)(oa,"FillGradientExtension",null,[]);const pa=na=>na.SortRange?4===na.SortRangeType?(e.ULS.sendTraceTag(537151622,
0,10,`SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: ${na.SortRangeType}`),!1):2===na.SortRangeType&&na.SortTopToBottom&&(null==na.HeaderRowSize||0>na.HeaderRowSize)?(e.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(e.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1),Pa=na=>{if(!na.SortConditions)return!0;
for(const Na of na.SortConditions){if(!Ra(na,Na.RowColOffset))return e.ULS.sendTraceTag(537151620,0,10,`SharedSortInfoResultExtension.VerifySortConditions: offset [${Na.RowColOffset}] is out of bounds. sort range: ${na.SortRange}`),!1;if(1===Na.SortConditionType&&Na.FillGradient&&!oa.isValid(Na.FillGradient))return e.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0},Z=na=>{if(!na.SortColumnInfoItems)return e.ULS.sendTraceTag(537151618,
0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;var Na=new O.a;for(var Va of na.SortColumnInfoItems){if(!Ra(na,Va.ColumnOffset))return e.ULS.sendTraceTag(537151617,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: offset [${Va.ColumnOffset}] is out of bounds. sort range: ${na.SortRange}`),!1;if(!Va.Name)return e.ULS.sendTraceTag(537151616,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [${Va.ColumnOffset}]`),!1;if(Va.CellColors&&
!Va.CellColors.length)return e.ULS.sendTraceTag(537151587,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [${Va.CellColors.length}]`),!1;if(Va.TextColors&&!Va.TextColors.length)return e.ULS.sendTraceTag(537151586,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [${Va.TextColors.length}]`),!1;if(Va.Icons&&!Va.Icons.length)return e.ULS.sendTraceTag(537151585,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [${Va.Icons.length}]`),
!1;Na.add(Va.ColumnOffset)}if(na.SortConditions)for(const Sa of na.SortConditions)if(!Na.contains(Sa.RowColOffset))return e.ULS.shipAssertTag(537151584,0,!1,`SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [${Sa.RowColOffset}]`),!1;if(na.HeaderColumnInfoItems){if(na.HeaderColumnInfoItems.length!==na.SortColumnInfoItems.length)return e.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),
!1;for(Na=0;Na<na.HeaderColumnInfoItems.length;++Na){Va=na.HeaderColumnInfoItems[Na];if(Va.ColumnOffset!==na.SortColumnInfoItems[Na].ColumnOffset)return e.ULS.shipAssertTag(537151582,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;if(Va.CellColors&&1<Va.CellColors.length)return e.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),
!1;if(Va.TextColors&&1<Va.TextColors.length)return e.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),!1;if(Va.Icons&&1<Va.Icons.length)return e.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),!1}}return!0},Ra=(na,Na)=>{const Va=na.SortRange;na=na.SortTopToBottom?Va.LastColumn-Va.FirstColumn:Va.LastRow-
Va.FirstRow;return 0<=Na&&Na<=na};var Ga=a(377),Ba=a(131),fa=a(96),Y=a(97),ja=a(132);class ca extends Ga.a{constructor(na,Na){super(na,Na);this.iCb=this.mbd();this.xr()}get oc(){return"SortMergedCellsErrorDialog"}iO(na,Na){if(1===na){var Va=y.v(this.iCb,this.$);J.g(this.$).Dg(Va,null,null,null,0,Y.a.OCj)}Va={["DialogButton"]:na,["Location"]:"dialog"};ja.b(this.$).Cd(Ba.a.QCj,Va,null,!0);super.iO(na,Na)}xr(){super.xr();const na=this.MCj();this.Rb=1;this.rc(1,L.a.instance.ga(2242));this.wl(L.a.instance.ga(2243),
fa.a.Ah(na),1,this.f0)}MCj(){return String.format(L.a.instance.ob(174),this.iCb.toString())}mbd(){const na=this.error.Description.split("_");return new m.Range(Number.parseInvariant(na[1])+1,Number.parseInvariant(na[2])+1,Number.parseInvariant(na[3])+1,Number.parseInvariant(na[4])+1,!0,!1)}}Object(t.a)(ca,"SortMergedCellsErrorDialog",Ga.a,[]);var aa=a(68),ta=a(573),xa=a(606);class ia extends M.a{constructor(na,Na,Va,Sa){super(na);this.Oec=this.oQd=!1;this.S5=[];this.Eci=(vb,Oa)=>{const yb=this.a6g(vb);
this.gLa(214,(Ob,Ja,lb)=>A.o(this.$.oa.va,yb,this.f_a(Ob,this.wEh(Oa)),this.uT(Ja),lb,null),16,!0)};this.Dci=(vb,Oa,yb)=>{vb=A.n(this.$.oa.va,Oa,this.iFh(Oa,yb),this.pLi,null,vb);this.S5.push(vb)};this.pLi=()=>{e.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");this.w5b(ia.Aqb())};this.l5c=(vb,Oa)=>{if(1===vb){vb=Oa.sortRangeType;const yb={};yb.SortOptions=Oa.sortOptions;yb.ShouldRestoreSelection=this.oQd;
yb.SelectedRange=this.selectedRange;yb.OriginalActiveCell=this.Qnc;yb.TopCellAddress=this.USa;yb.ShouldPromptNamedSheetViewTeachingDialog=0===vb||3===vb;ia.c3i(this.$,yb)}else this.oQd&&this.goa(this.selectedRange,this.Qnc)};this.X5h=(vb,Oa)=>{this.oQd=!0;this.goa(vb,Oa)};this.getColorName=vb=>G.a.NJa(K.a.lH(vb));e.ULS.shipAssertTag(529105669,0,!!Na.ActiveCell);e.ULS.shipAssertTag(529105668,0,!!Na.SelectedRange);e.ULS.shipAssertTag(529105667,0,y.D(Na.SelectedRange).contains(y.C(Na.ActiveCell)));e.ULS.shipAssertTag(529105666,
0,H.a.equals(Na.SelectedRange.SheetName,Na.ActiveCell.SheetName,!0));this.Kbb=new xa.a(na,ta.a.qah,()=>this.Oec,1);this.selectedRange=Na.SelectedRange;this.Qnc=Na.ActiveCell;this.CTg=Na.ExpandSelection;this.namedSheetViewPublic=Va;this.USa=Sa;this.initializeAndShow(L.a.instance.ga(183),this.l5c,this.Hsa(Na))}dispose(){this.Oec||(this.Oec=!0,this.x0b(),this.S5=null,this.Kbb.dispose(),this.Kbb=null);super.dispose()}get oc(){return"CustomSortDialog"}get ha(){return J.g(this.$).ha}wEh(na){return Na=>
{U.b(Na,-901005882)?(aa.a(this.$).jd.XL(-901005882),this.NEd()):U.b(Na,-569193796)?(aa.a(this.$).jd.XL(-569193796),this.hide(),new ca(this.$,Na.Errors[0])):U.a(Na)?(e.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),this.hide()):(Na=Na.Result,this.$.Xj(Na.SortRange),Na&&pa(Na)&&Pa(Na)&&Z(Na)?na(Na):this.w5b(ia.Aqb()))}}iFh(na,Na){return(Va,Sa)=>{if(this.Oec)e.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");
else if(!Va||U.a(Va))e.ULS.sendTraceTag(529105634,0,10,`CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: ${F.a.yc(Va.Errors)}`),this.$.ea.zp(Va.Errors),this.hide();else{Va=Va.Result;var vb=na.RangeType,Oa=na.HeaderRowSize,yb=na.SortTopToBottom;Va&&da(Va,na.ConditionType)&&qa(Va,vb,Oa,yb)?(Va.ColumnInfo.ColumnOffset=Sa,void 0!==Va.HeaderColumnInfo&&null!==Va.HeaderColumnInfo&&(Va.HeaderColumnInfo.ColumnOffset=Sa),Na(Va,na.ConditionType,na.SortTopToBottom)):
(e.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),this.w5b(ia.Aqb()))}}}a6g(na){const Na={};Na.SelectedRange=this.selectedRange;Na.ActiveCell=this.Qnc;Na.SortInfoMode=na;Na.ExpandSortSelection=this.CTg;Na.ExpandSortSelectionSupported=!0;return Na}Hsa(na){const Na={};Na[T.a.Tu]=this.oc;Na.fromAutoFilter=na.FromAutoFilter;Na.gridRTL=J.g(this.$).rtl;Na.activeCell=na.ActiveCell;Na.selectedRange=na.SelectedRange;
Na.invokeGetSortInfo=this.Eci;Na.invokeGetSortConditionColorsOrIcons=this.Dci;Na.highlightSortRange=this.X5h;Na.getColorName=this.getColorName;return Na}goa(na,Na){na=y.D(na);this.ha.sa.Wc.equals(na)||this.ha.updateSelection(na,y.C(Na),0,void 0,void 0,void 0,!0)}NEd(){(new W(na=>{const Na={};Na.ActiveCell=this.Qnc;Na.SelectedRange=this.selectedRange;Na.ExpandSelection=na;Na.FromAutoFilter=!1;this.$.ud(-207540907,v.a.Eb,8,{["SortCommandData"]:Na})})).show()}x0b(){if(void 0!==this.S5&&null!==this.S5)for(const na of this.S5)this.$.oa.va.reb(na.Nt)}static c3i(na,
Na){na.ud(1659552324,v.a.Eb,8,{["CustomSortCommandData"]:Na})}static Aqb(){return F.a.Yc(1,0,26,0,1,-1517197771,"CustomSortValidationError")}}Object(t.a)(ia,"CustomSortDialog",M.a,[]);var ya=a(1068);class ib{constructor(na){this.selection=null;this.selection=na}getSelection(){return this.selection}}Object(t.a)(ib,"MacroRecorderRangeAutoFilterClearedPayload",null,[101]);class wa{constructor(na){this.filterRange=null;this.filterRange=na}}Object(t.a)(wa,"MacroRecorderRangeFilterReappliedPayload",null,
[101]);var sa=a(61);const Ya=(na,Na,Va,Sa,vb,Oa,yb=null)=>{yb=na.Na(41,yb);yb.options=Na;return sa.g(na,"Sort",yb,Va,Sa,vb,Oa,0)},bb=(na,Na,Va,Sa,vb,Oa,yb=null)=>{yb=na.Na(41,yb);yb.selectedRange=Na;return sa.g(na,"ClearAutoFilter",yb,Va,Sa,vb,Oa,0)},mb=(na,Na,Va,Sa,vb,Oa,yb=null)=>{yb=na.Na(41,yb);yb.filterRange=Na;return sa.g(na,"ReapplyAutoFilter",yb,Va,Sa,vb,Oa,0)};var Ca=a(767),$a=a(768),Kb=a(112),rb=a(55),cc=a(1069),nc=a(197),Wb=a(33),Ea=a(338),ua=a(65);class ma{constructor(na,Na){this.sortOptions=
this.bSa=this.selectedRange=null;this.nbf=!1;this.activeCell=this.xe=this.ub=this.kc=null;this.onContentReady=()=>{this.mNf(!1);const Va=this.ha();Va.sa.wg&&Va.sa.Wc.equals(this.bSa)&&(X.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")?Va.updateSelection(this.selectedRange,y.C(this.activeCell),0,void 0,void 0,void 0,!0):Va.updateSelection(this.selectedRange,Va.sa.activeCell,0,void 0,void 0,void 0,!0))};this.YKi=(Va,Sa)=>{Va&&!F.a.rg(Va.Errors)&&this.kc&&
(this.kc.Qo=Va.Result,this.YJb(),this.applyPivotSort(Sa))};this.XKi=()=>{};this.xSi=(Va,Sa)=>{Sa&&Sa.ZJj&&Sa.selection&&Wb.a.qdf()&&(Va=ua.d(this.$.xa.pa),this.$Jj(new Ea.a(y.D(Sa.selection),Va)))};this.$=na;this.gjf="";this.namedSheetViewPublic=Na;this.gridView=J.g(this.$);this.$.Ib.Og("LoadResource","LoadDialogControlsStopwatch")}Nc(na,Na){return!this.apd(na,Na)}executeCommand(na,Na,Va){let Sa=null;na=Na.command;switch(na){case -864298118:Sa=this.pgh(Na,Va);break;case -1010737776:Sa=this.R5c(!0,
Na,Va);break;case 2123420468:Sa=this.R5c(!1,Na,Va);break;case -1089513346:Va=this.aXe(Va);if(!this.Gzb([y.D(Va.SortOptions.SelectedRange)]))return f.TaskExtensions.fk();Sa=this.GHe(Na,Va);break;case -1032691499:case -764711886:case -2016161444:Sa=this.h1i(Na,Va);break;case -207540907:case -1677817820:Sa=this.gridView.Db.s4(this.ha().sa.activeCell)?this.Y0i():this.V0i(Na,Va);break;case 1659552324:Sa=this.GHe(Na,this.aXe(Va));break;case 368460465:Sa=this.Fgh(Na,Va);break;case 529856798:Sa=this.kgh(Na);
break;case 644342024:Sa=this.Agh(Na)}return Sa||S.a(na)}Cc(na,Na){if(na=1===na)switch(Na.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:break;case -1032691499:case -764711886:case -2016161444:na=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PutSelectedItemOnTop",!1);break;default:na=!1}return na}Rc(){return!1}ha(){return this.$&&this.gridView?this.gridView.ha:null}mNf(na){na?
this.gridView.Ku(this.onContentReady):this.gridView.py(this.onContentReady);this.nbf=na}get sa(){return this.ha().sa}Wxj(na){return!!this.sortOptions&&H.a.equals(this.gjf,na.Dha,!0)}apd(na,Na){const Va=J.g(this.$).ha.sa.selectedRanges;return(new I.a(this.$.xa)).mm(na,Na,Va,this.gridView)}R5c(na,Na,Va){const Sa=new k.a;X.EwaSettings.isChangeGateEnabled("OfficeVSO:6496842_createDefaultSortOptions")?this.F9e(Sa,Va,na):(Sa.OperationType=0,Sa.IsAscending=na,Sa.HasHeader=!0,Sa.GuessHeader=!0,Sa.SortTopToBottom=
!0,Sa.ExpandSortSelectionSupported=!0,Va&&void 0!==Va[ma.sna]&&null!==Va[ma.sna]?(Va=Va[ma.sna],Sa.ActiveCell=Va.ActiveCell,Sa.SelectedRange=Va.SelectedRange,Sa.ExpandSortSelection=Va.ExpandSelection):(Sa.ActiveCell=y.o(this.sa.activeCell,this.$),Sa.SelectedRange=y.v(this.sa.Wc,this.$),Sa.ExpandSortSelection=null));return this.Gzb([y.D(Sa.SelectedRange)])?this.gridView.Db.s4(y.D(Sa.SelectedRange))?this.xgh(na):this.hld(Sa,Na):f.TaskExtensions.fk()}pgh(na,Na){e.ULS.shipAssertTag(520901652,0,!1,"SortCommandHandler.doDefaultSort: using default sort");
let Va=null;const Sa=this.ha();Sa&&(this.Wxj(Sa)?this.Gzb(Sa.sa.selectedRanges)&&(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,Va=this.hld(this.sortOptions,na)):Va=this.R5c(!0,na,Na));return Va}Gzb(na){return X.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")&&(X.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||this.$.isEditMode)?this.$.isEditMode?this.$.rq(na,!0,1):this.$.GVc(na,!0,1):!0}xgh(na){this.ZSh(na);return rb.Task.Ta(!0)}oQg(na){if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){const Na=
this.gridView.Db.Yj(this.sa.Wc,!1);if(Na)return new u.a(Na.name,this.sa.activeCell.left-Na.usedRange.left,na.IsAscending)}return new r.a(na)}hld(na,Na){this.gridView.Df.XG(!1);const Va=()=>this.oQg(na);return this.h7c((Sa,vb,Oa)=>Ya(this.$.oa.va,na,D.b(Sa,this.jFh(Na)),vb,Oa,na),Sa=>new z.a(141,0,Sa,void 0,Va),Na,this.Qwj(na))}Qwj(na){if(!this.namedSheetViewPublic)return!1;const Na=this.sa.Wc,Va=y.v(this.sa.Wc,this.$),Sa=this.gridView.Db.XLa(Na,!0),vb=this.sa.jba()&&this.gridView.Db.bff(Va),Oa=this.gridView.Db.dki(Va);
na=(Na.D4||Na.xZ)&&!Na.isSingle&&(null==na.ExpandSortSelection?!1:na.ExpandSortSelection)&&this.gridView.Db.bff(Va);return Sa||vb||Oa||na}Y0i(){return this.$.ud(-1556797033,v.a.Eb,8,null)}V0i(na,Na){na=8===na.Re&&Na&&void 0!==Na[ma.sna]&&null!==Na[ma.sna]?Na[ma.sna]:19===na.Re&&Na&&void 0!==Na[v.a.Zf]&&null!==Na[v.a.Zf]?n.a.Vh(Na[v.a.Zf]):this.f5g();if(!this.Gzb([y.D(na.SelectedRange)]))return f.TaskExtensions.fk();J.g(this.$).Df.XG(!1);let Va=null;(Na=Na.TopCellAddress)&&(Va=y.o(Na,this.$));new ia(this.$,
na,this.namedSheetViewPublic,Va);return rb.Task.Ta(!0)}aXe(na){return na[ma.pah]}GHe(na,Na){const Va=Oa=>{this.$5e(Oa)?this.L4e(Oa.Errors[0]):(Na.ShouldRestoreSelection&&this.goa(Na.SelectedRange,Na.OriginalActiveCell),e.ULS.sendTraceTag(537151576,0,50,`SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: ${na.Re}`),this.ULj(Na))},Sa=()=>{Na.ShouldRestoreSelection&&this.goa(Na.SelectedRange,Na.OriginalActiveCell);e.ULS.sendTraceTag(537151575,0,10,`SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: ${na.Re}`)},
vb=()=>new w(Na.SortOptions);return this.h7c((Oa,yb,Ob)=>Ya(this.$.oa.va,Na.SortOptions,D.b(Oa,Va),D.a(yb,Sa),Ob,this.sortOptions),Oa=>new z.a(187,0,Oa,void 0,vb),null,Na.ShouldPromptNamedSheetViewTeachingDialog)}goa(na,Na){na=y.D(na);J.g(this.$).ha.sa.Wc.equals(na)||J.g(this.$).ha.updateSelection(na,y.C(Na),0,void 0,void 0,void 0,!0)}f5g(){const na={};na.ActiveCell=y.o(this.sa.activeCell,this.$);na.SelectedRange=y.v(this.sa.Wc,this.$);na.FromAutoFilter=!1;na.ExpandSelection=null;return na}Fgh(na,
Na){const Va=this.faa();if(!Va)return rb.Task.Ta(!1);const Sa=this.$.oa.va.Sb(),vb=()=>new ya.a(Va);return X.EwaSettings.dc()?B.a(this.$.userOperationManager,(Oa,yb,Ob)=>A.A(this.$.oa.va,Va,D.b(Ca.a.ava(Kb.a.iZa,$a.a.toggleAutoFilter,Oa),this.xSi),yb,Ob,{selection:Va,ZJj:Na.On},Sa),Oa=>new z.a(516,0,Oa,64,vb),na):B.a(this.$.userOperationManager,(Oa,yb,Ob)=>A.A(this.$.oa.va,Va,Ca.a.ava(Kb.a.iZa,$a.a.toggleAutoFilter,Oa),yb,Ob,null,Sa),Oa=>new x.a(516,0,Oa,void 0,vb),na)}kgh(na){const Na=this.faa();
if(!Na)return rb.Task.Ta(!1);var Va=this.gridView.Db.Yj(this.sa.Wc,!0);Va&&e.ULS.sendTraceTag(537151574,0,50,`DoClearAutoFilter for namedObject: Type : ${Va.type.toString()}`);const Sa=this.$.oa.va.Sb(),vb=()=>new ib(Na);Va=X.EwaSettings.dc()?Oa=>new z.a(517,0,Oa,64,vb):Oa=>new x.a(517,0,Oa,void 0,vb);return this.h7c((Oa,yb,Ob)=>bb(this.$.oa.va,Na,Ca.a.ava(Kb.a.Lra,$a.a.clearAutoFilter,Oa),yb,Ob,null,Sa),Va,na)}h7c(na,Na,Va,Sa=!0){return this.namedSheetViewPublic&&Sa?this.namedSheetViewPublic.ORa().continueWith(vb=>
{vb.result&&B.a(this.$.userOperationManager,na,Na,Va)}):B.a(this.$.userOperationManager,na,Na,Va)}Agh(na){const Na=this.faa();if(!Na)return rb.Task.Ta(!1);const Va=this.$.oa.va.Sb(),Sa=()=>new wa(Na);return X.EwaSettings.dc()?B.a(this.$.userOperationManager,(vb,Oa,yb)=>mb(this.$.oa.va,Na,Ca.a.ava(Kb.a.Lra,$a.a.SKf,vb),Oa,yb,null,Va),vb=>new z.a(518,0,vb,64,Sa),na):B.a(this.$.userOperationManager,(vb,Oa,yb)=>mb(this.$.oa.va,Na,Ca.a.ava(Kb.a.Lra,$a.a.SKf,vb),Oa,yb,null,Va),vb=>new x.a(518,0,vb,void 0,
Sa),na)}jFh(na){return(Na,Va)=>{var Sa;U.b(Na,-901005882)?(aa.a(this.$).jd.XL(-901005882),this.NEd(Va,na.command)):this.$5e(Na)?this.L4e(Na.Errors[0]):!U.a(Na)&&Na.Result&&(this.sortOptions=Va,this.bSa=y.D(Na.Result.ActualSortRange),this.gjf=this.ha().Dha,this.nbf||(this.selectedRange=this.sa.Wc,this.selectedRange.equals(this.bSa)||(X.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")&&(this.activeCell=y.o(this.sa.activeCell,this.$)),this.aBj())),(null===
(Sa=this.sortOptions)||void 0===Sa?0:Sa.ActiveCell)&&(!X.EwaSettings.isChangeGateEnabled("OfficeVSO:6611537_shouldTriggerPivotTableHandRaise")||this.d2f(this.sortOptions))&&(Na=this.sortOptions.ActiveCell,Na=new m.Range(Na.FirstRow+1,Na.FirstColumn+1,Na.FirstRow+1,Na.FirstColumn+1,!0,!1),this.sL(Na),this.aWd(Na)))}}$5e(na){return U.b(na,-569193796)}L4e(na){aa.a(this.$).jd.XL(-569193796);new ca(this.$,na)}NEd(na,Na){(new W(Va=>{const Sa={};Sa.ActiveCell=na.ActiveCell;Sa.SelectedRange=na.SelectedRange;
Sa.ExpandSelection=Va;this.$.ud(Na,v.a.Eb,8,{[ma.sna]:Sa})})).show()}aBj(){const na=this.ha();if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")){let Na=y.C(this.activeCell);this.bSa.Ge(Na)||(Na=this.bSa.topLeft);na.updateSelection(this.bSa,Na,0,void 0,void 0,void 0,!0)}else na.updateSelection(this.bSa,na.sa.activeCell,0,void 0,void 0,void 0,!0);this.mNf(!0)}faa(){const na=this.ha();if(!na)return e.ULS.shipAssertTag(537151573,0,!!na,"SelectionManger is null"),
null;this.gridView.Df.XG(!1);return y.v(na.sa.Wc,this.$)}YJb(){this.kc&&this.kc.Qo&&(this.xe=this.kc.Qo,this.ub=this.kc.p$b())}ZSh(na){if(this.$.isEditMode&&(this.kc=this.gridView.Db.fp(this.sa.activeCell))){this.activeCell=y.o(this.sa.activeCell,this.$);if(this.kc&&this.kc.Qo){var Na=this.kc.Qo.CurrentCol;if(this.kc.Qo.CurrentRow===this.activeCell.FirstRow&&Na===this.activeCell.FirstColumn){this.YJb();this.applyPivotSort(na);return}}this.$.oa.va.Sb();Na=new z.a(228,0,(Va,Sa,vb)=>A.k(this.$.oa.va,
this.activeCell,D.b(Va,this.YKi),D.a(Sa,this.XKi),vb,na),16);this.$.userOperationManager.Ub(Na,null)}}applyPivotSort(na){if(this.kc&&this.ub&&this.activeCell&&this.xe){var Na=8===this.xe.CellArea,Va=1===this.xe.CellArea||2===this.xe.CellArea;(Na||Va)&&8!==this.xe.CellType&&4!==this.xe.CellType&&(Na?B.a(this.$.userOperationManager,(Sa,vb,Oa)=>A.b(this.$.oa.va,this.activeCell,na?1:2,this.ub.Caption,Sa,vb,Oa,null),Sa=>new z.a(1015,0,Sa,void 0,null),null):(Na=1===this.xe.CellArea?1:2,this.$.ma(688)?l.a.naps(this.$.domElement,
this.activeCell.FirstRow,this.activeCell.FirstColumn,this.kc.externalSourceIndex,this.ub.Index.toString(),this.ub.Caption,this.kc.isOlap?"":this.ub.Caption,Na,na):l.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.kc.externalSourceIndex,this.ub.Index.toString(),na)))}}ULj(na){this.d2f(na.SortOptions)&&(na.TopCellAddress?na=y.C(na.TopCellAddress):(na=na.OriginalActiveCell,na=new m.Range(na.FirstRow+1,na.FirstColumn+1,na.FirstRow+1,na.FirstColumn+1,!0,!1)),this.sL(na))}sL(na){Wb.a.gba(this.$)&&
f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ra(this.$.da,430,431,1),Na=>{Na.result.g7(na);e.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)}aWd(na){X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1)&&f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ra(this.$.da,476,475,0),Na=>{Na.result.aWd(na,0);e.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},
this.$.la,3)}h1i(na,Na){if(!this.Gzb(this.sa.selectedRanges))return f.TaskExtensions.fk();const Va=new k.a;this.F9e(Va,Na);Va.SortConditions=[this.u8g(na)];Va.OperationType=2;return this.hld(Va,na)}u8g(na){const Na=this.gridView.Vb(this.sa.activeCell);let Va=new cc.a;Va.IsAscending=!0;switch(na.command){case -1032691499:Na.gwb?(na=nc.a.cp(Na.backgroundColor),Va.SortColor=na.VR(!0)):Va.SortColor=ma.NoColor;Va.SortConditionType=1;break;case -764711886:Va.SortColor=Na.d0c===ma.NoColor?ma.NoColor:nc.a.vse(Na.d0c);
Va.SortConditionType=2;break;case -2016161444:Na.nwb?(Va.SortIcon=Na.cell.Fhc,Va.SortIconSet=Na.Ghc):(Va.SortIcon=ma.M_d,Va.SortIconSet=ma.M_d);Va.SortConditionType=3;break;default:e.ULS.debugAssertTag(522723787,0,!1,"SortCommandHandler.createSortConditionsFromSelectedCell: ribbon command didn't match any of the case statements")}return Va}$Jj(na){f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ra(this.$.da,426,427,1),Na=>{void Na.result.XVd(na,"Filter")},this.$.la,3)}F9e(na,Na,Va=!0){na.OperationType=
0;na.IsAscending=Va;na.HasHeader=!0;na.GuessHeader=!0;na.SortTopToBottom=!0;na.ExpandSortSelectionSupported=!0;Na&&Na[ma.sna]?(Na=Na[ma.sna],na.ActiveCell=Na.ActiveCell,na.SelectedRange=Na.SelectedRange,na.ExpandSortSelection=Na.ExpandSelection):(na.ActiveCell=y.o(this.sa.activeCell,this.$),na.SelectedRange=y.v(this.sa.Wc,this.$),na.ExpandSortSelection=null)}d2f(na){return!na.SortConditions||na.SortConditions.some(Na=>0===Na.SortConditionType)}}ma.pah="CustomSortCommandData";ma.sna="SortCommandData";
ma.M_d=-1;ma.NoColor=0;Object(t.a)(ma,"SortCommandHandler",null,[195]);class fb extends b.a{constructor(na){super(na)}yd(){f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ra(this.$.da,309,310,this.hb),na=>{this.gd([new ma(this.$,na.result)])},this.$.la,3)}static ka(na){b.a.Nd(160,new fb(na))}}Object(t.a)(fb,"SortCommandHandlerFactory",b.a,[]);M=a(221);class sb{constructor(na){na.da.Ga(446,this)}D9g(na,Na){new ca(na,Na)}}Object(t.a)(sb,"SortUtil",null,[415]);class Ua extends M.a{constructor(na){super();
this.$=na;this.Fb()}create(){let na=this.$.da.za(446);na||(na=new sb(this.$),this.$.da.Ga(446,na));this.qb(na)}static ka(na){na.da.Ga(447,new Ua(na))}}Object(t.a)(Ua,"SortUtilFactory",M.a,[]);a.d(C,"a",function(){return ab});const ab=()=>{c.a.Fa(na=>{fb.ka(na);Ua.ka(na)})}},1151:function(t,C,a){t=a(0);var c=a(550),b=a(15),d=a(133),f=a(53);class e extends d.StandardDialog{constructor(){super();this.Rb=0;this.rc(1,CommonUIStrings.l_DialogClose)}displayError(wa,sa){this.mHe(wa,sa,f.a.Uij)}mHe(wa,sa,
Ya){b.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Ya);this.Xz(Ya,wa,sa,null)}F5c(wa,sa){b.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Xz(f.a.Wij,wa,sa,null,!0)}}Object(t.a)(e,"ErrorDialog",d.StandardDialog,[318]);var k=a(83);d=a(1047);var l=a(144);class m{static get ag(){return l.a.ap(m.Bk,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}m.Bk="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(t.a)(m,"FileNameDialogHtml",null,[]);var v=a(4),n=a(13),w=a(44),r=a(85),u=a(88),y=a(30);class x extends d.a{constructor(wa,sa,Ya,bb,mb,Ca,$a,Kb){super(wa,sa,Ya,bb,mb,Ca,Kb);this.Epa=this.cPc=this.Iy=null;this.YRg=CommonUIStrings.l_SaveToAnotherFolder;this.ag=m.ag;this.ze="FileNameDialog-SaveToSharePoint";this.Gkb=$a;this.Tsg=Kb}OP(wa){const sa=y.a.uq(v.AFrameworkApplication.hm.Zm),Ya=v.AFrameworkApplication.breadcrumbFolderName,bb=v.AFrameworkApplication.breadcrumbBrandName,mb={["txtFileName"]:wa||
sa};let Ca=CommonUIStrings.L_SaveAs;2===v.AFrameworkApplication.ta.Oa.xj&&(Ca=CommonUIStrings.L_SaveACopy);this.initializeAndShow(Ca,Object(k.a)(this,this.g8b,"fileNameDialogHandler"),mb);this.VGe(wa,sa);this.MHa.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");v.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost")||(this.Iy=document.getElementById("anotherFolder"),wa=document.getElementById("folderLocation"),this.cPc=
u.a.tpe(wa,this.Iy,"anotherFolderDescribedBy"),this.Iy.className="WACButton WACDialogButtonNormal",wa=!1,Ya&&Ya.length?(this.Vje(this.Iy,this.cPc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,bb,Ya)),wa=this.Pzg(bb,Ya)):this.Vje(this.Iy,this.cPc,CommonUIStrings.l_CurrentOnlineFolder),this.PAg(this.Iy),this.Szg(this.Iy),wa?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.Iy,"SaveToAnotherLocationTwo"),b.ULS.sendTraceTag(24459297,216,
50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.Iy,"SaveToAnotherLocationOne"),w.a.addHandler(this.Iy,n.a.click,Object(k.a)(this,this.BAd,"onSaveToAnotherLocationClick")),w.a.addHandler(this.Iy,n.a.Kb,Object(k.a)(this,this.kBf,"onSaveToAnotherLocationKeyDown")))}Pzg(wa,sa){let Ya;Ya=!1;const bb=document.getElementById("currentLocation");bb.innerText="";const mb=this.PZe(bb,wa),Ca=this.PZe(bb,sa);let $a=255,Kb=255;255<mb+Ca&&($a=Math.max(238,408-mb),Kb=
Math.max(170,408-Ca),Ya=!0);this.pCg(bb,wa,Kb,sa,$a);return Ya}PZe(wa,sa){const Ya=document.createElement("div");Ya.innerText=sa;Ya.style.visibility="hidden";wa.appendChild(Ya);sa=Ya.clientWidth;wa.removeChild(Ya);return sa}pCg(wa,sa,Ya,bb,mb){sa&&(this.Tje(wa,sa,Ya),this.gCg(wa));bb&&this.Tje(wa,bb,mb)}Tje(wa,sa,Ya){const bb=document.createElement("div");bb.innerText=sa;bb.title=sa;bb.className="SaveToAnotherFolderBreadcrumb";bb.style.maxWidth=Ya.toString()+"px";wa.appendChild(bb)}gCg(wa){const sa=
document.createElement("span");sa.id="FolderSeparator";const Ya=document.createElementNS("http://www.w3.org/2000/svg","svg");Ya.setAttribute("class","SeparatorCaret");const bb=document.createElementNS("http://www.w3.org/2000/svg","polygon");bb.setAttribute("points","1 4 1 11 5 7.5");Ya.appendChild(bb);sa.appendChild(Ya);wa.appendChild(sa)}Vje(wa,sa,Ya){Ya=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Ya);sa&&(sa.innerText=Ya);wa.tabIndex=0;wa.setAttribute(u.a.Kd,u.a.Ms)}Szg(wa){const sa=
document.createElement("span");sa.id="anotherFolderText";sa.innerText=this.YRg;sa.className="AnotherFolderTextSpan";wa.appendChild(sa)}PAg(wa){const sa=document.createElement("span");sa.className="cui-img-cont-float cui-img-16by16 ";this.Epa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Epa.setAttribute("class","FolderIconSVG");const Ya=document.createElementNS("http://www.w3.org/2000/svg","path");Ya.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");
this.Epa.appendChild(Ya);sa.appendChild(this.Epa);wa.appendChild(sa)}kBf(wa){!wa||wa.keyCode!==r.a.$h&&wa.keyCode!==r.a.A0||this.BAd(wa)}BAd(){if(this.ZI){const wa=y.a.t3(v.AFrameworkApplication.fileName);let sa=this.ZI.value;this.hide();sa&&""!==sa&&""!==wa||1===this.ta.state?(""!==wa&&(sa+=wa),this.h8b(sa)?this.Cs.create().displayError(1,sa,!1):this.Gkb.start(sa,this.Tsg)):this.Cs.create().displayError(2,sa,!1)}}DVg(wa){this.Iy&&this.Epa&&(wa?(this.Iy.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.Iy,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Epa,"DisabledFolderIconSVG")):(this.Iy.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.Iy,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Epa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.Iy,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Epa,"DisabledFolderIconSVG"))))}Pgd(){super.Pgd();this.DVg(!!this.ZI&&""!==this.ZI.value)}dispose(){this.Iy&&(w.a.removeHandler(this.Iy,n.a.click,Object(k.a)(this,
this.BAd,"onSaveToAnotherLocationClick")),w.a.removeHandler(this.Iy,n.a.Kb,Object(k.a)(this,this.kBf,"onSaveToAnotherLocationKeyDown")),this.Iy=null);super.dispose()}}Object(t.a)(x,"FileNameDialog",d.a,[333]);var B=a(681),z=a(551),A=a(185),I=a(805),F=a(903),U=a(98),X=a(134);class S{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(t.a)(S,"SaveAsDialogInput",null,[]);class H{constructor(){this.properties=this.friendlyPath=this.folderName=
null}}Object(t.a)(H,"SaveLocation",null,[]);var D=a(370),J=a(186);class M{constructor(wa,sa,Ya,bb,mb,Ca,$a,Kb,rb){this.jLc=null;this.qA="";this.Gkb=wa;this.Cs=sa;this.Kh=rb;this.Vfa=Ya;this.We=mb;this.Gv=bb;this.FEa=$a;this.VWa=Kb;Ca&&(this.jLc=new c.a(()=>new I.a(Ca.value,null)))}UKh(){const wa=new B.a(z.a.Sk());wa.ia("type","currentHost");return Object.assign(new H,{folderName:this.Gv.breadcrumbFolderName,friendlyPath:this.Gv.breadcrumbBrandName,properties:wa})}Ili(wa){return!!wa&&"ClassicMru"===
wa.type&&!!wa.service_info&&!!wa.service_info.service_id&&-1!==wa.service_info.service_id.indexOf("SHAREPOINT")}pWh(){if(!this.jLc||!this.FEa)return null;var wa=this.jLc.value.TY("SaveAsToSharePointDialog",!1);if(!wa||3!==wa.state||!wa.iqf)return null;wa=wa.iqf;const sa=new A.a;let Ya=0,bb=0;for(var mb=0;mb<wa.length;mb++){var Ca=wa[mb];if(!this.Ili(Ca))continue;Ya++;if(!Ca.sharepoint_info)continue;const $a=Ca.url,Kb=Ca.sharepoint_info.site_url,rb=Ca.title;Ca=F.b(Ca,v.AFrameworkApplication.isRtl);
if(!($a&&Kb&&rb&&Ca))continue;bb++;const cc=new B.a(z.a.Sk());cc.ia("type","SharePoint");cc.ia("siteUrl",Kb);cc.ia("folderUrl",$a);bb++;sa.add(Object.assign(new H,{folderName:rb,friendlyPath:Ca,properties:cc}))}mb=new Map;mb.set("NumPlaces",wa.length.toString());mb.set("NumSharepointPlaces",Ya.toString());mb.set("placesWithMetadata",bb.toString());U.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",mb);0<Ya&&(bb?.5>1*bb/Ya&&U.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru",
"PartialPlacesMetadataMissing",!1,!1,null):U.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return sa}KLh(){const wa=new A.a;wa.add(this.UKh());const sa=this.pWh();sa&&wa.addRange(sa);return Object.assign(new S,{enableMoreLocations:!v.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.qA,extension:y.a.t3(this.Gv.Zm),saveLocations:wa.toArray(),scenario:"SaveToSharePoint"})}s$b(){const wa=Object(k.a)(this,this.KLh,
"getDialogInput"),sa={};sa.inputPropsCallback=wa;return sa}OP(wa){this.qA=wa;this.qA||(this.qA=String.format(CommonUIStrings.l_SaveACopy_Filename,y.a.uq(this.Gv.Zm)));wa={["id"]:"SaveAsDialog",["bodyControls"]:this.s$b()};let sa=CommonUIStrings.L_SaveAs;2===this.We.Oa.xj&&(sa=CommonUIStrings.L_SaveACopy);const Ya=new l.a(!1,!1,!0);Ya.Rb=1;Ya.ze="SaveAsDialog";Ya.rc(1,CommonUIStrings.l_SaveButtonLabel);Ya.initializeAndShow(sa,Object(k.a)(this,this.Qij,"saveAsDialogHandler"),wa)}cAj(wa,sa){wa&&""!==
wa&&""!==sa||1===this.We.state?this.Hli()?this.osi(wa,sa):(""!==sa&&(wa+=sa),this.Gkb.start(wa,this.Kh)):(b.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.Cs.create().displayError(2,wa,!1))}osi(wa,sa){U.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const Ya=this.VWa.ECe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.VWa.Xcd(Ya).then(bb=>{if(bb&&0<bb.length){const mb=
bb[0][D.a.gXi];bb=bb[0][D.a.bGf];if(""!==mb&&""!==bb)this.FEa.una(bb,wa+sa,mb,this.Kh),U.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.Cs.create().displayError(0,wa,!1);const Ca=X.a.Lr();Ca&&(Ca.set("SiteUrlAvailable",""===mb?"false":"true"),Ca.set("FolderUrlAvailable",""===bb?"false":"true"));U.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new J.a,{extendedProperties:Ca}))}}else this.Cs.create().displayError(0,wa,
!1),U.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(bb=>{"Canceled"===bb?((bb=X.a.Lr())&&bb.set("IsCanceled","true"),U.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new J.a,{extendedProperties:bb}))):U.Health.instance.recordKpiFailure("SaveACopySFP",bb,!1,!1,null)})}Hli(){return this.VWa?this.VWa.wpd():(b.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}Qij(wa,sa){if(sa&&1===wa){wa=sa.fileName;var Ya=y.a.t3(this.Gv.Zm);
sa.moreLocationsSelected&&this.cAj(wa,Ya);if(sa.locationCallback){var bb=sa.locationCallback();bb?bb.properties&&"currentHost"===bb.properties.na("type")?this.Vfa.una(wa+Ya,!1,this.Kh):bb.properties&&"SharePoint"===bb.properties.na("type")?(sa=bb.properties.na("siteUrl"),bb=bb.properties.na("folderUrl"),this.FEa.una(bb,wa+Ya,sa,this.Kh)):b.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):b.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else b.ULS.sendTraceTag(579179797,
216,10,"locationCallback is empty")}}}Object(t.a)(M,"ReactSaveAsDialog",null,[333]);class G{constructor(wa,sa,Ya,bb,mb,Ca,$a,Kb=null,rb=null,cc=null){this.La=sa;this.nb=wa;this.QW=bb;this.Vfa=Ca;this.Cs=mb;this.We=Ya;this.Dee=$a;this.zrg=Kb;this.FEa=rb;this.VWa=cc}create(wa){return this.We&&this.We.Oa.mv?new M(this.Dee,this.Cs,this.Vfa,v.AFrameworkApplication.hm,this.We,this.zrg,this.FEa,this.VWa,wa):new x(this.nb,this.La,this.We,this.QW,this.Cs,this.Vfa,this.Dee,wa)}}Object(t.a)(G,"FileNameDialogFactory",
null,[316]);class T{constructor(wa,sa,Ya,bb){this.Ko=this.Ejb=null;this.Ehb=wa;this.We=Ya;this.otg=bb;this.XCa=new c.a(()=>new I.a(sa.value,Object(k.a)(this,this.fvb,"getMoreInfoEventReceived")))}get UDf(){this.Ejb||(this.XCa.value.TY("Save As",!0),this.Ko&&this.Ko.fR&&this.Ko.fR.length&&(this.Ejb=this.kSh(this.Ko.fR)));return this.Ejb}start(wa){if(!this.UDf)if(v.AFrameworkApplication.breadcrumbFolderUrl&&v.AFrameworkApplication.breadcrumbFolderUrl.length)this.Ejb=v.AFrameworkApplication.breadcrumbFolderUrl;
else return b.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Ko),!1;const sa=this.otg();sa.xAj();const Ya=sa.TSh();if(!Ya)return b.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.Ehb.start((bb,mb)=>{sa.hide();wa(bb,mb)},()=>{this.XNa(sa)},Ya,this.Ejb);return!0}XNa(wa){wa.hide();b.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}kSh(wa){wa=
wa.toLowerCase();wa.endsWith("/")||(wa+="/");const sa=wa.indexOf("/documents/");return-1!==sa?wa.substring(0,sa+1)+"_layouts/15/onedrive.aspx":""}fvb(wa){this.Ko||3!==wa.state||(this.Ko=wa)}}Object(t.a)(T,"OneDriveFilePickerHelper",null,[319]);class K extends l.a{constructor(){super()}xAj(){this.PFc="FilePickerDialog";this.ag="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.ze="PickerDialog-MsoSp";this.showDialog("",null)}TSh(){return document.getElementById("FilePickerDiv")}BI(){}Wya(){}}
Object(t.a)(K,"PickerDialog",l.a,[317]);var L=a(639),V=a(831),W=a(371),da=a(27),qa=a(106),O=a(25);class ea{constructor(wa,sa,Ya,bb,mb,Ca,$a){this.nb=wa;this.bHc=Ya;this.La=sa;this.Gkb=bb;this.Ehb=mb;this.SMc=Ca;this.Nlg=$a}Gg(){const wa=this.Ehb.F3a();wa?da.a.aka||this.nb.qa("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.Ie(O.a.saveToSharePoint,qa.a.frame,Object(k.a)(this,this.iVf,"saveToSharePointActionDispatcher"),64):(wa.L7a.continueWith(sa=>{sa.Sf&&this.Ehb.Nzd(sa)}),this.l0b()):b.ULS.sendTraceTag(25180162,
216,15,"Failure with OneDrive API download as the js url is empty.")}l0b(){W.a.TGd(Object(k.a)(this,this.iVf,"saveToSharePointActionDispatcher"));W.a.g7c([new V.a(O.a.saveToSharePoint,qa.a.frame,0)],this.Ehb.F3a())}get V6a(){return this.nb.qa("SaveToAnotherFolderBrsIsEnabled")}get mve(){return this.nb.qa("UserCanWriteRelative")}iVf(wa,sa,Ya,bb,mb){return sa.contextId!==qa.a.frame||wa!==O.a.saveToSharePoint?2:this.V6a&&(this.SMc.UDf||this.mve)?1===Ya?L.SessionStatusManager.instance.u4a||v.AFrameworkApplication.m4?
8:this.Nlg()?32:8:2===Ya?(b.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(mb&&mb.SaveEntryPoint&&"VersionHistory"===mb.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.mve?(b.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.bHc.create(mb).OP(null)):(b.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.Gkb.start(null,mb)),32):8:8}}Object(t.a)(ea,"SaveToSharePointActor",
null,[]);class R{constructor(wa,sa,Ya,bb){this.Kh=this.Iae=null;this.FEa=wa;this.Cs=sa;this.SMc=Ya;this.We=bb}start(wa,sa){b.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Iae=wa;this.Kh=sa;this.SMc.start((Ya,bb)=>{this.E0i(Ya,bb)})||this.nRd()}E0i(wa,sa){if(wa)this.onSuccess(sa);else this.v5(sa)}nRd(){1!==this.We.state&&this.Cs().F5c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(wa){b.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");
if(wa&&wa.data&&wa.data.value&&wa.data.value.length&&wa.data.value[0].sharePoint){const sa=wa.data.value[0].sharePoint.url;wa=wa.data.value[0].sharePoint.listUrl;let Ya=null;if(sa&&(Ya=wa?this.JWh(wa):this.IWh(sa))){this.FEa.una(sa,this.Iae,Ya,this.Kh);return}b.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!sa,!Ya)}b.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.nRd()}IWh(wa){wa.endsWith("/")||
(wa+="/");let sa=0;for(let Ya=0;Ya<wa.length;Ya++)if("/"===wa.charAt(Ya)&&5===++sa)return wa.substr(0,Ya);return null}JWh(wa){wa.endsWith("/")&&(wa=wa.substring(0,wa.length-1));const sa=wa.lastIndexOf("/");return-1!==sa?wa.substring(0,sa):null}v5(wa){b.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");wa&&wa.error?b.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",wa.error.errorCode,wa.error.message):b.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.nRd()}}Object(t.a)(R,"SaveToSharePointManager",null,[276]);var oa=a(80);class pa{constructor(wa,sa,Ya,bb,mb,Ca,$a,Kb){this.MEa=wa;this.qA=sa;this.cVa=bb;this.VNc=Ca;this.V7=Ya;this.Vvg=mb;this.Wea=$a;this.Kh=Kb}execute(wa,sa){if(!v.AFrameworkApplication.Ng&&v.AFrameworkApplication.vd){var Ya=this.MEa+this.Wea;Ya=oa.a.Dl(Ya,"fu",y.a.ff(this.V7));Ya=oa.a.Dl(Ya,"su",y.a.ff(this.Vvg));Ya=oa.a.Dl(Ya,"fn",y.a.ff(this.qA));Ya=oa.a.Dl(Ya,"n",y.a.ff((new Date).getTime().toString()));
this.Kh&&this.Kh.FileDownloadUrl&&(Ya=oa.a.Dl(Ya,"furl",y.a.ff(this.Kh.FileDownloadUrl)));Ya=Ya+"&"+this.VNc;this.cVa&&this.cVa.length?Ya=oa.a.Dl(Ya,"fnn",y.a.ff(this.cVa)):b.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");b.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");v.AFrameworkApplication.vd.Bm(Ya,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,wa,sa,null,void 0,void 0,void 0,void 0,"9")}}}Object(t.a)(pa,"SharePointSaveAsCaller",
null,[295]);class Pa{constructor(wa){this.NEa=wa.appSettings.SaveAsToHostWebServiceBase;this.qA=wa.appSettings.FileName;this.Wea=wa.Va("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(wa,sa,Ya,bb){return new pa(this.NEa,this.qA,wa,sa,Ya,v.AFrameworkApplication.ij,this.Wea,bb)}}Object(t.a)(Pa,"SharePointUploadCallerFactory",null,[275]);var Z=a(41),Ra=a(39),Ga=a(237),Ba=a(684),fa=a(163),Y=a(640),ja=a(762);class ca{constructor(wa,sa,Ya,bb,mb){this.zm=this.fCa=null;this.uDc=!1;this.ZOc=
this.V7=null;this.rRc=sa;this.ekb=Ya;this.Cs=bb;this.We=mb;this.La=wa}una(wa,sa,Ya,bb){this.uDc=!1;b.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.yLb();this.V7=wa;bb&&bb.SaveEntryPoint&&(this.ZOc=bb.SaveEntryPoint);this.fCa=this.rRc.create(wa,sa,Ya,bb);bb&&"true"===bb.SkipSaveToHost?this.WP():this.bCh()}bCh(){const wa=()=>{b.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.WP()};32!==this.La.de(O.a.AQa,2,[()=>{b.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.WP()},wa])&&wa()}WP(){b.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.fCa.execute(Object(k.a)(this,this.lQi,"onSaveToSharePointUploadFinished"),Object(k.a)(this,this.kQi,"onSaveToSharePointUploadFailed"))}lQi(wa){if(wa&&wa.data&&wa.data.Vd){var sa;if(({Ut:sa}=Z.d(wa.data.Vd)).returnValue)if(sa.StatusCode!==Ga.a.FO&&sa.StatusCode!==
Ga.a.Sqb)b.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",wa.data.status,sa.StatusCode),sa.StatusCode!==Ga.a.ZRf&&this.KHe(wa.data.status)||(this.Tca(sa.StatusCode.toString()),this.izj(sa.StatusCode));else{b.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.GJd();try{sa.NewDocumentUrl?this.yPa(sa.NewDocumentUrl):this.zPa()}catch(Ya){b.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",
Ya.toString())}}else b.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:ja.a.qeb(wa.data.Vd)}),this.N5b()||(this.Tca("Failed to deserialize response"),this.wLb())}else b.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.N5b()||(this.Tca("Unknown"),this.wLb())}kQi(wa){wa&&wa.data?this.KHe(wa.data.status)||(b.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Tca(Ba.a[wa.data.status]),this.wLb()):(b.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),
this.N5b()||(this.Tca("Unknown"),this.wLb()))}N5b(){if(!this.uDc)return b.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.uDc=!0,this.WP(),!0;b.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}KHe(wa){b.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",wa);return this.N5b()}zPa(){b.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Ra.a.Ve(this.V7,Ra.a.GW(3),void 0,"UploadToSharePointManager.RedirectToFolder")}yPa(wa){let sa=
!1,Ya=!1;v.AFrameworkApplication.fa&&(sa=v.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),Ya=v.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",wa,sa);if(sa&&Ya){b.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const bb={};bb[D.a.tPa]="1";bb[D.a.documentUrl]=wa;bb[D.a.reason]=Y.a.saveAs;v.AFrameworkApplication.GU().execute(mb=>
{mb.Fj(fa.a.tta,bb)})}else Ra.a.Ve(wa,Ra.a.GW(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}yLb(){this.We&&1===this.We.state||(this.zm=this.ekb(),this.zm.message=CommonUIStrings.l_CommentProgressTooltip,this.zm.Rb=5,this.zm.ft=!1,this.zm.lAa(CommonUIStrings.l_DefaultDialogTitle,null,null))}UHa(){this.zm&&(this.zm.close(),this.zm=null)}wLb(){this.oj(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}hAj(){this.oj(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}pzj(){const wa=
String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.oj(CommonUIStrings.l_SaveAsFileTooLargeTitle,wa,f.a.Rij)}oj(wa,sa,Ya=f.a.Vij){b.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",wa,sa);this.UHa();1!==this.We.state&&this.Cs().mHe(wa,sa,Ya)}izj(wa){b.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",wa);switch(wa){case Ga.a.Hag:this.hAj();break;case Ga.a.ZRf:this.pzj();break;default:this.wLb()}}GJd(){"VersionHistory"===this.ZOc&&
this.La.processAction(O.a.rsc,2)}Tca(wa){"VersionHistory"===this.ZOc&&this.La.de(O.a.JJd,2,{["FailureReason"]:wa})}}Object(t.a)(ca,"UploadToSharePointManager",null,[274]);var aa=a(246),ta=a(778),xa=a(516),ia=a(55);class ya{constructor(){this.Lqa=this.kMc=this.fMc=this.fb=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Rh(wa){this.fb=wa;this.fMc=xa.a.Uq(wa.Wb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.kMc=xa.a.Uq(wa.Wb("Common.IEventEmitter<Common.IMruResult>"));
this.Lqa=xa.a.Uq(wa.Wb("Common.App.SharedFilePicker.ISharedFilePicker"));ia.Task.WAA.call(null,this.fMc,this.kMc,this.Lqa).continueWith(()=>{this.L6i()})}L6i(){this.fb.register(Pa,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Fc(()=>new Pa(v.AFrameworkApplication.fa)).tc();this.fb.register(ca,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Fc(()=>new ca(v.AFrameworkApplication.wb,
this.fb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new ta.a).create(),()=>new e,v.AFrameworkApplication.ta)).tc();this.fb.register(R,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Fc(()=>new R(this.fb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new e,this.fb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),v.AFrameworkApplication.ta)).tc();this.fb.register(T,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Fc(()=>
new T(this.fb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new c.a(()=>this.fMc.result),v.AFrameworkApplication.ta,()=>new K)).tc();this.fb.register(G,"Common.App.SaveToSharePoint.FileNameDialogFactory").Fc(()=>new G(v.AFrameworkApplication.fa,v.AFrameworkApplication.wb,v.AFrameworkApplication.ta,v.AFrameworkApplication.ta.Oa,this.fb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.fb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.fb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new c.a(()=>this.kMc.result),this.fb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Lqa?this.Lqa.result:null)).tc();this.fb.register(ea,"Common.App.SaveToSharePoint.SaveToSharePointActor").Fc(()=>new ea(v.AFrameworkApplication.fa,v.AFrameworkApplication.wb,this.fb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.fb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.fb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
this.fb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>v.AFrameworkApplication.ta.XTg)).tc();v.AFrameworkApplication.fa.qa("SaveToAnotherFolderBrsIsEnabled")&&this.fb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Gg()}static main(){aa.a.instance.yi(new ya)}}Object(t.a)(ya,"PackageManager",null,[4,5]);a.d(C,"a",function(){return ib});const ib=()=>{Type.registerNamespace("Common.App.SaveToSharePoint");ya.main()}},1159:function(t,C,a){var c=a(10);t=a(0);var b=a(691),
d=a(50),f=a(37),e=a(1),k=a(182);class l{constructor(ya,ib){this.$=ya;this.presentModeManager=ib}Nc(){return!1}Cc(ya,ib){if(!e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(ib.command){case 642419866:return!0;case 588342182:return this.presentModeManager.vz;default:return!1}}executeCommand(ya,ib){ya=f.TaskExtensions.fk();ib=ib.command;switch(ib){case 642419866:this.presentModeManager.Jwc(!this.presentModeManager.vz);this.presentModeManager.Vg("TogglePresentMode");
break;case 588342182:this.presentModeManager.I6a=!this.presentModeManager.I6a;this.presentModeManager.j3f(this.presentModeManager.I6a,"TogglePresentModeOverlay");this.presentModeManager.Vg("TogglePresentModeOverlay");break;default:ya=k.a(ib)}return ya}Rc(){return!1}}Object(t.a)(l,"PresentModeCommandHandler",null,[195]);class m extends b.a{constructor(ya){super(ya)}yd(){f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ra(this.$.da,423,424,this.hb),ya=>{this.gd([new l(this.$,ya.result)])},this.la,3)}static ka(ya){b.a.Nd(420,
new m(ya))}}Object(t.a)(m,"PresentModeCommandHandlerFactory",b.a,[]);var v=a(221),n=a(15),w=a(128),r=a(4),u=a(110),y=a(84);class x{}x.Wph="ewa-presentMode-overlay";x.Xph="ewa-presentMode-panel-container";x.Yph="ewa-presentMode-rowHdrParent-container";Object(t.a)(x,"CssClassNames",null,[]);var B=a(19),z=a(5),A=a(148),I=a(289),F=a(131),U=a(368),X=a(170);a(59);var S=a(113),H=a(431),D=a(12),J=a(11),M=a(100),G=a(342),T=a(21),K=a(132),L=a(417),V=a(108),W=a(13),da=a(258),qa=a(245),O=a(173),ea=a(45);class R{constructor(ya){this.lre=
this.$Oa=this.DDd=this.EDd=this.rca=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.Qoc={};this.Poc={};this.WOa=null;this.wGf=0;this.onKeyDown=ib=>{ib=ib.Ca;if(9===ib.keyCode){var wa=this.rca.querySelectorAll(D.DOMElementExtensions.qr);const sa=D.DOMElementExtensions.Kl(wa);wa=D.DOMElementExtensions.fz(wa);D.DOMElementExtensions.Sma(ib,sa,wa);return!0}return!1};this.Rl=()=>{this.$.da.Za(337,ib=>{this.$Oa.getPresentModeFloatieControlsMap().then(wa=>{const sa={};for(let Ya=0;Ya<wa.length;Ya++)sa[wa[Ya].controlId]=
wa[Ya].modelType;wa=ib.h6.Z3a(sa);0<wa.length&&appChrome.api.dispatch(wa);this.pjj()})})};this.$=ya}dispose(){this.$=this.DDd=this.EDd=this.rca=this.$Oa=null}Z9h(){window.requestAnimationFrame(()=>{this.rca=document.createElement("div");this.$.Qu.insertBefore(this.rca,this.$.Qu.lastChild);this.rca.id=this.$.Bb+z.a.N8b;this.rca.classList.add(x.Xph);this.EDd=document.getElementById(this.$.Bb+z.a.t4c);this.DDd=[this.$.yE];this.isInitialized=!0});this.$Oa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();
this.$Oa.initializePresentModeFloatie()}RXh(){const ya={};ya.PollingCountPerCaller=u.a.toJSON(this.Poc);ya.PollingDurationPerCaller=u.a.toJSON(this.Qoc);return ya}mRd(ya){this.isInitialized?ya?(this.$Oa.showPresentModeFloatie(this.rca,this.EDd,this.DDd),this.Vg("ShowOrHideFloatiePanel"),this.O7i()):(this.$Oa.hidePresentModeFloatie(),this.UOj()):n.ULS.sendTraceTag(537154326,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")}Vg(ya){this.wGf=J.HelperMethods.Tb();
this.WOa=ya;this.lre=O.AsyncMethodContext.lr(this.Rl,100,ea.a.l_i+ya,this.lre)}get mc(){return this.rca}get kf(){this.$Oa.updatePresentModeFloatieShyState(2);return!!this.rca}get $d(){return qa.a.KHf}hg(ya,ib){if(ib)return!1;ya=D.DOMElementExtensions.Kl(this.rca.querySelectorAll(D.DOMElementExtensions.qr));if(!ya)return n.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;ya.focus();return!0}kh(ya){return D.DOMElementExtensions.vf(this.mc,
ya)}lj(){}Nj(){}O7i(){da.a(this.$).Xh(this);this.$.da.Za(15,ya=>{this.ewaAccessibilityManager=ya;this.ewaAccessibilityManager.mode=5});V.KeyInputManager.instance.ra(W.a.Kb,this.mc,this.onKeyDown)}UOj(){da.a(this.$).Nz(this);T.g(this.$).U_();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);V.KeyInputManager.instance.Ba(W.a.Kb,this.mc,this.onKeyDown)}pjj(){const ya=J.HelperMethods.Tb()-this.wGf,ib=this.Qoc[this.WOa]?this.Qoc[this.WOa]:0;this.Qoc[this.WOa]=ib>ya?ib:ya;this.Poc[this.WOa]=
this.Poc[this.WOa]?this.Poc[this.WOa]+1:1}}Object(t.a)(R,"PresentModeFloatieManager",null,[478,102,2]);var oa=a(7),pa=a(60);class Pa{constructor(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}}Object(t.a)(Pa,"OverlayCavityInfo",null,[]);class Z{constructor(){this.height=this.width=0}}Object(t.a)(Z,"OverlayContainerInfo",null,[]);class Ra{constructor(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}}Object(t.a)(Ra,"PresentModeOverlayProps",
null,[]);class Ga{constructor(ya){this.OZa=this.FDd=null;this.$=ya;this.gridView=T.g(this.$)}L$h(){this.FDd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(()=>{this.OZa=Array(5);let ya,ib;for(let wa=1;4>=wa;wa++)ya=document.createElement("div"),D.DOMElementExtensions.setVisible(ya,!1),ya.id=`${"PresentModeOverlay"}-${wa}`,D.DOMElementExtensions.toggleCssClass(ya,x.Wph,!0),ib=this.gridView.Lf(wa).domElement,ib.insertBefore(ya,ib.firstChild),
this.OZa[wa]=ya})}i3f(ya){ya&&this.qSj();for(let ib=1;4>=ib;ib++)this.Gef(ib)&&D.DOMElementExtensions.setVisible(this.OZa[ib],ya);D.DOMElementExtensions.toggleCssClass(this.$.dr,"ewr-presentMode-overlay",ya)}qSj(){const ya=this.hTg();let ib;for(let wa=1;4>=wa;wa++)ib=wa,ya[ib]&&this.FDd.showOverlayWithCavity(this.OZa[ib],ya[ib])}dispose(){this.FDd=this.OZa=this.gridView=this.$=null}hTg(){let ya;const ib=T.g(this.$).rtl;let wa;const sa=Array(5);for(let bb=1;4>=bb;bb++)if(ya=bb,this.Gef(bb)){var Ya=
this.gridView.Lf(bb);wa=this.gridView.ha.Pa.pZ?this.HNh(bb,Ya,ib):this.AOh(bb,Ya,ib);Ya=this.M7g(Ya);sa[ya]=this.g8g(this.OZa[ya].id,Ya,wa)}return sa}Gef(ya){return this.gridView.ib.nQ(ya)}M7g(ya){return Object(oa.a)(new Z,{width:ya.Mm.width,height:ya.Mm.height})}g8g(ya,ib,wa){return Object(oa.a)(new Ra,{containerId:ya,overlayContainerInfo:ib,overlayCavityInfos:wa?[wa]:null})}HNh(ya,ib,wa){var sa=T.g(this.$).ha.Pa.$b;if(!sa)return n.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),
null;let Ya,bb;if(({xBa:ya,rotation:sa,translateX:Ya,translateY:bb}=sa.extension.KNh(ya)).returnValue){const mb=ya.x-ib.Mm.x;return Object(oa.a)(new Pa,{left:(wa?ib.Mm.width-(mb+ya.width):mb)-3+1,top:ya.y-ib.Mm.y-3+1,width:ya.width+5,height:ya.height+5,angle:sa,translateX:Ya,translateY:bb})}return null}AOh(ya,ib,wa){ya=this.gridView.lb.jub(this.gridView.ha.sa.activeRange,ya)||pa.a.b3;if(!ya.Ge(ib.Mm))return null;const sa=ya.x-ib.Mm.x;return Object(oa.a)(new Pa,{left:wa?ib.Mm.width-(sa+ya.width)-2:
sa-3,top:ya.y-ib.Mm.y-3,width:ya.width+5,height:ya.height+5})}}Object(t.a)(Ga,"PresentModeOverlayRenderer",null,[477,2]);var Ba=a(61);const fa=(ya,ib,wa,sa,Ya,bb,mb=null)=>{mb=ya.Na(41,mb);mb.shouldEnablePresentMode=ib;return Ba.g(ya,"SetPresentMode",mb,wa,sa,Ya,bb,0)};var Y=a(282);class ja extends Y.a{constructor(ya,ib){super(ya);this.m_i=()=>{this.sca.mRd(!0)};this.sca=ib;this.domElement.classList.add("ewr-presentMode-on");ya={[ja.Tu]:this.oc};this.Rb=0;this.initializeAndShow("",this.m_i,ya)}get oc(){return"PresentModeWelcomeDialog"}hide(){super.hide();
w.a.Mw(z.a.o3f,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)}}Object(t.a)(ja,"PresentModeWelcomeDialog",Y.a,[]);class ca{static get nDh(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static get oDh(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?
"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}static requestFullscreen(ya){ya.webkitRequestFullscreen?ya.webkitRequestFullscreen():ya.msRequestFullscreen?ya.msRequestFullscreen():ya.mozRequestFullScreen?ya.mozRequestFullScreen():ya.requestFullscreen?ya.requestFullscreen():n.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?
document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():n.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get ihi(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(t.a)(ca,"FullscreenUtils",null,[]);class aa{constructor(ya){this.Sna=
this.UTe=this.ZFb=this.P1a=this.ipc=this.sca=this.bPa=null;this.opd=this.KNb=this.UKd=!1;this.cLb=!0;this.Uec=!1;this.rRd=!0;this.JNb=this.v0a=this.BAe=0;this.$tc={};this.$nc={};this.Znc={};this.JHf=0;this.I6a=this.D8d=!1;this.v$i=()=>{D.DOMElementExtensions.toggleCssClass(this.$.dr,"ewr-presentMode-transition",!1);$removeHandler(this.P1a,"transitionend",this.Sna)};this.Yi=()=>{parseInt(this.$.Qu.style.right,10)!==this.BAe&&window.requestAnimationFrame(()=>{this.uAc(0);this.$.Tya(I.a.NY("PresentModeManager.OnContentAreaResized"))})};
this.H5=()=>{var ib=Object(y.a)(M.a,this.$.pa);if(ib&&this.vz){this.gridView.tfc=!1;ib=ib.headersVisible;var wa=T.g(this.$).rtl;D.DOMElementExtensions.toggleCssClass(this.$.dr,"ewr-presentMode-on-headers-off",!ib);D.DOMElementExtensions.toggleCssClass(this.$.dr,"ewr-presentMode-on-rtl",wa);(12!==this.v0a&&!ib||32!==this.v0a&&ib&&!wa||0!==this.v0a&&ib&&wa)&&window.requestAnimationFrame(()=>{this.uAc(2)})}};this.$c=()=>{this.baf();this.Vg("OnWorkbookOpened");n.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};
this.yp=()=>{this.opd=!0;this.Zda("OnSelectionStarted")};this.yg=()=>{this.opd=!1;this.Zda("OnSelectionEnded");this.dVf()};this.nh=()=>{this.Zda("OnEditStarted")};this.Jf=()=>{this.Zda("OnEditEnded")};this.xw=()=>{if(!this.Uec){const ib=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");this.Zda("OnVisibleAreaChanged",!0,ib)}};this.sDb=()=>{this.Uec=!0};this.sn=()=>{this.Zda("OnCurrentSelectionModeChanged");this.dVf();this.Vg("OnCurrentSelectionModeChanged")};this.Lm=
()=>{this.Zda("OnBlockCacheItemEvicted")};this.nf=()=>{this.Zda("OnBlockCacheItemChanged")};this.EF=()=>{this.Uec||this.Zda("OnActiveItemPanesChanged")};this.Gh=()=>{this.Uec=!1;this.sca.Vg("ActiveSheetChanged");this.H5()};this.yEb=(ib,wa)=>{if(ib=Object(y.a)(M.a,wa.item))ib.gpb(16,!0),ib.hYa(this.H5)};this.IJi=()=>{ca.ihi||(this.ipc&&this.ipc.pp&&this.ipc.hide(),T.g(this.$).eb&&T.g(this.$).Go(!0),this.Jwc(!1),n.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};
this.JJi=()=>{n.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=ya;this.gridView=T.g(this.$);this.$jj=ya.ya.PresentModeRenderUpdateTimeout;this.initialize(ya)}get vz(){return this.D8d}Jwc(ya){this.vz!==ya&&(this.D8d=ya,this.I6a=this.vz,this.baf(),this.cLb=this.X1f(),window.requestAnimationFrame(()=>{D.DOMElementExtensions.toggleCssClass(this.$.dr,"ewr-presentMode-transition",!0);$addHandler(this.P1a,"transitionend",this.Sna);
this.nAj(!ya);this.bVi();D.DOMElementExtensions.toggleCssClass(this.$.dr,"ewr-presentMode-on",ya);this.mAj(ya);A.b(this.$).g3f(this.vz);A.c(this.$).g3f(this.vz);this.$.uza();this.bPa.i3f(this.cLb);if(this.vz){this.aZa();w.a.get(z.a.o3f)?this.sca.mRd(this.vz):this.ipc=new ja(this.$,this.sca);var ib=L.b(this.$);ib&&(this.UKd=ib.R6c(!1));this.JHf=J.HelperMethods.Tb()}else this.sca.mRd(ya),this.UKd&&(ib=L.b(this.$))&&(ib.R6c(!0),this.UKd=!1),this.Z4b(),this.Tui()}))}j3f(ya,ib){this.rRd=ya;this.Zda(ib)}Vg(ya){this.sca.Vg(ya)}dispose(){this.Z4b();
this.bPa&&(this.bPa.dispose(),this.bPa=null);this.gridView=this.$=null}nAj(ya){const ib=this.$.da.za(25);void 0===ib||null===ib?n.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):ya?ib.Dwc():ib.wcc()}bVi(){D.DOMElementExtensions.toggleCssClass(document.getElementById(r.AFrameworkApplication.$1a),B.a.Np,this.vz);D.DOMElementExtensions.toggleCssClass(this.$.dr,"ewr-presentMode-on",this.vz);this.qAj(this.vz);this.gridView.tfc=!this.vz;this.GSj();this.$.da.Za(32,
ya=>{ya.cTj(this.vz)});S.b(this.$,ya=>{ya.Ccg(this.vz)})}qAj(ya){if(this.ZFb)if(ya){if(ya=Object(y.a)(M.a,this.$.pa))D.DOMElementExtensions.toggleCssClass(this.$.dr,"ewr-presentMode-on-headers-off",!ya.headersVisible),D.DOMElementExtensions.toggleCssClass(this.$.dr,"ewr-presentMode-on-rtl",T.g(this.$).rtl);this.uAc(0)}else this.$.dr.classList.remove("ewr-presentMode-on-headers-off"),this.$.dr.classList.remove("ewr-presentMode-on-rtl"),this.uAc(1)}uAc(ya){var ib=Object(y.a)(M.a,this.$.pa);if(ib){var wa=
parseInt(this.$.Qu.style.right,10);if(1===ya||2===ya){if(isNaN(wa)||wa<this.v0a)return;wa-=this.v0a}if(0===ya||2===ya)ya=ib.headersVisible,ib=T.g(this.$).rtl,ya=ya?ib?0:32:12,wa=isNaN(wa)?ya:wa+ya,this.v0a=ya;this.$.Qu.style.right=J.HelperMethods.pc(wa);this.BAe=wa}}GSj(){const ya=document.getElementById(this.$.Bb+z.a.A4b).parentNode;D.DOMElementExtensions.toggleCssClass(ya,x.Yph,this.vz)}initialize(ya){this.bPa=new Ga(ya);this.bPa.L$h();this.sca=new R(ya);this.sca.Z9h();this.P1a=document.getElementById("MainApp");
this.UTe=this.IJi;$addHandler(this.P1a,ca.nDh,this.UTe);$addHandler(this.P1a,ca.oDh,this.JJi);this.ZFb||(this.ZFb=document.createElement("div"),this.ZFb.className="ewa-presentMode-right-frame",this.$.yE.appendChild(this.ZFb));this.Sna=this.v$i}aZa(){this.gridView.ha.N1(this.yp);this.gridView.ha.IX(this.yg);this.gridView.hc.Nk(this.nh);this.gridView.hc.em(this.Jf);this.gridView.hC(this.sn);this.gridView.view.Ls(this.xw);this.gridView.HTc(this.sDb);this.gridView.Ea.MG(this.Lm);this.gridView.Ea.Ks(this.nf);
this.$.xa.Pf(this.Gh);this.$.xa.lra(this.EF);this.$.xa.lga(this.yEb);this.$.EA(this.Yi);this.$.el(this.$c);const ya=Object(y.a)(G.a,this.$.xa);for(const ib of ya.items)ib.hYa(this.H5)}Z4b(){this.gridView&&(this.gridView.ha.m6(this.yp),this.gridView.ha.RV(this.yg),this.gridView.hc.tk(this.nh),this.gridView.hc.yl(this.Jf),this.gridView.AD(this.sn),this.gridView.view.Pq(this.xw),this.gridView.dId(this.sDb),this.gridView.Ea.mI(this.Lm),this.gridView.Ea.Nq(this.nf));if(this.$){this.$.xa.zg(this.Gh);this.$.xa.kza(this.EF);
this.$.xa.pma(this.yEb);this.$.zD(this.Yi);this.$.Al(this.$c);const ya=Object(y.a)(G.a,this.$.xa);for(const ib of ya.items)ib.Nrc(this.H5)}}X1f(){if(!this.vz||!this.I6a)return!1;if(1===this.gridView.ha.Je){const ya=this.$.pa.activeRange.isSingle,ib=1===this.$.pa.selectedRanges.length&&!ya,wa=this.gridView.eb,sa=this.opd;ib||n.ULS.sendTraceTag(537154322,0,50,`PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : ${ya}`);return this.rRd&&ib&&!wa&&
!sa}return this.rRd}mAj(ya){ya?ca.requestFullscreen(this.P1a):ca.exitFullscreen()}Zda(ya,ib=!1,wa=!1){ib||(this.cLb=this.X1f());n.ULS.sendTraceTag(555356484,0,100,`PresentModeManager.UpdateLayout: UpdateLayout triggered by ${ya}, visibility: ${this.cLb}, immediateUpdate: ${wa}`);if(this.KNb&&wa)n.ULS.sendTraceTag(543023559,0,50,`PresentModeManager.UpdateLayout: Cancel update layout for ${this.JNb}`),window.cancelAnimationFrame(this.JNb),this.JNb=0;else if(this.KNb){n.ULS.sendTraceTag(543023558,0,
50,`PresentModeManager.UpdateLayout: Skipping update layout for ${ya}`);return}wa?this.HXd(J.HelperMethods.Tb(),ya):(this.JNb=window.requestAnimationFrame(sa=>{this.HXd(sa,ya)}),this.KNb=!0)}HXd(ya,ib){var wa=J.HelperMethods.Tb();if(wa-ya>this.$jj)this.JNb=window.requestAnimationFrame(Ya=>{this.HXd(Ya,ib)}),this.KNb=!1,n.ULS.sendTraceTag(537154319,0,50,`PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = ${wa-ya}ms.`);else{this.bPa.i3f(this.cLb);this.KNb=!1;var sa=
J.HelperMethods.Tb();ya=J.HelperMethods.Tb()-ya;wa=sa-wa;this.ajj(ya,ib);n.ULS.sendTraceTag(537154318,0,50,`PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = ${wa}ms. rafTotalDuration = ${ya}ms`)}}baf(){U.a(this.$.userOperationManager,(ya,ib,wa)=>fa(this.$.oa.va,this.vz,ya,ib,wa,null),ya=>new X.a(252,0,ya),null)}dVf(){let ya=H.a(this.gridView.Je);1!==this.gridView.Je||this.$.pa.activeRange.isSingle||(ya="Range");this.$tc[ya]=this.$tc[ya]?this.$tc[ya]+1:1}ajj(ya,ib){const wa=this.$nc[ib]?
this.$nc[ib]:0;this.$nc[ib]=wa>ya?wa:ya;this.Znc[ib]=this.Znc[ib]?this.Znc[ib]+1:1}Tui(){const ya={};var ib=J.HelperMethods.Tb()-this.JHf;ya.PresentModeDuration=ib;ya.SelectionCountPerObject=u.a.toJSON(this.$tc);ya.OverlayCountPerCaller=u.a.toJSON(this.Znc);ya.OverlayDurationPerCaller=u.a.toJSON(this.$nc);ib=this.sca.RXh();for(let wa in ib)ya[wa]=ib[wa];K.b(this.$).Cd(F.a.k_i,ya,void 0,!0)}}Object(t.a)(aa,"PresentModeManager",null,[366,2]);var ta=a(196);class xa extends v.a{constructor(ya){super();
this.$=ya;this.Fb()}create(){const ya=d.GetServiceTaskFactory.Ra(this.$.da,283,284,1);f.TaskExtensions.Aa(ya,()=>{f.TaskExtensions.Aa(ta.c(ya.result.Zn.loadScript("presentMode")),()=>{let ib=this.$.da.za(423);ib||(ib=new aa(this.$),this.$.da.Ga(423,ib));this.qb(ib)},this.$.la,3)},this.$.la,3)}static ka(ya){ya.da.Ga(424,new xa(ya))}}Object(t.a)(xa,"PresentModeManagerFactory",v.a,[]);a.d(C,"a",function(){return ia});const ia=()=>{c.a.Fa(ya=>{xa.ka(ya);m.ka(ya)})}},1163:function(t,C,a){var c=a(10);t=
a(0);var b=a(550),d=a(691),f=a(50),e=a(37),k=a(15),l=a(1232),m=a(4),v=a(163),n=a(751),w=a(98),r=a(262),u=a(640),y=a(27),x=a(155),B=a(177),z=a(287),A=a(5),I=a(147),F=a(102),U=a(77),X=a(74),S=a(368),H=a(170),D=a(59),J=a(61),M=a(321),G=a(583),T=a(1327),K=a(414),L=a(314),V=a(14);class W extends T.a{constructor(yb,Ob){super(yb,void 0,void 0,Ob)}get BNa(){return V.a.instance.Xa(413)}get zic(){return V.a.instance.Xa(414)}get yic(){return"DownloadOdsLink"}get XAb(){return"#"}get G7a(){return V.a.instance.Xa(415)}get vpf(){return!0}Zkf(){k.ULS.sendTraceTag(537162658,
0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")}alf(){k.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")}sic(){K.Redirect.showHelp(L.a.lEi);return!0}}Object(t.a)(W,"DownloadACopyAsOdsDialog",T.a,[]);class da{constructor(yb,Ob){this.dialog=null;this.Cvf=()=>{this.dialog&&this.dialog.hide()};this.HEi=yb;this.rb=Ob;this.rb.Bmb(this.Cvf)}rre(yb){this.dialog=yb}M5c(){this.HEi.cEf(-1059172980)}dispose(){this.rb.HHb(this.Cvf)}}
Object(t.a)(da,"DownloadACopyAsOdsDialogDownloadBehavior",null,[294,2]);const qa=(yb,Ob,Ja,lb,Pb,Jb,Lb=null)=>{Lb=yb.Na(9,Lb);Lb.isReadOnlyRecommended=Ob;return J.g(yb,"SetReadOnlyRecommended",Lb,Ja,lb,Pb,Jb,0)},O=(yb,Ob,Ja,lb,Pb,Jb,Lb=null)=>{Lb=yb.Na(9,Lb);Lb.calc_type=Ob;return J.g(yb,"SetCalculationOptions",Lb,Ja,lb,Pb,Jb,0)};class ea{constructor(yb){this.calculationMode=0;this.calculationMode=yb}}Object(t.a)(ea,"MacroRecorderWorkbookCalculationModeSetPayload",null,[101]);class R{constructor(yb){this.calculateType=
0;this.calculateType=yb}}Object(t.a)(R,"MacroRecorderWorkbookRecalculatedPayload",null,[101]);var oa=a(85),pa=a(144),Pa=a(188),Z=a(13),Ra=a(108),Ga=a(1);T=a(260);class Ba{static get YTi(){return Ba.XTi}}Ba.XTi="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(t.a)(Ba,"OpenInAppDialogCopyHtml",null,[]);var fa=a(151);class Y extends T.a{constructor(yb){super(yb);this.WH=null;this.ADb=()=>{k.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(this.$.ya.IsMeetingLiveSession)return this.ECc(),!0;y.a.hp?(k.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),this.vx&&this.vx.length||k.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),this.openUrl("intent:"+this.vx+"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+
this.rm+";end","_top")):9<=y.a.ijd?(k.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),this.openUrl(this.hla,"_top"),window.setTimeout(()=>{this.openUrl(this.rm,"_blank")},9E3)):(k.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),this.openUrl(this.hla,"_top"),window.setTimeout(()=>{this.openUrl(this.rm,"_blank")},500));
return!0};this.hOa=Ob=>Ob.Ca.keyCode===oa.a.$h||Ob.Ca.keyCode===oa.a.moa?(k.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),Ob.Cb.click(),!0):!1;1===m.AFrameworkApplication.ta.Oa.xj&&(this.vx=this.$.workbookContext.ClientUrl,this.hla="ms-excel:ofe|u|"+this.vx,this.rm=m.AFrameworkApplication.fa.Va("AppUrl"),y.a.Xaa?this.rm="itms-apps://"+m.AFrameworkApplication.fa.Va("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":y.a.hp&&(Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",
!1)&&this.$.ya.IsMeetingLiveSession?(k.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),this.rm=m.AFrameworkApplication.fa.Va("WildFireMarketUrlExcelAndroid")):y.a.Oyb?this.rm=m.AFrameworkApplication.fa.Va("WildFireUrlChinaStoreAndroid"):4<y.a.aVc.vNa&&(this.rm=m.AFrameworkApplication.fa.Va("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac")))}get oc(){return"OpenInAppDialogCopy"}openUrl(yb,Ob){let Ja=document.getElementById("link");
Ja||(Ja=document.createElement("a"),Ja.id="link",Ja.style.visibility="hidden",Ja.href="",document.body.appendChild(Ja));Ja.target=Ob;Ja.href=yb;Ja.click()}ECc(){k.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");e.TaskExtensions.Aa(f.GetServiceTaskFactory.Ra(this.$.da,21,137,1),yb=>{let Ob={};Ob.OpenInAppUrl=this.hla;Ob.StoreUrl=this.rm;yb.result.Fj("UI_OpenInMobileApp",Ob)},this.$.la)}ZTi(){k.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")}vg(){this.ag=
pa.a.ap(Ba.YTi,V.a.instance.ga(667),V.a.instance.ga(668),m.AFrameworkApplication.fB,fa.getImageClass(m.AFrameworkApplication.fa.Va("AppIcon")),V.a.instance.ga(669));this.ze="OpenInAppDialog";this.Rb=5;this.initializeAndShow("",this.ZTi.bind(this),null);this.yI(this.WH)}uv(yb){super.uv(yb);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.WH=document.getElementById("LinkToInstall");Pa.a.instance.ra(Z.a.click,this.WH,this.ADb);Ra.KeyInputManager.instance.ra(Z.a.Fd,this.WH,
this.hOa)}dispose(){this.WH&&(Pa.a.instance.Ba(Z.a.click,this.WH,this.ADb),Ra.KeyInputManager.instance.Ba(Z.a.Fd,this.WH,this.hOa),this.WH=null);super.dispose()}}Object(t.a)(Y,"OpenInAppDialogCopy",T.a,[]);var ja=a(133),ca=a(370);class aa{constructor(yb){this.F6h="itms-apps://";this.G6h="apps.apple.com/app/apple-store/id586683407?mt=8&pt=80423&ct=miniWAC";this.Sig=Ob=>{1==Ob&&this.ECc()};this.$=yb;this.vx=m.AFrameworkApplication.ta.Oa.vx;this.hla="ms-excel:ofe|u|"+this.vx;this.rm=m.AFrameworkApplication.fa.Va("AppUrl");
y.a.Xaa||y.a.Ug?this.rm=this.F6h+this.G6h:y.a.hp&&(m.AFrameworkApplication.fa.qa("UseAppAndroidMarketURL")?(k.ULS.sendTraceTag(523534414,306,100,"OpenInAppDialogReact: Using app android market url"),this.rm=m.AFrameworkApplication.fa.Va("WildFireMarketUrlExcelAndroid")):y.a.Oyb?this.rm=m.AFrameworkApplication.fa.Va("WildFireUrlChinaStoreAndroid"):4<y.a.aVc.vNa&&(this.rm=m.AFrameworkApplication.fa.Va("WildFireUrlExcelAndroid")))}ECc(){k.ULS.sendTraceTag(523534413,306,50,"OpenInAppDialogReact: OpenInAppForLiveFiles API invoked");
e.TaskExtensions.Aa(f.GetServiceTaskFactory.Ra(this.$.da,21,137,1),yb=>{let Ob={};Ob[ca.a.iEf]=this.hla;Ob[ca.a.rm]=this.rm;yb.result.Fj("UI_OpenInMobileApp",Ob)},this.$.la)}vg(){k.ULS.sendTraceTag(523534412,0,50,"initializeAndShowDialog: React Edit in app dialog opened.");const yb=new ja.StandardDialog;yb.Rb=0;yb.rc(1,V.a.instance.ga(673));yb.wl(V.a.instance.ga(671),V.a.instance.ga(672),0,this.Sig)}}Object(t.a)(aa,"OpenInAppDialogReact",null,[]);T=a(282);class ta extends T.a{constructor(yb){super(yb);
this.sessionId=yb.ya.UserSessionId;this.zQg=yb.ya.BuildVersion}get oc(){return"WACSessionIdDialog"}KM(){return{[ta.Bnj]:V.a.instance.ga(674),[ta.Cnj]:this.sessionId,[ta.id]:"WACSessionIdDialog",[ta.FXc]:V.a.instance.ga(675),[ta.buildVersion]:this.zQg}}vg(){const yb=this.KM();this.Rb=5;this.initializeAndShow(V.a.instance.ga(1025),this.yWj.bind(this),yb)}yWj(){k.ULS.sendTraceTag(521434688,306,100,"Show WACSessionIdDialogHandler invoked")}}ta.id="id";ta.Bnj="sessionIdLabel";ta.Cnj="sessionIdValue";ta.FXc=
"buildLabel";ta.buildVersion="buildVersion";Object(t.a)(ta,"WACSessionIdDialog",T.a,[]);var xa=a(28),ia=a(29),ya=a(352),ib=a(11),wa=a(182),sa=a(280),Ya=a(21),bb=a(42),mb=a(249),Ca=a(456),$a=a(374),Kb=a(51),rb=a(6),cc=a(140),nc=a(967),Wb=a(81),Ea=a(36),ua=a(298),ma=a(252);class fb{fQ(yb,Ob){yb=ia.a.Yc(12,1,676,0,0,0,"Blank");yb.Description=String.format(V.a.instance.ga(677),Ob);return yb}C9b(yb){switch(yb){case 1:case 2:return 0;default:return 2}}}Object(t.a)(fb,"ReloadCloseConfirmation",null,[113]);
var sb=a(149),Ua=a(584),ab=a(68),na=a(55),Na=a(175);class Va extends B.a{constructor(yb,Ob,Ja,lb){super();this.$=yb;this.businessBar=lb;this.openInExcelOperation=Ob;this.$J=Ja}get fc(){return this.$.ea.fc}get workbookContext(){return this.$.workbookContext}get P5b(){return this.$.workbookContext.FullDocumentInfo}get clientWorkflow(){return ab.a(this.$)}get jc(){return this.$.jc}Nc(){return!1}executeCommand(yb,Ob,Ja,lb){const Pb=this.P5b,Jb=this.$,Lb=Ob.command,Ab=this.openInExcelOperation,nb=this.$.Bb,
va=Ja.SourceControlId;Jb.Xk.Xke(Lb);Ab.qvc(Ob.startTime.getTime().toString());yb=null;switch(Lb){case 1455037301:this.$.v4?Ab.LAe():Ab.q1c();break;case -2044628748:case 2004484710:this.$.v4?Ab.LAe():Ab.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===va?(this.zBb("CellLongPress"),k.ULS.sendTraceTag(576495705,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):(this.zBb("PencilIcon"),k.ULS.sendTraceTag(576495704,
0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case 924877417:k.ULS.sendTraceTag(520372316,0,50,"User clicked the reload button");const db=ab.a(this.$).jd.activityState;bb.a(Jb).ls(new mb.a(rb.a.Mx,5,()=>{db[ma.a.oq]=rb.a.Zi}));break;case 480922297:Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowWacSessionIdDialogOnMobile",!1)&&(new ta(this.$)).vg();break;case -2028960985:Ab.$4f();break;
case -1059172980:new W(Ab.Mte(Lb),new da(Ab,Jb.rb));break;case -1285148982:this.clientWorkflow.jd.activityState[Ea.a.HSc]=!0;this.yzc(!1);break;case -75280711:this.yzc(!1);break;case -455164169:this.yzc(!0);break;case -1388494670:this.$.da.Za(400,tc=>{tc.Txi();this.yzc(!1)});break;case 810888577:m.AFrameworkApplication.ik=(new Date).getTime();k.ULS.sendTraceTag(537162656,0,50,`FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to ${m.AFrameworkApplication.ik}`);break;case -1804063550:case -974518828:Ob=
0;A.a.hBd in Ja&&(Ob=Ja[A.a.hBd]);Ab.cEf(Lb,Ob);break;case -1339961039:Ob=!1;Ja&&A.a.EIb in Ja&&(Ob=Ja[A.a.EIb]);this.reloadWorkbook(!1,Ob);break;case -8805455:const Xa=this.workbookContext;Jb.isEditMode||(Va.rye(Jb),yb=e.TaskExtensions.Aa(this.$J.value,tc=>{tc=tc.result;var Ma=tc.isEnabled();Ma&&G.a(tc,v.a.copyAndEdit,D.a.tg.MWe(),this.$.ea.Tg.get(2))?k.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):
Ma&&m.AFrameworkApplication.Zdg?(Ma={},Ma[l.a.eEd]=m.AFrameworkApplication.userSessionId,Ma[m.AFrameworkApplication.dAi]=xa.a.Wa.Nb.getTime().toString(),k.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),tc.Fj(v.a.editMode,Ma)):Pb.CopyAndEditUrl?this.P2g():(this.jc.supportsEditing||Xa.EditUrl)&&this.reloadWorkbookInEditMode()},this.la,3));break;case -723527778:Jb.isEditMode&&(Va.rye(Jb),
this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:const gb=Jb.oa.va.Sb(),Ha=-1355155015===Lb?1:0,tb=()=>new R(Ha);yb=S.a(this.$.userOperationManager,(tc,Ma,Tb)=>J.y(Jb.oa.va,Ha,null,tc,Ma,Tb,null,gb),tc=>new H.a(128,0,tc,void 0,tb),Ob);Ya.g(Jb).Df.XG(!1);break;case -1158102843:yb=Ya.g(Jb).Df.recalcSheet(Ob);Ya.g(Jb).Df.XG(!1);break;case -988468372:if(Ga.EwaSettings.ma(301))if(lb=parseInt(Ja[U.a.Pc],10),0<=lb&&3>lb)this.setCalculationMode(Ob,lb);else return k.ULS.sendTraceTag(537162652,
0,10,`SetCalculationMode , unexpected menuItemId: ${Ja[U.a.Pc]}`),wa.a(Lb);break;case 257398710:I.a.ntw(Pb.ReportAbuseUrl,Jb);break;case 1800405051:this.Xij();break;case -48469327:this.saveACopy();break;case 214430355:Ob=!1;Ja&&A.a.r6c in Ja&&(Ob=Ja[A.a.r6c]);if(!this.Pwj(Ob,Ja))break;m.AFrameworkApplication.m4?this.businessBar.Yf(42,null):this.businessBar.Yf(Ob?22:23,null);break;case 1389557314:yb=e.TaskExtensions.Aa(this.$J.value,tc=>{G.a(tc.result,v.a.Gyh,null,this.$.ea.Tg.get(6))||I.a.ntw(Pb.FileVersionUrl,
Jb)},this.la,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:va===nb+A.a.Yhf?Ab.wqi():Ab.vqi();break;case 512141517:va===nb+A.a.Xhf?Ab.Gqi():Ab.Fqi();break;case -1224038235:const bc=n.a.On in Ja?!Ja[n.a.On]:F.j(Jb.ea.workbookContext.Options);Ja[n.a.Description]=bc?V.a.instance.ga(576):V.a.instance.ga(577);yb=S.a(this.$.userOperationManager,(tc,Ma,Tb)=>qa(this.$.oa.va,!bc,tc,Ma,Tb,null),tc=>new H.a(129,0,tc),Ob);break;case 1118926154:if(this.$.isEditMode){const tc=new x.a;this.$.da.Za(53,
Ma=>{Ma?(Ma.Vl.oqi(this.$.Bb+A.a.Pqd),tc.setResult(!0)):k.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});yb=tc.task}break;case -1698025133:Ab.openInBrowser();break;case 520859864:yb=e.TaskExtensions.Aa(f.GetServiceTaskFactory.Ra(this.$.da,393,394,lb.ija()),tc=>{tc.result||k.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.la,3);break;default:yb=wa.a(Lb)}return yb||na.Task.Ta(!0)}zBb(yb){if(ib.HelperMethods.rZ){const Ob=
new Map;Ob.set("EntryPoint",yb);w.Health.instance.recordKpiUsage($a.a.WTi,0,Ca.a.Qzi,Ob)}else k.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")}showOpenInAppDialog(){m.AFrameworkApplication.isMobileMode&&(this.$.ya.IsMeetingLiveSession&&Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OpenInAppExcelReactDialog",!1)?(k.ULS.sendTraceTag(522859990,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app React dialog used"),
(new aa(this.$)).vg()):Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(k.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new Y(this.$)).vg()):(k.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),m.AFrameworkApplication.showOpenInAppDialog()))}Pwj(yb,Ob){return m.AFrameworkApplication.isMobileMode&&!X.a(this.$.ya,30)?
(this.showOpenInAppDialog(),k.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.zBb("CellDoubleTap"),k.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),!1):m.AFrameworkApplication.Sfc&&(yb&&ya.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(k.ULS.sendTraceTag(537162645,
0,50,`FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .${ya.d(this.workbookContext.WorkbookFileName)?"xls":"csv"}, HostEditUrl ${this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""}empty. Skipped prompt to edit`),!1):r.a.any([25,26,30,31,57,32,34],Ja=>this.businessBar.FLa(Ja))?(k.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),
!1):Ob&&A.a.W0i in Ob&&!yb?!1:!0}Cc(yb,Ob){yb=!1;switch(Ob.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:yb=!0;break;case 480922297:case 520859864:yb=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?
!0:!1;break;case 924877417:yb=Na.a.und?!0:!1;break;case -1285148982:case -75280711:case -455164169:yb=Ga.EwaSettings.ma(108);break;case -1388494670:yb=Ga.EwaSettings.ma(108);break;case 810888577:yb=Ga.EwaSettings.ma(270);break;case -1224038235:yb=this.$.ea.amIAlone;break;case -988468372:yb=Ga.EwaSettings.ma(301);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:yb=!0,k.ULS.shipAssertTag(537162642,0,this.$.Vja,"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return yb}Rc(){return!1}Xij(){if(this.fc){var yb=
this.$;bb.a(yb).ls(new mb.a(rb.a.Mx,5,()=>{yb.kI(!1,!0);const Ob=this.clientWorkflow.jd.activityState;Ob[ma.a.oq]=rb.a.cda;Ob[cc.a.WS]=2;Ob[Ea.a.Fr]=yb.isEditMode;Ob[cc.a.aga]=!1}))}}saveACopy(){if(this.fc){var yb=this.$;bb.a(yb).ls(new mb.a(rb.a.Mx,5,()=>{yb.kI(!1,!1);const Ob=this.clientWorkflow.jd,Ja=Ob.activityState;Ja[ma.a.oq]=rb.a.HUf;Ja[Ua.a.AXb]=this.jc.hasUnsupportedFeaturesForEdit;Ja[cc.a.aga]=!1;Ob.$q(ia.a.L$(this.businessBar.K6c,[-502303485]))}))}}yzc(yb){bb.a(this.$).ls(new mb.a(rb.a.Qma,
2,()=>{this.$.kI(!0,!0);var Ob=ab.a(this.$).jd,Ja=this.$.isEditMode;Ja=ia.a.Yc(1,1,0,0,0,Ja?-315732528:-2087635043,Ja?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Ja.ForceVersionUpgrade=yb;Ob.$q([Ja]);Ob=ab.a(this.$).jd.activityState;Ob[ma.a.oq]=rb.a.Qma;Ob[Ea.a.Fr]=this.$.isEditMode;Ob[cc.a.aga]=!1}))}closeWorkbook(){if(this.fc){var yb=this.$;D.a.tg.Svc("2145659238")?e.TaskExtensions.Aa(this.$J.value,Ob=>{Ob.result.Fj(v.a.eRe,{})},this.la,3):bb.a(yb).ls(new mb.a(rb.a.Mx,5,()=>{yb.kI(!0,
!1);const Ob=this.clientWorkflow.jd.activityState;Ob[cc.a.CX]=!1;Ob[cc.a.aga]=!1;this.jc.inViewerFromWebPart?(M.a.UEd(yb,this.clientWorkflow.jd),yb.Xk.Ky("InViewerFromWebPart"),Ob[ma.a.oq]=rb.a.UZ):(Ob[ma.a.oq]=rb.a.Jj,yb.Bd&32?Ob[cc.a.WS]=0:(Ob[cc.a.WS]=1,Ob[cc.a.pXb]=new nc.a),Ob[sb.a.uje]=!0)}))}}P2g(){const yb=this.jc.vbaRemovedDuringConversion;k.ULS.sendTraceTag(537162636,0,50,`FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = ${yb}`);const Ob=this.$;yb?bb.a(Ob).ls(new mb.a(rb.a.Mx,
5,()=>{const Ja=ia.a.Yc(3,0,0,1267,0,1069271157,"XLSMacroFailure");this.clientWorkflow.jd.$q([Ja]);this.clientWorkflow.jd.activityState[ma.a.oq]=rb.a.keb})):m.AFrameworkApplication.hideHeader?ib.HelperMethods.Ve(this.P5b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):I.a.ntw(this.P5b.CopyAndEditUrl,Ob)}reloadWorkbookInEditMode(){if(this.fc)if(D.a.tg.YU&&D.a.tg.HGd(),m.AFrameworkApplication.Sfc&&!m.AFrameworkApplication.lba)ib.HelperMethods.Ve(this.$.uob(!0),z.a.blank,
void 0,"FileOperationCommandHandler.BuildHostUrl");else{var yb=this.$,Ob=!1,Ja=this.jc.hasUnsupportedFeaturesForEdit,lb=this.workbookContext.FileWasRepaired;ya.d(this.workbookContext.WorkbookFileName)?(Ob=!0,k.ULS.sendTraceTag(537162634,0,50,`FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = ${Ja}`)):ya.a(this.workbookContext.WorkbookFileName)&&(Ob=!0,k.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));
var Pb=yb.me.get(59);Pb=!(yb.ea.jc.supportsEditing&&Pb);if(Ob&&!Ja||Pb&&(Ob||Ja)){let Jb;Jb=Pb?Ja?-2066104278:816071846:Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&X.a(this.$.ya,25)&&!this.$.zzb?765011943:-213064907;Ob=()=>{const Lb=ia.a.EZa([Jb]);this.clientWorkflow.jd.$q(Lb);this.clientWorkflow.jd.activityState[ma.a.oq]=rb.a.keb}}else Ob=()=>{yb.kI(!0,!1);var Jb=this.clientWorkflow.jd;const Lb=Jb.activityState;Lb[cc.a.WS]=1;Lb[ua.a.uXb]=u.a.fkc;Lb[Ea.a.Fr]=!0;Lb[Ua.a.AXb]=
this.jc.hasUnsupportedFeaturesForEdit;Lb[cc.a.aga]=!!this.workbookContext.EditUrl;Lb[Wb.a.z1]=this.workbookContext.EditUrl;if(!this.P5b.CopyAndEditUrl){const Ab=[Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&X.a(this.$.ya,25)&&!this.$.zzb?-943219229:1821390342];Jb.$q(ia.a.L$(this.businessBar.K6c,Ab))}lb&&!Ja?(ya.b(this.workbookContext.WorkbookFileName)&&Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5693008_CGForFlightODFRepairEnabled")?(Jb=ia.a.EZa([-425642652]),
k.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):Jb=ia.a.EZa([108482388]),this.clientWorkflow.jd.$q(Jb),Lb[ma.a.oq]=rb.a.VUf):this.$.ea.b6e?(k.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),Kb.b().OSd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session","PasswordToModifyDialogShown"),Lb[ma.a.oq]=rb.a.sFb):Lb[ma.a.oq]=
this.$.ea.Dfc?rb.a.aBb:rb.a.keb};bb.a(yb).ls(new mb.a(rb.a.Mx,5,Ob))}}reloadWorkbookInViewMode(){if(this.fc){D.a.tg.YU&&D.a.tg.HGd();var yb=this.$;y.a.Ug&&Ya.g(yb).Xb.textBox.blur();bb.a(yb).ls(new mb.a(rb.a.Mx,5,()=>{yb.kI(!yb.ea.isNamedObjectViewMode,!1);const Ob=this.clientWorkflow.jd.activityState;Ob[ma.a.oq]=rb.a.fha;Ob[cc.a.WS]=1;Ob[cc.a.CX]=!0;Ob[Ea.a.Fr]=!1;Ob[Ea.a.Zlb]=!0;Ob[ua.a.uXb]=u.a.fkc}))}}reloadWorkbook(yb,Ob){if(this.fc){var Ja=this.$;Ja.sU&65536&&bb.a(Ja).ls(new mb.a(rb.a.Mx,5,
()=>{Ja.kI(yb,!0);const lb=this.clientWorkflow.jd.activityState;lb[ma.a.oq]=rb.a.Vy;lb[Ea.a.KSc]=this.workbookContext.NovMode;Ob||(lb[cc.a.WS]=1,lb[cc.a.pXb]=new fb)}))}}setCalculationMode(yb,Ob){k.ULS.sendTraceTag(537162629,0,50,`SetCalculationMode ,calculation mode chosen : ${Ob} `);const Ja=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=Ob;const lb=()=>new ea(Ob);return S.a(this.$.userOperationManager,(Pb,Jb,Lb)=>O(this.$.oa.va,Ob,sa.b(Pb,Va.MQi(this.$,Ja)),sa.a(Jb,Va.LQi(this.$,
Ja)),Lb,null),Pb=>new H.a(197,0,Pb,void 0,lb),yb)}static rye(yb){yb.rb&&0<yb.rb.eR&&yb.rb.g9c(Ob=>{Ob.Pu()})}static MQi(yb,Ob){return Ja=>{ia.a.rg(Ja.Errors)&&(yb.ea.workbookContext.CalcMode=Ob,k.ULS.sendTraceTag(537162628,0,50,`OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to ${Ob}.  Error id names: ${ia.a.yc(Ja.Errors)}`))}}static LQi(yb,Ob){return()=>{yb.ea.workbookContext.CalcMode=Ob;k.ULS.sendTraceTag(537162627,0,50,`OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to ${Ob})`)}}}
Object(t.a)(Va,"FileOperationsCommandHandler",B.a,[195]);var Sa=a(152);class vb extends d.a{constructor(yb){super(yb)}yd(){const yb=this.$,Ob=[],Ja=f.GetServiceTaskFactory.create(yb.da,56,this.la,this.hb);Ob.push(Ja);const lb=f.GetServiceTaskFactory.Ra(yb.da,5,4,this.hb);Ob.push(lb);e.TaskExtensions.Aa(na.Task.zL(...Ob),()=>{Sa.b(Ja)&&this.gd([new Va(yb,Ja.result,new b.a(()=>f.GetServiceTaskFactory.create(yb.da,137,this.la,this.hb)),lb.result)])},this.la,0)}static ka(yb){d.a.Nd(94,new vb(yb))}}Object(t.a)(vb,
"FileOperationsCommandHandlerFactory",d.a,[]);a.d(C,"a",function(){return Oa});const Oa=()=>{c.a.Fa(vb.ka)}},1164:function(t,C,a){var c=a(10);t=a(0);var b=a(221),d=a(8),f=a(19),e=a(66),k=a(60),l=a(5),m=a(31);class v{}v.yqh="ewa-resizehdr-row-hidden";v.xqh="ewa-resizehdr-col-hidden";Object(t.a)(v,"CssClassNames",null,[]);var n=a(236),w=a(13),r=a(154),u=a(629),y=a(27),x=a(222),B=a(4),z=a(262),A=a(15),I=a(77),F=a(131),U=a(43),X=a(145),S=a(24),H=a(54),D=a(12),J=a(71),M=a(1),G=a(93),T=a(11),K=a(14),L=
a(250),V=a(132),W=a(369),da=a(42),qa=a(34);class O{constructor(Ea,ua,ma,fb,sb,Ua,ab){this.tva=Ea;this.rCb=ua;this.TNa=ma;this.Yhd=fb;this.ubb=sb;this.Wgf=Ua;this.R3h=ab}}Object(t.a)(O,"HeaderEventCachedInfo",null,[]);class ea{constructor(Ea){this.j6c=Ea}bBe(Ea){Ea=T.HelperMethods.ICd(Ea);return Math.max(0,Math.min(ea.Rof,Ea))}SAe(Ea){return this.FXi(Ea)}mZg(Ea){return Math.round(this.j6c*Ea+2*this.tXe()+1)}FXi(Ea){return Math.max(0,Math.min(ea.vof,(Math.max(0,Math.min(d.a.Jjc,Ea))-2*this.tXe()-1)/
this.j6c))}tXe(){return Math.floor(Math.max((this.j6c+3)/4,2))}cac(Ea,ua){return ua?Ea?ea.Rof:d.a.Xud:Ea?ea.vof:d.a.Jjc}}ea.Rof=409;ea.vof=255;Object(t.a)(ea,"ResizeHeadersConverter",null,[]);var R=a(189);class oa extends G.a{constructor(Ea,ua){super(ua.domElement);this.hX=this.OSf=!1;this.Ti=this.o7a=this.sAa=null;this.YJd=!0;this.Ggc=!1;this.dJb=this.hl=this.offset=0;this.OM=this.$V=this.j0=null;this.T4h="headerResizeTooltip";this.lG=this.ntd=null;this.xWc=this.f8=this.wza=!1;this.AEf=this.V9a=
d.a.Rva;this.Daf=M.EwaSettings.isChangeGateEnabled("OfficeVSO:6649809_AutoFitHiddenRowCol");this.HOb=!1;this.vN=ma=>{if(this.grid.Oj)return!1;ma=qa.a(this.grid.$).Td(ma);if(3===ma.tb&&!this.Xgf(ma.Ca)||!this.vHf(ma,!1))return!1;A.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");const fb=this.Nwc();this.obd(ma.clientPoint,fb,!0);this.wza||(n.a.instance.ra(w.a.zj,this.domElement.ownerDocument.body,this.e9a),r.a.instance.ra(w.a.Xf,this.domElement.ownerDocument.body,
this.e9a),this.wza=!0);this.Qcf()&&this.hX&&this.z8e(ma);return!1};this.IDb=ma=>{ma=qa.a(this.grid.$).Td(ma);this.Qcf()&&this.xWc&&this.z8e(ma);if(!ma.Ca.type.includes("touch")&&ma.Ca.button!==Sys.UI.MouseButton.leftButton||!this.rzb)return!1;J.g(ma.Ca);this.aKe();ma=this.grid.Oj?this.V9a:d.a.Rva;var fb=!1;if(this.grid.Oj&&this.Ti){var sb=ma!==this.hl||!this.Daf&&this.f8;M.EwaSettings.isChangeGateEnabled("OfficeVSO:7021389_removeHiddenCellFromModelFix")&&!sb&&this.HOb&&(this.Fe.removeRowColFromModel(this.Ti.YRc,
this.Ti.TNf),fb=!0)}else this.Ti&&(ma=this.f8?this.Kcd():this.Ti.u3()),sb=ma!==this.hl;this.sAa&&sb&&ma!==d.a.Rva?(ma=this.grid,sb=this.Wed(ma),fb={},fb.SheetMultiRange=U.r(sb,ma.$),oa.qOd(fb,this.isRow,this.hl),this.lkh(fb),ma.PGj=!0):(fb&&this.Fe.Ap("HeaderResizeBehavior::onDocumentMouseUp"),this.yg(null,null),this.vHb());return this.HOb=this.f8=!1};this.Wba=ma=>{if(this.grid.Oj)return!1;ma=u.a.create(ma.eventName,ma.Cb,ma.Ca,ma.tb);ma=qa.a(this.grid.$).Td(ma);if(!this.vHf(ma,!0))return!1;ma=this.grid;
var fb=this.Wed(ma);fb=U.r(fb,ma.$);ma.lb.Mg([this.isRow?13:14]);ma.lb.mAa();this.vHb();ma.$.ud(this.isRow?146338636:1391094586,I.a.Eb,30,{["autoFitRanges"]:fb});return!1};this.yxf=ma=>{this.hX?(this.f8&&!this.HOb&&this.LAg(),this.Ggc||this.Q9e(),ma=new Sys.UI.DomEvent(ma),ma=u.a.create(w.a.Jga,this.domElement,ma,2),ma=qa.a(this.grid.$).Td(ma),this.xzd(ma.clientPoint)):A.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.Ti?
this.Ti.YRc:-1}, isRow = ${this.isRow}`)};this.zxf=ma=>{ma=new Sys.UI.DomEvent(ma);ma=u.a.create(w.a.Jga,this.domElement,ma,2);this.IDb(ma)};this.PLi=ma=>{this.cya(ma,this.Ti,!1)};this.e9a=ma=>{ma=qa.a(this.grid.$).Td(ma);J.g(ma.Ca);return this.xzd(ma.clientPoint)};this.hI=ma=>{if(this.grid.Oj)return!1;ma=qa.a(this.grid.$).Td(ma);let fb;if(!this.uff||-1!==this.grid.ha.selectionType)return da.a(this.grid.$).Sp()&&(fb=this.wdd(ma))&&(fb.tva.style.cursor=""),!1;if(this.hX)return this.Q9e(),!1;fb=this.wdd(ma);
if(!fb)return!1;fb.tva.style.cursor=!this.grid.eb&&this.Aqd(fb)?this.isRow?"row-resize":"col-resize":"";J.g(ma.Ca);return!0};this.yp=()=>{this.vHb()};this.yg=()=>{if((3===I.a.Eb||y.a.np)&&this.grid.ha.sa.wg){var ma=this.grid.ha.sa.Wc;if(!(!ma.isRow&&!ma.Ze||!this.domElement||ma.isRow&&this.isRow&&!this.Fe.Sn.includes(ma.top)||ma.Ze&&!this.isRow&&!this.Fe.Sn.includes(ma.left))){var fb=this.grid.mg(ma,this.Fe.rj.paneType);if(fb){if(this.grid.Oj){const sb=this.isRow?ma.bottom:ma.right;this.Ti=this.Fe.Tr(S.Range.Uc(ma.bottom,
ma.right));if(!this.Ti){A.ULS.sendTraceTag(522826880,2,50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${sb}, is row ${this.isRow}`);return}}this.lG||this.i$g();ma.isRow&&this.isRow?(D.DOMElementExtensions.setVisible(this.lG,!0),this.lG.style.top=fb.bottomRight.y-this.lG.offsetHeight/2+"px"):ma.isRow||this.isRow||(D.DOMElementExtensions.setVisible(this.lG,!0),L.c(this.lG.style,this.grid.rtl,fb.bottomRight.x-this.lG.offsetWidth/
2+"px"))}}}};this.GF=(ma,fb)=>{M.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&A.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${fb.UL}`);fb.UL&&this.Xob()};this.Fe=ua;this.isRow=ua.isRow;this.rtl=ua.rj.rtl;this.grid=Ea;this.yof=this.isRow?d.a.Xud:d.a.Jjc;this.O4h=K.a.instance.ga(441);this.Y4h=K.a.instance.ga(440);this.R4h=K.a.instance.ga(442);V.a(this.grid.$,ma=>{this.ntd=
ma.IP(F.a.agj,!1)});this.n7i();this.grid.ha.cT(this.yg);this.grid.ha.N1(this.yp);this.grid.Ku(this.yg);da.a(this.grid.$).Vf.a9(this.GF)}get rzb(){return this.hX}get uff(){const Ea=(new X.a(this.grid.$.xa)).Ud(this.isRow?16:8),ua=this.grid.$.rb.Zx,ma=this.grid.xi,fb=da.a(this.grid.$).Sp();return Ea&&!ua&&!ma&&!fb}get cgj(){this.Tkh();return oa.vbb}cya(Ea,ua,ma){var fb=new Sys.UI.DomEvent(Ea);fb=u.a.create(w.a.Jga,this.domElement,fb,2);fb=qa.a(this.grid.$).Td(fb);this.uHf(ua,fb.clientPoint.x,fb.clientPoint.y,
!1,ma,Ea);Ea=this.Nwc();this.obd(this.sAa,Ea,!0);this.wza||(Ea=this.domElement.ownerDocument.body,Ea.addEventListener(w.a.Jga,this.yxf),Ea.addEventListener(w.a.ZFa,this.zxf),this.wza=!0)}NLi(Ea,ua,ma){this.uHf(ua,Ea.clientX,Ea.clientY,!0,this.Daf?ma:!1,Ea);Ea=this.grid;ua=this.Wed(Ea);ua=U.r(ua,Ea.$);Ea.lb.Mg([this.isRow?13:14]);Ea.lb.mAa();this.vHb();Ea.$.ud(this.isRow?146338636:1391094586,I.a.Eb,30,{["autoFitRanges"]:ua})}dispose(){this.n_c();this.grid.ha&&(this.grid.ha.rR(this.yg),this.grid.ha.m6(this.yp));
this.grid.py(this.yg);da.a(this.grid.$)&&da.a(this.grid.$).Vf.Pca(this.GF);x.a.instance.Ba(w.a.qk,this.domElement,this.Wba);n.a.instance.Ba(w.a.Mf,this.domElement.ownerDocument.body,this.IDb);r.a.instance.Ba(w.a.te,this.domElement.ownerDocument.body,this.IDb);y.a.np||(n.a.instance.Ba(w.a.pointerDown,this.domElement,this.vN),n.a.instance.Ba(w.a.zj,this.domElement,this.hI));this.wza&&(n.a.instance.Ba(w.a.zj,this.domElement.ownerDocument.body,this.e9a),r.a.instance.Ba(w.a.Xf,this.domElement.ownerDocument.body,
this.e9a),this.wza=!1);this.lG&&(n.a.instance.Ba(w.a.pointerDown,this.lG,this.vN),x.a.instance.Ba(w.a.qk,this.lG,this.Wba),this.n_c(),this.lG=null);this.OSf&&(D.DOMElementExtensions.pf(oa.vbb),oa.vbb=null);this.Fe=null;super.dispose()}n7i(){x.a.instance.ra(w.a.qk,this.domElement,this.Wba);n.a.instance.ra(w.a.Mf,this.domElement.ownerDocument.body,this.IDb);r.a.instance.ra(w.a.te,this.domElement.ownerDocument.body,this.IDb);y.a.np||(n.a.instance.ra(w.a.pointerDown,this.domElement,this.vN),n.a.instance.ra(w.a.zj,
this.domElement,this.hI))}Tkh(){if(!oa.vbb){document.getElementById(oa.NSf);this.OSf=!0;var Ea=oa.vbb=document.createElement("div");this.grid.$.frame.gaa().appendChild(Ea);Ea.id=oa.NSf;Ea.className=m.a.zqh;D.DOMElementExtensions.setVisible(Ea,!1)}}aKe(){if(this.wza){const Ea=this.domElement.ownerDocument.body;this.grid.Oj?(Ea.removeEventListener(w.a.Jga,this.yxf),Ea.removeEventListener(w.a.ZFa,this.zxf)):(n.a.instance.Ba(w.a.zj,Ea,this.e9a),r.a.instance.Ba(w.a.Xf,Ea,this.e9a));this.wza=!1}this.hX=
!1;M.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.QOf():(this.qTf(),this.WHd());W.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")}qTf(){this.grid.lb.Mg([this.isRow?13:14]);this.grid.lb.mAa()}LAg(){this.Fe.addRowColToModel(this.Ti.YRc-1,this.Ti.TNf);this.HOb=!0}xzd(Ea){if(!this.hX)return!1;const ua=this.isRow;if(!this.grid.Oj&&!this.j0){this.j0=document.createElement("div");this.j0.style.cssText="position: relative; width: inherit; height: inherit;"+
(ua?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var ma=this.Ti.ZJ();ma.nextSibling;)this.j0.appendChild(ma.nextSibling);ma.parentNode.appendChild(this.j0)}ma=ua?Ea.y-this.o7a.y:(this.rtl?-1:1)*(Ea.x-this.o7a.x);const fb=ua?Ea.y-this.sAa.y:(this.rtl?-1:1)*(Ea.x-this.sAa.x),sb=this.grid.Oj?this.V9a:this.Ti.u3();if(sb===d.a.Rva)return!1;ma&&(0<this.hl||0<sb+fb)&&sb+fb<=this.yof&&(this.hl=this.Nwc(fb),this.obd(Ea,this.hl,!1),this.grid.Oj?this.hl>=oa.x6e?(this.YJd=!0,this.Ti.setCellExtent(this.hl)):
this.YJd&&(this.YJd=!1,this.Ti.setCellExtent(oa.x6e)):(D.DOMElementExtensions.eoa(this.Ti.ZJ(),!ua,Math.max(this.dJb+fb,0)),this.j0.style[ua?"top":this.rtl?"right":"left"]=Math.max(fb,-this.dJb)+"px"),ma=(this.grid.Oj?this.AEf:ua?this.Ti.Fe.kC:this.Ti.Fe.mC)+Math.max(fb,this.grid.Oj?-this.V9a+oa.zbc:-this.dJb),D.DOMElementExtensions.eoa(this.Ti.Fe.domElement,!ua,ma),this.grid.Oj&&this.Ti.Fe.ioj(ma),this.o7a=new Sys.UI.Point(Ea.x,Ea.y),D.DOMElementExtensions.setVisible(this.lG,!1));return!0}u3(){return this.Ti?
this.f8?oa.d5h:this.Ti.u3():d.a.Rva}obd(Ea,ua,ma){this.OM&&ma&&(A.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.WHd());this.OM||ma||A.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.ntd&&this.ntd(()=>({["Location"]:"canvas"}));this.OM?this.NUe(ua):(this.OM=document.createElement("div"),
this.OM.id=this.T4h,this.NUe(ua),this.OM.className=m.a.Uoh,ua=document.getElementById(this.grid.$.Bb+l.a.rqf),ua.insertBefore(this.OM,ua.firstChild),Ea=qa.a(this.grid.$).gja(Ea),this.OM.style.left=(this.rtl?Math.max(Ea.x-this.OM.offsetWidth,0):Ea.x-Math.max(Ea.x+this.OM.offsetWidth-ua.offsetWidth,0)).toString()+"px",ua=document.getElementById(l.a.zra),this.OM.style.top=(Ea.y-(B.AFrameworkApplication.ta&&B.AFrameworkApplication.ta.Oa.$e?0:ua.offsetHeight)-this.OM.offsetHeight).toString()+"px")}WHd(){D.DOMElementExtensions.pf(this.OM);
this.OM=null}NUe(Ea){var ua=new ea(this.grid.$.workbookContext.DxDigitNormal);ua=this.isRow?ua.bBe(Ea).toFixed(2):ua.SAe(Ea).toFixed(2);this.OM.innerText=`${this.isRow?this.O4h:this.Y4h} ${ua} (${Ea.toString()} ${this.R4h})`}vHf(Ea,ua){let ma;if(-1!==this.grid.ha.selectionType||2===Ea.tb&&Ea.Ca.button!==Sys.UI.MouseButton.leftButton||!this.Aqd(ma=this.wdd(Ea))||!this.uff)return!1;J.g(Ea.Ca);this.sAa=this.o7a=new Sys.UI.Point(Ea.clientPoint.x,Ea.clientPoint.y);this.CSg(ma,ua);if(!this.Ti)return!1;
this.hX=!0;this.Iki(this.Ti,ma)&&this.T8h();this.dJb=this.Kcd();return this.wHf(Ea.Ca.rawEvent,ua)}uHf(Ea,ua,ma,fb,sb,Ua){this.hX=!0;this.f8=sb;this.Ti=Ea;this.Ggc=!1;this.sAa=this.o7a=new Sys.UI.Point(ua,ma);Ea=this.Ti.getRange();this.$V=sb?this.Rne(Ea):Ea;this.V9a=this.u3();this.AEf=this.isRow?this.Ti.Fe.kC:this.Ti.Fe.mC;this.wHf(Ua,fb)}wHf(Ea,ua){V.b(this.grid.$).Cd(F.a.Sfj,{["IsResizingHiddenHeader"]:this.f8,["IsAutoFitting"]:ua,["NumberOfSelectedRanges"]:this.grid.ha.sa.EK,["Location"]:"canvas"});
this.grid.Yxj&&(ua=ua?"header_resize_autofit":"header_resize_start",R.b(this.grid.$).TAa(Ea,ua,void 0));this.offset=this.Ti.qaa();this.hl=this.grid.Oj?this.V9a:this.Ti.u3();if(this.hl===d.a.Rva)return!1;W.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}Iki(Ea,ua){var ma=this.Ti.ZJ();if(!ma)return A.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;ma=ma.nextSibling;if(!ma)return!1;Ea=Ea.getRange();ma=this.Fe.Aua(ma).getRange();if(!Ea||
!ma)return A.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;Ea=this.isRow?Ea.bottom:Ea.right;ma=this.isRow?ma.bottom:ma.right;return Ea+1!==ma&&Ea!==ma&&this.Aqd(ua,!0)}T8h(){var Ea=this.Ti.ZJ();const ua=this.Fe.Aua(Ea.nextSibling);oa.Jki(ua,this.isRow)?(this.Ti=ua,this.$V=this.Ti.getRange()):(this.MAg(Ea),this.Ti=ua,Ea=this.Ti.getRange(),this.$V=this.Rne(Ea),this.f8=!0)}Rne(Ea){return this.isRow?new S.Range(Ea.top-1,Ea.left,Ea.top-1,Ea.right,!1,!0):new S.Range(Ea.top,Ea.left-
1,Ea.bottom,Ea.left-1,!1,!0)}MAg(Ea){const ua=this.Fe.Aua(Ea.nextSibling),ma=oa.k6g(ua,this.isRow,this.rtl);ma&&Ea.parentNode.insertBefore(ma,ua.ZJ())}Wed(Ea){const ua=this.$V,ma=Ea.ha.sa.selectedRanges;if(Ea.ha.sa.Rrb(ua))if(this.isRow){if(z.a.all(ma,fb=>fb.isRow))return ma}else if(z.a.all(ma,fb=>fb.Ze))return ma;return[ua]}getCellExtent(){return this.Ti.getCellExtent()}Kcd(){const Ea=this.Ti.ZJ().style;return Math.max(0,Math.min(this.yof,0|parseInt(this.isRow?Ea.height:Ea.width,10)))}Nwc(Ea=0){const ua=
this.grid;var ma=this.Fe.rj.paneType;let fb;fb=this.isRow?3===ma?[3,2]:[1,4]:4===ma?[2,4]:[1,3];var sb=ua.view.visibleArea.bottomRight;const Ua=Math.max(this.grid.Oj?this.V9a:this.Ti.u3(),0);Ea=this.f8&&!this.grid.Oj?Math.max(this.Kcd(),0):Math.max(Ua+Ea,0);M.EwaSettings.isChangeGateEnabled("OfficeVSO:6964315_DottedResizer")?(ma=ua.PQh(ma,this.isRow),ma=this.isRow?new k.a(0,this.offset,ma,Ea):new k.a(this.offset,0,Ea,ma)):ma=this.isRow?new k.a(0,this.offset,sb.x,Ea):new k.a(this.offset,0,Ea,sb.y);
sb=[this.isRow?13:14];M.EwaSettings.isChangeGateEnabled("OfficeVSO:6964315_DottedResizer")?ua.lb.oi(new S.Range(1,1,d.a.dh,d.a.mh,!1,!0),sb,!1):ua.lb.oi(S.Range.Uc(1,1),sb,!1);ua.lb.zn(sb,ma,fb);return Ea}n_c(){this.$V=this.sAa=this.o7a=null;if(this.j0){const Ea=this.j0.parentNode;if(Ea)for(Ea.removeChild(this.j0);this.j0.firstChild;)Ea.appendChild(this.j0.firstChild);this.j0=null}this.Ti=null;this.hX=!1;M.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||this.QOf()}QOf(){this.Ggc=
!1;this.WHd();D.DOMElementExtensions.setVisible(oa.vbb,!1);D.DOMElementExtensions.setVisible(this.lG,!1);M.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&this.qTf()}wdd(Ea){if(D.DOMElementExtensions.qz(Ea.Cb,"a"))return null;const ua=this.Xgf(Ea.Ca);if(ua&&this.grid.ha.sa.wg){var ma=this.grid.ha.sa.Wc;ma=this.Fe.Tr(S.Range.Uc(ma.bottom,ma.right))}else ma=this.Fe.Aua(Ea.Cb);if(!ma)return null;const fb=ma.ZJ(),sb=new Sys.UI.Bounds(fb.offsetLeft,fb.offsetTop,fb.offsetWidth,
fb.offsetHeight);var Ua=D.DOMElementExtensions.getBoundingClientRect(Ea.Cb);Ua=new Sys.UI.Point(Ea.clientPoint.x-Ua.x,Ea.clientPoint.y-Ua.y);this.isRow&&!ua&&(Ua.y+=T.HelperMethods.VC(Ea.Cb,fb,this.rtl).y);return new O(fb,Ua,sb,ma.getRange(),Math.max(oa.Mzi,Math.min(oa.Jyi,(this.isRow?sb.height:sb.width)*oa.bgj)),ua,!this.isRow&&0<fb.getElementsByTagName("input").length)}Aqd(Ea,ua=!1){if(!Ea||this.grid.eb)return!1;if(Ea.Wgf)return!0;var ma=Ea.TNa;const fb=Ea.ubb;var sb=this.Fe.rj.paneType,Ua=this.grid.Lf(sb).gi,
ab=!!Ua&&Ua.top===Ea.Yhd.top,na=!!Ua&&Ua.left===Ea.Yhd.left;sb=!!Ua&&Ua.bottom===Ea.Yhd.bottom&&(3===sb||2===sb);this.isRow?(na=Ea.rCb.y,Ea=na<=fb&&!ab,ma=na>=ma.height-fb-(sb?oa.eDh:0),ua=ua?Ea:ma||Ea):(sb=Ea.R3h,ab=this.rtl,Ua=Ea.rCb.x,Ea=Ua<=fb&&(!na||ab)&&(!sb||!ab),ma=Ua>=ma.width-fb&&(!ab||!na)&&(!sb||ab),ua=ua?ab?ma:Ea:Ea||ma);return ua}CSg(Ea,ua){const ma=this.isRow;if(Ea.Wgf)this.Ti=this.Fe.Aua(Ea.tva);else if(ma&&Ea.rCb.y<=Ea.ubb&&Ea.TNa.height>Ea.ubb||!ma&&Ea.TNa.width>Ea.ubb&&(!this.rtl&&
Ea.rCb.x<=Ea.ubb||this.rtl&&Ea.rCb.x>=Ea.TNa.width-Ea.ubb)){if(this.Ti=Ea.tva.previousSibling?this.Fe.Aua(Ea.tva.previousSibling):this.bQh(),ua&&Ea.tva.classList.contains(ma?m.a.FPe:m.a.EPe)&&(Ea=this.Fe.Aua(Ea.tva)))Ea=Ea.getRange(),this.$V=ma?new S.Range(Ea.top-1,Ea.left,Ea.top-1,Ea.right,!1,!0):new S.Range(Ea.top,Ea.left-1,Ea.bottom,Ea.left-1,!1,!0)}else this.Ti=this.Fe.Aua(Ea.tva);!this.$V&&this.Ti&&(this.$V=this.Ti.getRange())}bQh(){var Ea=this.isRow?1:0;return(Ea=this.Fe.rj.pG(this.Fe.rj.Ea.Lg(this.grid.$.pa,
e.a.oM(this.Fe.position.X+Ea-1,this.Fe.position.Y-Ea,this.Fe.position.PaneType))))?Ea.aQh():null}Q9e(){this.Ggc=!0;const Ea=this.cgj;D.DOMElementExtensions.setVisible(Ea,!0);Ea.style.cursor=this.isRow?m.a.NMe:m.a.BLe;this.Nwc()}lkh(Ea){this.grid.$.ud(this.isRow?745189930:-445963340,I.a.Eb,30,{["resizeRowColumnParameters"]:Ea})}i$g(){const Ea=document.createElement("div");Ea.className=m.a.Arh;const ua=document.createElement("div");ua.className=f.a.PA;Ea.appendChild(ua);const ma=document.createElement("img");
ma.src=H.a.hf(0);ma.className=this.isRow?f.a.wqh:f.a.rqh;ua.appendChild(ma);this.Fe.JA.domElement.parentNode.insertBefore(Ea,this.Fe.JA.domElement);this.grid.Oj?Ea.addEventListener(w.a.B9,this.PLi):(n.a.instance.ra(w.a.pointerDown,Ea,this.vN),x.a.instance.ra(w.a.qk,Ea,this.Wba));D.DOMElementExtensions.setVisible(Ea,!1);this.lG=Ea}vHb(){this.n_c();this.lG&&(this.Fe.JA.domElement.parentNode.removeChild(this.lG),this.lG=null)}Xgf(Ea){return D.DOMElementExtensions.vf(this.lG,Ea.target)}Xob(){this.hX&&
(M.EwaSettings.isChangeGateEnabled("OfficeVSO:6810003_HandleCancelResize")&&this.grid.Oj&&this.xzd(this.sAa),this.aKe(),this.grid.Oj||D.DOMElementExtensions.eoa(this.Ti.ZJ(),!this.isRow,this.dJb),this.vHb(),this.HOb=this.f8=!1)}Qcf(){return M.EwaSettings.ma(672)}z8e(Ea){(Ea=Ea.Ca.rawEvent)&&Ea.detail===oa.Nkj&&(Ea.type===w.a.Wp?(this.hX=!1,this.xWc=!0):Ea.type===w.a.dI&&(this.hX=!0,this.xWc=!1))}static g6g(Ea,ua){return new oa(Ea,ua)}static qOd(Ea,ua,ma){if(ua){Ea.ColumnWidth=-1;Ea.RowHeight=ma;for(const fb of Ea.SheetMultiRange.Ranges)fb.FirstColumn=
0,fb.LastColumn=0}else{Ea.RowHeight=-1;Ea.ColumnWidth=ma;for(const fb of Ea.SheetMultiRange.Ranges)fb.FirstRow=0,fb.LastRow=0}}static Jki(Ea,ua){if(!Ea||!Ea.ZJ())return A.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;const ma=Ea.getRange();Ea=Ea.ZJ().style;if(!ma||!Ea)return A.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;Ea=ua?Ea.height:Ea.width;return(ua?ma.top:ma.left)===(ua?d.a.dh:d.a.mh)&&Ea===oa.Fgg}static k6g(Ea,ua,ma){if(!Ea)return A.ULS.shipAssertTag(537154012,
2,!1,"header after hidden is null"),null;var fb=Ea.ZJ();if(!fb||!fb.style)return A.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;Ea=document.createElement("div");const sb=fb.style;Ea.style.top=ua?sb.top:oa.Fgg;ua||(ma?Ea.style.right=sb.right:Ea.style.left=sb.left);Ea.classList.add(ua?v.yqh:v.xqh);Ea.classList.add(ua?m.a.Ssb:m.a.Rsb);ma=document.createElement("div");ma.classList.add(ua?m.a.sPe:m.a.T8c);fb=ua?Number.parseInvariant(fb.innerText):S.Range.D_a(fb.innerText);
ma.innerText=ua?(fb-1).toString():S.Range.xP(fb-1);Ea.appendChild(ma);return Ea}}oa.Mzi=0;oa.Jyi=5;oa.zbc=1;oa.x6e=1;oa.d5h=0;oa.eDh=3;oa.bgj=.1;oa.NSf="ewa-rszrbg";oa.Fgg="0px";oa.Nkj=2;oa.vbb=null;Object(t.a)(oa,"HeaderResizeBehavior",G.a,[258]);class pa extends b.a{constructor(){super();this.Fb()}create(){this.qb(oa.g6g)}static ka(Ea){Ea.da.Ga(136,new pa)}}Object(t.a)(pa,"HeaderResizeBehaviorFactory",b.a,[]);var Pa=a(691),Z=a(50),Ra=a(37),Ga=a(172),Ba=a(419),fa=a(513),Y=a(368),ja=a(170),ca=a(281),
aa=a(280),ta=a(75),xa=a(21);class ia{constructor(Ea,ua){this.isRow=!1;this.autoFitRange=null;this.isRow=Ea;this.autoFitRange=ua}}Object(t.a)(ia,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[101]);class ya{constructor(Ea){this.resizeParameters=null;this.resizeParameters=Ea}}Object(t.a)(ya,"MacroRecorderSheetRowsColumnsResizedPayload",null,[101]);var ib=a(84);b=a(282);var wa=a(22);class sa extends b.a{constructor(Ea,ua){super(Ea);this.Xub=ma=>{ma=this.Kdd(ma);return this.hbd(ma)};this.Tfj=(ma,
fb)=>{var sb=this.N6a=fb[sa.Jfi];1===ma?(ma=fb[sa.DBj],sb=this.G2e(ma,sb),A.ULS.shipAssertTag(537153996,0,sb!==sa.Paa,`ResizeHeadersDialogHandler - invalid size input, size = ${ma}`),ma=sb!==this.jkd,A.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",this.isRow,this.N6a,sb,ma),ma&&this.O3g(sb)):A.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=
2040891415===ua.command;this.gridView=xa.g(this.$);this.Dsc=new ea(this.$.workbookContext.DxDigitNormal);this.jkd=this.cTg();Ea=this.x2g(this.jkd);ua=this.z2g(this.jkd);this.Gl=K.a.instance.ga(this.isRow?482:483);Ea=this.KM(Ea,ua);this.initializeAndShow(this.Gl,this.Tfj,Ea);A.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get oc(){return"ResizeHeadersDialog"}get N6a(){return sa.Q8d}set N6a(Ea){sa.Q8d=Ea}KM(Ea,ua){return{[sa.U3]:this.oc,[sa.Xki]:this.isRow,
[sa.p9h]:Ea,[sa.o9h]:ua,[sa.Phi]:this.N6a,[sa.Jdd]:this.Xub}}cTg(){const Ea=this.sGh();try{return this.XKh(Ea)}finally{Ea&&Ea.dispose()}}O3g(Ea){const ua={};ua.SheetMultiRange=U.r(this.gridView.ha.sa.selectedRanges,this.$);sa.qOd(ua,this.isRow,Ea);this.$.ud(this.isRow?745189930:-445963340,I.a.Eb,8,{["resizeRowColumnParameters"]:ua})}G2e(Ea,ua){return wa.a.q4(Ea)?ua?this.w2g(Ea):this.y2g(Ea):sa.Paa}y2g(Ea){return Math.floor(parseFloat(Ea))}w2g(Ea){Ea=parseFloat(Ea);return 0>Ea?sa.Paa:Ea?this.isRow?
T.HelperMethods.NXi(Ea):this.Dsc.mZg(Ea):0}z2g(Ea){return Ea===sa.Paa?"":this.isRow?this.Dsc.bBe(Ea).toString():this.Dsc.SAe(Ea).toFixed(2)}x2g(Ea){return Ea===sa.Paa?"":Ea.toString()}XKh(Ea){if(!Ea||!Ea.$$mn()||!Ea.Hn)return sa.Paa;var ua=Object(ib.a)(283,Ea.Hn);if(!ua)return sa.Paa;for(ua=this.isRow?ua.vxb:ua.hkd;Ea.$$mn();){const ma=Object(ib.a)(283,Ea.Hn);if(ma&&(this.isRow?ma.vxb:ma.hkd)!==ua)return sa.Paa}return ua}sGh(){const Ea=[];for(const ma of this.gridView.ha.sa.selectedRanges){const fb=
ma.clone();var ua=this.gridView.Lf(this.gridView.ib.Vi(fb));ua=fb.Ge(ua.gi);if(!ua)return null;this.isRow?fb.right=fb.left=ua.left:fb.top=fb.bottom=ua.top;Ea.push(fb)}return Ea.length?this.gridView.i$("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",Ea):null}Kdd(Ea){if(!wa.a.q4(Ea))return 1;Ea=this.G2e(Ea,this.N6a);if(0===Ea)if(M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HideLastRowCol",!1)){const ua=this.gridView.ha.sa.selectedRanges;if(this.gridView.Yd){if(!this.gridView.Yd.Zue(ua,
this.isRow))return 3}else if(this.vff())return 3}else if(this.vff())return 3;return this.Fni(Ea)?0:2}vff(){const Ea=this.gridView.ha.sa.selectedRanges;return this.isRow&&U.P(Ea)||!this.isRow&&U.O(Ea)}hbd(Ea){let ua="";switch(Ea){case 0:ua="";break;case 1:ua=K.a.instance.ga(772);break;case 2:ua=String.format(K.a.instance.ob(99),0,this.cac(this.N6a));break;case 3:ua=K.a.instance.ga(773)}return ua}Fni(Ea){return 0<=Ea&&Ea<=this.cac(!1)}cac(Ea){return this.Dsc.cac(Ea,this.isRow)}static qOd(Ea,ua,ma){if(ua){Ea.ColumnWidth=
sa.Paa;Ea.RowHeight=ma;for(const fb of Ea.SheetMultiRange.Ranges)fb.FirstColumn=0,fb.LastColumn=0}else{Ea.RowHeight=sa.Paa;Ea.ColumnWidth=ma;for(const fb of Ea.SheetMultiRange.Ranges)fb.FirstRow=0,fb.LastRow=0}}}sa.U3="id";sa.Xki="isRow";sa.p9h="initialSizeInPx";sa.o9h="initialSizeInDefaultUnits";sa.Phi="isInitialUnitsDefaultUnits";sa.Jdd="getInputErrorIfInvalid";sa.DBj="size";sa.Jfi="isDefaultUnits";sa.Paa=-1;sa.Q8d=!0;Object(t.a)(sa,"ResizeHeadersDialog",b.a,[]);var Ya=a(61);const bb=(Ea,ua,ma,
fb,sb,Ua,ab=null)=>{ab=Ea.Na(41,ab);ab.resizeRowColumnParameters=ua;return Ya.g(Ea,"ResizeRowsColumns",ab,ma,fb,sb,Ua,0)};var mb=a(338),Ca=a(455),$a=a(65),Kb=a(29),rb=a(340);class cc{constructor(Ea,ua){this.HPi=(ma,fb)=>{if(!ca.a(ma)&&fb){const sb=!!ma&&!!ma.RequestTelemetryData;xa.g(this.$).Gi.Pka(fb,ma.StateId,sb?ma.RequestTelemetryData.EcsOperationDuration:0,sb?ma.RequestTelemetryData.EcsRequestDuration:0,sb?ma.RequestTelemetryData.WfeRequestDuration:0)}};this.bHi=(ma,fb)=>{fb&&fb.f_b&&fb.f_b.SheetName&&
fb.f_b.Ranges.length&&fb.Yei&&M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(ma=$a.d(this.$.xa.pa),this.lZg(new mb.a(U.B(fb.f_b.Ranges[0]),ma)))};this.$=Ea;this.ug=ua}Nc(Ea,ua){Ea=!0;switch(ua){case -445963340:case 1391094586:Ea=this.Ud(8);break;case 745189930:case 146338636:Ea=this.Ud(16)}return!Ea}executeCommand(Ea,ua,ma){var fb=xa.g(this.$);const sb=ua.command;var Ua=Ga.a.create().toString();let ab=Ra.TaskExtensions.fk();switch(sb){case 1391094586:case 146338636:Ea=
1391094586===sb;(Ua=ma.autoFitRanges)&&Ua.Ranges&&Ua.Ranges.length||(Ua=U.r(fb.ha.sa.selectedRanges,this.$));ab=this.jgh(Ea?1:0,Ua,ua);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:Ea=-445963340===sb||-706918724===sb||369708605===sb;if(-445963340===sb||745189930===sb){var na=Ba.a(ua.command);fb.Gi.T6(16,Ua,na);fb=ma.resizeRowColumnParameters}else{ma=fb.ha.sa.selectedRanges;let Va=0;for(var Na of ma)if(-706918724===sb||369708605===sb){const Sa=
Na.right-Na.left+1;Va+=0<Sa?Sa:-1*Sa}else if(1542466017===sb||1051390410===sb)Va+=Na.bottom-Na.top+1;369708605===sb||1542466017===sb?A.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${Va}`):(-706918724===sb||1051390410===sb)&&A.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${Va}`);if(!M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HideLastRowCol",!1)||!fb.Yd){if(-706918724===sb&&6===
ua.Re&&U.O(ma)){A.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===sb&&6===ua.Re&&U.P(ma)){A.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}}Na=369708605===sb||1542466017===sb?-2:0;fb={};fb.SheetMultiRange=U.r(ma,this.$);if(Ea)for(na of fb.SheetMultiRange.Ranges)na.FirstRow=0,na.LastRow=
0;else for(const Sa of fb.SheetMultiRange.Ranges)Sa.FirstColumn=0,Sa.LastColumn=0;fb.RowHeight=Ea?-1:Na;fb.ColumnWidth=Ea?Na:-1}ab=this.Dgh(fb,ua,Ua,Ea);break;case 957527587:case 2040891415:new sa(this.$,ua)}return ab}lZg(Ea){M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&Ra.TaskExtensions.Aa(Z.GetServiceTaskFactory.Ra(this.$.da,426,427,1),ua=>{void ua.result.XVd(Ea,"ColumnAutoFit")},this.$.la,3)}Cc(Ea,ua,ma,fb){if(Ea=!!ma&&!!fb&&1===
fb.Sy)switch(ua.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:Ea=!1}return Ea}Rc(){return!1}iui(Ea){A.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Ea.success}. Reason: ${Object(Ca.c)(Ea)?void 0:Ea.reason}.`)}Ud(Ea){return(new X.a(this.$.xa)).Ud(Ea)}jgh(Ea,ua,ma){const fb=this.$.oa.va.Sb(),sb=0===Ea,Ua=()=>
new ia(sb,ua);return Y.a(this.$.userOperationManager,(ab,na,Na)=>{var Va=this.$.oa.va;ab=aa.b(ab,this.bHi);var Sa={Yei:!sb,f_b:ua};const vb=Va.Na(41,fb);vb.isRow=sb;vb.autoFitRanges=ua;return Ya.g(Va,"AutoFit",vb,ab,na,Na,Sa,0)},ab=>new ja.a(135,0,ab,void 0,Ua),ma)}Dgh(Ea,ua,ma,fb){const sb=ua.command,Ua=xa.g(this.$),ab=U.g(Ea.SheetMultiRange.Ranges);if(M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HideLastRowCol",!1)&&(1051390410===sb||-706918724===sb)&&null!=Ua.Yd&&!Ua.Yd.Zue(ab,!fb))return this.tfh(fb),
Ra.TaskExtensions.fk();let na;if(745189930===sb||-445963340===sb)A.ULS.shipAssertTag(537154002,0,this.$.activeItemName===Ea.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),na=this.ug.Uzj(Ua,ab,fb?Ea.ColumnWidth:Ea.RowHeight,!fb),this.iui(na),Object(Ca.c)(na)&&Ua.Gi.e0(ma,ta.BasicTelemetryCalculator.vQ);const Na=this.$.oa.va.Sb({MZ:!0,dZ:3});fb=(Sa,vb,Oa)=>{this.$.ry();U.i(ab,",",this.$,!1);return bb(this.$.oa.va,Ea,aa.b(Sa,this.HPi),vb,Oa,ma,Na)};const Va=
()=>new ya(Ea);return na&&Object(Ca.c)(na)?M.EwaSettings.dc()?Y.a(this.$.userOperationManager,fb,Sa=>new ja.a(136,0,Sa,64,Va),ua):Y.a(this.$.userOperationManager,fb,Sa=>new fa.a(136,0,Sa,void 0,Va),ua):Y.a(this.$.userOperationManager,fb,Sa=>new ja.a(136,0,Sa,void 0,Va),ua)}tfh(Ea){Ea=Kb.a.Yc(1,0,Ea?774:776,Ea?775:777,0,Ea?-2037763134:503471870,Ea?"HideAllColumnsError":"HideAllRowsError");new rb.a(this.$,Ea)}}Object(t.a)(cc,"ResizeCommandHandler",null,[195]);class nc extends Pa.a{constructor(Ea){super(Ea)}yd(){const Ea=
Z.GetServiceTaskFactory.create(this.$.da,18,this.la,this.hb);Ra.TaskExtensions.Aa(Ea,()=>{this.gd([new cc(this.$,Ea.result)])},this.la,3)}static ka(Ea){Pa.a.Nd(113,new nc(Ea))}}Object(t.a)(nc,"ResizeCommandHandlerFactory",Pa.a,[]);a.d(C,"a",function(){return Wb});const Wb=()=>{c.a.Fa(Ea=>{pa.ka(Ea);nc.ka(Ea)})}},1169:function(t,C,a){t=a(0);var c=a(133);class b extends c.StandardDialog{constructor(){super();this.Rb=0;this.rc(1,CommonUIStrings.l_DialogClose)}displayError(S){this.Xz(S,CommonUIStrings.l_DefaultDialogTitle,
CommonUIStrings.l_OneDriveContactError,null)}F5c(S){this.Xz(S,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(t.a)(b,"ErrorDialog",c.StandardDialog,[331]);var d=a(15),f=a(155);class e{oVe(){d.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const S=new f.a;S.setResult("api.onedrive.com");return S.task}}Object(t.a)(e,"OneDriveConsumerEndpointHelper",null,[246]);var k=a(83),l=a(53),m=a(371),v=a(226);class n{constructor(S,H,D,J){this.ODa=this.w5=
null;this.vPc=this.xPc=!1;this.kWa=null;this.nb=S;this.APb=H;this.uDa=D;this.Cs=J}get ape(){return this.APb}get fa(){return this.nb}F3a(){this.kWa||(this.kWa=this.O9a?v.a.create(this.O9a,null,null,null,!1):null);return this.kWa}setup(S){this.ODa=S;this.xPc||this.vPc?this.xPc&&this.ODa&&this.ODa(!0):(S=this.F3a())?(this.vPc=!0,S.L7a.continueWith(H=>{this.yOi(H)}),m.a.Xha(S)):(d.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.ODa(!1))}Nzd(S){d.ULS.sendTraceTag(20509838,
352,15,"Failure during OneDrive API download: {0}",S.exception?S.exception.toString():"No error detail.")}yOi(S){this.vPc=!1;if(S.Sf)this.Nzd(S),this.ODa(!1);else try{this.xPc=!0,d.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.nkd(),d.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.ODa(!0)}catch(H){d.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",H.toString()),this.ODa(!1)}}startPicker(S){this.w5=S;this.uDa?d.ULS.sendTraceTag(23881878,
216,50,"In limited edit mode, will not show Picker."):(d.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(k.a)(this,this.hyd,"onApiReady")))}hyd(S){S?this.oic():this.oj()}oj(){this.Cs().displayError(l.a.KTi)}onSuccess(S){d.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.w5&&this.w5(!0,S)}dispose(){this.kWa&&this.kWa.dispose()}}Object(t.a)(n,"AOneDriveFilePickerApiManager",null,[303,2]);class w extends n{constructor(S,
H,D,J,M,G){super(H,D,J,G);this.Kh=null;this.m1=S;this.Ivg=M}get O9a(){return this.fa.Va("OneDriveApiUrl")}start(S,H){this.Kh=S;this.startPicker(H)}nkd(){WL.init(1===this.ape||2===this.ape?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}startPicker(S){this.w5=S;!this.uDa&&this.m1.qLa?(d.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(k.a)(this,this.hyd,"onApiReady"))):
(d.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.Ivg())}oic(){try{d.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Kh).then(Object(k.a)(this,this.onSuccess,"onSuccess"),Object(k.a)(this,this.v5,"onFailure"))}catch(S){d.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",S,S.stack),this.oj()}}v5(S){if(S&&S.error){if("user_canceled"===S.error.code){d.ULS.sendTraceTag(17909058,352,50,"User canceled.");
return}d.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",S.error.code,S.error.message)}else d.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.w5&&this.w5(!1,S);this.oj()}}Object(t.a)(w,"OneDriveFilePickerApiManagerV5",n,[]);class r extends n{constructor(S,H,D,J,M){super(S,H,D,J);this.WRb=this.Abe=null;this.Jng=M;this.options={};this.options.clientId=this.fa.Va("OneDriveApiV7ClientId");this.options.cancel=Object(k.a)(this,
this.dzc,"toggleHostDivVisibility")}get O9a(){return this.fa.Va("OneDriveApiV72Url")}start(S,H){this.WRb=H;const D=this.Jng.oVe();D.continueWith(()=>{d.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.Abe=D.result;this.startPicker((J,M)=>{this.dzc();S(J,M)})},3);D.continueWith(()=>{d.ULS.sendTraceTag(24134242,352,15,D.exception.message);this.dzc()},5)}nkd(){this.options.success=S=>{const H={};H.data=S;this.onSuccess(H)};this.options.error=
S=>{const H={};H.error=S;this.v5(H)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Abe;this.options.advanced.iframeParentDiv=this.WRb}oic(){try{d.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.dzc(),OneDrive.open(this.options)}catch(S){d.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",S.message),this.oj()}}v5(S){this.w5&&this.w5(!1,S);this.oj()}dzc(){this.WRb.style.visibility=
"hidden"===this.WRb.style.visibility?"":"hidden"}}Object(t.a)(r,"OneDriveFilePickerApiManagerV7",n,[]);class u extends n{constructor(S,H,D,J){super(S,H,D,J);this.Akg=S;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.fa.Va("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get O9a(){return this.fa.Va("OneDriveApiV72Url")}start(S,H,D,J){this.options.advanced.iframeParentDiv=D;this.options.advanced.endpointHint=J;this.options.cancel=H;this.Akg.qa("OneDriveApiV72RecentsViewEnabled")&&
(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(S)}startPicker(S){this.w5=S;this.uDa?d.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(d.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(k.a)(this,this.hyd,"onApiReady")))}nkd(){this.options.success=
S=>{const H={};H.data=S;this.onSuccess(H)};this.options.error=S=>{const H={};H.error=S;this.v5(H)}}oic(){try{d.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(S){d.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",S.message,S.stack),this.oj()}}Nzd(S){d.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",S.exception?S.exception.toString():"No error detail.");m.a.o$i(this.O9a);
this.kWa=null}oj(){this.Cs().F5c(l.a.Tij)}v5(S){this.w5&&this.w5(!1,S)}}Object(t.a)(u,"OneDriveFilePickerApiManagerV72",n,[]);class y{constructor(S){this.olsSessionId=this.value=this.key=null;this.olsSessionId=S}}Object(t.a)(y,"IExtraData",null,[]);var x=a(4);class B extends u{constructor(S,H,D,J){super(S,H,D,J);this.options.advanced.filter=S.Va("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=x.AFrameworkApplication.ipe;S.qa("OneDriveApiV72CommandModeEnabled")&&
(this.options.commandMode=S.Va("OneDriveApiV72CommandMode")||"none");S.qa("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new y(x.AFrameworkApplication.userSessionId))}get O9a(){return this.fa.Va("OneDriveApiV72Url")}oic(){try{d.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:
"",x.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(S){d.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",S.message,S.stack),this.oj()}}}Object(t.a)(B,"OneDriveFilePickerApiOpenManagerV72",u,[]);var z=a(237);class A{constructor(S){this.hk=null;this.wh=S;this.xOc=3}oVe(){this.hk=new f.a;d.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.FMd();return this.hk.task}FMd(S=null){const H=
String.format("GetMoreInfoHandler.ashx?{0}",x.AFrameworkApplication.qHa);this.wh.V8(H,1,null,S,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(k.a)(this,this.lRh,"getMoreInfoSucceeded"),Object(k.a)(this,this.jRh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")}jRh(S){if(S.data.httpStatus===z.a.VFb&&"X-NewKey"in S.data.responseHeaders){d.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const H={};H["X-Key"]=S.data.responseHeaders["X-NewKey"];
this.FMd(H)}else 0<this.xOc?(d.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.xOc),this.xOc--,this.FMd()):(d.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.hk.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}lRh(S){"PersonalFileStorageUrl"in S.data.responseHeaders&&""!==S.data.responseHeaders.PersonalFileStorageUrl?(d.ULS.sendTraceTag(24134239,
352,50,"Successfully received an ODB endpoint"),this.hk.setResult(S.data.responseHeaders.PersonalFileStorageUrl)):(d.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.hk.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(t.a)(A,"OneDriveForBusinessEndpointHelper",null,[246]);var I=a(246),F=a(558);class U{constructor(){this.fb=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Rh(S){this.fb=
S;this.fb.register(w,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").tc().Fc(()=>new w(F.a.instance,x.AFrameworkApplication.fa,x.AFrameworkApplication.E1a,x.AFrameworkApplication.limitedEdit,x.AFrameworkApplication.w3f,()=>new b));x.AFrameworkApplication.lgf?this.fb.register(246,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").tc().Fc(()=>new e):this.fb.register(246,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").tc().Fc(()=>
new A(x.AFrameworkApplication.vd));this.fb.register(r,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").tc().Fc(()=>new r(x.AFrameworkApplication.fa,x.AFrameworkApplication.E1a,x.AFrameworkApplication.limitedEdit,()=>new b,this.fb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.fb.register(u,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").tc().Fc(()=>new u(x.AFrameworkApplication.fa,x.AFrameworkApplication.E1a,x.AFrameworkApplication.limitedEdit,
()=>new b));this.fb.register(B,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").tc().Fc(()=>new B(x.AFrameworkApplication.fa,x.AFrameworkApplication.E1a,x.AFrameworkApplication.limitedEdit,()=>new b))}static main(){I.a.instance.yi(new U)}}Object(t.a)(U,"PackageManager",null,[4,5]);a.d(C,"a",function(){return X});const X=()=>{Type.registerNamespace("Common.App.OneDriveFilePickerApi");U.main()}},1177:function(t,C,a){t=a(0);var c=a(83),b=a(15),d=a(133),f=a(53),e=a(25);class k extends d.StandardDialog{constructor(K,
L){super();this.lWa=!1;this.qA=null;this.La=K;this.yhb=L;this.RRa=!1}displayError(K,L,V){this.qA=L;this.lWa=V;b.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",K,V);K=this.MZc(K);0===K?(this.Rb=6,this.rc(0,CommonUIStrings.l_DialogClose)):(this.Rb=0,this.rc(1,CommonUIStrings.l_DialogClose));0===K&&b.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Xz(f.a.Sij,this.Bcd(K),this.LLh(K,L),Object(c.a)(this,this.SKd,"retryDialogHandler"),!0)}SKd(K){1===
K?(b.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.qA?this.La.de(e.a.ZIb,2,[this.qA,this.lWa]):this.La.processAction(e.a.ZIb,2)):b.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}MZc(K){return 0>K||6<K?(b.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",K),0):K}LLh(K,L){K=this.MZc(K);return this.yhb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,
String.format(CommonUIStrings.l_OverwriteTargetText,L),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][K]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,L),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][K]}Bcd(K){K=this.MZc(K);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,
CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][K]}}Object(t.a)(k,"ErrorRetryDialog",d.StandardDialog,[340]);class l{constructor(K,L){this.nb=K;this.La=L;this.yhb=this.nb.qa("SaveToHostWithExtraCharsInFileName")}create(){return new k(this.La,this.yhb)}}Object(t.a)(l,"ErrorRetryDialogFactory",null,[326]);d=a(1047);var m=a(144);class v{static get ag(){return m.a.ap(v.Bk,
CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}v.Bk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(t.a)(v,"FileNameDialogHtml",null,[]);var n=a(4),w=a(30);class r extends d.a{constructor(K,L,V,W,da,qa){super(K,L,V,W,da,qa);this.ag=v.ag;this.ze="FileNameDialog-SaveAsToHost"}OP(K,L){const V=w.a.uq(n.AFrameworkApplication.hm.Zm);L={["txtFileName"]:K||V,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:L};this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(c.a)(this,this.g8b,"fileNameDialogHandler"),L);this.VGe(K,V)}}Object(t.a)(r,"FileNameDialog",d.a,[335]);class u{constructor(K,
L,V,W,da,qa){this.La=L;this.nb=K;this.QW=W;this.Vfa=qa;this.Cs=da;this.We=V}create(){return new r(this.nb,this.La,this.We,this.QW,this.Cs,this.Vfa)}}Object(t.a)(u,"FileNameDialogFactory",null,[320]);var y=a(639),x=a(106);class B{constructor(K,L,V){this.Vfa=V;this.bHc=L;this.nb=K}Gg(){2===n.AFrameworkApplication.ta.Oa.xj?n.AFrameworkApplication.wb.Ie(e.a.ZIb,x.a.frame,Object(c.a)(this,this.QUf,"saveAsToHostActionDispatcher"),4):n.AFrameworkApplication.wb.Ob(e.a.ZIb,x.a.frame,Object(c.a)(this,this.QUf,
"saveAsToHostActionDispatcher"))}QUf(K,L,V,W,da){return L.contextId!==x.a.frame||K!==e.a.ZIb?2:this.nb.qa("SaveAsToHostBrsIsEnabled")?1===V?y.SessionStatusManager.instance.u4a||n.AFrameworkApplication.m4?8:32:2===V?(b.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),K=this.bHc.create(),da&&Object.getType(da)===Array&&2===da.length?K.OP(da[0],!!da[1]):K.OP(null,!1),32):8:8}}Object(t.a)(B,"SaveAsToHostActor",null,[]);var z=a(41),A=a(80),I=a(39),F=a(237),U=a(370),
X=a(163),S=a(640),H=a(762);class D{constructor(K,L,V,W,da,qa,O,ea){this.zm=null;this.lWa=this.OCa=!1;this.Ufa=this.Kh=this.qA=null;this.nb=L;this.MEa=this.nb.appSettings.SaveAsToHostWebServiceBase;this.F7d=W;this.ekb=da;this.wh=V;this.Cs=qa;this.zh=ea;this.We=O;this.La=K;this.Wea=L.Va("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}yLb(){1!==this.We.state&&(this.zm=this.ekb(),this.zm.message=CommonUIStrings.l_CommentProgressTooltip,this.zm.Rb=5,this.zm.ft=!1,this.zm.lAa(CommonUIStrings.l_DefaultDialogTitle,
null,null))}KR(K=0){1!==this.We.state&&this.Cs.create().displayError(K,w.a.uq(this.qA),this.lWa)}zPa(){const K=this.nb.appSettings.BreadcrumbFolderUrl;b.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");I.a.Ve(K,I.a.GW(3),void 0,"UploadToHostManager.RedirectToFolder")}yPa(K){let L=!1,V=!1;this.nb&&(L=this.nb.qa("SaveACopyIsEnabledForUiHost"),V=this.nb.qa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",
K,L,V);if(L&&V){b.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const W={};W[U.a.tPa]="1";W[U.a.documentUrl]=K;W[U.a.reason]=S.a.saveAs;n.AFrameworkApplication.GU().execute(da=>{da.Fj(X.a.tta,W)})}else L&&!V&&n.AFrameworkApplication.bba?I.a.Ve(K,I.a.GW(4),void 0,"UploadToHostManager.RedirectToEditUrl"):I.a.Ve(K,I.a.GW(3),void 0,"UploadToHostManager.RedirectToEditUrl")}una(K,L,V=null){b.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");
this.F7d&&!this.F7d()&&this.wh&&(this.zh&&(this.Ufa=this.zh.Bc("DialogShown","SaveAsToHostUploadTime")),this.yLb(),this.lWa=L,this.qA=K,(this.Kh=V)&&"true"===this.Kh.SkipSaveToHost?this.E7b():this.WP())}WP(){32!==this.La.processAction(e.a.AQa,1)?(b.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.E7b()):this.La.de(e.a.AQa,2,[()=>{b.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.E7b()},(K,
L)=>{b.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.KR(L)}])}VSi(K){this.UHa();this.OCa=!1;if(K&&K.data&&K.data.Vd)if(({Ut:L}=z.d(K.data.Vd)).returnValue)if(K=L,K.StatusCode!==F.a.FO&&K.StatusCode!==F.a.Sqb){b.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var L={};L.FailureReason=K.StatusCode.toString();L.ExtraInfo=K.ExtraInfo;this.Tca(L);this.KR(parseInt(K.ExtraInfo))}else{b.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.GJd();try{K.NewDocumentUrl&&""!==K.NewDocumentUrl?this.yPa(K.NewDocumentUrl):this.zPa()}catch(V){b.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",V.toString())}this.CFb()}else b.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:H.a.qeb(K.data.Vd)}),this.Tca({["FailureReason"]:"Failed to deserialize response"}),this.KR();else b.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.Tca({["FailureReason"]:"null response"}),this.KR()}USi(K){5!==K.data.status&&12!==K.data.status||this.OCa?(b.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:K.data.status,["HttpStatus"]:K.data.httpStatus}),this.Tca({["FailureReason"]:K.data.httpStatus.toString()}),this.UHa(),this.KR(),this.CFb()):(b.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.OCa=!0,this.Kh&&"true"===this.Kh.SkipSaveToHost?this.E7b():
this.WP())}UHa(){this.zm&&(this.zm.close(),this.zm=null)}CFb(){this.Ufa&&(this.Ufa.stop(),this.Ufa=null)}GJd(){this.Kh&&"VersionHistory"===this.Kh.SaveEntryPoint&&this.La.processAction(e.a.rsc,2)}Tca(K){this.Kh&&"VersionHistory"===this.Kh.SaveEntryPoint&&this.La.de(e.a.JJd,2,K)}E7b(){let K=this.MEa+this.Wea;K=A.a.Dl(K,"qs",w.a.ff(n.AFrameworkApplication.ij));K=A.a.Dl(K,"n",w.a.ff((new Date).getTime().toString()));K=A.a.Dl(K,"ov",w.a.ff(this.lWa.toString()));K=A.a.Dl(K,"fn",w.a.ff(this.qA));this.Kh&&
this.Kh.FileDownloadUrl&&(K=A.a.Dl(K,"furl",w.a.ff(this.Kh.FileDownloadUrl)));this.wh.Bm(K,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(c.a)(this,this.VSi,"onUploadFinished"),Object(c.a)(this,this.USi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(t.a)(D,"UploadToHostManager",null,[273]);var J=a(246),M=a(778);class G{constructor(){this.fb=null}get name(){return"Common.App.SaveAsToHost"}init(){n.AFrameworkApplication.fa.gv(Object(c.a)(this,this.pB,"onFullAppSettingsReady"))}pB(){n.AFrameworkApplication.fa.qa("SaveAsToHostBrsIsEnabled")&&
this.fb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Gg()}Rh(K){this.fb=K;this.fb.register(l,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Fc(()=>new l(n.AFrameworkApplication.fa,n.AFrameworkApplication.wb)).tc();this.fb.register(D,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Fc(()=>new D(n.AFrameworkApplication.wb,n.AFrameworkApplication.fa,n.AFrameworkApplication.vd,()=>n.AFrameworkApplication.Ng,
()=>(new M.a).create(),K.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),n.AFrameworkApplication.ta,n.AFrameworkApplication.ta.MD)).tc();this.fb.register(u,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Fc(()=>new u(n.AFrameworkApplication.fa,n.AFrameworkApplication.wb,n.AFrameworkApplication.ta,n.AFrameworkApplication.ta.Oa,K.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),K.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).tc();
this.fb.register(B,"Common.App.SaveAsToHost.SaveAsToHostActor").Fc(()=>new B(n.AFrameworkApplication.fa,K.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),K.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).tc()}dispose(){}static main(){J.a.instance.yi(new G)}}Object(t.a)(G,"SaveAsToHostPackage",null,[4,5]);a.d(C,"a",function(){return T});const T=()=>{Type.registerNamespace("Common.App.SaveAsToHost");G.main()}},1178:function(t,C,a){t=a(0);var c=a(83),b=a(15),d=a(144);class f{static get ag(){return d.a.ap(f.Bk,
CommonUIStrings.l_SaveACopyFileName)}}f.Bk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(t.a)(f,"FileNameDialogHtml",null,[]);var e=a(4),k=a(30);class l extends d.a{constructor(H,D,J,M){super();this.JRb=
this.V7=null;this.La=H;this.QW=D;this.wlb=J;this.rc(1,CommonUIStrings.l_SaveButtonLabel);this.ag=f.ag;this.ze="FileNameDialog-SaveACopy";this.Kh=M}OP(H,D,J){this.JRb=H;this.V7=J;H={["txtFileName"]:k.a.uq(e.AFrameworkApplication.hm.Zm),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,D)};this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(c.a)(this,this.g8b,"fileNameDialogHandler"),H);b.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");
document.getElementById("txtFileName").focus()}g8b(H,D){1!==H?b.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(H=D.txtFileName.trim(),b.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),D=k.a.t3(e.AFrameworkApplication.fileName),H&&""!==H&&""!==D&&(H+=D),this.wlb.una(this.JRb,this.V7,H,this.Kh))}}Object(t.a)(l,"FileNameDialog",d.a,[341]);class m{constructor(H,D,J){this.La=H;this.QW=D;this.wlb=J}create(H){return new l(this.La,
this.QW,this.wlb,H)}}Object(t.a)(m,"FileNameDialogFactory",null,[330]);var v=a(133),n=a(25);class w extends v.StandardDialog{constructor(H){super();this.Rb=1;this.rc(1,CommonUIStrings.l_RetryButtonLabel);this.rc(0,CommonUIStrings.l_DialogClose);this.La=H}displayError(H){b.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",H);this.Xz(H,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(c.a)(this,this.SKd,"retryDialogHandler"))}SKd(H){1===H?(b.ULS.sendTraceTag(7165653,
216,50,"User click to retry the action."),this.La.processAction(n.a.saveACopy,2)):b.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(t.a)(w,"RetryDialog",v.StandardDialog,[328]);v=a(1048);var r=a(831),u=a(371),y=a(106);class x extends v.a{constructor(H,D,J,M){super(H,D,J,M);this.Msg=D}V6a(){return this.nb.qa("SaveACopyBrsIsEnabled")}UUe(){return n.a.saveACopy}l0b(){u.a.TGd(Object(c.a)(this,this.hVf,"saveToCloudActionDispatcher"));u.a.g7c([new r.a(n.a.saveACopy,y.a.frame,0)],
this.Msg.F3a())}uMf(){b.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(t.a)(x,"SaveACopyActor",v.a,[]);v=a(1051);class B extends v.a{constructor(H,D,J,M,G,T,K){super(D,J,M,G,T,K);this.jog=H}onSuccess(H){H&&H.data&&H.data.folders?(b.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.jog.create(this.Kh).OP(H.data.folders[0].id,H.data.folders[0].name,H.data.folders[0].urls.viewInBrowser)):(b.ULS.sendTraceTag(7165656,216,
10,"Fail to select folder to upload file."),this.oj())}v5(H){H&&H.error&&"user_canceled"===H.error.code&&b.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.v5(H)}oj(){b.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.oj()}}Object(t.a)(B,"SaveACopyManager",v.a,[]);var z=a(1049);class A extends z.a{constructor(H,D,J,M,G,T){super(D,J,M,G,T);this.La=H}fpd(){return!!this.Kh&&!!this.Kh.SaveEntryPoint&&"VersionHistory"===this.Kh.SaveEntryPoint.toString()}KR(){b.ULS.sendTraceTag(7205459,
216,50,"Display Error for Save A Copy.");this.fpd()&&this.La.de(n.a.JJd,2,{["FailureReason"]:"Unknown"});super.KR()}zPa(){b.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.fpd()&&this.La.processAction(n.a.rsc,2);super.zPa()}yPa(H){b.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",H);this.fpd()&&this.La.processAction(n.a.rsc,2);super.yPa(H)}WP(){this.Kh&&"true"===this.Kh.SkipSaveToHost?super.WP():32!==this.La.processAction(n.a.AQa,
1)?(b.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.WP()):this.La.de(n.a.AQa,2,[()=>{b.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");z.a.prototype.WP.call(this)},()=>{b.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.KR()}])}}Object(t.a)(A,"SaveACopyUploadToCloudManager",z.a,[]);var I=a(246),F=a(558),U=a(778);class X{constructor(){this.fb=
null}get name(){return"Common.App.SaveACopy"}init(){e.AFrameworkApplication.fa.gv(Object(c.a)(this,this.pB,"onFullAppSettingsReady"))}pB(){e.AFrameworkApplication.fa.qa("SaveACopyBrsIsEnabled")&&this.fb.resolve("Common.App.SaveACopy.SaveACopyActor").Gg()}dispose(){}Rh(H){this.fb=H;this.fb.register(A,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Fc(()=>new A(e.AFrameworkApplication.wb,H.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new U.a).create(),()=>new w(e.AFrameworkApplication.wb),
e.AFrameworkApplication.ta,e.AFrameworkApplication.ta.MD)).tc();this.fb.register(m,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Fc(()=>new m(e.AFrameworkApplication.wb,e.AFrameworkApplication.ta.Oa,H.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).tc();this.fb.register(x,"Common.App.SaveACopy.SaveACopyActor").Fc(()=>new x(H.resolve("Common.App.SaveACopy.SaveACopyManager"),H.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
e.AFrameworkApplication.fa,e.AFrameworkApplication.ta.MD)).tc();this.fb.register(B,"Common.App.SaveACopy.SaveACopyManager").Fc(()=>new B(H.resolve("Common.App.SaveACopy.FileNameDialogFactory"),H.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),F.a.instance,H.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),e.AFrameworkApplication.fa,e.AFrameworkApplication.E1a,()=>new w(e.AFrameworkApplication.wb))).tc()}static main(){I.a.instance.yi(new X)}}Object(t.a)(X,"PackageManager",
null,[4,5]);a.d(C,"a",function(){return S});const S=()=>{Type.registerNamespace("Common.App.SaveACopy");X.main()}},1179:function(t,C,a){var c=a(10);t=a(0);var b=a(221),d=a(15),f=a(30),e=a(84),k=a(240),l=a(36);class m extends k.a{constructor(J,M,G){super(J,M);this.eCd=this.executionContext=null;this.qWi=(T,K)=>{this.tFb(T,K)};this.RJ=G}initialize(J){super.initialize(J)}execute(J){this.executionContext=J;J=Object(e.a)(7,this.executionContext.Ae);this.Iqb(J);return 1}LI(J){super.LI(J)}Iqb(){this.subscribe(this.executionContext,
this.qWi,J=>{this.eCd.add_disposing(J)})}tFb(J){this.unsubscribe(M=>{J.remove_disposing(M)});this.executionContext.activityState[l.a.B1]=0}}Object(t.a)(m,"PasswordProtectedFileActivity",k.a,[]);var v=a(282),n=a(260),w=a(14);class r extends v.a{constructor(J){super(J);this.gpa=0;this.C4i=(M,G)=>{this.kab(M,G)};this.XYd=(M,G)=>{this.ATa(M,G)}}get oc(){return"PasswordDialog"}get Crb(){return this.gpa}get Gl(){return w.a.instance.ga(1981)}kab(J){this.gpa=J}z2(){const J={};J[v.a.description]=w.a.instance.ga(1982);
J[v.a.U5]=w.a.instance.ga(1978);J[v.a.xFf]=w.a.instance.ga(2E3);J[v.a.vFf]=w.a.instance.ga(2001);J[v.a.wFf]=w.a.instance.ga(1979);J[v.a.Njd]=w.a.instance.ga(1985);J[v.a.Ere]=w.a.instance.ga(1667);J[v.a.BVj]=w.a.instance.Xa(25);J[v.a.efg]=this.XYd;return J}Hsa(){const J={};J[n.a.Tu]=this.oc;J[v.a.tZa]=this.z2();return J}vg(){this.Rb=1;this.initializeAndShow(this.Gl,this.C4i,this.Hsa())}}Object(t.a)(r,"PasswordProtectedFilePasswordInputDialog",v.a,[]);var u=a(61),y=a(29),x=a(281),B=a(51);class z extends r{constructor(J){super(J);
this.NKd=5;this.A8d=!1;this.passwordToModify=null;this.yFf=()=>{this.$.isEditMode&&this.dgc&&(B.b().d7c("PasswordToModifyPasswordVerifiedTillInteractive"),this.$.Al(this.yFf))};this.vg();this.$.el(this.yFf)}get dgc(){return this.A8d}get Gl(){return w.a.instance.ga(1983)}kab(J,M){super.kab(J,M);d.ULS.sendTraceTag(537154755,0,50,`PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: ${J}`)}ATa(J,M){this.passwordToModify=J;const G={};G.FileModifyPassword=
f.a.ff(J);u.M(this.$.oa.va,G,this.$Si(M),this.ZSi(M),null,null)}z2(){const J=super.z2();J[v.a.Njd]=w.a.instance.ga(1986);J[v.a.description]=w.a.instance.Xa(24);return J}vg(){B.b().d7c("PasswordToModifyDialogShown");d.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");super.vg()}$Si(J){return M=>{y.a.jh(M.Errors,[-2019873242])&&this.w5b(this.Aqb());if(!M||x.a(M))if(0<this.NKd)this.WKf(J);else{d.ULS.sendTraceTag(537154754,
0,10,`VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: ${y.a.yc(M.Errors)}`);this.$.ea.zp(M.Errors);this.hide();return}this.A8d=M.Result;this.dgc&&(B.b().OSd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),d.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));
J(this.dgc?0:1)}}ZSi(J){return()=>{0<this.NKd?this.WKf(J):(d.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),J(3))}}WKf(J){--this.NKd;this.ATa(this.passwordToModify,J)}Aqb(){return y.a.Yc(1,0,1666,1667,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")}}Object(t.a)(z,"PasswordProtectedFileModifyPasswordInputDialog",r,[]);var A=a(6);class I extends m{constructor(J,M,G){super(J,M,G)}Iqb(J){this.eCd=
new z(J);super.Iqb(J)}tFb(J,M){const G=J.Crb,T=J.dgc,K=J.passwordToModify;super.tFb(J,M);this.executionContext.zxa([2001366804]);switch(G){case 1:T?(M=Object(e.a)(7,this.executionContext.Ae),this.executionContext.activityState[l.a.Mje]=f.a.ff(K),this.executionContext.activityState[l.a.KXa]=!0,J.passwordToModify="",this.fh(M.isEditMode?A.a.yj:this.JJ)):d.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");
this.vp();break;case 0:this.executionContext.activityState[l.a.Fr]=!1;this.fh(this.RJ);this.vp();break;default:d.ULS.sendTraceTag(537154756,0,50,`PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '${G}'`)}}}Object(t.a)(I,"PasswordProtectedFileModifyActivity",m,[]);class F extends b.a{constructor(J,M,G,T){super();this.activityName=J;this.JJ=M;this.RJ=G;this.$=T;this.Fb()}create(){this.qb(new I(this.activityName,this.JJ,this.RJ))}static ka(J){J.da.Ga(434,new F(A.a.sFb,
A.a.keb,A.a.Bpb,J))}}Object(t.a)(F,"PasswordProtectedFileModifyActivityFactory",b.a,[]);var U=a(42);class X extends r{constructor(J,M){super(J);this.password=null;this.thf=M;this.vg()}ATa(J,M){this.password=J;M(0)}z2(){const J=super.z2();this.thf&&(J[v.a.jlh]=1);return J}vg(){d.ULS.sendTraceTag(537154722,0,50,`PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword=${this.thf}`);super.vg();U.a(this.$).Une()}}Object(t.a)(X,"PasswordProtectedFileOpenPasswordInputDialog",
r,[]);class S extends m{constructor(J,M,G){super(J,M,G)}Iqb(J){const M=y.a.jh(this.executionContext.errors,[1217361942]);this.eCd=new X(J,M);J.gec||J.CGe();super.Iqb(J)}tFb(J,M){let G,T;G=J.password;J.password="";T=J.Crb;super.tFb(J,M);this.executionContext.activityState[l.a.PSc]=f.a.ff(G);this.executionContext.activityState[l.a.KXa]=!0;this.executionContext.zxa([110414285,1217361942]);d.ULS.sendTraceTag(537154752,0,50,`PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: ${T}`);
switch(T){case 1:this.fh(this.JJ);this.vp();break;case 0:this.fh(this.RJ),this.vp()}}}Object(t.a)(S,"PasswordProtectedFileOpenActivity",m,[]);class H extends b.a{constructor(J,M,G,T){super();this.activityName=J;this.JJ=M;this.RJ=G;this.$=T;this.Fb()}create(){this.qb(new S(this.activityName,this.JJ,this.RJ))}static ka(J){J.da.Ga(386,new H(A.a.ooc,A.a.yj,A.a.Jj,J))}}Object(t.a)(H,"PasswordProtectedFileOpenActivityFactory",b.a,[]);a.d(C,"a",function(){return D});const D=()=>{c.a.Fa(H.ka);c.a.Fa(F.ka)}},
1187:function(t,C,a){t=a(0);var c=a(133);class b extends c.StandardDialog{constructor(){super();this.Rb=0;this.rc(1,CommonUIStrings.l_DialogClose)}displayError(S){this.Xz(S,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(t.a)(b,"ErrorDialog",c.StandardDialog,[328]);var d=a(1051),f=a(1048),e=a(15),k=a(83),l=a(4),m=a(251),v=a(39),n=a(25);class w extends c.StandardDialog{constructor(S,H,D){super();this.La=S;this.m1=H;this.QW=D;this.Hv=!1;this.Rb=1;this.S_(1);
this.rc(1,CommonUIStrings.l_SignIn);this.rc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}OP(){this.m1.WXa(Object(k.a)(this,this.pCf,"onSignIn"));this.wl(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(k.a)(this,this.Oai,"inputHandler"))}Oai(S){0===S?(e.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.T5()}ZVg(){let S="2";if(this.QW)switch(this.QW.xj){case 3:S="0";break;case 2:S="3";break;case 1:S="1"}return S}hide(){this.m1.DHb(Object(k.a)(this,
this.pCf,"onSignIn"));super.hide()}T5(){const S=new m.QueryStringBuilder("Signin.aspx");S.Qi("prompt","1");S.Qi("cbcxt",this.ZVg());l.AFrameworkApplication.NXa(S);v.a.Ve(S.toString(),"LoginWindow",void 0,"SignInDialog")}pCf(){this.pp&&this.hide();e.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(n.a.saveToCloudStorage,2)}}Object(t.a)(w,"SignInDialog",c.StandardDialog,[292]);class r{constructor(S,H,D){this.La=S;this.m1=
H;this.QW=D}create(){return new w(this.La,this.m1,this.QW)}}Object(t.a)(r,"SignInDialogFactory",null,[272]);var u=a(80),y=a(30);class x{constructor(S,H,D,J,M,G,T){this.MEa=S;this.qA=H;this.cVa=D;this.JRb=J;this.VNc=M;this.Wea=G;this.Kh=T}execute(S,H){if(!l.AFrameworkApplication.Ng&&l.AFrameworkApplication.vd){var D=this.MEa+this.Wea;D=u.a.Dl(D,"fo",y.a.ff(this.JRb));D=u.a.Dl(D,"fn",y.a.ff(this.qA));D=u.a.Dl(D,"qs",y.a.ff(this.VNc));D=u.a.Dl(D,"n",y.a.ff((new Date).getTime().toString()));this.Kh&&
this.Kh.FileDownloadUrl&&(D=u.a.Dl(D,"furl",y.a.ff(this.Kh.FileDownloadUrl)));this.cVa&&(D=u.a.Dl(D,"fnn",y.a.ff(this.cVa)));l.AFrameworkApplication.vd.Bm(D,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,S,H,null)}}}Object(t.a)(x,"SkyDriveUploadCaller",null,[291]);class B{constructor(S){this.nb=S;this.NEa=S.appSettings.SkyDriveUploadWebServiceBase;this.qA=S.appSettings.FileName;this.Wea=S.Va("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(S,H,D){return new x(this.NEa,this.qA,
H,S,l.AFrameworkApplication.ij,this.Wea,D)}}Object(t.a)(B,"SkydriveUploadCallerFactory",null,[271]);var z=a(1049),A=a(246),I=a(558),F=a(778);class U{constructor(){this.fb=null}get name(){return"Common.App.SaveToCloudStorage"}init(){l.AFrameworkApplication.fa.qa("SaveToCloudStorageUIIsEnabled")&&this.fb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Gg()}dispose(){}Rh(S){this.fb=S;this.fb.register(r,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Fc(()=>
new r(l.AFrameworkApplication.wb,I.a.instance,l.AFrameworkApplication.ta.Oa)).tc();this.fb.register(B,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Fc(()=>new B(l.AFrameworkApplication.fa)).tc();this.fb.register(f.a,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Fc(()=>new f.a(S.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),S.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
l.AFrameworkApplication.fa,l.AFrameworkApplication.ta.MD)).tc();this.fb.register(z.a,"Common.App.SaveToCloudStorage.UploadToCloudManager").Fc(()=>new z.a(S.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new F.a).create(),()=>new b,l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.MD)).tc();this.fb.register(d.a,"Common.App.SaveToCloudStorage.SaveToCloudManager").Fc(()=>new d.a(S.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),I.a.instance,S.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
l.AFrameworkApplication.fa,l.AFrameworkApplication.E1a,()=>new b)).tc()}static main(){A.a.instance.yi(new U)}}Object(t.a)(U,"PackageManager",null,[4,5]);a.d(C,"a",function(){return X});const X=()=>{Type.registerNamespace("Common.App.SaveToCloudStorage");U.main()}},1188:function(t,C,a){t=a(0);var c=a(83),b=a(15),d=a(4),f=a(53),e=a(414),k=a(82);class l{constructor(z,A,I,F){this.ILc=null;this.SQb=F;this.lX=z;this.mX=A;this.RD=I;this.Gfe=this.Wnf.Iwj;z=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");
this.Vrg=z[0];this.Urg=z[1]}get Wnf(){return this.ILc||(this.ILc=k.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get wva(){return CommonUIStrings.l_OICErrorHelpLink}get cwc(){return this.Gfe}get Ynf(){return this.Vrg}get Xnf(){return this.Urg}get Vnf(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.Gfe?3:2}get Bsb(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get t2b(){return!!this.mX}get Csb(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get Gl(){return CommonUIStrings.l_DefaultDialogTitle}KFd(z){this.lDb(z)}bsd(z){this.lDb(z)}lDb(z){let A=
10;this.mX&&1===z&&(this.mX(this.RD),A=1);this.lX&&this.lX(this.RD);this.TF(A)}UNa(){e.Redirect.showHelp("OICFailure");this.TF(2)}Xxd(){this.Wnf.vjf();this.TF(4)}TF(z){b.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.SQb,z);d.AFrameworkApplication.isc(f.a.kEf,this.SQb,z)}dispose(){this.RD=this.lX=this.mX=null}}Object(t.a)(l,"AOICErrorDialog",null,[2]);var m=a(44),v=a(133);class n extends l{constructor(z,A,I,F){super(z,A,I,F);this.bqa=this.am=null;z=
document.createElement("span");z.id="errorMessageText";z.innerText=this.errorMessage;z.appendChild(document.createElement("br"));z.appendChild(document.createElement("br"));this.am=document.createElement("a");this.am.href="#";this.am.innerText=this.wva;z.appendChild(this.am);m.a.addHandler(this.am,"click",Object(c.a)(this,this.UNa,"oicErrorHelpLinkHandler"));A=new v.StandardDialog;A.ze=this.id;this.cwc?(I=document.createElement("span"),F=document.createElement("span"),I.innerText=this.Ynf,F.innerText=
this.Xnf,this.bqa=document.createElement("a"),this.bqa.href="#",this.bqa.innerText=this.Vnf,z.appendChild(document.createElement("br")),z.appendChild(I),z.appendChild(this.bqa),z.appendChild(F),m.a.addHandler(this.bqa,"click",Object(c.a)(this,this.Xxd,"oicErrorMacOfferLinkHandler"))):this.t2b&&(z.appendChild(document.createElement("br")),z.appendChild(document.createElement("br")),I=document.createElement("span"),I.innerText=this.Bsb,z.appendChild(I));this.t2b?(A.Rb=1,A.rc(1,this.Csb)):A.Rb=0;A.wl(this.Gl,
null,this.icon,Object(c.a)(this,this.bsd,"legacyOICErrorDialogHandler"),z);A.jW("errorMessageText")}dispose(){this.am&&(m.a.removeHandler(this.am,"click",Object(c.a)(this,this.UNa,"oicErrorHelpLinkHandler")),this.am=null);this.bqa&&(m.a.removeHandler(this.bqa,"click",Object(c.a)(this,this.Xxd,"oicErrorMacOfferLinkHandler")),this.bqa=null);super.dispose()}}Object(t.a)(n,"OICErrorDialog",l,[]);class w{constructor(z,A,I){this.lX=A;this.mX=z;this.RD=I}get id(){return"OICErrorDialogWithDownload"}get VKe(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get wva(){return CommonUIStrings.l_OICErrorHelpLink}get Bsb(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get Csb(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get Gl(){return CommonUIStrings.l_DefaultDialogTitle}KFd(z){this.lDb(z)}bsd(z){this.lDb(z)}lDb(z){let A=
10;1===z&&(this.mX(this.RD),A=1);this.lX&&this.lX(this.RD);this.TF(A)}UNa(){e.Redirect.showHelp("OICFailure");this.TF(2)}TF(z){d.AFrameworkApplication.isc(f.a.lEf,3,z)}dispose(){this.RD=this.mX=this.lX=null}}Object(t.a)(w,"AOICErrorDialogWithDownload",null,[2]);class r extends w{constructor(z,A,I){super(z,A,I);this.am=null;z=document.createElement("span");z.id="errorMessageText";z.innerText=this.VKe;z.appendChild(document.createElement("br"));z.appendChild(document.createElement("br"));this.am=document.createElement("a");
this.am.href="#";this.am.innerText=this.wva;z.appendChild(this.am);m.a.addHandler(this.am,"click",Object(c.a)(this,this.UNa,"oicErrorHelpLinkHandler"));z.appendChild(document.createElement("br"));z.appendChild(document.createElement("br"));A=document.createElement("span");A.innerText=this.Bsb;z.appendChild(A);A=new v.StandardDialog;A.ze=this.id;A.Rb=1;A.rc(1,this.Csb);A.wl(this.Gl,null,this.icon,Object(c.a)(this,this.bsd,"legacyOICErrorDialogHandler"),z);A.jW("errorMessageText")}dispose(){this.am&&
(m.a.removeHandler(this.am,"click",Object(c.a)(this,this.UNa,"oicErrorHelpLinkHandler")),this.am=null);super.dispose()}}Object(t.a)(r,"OICErrorDialogWithDownload",w,[]);var u=a(144);class y extends l{constructor(z,A,I,F){super(z,A,I,F);A={["errorMessage"]:this.errorMessage};A.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.wva,["onExecute"]:U=>{this.UNa(U)}};this.cwc?(A.macOfficePreLinkText=this.Ynf,A.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.Vnf,
["onExecute"]:U=>{this.Xxd(U)}},A.macOfficePostText=this.Xnf):this.t2b&&(A.errorFileDownloadOffer=this.Bsb);z=new u.a(!1,!1,!0);this.t2b?(z.Rb=1,z.rc(1,this.Csb)):z.Rb=0;z.ze=this.id;A={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:A};z.initializeAndShow(this.Gl,Object(c.a)(this,this.KFd,"reactOICErrorDialogHandler"),A)}}Object(t.a)(y,"ReactOICErrorDialog",l,[]);class x extends w{constructor(z,A,I){super(z,A,I);A={["errorMessage"]:this.VKe,["errorFileDownloadOffer"]:this.Bsb};A.helpLink=
{["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.wva,["onExecute"]:F=>{this.UNa(F)}};z=new u.a(!1,!1,!0);z.Rb=1;z.rc(1,this.Csb);z.ze=this.id;A={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:A};z.initializeAndShow(this.Gl,Object(c.a)(this,this.KFd,"reactOICErrorDialogHandler"),A)}}Object(t.a)(x,"ReactOICErrorDialogWithDownload",w,[]);a.d(C,"a",function(){return B});class B{constructor(){this.yib=!!d.AFrameworkApplication.ta&&d.AFrameworkApplication.ta.Oa.mv}A7g(z,A,I){this.yib?
new y(z,A,null,I):new n(z,A,null,I)}B7g(z,A,I){this.yib?new x(z,A,I):new r(z,A,I)}C7g(z,A,I,F,U){const {ReactOICErrorDialogWithTrial:X}=a(1328),{OICErrorDialogWithTrial:S}=a(1329);this.yib?new X(z,A,I,null,F,U):new S(z,A,I,null,F,U)}static get instance(){return B.Ma||(B.Ma=new B)}}B.Ma=null;Object(t.a)(B,"OICErrorDialogFactory",null,[312])},1205:function(t,C,a){var c=a(10);t=a(0);var b=a(691),d=a(21),f=a(43),e=a(1),k=a(15),l=a(30),m;(function(F){F[F.url=0]="url";F[F.ref=1]="ref";F[F.mailto=2]="mailto"})(m||
(m={}));Object(t.b)("HyperlinkSelectionState",m);var v=a(766),n=a(8),w=a(580),r=a(61),u=a(96),y=a(14);class x extends v.a{constructor(F,U,X){super(F);this.Vlb=0;this.qyb=!1;this.$0a=null;this.OGe=!1;this.nqb=!0;this.Gl=this.ySc=null;this.Hwd=0;this.Gwd=this.Iwd=null;this.removeHyperLink=!1;this.location=this.cellValue=null;this.B6h=(S,H)=>{1===S||2===S?(k.ULS.sendTraceTag(555755670,0,50,`HyperLink ${1===S?"OK":"Remove"} pressed`),this.Iwd=H[x.xri],this.Hwd=H[x.qlj],this.Gwd=H[x.Ffh],2===S&&(this.removeHyperLink=
!0),this.commit()):k.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};this.jVj=(S,H)=>0!==H&&S.length?1===H?this.EXe(f.y(S,this.ea.xa)||this.mBi(S),765):this.EXe(l.a.Dmd(S),767):null;this.selectedRange=U;this.VL=X;this.ea=F.ea;this.sheetName=U.SheetName;this.cLa();this.Fo();this.Rb=this.qyb?9:1;this.rc(1,y.a.instance.ga(4));this.qyb&&this.rc(2,y.a.instance.ga(768));this.initializeAndShow(this.Gl,this.B6h,{[x.Tu]:this.oc,[x.kVj]:this.jVj,[x.jOg]:{[x.Oeh]:this.OGe,[x.Gfh]:this.$0a,[x.fzg]:this.Vlb,
[x.gzg]:this.ySc,[x.W2g]:this.nqb}})}get oc(){return"HyperLinkDialog"}rZe(F,U){switch(U){case 2:return F.startsWith("mailto:")?F:"mailto:"+F;case 1:return`${n.a.cHf}${this.tQh(F)}`;default:return F}}get Rw(){return 526}KA(){const F=this.$;this.location=this.rZe(this.Iwd,this.Hwd);try{this.location=u.a.Ah(this.location)}catch(S){k.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}k.ULS.sendTraceTag(555755667,0,50,`Committing ${m[this.Hwd]} link`);this.cellValue=this.Gwd.length?this.Gwd:
this.Iwd;F.ry();const U=F.oa.va.Sb(),X=f.s(this.selectedRange);return(S,H,D)=>r.b(F.oa.va,X,this.cellValue,this.location,this.removeHyperLink,!1,123,S,H,D,this.VL.range,U)}jj(){const F=f.s(this.selectedRange);return()=>new w.a(F,this.cellValue,this.location)}mxh(){let F=this.VL.cell.O4a;this.VL.cell.lwb?F&&F.startsWith("mailto:")?(this.Vlb=2,F=F.substr(7)):this.Vlb=0:this.Vlb=1;return F}cLa(){e.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?this.qyb=this.VL.waa:this.qyb=!!this.VL.KJa(64)||
!!this.VL.KJa(128)}Fo(){if(this.qyb){this.$0a=this.VL.text;const F=this.mxh();F&&(this.ySc=F);this.Gl=y.a.instance.ga(832);this.nqb=this.ySc===this.$0a}else this.VL.text?(this.$0a=this.VL.text,this.nqb=!1):(this.$0a="",this.nqb=!0),this.Vlb=0,this.Gl=y.a.instance.ga(831);this.VL.gF&&(this.nqb=!1,this.OGe=!0,e.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.$0a=this.VL.formulaBarText))}mBi(F){return this.ea.zb.Ek(F)}EXe(F,U){return F?null:y.a.instance.ga(U)}tQh(F){let U,
X;({sheetName:U,range:X}=f.Z(F,this.ea.xa)).returnValue&&X&&(F=f.x(X,U||this.sheetName,!1));return F}}x.kVj="validateLinkValues";x.jOg="bodyProps";x.Oeh="disableDisplayText";x.Gfh="displayTextValue";x.fzg="activeLinkOption";x.gzg="activeLinkValue";x.W2g="copyLinkValueToDisplay";x.xri="linkValue";x.qlj="selectedLink";x.Ffh="displayText";Object(t.a)(x,"HyperlinkDialog",v.a,[]);var B=a(55);class z{constructor(F,U){this.$=F;this.gridView=U}Nc(){return!1}Cc(F,U){return 1===F&&-1583422759===U.command}Rc(){return!1}executeCommand(){this.Nzj();
return B.Task.Ta(!0)}Nzj(){const F=f.v(this.gridView.ha.sa.Wc,this.$),U=d.e(this.gridView);(!e.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.rq([this.gridView.ha.sa.Wc],!0))&&U&&new x(this.$,F,U)}}Object(t.a)(z,"ShowHyperlinkCommandHandler",null,[195]);class A extends b.a{constructor(F){super(F)}yd(){this.gd([new z(this.$,d.g(this.$))])}static ka(F){b.a.Nd(105,new A(F))}}Object(t.a)(A,"ShowHyperlinkCommandHandlerFactory",b.a,[]);a.d(C,
"a",function(){return I});const I=()=>{c.a.Fa(A.ka)}},1206:function(t,C,a){var c=a(10);t=a(0);var b=a(4),d=a(106),f=a(691),e=a(61),k=a(50),l=a(37),m=a(15),v=a(182),n=a(25),w=a(55);class r{constructor(A,I){this.$=A;this.ai=I}Nc(){return!1}executeCommand(A,I,F){A=2;switch(I.command){case -309686558:A=this.ai.de(n.a.saveACopy,2,F);break;case 617689800:A=this.ai.de(n.a.saveToCloudStorage,2,F);break;case -1244760097:A=this.ai.de(n.a.saveToSharePoint,2,F)}return 2===A&&I?v.a(I.command):w.Task.Ta(!0)}Cc(A,
I){A=!1;switch(I.command){case -1244760097:case -309686558:case 617689800:A=!0,m.ULS.shipAssertTag(537153984,0,this.$.Vja,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return A}Rc(){return!1}}Object(t.a)(r,"SaveToHostCommandHandler",null,[195]);class u extends f.a{constructor(A){super(A);this.aCh=(I,F,U,X,S)=>1===U?32:I===n.a.AQa&&2===U?(I=this.$.oa.va.Sb(),e.C(this.$.oa.va,S[0],S[1],null,null,I),32):8}yd(){l.TaskExtensions.Aa(k.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.hb),()=>{this.gd([new r(this.$,b.AFrameworkApplication.wb)])},this.la,3);b.AFrameworkApplication.wb.Ob(n.a.AQa,d.a.frame,this.aCh)}static ka(A){f.a.Nd(267,new u(A))}}Object(t.a)(u,"SaveToHostCommandHandlerFactory",f.a,[]);var y=a(221);class x{constructor(A,I){this.$=A;this.ai=I;this.$.da.Ga(393,this)}Nc(A){switch(A){case -309686558:return 8===this.ai.processAction(n.a.saveACopy,1,null);case 617689800:return 8===this.ai.de(n.a.saveToCloudStorage,1,null);case -1244760097:return 8===
this.ai.de(n.a.saveToSharePoint,1,null)}return!1}dispose(){this.$=null}}Object(t.a)(x,"SaveToHostManager",null,[268,2]);class B extends y.a{constructor(A){super();this.$=A;this.Fb()}create(){this.qb(this.$.da.za(393)||new x(this.$,b.AFrameworkApplication.wb))}static ka(A){A.da.Ga(394,new B(A))}}Object(t.a)(B,"SaveToHostManagerFactory",y.a,[]);a.d(C,"a",function(){return z});const z=()=>{c.a.Fa(u.ka);c.a.Fa(B.ka)}},1207:function(t,C,a){var c=a(10);t=a(0);var b=a(221),d=a(15),f=a(84),e=a(114),k=a(29),
l=a(36);class m extends e.a{constructor(H,D){super(H,D)}execute(H){const D=Object(f.a)(7,H.Ae);d.ULS.shipAssertTag(537153921,0,k.a.rnb(H.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");D.kI(!0,!0);H.activityState[l.a.tXb]=D.ea.sessionId;H.activityState[l.a.Ylb]=!0;H.activityState[l.a.zXb]=!0;d.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}}Object(t.a)(m,"SessionReloadActivity",e.a,
[]);var v=a(6);class n extends b.a{constructor(){super();this.Fb()}create(){this.qb(new m(v.a.ccb,v.a.Vy))}static ka(H){H.da.Ga(142,new n)}}Object(t.a)(n,"SessionReloadActivityFactory",b.a,[]);var w=a(58),r=a(264),u=a(109),y=a(47),x=a(45),B=a(35),z=a(1),A=a(46),I=a(244),F=a(115);class U extends e.a{constructor(H,D,J,M,G){super(H,D);U.tud=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];U.sud=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];
U.Qnf=[-1468309555,611268539,-1750576502,61029505];U.Pnf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];this.Vwc=J;this.xBj=M;this.EKj=G}execute(H){var D=Object(f.a)(7,H.Ae);H.activityState[l.a.dra]=!0;var J=U.GWh(H);if(U.Avj(H,J))return U.Vxi(H),J=50,0<H.errors.length&&(J=15),d.ULS.sendTraceTag(537153891,0,J,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${k.a.yc(H.errors)}`),H.activityState[l.a.dra]=!1,this.fh(v.a.idle),
3;switch(J){case 1:case 3:this.Fai(H,J);break;case 2:this.Eai(H);break;case 0:H.activityState[l.a.LXa]=null}d.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${J}. activityName:${this.activityName}. NextActivityName:${this.WZ}. TimeFromLastStatefulResponse:${D.ea.o0}.`);var M=B.a.og(H.activityState,F.a.neb);d.ULS.shipAssertTag(40502925,0,!M||M&&(1===J||3===J),`triggerSilentReloadAfterTokenRefresh: ${M}, silentReloadType: ${J}`);D=D.Xk.reloadCount;return 0!==J&&
0<D?(M=r.a.Yua(D,200),d.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${J}] retryNum [${D}] delayInMs [${M}] activityName [${this.activityName}]`),y.a.instance.create(()=>{U.mM(H)},M,x.a.Enj),1):3}Fai(H,D){d.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");const J=Object(f.a)(7,H.Ae);H.activityState[l.a.Ylb]=!0;J.gec||A.PageLoadTrackingInfo.instance.qj("ReopenOnLoad");!U.isEditMode(H)&&k.a.rnb(H.errors)&&
(d.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),H.activityState[l.a.tXb]=J.ea.sessionId,H.activityState[l.a.zXb]=!0);H.Kud();3===D?(J.ea.fg()||J.ea.tDi(),J.kI(!0,!0),this.fh(this.EKj),H.activityState[l.a.Cje]=J.workbookContext.CalcMode):(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===D&&J.kI(!0,!0),H.activityState[l.a.HSc]=!1,this.fh(this.Vwc))}Eai(H){d.ULS.sendTraceTag(537153888,
0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");H.activityState[l.a.LXa]=null;H.Kud();this.fh(this.xBj);H=Object(f.a)(7,H.Ae);H.gec||(A.PageLoadTrackingInfo.instance.qj("RefreshOnLoad"),H.gIb())}static mM(H){H.mM()}static GWh(H){const D=Object(f.a)(7,H.Ae),J=D.ea,M=U.isEditMode(H);var G=k.a.jh(H.errors,M?U.sud:U.tud);const T=k.a.jh(H.errors,M?U.Pnf:U.Qnf),K=D.TM,L=D.Xk.reloadCount,V=D.ya.MaxConsecutiveSilentReloadAllowed,W=D.Xk.Z5e(),da=k.a.yc(H.errors),qa=k.a.yc(H.Pya),
O=0<k.a.yM(pa=>!pa.triggerSilentReopenOnly,H.errors).length;let ea=G;const R=B.a.og(H.activityState,F.a.neb);R&&(ea=!0);const oa={name:"SessionReloadSilentActivity.GetSilentReloadType"};oa.editMode=M;oa.isSilentReopenError=G;oa.isSilentRefreshError=T;oa.reloadSequenceCount=D.Xk.HPa;oa.reloadCount=L;oa.maxReloads=V;oa.stopSilentReloads=W;oa.errorNames=da;oa.processedErrorNames=qa;oa.isClientDirty=K;oa.errorsForSilentReopenOnly=O;oa.triggerSilentReloadAfterTokenRefresh=R;oa.IsReopenDisabled=D.$La;G=
w.a.Ac(oa);d.ULS.sendTraceTag(21837004,0,50,G);if(!W){if(ea&&(M?U.rvj(H):U.tvj(H)))return I.a.$0f(H,D)?3:D.$La?2:1;if(T&&(M||!J.pab))return 2}return 0}static Avj(H,D){for(const J of H.errors)if(-1337545025===J.MessageId||-238814601===J.MessageId)return!1;return k.a.yM(J=>!J.triggerSilentReopenOnly,H.errors).length?3!==D:!1}static Vxi(H){const D=k.a.yM(J=>!J.triggerSilentReopenOnly,H.errors);for(const J of D)H.Iba(J)}static isEditMode(H){const D=Object(f.a)(7,H.Ae);return D.ea.fc?D.hv&&!!(D.Bd&64):
B.a.og(H.activityState,l.a.Fr)}static tvj(H){const D=Object(f.a)(7,H.Ae),J=k.a.L$(H.errors,U.tud);if(u.b(J,M=>M.ForceVersionUpgrade))return!1;H=k.a.rnb(H.errors);return!D.ea.pab||H?!0:!1}static rvj(H){H=k.a.L$(H.errors,U.sud);return!u.b(H,D=>D.ForceVersionUpgrade)}}U.tud=null;U.sud=null;U.Qnf=null;U.Pnf=null;Object(t.a)(U,"SessionReloadSilentActivity",e.a,[]);class X extends b.a{constructor(H,D){super();this.activityName=H;this.JJ=D;this.Fb()}create(){this.qb(new U(this.activityName,this.JJ,v.a.Vy,
v.a.Zi,v.a.aNb))}static ka(H){H.da.Ga(143,new X(v.a.Qma,v.a.j_b));H.da.Ga(144,new X(v.a.Cuc,v.a.AOa));H.da.Ga(145,new X(v.a.Duc,v.a.jBd));H.da.Ga(154,new X(v.a.dcb,v.a.zO))}}Object(t.a)(X,"SessionReloadSilentActivityFactory",b.a,[]);a.d(C,"a",function(){return S});const S=()=>{c.a.Fa(H=>{n.ka(H);X.ka(H)})}},1217:function(t,C,a){var c=a(10);t=a(0);var b=a(221),d=a(15),f=a(84),e=a(240),k=a(314),l=a(29),m=a(14),v=a(377),n=a(96);class w extends v.a{constructor(z,A){super(z,A);this.gpa=0;this.xr()}get oc(){return"SharedWorkbookDialog"}get Crb(){return this.gpa}iO(z,
A){this.gpa=z;super.iO(z,A)}xr(){super.xr();this.Rb=9;const z=this.lQh();this.rc(1,m.a.instance.ga(1665));this.rc(2,m.a.instance.ga(993));this.wl(m.a.instance.ga(707),n.a.Ah(z),this.icon,this.f0)}lQh(){return String.format(m.a.instance.ga(708))}}Object(t.a)(w,"LegacySharedWorkbookDialog",v.a,[]);var r=a(6),u=a(36);class y extends e.a{constructor(z,A,I){super(z,A);this.executionContext=null;this.dri=F=>{const U=this.Bs.jd,X=Object(f.a)(7,U.Ae);let S;S=F.Crb;this.unsubscribe(H=>{F.remove_disposing(H)});
for(let H=0,D=U.errors.length;H<D;H++)-573864504===U.errors[H].MessageId&&U.Iba(U.errors[H]);switch(S){case 1:X.ea.Kzc=!0;d.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");this.fh(X.isEditMode?r.a.aNb:this.Wbh);this.vp();break;case 2:this.fh(r.a.openInExcelClient);this.vp();break;case 0:U.activityState[u.a.Fr]=!1,this.fh(this.RJ),this.vp()}};this.Wbh=A;this.RJ=I}initialize(z){super.initialize(z)}execute(z){this.executionContext=
z;this.j5g();return 1}LI(z){super.LI(z)}j5g(){const z=Object(f.a)(7,this.executionContext.Ae),A=l.a.EZa([-573864504]);A[0].HelpDescription=m.a.instance.ga(710);A[0].HelpTopicId=k.a.eri;const I=new w(z,A[0]);this.subscribe(this.executionContext,this.dri,F=>{I.add_disposing(F)})}}Object(t.a)(y,"LegacySharedWorkbookActivity",e.a,[]);class x extends b.a{constructor(z,A,I,F){super();this.activityName=z;this.JJ=A;this.RJ=I;this.$=F;this.Fb()}create(){this.qb(new y(this.activityName,this.JJ,this.RJ))}static ka(z){z.da.Ga(460,
new x(r.a.aBb,r.a.keb,z.Vzb?r.a.Jj:r.a.Bpb,z))}}Object(t.a)(x,"LegacySharedWorkbookActivityFactory",b.a,[]);a.d(C,"a",function(){return B});const B=()=>{c.a.Fa(x.ka)}},1241:function(t,C,a){t=a(0);var c=a(1279),b=a(1280),d=a(4);class f{constructor(){this.$3d=this.fb=null}get name(){return"Common.App.DirectPrint"}Rh(l){this.fb=l;l.register(c.a,"Common.App.DirectPrint.DirectPrintDialogFactory").tc().Fc(()=>new c.a(d.AFrameworkApplication.ta.vW));l.register(363,"Common.App.DirectPrint.IDirectPrintManager").tc().Fc(()=>
b.a.create(this.fb))}init(){this.$3d=this.fb.resolve("Common.App.DirectPrint.IDirectPrintManager");this.$3d.start()}dispose(){}}Object(t.a)(f,"PackageManager",null,[4,5]);var e=a(246);a.d(C,"a",function(){return k});const k=()=>{Type.registerNamespace("Common.App.DirectPrint");e.a.instance.yi(new f)}},1254:function(t,C,a){t=a(0);var c=a(15),b=a(4),d=a(86),f=a(27),e=a(38),k=a(78),l;(function(G){G[G.unableToRefreshLock=0]="unableToRefreshLock";G[G.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";
G[G.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";G[G.workbookTooLarge=3]="workbookTooLarge";G[G.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";G[G.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";G[G.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";G[G.unsupportedFeatures=7]="unsupportedFeatures";G[G.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";G[G.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";
G[G.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";G[G.lastGenericStatusError=11]="lastGenericStatusError";G[G.scratchPadWarning=12]="scratchPadWarning";G[G.authenticationLost=13]="authenticationLost";G[G.odfCompatibilityIssues=14]="odfCompatibilityIssues";G[G.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";G[G.workbookIsIrmProtected=16]="workbookIsIrmProtected";G[G.biFeatureNotAvailable=17]="biFeatureNotAvailable";G[G.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";
G[G.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";G[G.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";G[G.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";G[G.editAttemptInReadOnly=22]="editAttemptInReadOnly";G[G.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";G[G.unsupportedBrowser=24]="unsupportedBrowser";G[G.readOnlyPermissions=25]="readOnlyPermissions";G[G.documentIsIrmProtectedWarning=26]=
"documentIsIrmProtectedWarning";G[G.policyWarningMessage=27]="policyWarningMessage";G[G.workingOnIt=28]="workingOnIt";G[G.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";G[G.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";G[G.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";G[G.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";G[G.legacyConnectionsBB=33]="legacyConnectionsBB";G[G.tooManyLoadBlockingFloatingObjectsBB=
34]="tooManyLoadBlockingFloatingObjectsBB";G[G.groupedSlicersBB=35]="groupedSlicersBB";G[G.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";G[G.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";G[G.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";G[G.wacGdprNotice=39]="wacGdprNotice";G[G.automaticSensitivityLabel=40]="automaticSensitivityLabel";G[G.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";G[G.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";
G[G.localStorageDisabled=43]="localStorageDisabled";G[G.autoRefreshDisabled=44]="autoRefreshDisabled";G[G.corruptedFileRepaired=45]="corruptedFileRepaired";G[G.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";G[G.minorVersionLimitReached=47]="minorVersionLimitReached";G[G.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";G[G.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";G[G.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";
G[G.sensitivityApplicationLabelDisabledError=51]="sensitivityApplicationLabelDisabledError";G[G.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";G[G.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";G[G.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";G[G.promptEnableExternalLinks=55]="promptEnableExternalLinks";G[G.networkDown=56]="networkDown";G[G.defaultToViewDueToCogs=
57]="defaultToViewDueToCogs";G[G.refreshLinkedEntityErrorBar=58]="refreshLinkedEntityErrorBar";G[G.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";G[G.canvasHealth=60]="canvasHealth";G[G.novModeDepreciation=61]="novModeDepreciation";G[G.mismatchedFileFormatConverted=62]="mismatchedFileFormatConverted";G[G.optimizeWorkbook=63]="optimizeWorkbook";G[G.novModePostDepreciation=64]="novModePostDepreciation";G[G.officeScriptsRunning=65]="officeScriptsRunning";G[G.powerQueryRefreshDataSourceNotSupported=
66]="powerQueryRefreshDataSourceNotSupported";G[G.readOnlyPivotTable=67]="readOnlyPivotTable";G[G.powerQueryRefreshHostNotSupported=68]="powerQueryRefreshHostNotSupported";G[G.refreshPageAfterEnablingTheExtension=69]="refreshPageAfterEnablingTheExtension";G[G.count=70]="count"})(l||(l={}));Object(t.b)("EwaBusinessBarEntryType",l);var m=a(5),v=a(1054);class n extends Sys.EventArgs{constructor(G,T,K=null){super();this.$Fa=G;this.G5c=T;this.data=K}}Object(t.a)(n,"BusinessBarEntryDisplayChangedEventArgs",
Sys.EventArgs,[]);var w=a(1056),r=a(1055),u=a(1058),y=a(1057),x=a(1052),B=a(470),z=a(50),A=a(525),I=a(37),F=a(642),U=a(29),X=a(1),S=a(21),H=a(57),D=a(68),J=a(832);a.d(C,"a",function(){return M});class M extends k.a{constructor(G,T){super();this.Qa=new e.a;this.pT=null;this.BGc=[];this.ulc=()=>{this.$.oa.qLa?this.removeEntry(13):this.Yf(13,null)};this.ni=(K,L)=>{for(let V=0,W=M.ibc().length;V<W;V++)K=M.ibc()[V],this.removeEntry(K);L.context&&0<L.context.communicationErrorRetryCount&&(c.ULS.sendTraceTag(537170240,
0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.removeEntry(21));this.Ddj()};this.Un=(K,L)=>{var V;K=this.$yh(L.errors);let W=[];for(let qa=0,O=K.length;qa<O;++qa){const ea=K[qa];if(1===ea.Type&&ea.Appearance&32)W=this.b3h(ea,W);else if(L.pnj){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");
var da=(null===(V=L.context)||void 0===V?0:V.stopwatch)?L.context.stopwatch.uc:-1;5E3>da?c.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${da}ms).`):b.AFrameworkApplication.ami()||this.WCg(ea,L.context.methodName)}da=[...M.ibc()];for(let R=0,oa=W.length;R<oa;++R){const pa=W[R];this.Yf(pa,ea);Array.remove(da,pa)}for(let R=0,oa=da.length;R<oa;++R)this.removeEntry(da[R])}};this.Xc=(K,
L)=>{this.Ec(K,L)};this.Ec=()=>{const K=this.$.ea;K.fc||K.fg()||(this.uHd(),this.BGc.length=0)};this.$c=(K,L)=>{this.$.ea.fg()&&!L.$U||this.e9e(L.$U)};this.OEb=()=>{const K=this.$.userOperationManager.Uac();K&&K.operation.flags&1&&this.P2f()};this.qxf=()=>{this.P2f()};this.Uf=()=>{this.Lwe();this.Y2f()};this.uN=()=>{if(this.$.v4&&this.$.ea.fg()&&this.$.ea.fc)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),this.removeEntry(32),
this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const K=this.$.da.za(331);K&&K.IIa||this.removeEntry(55);this.removeEntry(5)}};this.$=G;this.BYa=T;this.rLg();b.AFrameworkApplication.vd&&b.AFrameworkApplication.vd.mTc(this);this.HXa=Array(70);for(let K=0;70>K;K++)this.HXa[K]=null;this.Lh=F.EcmaDateClock.instance;this.qif=this.Lh.Nb.getTime();T&&(T=G.oa,T.Ly(this.Un),T.Ir(this.ni),T.xmb(this.ulc),T.WXa(this.ulc),G.ea.jk(this.Xc),G.ea.Lu(this.Uf),G.el(this.$c),G.kk(this.Ec),G.ea.GX(this.uN),
G.userOperationManager.Hr(this.OEb),X.EwaSettings.ma(169)&&G.ea.Tg.get(45)&&b.AFrameworkApplication.fa.qa("SupportsPolicies")||this.P4e(),this.e9e(H.c(G)));G.da.Ga(5,this)}P4e(){U.a.er(this.$.ea.JF)&&this.Un(this,new B.a(this.$.ea.JF,null,!1,-1,-1,-1,-1,"",-1,"",-1))}yDg(G){this.Qa.addHandler("bBarAttachedOrDetached",G)}get K6c(){return this.BGc}get domElement(){return this.pT?this.pT.domElement:null}dispose(){if(this.$){const G=this.$,T=G.oa;T.Oz(this.Un);T.qt(this.ni);T.mrc(this.ulc);T.DHb(this.ulc);
G.ea.Ik(this.Xc);G.ea.Hw(this.Uf);G.Al(this.$c);G.zl(this.Ec);G.ea.z_(this.uN);G.userOperationManager.Co(this.OEb);S.g(G).Xb.tk(this.qxf)}d.a.Ia(this.pT);this.$=this.pT=null;super.dispose()}lei(G){switch(G){case 4:case 5:case 11:case 55:case 7:case 37:case 38:return!0;case 59:return X.EwaSettings.ma(648);default:return!1}}Yf(G,T,K=null,L=null,V=null){if(!this.$.isMobileMode||this.lei(G))this.BYa&&!this.xE(G)&&(X.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170254,
0,50,`Adding entry to BB: ${Enum.toString(l,G)}`),this.HXa[G]=this.Lh.gea,this.pT.gC(G,T,L,V),this.Qa.raiseEvent("bBarAttachedOrDetached",new n(G,!0,K))),T&&32===T.Appearance&&D.a(this.$).jd.Iba(T)}Bzj(G,T,K,L){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");x.a.initialize(G,T,K,L);this.Yf(39,null)}Cyj(G,T,K,L){v.a.initialize(G,T,K,L);this.Yf(40,null)}LAj(G,T,K,L){r.a.initialize(G,T,K,L);this.Yf(41,null)}aAj(G,T,K,L){w.a.initialize(G,T,K,L);this.Yf(42,null)}UAj(G,T,
K,L){y.a.initialize(G,T,K,L);this.Yf(53,null)}TAj(G,T,K,L){u.a.initialize(G,T,K,L);this.Yf(54,null)}removeEntry(G){this.BYa&&(X.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(l,G)}`),this.HXa[G]=null,this.pT.removeEntry(G)&&this.Qa.raiseEvent("bBarAttachedOrDetached",new n(G,!1)))}FLa(G){return this.BYa?this.pT.FLa(G):!1}xE(G){return this.BYa?this.pT.xE(G):!1}JCb(){c.ULS.sendTraceTag(537170248,0,
50,"Network disconnect notification received from the app")}Ekc(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}rLg(){const {BusinessBarControl:G}=a(1145);if(this.BYa&&!this.pT){S.g(this.$).Xb.Nk(this.qxf);var T=document.getElementById(this.$.Bb+m.a.Tte);this.pT=new G(this.$,T)}}uHd(){this.BYa&&this.pT.uHd()}Ddj(){if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const T=
this.Lh.gea;if(3E5<=T-this.qif){this.qif=T;for(let K=0;70>K;K++){var G=this.HXa[K];if(G&&(G=T-G,3E5<=G)){const L=Enum.toString(l,K);c.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${L}] was activated but not turned off for ${G} Millis`)}}}}}$yh(G){const T=[];for(const K of G)switch(K.MessageId){case -113742550:const L=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||U.a.jh(G,L))&&T.push(-113742550)}return U.a.QF(G,
T)}b3h(G,T){switch(G.MessageId){case 2113407564:const K=U.a.EZa([1821390342,-943219229,-502303485,1437034227]);for(let L=0;L<K.length;L++)K[L].HelpTopicId=G.HelpTopicId,K[L].HelpDescription=G.HelpDescription,this.BGc.push(K[L])}switch(G.MessageId){case -395951567:this.Yf(6,G);break;case 1643490758:this.Yf(4,G);break;case -907264831:this.Yf(5,G);break;case 757111532:case 2113407564:this.Yf(7,G);break;case 2010656511:this.Yf(15,G);break;case 1321660996:this.$.h4c=!0;this.Yf(8,G);break;case 526339737:this.$.h4c=
!0;this.Yf(9,G);break;case -407088521:this.Yf(10,G);break;case 1756116017:this.Yf(14,G);break;case -1703455218:this.Yf(17,G);break;case 1393475740:this.Yf(25,G);break;case -949523941:this.Yf(26,G);break;case 1779381952:this.Yf(44,G);break;case 1421575100:this.Yf(45,G);break;case 613676060:this.Yf(46,G);break;case 1233668252:this.Yf(62,G);break;case 1911608588:G=!!(this.$.Bd&64);!this.$.ea.fg()&&G&&T.push(29);break;case 1544494907:break;case -655555355:T.push(this.aqd()?1:0);break;case -1221382671:T.push(2);
break;case 1662282929:T.push(3);break;case 104919273:this.$.ea.fg()||T.push(30);break;case -689453604:G=!!(this.$.Bd&64);this.$.ea.b6e=!0;!this.$.ea.fg()&&G&&T.push(31);break;case 157762400:this.$.ea.Dfc=!0;!this.$.ea.fg()&&this.$.Bd&64&&!this.$.isEditMode&&T.push(32);break;case -1125398042:X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&!this.$.ea.fg()&&this.$.Bd&64&&!this.$.isEditMode&&T.push(34);break;case -73730134:!this.$.ea.fg()&&this.$.Bd&
64&&T.push(33);break;case -293349236:T.push(66);break;case 1580811823:T.push(68);break;case -37299333:break;case 136737622:T.push(47);break;case -1780327030:this.Yf(55,G);break;case -113742550:this.Yf(57,G);break;case -260312420:this.$.ea.fg()||T.push(67);break;default:this.Yf(11,G)}return T}k9h(){if(b.AFrameworkApplication.fa.qa("WildFireExcelBizBar")&&!J.a.Mnd(J.a.Mbd(1))&&(f.a.hp||f.a.Ug)){const G=z.GetServiceTaskFactory.create(this.$.da,155,this.$.la,1);I.TaskExtensions.Aa(G,()=>{this.Yf(20,null)},
this.la,3)}}F8h(G){!G&&A.b(this.$)&&this.Yf(61,null)}G8h(G){!G&&A.c(this.$)&&this.Yf(64,null)}e9e(G){(!G&&!this.$.printingEnabled||this.$.me.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.Yf(16,null));this.k9h();this.Lwe();this.Y2f();this.F8h(G);this.G8h(G)}Lwe(){this.$.workbookContext.Options&32768&&this.rzj()}rzj(){this.HXa[37]||this.Yf(37,null)}tBj(){this.HXa[38]||
this.Yf(38,null)}Y2f(){X.EwaSettings.ma(648)&&this.$.workbookContext.Options&524288&&this.Yf(59,null)}u3f(G,T){this.Yf(58,G,null,T)}Oke(G,T=null){this.pT.xE(G)?this.pT.INb(G,T):this.Yf(G,null,null,null,T)}P2f(){this.$.Bd&8&&this.Yf(12,null)}aqd(){const G=this.$.da.za(38);return G?G.tokenExpired:!1}WCg(G,T){if(!this.xE(21)&&-1387426400!==G.MessageId){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const K={};K.FailedMethod=T;this.Yf(21,G,
K)}}static ibc(){return M.hoe||(M.hoe=[0,1,2,3])}}M.hoe=null;Object(t.a)(M,"BusinessBarManager",k.a,[535,2,73])},1267:function(t,C,a){t=a(0);var c=a(221),b=a(1254);class d extends c.a{constructor(k){super();this.$=k;this.Fb()}create(){this.qb(this.$.da.za(5)||new b.a(this.$,!this.$.Eaa))}static ka(k){k.da.Ga(4,new d(k))}}Object(t.a)(d,"BusinessBarManagerFactory",c.a,[]);var f=a(10);a.d(C,"a",function(){return e});const e=()=>{f.a.Fa(d.ka)}},1278:function(t,C,a){t=a(0);var c=a(15),b=a(83),d=a(847),
f=a(832),e=a(1199);class k{constructor(){this.CDc=new e.a;this.ADc=new e.a;this.zDc=new e.a;this.lPg(this.CDc);this.kPg(this.ADc);this.jPg(this.zDc);this.HIc=new e.a;this.GIc=new e.a;this.FIc=new e.a;this.IRg(this.HIc);this.HRg(this.GIc);this.GRg(this.FIc);this.SEc=new e.a;this.EPg(this.SEc);this.bFa(this.SEc);this.bFa(this.zDc);this.bFa(this.ADc);this.bFa(this.CDc);this.bFa(this.GIc);this.bFa(this.HIc);this.bFa(this.FIc)}kXh(w,r){switch(w){case 1:return this.E_h(r);case 2:return this.cHh(r)}return f.a.owc?
this.SEc:null}lPg(w){w.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}kPg(w){w.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}jPg(w){w.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);
w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}IRg(w){w.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);w.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);
w.add("OverlayBig","Get the Word app");w.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");w.add("OverlaySmallSplit1","Discover Word");w.add("OverlaySmallSplit2","designed for the iPad.");w.add("SkipButton","Skip for now")}EPg(w){w.add("Headline","Get the Office Online extension for Chrome");w.add("UseAppButton","Get the extension");w.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}HRg(w){w.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);
w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);w.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);w.add("OverlayBig","Get the PowerPoint app");w.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");w.add("OverlaySmallSplit1","Discover PowerPoint");w.add("OverlaySmallSplit2",
"designed for the iPad.");w.add("SkipButton","Skip for now")}GRg(w){w.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);w.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}bFa(w){w.add("Corporation","Microsoft Corporation")}E_h(w){switch(w){case 3:return this.HIc;
case 2:return this.GIc;case 1:return this.FIc}return null}cHh(w){switch(w){case 3:return this.CDc;case 2:return this.ADc;case 1:return this.zDc}return null}static get instance(){k.Ma||(k.Ma=new k);return k.Ma}}k.Ma=null;Object(t.a)(k,"WildFireStringFactory",null,[]);var l=a(4),m=a(39),v=a(27);a.d(C,"a",function(){return n});class n{constructor(w,r,u,y,x=null,B=null){this.UMc=null;this._id=w;this.CNc=r;this.apg=x;this.sib=y;this.Dkb=B;this.Goa=null;this.pXa=u;this.alb=k.instance.kXh(r,w)}g2c(){this.Goa=
new d.a(this.title,this.message,null);this.Goa.addButton(this.aue,Object(b.a)(this,this.Utf,"onButtonOneClick"),"");this.pXa&&this.Goa.eCg(this.due,Object(b.a)(this,this.Xtf,"onButtonTwoClick"));this.Goa.U9=Object(b.a)(this,this.cHe,"dismissBar");this.Goa.image=3;this.Goa.id=16;this.Goa.closeable=!0}get title(){return this.alb.na("Headline")}get message(){return this.alb.na("CallToAction")}get kUj(){return this.pXa}get aue(){return this.pXa?this.alb.na("InstallButton"):this.alb.na("UseAppButton")}get due(){return this.pXa?
this.alb.na("OpenAppButton"):""}Utf(){this.pXa?this.qbi():this.bUj()}Xtf(){this.pXa&&this.PTi()}get LRg(){return this.Goa}get openUrl(){this.UMc||(this.UMc=this.apg());return this.UMc}qbi(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.sib&&this.Dkb&&this.Dkb();f.a.GMf(this._id,this.CNc)}PTi(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.sib&&this.Dkb&&this.Dkb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(f.a.kpe(this._id),
this.openUrl,0,!1))}bUj(){f.a.owc?this.PRg():(c.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),f.a.GOd("BizBarClicked"),1!==this.CNc&&2!==this.CNc||f.a.eYg(this.openUrl,this.sib,this._id,this.Dkb))}PRg(){this.sib?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");m.a.uU(l.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())}dfh(){this.sib?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):
c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");f.a.GOd(f.a.hxe)}cHe(){f.a.owc?this.dfh():(f.a.GOd(f.a.Mbd(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static E3b(){const w=l.AFrameworkApplication.ta.Oa,r=new n(w.xj,f.a.gbc(),8<v.a.P4a,1===w.o5,()=>w.vx,w.JUf());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return r}}Object(t.a)(n,"WildFireBusinessBar",null,[])},1279:function(t,C,a){t=a(0);var c=a(15),b=a(83),d=a(133),f=a(4),e=a(13),k=a(94),
l=a(44),m=a(179),v=a(1071),n=a(88),w=a(56),r=a(80),u=a(936);class y extends d.StandardDialog{constructor(B,z,A,I=null){super();this.YO=this.cm=this.upa=null;this.Xm=[];this.WTb=z;this.UO=B;this.vpg=A;this.fVb=I;this.$kb=new u.a("LoadResource","LoadPrintablePdf")}OP(){this.Rb=5;this.width=40;const B=document.createElement("span");B.id=this.hi("DirectPrintHeaderContent");const z=document.createElement("span");z.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(z,"DirectPrintHeader");
this.YO=document.createElement("iframe");this.YO.name="pdfObjectFrame";this.YO.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.YO.onload=Object(b.a)(this,this.R_i,"printablePdfLoaded");if(this.fVb&&0<this.fVb.count){var A=r.a.Aed(this.WTb,this.fVb);const I=r.a.SHd(this.WTb,this.fVb);this.cm=document.createElement("form");this.cm.id="printPreviewPostForm";this.cm.method="POST";this.cm.target=this.YO.name;this.cm.action=I;for(let F of A)A=document.createElement("input"),A.type="hidden",A.name=
F.key,A.value=F.value,this.cm.appendChild(A)}else this.YO.setAttribute("src",this.WTb);Sys.UI.DomElement.addCssClass(this.YO,m.a.fbe);this.vpg?(Sys.UI.DomElement.addCssClass(this.YO,"DirectPrintPdfObjectHidden"),z.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,n.a.sh(this.YO,n.a.iC,n.a.lk)):(Sys.UI.DomElement.addCssClass(this.YO,"DirectPrintPdfObject"),this.Xm.push(this.YO));B.appendChild(z);B.appendChild(document.createElement("br"));B.appendChild(this.YO);this.cm&&B.appendChild(this.cm);
B.appendChild(document.createElement("br"));B.appendChild(this.Q0g(this.cm?"#":this.WTb));this.$kb.start();this.jCb(CommonUIStrings.l_AppTitle,null,null,null,null,B);this.jW(this.hi("DirectPrintHeaderContent"));this.cm&&this.cm.submit();this.Q5g();c.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}Q0g(B){const z=document.createElement("span");var A=document.createElement("span");A.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;z.appendChild(A);f.AFrameworkApplication.fa&&
(2===f.AFrameworkApplication.ta.Oa.xj&&f.AFrameworkApplication.fa.qa("PPTDisableDirectPrintDialogDownloadPDFLink")||1===f.AFrameworkApplication.ta.Oa.xj&&f.AFrameworkApplication.fa.qa("XLODisableDirectPrintDialogOpenPDFLink"))?(B=document.createElement("span"),2===f.AFrameworkApplication.ta.Oa.xj?B.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===f.AFrameworkApplication.ta.Oa.xj&&(B.innerText=CommonUIStrings.l_InternalError_Directive,c.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),
this.upa=B,z.appendChild(document.createElement("br")),z.appendChild(B)):(A=document.createElement("a"),A.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,A.href=B,A.target="_blank",A.id="PrintPDFLink",A.className="AllowBrowserClick",this.upa=A,z.appendChild(document.createElement("br")),z.appendChild(A),this.cm&&l.a.addHandler(A,"click",Object(b.a)(this,this.snc,"onSubmit")),this.UO.ra(e.a.click,this.upa,Object(b.a)(this,this.hIe,"downloadPDFLinkClicked"),null));this.Xm.push(this.upa);
return z}snc(B){this.cm&&(this.cm.target="_blank",this.cm.submit());B.preventDefault()}Q5g(){if(0<this.Xm.length){const B=new v.a(this.Xm),z=k.FocusManager.instance().eQ();z&&(this.upa.focus(),z.af=B,z.KZ=!0)}}hIe(){c.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}Psd(){c.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}R_i(){c.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.$kb&&this.$kb.stop()}dispose(){this.upa&&
(this.UO.Ba(e.a.click,this.upa,Object(b.a)(this,this.hIe,"downloadPDFLinkClicked")),this.upa=null);w.a.y_(this.YO);this.YO=null;super.dispose()}}Object(t.a)(y,"DirectPrintDialog",d.StandardDialog,[391]);a.d(C,"a",function(){return x});class x{constructor(B){this.UO=B}RLh(B,z){return new y(this.UO,B,z,null)}}Object(t.a)(x,"DirectPrintDialogFactory",null,[380])},1280:function(t,C,a){t=a(0);var c=a(15),b=a(550),d=a(83),f=a(1332),e=a(1072);class k{constructor(r,u){this.$6f=r;this.ySa=u}}Object(t.a)(k,
"DirectPrintProbeResults",null,[]);var l=a(4),m=a(262),v=a(27),n=a(110);a.d(C,"a",function(){return w});class w{constructor(r,u,y,x,B,z,A,I,F,U){this.xWb=null;this.rng=r;this.vjb=u;this.vMc=y;this.zqg=x;this.erg=B;this.ONc=new b.a(Object(d.a)(this,this.OTh,"getProbeResults"));this.MUa=z;this.b$d=F;this.jwg=A;this.frg=I;this.mrg=U}get KC(){return this.rng}start(){}S1i(){const r=Array(this.KC.xSa.length);if(void 0!==this.vjb&&null!==this.vjb)for(let u=0;u<this.KC.xSa.length;u++)r[u]=this.KC.xSa[u]in
this.vjb&&this.zqg(this.vjb[this.KC.xSa[u]]);return r}T1i(){const r=Array(this.KC.ySa.length),u=!(void 0===this.vMc||null===this.vMc);for(let y=0;y<this.KC.ySa.length;y++){const x=this.KC.ySa[y];r[y]=u&&x in this.vMc?!0:this.erg(x)}return r}BXh(){const r=this.S1i(),u=Array(r.length);for(let y=0;y<r.length;y++)u[y]=r[y]?this.pxh(this.vjb[this.KC.xSa[y]]):null;return u}pxh(r){if(void 0===r||null===r)return null;r=r.enabledPlugin;return void 0===r||null===r?null:r.name}OTh(){var r=this.BXh();const u=
this.T1i(),y={},x={};for(let B=0;B<this.KC.xSa.length;B++)y[this.KC.xSa[B]]=r[B];for(r=0;r<this.KC.ySa.length;r++)x[this.KC.ySa[r]]=u[r];return new k(y,x)}iyj(){return this.mrg||!this.KC.isEnabled||l.AFrameworkApplication.isUnifiedHostMode?!1:this.kGj()}qwc(){if(null!=this.xWb)return this.xWb;const r=w.Rbf(this.KC);return this.xWb=this.KC.Sbf&&r||this.Kei()}Kei(){return v.a.jp&&this.KC.Mei&&v.a.jxe>=this.KC.PWg?!0:!1}kGj(){if(!this.frg(this.KC))return!1;var r=n.a.bgd(this.ONc.value.$6f);for(const u of r)if(void 0!==
u&&null!==u)return!0;r=n.a.bgd(this.ONc.value.ySa);for(const u of r)if(u)return!0;return!1}c4h(){const r=n.a.bgd(this.ONc.value.$6f);for(const u of r)if(m.a.contains(this.KC.s7h,u))return!0;return!1}q3f(r){l.AFrameworkApplication.ta&&l.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")?this.b$d(r,null):this.iyj()?this.wfh(r,this.c4h()&&!0):this.b$d(r,null)}wfh(r,u){const y=this.jwg.Bc("UserAction","OpenDirectPrintDialog");this.MUa.RLh(r,u).OP();y.stop()}static ugf(r){try{return new ActiveXObject(r),
!0}catch(u){c.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",r)}return!1}static Tbf(r){return void 0===r||null===r?!1:!(void 0===r.enabledPlugin||null===r.enabledPlugin)}static create(r){const u=new e.a(l.AFrameworkApplication.fa.appSettings);let y=null;try{y=window.navigator.mimeTypes}catch(U){c.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let x=null;try{x=window.navigator.plugins}catch(U){c.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const B=
w.Tbf,z=w.ugf;r=r.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const A=l.AFrameworkApplication.ta.MD,I=w.vgf,F=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Oa.mv&&!l.AFrameworkApplication.fa.qa("PrintDialogFallbackLinkEnabled");return new w(u,y,x,B,z,r,A,I,(U,X)=>new f.a(U,!1,X,!0,F),l.AFrameworkApplication.Xja)}static vgf(r){return v.a.jp||v.a.fu&&r.Whi||r.Sbf&&w.Rbf(r)?!0:!1}static Rbf(r){var u=v.a.fsb;if(u){var y=u.split(".");if(2===y.length)return u=parseInt(y[0]),y=
parseInt(y[1]),u>r.Bvd||u===r.Bvd&&y>=r.Fpf}return!1}}Object(t.a)(w,"DirectPrintManager",null,[363])},1327:function(t,C,a){a.d(C,"a",function(){return m});t=a(0);var c=a(83);C=a(133);var b=a(1060),d=a(259),f=a(4),e=a(13),k=a(80),l=a(27);class m extends C.StandardDialog{constructor(v,n=!0,w=!1,r=null,u=null,y=!1){super();this.iVa=this.hVa=this.cm=this.jX=null;var x=this.WUd?this.WUd:CommonUIStrings.l_DefaultDialogTitle;m.H4a=y;this.$Qb=r||new b.a(v,!0);this.$Qb.rre(this);const B=[],z=[];m.wu&&(this.DUc&&
this.DUc.forEach(F=>{Array.add(B,F)}),this.Cne&&this.Cne.forEach(F=>{Array.add(z,F)}));n?w?(this.Rb=4,this.rc(1,this.buttonText),this.rc(2,CommonUIStrings.l_DialogClose)):(this.Rb=6,this.rc(0,CommonUIStrings.l_DialogClose)):this.Rb=5;y=document.createElement("span");this.y3c&&(y.className=this.y3c);r=document.createElement("a");r.innerText=this.zic;r.href=v;r.target="_blank";r.id=this.yic;r.className=d.AFrame.joe;var A=!l.a.pz&&!!u&&0<u.count;if(A){const F=k.a.Aed(v,u);u=k.a.SHd(v,u);r.href="#";r.target=
"_self";this.cm=document.createElement("form");this.cm.id="printPreviewPostForm1";this.cm.method="post";this.cm.target="_blank";this.cm.action=u;for(var I of F)u=document.createElement("input"),u.type="hidden",u.name=I.key,u.value=I.value,this.cm.appendChild(u)}else this.cm=null;this.cm||m.H4a?m.H4a||Array.add(z,{["type"]:"AppLinkProps",["id"]:this.yic,["text"]:this.zic,["onExecute"]:()=>{this.cLf()}}):Array.add(z,{["type"]:"AppLinkProps",["id"]:this.yic,["text"]:this.zic,["handler"]:{["href"]:A?
"#":v,["target"]:A?"_self":"_blank"}});this.BNa&&Array.add(B,this.BNa);w?(v=document.createElement("span"),v.innerText=this.BNa.replace("{0}",""),y.appendChild(v)):this.vpf?(v=document.createElement("span"),v.id=this.hi("message"),I=document.createElement("span"),u=document.createElement("span"),A=this.BNa.split("{0}"),I.innerText=A[0],u.innerText=A[1],v.appendChild(I),v.appendChild(r),v.appendChild(u),y.appendChild(v)):(v=document.createElement("span"),v.innerText=this.BNa,y.appendChild(v),y.appendChild(document.createElement("br")),
y.appendChild(document.createElement("br")),y.appendChild(r),m.H4a||Array.add(B,"{0}"));this.cm&&y.appendChild(this.cm);m.wu&&(this.G7a&&(this.XAb?this.oke(this.G7a,this.XAb):(Array.add(B,"{0}"),Array.add(z,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.G7a,["onExecute"]:()=>{this.sic()}}))),this.fra(B,z));this.jCb(x,null,this.n8e,null,Object(c.a)(this,this.$v,"dialogHandler"),m.wu?null:y);this.jW(this.hi("message"));!m.wu&&this.XAb&&this.G7a&&(x=document.createElement("div"),x.className=
"WACDialogLearnMoreLinkContainer",this.jX=document.createElement("a"),this.jX.innerText=this.G7a,this.jX.href=this.XAb,this.jX.target="_blank",this.jX.id=this.hi("LearnMoreLinkId"),this.jX.className=d.AFrame.joe,x.appendChild(this.jX),n?this.vb.insertBefore(x,this.vb.lastChild):this.vb.appendChild(x),this.jW(String.format("{0} {1}",this.hi("message"),this.hi("LearnMoreLinkId"))));this.ghb=r;w?this.yI(this.PB):this.yI(this.ghb);this.Zkf();f.AFrameworkApplication.ta.vW.ra(e.a.click,this.ghb,Object(c.a)(this,
this.fIe,"downloadLinkClicked"),null);this.jX&&f.AFrameworkApplication.ta.vW.ra(e.a.click,this.jX,Object(c.a)(this,this.sic,"learnMoreLinkClicked"),null);this.YQb=!1}get n8e(){return null}get WUd(){return null}get BNa(){return null}get XAb(){return null}get G7a(){return null}get vpf(){return!1}get buttonText(){return CommonUIStrings.l_Open}get y3c(){return null}get DUc(){return null}get Cne(){return null}dWc(){this.cm&&(this.hVa||(this.hVa=Object(c.a)(this,this.QEi,"onActionButtonClicked"),this.Cy.ra(e.a.click,
this.PB,this.hVa)),this.iVa||(this.iVa=Object(c.a)(this,this.REi,"onActionButtonKeyUp"),this.Xd.ra(e.a.Fd,this.PB,this.iVa)));super.dWc()}QEi(v){this.YPe(v);return!0}REi(v){return this.hif(v,Object(c.a)(this,this.YPe,"executeDismissActionButtonFromArgs"))}YPe(v){this.cm&&this.cm.submit();this.Vta(v.Cb)}Psd(){}fIe(){this.alf();this.cm?this.cm.submit():this.$Qb.M5c();return!0}sic(){return!1}dispose(){this.$Qb.dispose();this.ghb&&(f.AFrameworkApplication.ta.vW.Ba(e.a.click,this.ghb,Object(c.a)(this,
this.fIe,"downloadLinkClicked")),this.ghb=null);this.jX&&(f.AFrameworkApplication.ta.vW.Ba(e.a.click,this.jX,Object(c.a)(this,this.sic,"learnMoreLinkClicked")),this.jX=null);this.Cy&&this.hVa&&(this.Cy.Ba(e.a.click,this.PB,this.hVa),this.hVa=null);this.Xd&&this.iVa&&(this.Xd.Ba(e.a.Fd,this.PB,this.iVa),this.iVa=null);super.dispose()}cLf(){this.cm&&(document.body.appendChild(this.cm),this.cm.submit(),document.body.removeChild(this.cm))}$v(v){1===v&&(this.Psd(),this.cm?m.wu&&this.cLf():this.$Qb.M5c());
this.dispose()}static get wu(){return f.AFrameworkApplication.ta.Oa.mv&&f.AFrameworkApplication.ta.Oa.dff}static get H4a(){return m.B6d}static set H4a(v){m.B6d=v}}m.B6d=!1;Object(t.a)(m,"ADialogWithLinkToResource",C.StandardDialog,[])},1328:function(t,C,a){a.r(C);a.d(C,"ReactOICErrorDialogWithTrial",function(){return f});t=a(0);var c=a(83);C=a(1062);var b=a(414),d=a(144);class f extends C.a{constructor(e,k,l,m,v,n){super(e,k,l,m,v,n);k={["errorMessage"]:this.UKe,["offerString"]:this.qsf};e=new d.a(!1,
!1,!0);this.Q2f?(e.Rb=1,k.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.wva,["onExecute"]:()=>{b.Redirect.showHelp(this.K6e)}}):(e.Rb=4,e.rc(2,this.h8e));e.rc(1,this.RWb);e.ze=this.id;k={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:k};e.initializeAndShow(this.Gl,Object(c.a)(this,this.r4i,"reactOICErrorDialogWithTrialHandler"),k)}}Object(t.a)(f,"ReactOICErrorDialogWithTrial",C.a,[])},1329:function(t,C,a){a.r(C);a.d(C,"OICErrorDialogWithTrial",function(){return d});t=
a(0);var c=a(83);C=a(1062);var b=a(133);class d extends C.a{constructor(f,e,k,l,m,v){super(f,e,k,l,m,v);f=document.createElement("span");f.innerText=this.UKe;f.appendChild(document.createElement("br"));f.appendChild(document.createElement("br"));e=document.createElement("span");e.innerText=this.qsf;f.appendChild(e);e=new b.StandardDialog;this.Q2f?(e.Rb=1,e.xke(this.wva,this.K6e)):(e.Rb=4,e.rc(2,this.h8e));e.rc(1,this.RWb);e.ze=this.id;e.wl(this.Gl,null,this.icon,Object(c.a)(this,this.$qi,"legacyOICErrorDialogWithTrialHandler"),
f)}}Object(t.a)(d,"OICErrorDialogWithTrial",C.a,[])},1330:function(t,C,a){a.r(C);a.d(C,"CheckRoamingRightsRequest",function(){return c});t=a(0);a=a(1063);class c extends a.a{constructor(){super()}uvb(){return 2}daa(){return 1}}Object(t.a)(c,"CheckRoamingRightsRequest",a.a,[])},1331:function(t,C,a){a.r(C);a.d(C,"GetRoamingLauncherRequest",function(){return c});t=a(0);a=a(1063);class c extends a.a{constructor(){super()}uvb(){return 0}daa(){return 2}}Object(t.a)(c,"GetRoamingLauncherRequest",a.a,[])},
1332:function(t,C,a){a.d(C,"a",function(){return m});t=a(0);var c=a(15),b=a(1327),d=a(1060),f=a(4),e=a(88),k=a(80),l=a(27);class m extends b.a{constructor(v,n,w=null,r=!0,u=!1){super(v,!0,!(m.jBa&&r),new d.a(v,n),w,u);m.jBa=m.jBa&&r;if(m.jBa){n=document.createElement("iframe");r=null;u=this.reh;n.name="pdfObjectFrame";n.id="pdfObjectIFrame";if(w&&0<w.count){const y=k.a.Aed(v,w);v=k.a.SHd(v,w);r=document.createElement("form");r.id="printPreviewPostForm";r.method="POST";r.target=n.name;r.action=v;for(let x of y)v=
document.createElement("input"),v.type="hidden",v.name=x.key,v.value=x.value,r.appendChild(v)}else n.src=v;u.appendChild(n);r&&(u.appendChild(r),r.submit());Sys.UI.DomElement.addCssClass(n,"DirectPrintPdfObjectHidden");e.a.sh(n,e.a.iC,e.a.lk)}}get n8e(){return"Print_32x32x32"}get WUd(){return m.jBa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get BNa(){return m.jBa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get DUc(){const v=[];Array.add(v,CommonUIStrings.l_PrintDialogCanCloseDocument);
if(b.a.H4a){let n=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==f.AFrameworkApplication.ta.Oa.IEe&&(n=f.AFrameworkApplication.ta.Oa.IEe);Array.add(v,n)}return m.jBa?v:null}get zic(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get yic(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get y3c(){return f.AFrameworkApplication.vGe?"UIFontDialogTextLarge":null}Zkf(){c.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}alf(){f.AFrameworkApplication.Bn.oxb(9540);
c.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}Psd(){c.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get jBa(){return!!f.AFrameworkApplication.ta&&f.AFrameworkApplication.ta.Oa.mv&&f.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")&&!(l.a.pz||l.a.fu||l.a.Tf||l.a.cMa)&&!f.AFrameworkApplication.isUnifiedHostMode&&f.AFrameworkApplication.fa.qa("ShouldHostDefaultToNativeBrowserPrintExperience")}static set jBa(v){}}Object(t.a)(m,
"PrintDialogWithLinkToPdf",b.a,[])},1349:function(t,C,a){t=a(0);var c=a(83),b=a(41);class d{constructor(){this.classId=0}static JHa(m){try{return b.a(m)}catch(v){}return null}}Object(t.a)(d,"ARoamingAppsResponse",null,[]);class f{constructor(){this.state=this.callback=null;this.Umd=!1}}Object(t.a)(f,"GetRoamingAppsLauncherContext",null,[]);var e=a(4),k=a(107);a.d(C,"a",function(){return l});class l{constructor(m){this.QEc=!1;this.FWa=l.wdc;this.GOc=this.HMc=0;this.platform=null;this.Iug=m;this.Rhe=
this.HOc=!1}get roamingAppsAreEnabled(){return this.Iug}get vUj(){return this.roamingAppsAreEnabled&&this.HOc?this.Rhe:!1}CWg(){e.AFrameworkApplication.Yfc&&this.roamingAppsAreEnabled&&!this.HOc&&!this.QEc&&(this.GOc=1,this.QEc=!0,this.Afj(),this.VPe())}Afj(){this.FWa=l.wdc;this.HMc=0}getRoamingAppsLauncher(m,v,n){this.vUj?(m=new f,m.callback=v,m.state=n,m.Umd=!0,this.$Pe(m)):v(!1,"",n)}VPe(){const m=new (a(1330).CheckRoamingRightsRequest);m.RoamingApp=this.GOc;m.BaseDocQuerySignature=e.AFrameworkApplication.ij;
m.execute(Object(c.a)(this,this.EWg,"checkUserRoamingRightsSucceeded"),Object(c.a)(this,this.DWg,"checkUserRoamingRightsFailed"),null)}EWg(m){e.AFrameworkApplication.Ng||((m=d.JHa(m.data.Vd))?this.IOd(m.HasRights):this.IOd(!1))}DWg(){if(!e.AFrameworkApplication.Ng)if(this.HMc>=l.Byi)this.IOd(!1);else{var m=new k.a(2,1,this.FWa,Object(c.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);e.AFrameworkApplication.zi.Ag(m);this.HMc++;this.FWa*=l.Wgj;this.FWa>l.Oof&&(this.FWa=l.Oof)}}IOd(m){this.Rhe=
m;this.HOc=!0;this.QEc=!1}retryCheckUserRoamingRights(){this.VPe()}$Pe(m){const v=new (a(1331).GetRoamingLauncherRequest);v.RoamingApp=this.GOc;v.BaseDocQuerySignature=e.AFrameworkApplication.ij;v.execute(Object(c.a)(this,this.oVh,"getRoamingAppsLauncherSucceeded"),Object(c.a)(this,this.nVh,"getRoamingAppsLauncherFailed"),m)}oVh(m){if(!e.AFrameworkApplication.Ng){var v=d.JHa(m.data.Vd);m=m.data.state;v?(this.platform=v.Platform,m.callback(!0,v.Launcher,m.state)):m.callback(!1,"",m.state)}}nVh(m){if(!e.AFrameworkApplication.Ng){var v=
m.data.state;5===m.data.status&&v.Umd?(v.Umd=!1,this.$Pe(v)):v.callback(!1,"",v.state)}}static get instance(){return l.aC||(l.aC=new l(e.AFrameworkApplication.LKg))}}l.wdc=1E3;l.Wgj=5;l.Oof=12E5;l.Byi=5;l.aC=null;Object(t.a)(l,"RoamingAppsManager",null,[])},1423:function(t,C,a){a.r(C);var c=a(1046),b=a(0),d=a(246);class f{get name(){return"Common.App.DialogWithLinkToResource"}Rh(){}init(){}dispose(){}static main(){d.a.instance.yi(new f)}}Object(b.a)(f,"CommonAppDialogWithLinkToResourcePackage",null,
[4,5]);var e=a(550),k=a(15),l=a(83),m=a(805),v=a(30),n=a(130);class w{static Qjh(vc){return w.Nte("New",vc)}static Rjh(vc){return w.Nte("Open",vc)}static yte(vc,ed){return w.Mga("LoadingMenuSection",w.ysi,vc,w.vob("lblLoading",ed))}static wob(vc,ed,Id=null,Ld=null){return w.Mga("MessageMenuSection",w.hqf,ed,w.vob("lblMessage",vc,Id,Ld))}static xQg(vc){return w.yte(vc,CommonUIStrings.l_VoicedLoadingText)}static yQg(vc,ed){return w.wob(CommonUIStrings.l_NewCreationLocationMessage,vc.mi,ed.fR,ed.yna)}static wQg(vc,
ed){return w.wob(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,ed.yna,"\n\n"),vc.mi)}static Ate(vc){return w.wob(CommonUIStrings.l_NewGenericErrorMessage,vc.mi)}static uQg(vc,ed,Id){return w.Mga("menuNewBlank",w.L4h,Id?vc.mi:null,w.rob(vc.u6e,vc.v6e,vc.w6e,null,vc.Fja,vc.bxb,ed,"blank"))}static tRg(){return w.vob("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static Kte(){return w.vob("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static uRg(vc,ed){return w.Mga("menuNewTemplates",
vc,null,ed)}static sQg(vc,ed){return w.Mga("menuNewMoreTemplates",w.lTe,null,w.rob("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,vc,ed))}static wPg(vc,ed,Id){let Ld="";Id&&ed&&(Ld=w.Mga("BrowseMoreMenuSection",w.lTe,null,w.rob("btnBrowseMore",ed,ed,null,null,null,vc||"1959943459",Id)));return Ld}static vob(vc,ed,Id=null,Ld=null){let ce=Ld;ed&&0<ed.length&&(ce=w.crf.Aoc(ed).trimEnd(),ce=0<=ce.indexOf("{0}")?String.format(ce,Ld):String.format("{0} {1}",
ce,Ld));Id=Id&&Ld?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',v.a.gf(Id),v.a.gf(Ld),v.a.gf(ce)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',v.a.gf(vc||""),w.crf.Aoc(v.a.gf(ed||"")),Id)}static rob(vc,ed,Id,Ld,ce,la,jb,ra){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
v.a.gf(vc||""),v.a.gf(ed||""),v.a.gf(Id||""),Ld||"32by32",v.a.gf(ce||""),v.a.gf(la||""),jb,v.a.gf(ra||""))}static Nte(vc,ed){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',vc,ed)}static Mga(vc,ed,Id,Ld){Id=Id?String.format('Title="{0}"',v.a.gf(Id)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
v.a.gf(vc||""),v.a.gf(ed||""),Id,Ld)}}w.hqf="MenuMru";w.ysi="MenuLoading";w.L4h="MenuHeader";w.lTe="MenuFooter";w.crf=n.a.zx("\n","&#10;");Object(b.a)(w,"NewAndOpenXmlUtilities",null,[]);var r=a(4),u=a(98),y=a(159);class x{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(b.a)(x,"HostInformation",null,[]);var B=a(107),z=a(39),A=a(370),I=a(163),F=a(640),U=a(574),X=a(106),S=a(25);class H{constructor(vc,ed,Id,Ld,ce,la){this.JQc=this.Ko=this.RPb=null;this.DVb=this.TPc=
!1;this.Y$d=0;this.HPc=this.aKc=!1;this.f1=vc;this.Dhb=ed;this.XCa=new e.a(()=>new m.a(Id.value,Object(l.a)(this,this.fvb,"getMoreInfoEventReceived")));this.ksg=Ld;this.iqa=ce;this.zvg=la;this.Rkb=this.mwc;2===this.DK.Pba&&(this.HPc=!0)}get gP(){switch(this.DK.Pba){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}Gg(){const vc=this.DK.F8a;vc.Ob(S.a.newDocument,X.a.frame,Object(l.a)(this,this.newDocument,"newDocument"));vc.Ie(S.a.Toc,X.a.frame,
Object(l.a)(this,this.Toc,"populateNewMenu"),96)}newDocument(vc,ed,Id,Ld,ce){return 1===Id?32:2===Id&&ce&&ce.MenuItemId&&ce.SourceControlId?this.h0a(ce.MenuItemId,ce.SourceControlId):8}h0a(vc,ed){var Id=this.Hkc.T2c;if(null===Id)return 8;var Ld=r.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(r.AFrameworkApplication.lba&&Ld){k.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const ce={};ce[A.a.o8f]=
vc;ce[A.a.gP]=this.gP;ce[A.a.lcid]=r.AFrameworkApplication.lcid.toString();ce[A.a.reason]=F.a.createNew;r.AFrameworkApplication.GU().execute(la=>{la.Fj(I.a.h0a,ce)})}else Ld=(new Date).getTime(),ed=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",Id,v.a.ff(this.Yka),v.a.ff(vc),v.a.ff(this.gP),v.a.ff(r.AFrameworkApplication.lcid.toString()),v.a.ff(Ld.toString()),v.a.ff(ed),v.a.ff(r.AFrameworkApplication.canary),r.AFrameworkApplication.ij),
(Id=r.AFrameworkApplication.fa.Va("ScenarioId"))&&""!==Id&&(ed+="&wdscenarioid="+v.a.ff(Id)),ed+="&"+r.AFrameworkApplication.Iac(),r.AFrameworkApplication.twa&&(ed+="&"+r.AFrameworkApplication.Y$b()),(Id=this.Ko?this.Ko.fR:null)&&(ed+="&DestinationUrl="+v.a.ff(Id)),z.a.Ve(ed,"_blank",void 0,"CreateNewDocument");2===this.DK.Pba&&k.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:U.a[this.DK.Pba],["Template"]:vc});return 32}Ivi(vc){let ed=Number.MAX_VALUE,Id=Number.MIN_VALUE;
const Ld=window.performance;if(Ld&&"undefined"!==typeof Ld.getEntriesByName){for(let la=0;la<vc.length;la++){var ce=Ld.getEntriesByName(vc[la]);ce&&0<ce.length&&(ce=ce[0],ed=Math.min(parseInt(String(ce.fetchStart)),ed),Id=Math.max(parseInt(String(ce.responseEnd)),Id))}Id>ed&&k.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:Id-ed,["MinFetchStart"]:ed,["MaxResponseEnd"]:Id})}}Toc(vc,ed,Id,Ld,ce){if(1===Id)return this.HPc&&(r.AFrameworkApplication.fN("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),
this.HPc=!1),32;2!==Id||this.aKc||(this.Y$d=(new Date).getTime(),k.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.mwc,["CachedNewMenuXmlExists"]:!!this.RPb,["ShouldCallGetMoreInfo"]:this.DK.supportsGetMoreInfoForPersonalStorage}));return this.uYi(ce)}uYi(vc){vc&&(this.RPb?vc.PopulationXML=this.RPb:(this.DK.supportsGetMoreInfoForPersonalStorage&&!this.Ko&&this.nCi.TY("Opened New menu",!0),vc.PopulationXML=this.ZFh(this.getTemplateListJson())));
return 32}iff(){return!this.DK.supportsGetMoreInfoForPersonalStorage||!!this.Ko&&3===this.Ko.state&&!!this.Ko.yna&&!!this.Ko.fR}uki(){return r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Oa.vZ?!0:this.iff()}getTemplateListJson(){if(!this.mwc||!this.uki())return null;if(this.Rkb&&!this.DVb){var vc="9";const ed=r.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in ed&&(vc=ed.NumberOfTemplatesInBackstage);let Id=this.gP;"TemplateCollectionId"in ed&&(Id=ed.TemplateCollectionId);
vc=String.format(this.DK.iV+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",v.a.ff(r.AFrameworkApplication.lcid.toString()),v.a.ff(Id),vc);Boolean.parse(ed.AppendOriginQueryParam||"false")&&(vc+="&org=backstage");vc+="&"+r.AFrameworkApplication.Iac();r.AFrameworkApplication.twa&&(vc+="&"+r.AFrameworkApplication.Y$b());this.DK.KCb.Bm(vc,1,null,null,!1,2,Ld=>{this.DK.Cba("CreateNewActor.GetTemplateListJson",Ld.data);this.QHj(Ld.data.Vd)},Ld=>{this.DK.Cba("CreateNewActor.GetTemplateListJson",
Ld.data);this.PHj()},null,void 0,void 0,void 0,void 0,"5");this.Rkb=!1}return this.JQc}QHj(vc){this.JQc=vc;this.Rkb=!1;this.XGb();if(r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Oa.vZ&&y.c()){vc=r.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const ed=r.AFrameworkApplication.lba;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.JQc,!0,vc&&ed))}}PHj(){this.DVb=this.Rkb=!0;this.XGb();r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Oa.vZ&&
y.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));u.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}iYh(vc){var ed=0;for(var Id=0;Id<vc.length;Id++)if("ST"===vc[Id].ImageType){ed=Id;break}const Ld=vc.length?vc[ed]:null;vc=Ld?Ld.Url||"":"";var ce;let la=Id=ed=!1;if(Ld&&(ce=Ld.AspectRatio))ce=parseFloat(ce),1>ce?ed=!0:1.5<ce?Id=!0:1===ce&&(la=!0);else switch(k.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",
{["Url"]:vc}),this.DK.Pba){case 3:ed=!0;break;case 2:Id=!0;break;case 5:la=!0}return{returnValue:vc,n7h:ed?"95by123":Id?"123by69":la?"100by100":"123by95"}}ZFh(vc){vc=({Qvc:ed}=this.vQg(vc,this.Hkc,this.Hkc.aGa||"1056925771")).returnValue;if(ed){this.RPb=vc;var ed=(new Date).getTime()-this.Y$d;k.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:ed})}return vc}fvb(vc,ed){k.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");
this.Ko||3!==vc.state?2===vc.state&&(k.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.TPc=!0,this.XGb()):(this.Ko=vc,ed||this.XGb(),r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Oa.vZ&&y.c()&&y.d("setFileMenuHostInformation")&&(vc=Object.assign(new x,{hostUrl:this.Ko.fR,hostName:this.Ko.yna,folderUrl:r.AFrameworkApplication.breadcrumbFolderUrl,folderName:r.AFrameworkApplication.breadcrumbFolderName}),k.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),
appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(vc))))}vQg(vc,ed,Id){let Ld;Ld=!1;const ce=this.iff();let la="";this.DK.supportsGetMoreInfoForPersonalStorage&&(this.TPc?(la=w.Ate(ed),this.TPc=!1,k.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Ko?ce?la=w.yQg(ed,this.Ko):this.Ko.Abi?(Ld=!0,this.Rkb=!1,la=w.wQg(ed,this.Ko),k.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):
(Ld=!0,la=w.Ate(ed),k.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Ko.fR,["StorageServiceDisplayNameIsSet"]:!!this.Ko.yna})):(la=w.xQg(ed.mi),k.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));ce&&(la+=w.uQg(ed,Id,!la)+({Qvc:Ld}=this.sRg(vc,Id)).returnValue);return{returnValue:w.Qjh(la),Qvc:Ld}}sRg(vc,ed){let Id;Id=!1;if(!this.mwc)return Id=!0,k.ULS.sendTraceTag(5849609,
202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Qvc:Id};let Ld="",ce="",la="MenuTemplate";if(this.DVb)Ld=w.Kte(),this.DVb=!1,k.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(vc){try{const jb=Sys.Serialization.JavaScriptSerializer.deserialize(vc,!0);Ld=this.rRg(jb,ed);k.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");r.AFrameworkApplication.drf&&"OneDrive"===this.Yka&&(ce=w.sQg(this.oCi,r.AFrameworkApplication.drf))}catch(jb){k.ULS.sendTraceTag(5849613,
202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:vc}),Ld=w.Kte()}Id=!0}else la="MenuLoading",Ld=w.tRg(),k.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:w.uRg(la,Ld)+ce,Qvc:Id}}rRg(vc,ed){let Id="";const Ld=[];for(let la=0;la<vc.length;la++){var ce=vc[la];let jb="";if(ce){const ra=ce.Title,hb=ce.AssetId;ce=ce.Thumbnails;hb&&ra&&ce&&({n7h:ce,returnValue:jb}=this.iYh(ce),Id+=w.rob("jbtnNewTemplate"+la,ra,null,
ce,null,jb,ed,hb))}Ld[la]=jb}vc=new B.a(4,1,5E3,()=>{this.Ivi(Ld)},106);this.DK.Fkc.Ag(vc);return Id}XGb(){this.aKc=!0;this.DK.Wqf.Qw(this.Hkc.ztb);this.aKc=!1}get DK(){return this.f1.value}get Hkc(){return this.Dhb.value}get nCi(){return this.XCa.value}get oCi(){return this.ksg.value}get Yka(){return this.iqa.value}get mwc(){return this.zvg.value}}Object(b.a)(H,"CreateNewActor",null,[]);var D=a(1326);class J extends D.a{constructor(){super()}lle(){this.$S(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);
this.$S(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.$S(2,CommonUIStrings.l_Open);this.$S(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.$S(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.$S(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return J.Ma||(J.Ma=new J)}static kUi(vc){return J.instance.ga(vc)}}J.Ma=null;Object(b.a)(J,"MruActorIntlHelper",D.a,[]);var M;(function(vc){vc[vc.success=0]="success";vc[vc.failure=1]="failure";vc[vc.spinner=2]="spinner";vc[vc.none=3]="none"})(M||
(M={}));Object(b.b)("DisplayState",M);var G=a(41);class T{constructor(vc,ed,Id,Ld,ce,la,jb,ra){this.yEc=null;this.IRc=!0;this.QPb="";this.gxg=0;this.RVa=null;this.VKc=3;this.nb=ra;this.f1=vc;this.hj=ed;this.kog=Id;this.plg=Ld;this.olg=ce;this.XCa=new e.a(()=>new m.a(la.value,null));this.Wog=new e.a(()=>new m.a(jb.value,Object(l.a)(this,this.UAi,"mruEventResultReceived")));this.nb.qa("WacInTabOpenMRUIsEnabledForUiHost");this.nb.qa("UiHostSupportsDocRebootFeatures")}UAi(vc,ed){this.RVa=vc;ed||this.XMf()}o8i(){this.yw.F8a.Ie(S.a.Soc,
X.a.frame,Object(l.a)(this,this.Soc,"populateMruMenu"),96)}Soc(vc,ed,Id,Ld,ce){return 1!==Id&&ce?this.rYi(ce):32}rYi(vc){this.ukh();this.tkh();vc.PopulationXML=w.Rjh(this.QPb+this.yEc);return 32}ukh(){var vc=3;let ed=!1;if(this.QPb&&this.gxg===this.RVa.BJj)k.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),vc=this.VKc;else{k.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});
var Id=this.yw.ew();this.RVa=this.TAi.TY("File Open opened",!0);this.QPb&&2!==this.VKc&&3!==this.RVa.state?ed=!0:(vc=this.YVh(this.RVa),r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Oa.vZ&&y.c()&&vc&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(vc,!0)),this.QPb=({fCi:vc}=this.$Fh(this.RVa)).returnValue);Id=this.yw.ew()-Id;k.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:Id})}2!==vc&&(Id={["DisplayState"]:M[vc]},
1!==vc&&(Id.IsStale=ed),k.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",Id));this.VKc=vc}YVh(vc){let ed;try{ed=G.c(vc.Wvd)}catch(Id){ed=null,k.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",Id)}return ed}tkh(){this.IRc?(k.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.yEc=({GWj:this.IRc}=this.bxi()).returnValue):k.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");
k.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.IRc,["NotDisplayingLink"]:!this.yEc})}$Fh(vc){let ed;1===vc.state||0===vc.state?(k.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),vc=2,ed=w.yte(this.mja(2),this.mja(5))):3===vc.state&&vc.Wvd?(ed=this.tQg(vc.Wvd),vc=0):(k.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),ed=w.wob(this.mja(1),this.mja(2)),vc=1);return{returnValue:ed,
fCi:vc}}tQg(vc){let ed;const Id=this.fCb.aGa||"2155708348";if(vc.length){ed=w.vob("lblRecentDocuments",this.mja(3));let Ld=0;for(let ce=0;ce<vc.length;ce++){const la=vc[ce];"FileName"in la&&"DocumentUrl"in la&&"Path"in la&&(ed+=w.rob("MruButton"+ce,la.FileName.toString(),la.Path.toString(),null,this.fCb.Fja,this.fCb.bxb,Id,la.DocumentUrl.toString()),la.IsPinned&&Ld++)}ed=w.Mga("RecentDocumentsMenuSection",w.hqf,this.mja(2),ed);k.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",
["TotalDocuments"]:vc.length,["NumPinnedDocuments"]:Ld})}else ed=w.wob(this.mja(0),this.mja(2)),k.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return ed}bxi(){let vc;vc=!0;let ed=this.POg;var Id=this.OOg;if(ed&&Id||!this.yw.supportsGetMoreInfoForPersonalStorage)vc=!1;else{const Ld=this.eac.TY("File Open",!1);3===Ld.state&&(ed=Ld.fR,Id=Ld.yna,vc=!1)}Id=Id?String.format(this.mja(4),Id):null;return{returnValue:w.wPg(this.fCb.aGa,Id,ed),GWj:vc}}XMf(){this.yw.Wqf.Qw(this.fCb.ztb)}get yw(){return this.f1.value}get mja(){return this.hj.value}get fCb(){return this.kog.value}get POg(){return this.plg.value}get OOg(){return this.olg.value}get eac(){return this.XCa.value}get TAi(){return this.Wog.value}}
Object(b.a)(T,"MruRenderer",null,[]);var K=a(237),L=a(762);class V{constructor(vc,ed,Id,Ld,ce,la,jb){this.Ko=null;this.Oee=!1;this.wpa=this.L1d=0;this.rsg=vc;this.hWa=ed;this.wTb=Id;this.Dhb=Ld;this.iqa=ce;this.f1=la;this.XCa=new e.a(()=>new m.a(jb.value,Object(l.a)(this,this.fvb,"getMoreInfoEventReceived")))}h0a(){!this.Ko&&this.Ewd.supportsGetMoreInfoForPersonalStorage?this.eac.TY("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}fvb(vc){if(!this.Ko&&3===vc.state)this.Ko=vc;else if(2===
vc.state){this.Oee?k.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.eac.TY("NewDocumentFromStream",!0),this.Oee=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.L1d=(new Date).getTime();var vc=this.tyh.T2c;if(null===vc)this.hWa(null);else{var ed=this.wTb.menuItemId,Id=this.wTb.bG,Ld=this.wTb.BFj,ce=this.wTb.yyh;this.wpa="streamBase64"===Ld?ce.length/1024:0;k.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.gP,
this.wpa);var la=(new Date).getTime();vc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",vc,v.a.ff(this.Yka),v.a.ff(ed),v.a.ff(this.gP),v.a.ff(r.AFrameworkApplication.lcid.toString()),v.a.ff(la.toString()),v.a.ff(Id),v.a.ff(r.AFrameworkApplication.canary),r.AFrameworkApplication.ij,v.a.ff(Ld));vc+="&"+r.AFrameworkApplication.Iac();r.AFrameworkApplication.twa&&(vc+="&"+r.AFrameworkApplication.Y$b());(ed=this.Ko?this.Ko.fR:null)&&
(vc+="&DestinationUrl="+v.a.ff(ed));this.Ewd.KCb.Bm(vc,2,ce,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(l.a)(this,this.iCi,"newDocumentFromStreamSuccessHandler"),Object(l.a)(this,this.hCi,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}iCi(vc){if(vc&&vc.data&&vc.data.Vd)if(({Ut:ed}=G.d(vc.data.Vd)).returnValue)if(vc=ed,vc.StatusCode!==K.a.FO&&vc.StatusCode!==K.a.Sqb)k.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",
this.gP,this.wpa,vc.StatusCode),this.hWa(null);else if(vc.NewDocumentUrl&&""!==vc.NewDocumentUrl){var ed=(new Date).getTime()-this.L1d;k.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.gP,this.wpa,ed);this.rsg(vc.NewDocumentUrl)}else k.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.gP,this.wpa),this.hWa(null);else k.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",
this.gP,this.wpa,{["ResponseData"]:L.a.qeb(vc.data.Vd)}),this.hWa(null);else k.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.gP,this.wpa),this.hWa(null)}hCi(vc){vc&&vc.data&&k.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.gP,this.wpa,vc.data.status);this.hWa(null)}get gP(){switch(this.Ewd.Pba){case 3:return"WordWAC";case 1:return"ExcelWAC";
case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get tyh(){return this.Dhb.value}get Yka(){return this.iqa.value}get Ewd(){return this.f1.value}get eac(){return this.XCa.value}}Object(b.a)(V,"NewDocumentFromStreamOperation",null,[]);class W{constructor(vc,ed,Id,Ld){this.Dhb=vc;this.iqa=ed;this.f1=Id;this.Vog=Ld}create(vc,ed,Id){return new V(vc,ed,Id,this.Dhb,this.iqa,this.f1,this.Vog)}}Object(b.a)(W,"NewDocumentFromStreamOperationFactory",null,[569]);var da=a(82),qa=a(516),O=a(55);
class ea{get name(){return"Common.App.NewAndOpen.UX"}Rh(vc){vc.register(W,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").tc().Fc(()=>new W(new e.a(()=>r.AFrameworkApplication.ta.Oa.Vcd()),new e.a(()=>r.AFrameworkApplication.Yka),new e.a(()=>vc.vh("Common.INewAndOpenCommonHelpers")),new e.a(()=>vc.vh("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){r.AFrameworkApplication.fa.gv(()=>{this.rxb()})}rxb(){const vc=
qa.a.Uq(da.a.instance.Wb("Common.INewAndOpenCommonHelpers")),ed=qa.a.Uq(da.a.instance.Wb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));r.AFrameworkApplication.Yka&&O.Task.WAA.call(null,vc,ed).continueWith(()=>{const Id=new H(new e.a(()=>vc.result),new e.a(()=>r.AFrameworkApplication.ta.Oa.Vcd()),new e.a(()=>ed.result),new e.a(()=>r.AFrameworkApplication.ta.Oa.Wcd().aGa||"1959943459"),new e.a(()=>r.AFrameworkApplication.Yka),new e.a(()=>r.AFrameworkApplication.Zii));Id.Gg();Id.XGb()});if(r.AFrameworkApplication.xLf){const Id=
qa.a.Uq(da.a.instance.Wb("Common.IEventEmitter<Common.IMruResult>"));O.Task.WAA.call(null,vc,ed,Id).continueWith(()=>{const Ld=new T(new e.a(()=>vc.result),new e.a(()=>J.kUi),new e.a(()=>r.AFrameworkApplication.ta.Oa.Wcd()),new e.a(()=>r.AFrameworkApplication.jUi),new e.a(()=>r.AFrameworkApplication.iUi),new e.a(()=>ed.result),new e.a(()=>Id.result),r.AFrameworkApplication.fa);Ld.o8i();Ld.XMf()})}}dispose(){}}Object(b.a)(ea,"UXPackageManager",null,[4,5,2]);var R=a(1169),oa=a(1177),pa=a(1151),Pa=a(1187),
Z=a(1178),Ra;(function(vc){vc[vc.myFiles=0]="myFiles";vc[vc.recent=1]="recent";vc[vc.currentFolder=2]="currentFolder";vc[vc.yourPhone=3]="yourPhone"})(Ra||(Ra={}));Object(b.b)("SharedFilePickerLandingLocation",Ra);class Ga{constructor(vc){this.NKa=this.T$a=null;this._initialized=!1;this.Sid=vc}A1a(vc){this._initialized||(vc.eo(I.a.cMf),vc.Tl(I.a.cMf,Object(l.a)(this,this.vPi,"onReceivedPickerResponse")),this._initialized=!0)}Xcd(vc){return this.NKa=new Promise((ed,Id)=>{const Ld={};Ld[A.a.fXi]=vc;
this.T$a=(ce,la)=>{""===la?(k.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),ed(ce)):("Canceled"===la?k.ULS.sendTraceTag(572548164,306,50,la):k.ULS.sendTraceTag(556901065,306,10,la),Id(la))};this.Sid.execute(ce=>{this.A1a(ce);ce.Fj(I.a.oUi,Ld)})})}vPi(vc){this.T$a(vc.Values[A.a.slj],void 0===vc.Values[A.a.CCd]||null===vc.Values[A.a.CCd]?"":vc.Values[A.a.CCd])}wpd(){return r.AFrameworkApplication.fa.qa("UiHostCommonFilePicker")}ECe(vc,ed,Id,Ld,ce,la,jb){const ra={};ra[A.a.elj]=
vc;ra[A.a.titleText]=ed;ra[A.a.zIg]=Id;ra[A.a.AIg]=Ld;ra[A.a.BIg]=!1;ra[A.a.vfh]=!0;ra[A.a.Fyh]=ce;ra[A.a.jXi]=la;ra[A.a.iXi]=Ra[jb];y.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(ra[A.a.kXi]="Dark");return ra}}Object(b.a)(Ga,"SharedFilePickerManager",null,[311]);class Ba{constructor(){this.fb=null}get name(){return"Common.App.SharedFilePicker"}Rh(vc){this.fb=vc;vc.register(Ga,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").tc().Fc(()=>
new Ga(vc.Wb("Postmessage.IHostPostmessenger")))}init(){r.AFrameworkApplication.fa.gv(()=>{this.rxb()})}rxb(){this.fb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){d.a.instance.yi(new Ba)}}Object(b.a)(Ba,"SharedFilePickerPackage",null,[4,5]);var fa=a(1278),Y=a(832),ja=a(27);class ca{get name(){return"Common.App.WildFire"}Uje(vc){let ed=!1;vc&&(vc.g2c(),vc.LRg&&(ed=!1));return ed}w4g(){var vc=r.AFrameworkApplication.ta.Oa;vc=new fa.a(vc.xj,Y.a.gbc(),!1,1===vc.o5);
this.Uje(vc)&&k.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}E3b(vc,ed,Id,Ld,ce,la){vc=new fa.a(vc,Id,Ld,ed,ce,la);this.Uje(vc)&&k.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}B$g(){const vc=r.AFrameworkApplication.ta.Oa;var ed=r.AFrameworkApplication.fa;const Id=vc.xj,Ld=1===vc.o5;if(ed.qa(Y.a.TZh(Id))){var ce=Y.a.gbc(),la=8<ja.a.P4a;if(2!==Id||2!==ce||!Ld){ed=ed.qa(Y.a.UZh(Id));var jb=vc.JUf(),ra=()=>vc.vx;ed&&!Y.a.Mnd(Y.a.Mbd(Id))&&this.E3b(Id,Ld,ce,la,ra,jb)}}}init(){var vc=
r.AFrameworkApplication.fa;const ed=vc.qa("WildFireChromeExtensionEnabled");vc=vc.qa("WildFireChromeExtensionBar")&&ed;Y.a.owc&&vc&&!Y.a.Mnd(Y.a.hxe)?this.w4g():(document.body&&Y.a.Gxj&&this.B$g(),r.AFrameworkApplication.wb.Ob(S.a.Urd,X.a.frame,Object(l.a)(this,this.Urd,"launchWildFireBusinessBar")))}Urd(vc,ed,Id,Ld,ce){if(1===Id)return 32;if(!ce)return 8;this.E3b(ce.app,ce.mode,ce.platform,ce.useTwoButton,null,null);return 32}dispose(){}Rh(){}static main(){d.a.instance.yi(new ca)}}Object(b.a)(ca,
"PackageManager",null,[4,5]);var aa=a(1267);a(1059);var ta=a(10),xa=a(691),ia=a(50),ya=a(37),ib=a(182);class wa{constructor(vc){this.ai=vc}Nc(){return!1}executeCommand(vc,ed,Id){return 2!==this.ai.de(S.a.newDocument,2,Id)?O.Task.Ta(!0):ib.a(ed.command)}Cc(vc,ed){return 1056925771===ed.command}Rc(vc,ed,Id){vc=!0;switch(ed){case "PopulateNewMenu":this.ai&&this.ai.de(S.a.Toc,2,Id);break;default:vc=!1}return vc}}Object(b.a)(wa,"CreateNewCommandHandler",null,[195]);class sa extends xa.a{constructor(vc){super(vc)}yd(){const vc=
ia.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),ed=ia.GetServiceTaskFactory.create(this.$.da,165,this.la,this.hb);ya.TaskExtensions.Aa(ya.TaskExtensions.Wd([vc,ed],this.la),()=>{this.gd([new wa(r.AFrameworkApplication.wb)])},this.la,3)}static ka(vc){xa.a.Nd(87,new sa(vc))}}Object(b.a)(sa,"CreateNewCommandHandlerFactory",xa.a,[]);var Ya=a(1163),bb=a(1061),mb=a(1205),Ca=a(508),$a=a(102),Kb=a(170),rb=a(11),cc=a(22),nc=a(280),Wb=a(990);class Ea{}Ea.create="Create";Ea.activate="Activate";
Ea.close="Close";Ea.remove="Delete";Ea.duplicate="Duplicate";Object(b.a)(Ea,"Actions",null,[]);var ua=a(29),ma=a(42);class fb extends O.Task{constructor(vc){super();this.k_d=null;this.m_d=0;this.GPb=null;this._state=0;this.moveNext=()=>{try{for(this._state=1;1===this._state;)this.iWa=this.iWa()}catch(ed){this.dispose(),this.Yza(ed),this._state=3}};this.Dt=vc;this.iWa=this.wCc;this.moveNext()}wCc(){this.k_d=ua.a.Yc(3,2,0,1668,0,-1244327602,"MsFormDeleteConfirmation");this.GPb=ma.a(this.Dt.$).oj(this.k_d).G();
this.GPb.isCompleted||(this._state=2,this.GPb.b9a(this.moveNext));return this.Wgg}Wgg(){this.m_d=this.GPb.TY();0===this.m_d&&(this.Dt.$.workbookContext.Options=rb.HelperMethods.dO(!1,this.Dt.$.workbookContext.Options,2048),this.Dt.deleteMsFormMetaDataSheet());this._state=3;this.VJb(!0)}dispose(){}}Object(b.a)(fb,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",O.Task,[2]);class sb{}sb.action="Action";sb.RAh="FlexPane";sb.d9b="formId";sb.id="id";sb.title="Title";
sb.SOb="XlWorkbookId";sb.MCh="Fragment";sb.host="Host";sb.CKj="TopView";sb.w1="auth_pvr";Object(b.a)(sb,"Parameters",null,[]);var Ua=a(61);const ab=(vc,ed,Id,Ld,ce,la,jb=null)=>{jb=vc.Na(9,jb);jb.sheetName=ed;jb.confirmationChoice=!0;return Ua.g(vc,"DeleteSheet",jb,Id,Ld,ce,la,0)};class na{constructor(vc){this.oo="Excel";this.$=vc;this.vU=Wb.a.current}get hasMsForm(){return $a.c(this.$.pg)}get tkc(){return this.$.workbookContext.MsFormId}get POb(){return this.$.workbookContext.MsFormDocUrl}get w1(){return cc.a.contains(this.$.Qv.DocumentHostInfo.FileSource,
"onedrive",!0)?"MSA":"OrgId"}Nc(vc,ed){switch(ed){case -105284469:return!$a.i(this.$.pg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1}executeCommand(vc,ed){vc=ya.TaskExtensions.fk();ed=ed.command;switch(ed){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:vc=this.deleteMsForm();break;default:vc=ib.a(ed)}return vc}Cc(vc,
ed){if(!this.$.ea.Tg.get(61))return!1;vc=!1;switch(ed.command){case -105284469:vc=$a.i(this.$.pg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:vc=this.hasMsForm}return vc}Rc(){return!1}insertMsForm(){const vc=v.a.uq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),ed={},Id={};ed[sb.action]=Ea.create;ed[sb.w1]=this.w1;Id[sb.action]=Ea.create;Id[sb.SOb]=encodeURIComponent(this.POb);Id[sb.host]=this.oo;Id[sb.title]=encodeURIComponent(vc);this.YBb(ed,
Id);this.$.workbookContext.Options=rb.HelperMethods.dO(!1,this.$.workbookContext.Options,2048)}editMsForm(){const vc={},ed={};vc[sb.w1]=this.w1;ed[sb.d9b]=this.tkc;ed[sb.SOb]=encodeURIComponent(this.POb);ed[sb.host]=this.oo;this.YBb(vc,ed)}previewMsForm(){const vc={},ed={};vc[sb.w1]=this.w1;ed[sb.d9b]=this.tkc;ed[sb.SOb]=encodeURIComponent(this.POb);ed[sb.host]=this.oo;ed[sb.CKj]="Preview";this.YBb(vc,ed)}sendMsForm(){const vc={},ed={};vc[sb.w1]=this.w1;ed[sb.d9b]=this.tkc;ed[sb.RAh]="SendForm";ed[sb.SOb]=
encodeURIComponent(this.POb);ed[sb.host]=this.oo;this.YBb(vc,ed)}deleteMsForm(){return new fb(this)}deleteMsFormMetaDataSheet(){this.$.userOperationManager.Yt(new Kb.a(158,0,(vc,ed,Id)=>ab(this.$.oa.uw,this.vU.Etb,nc.b(vc,()=>{this.Lch()}),ed,Id,null)))}Lch(){const vc={},ed={};vc[sb.action]=Ea.remove;vc[sb.w1]=this.w1;ed[sb.action]=Ea.remove;ed[sb.host]=this.oo;ed[sb.d9b]=encodeURIComponent(this.tkc);ed[sb.SOb]=encodeURIComponent(this.POb);this.YBb(vc,ed)}YBb(vc,ed){const Id=this.$.ya.MsFormBaseUrl+
"/Pages/DesignPage.aspx";let Ld="";var ce="";if(ed){for(let ra in ed){var la=ra,jb=ed[ra];ce+=ce.length?"&":"";ce+=la+"="+jb}vc||(vc={});vc[sb.MCh]=encodeURIComponent(ce)}if(vc)for(let ra in vc)ed=ra,ce=vc[ra],Ld+=Ld.length?"&":"?",Ld+=ed+"="+ce;window.open(Id+Ld,"_blank")}}Object(b.a)(na,"MsFormCommandHandler",null,[195]);class Na extends xa.a{constructor(vc){super(vc)}yd(){const vc=ia.GetServiceTaskFactory.create(this.$.da,203,this.la,this.hb);ya.TaskExtensions.Aa(ya.TaskExtensions.Wd([vc],this.la),
()=>{this.gd([new na(this.$)])},this.la,3)}static ka(vc){vc.ea.Tg.get(61)&&xa.a.Nd(215,new Na(vc))}}Object(b.a)(Na,"MsFormCommandHandlerFactory",xa.a,[]);var Va=a(221);class Sa extends Va.a{constructor(vc){super();this.$=vc;this.Fb()}create(){ya.TaskExtensions.Aa(ia.GetServiceTaskFactory.create(this.$.da,164,this.la,this.hb),()=>{this.qb(new ea)},this.la,3)}}Object(b.a)(Sa,"NewAndOpenUXFactory",Va.a,[]);class vb{constructor(vc,ed){this.ai=ed;this.$=vc}executeCommand(vc,ed,Id){vc=2;switch(ed.command){case S.a.openUrlInNewTab:vc=
this.ai.de(S.a.openUrlInNewTab,2,Id);break;case S.a.zOa:vc=this.ai.de(S.a.zOa,2,Id)}return 2!==vc?O.Task.Ta(!0):ib.a(ed.command)}Cc(vc,ed){return ed.command===S.a.openUrlInNewTab||ed.command===S.a.zOa}Rc(vc,ed,Id){return"PopulateMruMenu"===ed?(this.ai.de(S.a.Soc,2,Id),!0):!1}Nc(){return!1}}Object(b.a)(vb,"OpenFromMruCommandHandler",null,[195]);class Oa extends xa.a{constructor(vc){super(vc)}yd(){const vc=ia.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),ed=ia.GetServiceTaskFactory.create(this.$.da,
165,this.la,this.hb);ya.TaskExtensions.Aa(ya.TaskExtensions.Wd([vc,ed],this.la),()=>{this.gd([new vb(this.$,r.AFrameworkApplication.wb)])},this.la,3)}static ka(vc){xa.a.Nd(88,new Oa(vc))}}Object(b.a)(Oa,"OpenFromMruCommandHandlerFactory",xa.a,[]);var yb=a(1141),Ob=a(1179),Ja=a(1217),lb=a(1064),Pb=a(1159),Jb=a(1065),Lb=a(1066),Ab=a(1164),nb=a(1206),va=a(1207),db=a(84),Xa=a(368),gb=a(100),Ha=a(21),tb=a(369);class bc{constructor(vc,ed){this.sheetName=null;this.value=!1;this.sheetName=vc;this.value=ed}getSheetName(){return this.sheetName}eva(){return this.value}}
Object(b.a)(bc,"MacroRecorderSheetOptionToggledPayload",null,[101]);const tc=(vc,ed,Id,Ld,ce,la,jb,ra=null)=>{ra=vc.Na(9,ra);ra.sheetName=ed;ra.show=Id;return Ua.g(vc,"ShowGridlines",ra,Ld,ce,la,jb,0)},Ma=(vc,ed,Id,Ld,ce,la,jb,ra=null)=>{ra=vc.Na(9,ra);ra.sheetName=ed;ra.show=Id;return Ua.g(vc,"ShowHeadings",ra,Ld,ce,la,jb,0)},Tb=(vc,ed,Id,Ld,ce,la,jb,ra=null)=>{ra=vc.Na(9,ra);ra.sheetName=ed;ra.directionRtl=Id;return Ua.g(vc,"ChangeSheetDirection",ra,Ld,ce,la,jb,0)};class zb{constructor(vc){this.$=
vc}Nc(){return!1}executeCommand(vc,ed){const Id={};this.$.Xj(Id);vc=ed.command;const Ld=Object(db.a)(gb.a,this.$.xa.getItemByName(Id.SheetName));if(!Ld)return ib.a(vc);let ce,la,jb,ra,hb;switch(vc){case 705559150:case -1411193626:ce=16;la=!Ld.hideGridLines;jb=tc;hb=183;ra=Ld.hideGridLines;break;case -2052321504:case 515737500:ce=4;la=!Ld.headersVisible;jb=Ma;hb=184;ra=!Ld.headersVisible;break;case -1478455630:ce=2;la=!Ld.displayRtl;jb=Tb;hb=185;ra=!Ld.displayRtl;Ha.g(this.$).Ea.$Pj(la);break;default:return ib.a(vc)}Ld.gpb(ce,
la);const Eb=()=>new bc(Id.SheetName,ra),fc=this.$.oa.va;return Xa.a(this.$.userOperationManager,(Mc,xd,Hd)=>jb(fc,Id.SheetName,ra,nc.b(Mc,Md=>{zb.DEb(Md,Ld,ce,la)}),nc.a(xd,()=>{zb.ODb(Ld,ce,la)}),Hd,null),Mc=>new Kb.a(hb,0,Mc,void 0,Eb),ed)}Cc(vc,ed){vc=!1;switch(ed.command){case -1411193626:case 515737500:case -1478455630:vc=!0;break;case 705559150:case -2052321504:vc=tb.a(this.$)}return vc}Rc(){return!1}static DEb(vc,ed,Id,Ld){ua.a.er(vc.Errors)&&ed.gpb(Id,!Ld)}static ODb(vc,ed,Id){vc.gpb(ed,
!Id)}}Object(b.a)(zb,"SheetOptionsToggleCommandHandler",null,[195]);class ic extends xa.a{constructor(vc){super(vc)}yd(){this.gd([new zb(this.$)])}static ka(vc){xa.a.Nd(100,new ic(vc))}}Object(b.a)(ic,"SheetOptionsToggleCommandHandlerFactory",xa.a,[]);var Qb=a(172),wb=a(177),hc=a(147),Za=a(65),ub=a(59),uc=a(208),Oc=a(583),Bb=a(90),Nb=a(1),dc=a(249),sc=a(210),yc=a(12);class cd extends sc.a{constructor(vc,ed,Id,Ld=null){super(vc,Id,2,Ld);this.CIc=null;this.onResize=()=>{const ce=this.dPh();this.PKa.setAttribute("width",
ce.x.toString());this.PKa.setAttribute("height",ce.y.toString());this.MQj(ce);this.Czd()};this.FFe=ed;this.$.EA(this.onResize);this.tcc()}get PKa(){return this.CIc}initialize(){let vc;const ed=this.$.Bb+"iframeDialog_frame",Id=this.$.Bb+"iframeDialog";vc=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',ed,this.kYe(Id));this.Lb.style.margin=rb.HelperMethods.pc(0);this.Lb.style.marginBottom=rb.HelperMethods.pc(-2);this.Lb.innerHTML=vc;this.CIc=document.getElementById(ed);
this.domElement.id=Id;this.onResize(null,Sys.EventArgs.Empty);super.initialize()}dispose(){this.$&&this.$.zD(this.onResize);super.dispose()}setFocus(){yc.DOMElementExtensions.setFocus(this.PKa)}onHide(){this.PKa.contentWindow.close();yc.DOMElementExtensions.pf(this.PKa);this.CIc=null;super.onHide()}MQj(vc){const ed=this.domElement.style;ed.width=rb.HelperMethods.pc(vc.x);ed.marginLeft=rb.HelperMethods.pc(-vc.x/2)}dPh(){const vc=yc.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*
vc.width),this.FFe.x),Math.min(Math.floor(.9*vc.height),this.FFe.y))}}Object(b.a)(cd,"IFrameDialog",sc.a,[]);var pd=a(5),Rb=a(74),Dc=a(14);class nd extends cd{constructor(vc){super(vc,new Sys.UI.Point(960,680),Dc.a.instance.ga(1266));this.name=pd.a.zJe}get oc(){return"EmbeddingDialog"}kYe(vc){const ed=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);uc.a.Zg(ed,pd.a.Dmh,vc);Rb.a(this.$.ya,34)&&uc.a.Zg(ed,pd.a.CLe,"1");Rb.a(this.$.ya,35)&&uc.a.Zg(ed,pd.a.DLe,"1");return ed.toString()}onShow(){k.ULS.sendTraceTag(537151690,
0,50,"EmbeddingDialog.OnShow: the dialog is being shown");super.onShow()}}Object(b.a)(nd,"EmbeddingDialog",cd,[]);var od=a(1232),wd=a(86),Pc=a(80),Hb=a(816);class Nc{}Nc.t0f="FrameDialog_ShareFromEdit";Nc.view="FrameDialog_View";Nc.nye="FrameDialog_CloseAndRefresh";Nc.yuj="FrameDialog_ShareFromView";Nc.edit="FrameDialog_Edit";Nc.z6i="FrameDialog_RefreshGrid";Nc.GYg="FrameDialog_CloseMe";Nc.xye="FrameDialog_CloseMeError";Nc.ready="FrameDialog_Ready";Nc.MXi="FrameDialog_PleaseClose";Nc.eK="GotoRange";
Object(b.a)(Nc,"PostMessageConstants",null,[]);var Db=a(513),Cc=a(247),Xc=a(121),ld=a(281),Dd=a(97);class Od{constructor(){this.eK=null;this.fDd=1461300262}}Object(b.a)(Od,"SessionUpdateContext",null,[]);class Qd extends cd{constructor(vc,ed,Id){super(vc,new Sys.UI.Point(Qd.kch,Qd.Nbh),Dc.a.instance.ga(ed?1271:1270));this.o0a=null;this.RJc=!1;this.Anc=Ld=>{const ce=this.$,la=new Od;la.eK=Ld.Values[Nc.eK];let jb=!1;switch(Ld.MessageId){case Nc.t0f:this.Pu();jb=!0;la.fDd=1334518759;break;case Nc.view:this.Kna=
Dc.a.instance.ga(1271);this.Cdg(!0);break;case Nc.nye:this.Pu(),jb=!0}Ld=(ra,hb,Eb)=>Cc.m(ce.oa.va,nc.b(ra,this.KQi),hb,Eb,la);Nb.EwaSettings.dc()?(Ld=new Kb.a(140,0,Ld),Ld.flags=jb?16:80):(Ld=jb?new Kb.a(140,0,Ld):new Db.a(140,0,Ld),Ld.flags=16);ce.userOperationManager.Ub(Ld,this.Jd)};this.GIi=()=>{const Ld=this.$;Ld.ya.SurveyRedirectUrl?(this.Pu(),Ld.ud(1305810481,0,8,null)):(this.Kna=Dc.a.instance.ga(1270),this.Cdg(!1))};this.YQi=()=>{const Ld=this.$;this.Pu();Ld.ud(1334518759,0,8,null)};this.Hlc=
Ld=>{const ce=this.$;this.Pu();Ld.MessageId===Nc.xye&&ce.ea.vad()};this.rPi=()=>{this.RJc=!0;this.raiseEvent(Qd.csd)};this.KQi=(Ld,ce)=>{if(!ld.a(Ld)){Ld=this.$;if(ce.eK){const la=Ld.ea.xa;if(la.contains(ce.eK.SheetName))this.rmc(ce);else{let jb=null;jb=()=>{la.pma(jb);this.rmc(ce)};la.lga(jb)}}1461300262!==ce.fDd&&Ld.ud(ce.fDd,0,8,null)}};this.E8d=ed;this.Jd=Id}dFg(vc){this.addHandler(Qd.csd,vc)}fbj(vc){this.removeHandler(Qd.csd,vc)}get oc(){return"FormDialog"}get Idf(){return this.RJc}get t6a(){return this.E8d}dispose(){wd.a.Ia(this.o0a);
this.o0a=null;super.dispose()}initialize(){super.initialize();const vc=Pc.a.naa(this.$.ya.FormLightBoxUrl),ed=this.o0a=new od.a(this.PKa.contentWindow,vc);ed.isEnabled()&&ed.$Ea(vc)&&(this.hma(Nc.t0f,this.Anc),this.hma(Nc.view,this.Anc),this.hma(Nc.nye,this.Anc),this.hma(Nc.yuj,this.YQi),this.hma(Nc.edit,this.GIi),this.hma(Nc.z6i,this.Anc),this.hma(Nc.ready,this.rPi),this.hma(Nc.GYg,this.Hlc),this.hma(Nc.xye,this.Hlc))}close(vc){vc===this.lM&&this.Idf&&this.o0a.send(new Hb.a(Nc.MXi))||super.close(vc)}kYe(){return this.CCe(this.t6a)}CCe(vc){const ed=
this.$.ya,Id=new Sys.StringBuilder(ed.FormLightBoxUrl);uc.a.Zg(Id,pd.a.vCh,this.$.ea.sessionId);uc.a.Zg(Id,pd.a.tCh,vc?pd.a.uCh:pd.a.sCh);Xc.a.JYa(Id,ed);return Id.toString()}Cdg(vc){this.RJc=!1;this.PKa.src=this.CCe(vc);this.E8d=vc}hma(vc,ed){this.o0a.eo(vc);this.o0a.Tl(vc,ed)}rmc(vc){const ed=this.$.ea.xa.getItemByName(vc.eK.SheetName);ed&&0===ed.Wz&&Ha.g(this.$).Dg(vc.eK,null,null,null,20,Dd.a.eCh)}}Qd.kch=900;Qd.Nbh=1200;Qd.csd="lightBoxReady";Object(b.a)(Qd,"FormDialog",cd,[229]);var Nd;(function(vc){vc[vc.comment=
10]="comment";vc[vc.range=12]="range";vc[vc.table=13]="table";vc[vc.chart=14]="chart";vc[vc.sheet=15]="sheet"})(Nd||(Nd={}));Object(b.b)("NavigationType",Nd);var he=a(865),ve=a(117),Td=a(19),ke=a(556),xe=a(941),le=a(283),Je=a(731),Fe=a(54);class eb extends Je.a{constructor(vc,ed,Id,Ld,ce,la=0){super(vc,Dc.a.instance.ga(ed),!1);this.message=Id;this.IEi=Ld;this.AZd=ce;this.operationFlags=la}get oc(){return"WebMethodConfirmationDialog"}get Rw(){return 1005}get LGa(){return this.operationFlags}initialize(){let vc=
"<div class='"+ve.a.Mn+"'>\r\n\t<div class='"+ve.a.QLe+"'>\r\n\t\t<div class='"+Td.a.eye+"'>\r\n\t\t\t<img src='{0}' class='"+Td.a.KOe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+ve.a.TLe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";vc=String.format(vc,Fe.a.hf(13),Dc.a.instance.ga(25),Dc.a.instance.ga(this.message));this.Lb.innerHTML=vc;this.addButton(0,this.IEi);this.addButton(1);super.initialize()}KA(){return this.AZd}}Object(b.a)(eb,"WebMethodConfirmationDialog",Je.a,[]);class Xb extends he.a{constructor(vc){super(vc,
Dc.a.instance.ga(1273));this.hTa=this.HQa=this.textBox=null;this.sDf=()=>{const ed=this.$;this.Pu();const Id=new eb(ed,1276,1277,1278,(Ld,ce,la)=>{var jb=ed.oa.va.Sb(),ra=ed.oa.va;jb=ra.Na(1,jb);return Ua.g(ra,"UnshareForm",jb,Ld,ce,la,null,0)},16);Id.initialize();Id.Ff()}}get oc(){return"ShareFormDialog"}dispose(){this.hTa&&this.hTa.Nca(this.sDf);wd.a.qc([this.textBox,this.HQa,this.hTa]);this.hTa=this.HQa=this.textBox=null;super.dispose()}initialize(){let vc="<div class='"+ve.a.Mn+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+
ve.a.N1a+"'>\r\n\t<input type='text' id='{1}' class='"+ve.a.VE+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";vc=String.format(vc,Dc.a.instance.ga(1274),"sfd_input","sfd_unshare",Td.a.Np,Dc.a.instance.ga(1275));this.Lb.innerHTML=vc;this.textBox=new le.a(this.getElementById("sfd_input"));this.HQa=new xe.a(this.textBox.domElement);this.hTa=ke.a.create(this.getElementById("sfd_unshare"));this.hTa.J1(this.sDf);this.textBox.text=Dc.a.instance.ga(741);
this.textBox.enabled=!1;this.textBox.readOnly=!ja.a.Ug;this.addButton(1,10);super.initialize()}Kga(){return(vc,ed,Id)=>{var Ld=this.$.oa.va.Sb(),ce=this.$.oa.va;vc=this.Pia(vc);ed=this.baa(ed);Ld=ce.Na(1,Ld);return Ua.g(ce,"ShareForm",Ld,vc,ed,Id,null,0)}}dy(vc,ed,Id){this.textBox.text=vc.Result;this.textBox.enabled=!0;yc.DOMElementExtensions.setVisible(this.hTa.domElement,!0);super.dy(vc,ed,Id)}setFocus(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();return}catch(vc){}super.setFocus()}}
Object(b.a)(Xb,"ShareFormDialog",he.a,[]);var oc=a(244),Gc=a(6),Vc=a(81),P=a(252),Ta=a(68),pb=a(619),Yb=a(139),Ac=a(420),Zc=a(171),id=a(254),gd=a(17),Ub=a(251);class Lc extends wb.a{constructor(vc,ed,Id){super();this.Wue=this.Xue=!1;this.aGi=()=>{this.Xue=!0;this.t2f()};this.$=vc;this.Sa=ed;this.$J=Id;Ta.a(this.$).NGd(new Yb.a(Gc.a.Cbg,Gc.a.idle,Lc.wVg),new oc.a(Gc.a.vye,Gc.a.UZ,null,Gc.a.zO,Gc.a.idle))}get kCc(){return $a.b(this.$.pg)}get CLd(){return this.$.isEditMode&&(this.$.ea.fih||this.$.TM)}Nc(vc,
ed){vc=this.$.workbookContext.FullDocumentInfo;switch(ed){case 353606613:case -1099009678:case 192430811:return!Nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode;case 783415632:return!Nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode;case 869186573:return ed=id.a()&&this.$.ea.Tg.get(5),!vc.FileSharingUrl&&!ed;case -1570751769:case 1986648902:return 131072!==
(this.$.sU&131072);case 330035228:return!(this.B2a(!0)&&this.kCc);case -509039657:return!(this.B2a()&&this.kCc);case 1334518759:return!(this.B2a()&&this.kCc&&this.hve())}return!1}executeCommand(vc,ed,Id){vc=this.$.workbookContext.FullDocumentInfo;var Ld=S.a.workflow,ce=ya.TaskExtensions.fk();const la=ed.command;if(la===Ld||-266099===la)return this.D3h(ed,Ld,vc);switch(la){case 1986648902:this.I_f();break;case -1570751769:this.k1h(ed);break;case 869186573:ed=S.a.xuj;ce=r.AFrameworkApplication.fa.qa("ShareMenuIsEnabled");
Ld=null;(Nb.EwaSettings.ma(549)||ce)&&Id&&"CopyLink"===Id.SourceControlId?(Ld={},Ld[A.a.EKb]="copy",ed=S.a.s0f):ce&&Id&&"ManageAccess"===Id.SourceControlId?(Ld={},Ld[A.a.EKb]="manageAccess",ed=S.a.zuj):Id&&"LinkToComment"===Id.SourceControlId&&(Ld={},Ld[A.a.EKb]="copy",Ld[A.a.bPd]=Id.navId,ed=S.a.s0f);ce=this.B3f(vc,Ld);Zc.c(ed);break;case -1099009678:ce=this.Avc(12,vc);break;case 192430811:ce=this.Avc(13,vc);break;case 353606613:ce=this.Avc(14,vc);break;case 783415632:ce=this.Avc(15,vc);break;case -59906385:case 1197060601:this.R2h(ed,
vc);break;case 1305810481:this.x4e(!1,ed);break;case 330035228:this.x4e(!0,ed);break;case -509039657:this.deleteForm();break;case 1334518759:ed.pyb=!0;this.shareForm();break;case 710925581:ub.a.tg.Svc("710925581")&&(ce=ya.TaskExtensions.Aa(this.$J.value,jb=>{jb.result.Fj(I.a.conversation,{})},this.la,3));break;case 327119921:this.Z0h();break;default:ce=ib.a(la)}return ce}Cc(vc,ed){vc=!1;ed=ed.command;if(ed===S.a.workflow)return!0;switch(ed){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:vc=
!0;break;case 353606613:case -1099009678:case 192430811:vc=Nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode;break;case 783415632:vc=Nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.ea.isNamedObjectViewMode}return vc}Rc(vc,ed,Id){if("PopulateFormMenu"===ed){ed=this.kCc?this.hve()?Lc.Cwh:Lc.Dwh:Lc.mCi;vc=this.Sa.zc();for(let Ld=0;Ld<ed.length;Ld++)vc.buttons.push(this.Sa.pb(ed[Ld]));ed=this.Sa.sq("Forms.Flyout");
ed.nc.push(vc);Id.MenuItems=ed.rE();return!0}return!1}D3h(vc,ed,Id){return this.CLd&&vc.command===ed?(this.ALd(vc,-266099),ya.TaskExtensions.raa()):ya.TaskExtensions.Aa(this.$J.value,Ld=>{Oc.a(Ld.result,I.a.workflow,null,Id.WorkflowPostMessage)||rb.HelperMethods.Ve(Id.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.la,3)}hve(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.Tg.get(26)}Z0h(){var vc=Qb.a.create().toString();k.ULS.sendTraceTag(528581128,
306,50,`Calling share to teams deeplink with ID: ${vc}`);var ed=this.$.frame,Id=ed.C8a,Ld=this.$;const ce=new Ub.QueryStringBuilder(r.AFrameworkApplication.fa.Va("TeamsMeetingShareEndpoint"));ce.Qi("deeplinkId",vc);ce.Qi("lm","deeplink");vc=ce.Qi;var la={};const jb=new Ub.QueryStringBuilder(r.AFrameworkApplication.fa.Va("TeamsAppSharingUrl"));jb.Qi("auth","2");jb.Qi("flight","officeunihost");jb.Qi("source","TEAMS-ELECTRON.meetingStage.deeplink");var ra={};ra.fileType=v.a.t3(Ld.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);
ra.objectUrl=Ld.workbookContext.FullDocumentInfo.WorkbookPath;ra.baseUrl=Ld.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;{Ld=Ld.workbookContext.WorkbookFileVersionId;let hb=decodeURIComponent(Ld);for(;Ld!=hb;)Ld=hb,hb=decodeURIComponent(Ld);0>Ld.indexOf("{")||0>Ld.indexOf("}")?(k.ULS.sendTraceTag(528250338,306,15,`Decoded fileId does not match expected format. Decoded id: ${Ld}`),Ld=""):Ld=Ld.substring(Ld.indexOf("{")+1,Ld.indexOf("}")).toLowerCase()}ra.fileId=Ld;ra=G.c(G.c(ra));jb.Qi("subEntityId",
ra.substring(1,ra.length-1));la.appSharingUrl=jb.toString();la.appId=r.AFrameworkApplication.fa.Va("TeamsAppId");la=JSON.stringify(la);vc.call(ce,"appContext",la);Id.call(ed,ce.toString(),!0)}k1h(vc){this.CLd?this.ALd(vc,1986648902):this.I_f()}x4e(vc,ed){!vc&&this.$.ya.SurveyRedirectUrl?this.X0i():(vc=new Qd(this.$,vc,ed),vc.initialize(),vc.Ff())}R2h(vc,ed){this.CLd&&1197060601===vc.command?this.ALd(vc,-59906385):ya.TaskExtensions.Aa(this.$J.value,Id=>{Id=Id.result;Id&&Oc.a(Id,I.a.replyWithChanges,
null,this.$.ea.Tg.get(8))||(Id=new Sys.StringBuilder(ed.ReplyWithChangesUrl),uc.a.Zg(Id,Ac.e,Ac.d),hc.a.ntw(Id.toString(),this.$))},this.la,3)}ALd(vc,ed){const Id=Ta.a(this.$).jd.activityState,Ld=new Bb.a(ed,vc.method,vc.mode,vc.Re,vc.tabName);ma.a(this.$).ls(new dc.a(Gc.a.Mx,5,()=>{Id[P.a.oq]=Gc.a.KUf;Id[pb.a.DSc]=Ld;this.$.Xk.Ky("SocialSharingSaveBeforeCommand");this.$.Xk.Xke(Ld.command)}))}I_f(){const vc=this.$.ya.DocumentHostInfo;vc.HostEmbeddedViewUrl||this.Xue?this.t2f():this.$.me.get(53)&&
ya.TaskExtensions.Aa(this.$J.value,ed=>{this.ANj(ed.result)||hc.a.ntw(vc.FileEmbedCommandUrl,this.$)},this.la,3)}ANj(vc){return vc.isEnabled()&&(this.Wue||(this.Wue=vc.Tl(I.a.Vue,this.aGi)))?vc.Fj(I.a.iyh,null):!1}t2f(){if(ja.a.np)hc.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{const vc=new nd(this.$);vc.initialize();vc.Ff()}}deleteForm(){const vc=this.$,ed=new eb(vc,1279,1280,1272,(Id,Ld,ce)=>{var la=vc.oa.va.Sb(),jb=vc.oa.va;la=jb.Na(9,la);la.surveyId=null;return Ua.g(jb,"DeleteSurvey",la,
Id,Ld,ce,null,0)});ed.initialize();ed.Ff()}shareForm(){const vc=this.$.workbookContext.FullDocumentInfo;if(this.$.ea.Tg.get(26)){const ed=new Xb(this.$);ed.initialize();ed.Ff()}else ya.TaskExtensions.Aa(this.$J.value,ed=>{Oc.a(ed.result,I.a.shareForm,{[A.a.AGj]:this.$.workbookContext.SurveyTitle},this.$.ea.Tg.get(10))||hc.a.ntw(vc.ShareFormCommandUrl,this.$)},this.la,3)}X0i(){const vc=this.$;vc.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");const ed=new Sys.StringBuilder(vc.ya.SurveyRedirectUrl);
uc.a.Zg(ed,"startupDialog","FormEdit");const Id=Ta.a(this.$),Ld=Id.jd.activityState;Ld[Vc.a.z1]=ed.toString();Ld[Vc.a.WL]=Vc.a.pwd;this.$.Xk.Ky("SocialSharingEnvironmentChange");ma.a(vc).ls(new dc.a(Gc.a.Mx,5,()=>{const ce=ua.a.Yc(3,2,1324,1325,1326,554412057,"FossEnvironmentUnsupported");Id.jd.$q([ce]);Ld[P.a.oq]=Gc.a.Cbg}))}B2a(vc=!1){return(this.$.ea.isEditMode||vc)&&this.$.ea.Tg.get(25)&&id.a()}qWh(vc){var ed=Ha.g(this.$).ha;const Id=this.$.xa.pa?Za.d(this.$.xa.pa):null;if(!Id)return k.ULS.sendTraceTag(537151649,
0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: ${Nd[vc]}.`),null;var Ld=null;14===vc?Ld=this.PVh(ed):12===vc?(Ld=ed.Dha,Ld=cc.a.contains(Ld,"!",!0)?Ld.split("!")[1]:Ld):13===vc&&(ed=ed.sa.selectedRanges,ed[0]&&(ed=Ha.g(this.$).Db.Yj(ed[0])))&&(Ld=ed.ej);if(!Ld&&15!==vc)return k.ULS.sendTraceTag(537151648,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: ${Nd[vc]}`),null;ed={};
ed[A.a.EKb]="copy";ed[A.a.bPd]=this.DMh(vc,Ld,Id);k.ULS.sendTraceTag(537151647,0,50,`SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: ${Nd[vc]} and sectionNameOrId: ${Ld} and SheetId: ${Id}`);return ed}PVh(vc){if(vc.Pa.pZ&&(vc=vc.Pa.$b.floatingObject)&&0===vc.type){const ed=vc.id.split(".");if(1<ed.length)return ed[1];k.ULS.sendTraceTag(537151646,0,10,`SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  ${vc.id}`)}return null}DMh(vc,
ed,Id){let Ld=vc+"_";Ld=btoa(15===vc?Ld+Id:Ld+(ed+"_"+Id));Ld=Ld.replace(RegExp("\\+","g"),"-");Ld=Ld.replace(RegExp("\\/","g"),"_");return Ld=Ld.replace(RegExp("\\=+$","g"),"")}B3f(vc,ed,Id=!1){return ya.TaskExtensions.Aa(this.$J.value,Ld=>{Oc.a(Ld.result,I.a.sharing,ed,this.$.ea.Tg.get(5))?(k.ULS.sendTraceTag(537151644,0,50,`SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: ${ed?ed[A.a.EKb]:""}`),Id&&Nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)&&Nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",!1)&&window.addEventListener("message",this.e5e)):rb.HelperMethods.Ve(vc.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.la,3)}e5e(vc){if(vc&&vc.data)try{switch(JSON.parse(vc.data).name){case "share_dismiss":this.BLj()}}catch(ed){k.ULS.sendTraceTag(512328543,0,50,"SocialSharingCommandHandler.handleShareMessage Failed to parse data with exception : "+ed.message)}}Avc(vc,ed){if(15===
vc&&!Nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||15!==vc&&!Nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;const Id=this.qWh(vc);if(Id)return k.ULS.sendTraceTag(520737606,0,50,`SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id=${Id[A.a.bPd]}`),this.B3f(ed,Id,!0);k.ULS.sendTraceTag(537151643,0,10,`SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: ${Nd[vc]}`);
return null}BLj(){window.addEventListener("message",this.e5e);Nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",!1)&&(this.$.ud(638984051,0,0,null),k.ULS.sendTraceTag(512328542,0,50,"SocialSharingCommandHandler.triggerDeepLinkCreationSurvey: FPS survey got triggered."))}}Lc.mCi=[103];Lc.Cwh=[107,104,105,106];Lc.Dwh=[104,105];Lc.wVg=[new gd.a(Gc.a.vye,554412057,0,0,1327),new gd.a(Gc.a.idle,554412057,0,1)];Object(b.a)(Lc,"SocialSharingCommandHandler",wb.a,[195]);
class hd extends xa.a{constructor(vc){super(vc)}yd(){const vc=new e.a(()=>ia.GetServiceTaskFactory.create(this.$.da,137,this.la,this.hb));ya.TaskExtensions.Aa(ia.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb),ed=>{this.gd([new Lc(this.$,ed.result,vc)])},this.la,3)}static ka(vc){xa.a.Nd(114,new hd(vc))}}Object(b.a)(hd,"SocialSharingCommandHandlerFactory",xa.a,[]);var Kd=a(1147);class Wd{constructor(vc){this.ai=vc}executeCommand(vc,ed,Id){return 2!==this.ai.de(S.a.tryOfficeThroughTellMe,
2,Id)?O.Task.Ta(!0):ib.a(ed.command)}Cc(vc,ed){return 215809929===ed.command}Rc(){return!1}Nc(){return!1}}Object(b.a)(Wd,"TryOfficeThroughTellMeCommandHandler",null,[195]);class oe extends xa.a{constructor(vc){super(vc)}yd(){this.gd([new Wd(r.AFrameworkApplication.wb)])}static ka(vc){xa.a.Nd(207,new oe(vc))}}Object(b.a)(oe,"TryOfficeThroughTellMeCommandHandlerFactory",xa.a,[]);var We=a(155),Ze=a(77),Be=a(152),af=a(260),ff=a(144),Pe=a(183);class Ne{static GM(){return ff.a.ap(Ne.Bk,Pe.a.Xa(436))}}Ne.Bk=
"<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(b.a)(Ne,"NamedSheetViewTeachingDialogHtml",null,[]);var se=a(51);class Wa extends af.a{constructor(vc){super(vc);this.stopwatch=this.Yo=null;this.uBi=ed=>{if(1===ed)this.$.Ka.Mb(new Bb.a(-2050946363,
Ze.a.Eb,2,8,null)).continueWith(Id=>{this.Yo.setResult(!Be.a(Id)&&Id.result)}),ed="Yes";else{const Id=2===ed;this.Yo.setResult(Id);ed=2===ed?"No":"Close";Id&&this.t_i()}this.Bui(ed);this.hide()}}get oc(){return"ShowNamedSheetViewTeachingDialog"}vg(){this.Rb=4;this.stopwatch=this.$.Ib.Bc("UserAction",this.oc);const vc=Dc.a.instance.ga(1910);this.ag=Ne.GM();this.Yo=new We.a;this.initializeAndShow(vc,this.uBi,{});return this.Yo.task}uv(vc){super.uv(vc);this.rc(1,Dc.a.instance.ga(1912));this.rc(2,Dc.a.instance.Xa(449))}t_i(){this.$.ea.Bkc=
!1}Bui(vc){const ed={};ed.a=this.$.ya.UserSessionId;ed.b="NamedSheetViewTeachingDialogClose";ed.c=vc;ed.e=!0;this.stopwatch&&(this.stopwatch.stop(),ed.d=this.stopwatch.uc);se.b().Le(53,ed,!0)}}Object(b.a)(Wa,"NamedSheetViewTeachingDialog",af.a,[]);var Sb=a(161);class wc{constructor(vc){this.$=vc;vc.da.Ga(309,this)}ORa(){if(this.qxj()){if(Nb.EwaSettings.ma(573)){this.$.xa.pa.Ed.rQd=!0;const vc=new We.a;this.$.Ka.Mb(new Bb.a(-2050946363,Ze.a.Eb,2,0,null)).continueWith(ed=>{vc.setResult(!Be.a(ed)&&ed.result)});
return vc.task}return(new Wa(this.$)).vg()}return O.Task.Ta(!0)}qxj(){const vc=this.$.xa.pa;return this.$.ea.N8a&&this.$.ea.Bkc&&!vc.Ed.lv&&this.$.ea.uM&&!Sb.f(this.$)}}Object(b.a)(wc,"NamedSheetViewPublic",null,[417]);class Uc extends Va.a{constructor(vc){super();this.$=vc;this.Fb()}create(){this.qb(this.$.da.za(309)||new wc(this.$))}static ka(vc){vc.da.Ga(310,new Uc(vc))}}Object(b.a)(Uc,"NamedSheetViewPublicFactory",Va.a,[]);var ob=a(7),Zb=a(185),Bc=a(1325),bd=a(856),Ed=a(457);class ge{constructor(vc,
ed,Id,Ld,ce,la,jb){this.title=vc;this.body=ed;this.E_i=Id;this.primaryButtonAction=Ld;this.secondaryButtonAction=la;this.lWf=ce;this.targetObject=jb}}Object(b.a)(ge,"NamedSheetViewTeachingCalloutContent",null,[]);class be{constructor(vc){this.Yge=0;this.a8f=vc}get Z7f(){return this.Yge}get f1i(){return this.Z7f<this.a8f.count?this.a8f.na(this.Yge++):null}}Object(b.a)(be,"NamedSheetViewTeachingCalloutList",null,[]);var qe=a(1070);class ze{constructor(vc){this.stopwatch=this.mZb=this.Eyc=this.nUd=null;
this.$7f=0;this.$=vc}d9h(vc){this.$7f=vc;const ed=Object(ob.a)(new Zb.a,{});ze.Igi(vc)?(ed.add(new ge(Dc.a.instance.Xa(438),Dc.a.instance.Xa(439),Dc.a.instance.ga(1940),()=>{this.YH(2,"Continue");this.KJ(!0)},Dc.a.instance.ga(1941),()=>{this.KJ();this.YH(1,"ExitGuide")},qe.a())),1===vc&&ed.add(new ge(Dc.a.instance.ga(1942),Dc.a.instance.Xa(441),Dc.a.instance.ga(1940),()=>{this.YH(2,"FirstEnterTempViewContinueSecond");this.KJ(!0)},Dc.a.instance.ga(1941),()=>{this.KJ();this.YH(1,"FirstEnterTempViewExitGuideSecond")},
qe.a())),ed.add(new ge(Dc.a.instance.Xa(442),Dc.a.instance.Xa(443),Dc.a.instance.ga(1940),()=>{this.YH(2,"FirstEnterExitCalloutContinue");this.KJ(!0)},Dc.a.instance.ga(1941),()=>{this.KJ();this.YH(1,"FirstEnterExitCalloutGuide")},ze.UZe())),ed.add(new ge(Dc.a.instance.ga(1943),Dc.a.instance.Xa(440),Dc.a.instance.ga(1944),()=>{this.c3f();this.KJ();this.YH(1,"LearnMore")},Dc.a.instance.ga(1945),()=>{this.KJ();this.YH(1,"Done")},ze.TZe()))):2===vc?ed.add(new ge(Dc.a.instance.ga(1942),Dc.a.instance.Xa(441),
Dc.a.instance.ga(1939),()=>{this.KJ();this.YH(1,"EnterTempViewAfterPersistedView")},null,null,qe.a())):3===vc&&(ed.add(new ge(Dc.a.instance.Xa(438),Dc.a.instance.ga(1951),Dc.a.instance.ga(1940),()=>{this.YH(2,"AutoOptInExitCalloutContinue");this.KJ(!0)},Dc.a.instance.ga(1941),()=>{this.KJ();this.YH(1,"AutoOptInExitGuide")},ze.UZe())),ed.add(new ge(Dc.a.instance.ga(1942),Dc.a.instance.Xa(441),Dc.a.instance.ga(1940),()=>{this.YH(2,"Continue");this.KJ(!0)},Dc.a.instance.ga(1941),()=>{this.KJ();this.YH(1,
"ExitGuide")},qe.a())),ed.add(new ge(Dc.a.instance.ga(1943),Dc.a.instance.Xa(440),Dc.a.instance.ga(1944),()=>{this.c3f();this.KJ();this.YH(1,"LearnMore")},Dc.a.instance.ga(1945),()=>{this.KJ();this.YH(1,"Done")},ze.TZe())));this.nUd=new be(ed)}c3f(){const vc=new Bb.a(-859308420,Ze.a.Eb,this.$.Mc,9,null);this.$.Ka.Mb(vc,{[Ze.a.Zf]:"HelpID=SheetViews",["InputMethod"]:Ze.a.Eb,[Ze.a.Pc]:pd.a.oQ,["ShouldCanvasTakeFocus"]:!0})}show(vc){this.d9h(vc);this.$cb()}arj(vc){this.mZb=vc}$cb(){var vc=this.nUd.f1i;
if(vc){var ed=Object(ob.a)(new Bc.a,{label:vc.E_i,onExecute:vc.primaryButtonAction}),Id=null;vc.lWf&&(Id=Object(ob.a)(new Bc.a,{label:vc.lWf,onExecute:vc.secondaryButtonAction}));vc=Object(ob.a)(new bd.a,{target:vc.targetObject,content:vc.body,title:vc.title,showCloseIcon:!0,primaryButtonProps:ed,secondaryButtonProps:Id,useTeachingStyles:!0});vc=this.mZb.callout(vc);ed=Object(ob.a)(new Ed.a,{onShow:()=>{this.YH(0)}});this.Eyc=this.mZb.addNotification(vc,ed)}}dismiss(){this.KJ();this.YH(1,"DismissedByOthers")}KJ(vc=
!1){this.Eyc&&(this.mZb.removeNotification(this.Eyc),this.Eyc=null);vc&&this.$cb()}YH(vc,ed=null){const Id={};Id.a=this.$.ya.UserSessionId;Id.b=this.$7f;Id.c=this.nUd.Z7f;Id.d=vc;Id.e=ed;0===vc?this.stopwatch=this.$.Ib.Bc("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),Id.f=this.stopwatch.uc,this.stopwatch=null),2===vc&&(this.stopwatch=this.$.Ib.Bc("UserAction","ShowNamedSheetViewTeachingCalloutNext")));se.b().Le(52,Id,!0)}static TZe(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")}static UZe(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")}static Igi(vc){return 0===
vc||1===vc}}Object(b.a)(ze,"NamedSheetViewTeachingCallout",null,[416]);class Ce extends Va.a{constructor(vc){super();this.$=vc;this.Fb()}create(){let vc=this.$.da.za(322);vc||(vc=new ze(this.$),this.$.da.Ga(322,vc));this.qb(vc)}static ka(vc){vc.da.Ga(323,new Ce(vc))}}Object(b.a)(Ce,"NamedSheetViewTeachingCalloutFactory",Va.a,[]);var Ve=a(1241),we=a(1136);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");Object(c.a)();Type.registerNamespace("CADWLTR");f.main();Type.registerNamespace("Common.App.NewAndOpen.UX");d.a.instance.yi(new ea);Object(R.a)();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");
Object(oa.a)();Object(pa.a)();Object(Pa.a)();Object(Z.a)();Type.registerNamespace("Common.App.SharedFilePicker");Ba.main();Type.registerNamespace("Common.App.WildFire");ca.main();Object(aa.a)();ta.a.Fa(sa.ka);Object(Ya.a)();Object(bb.a)();Object(mb.a)();Ca.a.Hi(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(()=>{ta.a.Fa(vc=>{Na.ka(vc)})})();
(()=>{ta.a.Fa(vc=>{vc.da.Ga(165,new Sa(vc))})})();ta.a.Fa(Oa.ka);Object(yb.a)();Object(Ob.a)();Object(Ja.a)();Object(lb.a)();Object(Pb.a)();Object(Jb.a)();Object(Lb.a)();Object(Ab.a)();Object(nb.a)();Object(va.a)();ta.a.Fa(ic.ka);ta.a.Fa(hd.ka);Object(Kd.a)();ta.a.Fa(oe.ka);(()=>{ta.a.Fa(vc=>{Uc.ka(vc);Ce.ka(vc)})})();Object(Ve.a)();Object(we.a)()},705:function(t,C,a){a.d(C,"a",function(){return U});t=a(0);var c=a(7),b=a(15),d=a(86),f=a(222),e=a(13),k=a(108),l=a(174),m=a(85);C=a(235);var v=a(1053),
n=a(19),w=a(5),r=a(319),u=a(54),y=a(12),x=a(71),B=a(14),z=a(21),A=a(96),I=a(896),F=a(1);class U extends C.a{constructor(X,S){super(document.createElement("div"));this.Pjf=this.woe=this.Pie=this.z1b=this.xba=this.x7=this.fS=this.Uy=null;this.rva=this.YY=this.ev=this.F4a=!1;this.TGi=H=>{this.kD(H)};this.ZGi=H=>{13===H.keyCode&&this.kD(H)};this.$xd=H=>{this.xo(H.tb);return!0};this.fyd=H=>{this.YZ(H.tb);return!0};this.vmc=H=>{this.Ala(H.tb?H.tb:0);return!0};this.UGi=H=>{this.kD(H.Ca);return!0};this.Vig=
(H=null)=>{this.xo(H.inputMethod?H.inputMethod:0);return!0};this.Wig=(H=null)=>{this.YZ(H.inputMethod?H.inputMethod:0);return!0};this.H0=X;this.RC=S;this.zWc=S.$Fa.toString();this.title=S.title;this.message=S.message;this.set_visibilityMode(1)}get ORg(){return this.RC.$Fa}get businessBar(){return this.H0}get actionButton(){return this.RC?this.RC.actionButton:""}get EFa(){return this.RC?this.RC.EFa:""}get linkText(){return this.RC?this.RC.link:""}get Tk(){return this.RC?this.RC.Tk:""}get alt(){return this.RC?
this.RC.alt:""}dispose(){d.a.qc([this.z1b,this.fS,this.x7]);this.ev&&this.fS&&(f.a.instance.Ba(e.a.click,this.fS.domElement,this.$xd),k.KeyInputManager.instance.Bv(this.domElement,this.Pie));this.YY&&this.x7&&(f.a.instance.Ba(e.a.click,this.x7.domElement,this.fyd),k.KeyInputManager.instance.Bv(this.domElement,this.woe));this.rva&&this.xba&&(f.a.instance.Ba(e.a.click,this.xba,this.vmc),k.KeyInputManager.instance.Bv(this.domElement,this.Pjf));this.xba=this.Uy=this.H0=this.x7=this.fS=null;super.dispose()}update(){}eQj(){this.rDe(!0)}g2c(){this.rDe(!1)}A8g(){this.message=
A.a.Ah(this.message);this.title=A.a.Ah(this.title);l.UISurfaces.aed().then(X=>{X.initializeMessageBarInStore();let S=Object(c.a)(new I.a,{messageTitle:this.title,message:this.message,isMultiline:!1,messageBarType:this.RC.NRg,closeable:!this.F4a,dismissButtonAriaLabel:B.a.instance.ga(10),onDismiss:this.UGi});this.rva&&(S.linkProps={["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.vmc});this.ev&&(S.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.Vig});
this.YY&&(S.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.EFa,["onExecute"]:this.Wig});X.createNewMessageBar(this.domElement,S);return null},()=>{b.ULS.sendTraceTag(524075914,0,10,"Business Bar could not be initialized");return null});this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement)}sDe(X){let S="<div class='"+v.a.Tlh+"' id='{0}'><div class='"+v.a.Rlh+"'><a class='"+v.a.Zlh+"' title='{1}'><span class='"+n.a.x1b+" "+v.a.Vlh+"' id='{2}'>";this.Tk.length&&
(S+="<img class='{3}' src='{4}'/>");S+="</span></a><span class='"+v.a.Ylh+"' id='{5}'>{6}</span><span class='"+v.a.Xlh+"' id='message'>{7}</span><a id='link' href='#' class='"+v.a.Wlh+"'>{8}</a><span class='"+v.a.uLe+"'><button type='button' id='action' class='"+v.a.tLe+"'>{9}</button></span><span class='"+v.a.uLe+"'><button type='button' id='altAction' class='"+v.a.tLe+"'>{10}</button></span></div><a class='"+v.a.Ulh+"' tabindex='0' role='button'><span id='close' class='"+n.a.PA+"'><img class='"+
n.a.E8c+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>";X||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var H=this.businessBar.$.Bb;X=H+"ewaBusinessBarEntryBody"+this.zWc;const D=H+"ewaBusinessBarEntryTitle"+this.zWc;H=H+"ewaBusinessBarEntryIcon"+this.zWc;this.domElement.className=v.a.Slh;this.domElement.innerHTML=String.format(S,X,this.alt,H,this.Tk,u.a.hf(0),D,this.title,this.message,this.linkText,this.actionButton,this.EFa,u.a.hf(13),
B.a.instance.ga(798));y.DOMElementExtensions.nu(this.domElement,w.a.Dra,D,X);this.xba=$get("link",this.domElement);y.DOMElementExtensions.setVisible(this.xba,this.rva);this.rva&&(f.a.instance.ra(e.a.click,this.xba,this.vmc),this.Pjf=k.KeyInputManager.instance.ms(this.xba,this.vmc,m.a.$h,m.a.A0));this.fS=new r.a(y.DOMElementExtensions.getElementById(this.domElement,"action"));this.fS.isVisible=this.ev;this.x7=new r.a(y.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.x7.isVisible=
this.YY;this.ev&&(f.a.instance.ra(e.a.click,this.fS.domElement,this.$xd),this.Pie=k.KeyInputManager.instance.ms(this.fS.domElement,this.$xd,m.a.$h,m.a.A0),this.YY&&(f.a.instance.ra(e.a.click,this.x7.domElement,this.fyd),this.woe=k.KeyInputManager.instance.ms(this.fS.domElement,this.fyd,m.a.$h,m.a.A0)));this.Uy=$get("close",this.domElement);this.z1b=this.ue.Zd(this.Uy);this.z1b.ka("click",this.TGi);this.z1b.ka("keydown",this.ZGi);y.DOMElementExtensions.setVisible(this.Uy,!this.F4a)}rDe(X){65==this.RC.$Fa?
this.sDe(X):F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.A8g():this.sDe(X)}xo(){b.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.RC.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.RC.B7c}`);z.g(this.businessBar.$).Go(!0)}YZ(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.RC.hash}]: BusinessBarEntry.OnAltActionClick()`);z.g(this.businessBar.$).Go(!0)}Ala(){b.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.RC.hash}]: BusinessBarEntry.OnLinkClick()`);
z.g(this.businessBar.$).Go(!0)}kD(X){b.ULS.sendTraceTag(21517971,0,50,`BusinessBar [${this.RC.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.RC.B7c}`);this.set_visible(!1);this.businessBar.removeEntry(this.ORg);x.g(X)}}Object(t.a)(U,"BusinessBarEntry",C.a,[])},777:function(t,C,a){a.r(C);t=a(0);var c=a(7),b=a(15),d=a(4);a(27);var f=a(380),e=a(38),k=a(50),l=a(12),m=a(127),v=a(1),n=a(14),w=a(21);class r extends Sys.EventArgs{constructor(J){super();this.M_i=J}}Object(t.a)(r,"PrintPreviewPaneOperationStatusEventArgs",
Sys.EventArgs,[]);var u=a(258),y=a(245);class x{constructor(J){this.ng=J}Xh(){u.a(this.ng.$).dB(this.$d)||u.a(this.ng.$).Xh(this)}m7(){u.a(this.ng.$).dB(this.$d)&&u.a(this.ng.$).Nz(this)}get $d(){return y.a.mIf}get mc(){const {PrintPreviewPane:J}=a(777);return document.getElementById(J.K_i)}get kf(){return!0}kh(J){return l.DOMElementExtensions.vf(this.mc,J)}lj(){this.ng.$.frame.Ee.Sj(this.ng.$.frame.Ee.RE)}Nj(){}hg(J,M){return M?!1:(this.ng.enterPrintPreviewHeaderFocusTrapZone(),!0)}}Object(t.a)(x,
"PrintPreviewHeaderKeyboardAccessibleSection",null,[102]);class B{constructor(J){this.ng=J}Xh(){u.a(this.ng.$).dB(this.$d)||u.a(this.ng.$).Xh(this)}m7(){u.a(this.ng.$).dB(this.$d)&&u.a(this.ng.$).Nz(this)}get $d(){return y.a.nIf}get mc(){const {PrintPreviewPane:J}=a(777);return this.ng.useMSPdfViewer?document.getElementById(a(777).PrintPreviewPane.gCd):document.getElementById(J.IFf)}get kf(){return!0}kh(J){return l.DOMElementExtensions.vf(this.mc,J)}lj(){this.ng.$.frame.Ee.Sj(this.ng.$.frame.Ee.RE)}Nj(){}hg(J,
M){return M?!1:(this.ng.useMSPdfViewer?(J=document.getElementById(a(777).PrintPreviewPane.gCd))&&l.DOMElementExtensions.setFocus(J,!0):l.DOMElementExtensions.setFocus(this.ng.JK),!0)}}Object(t.a)(B,"PrintPreviewKeyboardAccessibleSection",null,[102]);class z{constructor(J){this.ng=J}Xh(){u.a(this.ng.$).dB(this.$d)||u.a(this.ng.$).Xh(this)}m7(){u.a(this.ng.$).dB(this.$d)&&u.a(this.ng.$).Nz(this)}get $d(){return y.a.qIf}get mc(){const {PrintPreviewPane:J}=a(777);return document.getElementById(J.mEd)}get kf(){return!0}kh(J){return l.DOMElementExtensions.vf(this.mc,
J)}lj(){this.ng.$.frame.Ee.Sj(this.ng.$.frame.Ee.RE)}Nj(){}hg(J,M){return M?!1:(this.ng.enterPrintSettingsTaskPaneFocusTrapZone(),!0)}}Object(t.a)(z,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[102]);class A{constructor(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}}Object(t.a)(A,"MSPdfViewerFileUrl",null,[]);class I{constructor(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=
this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}}Object(t.a)(I,"PrintSettingsTaskPaneProps",null,[]);class F{constructor(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}}Object(t.a)(F,"ViewerPaneProps",null,[]);var U=a(1073),X=a(375),S=a(5),H=a(1074);a.d(C,"PrintPreviewPane",function(){return D});
class D extends e.a{constructor(J,M,G,T){super();this.mBb=this.Hic=this.JK=this.kGb=this.Cw=this.vV=this.xD=this.MF=null;this.lBb=!1;this.kwa=!0;this.nEd=this.jEd=this.kEd=this.ewaAccessibilityManager=this.toc=null;this.omd=!1;this.Uxf=()=>{b.ULS.sendTraceTag(537154206,0,50,`PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: ${this.lBb}`);this.lBb&&(this.K5h(),this.JK.style.visibility="visible",this.Hic?this.Hic.stop():b.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),
this.raiseEvent(D.YCb,new r(1)),this.MNd(),this.lBb=!1)};this.$=J;this.wD=M;this.m8g();this.useMSPdfViewer=G;this.isUniversalPrintEnabled=T;this.isExportPdfMode=!1}tFg(J){this.addHandler(D.YCb,J)}sbj(J){this.removeHandler(D.YCb,J)}CAj(J){this.isExportPdfMode=J;this.h8g()}DAj(){var J=this.$.Ib.Bc("UserAction","createSettingsPaneStopwatch");const M=document.getElementById(D.mEd);this.o8g();const G=this.p8g();this.xD.createPrintSettingsTaskPane(M,G);J.stop();this.lBb=!1;if(this.isUniversalPrintEnabled&&
this.Cw){J="A4";switch(G.selectedPrintSettingsValues.selectedPaperSize){case 8:J="A3";break;case 9:J="A4";break;case 11:J="A5";break;case 12:J="JIS B4";break;case 13:J="JIS B5";break;case 5:J="North America Legal";break;case 1:J="North America Letter";break;case 6:J="North America Invoice";break;case 7:J="North America Executive";break;case 3:J="North America Ledger"}this.MF.setDocumentSettings({mediaSize:J,orientation:2===G.selectedPrintSettingsValues.selectedOrientation?"landscape":"portrait",colorMode:1===
G.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.aHd()}setPageRangeSettings(J,M,G,T,K){this.xD&&(this.xD.setPageRangeSettings(J,M,G,T,K),this.SZf(String.format(n.a.instance.ob(204),T,K,J)))}z5h(){this.Cw&&(this.Cw.style.display="none")}Yfh(){this.dispose();this.YWd();this.YNj();this.MF&&this.MF.closePrintPreviewPane();this.vV=this.xD=this.MF=this.Cw=null}esi(J){b.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?
((this.mBb=this.$.Ib.Bc("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||b.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.vV.renderPdf(J)):this.JK&&((this.Hic=this.$.Ib.Bc("UserAction","loadPdfStopwatch"))||b.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.lBb=!0,this.JK.src&&this.JK.src===J?this.Uxf(null):this.JK.src=J);if(this.isUniversalPrintEnabled&&this.Cw){const M=X.b(this.$.workbookContext);
this.MF.setFileUrl(J,M)}}onPdfLoad(){this.mBb?(b.ULS.sendTraceTag(537154208,0,50,`PrintPreviewPane:onPdfLoad - Rendering time : ${this.mBb.uc} ms, isFirstTimeLoad: ${this.kwa}`),this.mBb.stop()):b.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(D.YCb,new r(1));this.hideWaitCursor();this.MNd()}printPdf(){l.DOMElementExtensions.setFocus(this.JK);this.JK.contentWindow.print()}rBj(){this.showSpinner();this.showWaitCursor();this.SZf("")}K5h(){this.hideSpinner();
this.hideWaitCursor()}Xz(J,M,G=null){this.Cw&&this.vV&&(this.omd=!1,this.vV.showErrorDetails(M,J,G),this.wD.G5a=!0,this.JK&&(this.JK.src=""),this.disablePrintButton(),this.hideWaitCursor(),D.zji(M)&&(this.omd=!0,this.IOi()))}hidePreviewError(){this.wD.G5a=!1;this.vV.hidePreviewError();this.enablePrintButton()}Pfh(){(this.kGb=document.getElementById(D.oIf))&&this.kGb.parentNode&&this.kGb.parentNode.removeChild(this.kGb)}hideErrorMessageForPrintOptions(){this.xD&&this.xD.hideErrorMessageForPrintOptions()}showErrorMessageForPrintOptions(J){this.xD&&
this.xD.showErrorMessageForPrintOptions(J)}showSpinner(){this.wD.G5a||v.EwaSettings.isChangeGateEnabled("OfficeVSO:5547045_ShowLoadingIconOnSettingsChange")&&this.omd?this.hidePreviewError():this.JK&&(this.JK.style.visibility="hidden");this.vV&&this.vV.showSpinner()}hideSpinner(){this.vV&&this.vV.hideSpinner()}enablePrintButton(){this.xD&&this.xD.enablePrintButton();this.isUniversalPrintEnabled&&this.Cw&&this.MF.updatePrintButtonEnableDisableState(!0)}disablePrintButton(){this.xD&&this.xD.disablePrintButton();
this.isUniversalPrintEnabled&&this.Cw&&this.MF.updatePrintButtonEnableDisableState(!1)}showWaitCursor(){this.xD&&this.xD.showWaitCursor();this.isUniversalPrintEnabled&&this.Cw&&this.MF.updatePrintButtonEnableDisableState(!1)}hideWaitCursor(){this.xD&&this.xD.hideWaitCursor();this.isUniversalPrintEnabled&&this.Cw&&this.MF.updatePrintButtonEnableDisableState(!0)}k8g(){if(this.Cw)b.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");
else if(this.Cw=document.createElement("div"),this.Cw.id=D.oIf,this.Cw.classList.add(D.N_i),this.$.dr.insertBefore(this.Cw,this.$.dr.firstChild),d.AFrameworkApplication.ta&&d.AFrameworkApplication.ta.Oa.$e){const J=document.getElementById(S.a.zra);J&&(this.Cw.style.top=`${J.clientHeight}px`,this.Cw.style.height=`calc(100vh - ${J.clientHeight}px)`)}}enterPrintPreviewHeaderFocusTrapZone(){this.MF.enterPrintPreviewHeaderFocusTrapZone()}enterPrintSettingsTaskPaneFocusTrapZone(){this.MF.enterPrintSettingsTaskPaneFocusTrapZone()}yYi(){this.$.da.Za(15,
J=>{this.ewaAccessibilityManager=J;this.ewaAccessibilityManager.mode=3})}m8g(){this.nEd=new z(this);this.kEd=new B(this);this.jEd=new x(this)}aHd(){this.nEd.Xh();this.kEd.Xh();this.jEd.Xh();this.yYi()}YWd(){this.nEd.m7();this.kEd.m7();this.jEd.m7();w.g(this.$).U_();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)}PN(){this.toc=m.a.instance.Zd(this.JK);this.toc.ka("load",this.Uxf)}YNj(){this.toc&&this.JK&&this.toc.detach("load")}MNd(){this.isUniversalPrintEnabled?this.YYf(D.L_i,
D.qCi):this.YYf(D.mEd,D.iIf)}YYf(J,M){this.kwa&&(J=document.getElementById(J))&&(M=l.DOMElementExtensions.getElementById(J,M))&&(this.kwa=!1,M.focus())}IOi(){this.wD.G5a=!1;this.enablePrintButton();this.MNd()}h8g(){const J=k.GetServiceTaskFactory.Ra(this.$.da,283,284,0).result.Zn;J.loadScript("excel-print-preview-sprite").then(()=>{J.loadScript("printPreviewer").then(()=>{J.loadScript("excelPrintPreviewer").then(()=>{this.n8g()})},()=>{b.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},
()=>{b.ULS.sendTraceTag(525358668,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}n8g(){const J=this.$.Ib.Bc("UserAction","createEmptyPreviewerStopwatch");this.k8g();this.l8g();this.isUniversalPrintEnabled?this.MF.createEmptyPrintPreviewPaneAsync(this.Cw,this.zDe()).then(()=>{J.stop();this.iAe();this.MF.updatePrintButtonEnableDisableState(!1)}):(this.MF.createEmptyPrintPreviewPane(this.Cw,this.zDe()),J.stop(),this.iAe())}iAe(){const J=
this.$.Ib.Bc("UserAction","createPdfPreviewPaneStopwatch"),M=document.getElementById(D.gCd);this.useMSPdfViewer&&(M.tabIndex=0);this.U7g();this.T7g(M);J.stop();this.raiseEvent(D.YCb,new r(0))}l8g(){this.MF||(this.MF=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.MF||b.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")}o8g(){this.xD||(this.xD=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());
this.xD||b.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")}U7g(){this.vV||(this.vV=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.vV||b.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")}T7g(J){this.vV.createPrintPreviewPane(J,this.y$g());this.useMSPdfViewer||(this.JK=l.DOMElementExtensions.getElementById(this.Cw,
D.IFf),this.JK.title=n.a.instance.ga(1214),this.PN())}p8g(){let J,M="en-US";J=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?M=this.$.ya.DataCultureTag:b.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object(c.a)(new I,{whatToPrintOptions:this.wD.pv.whatToPrintOptions,orientationOptions:this.wD.pv.orientationOptions,paperSizeOptions:this.wD.pv.paperSizeOptions,scalingOptions:this.wD.pv.scalingOptions,
marginDetailedOptions:this.wD.OQh(),selectedPrintSettingsValues:this.wD.LTh(),printSettingsTaskPaneCallbacks:this.wD.JTh(),logger:new f.a,shouldDisableCurrentSelection:this.wD.Vvc(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:J,dataCultureTag:M,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})}zDe(){return this.isUniversalPrintEnabled?this.wD.HTh():Object(c.a)(new U.a,{backActionButtonText:n.a.instance.ga(1212),printPreviewPaneCallbacks:this.wD.c0e(),logger:new f.a,disableTellMeControl:!0,
isExportPdfMode:!1})}y$g(){return this.useMSPdfViewer?Object(c.a)(new F,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.h7g(),onPdfLoad:()=>{this.onPdfLoad()}}):Object(c.a)(new F,{useMSPdfViewer:!1})}h7g(){return Object(c.a)(new A,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})}SZf(J){this.Cw&&this.MF.setAdditionalHeaderText(J)}static zji(J){return 3===J||2===J}}D.oIf="PrintPreviewerContainer";
D.mEd="printSettingsTaskPaneId";D.gCd="previewId";D.IFf="printpreviewiframe";D.K_i="printPreviewHeaderId";D.iIf="printButton";D.L_i="printPreviewPaneId";D.qCi="printButtonId";D.N_i=H.a.Cw;D.YCb="pppnosu";Object(t.a)(D,"PrintPreviewPane",e.a,[803])},832:function(t,C,a){a.d(C,"a",function(){return e});t=a(0);var c=a(15),b=a(4),d=a(39),f=a(27);class e{static sVe(k,l){switch(k){case 3:return e.XZh(l);case 2:return e.GSh(l);case 1:return e.RMh(l)}return""}static XZh(k){switch(k){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();
case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static GSh(k){switch(k){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static RMh(k){switch(k){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(k,
l,m){if(f.a.Ug||f.a.hp)window.setTimeout(()=>{e.GMf(m,e.gbc())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(e.kpe(m),k,0,!1)}static eYg(k,l,m,v){l&&v&&v();e.openInClient(k,l,m)}static gbc(){return f.a.Ug?1:f.a.hp?2:f.a.e7a?3:f.a.isMac?4:0}static TZh(k){switch(k){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static UZh(k){switch(k){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";
case 1:return"WildFireExcelBizBarFlight";default:return""}}static get Oyb(){return"zh-CN"===window.navigator.language}static GMf(k,l){1===l?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),k=e.sVe(k,l),8<f.a.P4a?d.a.Ve(k,void 0,void 0,"RedirectToAppStore"):d.a.uU(k)):document.hidden||(e.Oyb?(k=b.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),d.a.uU(k)):c.ULS.sendTraceTag(18088019,
306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(e.sVe(k,l),null,null)))}static kpe(k){switch(k){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get owc(){return(f.a.e7a||f.a.isMac)&&f.a.jp}static get Gxj(){return f.a.Ug||f.a.hp}static Mbd(k){switch(k){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static Mnd(k){return(k=
e.KPh(k))&&""!==k?Boolean.parse(k):!1}static GOd(k){e.zqj(k)}static KPh(k){try{return localStorage.getItem(k)}catch(l){return c.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+l.message),null}}static zqj(k){try{localStorage.setItem(k,"true")}catch(l){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+l.message)}}}e.hxe="ChromeExtensionBarDismiss";Object(t.a)(e,"WildFireUtilities",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kmhv.js.map/b07a260fb0f43d06d2324df7e82dbf4a/EwaDSEsNext.kmhv.js.map