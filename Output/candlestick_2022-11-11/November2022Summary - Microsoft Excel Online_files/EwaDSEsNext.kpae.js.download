'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1075:function(t,C,a){a.d(C,"a",function(){return b});var c=a(508);const b=()=>{c.a.Hi('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}')}},
1076:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b,d){this.command=0;this.selectedRanges=null;this.command=b;this.selectedRanges=d}Xs(){return this.command}}Object(t.a)(c,"MacroRecorderRangeOperationAppliedPayload",null,[101])},1077:function(t,C,a){a.d(C,"a",function(){return b});var c=a(508);const b=()=>{c.a.Hi(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}")}},
1078:function(t,C,a){a.d(C,"a",function(){return"FieldInfoListContextLoaded"});a.d(C,"h",function(){return"GetFieldInfoListContextOperationFailed"});a.d(C,"d",function(){return"Days from Today"});a.d(C,"g",function(){return"Years from Today"});a.d(C,"c",function(){return"Day of the Week"});a.d(C,"f",function(){return"Month of the Year"});a.d(C,"e",function(){return"End of Month"});a.d(C,"b",function(){return"Next Day"})},1079:function(t,C,a){a.d(C,"a",function(){return b});var c=a(508);const b=()=>
{c.a.Hi(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}")}},
1080:function(t,C,a){a.d(C,"a",function(){return b});var c=a(508);const b=()=>{c.a.Hi(".DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}")}},
1082:function(t,C,a){a.d(C,"a",function(){return b});var c=a(508);const b=()=>{c.a.Hi(".ewa-facp-text-box{position:absolute}")}},1083:function(t,C,a){a.d(C,"b",function(){return"MinorThemeFont"});a.d(C,"a",function(){return"MajorThemeFont"})},1085:function(t,C,a){a.d(C,"a",function(){return b});var c=a(508);const b=()=>{c.a.Hi('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}')}},
1086:function(t,C,a){a.d(C,"a",function(){return l});t=a(0);C=a(235);var c=a(5),b=a(33),d=a(11),f=a(21),e=a(34),k=a(4);class l extends C.a{constructor(m){super(document.createElement("div"));this.KQ=this.OHa=this.NHa=this.PHa=this.RHa=this.QHa=!1;this.VI=null;this.visible=void 0;this.gmc=(v,n)=>{this.mt(v,n)};this.VKa=()=>{this.Ya.textBox.kF=!0};this.kya=()=>{this.Ny(!0)};this.Btf=()=>{this.Ya.textBox.focus()};this.Fh=()=>{f.g(this.$).inRangePicker||(this.qe=!1)};this.$=m;f.g(m)&&f.g(m).ha&&f.g(this.$).ha.pJ(this.Fh);
this.Ok=b.a.a4()}get $H(){return this.Ot.$H}get qe(){return this.Ot.qe}set qe(m){this.Ot.qe=m}get Ya(){return this.VI}set Ya(m){(this.VI=m)&&this.VI.qZd.add(this)}get HCh(){return b.a.WM(this.$)?-5:-40}get_visible(){return void 0!==this.visible?this.visible:this.visible=super.get_visible()}set_visible(m){if(this.visible===m)return m;this.visible=m;return super.set_visible(m)}mt(){this.eBa(!1);this.Ot.mt()}dispose(){this.$&&f.g(this.$)&&f.g(this.$).ha&&f.g(this.$).ha.RK(this.Fh);this.$=null;super.dispose()}Th(m,
v,n=!1){m=!1;if((this.q0a||n)&&!this.rwa()&&this.get_visible()&&this.qe)switch(this.Ok&&this.lAc(v),v){case 1872288872:this.qe=!1;m=!0;break;case -798660877:this.Ot.lB(1);m=!0;break;case 137938150:this.Ot.lB(-1);m=!0;break;case 2091832999:this.Ot.lB(this.$H-1);m=!0;break;case 742457698:this.Ot.lB(-(this.$H-1));m=!0;break;case 125627505:m=this.Ny(!1);break;case 267796030:b.a.a4()&&(m=this.Ny(!1))}return m}eBa(m){if(this.qe||m){var v=f.g(this.$);m=v.domElement;var n=this.VI.textBox.domElement,w=e.a(this.$).si(n.offsetHeight),
r=e.a(this.$).si(n.offsetTop),u=e.a(this.$).si(n.offsetWidth);n=e.a(this.$).si(n.offsetLeft);v=v.lm;var y=k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Oa.$e,x=$get(this.$.Bb+c.a.s_a,this.$.domElement);y&&(x=document.getElementById("EditorContainer"));var B=new Sys.UI.Point(v?this.Ot.i9b:0,v?this.HCh:l.z0h);w=x.offsetTop+B.y+(b.a.WM(this.$)&&v?0:w+r);this.$.g4||(r=$get(c.a.zra,this.$.domElement),w+=r&&!y?r.offsetHeight:0);r=this.domElement;r.style.top=d.HelperMethods.pc(w);n=x.offsetLeft+
n+B.x;!b.a.WM(this.$)&&this.$.isChromeRtl?r.style.right=d.HelperMethods.pc(v?this.Ot.i9b:m.offsetLeft+m.offsetWidth-n-u):r.style.left=d.HelperMethods.pc(n)}}rSa(m){this.Ot&&(m&&!this.KQ?(this.Ot.Y8(this.Btf),this.Ot.lYb(this.VKa),this.Ot.Mmb(this.kya),this.KQ=!0):this.KQ&&(this.Ot.Oca(this.Btf),this.Ot.yrc(this.VKa),this.Ot.THb(this.kya),this.KQ=!1))}lAc(m){switch(m){case -798660877:case 137938150:case 2091832999:case 742457698:this.QHa=!0;break;case 125627505:this.PHa=!0;break;case 267796030:b.a.a4()&&
(this.NHa=!0)}}}l.i9b=0;l.z0h=1;Object(t.a)(l,"AutoCompleteControl",C.a,[555])},1087:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c extends Sys.EventArgs{constructor(b,d=0,f="",e=""){super();this.length=b;this.selectedIndex=d;this.YF=f;this.description=e}}Object(t.a)(c,"ListEventArgs",Sys.EventArgs,[])},1088:function(t,C,a){a.d(C,"a",function(){return r});t=a(0);var c=a(15),b=a(27);C=a(835);var d=a(770),f=a(5),e=a(77),k=a(33),l=a(12),m=a(1),v=a(116),n=a(21),w=a(907);class r extends C.a{constructor(u,
y){super(u,y,new w.a(d.a.listItem,d.a.fBb,d.a.iBb,d.a.jBb));this.Cbc=!1;this.Lkb=this.mr=null;this.ITe=!1;this.visible=void 0;this.wAa(!0);this.ITe=m.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash")}get i9b(){if(k.a.WM(this.$)){var u=document.getElementById(this.$.Bb+f.a.HTe);return!this.ITe||u?l.DOMElementExtensions.getBoundingClientRect(u).x:0}u=m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(f.a.fwd):document.getElementById(this.$.Bb+
f.a.fwd+"-"+f.a.xqf);c.ULS.shipAssertTag(537170323,0,!!u||this.$.mK,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return u?u.offsetWidth:0}get ee(){return this.Lkb}set ee(u){this.Lkb=u}get qe(){return void 0!==this.visible?this.visible&&0<this.mr.length:(this.visible=l.DOMElementExtensions.isVisible(this.gg))&&0<this.mr.length}set qe(u){this.visible!==u&&(l.DOMElementExtensions.setVisible(this.gg,u),l.DOMElementExtensions.setVisible(this.RSa,u),this.visible=
u);const y=n.g(this.$).view;u?this.Cbc||(y.Ls(this.PFa.gmc),this.Cbc=!0):(this.mr.length=0,this.Cbc&&(y.Pq(this.PFa.gmc),this.Cbc=!1))}Fxa(){var u=460;const y=n.g(this.$);var x=y.domElement,B=this.RSa.style;const z=this.gg.offsetTop+this.Ej.offsetHeight*this.Ej.sectionRowIndex-this.gg.scrollTop;B.width="auto";B.whiteSpace="nowrap";B.position="absolute";const A=x.offsetLeft+x.offsetWidth-(this.domElement.offsetLeft+this.gg.offsetLeft+this.gg.offsetWidth+3);x=this.domElement.offsetLeft-3-(x.offsetLeft+
this.i9b);u=Math.min(this.RSa.offsetWidth,u,Math.max(A,x));l.DOMElementExtensions.Dv(this.RSa,u);B.whiteSpace="";B.position="absolute";z+3>this.gg.offsetTop+this.gg.offsetHeight||z<this.gg.offsetTop||(u=this.gg.offsetLeft-3-this.RSa.offsetWidth,B=this.gg.offsetLeft+this.gg.offsetWidth+3,l.DOMElementExtensions.updatePosition(this.RSa,x>A!==y.rtl?u:B,z,!1))}lB(u){super.lB(u);this.Fxa()}mt(){this.Fxa()}rra(){const u=this.qn,y=this.gg,x=3===e.a.Eb||b.a.np,B=x?this.aCb:this.$H;this.qe=!0;y.style.height=
"auto";this.PFa.set_visible(!0);this.smb(u,x);this.mr.length>B?(l.DOMElementExtensions.MI(y,Math.floor(y.offsetHeight*B/this.mr.length)),y.style.overflowY="auto"):m.EwaSettings.Vfc()||(y.style.height="auto",y.style.overflowY="hidden");l.DOMElementExtensions.Dv(y,u.offsetWidth+(this.mr.length>B?v.a.mu:0))}}Object(t.a)(r,"AutoCompleteListBox",C.a,[])},1089:function(t,C,a){a.d(C,"a",function(){return n});t=a(0);var c=a(222),b=a(13),d=a(108),f=a(236);C=a(235);var e=a(553),k=a(5),l=a(54),m=a(12),v=a(71);
class n extends C.a{constructor(w,r,u,y,x,B,z,A,I,F){super(document.createElement("a"));this.Vm=!1;this.ed=U=>{this.raiseEvent("ClickButton",U);return!0};this.onKeyDown=U=>{this.raiseEvent("KeyDown",U);return!1};this.ww=()=>{this.hovered=!0;this.raiseEvent("PointerOver");return!1};this.AN=()=>{this.hovered=!1;this.raiseEvent("PointerOut");return!1};this.onBlur=U=>{v.g(U);this.focused=!1;this.raiseEvent("Blur")};this.onFocus=U=>{v.g(U);this.focused=!0;this.raiseEvent("Focus")};this.Pjh=A;this.Zeh=
I;this.aJ=n.pb(this.domElement,r,u,y,x,B,z,F);this.Gc.ka("contextmenu",U=>{v.g(U)});this.enable();this.focused=this.hovered=!1;w.appendChild(this.domElement)}MTc(w){this.get_events().addHandler("ClickButton",w)}hId(w){this.get_events().removeHandler("ClickButton",w)}ZTc(w){this.get_events().addHandler("KeyDown",w)}vId(w){this.get_events().removeHandler("KeyDown",w)}AYb(w){this.get_events().addHandler("PointerOver",w)}GId(w){this.get_events().removeHandler("PointerOver",w)}zYb(w){this.get_events().addHandler("PointerOut",
w)}FId(w){this.get_events().removeHandler("PointerOut",w)}ymb(w){this.get_events().addHandler("Blur",w)}FHb(w){this.get_events().removeHandler("Blur",w)}Y8(w){this.get_events().addHandler("Focus",w)}Oca(w){this.get_events().removeHandler("Focus",w)}get ul(){return this.aJ}get isEnabled(){return this.Vm}enable(){this.domElement&&(this.domElement.classList.remove(e.a.KT),this.domElement.style.cursor="",c.a.instance.ra(b.a.click,this.domElement,this.ed),d.KeyInputManager.instance.ra(b.a.Kb,this.domElement,
this.onKeyDown),f.a.instance.ra(b.a.pointerOver,this.domElement,this.ww),f.a.instance.ra(b.a.pointerOut,this.domElement,this.AN),this.Gc.ln("blur")||this.Gc.ka("blur",this.onBlur),this.Gc.ln("focus")||this.Gc.ka("focus",this.onFocus),this.domElement.title=this.Pjh,this.Vm=!0)}disable(){this.domElement&&(this.domElement.classList.add(e.a.KT),this.domElement.style.cursor="",this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.ed),d.KeyInputManager.instance.Ba(b.a.Kb,this.domElement,this.onKeyDown),
f.a.instance.Ba(b.a.pointerOver,this.domElement,this.ww),f.a.instance.Ba(b.a.pointerOut,this.domElement,this.AN)),this.domElement.title=this.Zeh,this.Vm=!1)}dispose(){this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.ed),d.KeyInputManager.instance.Ba(b.a.Kb,this.domElement,this.onKeyDown),f.a.instance.Ba(b.a.pointerOver,this.domElement,this.ww),f.a.instance.Ba(b.a.pointerOut,this.domElement,this.AN),this.Vm=!1);m.DOMElementExtensions.setVisible(this.domElement,!1);super.dispose()}static pb(w,
r,u,y,x,B,z,A){w.removeAttribute("Href");w.setAttribute(k.a.Kd,k.a.Ms);w.className=r;w.tabIndex=A;r=document.createElement("span");r.className=z;r.classList.add(u);r.tabIndex=-1;w.appendChild(r);w=document.createElement("img");w.src=l.a.hf(y);w.className=x;w.alt=B;w.tabIndex=-1;r.appendChild(w);return w}}Object(t.a)(n,"ListButton",C.a,[437,2])},1131:function(t,C,a){function c(la){var jb;if(la){var ra=new Ve(0===la.kind);la=null===(jb=null===la||void 0===la?void 0:la.rangeInfo)||void 0===jb?void 0:
jb.positionKindInfo;if(!la)return ra;ra.rF=0===la.firstRow;ra.qF=0===la.firstColumn;ra.jK=0===la.secondRow;ra.iK=0===la.secondColumn;return ra}}var b=a(10),d=a(0),f=a(691),e=a(50),k=a(37),l=a(15),m=a(19),v=a(379),n=a(77);class w{}w.d9c="!";w.yEf="[";w.xEf="]";w.openParen="(";w.closeParen=")";w.rgg=" /.(*\\".split("");w.p6b="...";w.kFb="param_help_link";w.VBd="param_help_udf";w.Yad="function_list_box";w.BDh="function_param_box";w.$ad="function_reader_description";w.Uad="function_description_box";w.cUe=
"function_param_table";w.tVi="param_row_";w.WBd="param_set";w.hFf="param_row_0";w.iFf="param_row_1";w.CDh="<div id='{0}' class='{1}'></div>";w.ADh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";w.jFf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";w.xDh="<div id='{0}' class='{1} {2} {3}'></div>";w.vDh="<div id='{0}' class='{1} {2} {3} {4}'></div>";
w.Ajf="[@";w.j3g=1;w.i3g=3;w.pch=500;w.Wof=50;Object(d.a)(w,"FormulaAssistanceConstants",null,[]);var r=a(14),u=a(282),y=a(8),x=a(5),B=a(90),z=a(11),A=a(21),I=a(351),F=a(433),U=a(349);const X=(la,jb,ra)=>{if(la){const hb=la.da.za(491);hb?hb.r9.argumentAssistanceLearnMoreCounter++:l.ULS.sendTraceTag(523551513,0,50,"FormulaAssistanceExtensions: logHelpLinkClick getService returned a null formulaAssistanceManager");ra?S(la,jb,ra):(ra=new B.a(-859308420,n.a.Eb,la.Mc,0,null),la.Ka.Mb(ra,{[n.a.Pc]:x.a.oQ,
[n.a.Zf]:"HelpID="+jb}))}},S=(la,jb,ra)=>{if(ra){if(jb&&(!jb||jb.startsWith("http://")||jb.startsWith("https://"))){if(la.ma(156)&&(la=Object(F.a)({nDb:269,new:U.a,registry:la.da}))&&la.Wna(jb))return;z.HelperMethods.Ve(jb,"_blank",I.a)}}else z.HelperMethods.pV(la.mG,"XLWAEndUser_"+jb,la.$R)},H=la=>{let jb=y.a.XZ;const ra=la.da.za(368);ra&&!A.g(la).lm&&(jb=ra.zoom);return jb};var D=a(33),J;(function(la){la.CategoryList="categoryList";la.FunctionsMap="functionsMap";la.FunctionIdsToDisplay="functionIdsToDisplay";
la.RefreshListCallback="refreshListCallback";la.HelpCallback="helpCallback";la.InitialCategory="initialCategory";la.AllCategoryName="allFunctionsCategoryName"})(J||(J={}));Object(d.b)("PropsKeys",J);class M extends u.a{constructor(la){super(la);this.YTe=(jb,ra)=>{1===jb&&(this.hide(),jb={[n.a.Pc]:ra.functionName,["ibdk"]:!0},ra=D.a.nwa(this.$)?1117706454:-433697611,ra=new B.a(ra,0,this.$.Mc,8,null),this.$.Ka.Mb(ra,jb))};this.onFunctionInfoLoaded=()=>{this.functionInfoManager.Rab(this.onFunctionInfoLoaded);
this.s9e()};this.a5h=jb=>{S(this.$,jb,!1)};this.qef=jb=>!this.functionInfoManager.lfc(jb);this.Gl=r.a.instance.ga(1033);this.functionInfoManager=la.da.za(19);this.vg()}get oc(){return"FunctionDialog"}vg(){this.functionInfoManager.z1a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0);this.Rb=1;this.functionInfoManager.qZ?this.s9e():this.functionInfoManager.aYa(this.onFunctionInfoLoaded)}s9e(){var la;this.dZb=this.functionInfoManager.q9b.filter(this.qef);const jb=null!==(la=M.uif)&&void 0!==
la?la:M.u_g;la=this.functionInfoManager.Tad;const ra=this.functionInfoManager.J$b(jb).map(hb=>hb.FunctionIndex);this.Cx={[M.Tu]:this.oc,[J.CategoryList]:la,[J.FunctionsMap]:this.Y5g(),[J.FunctionIdsToDisplay]:ra,[J.RefreshListCallback]:this.mMi.bind(this),[J.HelpCallback]:this.a5h,[J.InitialCategory]:jb,[J.AllCategoryName]:M.AllCategoryName};this.initializeAndShow(this.Gl,this.YTe,this.Cx)}Y5g(){let la={};this.dZb.forEach(jb=>{la[jb.FunctionIndex]=jb});return la}RQj(la){la=la.map(jb=>jb.FunctionIndex);
this.Cx[J.FunctionIdsToDisplay]=la;this.kTa(this.Gl,this.R3a(this.YTe),this.Cx)}mMi(la,jb){jb?jb=this.bzh(jb):(jb=this.functionInfoManager.J$b(la).filter(this.qef),M.uif=la);this.RQj(jb)}bzh(la=""){la=la.toLocaleLowerCase();const jb=this.dZb.filter(({NameUI:ra})=>ra.toLocaleLowerCase().startsWith(la));3<=la.length&&(jb.push(...this.dZb.filter(ra=>ra.NameUI.toLocaleLowerCase().includes(la)&&!jb.includes(ra))),jb.push(...this.dZb.filter(ra=>ra.Help.toLocaleLowerCase().includes(la)&&!jb.includes(ra))));
return jb}}M.AllCategoryName=r.a.instance.ga(1032);M.u_g=r.a.instance.ga(1031);M.uif=void 0;Object(d.a)(M,"FunctionDialog",u.a,[]);var G=a(97),T=a(55),K=a(64),L=a(86),V=a(27),W=a(210),da=a(72),qa=a(117),O=a(224),ea=a(54),R=a(724),oa=a(12),pa=a(71),Pa=a(1);const Z=da.a.onh,Ra=da.a.RLe,Ga=da.a.SLe,Ba=da.a.b8c,fa=da.a.qnh,Y=da.a.unh,ja=da.a.OLe,ca=da.a.VLe,aa=da.a.snh,ta=da.a.PLe;class xa extends W.a{constructor(la,jb){super(la,r.a.instance.ga(1033),void 0,void 0,void 0,Pa.EwaSettings.ma(395));this.Rtb=
this.Dkf=this.eUe=this.bUe=this.Iia=this.aUe=this.Ttb=this.hJa=this.Jia=this.iJa=null;this.Uhd=!1;this.Hwb=this.h5=this.D0b=null;this.onFunctionInfoLoaded=()=>{if(!this.hJa.count){const ra=this.functionInfoManager.Tad;for(let hb=0,Eb=ra.length;hb<Eb;++hb)this.hJa.YL(ra[hb],ra[hb],!1).className=da.a.pnh;this.hJa.selectedIndex=0;L.a.qc([this.D0b,this.h5,this.Hwb]);this.D0b=this.ue.Zd(this.iJa);this.h5=this.ue.Zd(this.Jia);this.Hwb=this.ue.Zd(this.Rtb);this.D0b.ka("change",this.Owf);this.h5.ka("change",
this.LJi);this.h5.ka("dblclick",this.MJi);this.Hwb.ka("click",this.Yba);this.Hwb.ka("keyup",this.SLi);oa.DOMElementExtensions.setVisible(this.Jia,!0);oa.DOMElementExtensions.setVisible(this.aUe,!1);this.$.h4c&&oa.DOMElementExtensions.setVisible(this.Dkf,!0)}this.Owf(null);this.getButton(0).get_element().disabled=!1;this.iJa.disabled=!1;this.cRa();this.Uhd=!0};this.Yba=()=>{this.l$&&X(this.$,this.l$.HelpId,this.l$.IsDynamicUdf)};this.SLi=ra=>{13!==ra.keyCode&&32!==ra.keyCode||this.Yba(ra)};this.Owf=
()=>{const ra=this.functionInfoManager.J$b(this.hJa.ee.value);this.qua(ra);this.Jia.scrollTop=0;this.sYf()};this.LJi=()=>{this.sYf()};this.MJi=ra=>{this.l$&&(pa.g(ra),this.close(0))};this.Xc=(ra,hb)=>{O.b(hb)&&this.Pu()};this.functionInfoManager=la.da.za(19);this.formulaAssistanceControl=la.da.za(221);if(this.Itb=D.a.SU(this.$))this.formulaAssistanceManager=la.da.za(464);this.vM=jb}get oc(){return"FunctionDeprecatedDialog"}get l$(){if(!this.Jia||!this.Jia.firstChild)return null;const la=Number.parseInvariant(this.Jia.children[this.Jia.selectedIndex].value);
return this.functionInfoManager.lOh(la)}initialize(){this.Lb.classList.add(da.a.mnh);this.Lb.innerHTML=xa.$G();this.Pe||(this.hn(),this.T8());super.initialize();const la=oa.DOMElementExtensions.Kj(this.Lb,ta);this.rtl&&(la.align="right",this.Rtb.style.marginLeft="5px");this.Pe&&(la.style.padding="1px");this.functionInfoManager.z1a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)}dispose(){this.functionInfoManager&&(this.functionInfoManager.Rab(this.onFunctionInfoLoaded),this.functionInfoManager.$.ea.Ik(this.Xc));
L.a.qc([this.D0b,this.h5,this.Hwb,this.hJa,this.Ttb]);super.dispose()}hn(){this.iJa=oa.DOMElementExtensions.Kj(this.Lb,Z);this.Jia=oa.DOMElementExtensions.Kj(this.Lb,Ra);this.iJa.setAttribute(x.a.Kd,x.a.FZb);this.hJa=new R.a(this.iJa,!0);this.Ttb=new R.a(this.Jia,!0);this.aUe=oa.DOMElementExtensions.Kj(this.Lb,Y);this.Rtb=oa.DOMElementExtensions.Kj(this.Lb,fa);this.eUe=oa.DOMElementExtensions.Kj(this.Lb,ca);this.Dkf=oa.DOMElementExtensions.Kj(this.Lb,aa);this.bUe=$get(xa.Vad,this.Lb);this.Iia=oa.DOMElementExtensions.Kj(this.Lb,
ja);this.Pe&&(this.Iia.style.paddingLeft="1px");this.functionInfoManager.aYa(this.onFunctionInfoLoaded);this.functionInfoManager.$.ea.jk(this.Xc)}sQ(la){this.$.da.Za(40,()=>{this.hJa.sQ(la)})}Fo(){this.Itb?this.formulaAssistanceManager.t5b():this.formulaAssistanceControl.set_visible(!1);super.Fo();this.Uhd||(this.getButton(0).get_element().disabled=!0)}setFocus(){!this.iJa.disabled&&this.Uhd&&oa.DOMElementExtensions.setFocus(this.iJa)}commit(){return!0}Opb(){let la=this.l$.NameDataStrings;const jb=
new B.a(-433697611,0,this.$.Mc,8,null);this.$.Ka.Mb(jb,{[n.a.Pc]:la})}Zra(){this.Itb?this.formulaAssistanceManager.Uca():this.formulaAssistanceControl.Enb()}qua(la){this.Ttb.clear();const jb=xa.Vad+" "+xa.WTe;for(let ra=0,hb=la.length;ra<hb;++ra){const Eb=this.Ttb.YL(la[ra].NameUI,la[ra].FunctionIndex.toString(),!1);V.a.kv&&Eb.classList.add(Ba);Eb.setAttribute(x.a.pE,xa.XTe);Eb.setAttribute(x.a.QG,jb)}this.Ttb.selectedIndex=0}sYf(){if(this.l$){this.Rtb.parentNode.className=da.a.PLe+(this.functionInfoManager.lfc(this.l$)?
"-udf":"");var la=this.l$.NameDataStrings;this.eUe.innerText=la;this.Rtb.innerText=la;this.Iia.innerText=this.l$.Help;la=this.l$.Params.split(w.d9c);this.bUe.innerText=w.openParen+(1<la.length?w.p6b:la[0])+w.closeParen}}static $G(){return String.format("<div class='"+da.a.nnh+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+qa.a.Mn+"'>{1}</div>\r\n<div class='"+da.a.NLe+"'>\r\n\t<select id='{16}' class='{17} "+m.a.Np+" "+
m.a.Zo+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+da.a.rnh+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+m.a.Np+"'>\r\n\t\t\t<span class='"+m.a.PA+" "+da.a.tnh+"'>\r\n\t\t\t\t<img title='{3}' class='"+m.a.Ssh+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",
r.a.instance.ga(1036),r.a.instance.ga(1037),r.a.instance.ga(741),r.a.instance.ob(3),ea.a.hf(13),r.a.instance.ga(1038),xa.uDh,xa.Vad,7,Z,fa,Y,ja,ca,aa,ta,xa.yDh,Ra+(V.a.kv?" "+Ga:""),xa.WTe,xa.XTe)}}xa.Vad="function_dialog_param_string";xa.WTe="function_dialog_function_description";xa.XTe="function_dialog_function_name";xa.yDh="function_list";xa.uDh="function_category";Object(d.a)(xa,"FunctionDeprecatedDialog",W.a,[]);var ia=a(260);class ya extends u.a{constructor(la,jb){super(la);this.p9b=jb;this.rDh=
(ra,hb)=>{var Eb;1===ra&&(this.hide(),ra={[n.a.Pc]:this.p9b.NameUI,["functionArgs"]:null!==(Eb=hb.functionArgs)&&void 0!==Eb?Eb:[],["ibdk"]:!0},Eb=new B.a(-433697611,0,this.$.Mc,8,null),this.$.Ka.Mb(Eb,ra))};this.nHh=ra=>({name:"argument_"+ra,description:"mock argument description. she sells sea shells at the sea shore shop",type:"number"});this.Gl=r.a.instance.ga(1034);this.vg()}get oc(){return"FunctionArgumentsDialog"}vg(){this.Rb=1;this.Cx={[ia.a.Tu]:this.oc,["functionInfo"]:this.p9b,["initialArgs"]:this.oHh(this.p9b),
["evaluateCallback"]:this.PSg,["generateArgByIndex"]:this.nHh,["helpCallback"]:this.pV,["isModal"]:!1};this.initializeAndShow(this.Gl,this.rDh,this.Cx)}pV(){S(this.$,this.p9b.HelpId,!1)}PSg(){return"42"}oHh(la){return ib(la)}}Object(d.a)(ya,"FunctionArgumentsDialog",u.a,[]);const ib=la=>la.Params.split("!")[0].split(",").map(jb=>({name:jb,description:`Mock description for param ${jb}. How Mmuch wood would a wood chuck chuck if a wood chuck would chuck wood`,type:"text"}));class wa{constructor(la,
jb,ra){this.$=la;this.Sa=jb;this.functionInfoManager=ra;this.wDh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=null;this.onFunctionInfoLoaded=()=>{this.menuId&&this.wDh.includes(this.menuId)&&this.frame.Qw(this.menuId)};this.SU=D.a.SU(this.$);this.nwa=D.a.nwa(this.$);this.qki=D.a.aod();this.SU&&(this.formulaAssistanceManager=this.$.da.za(464));this.RX={};this.frame=this.$.frame;this.functionInfoManager.aYa(this.onFunctionInfoLoaded);
this.formulaAssistanceTelemetryManager=la.da.za(491)}Nc(la,jb){switch(jb){case 753860909:case -2060563418:case 1117706454:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return la=A.g(this.$).Di,la.a5a||!la.eb||0>=la.text.length?!1:!0;default:return!1}}executeCommand(la,jb,ra){var hb,Eb;la=jb.command;const fc=A.g(this.$),Mc=fc.Di;switch(la){case 753860909:case -2060563418:null===
(hb=this.formulaAssistanceManager)||void 0===hb?void 0:hb.t5b();fc.inRangePicker&&Mc.rC(!1);this.qki?new M(this.$):(new xa(this.$,Mc)).Ff();this.formulaAssistanceTelemetryManager.H2a.dialogShownCounter++;break;case 1117706454:null===(Eb=this.formulaAssistanceManager)||void 0===Eb?void 0:Eb.t5b();fc.inRangePicker&&Mc.rC(!1);hb=this.functionInfoManager.mOh(ra[n.a.Pc]);new ya(this.$,hb);ra.ibdk?this.formulaAssistanceTelemetryManager.H2a.argsDialogOpenedByDialogCounter++:this.formulaAssistanceTelemetryManager.H2a.argsDialogOpenedByRibbonCounter++;
break;case -433697611:ra.ibdk&&(this.nwa?this.formulaAssistanceTelemetryManager.H2a.argsDialogCommitedCounter++:this.formulaAssistanceTelemetryManager.H2a.dialogCommitedCounter++);let xd=ra[n.a.Pc]+w.openParen;this.nwa&&(xd+=ra.functionArgs.join(this.$.listSeparator)+w.closeParen);ra.UILocation&&this.$.ud(-1075437823,-1,0,null);fc.view.visibleArea.contains(fc.mg(null))||fc.dt(fc.ha.sa.activeCell,3,G.a.wCh);const Hd=Mc.textBox;ra=Mc.textBox.caretPosition;Mc.eb&&Mc.text?(hb=Mc.text,Eb=ra?hb.substring(0,
ra):"=",Mc.text=Eb+xd+hb.substring(ra+(Hd.ty?Hd.ty.length:0),hb.length),Hd.caretPosition=Eb.length+xd.length):k.TaskExtensions.Aa(fc.startEdit(!0,1),()=>{Mc.text="="+xd;if(this.nwa)fc.endEdit(!0,"FormulaAssistanceCommandHandler.ExecuteCommand");else{const Md=xd.length+1;Hd.kcb(Md);Hd.caretPosition=Md}},this.$.la,11,K.a.current);fc.lm&&(ra=fc.Xb,ra.text=Hd.text,ra.setCaretPosition(Hd.caretPosition));this.SU?this.formulaAssistanceManager.Uca():(ra=Mc.U1.get(v.a.Stb),null===ra||void 0===ra?void 0:ra.ZX(!1))}return T.Task.Ta(!0)}Cc(la,
jb){switch(jb.command){case 753860909:case -2060563418:case -433697611:return!0;case 1117706454:return this.nwa;default:return!1}}tEh(la,jb){jb=this.Sa.sq(jb);const ra=this.Sa.zc();var hb=this.functionInfoManager.J$b(la);if(!hb)return l.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),jb.rE();const Eb=this.nwa?1117706454:-433697611;for(let fc=0;fc<hb.length;++fc){const Mc=hb[fc].NameUI,xd=this.Sa.EP(280,"Formulas."+la+"MenuItem_"+hb[fc].FunctionIndex.toString(),
Eb,null,1,"None",0,0,Mc,!1,0);xd.label=Mc;const Hd=hb[fc].Params.split(w.d9c);xd.FR(Mc+" "+(w.openParen+(1<Hd.length?w.p6b:Hd[0])+w.closeParen)+"\n"+hb[fc].Help);ra.buttons.push(xd)}la=this.Sa.zc();hb=this.Sa.EP(280,"Formulas.MoreFunctionsMenuItem",-2060563418,m.a.cPe,3,"Image16by16",1035,0,"Formulas.MoreFunctionsMenuItem",!1,0);la.buttons.push(hb);jb.nc.push(ra);jb.nc.push(la);return jb.rE()}Rc(la,jb,ra){la=this.kOh(jb);if(-1===la)return!1;this.menuId=ra.MenuId;if(!this.functionInfoManager.qZ)return this.functionInfoManager.z1a({Filter:null,
FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;la=this.functionInfoManager.Tad[la];this.RX[la]=this.RX[la]||this.tEh(la,ra.MenuId);ra.MenuItems=this.RX[la];return!0}kOh(la){switch(la){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;
case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}}}Object(d.a)(wa,"FormulaAssistanceCommandHandler",null,[195]);class sa extends f.a{constructor(la){super(la)}yd(){const la=e.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb),jb=e.GetServiceTaskFactory.create(this.$.da,153,this.la,this.hb);k.TaskExtensions.Aa(k.TaskExtensions.Wd([la,jb],this.la),()=>{this.gd([new wa(this.$,la.result,jb.result)])},this.la,3)}static ka(la){f.a.Nd(92,new sa(la))}}
Object(d.a)(sa,"FormulaAssistanceCommandHandlerFactory",f.a,[]);var Ya=a(221),bb=a(22);class mb{constructor(la,jb){this.jJa=this.kua=this.Dia=null;this.wAf=(ra,hb)=>{this.P4i(hb.functionName,hb.Zad)};this.yAf=(ra,hb)=>{this.O4i(hb.Zad,hb.qMd,hb.uVi)};this.xAf=(ra,hb)=>{ra=[];for(var Eb of hb.qMd)(!this.Uva||void 0!==Eb&&null!==Eb)&&(hb=Eb.trim())&&ra.push(hb);if(!this.Uva||ra.length){Eb="";for(hb=0;hb<ra.length;hb++){const fc=this.HXc(ra[hb]),Mc=mb.$Cd(hb,ra.length);Eb+=fc+Mc;Mc&&(Eb+=this.ariaLiveNotifier.kxa)}this.ariaLiveNotifier.readText(Eb)}};
this.zAf=(ra,hb)=>{this.ariaLiveNotifier.R4i(hb.YF,hb.description,hb.selectedIndex.toString(),hb.length.toString())};this.sAf=(ra,hb)=>{this.ariaLiveNotifier.yLf(hb.description,hb.length)};this.Iwf=()=>{this.ariaLiveNotifier.mab(r.a.instance.ga(887),x.a.TYa)};this.Bwf=()=>{this.ariaLiveNotifier.readText(r.a.instance.ga(888))};this.Ewf=()=>{this.ariaLiveNotifier.readText(r.a.instance.ga(889))};this.$=jb;this.ariaLiveNotifier=la;this.$.da.Ga(219,this);this.Uva=D.a.a4()}dispose(){this.UWd();this.jJa=
this.kua=this.Dia=null}fWc(la){la&&(this.Dia=la,this.Dia.kme(this.wAf),this.Dia.$me(this.yAf),this.Uva&&this.Dia.Zme(this.xAf))}gWc(la){la&&(this.kua=la,this.Uva&&(this.kua.ime(this.Iwf),this.kua.gme(this.Bwf)),this.kua.hme(this.Ewf))}hWc(la){la&&(this.jJa=la,this.jJa.lUc(this.zAf),this.jJa.pYb(this.sAf))}UWd(){var la,jb,ra;this.Dia&&(this.Dia.IPf(this.wAf),this.Dia.gQf(this.yAf),this.Uva&&this.Dia.fQf(this.xAf));this.jJa&&(this.jJa.JId(this.zAf),this.jJa.Brc(this.sAf));this.Uva&&(null===(la=this.kua)||
void 0===la?void 0:la.HPf(this.Iwf),null===(jb=this.kua)||void 0===jb?void 0:jb.FPf(this.Bwf));null===(ra=this.kua)||void 0===ra?void 0:ra.GPf(this.Ewf)}P4i(la,jb){if(jb){let ra="";this.Uva||(ra+=r.a.instance.ob(57)+this.ariaLiveNotifier.kxa);for(let hb=0;hb<jb.length;hb++)ra+=la+this.ariaLiveNotifier.kxa+this.HXc(jb[hb])+mb.$Cd(hb,jb.length);this.Uva&&(ra+=r.a.instance.ga(886)+this.ariaLiveNotifier.kxa);this.ariaLiveNotifier.readText(ra)}}O4i(la,jb,ra){if(la){let Eb="",fc=0;if(jb){for(let Mc=0;Mc<
jb.length;Mc++){if(ra>=la[Mc].split(this.$.listSeparator).length){fc++;continue}var hb=jb[Mc].trim();if(!hb)return;hb=this.HXc(hb);const xd=mb.$Cd(Mc-fc,jb.length-fc);Eb+=hb+xd;xd&&(Eb+=this.ariaLiveNotifier.kxa)}this.ariaLiveNotifier.readText(Eb)}}}HXc(la){if(!la)return"";var jb=la.split(this.$.listSeparator);la="";for(const ra of jb){if(mb.Cmd(ra))la+=ra;else{const hb=(jb=mb.mji(ra))?ra.replace("[","").replace("]",""):ra;la+=String.format(jb?r.a.instance.ob(59):r.a.instance.ob(58),hb)}la+=this.ariaLiveNotifier.kxa}return la}static $Cd(la,
jb){return la>=jb||1===jb?(l.ULS.shipAssertTag(537161997,0,la<jb,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""):String.format(r.a.instance.ob(55),la+1,jb)+"\r\n"}static Cmd(la){return bb.a.contains(la,w.p6b,!0)}static mji(la){return la.trimStart().startsWith(w.yEf)||la.trimEnd().endsWith(w.xEf)}}Object(d.a)(mb,"FormulaAssistanceReadoutHandler",null,[672,2]);class Ca extends Ya.a{constructor(la){super();this.$=la;this.Fb()}create(){const la=this.$.da;k.TaskExtensions.Aa(e.GetServiceTaskFactory.Ra(la,
211,212,this.hb),jb=>{jb=la.za(219)||new mb(jb.result,this.$);this.qb(jb)},this.la,3)}static ka(la){la.da.Ga(220,new Ca(la))}}Object(d.a)(Ca,"FormulaAssistanceReadoutHandlerFactory",Ya.a,[]);var $a=a(638),Kb=a(110),rb=a(977),cc=a(58),nc=a(43),Wb=a(121);class Ea{constructor(){this.hQa={}}zfd(la){return this.hQa&&la in this.hQa?this.hQa[la]:null}h6f(la,jb){this.hQa||(this.hQa={});this.hQa[la]=jb}gZ(){this.hQa=null}}Object(d.a)(Ea,"FormulaAssistanceContextualPreviewCache",null,[]);var ua=a(61);const ma=
(la,jb,ra,hb,Eb,fc,Mc=null)=>{Mc=la.Na(1,Mc);Mc.getPartialCalcResultsParameters=jb;return ua.g(la,"GetPartialCalcResults",Mc,ra,hb,Eb,fc,4)};class fb{constructor(la){this.vyi=30;this.calcManager=null;this.zd=!1;this.yOa=this.AFb=this.m$a=null;this.gy=()=>{this.Tga.gZ()};this.$=la;this.Tga=new Ea;this.fSf=-1;this.$.ea.kE(this.gy)}dispose(){this.zd||(this.$&&(this.$.ea.BD(this.gy),this.$=null),this.Tga=this.AFb=null,this.zd=!0)}ncd(la,jb,ra,hb){if(jb&&0>=jb.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");
if(!la)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=this.$.da.za(266);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");let Eb="="+jb.substring(ra.start,ra.end);Pa.EwaSettings.ma(587)&&(Eb=this.calcManager.pXh(A.g(this.$).ha.sa.activeCell,la,ra));const fc=this.uKh(Eb,ra);if(Pa.EwaSettings.ma(587)){if(fc&&!this.calcManager.isFormulaSubExpressionVolatile(la))return Promise.resolve(fc)}else if(fc)return Promise.resolve(fc);
return this.wKh(Eb,ra).then(Mc=>{if(this.PZc(hb))throw Error.create("OperationCanceledException");if(!Mc||Mc.Ngj||Mc.xma.startsWith("##UNSUPPORTED:"))return this.IWe(jb,Eb,ra,hb);this.Tga.h6f(Eb,Mc.xma);return Promise.resolve(Mc)})}uKh(la,jb){return(la=this.Tga.zfd(la))?new rb.a(la,jb.start,jb.end,0):null}wKh(la,jb){if(!la||0>=la.length||!jb)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.NSg(A.g(this.$).ha.sa.activeCell,
la,this.vyi,jb)}IWe(la,jb,ra,hb){if(!la||0>=la.length||!jb||0>=jb.length||!ra)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");if(this.yOa)return this.vKh(la,jb,ra,hb);const Eb={};Eb.PartialFormula=jb;Eb.Formula=la;Eb.SourceRange=nc.v(A.g(this.$).ha.sa.activeCell,this.$);return this.yOa=new Promise((fc,Mc)=>{this.AFb=new $a.a;this.fSf=this.$.ea.Ke;this.m$a=ma(this.$.oa.va,Eb,xd=>{this.oTi(jb,ra,hb,xd,fc,Mc)},xd=>{this.m$a=
this.yOa=null;Mc(xd)},null,null,null);this.AFb.token.register(()=>{this.pUg(Mc)})})}oTi(la,jb,ra,hb,Eb,fc){this.m$a=this.yOa=null;if(this.fSf!==this.$.ea.Ke)fc(Error.create("OperationCanceledException"));else if(hb.Result)if(hb=cc.a.Vh(hb.Result),!hb||Kb.a.isEmpty(hb))Eb(null);else{for(let Mc in hb)this.Tga.h6f(Mc,hb[Mc]);this.PZc(ra)?fc(Error.create("OperationCanceledException")):(la=this.Tga.zfd(la))?(""===la&&(la=" "),Eb(new rb.a(la,jb.start,jb.end,0))):fc(Error.create("SubexpressionNotFoundException"))}else Eb(null)}vKh(la,
jb,ra,hb){return new Promise((Eb,fc)=>{this.yOa.then(()=>{this.SSf(la,jb,ra,hb,Eb,fc)}).catch(()=>{this.SSf(la,jb,ra,hb,Eb,fc)})})}SSf(la,jb,ra,hb,Eb,fc){if(this.PZc(hb))fc(Error.create("OperationCanceledException"));else{const Mc=this.Tga.zfd(jb);Mc?Eb(new rb.a(Mc,ra.start,ra.end,0)):this.IWe(la,jb,ra,hb).then(xd=>{Eb(xd)}).catch(xd=>{fc(xd)})}}pUg(la){this.m$a&&(Wb.a.tu(this.m$a.Nt)?(this.yOa=this.m$a=null,la(Error.create("PendingWebReqeuestCancelled"))):l.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))}gZ(){this.qUg();
this.Tga&&this.Tga.gZ()}qUg(){this.AFb&&this.AFb.cancel()}PZc(la){return this.zd||la.kK}}Object(d.a)(fb,"FormulaAssistanceContextualPreviewCalculator",null,[2]);var sb=a(155),Ua=a(213);class ab{}ab.coh="ewa-facp-text-box";Object(d.a)(ab,"CssClassNames",null,[]);class na{constructor(la){this.Wpa=this.tSa=this.I1a=this.BP=this.d$=this.Ya=null;this.Fhd=!1;this.Jc=la}dispose(){(this.d$||this.BP)&&this.X6e();this.Ya=this.Wpa=null}DQj(la,jb,ra,hb){la&&jb&&hb&&jb.xma&&!(1>jb.xma.length)&&(this.Ya=la,this.JOf(),
this.I1a=jb,this.tSa=hb,this.Wyj(jb,ra,hb))}X6e(){this.m5h();this.JOf();this.tSa=this.I1a=null}Wyj(la,jb,ra){if(la.xma&&!(1>la.xma.length)){var hb=this.Jc.da.za(266);if(hb){var Eb=hb.xQh();Eb&&k.TaskExtensions.Aa(this.nBb,()=>{if(jb)if(Pa.EwaSettings.ma(587)&&this.Ya.eb&&0<ra.length){this.Twb(la.fJa,ra[0].start,null);var fc=this.S1e(ra[0],Eb),Mc=this.Ya.text.substring(ra[0].start,ra[0].end).trim();Mc=this.Ya.text.indexOf(Mc);Mc=this.Ya.text.substring(0,Mc).lastIndexOf("\n");this.Twb(0>Mc||1>=ra.length?
ra[0].start:Mc+1,ra[0].end,fc?String.format(fc,.3):null);for(var xd=1;xd<ra.length;xd++)fc=this.S1e(ra[xd],Eb),Mc=this.Ya.text.substring(ra[xd].start,ra[xd].end).trim(),Mc=this.Ya.text.indexOf(Mc),Mc=this.Ya.text.substring(ra[xd-1].end,Mc).lastIndexOf("\n"),this.Twb(0>Mc?ra[xd-1].end:Mc+1+ra[xd-1].end,ra[xd].end,fc?String.format(fc,.3):null);Mc=this.Ya.text.substring(ra[ra.length-1].end,la.mua).indexOf("\n");this.Twb(0>Mc?ra[ra.length-1].end:Mc+1+ra[ra.length-1].end,la.mua,null);l.ULS.sendTraceTag(537162061,
0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else this.Twb(la.fJa,la.mua,null),l.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");this.d$||(this.d$=document.createElement(Ua.a.div),this.Ya.textBox.domElement.appendChild(this.d$));this.BP||(this.BP=document.createElement(Ua.a.div),this.BP.className=
ab.coh,this.Jc.domElement.appendChild(this.BP));fc=la.mua;Pa.EwaSettings.ma(587)&&this.Ya.eb&&ra&&0<ra.length&&ra[0].start<fc&&ra[0].start!==la.fJa&&!this.Ya.textBox.ty.length&&(fc=ra[0].start);xd=bb.a.contains(this.Ya.textBox.Se.id,"FormulaBar",!0)&&bb.a.contains(this.Ya.text.substring(la.fJa,la.mua),"\n",!0);Mc=this.Ya.eb?this.Ya.textBox.caretPosition:0;fc=excelOnline.utils.getBoundingRectForText(this.Ya.textBox.Se,xd?Mc:la.fJa,xd?Mc:fc,Pa.EwaSettings.ma(587));this.BP.style.left=z.HelperMethods.pc(fc.left);
this.BP.style.top=z.HelperMethods.pc(fc.top);this.BP.style.width=z.HelperMethods.pc(fc.width);this.BP.style.height=z.HelperMethods.pc(fc.height);dialogControls.renderToolTip(this.d$,`FormulaAssistancePreviewToolTip_${la.mua}_${la.mua}`,la.xma,this.BP,0,!1,!1,1)},this.Jc.la,3)}}}S1e(la,jb){const ra=this.Ya.text;var hb=ra.substring(la.start,la.end);hb=hb.trim();la=ra.indexOf(hb,la.start);jb=ra.indexOf(jb,la);hb=ra.substring(la,jb);hb=hb.trim();return this.Ya.colors.getItem(la+"-"+(la+hb.length))}m5h(){this.Ya&&
this.d$&&this.BP&&k.TaskExtensions.Aa(this.nBb,()=>{this.Ya.textBox.domElement.contains(this.d$)&&(dialogControls.clearToolTip(this.d$),this.Ya.textBox.domElement.removeChild(this.d$),this.d$=null);this.Jc.domElement.contains(this.BP)&&(this.Jc.domElement.removeChild(this.BP),this.BP=null)},this.Jc.la,3)}Twb(la,jb,ra){!this.Ya||la>=jb||(this.Ya.textBox.formatText(la,jb-la,{["background"]:ra||"#E3DDCC"}),this.Fhd=!0)}JOf(){if(this.Ya&&this.I1a&&this.Fhd){var la=this.I1a.mua;Pa.EwaSettings.ma(587)&&
0<this.tSa.length&&this.tSa[this.tSa.length-1].end>la&&(la=this.tSa[this.tSa.length-1].end);this.Ya.textBox.formatText(this.I1a.fJa,la-this.I1a.fJa,{["background"]:!1});this.Fhd=!1}}get nBb(){if(this.Wpa)return this.Wpa;const la=new sb.a;this.Jc.Qx(jb=>{k.TaskExtensions.Aa(jb.tsd(),()=>{la.setResult(!0)},this.Jc.la,3)});return this.Wpa=la.task}}Object(d.a)(na,"FormulaAssistanceContextualPreviewControl",null,[2]);var Na=a(84),Va=a(47),Sa=a(45);class vb{constructor(la){this.c7=0;this.Aad=la}x2f(la,
jb,ra){ra?this.g5g(la,jb,ra):this.c4e(la,jb,ra,!0)}ofj(){this.c7=0}g5g(la,jb,ra){this.c7++;const hb=this.c7;Va.a.instance.create(()=>{this.c4e(la,jb,ra,hb===this.c7)},500,Sa.a.xCh,!0,!0)}c4e(la,jb,ra,hb){const Eb=this.Aad.ncd(la,jb);Eb&&Eb.then(fc=>{hb&&this.Aad.ond(jb)&&this.Aad.CQj(la,fc,ra)}).catch(fc=>{fc=Object(Na.a)(Error,fc);"OperationCanceledException"===fc.message?l.ULS.sendTraceTag(537162059,0,50,`GetContextualFormulaPreviewResults - caught exception: ${fc}`):l.ULS.sendTraceTag(537162058,
0,10,`GetContextualFormulaPreviewResults - caught exception: ${fc}`)})}}Object(d.a)(vb,"FormulaAssistanceContextualPreviewHoverManager",null,[]);var Oa=a(200);class yb{constructor(la){this.Tqb=this.Rga=this.calcManager=this.Ya=null;this.h9a=()=>{this.G4a(!1,!1)};this.$=la;this.Htb=new na(la);this.f9b=new fb(la);this.g9b=new vb(this);A.g(la).Xb.em(this.h9a);this.$.da.Ga(317,this)}dispose(){this.LYc();L.a.qc([this.Htb,this.f9b]);this.g9b=this.f9b=this.Htb=null;this.$&&A.g(this.$).Xb.yl(this.h9a);this.Rga=
this.Ya=this.$=null}Xyj(la,jb){jb&&Oa.f(jb.text)&&!(jb.gwa||jb.textBox.ty||this.Ya&&this.Ya.textBox.ty)&&(this.Ya=jb,this.calcManager=this.$.da.za(266))&&(l.ULS.sendTraceTag(537162056,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),la=z.HelperMethods.qub(la),la=this.calcManager.mXh(A.g(this.$).ha.sa.activeCell,this.Ya.text,la.x,la.y),jb=this.calcManager.getSubExpressionSpan(la),!jb||jb.end<=jb.start||this.ond(jb)||
(this.Rga=jb,this.g9b.x2f(la,jb,!0)))}YQd(la){if(la&&Oa.f(la.text))if(la.textBox.ty&&la.textBox.ty.trim()){if(this.Ya=la,this.calcManager=this.$.da.za(266)){l.ULS.sendTraceTag(537162054,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");la={};var jb=this.Ya.textBox.ty.trim();la.start=this.Ya.text.indexOf(jb,this.Ya.textBox.caretPosition);la.end=la.start+jb.length;(jb=this.calcManager.getFormulaSubExpressionObject(A.g(this.$).ha.sa.activeCell,
this.Ya.text,this.Ya.textBox.ty))&&!this.ond(la)&&(this.Rga=la,this.g9b.x2f(jb,la,!1))}}else this.G4a(!1,!0)}G4a(la,jb){!this.Ya||jb&&this.Ya.textBox.ty||(this.Rga=null,la&&(this.LYc(),this.f9b.gZ(),this.g9b.ofj()),this.Htb&&this.Htb.X6e(),this.Ya.gwa||(this.Ya.gwa=!1,this.Ya=null))}ncd(la,jb){if(!this.Ya||this.Ya.gwa)return null;this.LYc();this.Tqb=new $a.a;return this.f9b.ncd(la,this.Ya.text,jb,this.Tqb.token)}CQj(la,jb,ra){this.Tqb=null;!la||!jb||!jb.xma||0>=jb.xma.length?this.G4a(!1,!1):(la=this.calcManager.nXh(A.g(this.$).ha.sa.activeCell,
la,this.Ya.text),this.Htb.DQj(this.Ya,jb,ra,la))}ond(la){return this.Rga?la.start===this.Rga.start&&la.end===this.Rga.end&&la.pre===this.Rga.pre&&la.post===this.Rga.post:!1}LYc(){this.Tqb&&this.Tqb.cancel()}}Object(d.a)(yb,"FormulaAssistanceContextualPreviewManager",null,[640,2,641]);var Ob=a(7),Ja=a(4),lb=a(222),Pb=a(13),Jb=a(185),Lb=a(1086),Ab=a(67),nb=a(770),va=a(31),db=a(24),Xa=a(65),gb=a(247),Ha=a(245),tb=a(162);class bc{constructor(la=!1){this.yS=0;this.N7d=!1;this.lVa=this.i9d=null;this.$qg=
la;this.textEdit=null}cZf(la){this.yS=0;this.N7d=la.IsCompatibility;this.set_name(la.NameDataStrings);this.lVa=la.Help}Apj(la){this.yS=1;this.set_name(la.Name)}apj(la){this.yS=2;this.set_name(la.name);this.lVa=la.tooltip}Dqj(la){this.yS=3;this.set_name(la.name);this.lVa=la.toolTip}A_f(la){this.yS=4;this.set_name(la.name)}Usj(la){this.yS=5;this.set_name(la.name);this.lVa=la.toolTip}Tsj(la){this.yS=7;this.set_name(la.name)}srj(){this.yS=6;this.set_name(r.a.instance.ob(191));this.lVa=r.a.instance.ob(192)}get itemType(){return this.yS}get efi(){return this.N7d}get name(){return this.label}set_name(la){return this.i9d=
la}get label(){return this.i9d}get Iia(){return this.lVa}get Fzb(){return this.$qg}static B9g(){return Object(Ob.a)(new bc(!0),{})}}Object(d.a)(bc,"AutoCompleteItem",null,[616]);class tc{constructor(){this.sheetName=this.namedRange=this.tooltip=this.name=null;this.type=0}}Object(d.a)(tc,"DefinedNameInfo",null,[]);var Ma=a(184);class Tb{constructor(la){this.NFe={};this.$=la}get MFe(){const la=[];if(!this.$.zb||!this.$.zb.items)return la;let jb=0;const ra=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&
D.a.SU(this.$);for(const hb of this.$.zb.items)if(hb&&(3===hb.type&&hb.usedRange||ra&&2===hb.type)){const Eb=new tc;Eb.tooltip=hb.sheetName+Ab.a.exclamation+hb.usedRange.toString();Eb.name=hb.name;Eb.namedRange=this.r2g(hb.usedRange);Eb.sheetName=hb.sheetName;Eb.type=this.j2g(hb.type);la.push(Eb);this.NFe[hb.name.toUpperCase()]=Eb;++jb;if(jb===w.Wof){l.ULS.sendTraceTag(537162076,0,15,`Maximum number of defined names reached for formula assistance: ${w.Wof}`);break}}return la}XMj(la){var jb=this.NFe[la.toUpperCase()];
if(!jb)return{returnValue:!1,sheetName:"",range:null};la=jb.sheetName;jb=this.b2g(jb.namedRange);return{returnValue:!0,sheetName:la,range:jb}}r2g(la){if(null!=la&&void 0!=la)return{top:la.top,left:la.left,bottom:la.bottom,right:la.right,maxRows:la.maxRows,maxColumns:la.maxColumns,sheetName:void 0}}b2g(la){if(null!=la&&void 0!=la)return new Ma.a(la.top,la.left,la.bottom,la.right,la.maxRows,la.maxColumns)}j2g(la){switch(la){case 2:return 0;case 3:return 1;default:return-1}}}Object(d.a)(Tb,"DefinedNameInfoManager",
null,[]);var zb=a(128),ic=a(262),Qb=a(259),wb=a(235);class hc extends Sys.EventArgs{constructor(la,jb){super();this.functionName=la;this.Zad=jb}}Object(d.a)(hc,"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);class Za extends Sys.EventArgs{constructor(la){super();this.qMd=la}}Object(d.a)(Za,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);class ub extends Sys.EventArgs{constructor(la,jb,ra){super();this.Zad=la;this.qMd=jb;this.uVi=ra}}Object(d.a)(ub,"FormulaAssitanceSelectedParameterChangedEventArgs",
Sys.EventArgs,[]);var uc=a(258);class Oc{constructor(la,jb,ra,hb,Eb=null){this.Qaa=this.yYc=!1;this.$=la;this.formulaAssistanceUIControl=jb;this.DTe=ra;this.$kj=hb;this.t4e=Eb;this.Qaa=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug")}get kf(){return this.yYc}set kf(la){this.yYc!==la&&(la?uc.a(this.$).Xh(this):uc.a(this.$).Nz(this),this.yYc=la)}get $d(){return this.$kj}get mc(){return this.formulaAssistanceUIControl.getRootElement(this.DTe)}hg(la,jb){la=!1;jb||(A.g(this.$).Di.textBox.kF=
!0,la=this.formulaAssistanceUIControl.focus(this.DTe));return la}kh(la){const jb=this.mc;return!(void 0===jb||null===jb)&&oa.DOMElementExtensions.vf(jb,la)}lj(){this.t4e&&this.t4e();if(this.Qaa){const la=A.g(this.$).Di.textBox;this.selection=la.selection;la.removeSelection()}}Nj(){this.Qaa&&(A.g(this.$).Di.textBox.selection=this.selection)}dispose(){uc.a(this.$).Nz(this)}}Object(d.a)(Oc,"FormulaAssistanceFocusManager",null,[102,2]);var Bb=a(38),Nb=a(368),dc=a(170),sc=a(35),yc=a(281),cd=a(280),pd=
a(909);class Rb extends Bb.a{constructor(la,jb){super();this.Jog=[];this.bbd={};this.cbd={};this.uS=null;this.Y7=[];this.kJa={};this.dxf=(ra,hb)=>{l.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");this.Qwf(ra,!!hb&&1!==hb.FilterType,!0)};this.cxf=()=>{l.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");this.uS=null};this.Nwf=ra=>{l.ULS.sendTraceTag(537161985,
0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");this.CGd(ra.Kia,!0,!1)};this.bxf=ra=>{l.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");this.Qwf(ra,!0,!1)};this.IJc=this.KJc=!1;this.jb=la;this.pluginScheduler=jb;this.$.da.Ga(19,this)}aYa(la){this.addHandler("FunctionInfoLoaded",la)}Rab(la){this.removeHandler("FunctionInfoLoaded",la)}xEg(la){this.addHandler("FunctionInfoReset",la)}Gaj(la){this.removeHandler("FunctionInfoReset",la)}get qZ(){return this.KJc}get Ygi(){return this.IJc}get q9b(){var la=
this.uS,jb=pd.a(this.$);if(!jb)return la;jb=jb.BNh();const ra=jb.length;if(0>=ra)return la;const hb=[];hb.push(...la);for(la=0;la<ra;la++){const Eb=jb[la],fc={};fc.FunctionIndex=hb.length;fc.HelpId=fc.GroupUI=null;fc.Help=Eb.description;fc.IsCommonlyUsed=fc.IsCompatibility=!1;fc.NameDataStrings=Eb.name;fc.NameUI=Eb.name;fc.Params=null;fc.ParamsHelp=null;hb.push(fc)}return hb}get Tad(){return this.Y7}get $(){return this.jb}dispose(){const la=this.$.da.za(268);la&&la.pId(this.Nwf);this.jb=null;super.dispose()}ySf(){this.raiseEvent("FunctionInfoReset")}ZJd(){this.ySf();
this.KJc=!1;this.uS=null;this.IJc=!0}z1a(la,jb=!1){if(this.qZ)this.fKf();else{l.ULS.sendTraceTag(537161991,0,50,`Retrieving the list of function names for culture '${this.$.ya.UICultureTag}' from the server.`);let hb=null;(hb=this.$.da.za(268))||l.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===hb||void 0===hb?0:hb.Kia)&&0<hb.Kia.length)Pa.EwaSettings.ma(121)?hb.$Bh(this.bxf):this.CGd(hb.Kia,!0,!1);else{var ra=this.$.oa.va.Sb();la&&(this.$.ea.fc||jb)&&
!this.Ygi&&(jb?Nb.a(this.$.userOperationManager,(Eb,fc,Mc)=>ua.o(this.$.oa.va,la,cd.b(Eb,this.dxf),cd.a(fc,this.cxf),Mc,la,ra),Eb=>new dc.a(130,0,Eb,16),null):ua.o(this.$.oa.va,la,this.dxf,this.cxf,null,la,ra));!this.qZ&&this.$.ea.fc&&(hb?(l.ULS.sendTraceTag(537161989,0,50,`FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded=${this.qZ}, IsSessionActive=${this.$.ea.fc}`),hb.jme(this.Nwf)):(l.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),
ua.o(this.$.oa.va,{FilterType:0},this.bxf,null,null,null,ra),this.IJc=!1))}}}lOh(la){return 0>la||la>=this.uS.length?null:this.uS[la]}qdd(la){return sc.a.Dc(this.bbd,la.toUpperCase())}mOh(la){return sc.a.Dc(this.cbd,la.toUpperCase())}J$b(la){return sc.a.Dc(this.kJa,la)}lfc(la){return!la.GroupUI}Qwf(la,jb,ra){const hb=yc.a(la);l.ULS.sendTraceTag(537161955,0,50,`FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult=${hb}`);hb?(A.g(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),
this.$.ea.zp(la.Errors)):(this.CGd(la.Result,jb,ra),D.a.UU()&&!D.a.SU(this.$)&&this.SSj())}CGd(la,jb,ra){l.ULS.sendTraceTag(537161954,0,50,`FunctionInfoManager.RefreshFunctionList: functionsInfo count = ${la.length}, isCategorized = ${jb}, partialResult = ${ra} IsFullyLoaded = ${this.qZ}`);this.qZ||(this.uS=la,this.zPg(jb),this.KJc=!ra,this.fKf())}fKf(){this.raiseEvent("FunctionInfoLoaded")}SSj(){this.pluginScheduler.notifier().setFunctionsInfo(this.q9b)}zPg(la){var jb=r.a.instance.ga(1031),ra=[];
this.kJa={};this.Y7=[];this.kJa[jb]=ra;const hb=r.a.instance.ga(1032),Eb=[];this.Y7.push(jb);this.Y7.push(hb);for(let Mc=0,xd=this.uS.length;Mc<xd;Mc++){jb=this.uS[Mc];jb.IsCompatibility||Eb.push(jb);var fc=jb.NameUI;const Hd=jb.NameDataStrings;this.bbd[Hd.toUpperCase()]||(this.bbd[Hd.toUpperCase()]=jb);this.cbd[fc.toUpperCase()]||(this.cbd[fc.toUpperCase()]=jb);if(!this.lfc(jb)){if(la){fc=jb.GroupUI;let Md=sc.a.Dc(this.kJa,fc);Md||(Md=[],this.kJa[fc]=Md,this.Y7.push(fc));Md.push(jb)}jb.IsCommonlyUsed&&
ra.push(jb);jb.IsCompatibility||this.Jog.push(Hd)}}this.kJa[hb]=Eb;la&&(Rb.YNf(ra,[2,3,0,5,4,9,1,7,8,6]),ra=Array(14),ra[0]=0,ra[1]=1,ra[2]=7,ra[3]=11,ra[4]=5,ra[5]=2,ra[6]=6,ra[7]=10,ra[8]=9,ra[9]=3,ra[10]=4,ra[11]=13,ra[12]=12,ra[13]=8,Rb.YNf(this.Y7,ra),ra=[],ra.push(...this.Y7),ra.splice(13,1),this.Y7=ra);ra=(Mc,xd)=>Mc.NameUI.localeCompare(xd.NameUI);this.uS=[...this.uS];this.uS.sort((Mc,xd)=>Mc.NameDataStrings.localeCompare(xd.NameDataStrings));for(let Mc=1,xd=this.Y7.length;Mc<xd&&la;Mc++)this.kJa[this.Y7[Mc]].sort(ra);
for(let Mc=0,xd=this.uS.length;Mc<xd;Mc++)this.uS[Mc].FunctionIndex=Mc}static YNf(la,jb){const ra=[...la];for(let hb=0;hb<ra.length&&hb<jb.length;hb++)la[hb]=ra[jb[hb]]}}Object(d.a)(Rb,"FunctionInfoManager",Bb.a,[552,553,2]);var Dc=a(236),nd=a(93),od=a(48),wd=a(704);class Pc extends nd.a{constructor(la,jb,ra,hb=null){super(la,hb);this.U2=null;this.aMb=this.vTd=!1;this.offsetParent=this.U6=this.i1a=null;this.hIc=!1;this.Xyd=Eb=>this.u5(Eb);this.Wyd=Eb=>this.qN(Eb);this.Kvf=Eb=>{const fc=z.HelperMethods.Qn(Eb);
fc.button===Sys.UI.MouseButton.leftButton&&2===Eb.tb&&(this.Kmd(fc.target)||this.gSa(fc));return!1};this.p4d=jb;ra&&(this.vTd=!0,Dc.a.instance.ra(Pb.a.pointerDown,this.oIe,this.Kvf));this.Lea=!1}get b6b(){return this.Lea}get oIe(){return this.p4d}get h4h(){return this.hIc}dispose(){this.vTd&&(Dc.a.instance.Ba(Pb.a.zj,this.oIe,this.Kvf),this.vTd=!1);this.aMb&&(this.aMb=!1,Dc.a.instance.Ba(Pb.a.Mf,this.domElement.ownerDocument.body,this.Xyd),Dc.a.instance.Ba(Pb.a.zj,this.domElement.ownerDocument.body,
this.Wyd));this.U2=this.p4d=null;super.dispose()}jke(la){this.U2?this.U2.push(la):this.U2=[la]}Kmd(la){if(this.U2)for(let jb=0,ra=this.U2.length;jb<ra;++jb)if(oa.DOMElementExtensions.vf(this.U2[jb],la))return!0;return!1}gSa(la){this.b6b||(this.Lea=!0,bb.a.equals(this.domElement.currentStyle.position,"absolute",!0)||(this.domElement.style.position="absolute"),this.Nkh(),Dc.a.instance.ra(Pb.a.Mf,this.domElement.ownerDocument.body,this.Xyd),Dc.a.instance.ra(Pb.a.zj,this.domElement.ownerDocument.body,
this.Wyd),this.aMb=!0,this.drag(!0,la))}drag(la,jb){pa.g(jb);var ra=new od.a(0,0),hb=new Sys.UI.Point(jb.clientX,jb.clientY);jb=this.domElement.parentNode;hb=wd.a.xs(ra,jb,hb,this.isRtl());la?(ra=wd.a.dF(ra,jb,this.domElement,this.isRtl()),this.i1a=wd.a.KD(hb,ra),this.U6=hb,this.hIc=!1):!this.h4h&&this.d4h(hb,this.U6)&&(this.hIc=!0);ra=wd.a.KD(hb,this.i1a);wd.a.ncb(jb,this.domElement,ra,this.isRtl(),la)}VA(la){this.aMb&&(this.aMb=!1,Dc.a.instance.Ba(Pb.a.Mf,this.domElement.ownerDocument.body,this.Xyd),
Dc.a.instance.Ba(Pb.a.zj,this.domElement.ownerDocument.body,this.Wyd));pa.g(la);this.Lea=!1;this.U6=this.i1a=null}u5(la){const jb=z.HelperMethods.Qn(la);jb.button===Sys.UI.MouseButton.leftButton&&2===la.tb&&this.VA(jb);return!1}qN(la){2===la.tb&&this.drag(!1,z.HelperMethods.Qn(la));return!1}d4h(la,jb){return jb.x<la.x-2||jb.x>la.x+2||jb.y<la.y-2||jb.y>la.y+2}Nkh(){this.offsetParent=this.domElement.offsetParent||this.domElement.ownerDocument.body;oa.DOMElementExtensions.getLocation(this.offsetParent)}}
Object(d.a)(Pc,"BaseDraggableBehavior",nd.a,[]);class Hb extends Pc{constructor(la,jb,ra=null,hb=!1){super(la,jb,!1,ra);this.mRa(hb);this.gj=bb.a.equals("rtl",la.dir,!0)}setVisible(la){oa.DOMElementExtensions.setVisible(this.domElement,la);la||(this.domElement.style.top="auto",this.domElement.style.left="auto")}isRtl(){return this.gj}mRa(la){const jb=this.domElement.style;jb.cursor="move";jb.position=la?"relative":"absolute"}}Object(d.a)(Hb,"FunctionParamBoxDraggableItem",Pc,[]);class Nc{constructor(){this.onDismissClick=
this.onFeedback=this.onHelpLink=this.onCardModeChange=null}}Object(d.a)(Nc,"FormulaArgumentAssistanceCallbacks",null,[]);class Db{constructor(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0}}Object(d.a)(Db,"FormulaArgumentAssistanceRenderingInfo",null,[]);var Cc=a(85),Xc=a(108),ld=a(151);class Dd{constructor(la){this.eH=la;this.bZ=this.aQd=this.ln=!1;this.onKeyDown=jb=>!this.bZ&&jb.keyCode===Cc.a.moa&&jb.altKey&&jb.ctrlKey?(this.L6b(),jb.stopPropagation(),jb.preventDefault(),!0):
!1;this.xMa=jb=>{if(!this.bZ)return!1;if(jb.eventName===Pb.a.Kb){const ra=jb.Ca.ctrlKey?1:jb.Ca.shiftKey?50:10;switch(jb.Ca.keyCode){case Cc.a.zTa:this.f5(0,-ra);break;case Cc.a.koa:this.f5(0,ra);break;case Cc.a.loa:this.f5(-ra,0);break;case Cc.a.efb:this.f5(ra,0);break;case Cc.a.uL:case Cc.a.$h:this.aQd=!0;break;default:return!1}}jb.eventName===Pb.a.Fd&&this.aQd&&this.i3(!0);jb.Ca.preventDefault();return!0};this.KFb=jb=>{if(!this.bZ)return!1;jb.Ca.preventDefault();this.i3();return!0};this.onBlur=
()=>{if(!this.bZ)return!1;this.i3();return!0};this.Fq=Xc.KeyInputManager.instance;this.pointerInputManager=Dc.a.instance}ka(la){(this.root=la)&&!this.ln&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.ln=!0)}detach(){this.root&&this.ln&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.ln=!1)}L6b(){this.root&&(this.target=this.eH.GCf("move",!0),this.VSd=this.target.getBoundingClientRect(),this.bZ=!0,this.aQd=!1,this.rv(),this.pkc||this.S2c(),this.target.appendChild(this.pkc))}i3(la=
!1){this.eH.bwf(la);this.bZ=!1;this.QHd();this.sHd();this.VSd=this.target=void 0}rv(){this.Fq.capture(this.xMa,null);this.pointerInputManager.pt(Pb.a.pointerDown,this.target,this.KFb,!0);this.target.addEventListener("blur",this.onBlur)}sHd(){this.Fq.releaseCapture();this.pointerInputManager.At(Pb.a.pointerDown,this.target,this.KFb,!0);this.target.removeEventListener("blur",this.onBlur)}QHd(){var la;this.target&&(null===(la=this.pkc)||void 0===la?void 0:la.parentNode)===this.target&&this.target.removeChild(this.pkc)}f5(la,
jb){const ra=this.target.getBoundingClientRect();la+=ra.left-this.VSd.left;jb+=ra.top-this.VSd.top;this.eH.onMove(la,jb)}S2c(){this.pkc=ld.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}}Object(d.a)(Dd,"FormulaAssistanceMoveAdapter",null,[]);var Od=a(275);class Qd{constructor(la){this.eH=la;this.ln=!1}Saa(){return this.ln&&!!this.tja}$Na(la){this.tja.style.cursor="grabbing";this.EEj=la.clientPoint.x;this.FEj=la.clientPoint.y;this.eH.GCf("drag");return!0}sla(la){this.eH.onMove(la.clientPoint.x-
this.EEj,la.clientPoint.y-this.FEj);return!0}rla(){this.VA()}qla(){this.VA()}ka(la){if(this.tja=la)this.tja.style.cursor="grab",Od.a.instance.x_(this.tja,this),this.ln=!0}detach(){this.ln&&this.tja&&(this.tja.style.cursor="",Od.a.instance.l7(this.tja,this),this.ln=!1)}VA(){this.tja.style.cursor="grab";this.eH.bwf()}}Object(d.a)(Qd,"FormulaAssistanceDragAdapter",null,[660]);class Nd{constructor(la,jb){this.bJa=la;this.formulaAssistanceTelemetryManager=jb;this.ln=!1;this.cea={[he.Drag]:0,[he.Move]:0};
this.cCc=this.bJa.getWindowEdgeBuffer()+1;this.Zpf=new Dd(this);this.kIe=new Qd(this)}ka(la,jb,ra,hb){this.root=la;this.render=ra;this.dismiss=hb;this.detach();jb&&(this.kIe.ka(jb),this.Zpf.ka(la.firstChild),this.ln=!0)}detach(){this.ln&&(this.kIe.detach(),this.Zpf.detach(),this.ln=!1);oa.DOMElementExtensions.pf(this.placeholder)}clear(){this.bJa.setOverrideTarget(void 0);this.detach();this.HJd()}GCf(la,jb=!1){this.cea[la]+=1;this.Axc=this.root.firstChild.getBoundingClientRect();this.placeholder=
this.root.cloneNode(!0);la=this.placeholder.firstChild;la.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);jb&&(this.WDd=document.activeElement,la.tabIndex=0,la.focus());this.dismiss();return la}onMove(la,jb){la=Math.min(Math.max(la,this.cCc-this.Axc.left),window.innerWidth-this.Axc.right-this.cCc);jb=Math.min(Math.max(jb,this.cCc-this.Axc.top),window.innerHeight-this.Axc.bottom-this.cCc);this.placeholder.firstChild.style.transform=`translate(${la}px, ${jb}px)`}bwf(la=
!0){const jb=this.placeholder.firstChild.getBoundingClientRect(),ra=this.bJa.getDirectionalHint({top:jb.top,left:jb.left});this.bJa.setOverrideTarget({top:1===ra?jb.bottom:jb.top,left:jb.left});this.render();window.requestAnimationFrame(()=>{oa.DOMElementExtensions.pf(this.placeholder);this.WDd&&(la&&this.WDd.focus(),this.WDd=void 0)})}HJd(){const la=this.formulaAssistanceTelemetryManager.r9,jb=this.cea[he.Drag],ra=this.cea[he.Move];0<jb&&(la.argumentAssistanceDragCounter+=1,la.argumentAssistanceDragTotalCounter+=
jb,this.cea[he.Drag]=0);0<ra&&(la.argumentAssistanceMoveCounter+=1,la.argumentAssistanceMoveTotalCounter+=ra,this.cea[he.Move]=0)}}Object(d.a)(Nd,"FormulaAssistanceDragControl",null,[]);var he;(function(la){la.Drag="drag";la.Move="move"})(he||(he={}));Object(d.b)("FormulaAssistanceDragMode",he);class ve extends wb.a{constructor(la,jb,ra,hb,Eb,fc){super(ve.nJa(D.a.a4()));this.$=la;this.tj=jb;this.functionInfoManager=ra;this.formulaAssistanceUIControl=hb;this.formulaAssistanceTelemetryManager=Eb;this.pluginScheduler=
fc;this.k1a=null;this.S1=0;this.pr=null;this.HVc=!1;this.Aka=this.Qq=null;this.ARa=!0;this.xQ=!1;this.Waa=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.Tdf=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.onCardModeChange=Mc=>{this.BNb(Mc);1===Mc?this.formulaAssistanceTelemetryManager.r9.argumentAssistanceCollapseCounter++:this.formulaAssistanceTelemetryManager.r9.argumentAssistanceExpandCounter++};
this.OQa=Mc=>{const xd={};xd[x.a.rU]="ArgumentAssistanceCard";const Hd={};Hd.FunctionName=Mc.functionName;xd[x.a.L9c]=Hd;this.$.ud(802602464,0,8,xd)};this.onDismissClick=()=>{this.formulaAssistanceTelemetryManager.r9.argumentAssistanceDismissCounter++;this.ARa=!1;this.Grb();this.xQ&&this.eH.clear();0===this.S1&&this.BNb(1)};this.Jf=()=>{this.ARa=!0;this.xQ&&this.eH.clear()};this.KJi=Mc=>{Mc.button===Sys.UI.MouseButton.leftButton&&Mc.target&&(pa.g(Mc),this.k1a&&this.k1a.gSa(Mc))};this.mt=()=>{void 0!==
this.Qq&&null!==this.Qq&&this.Qq()};this.Z3=(this.Ok=D.a.a4())&&Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);if(this.Ok){this.VNd();this.pr=new Oc(this.$,this.formulaAssistanceUIControl,0,Ha.a.zad);this.Z3&&A.g(this.$).hc.em(this.Jf);if(this.xQ=Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)&&!!this.formulaAssistanceUIControl)this.eH=
new Nd(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}else this.k1a=new Hb(this.domElement,this.$.yE,void 0,D.a.WM(this.$)),this.Gc.ka("mousedown",this.KJi),la=$get(w.Yad,this.tj),this.tj.insertBefore(this.domElement,la);A.g(this.$).view.Ls(this.mt)}kme(la){this.addHandler("FAFunctionNameUpdated",la)}IPf(la){this.removeHandler("FAFunctionNameUpdated",
la)}$me(la){this.addHandler("FAParameterSelectionChangedOld",la)}gQf(la){this.removeHandler("FAParameterSelectionChangedOld",la)}Zme(la){this.addHandler("FAParameterSelectionChanged",la)}fQf(la){this.removeHandler("FAParameterSelectionChanged",la)}set_visible(la){this.Ok?la||this.Grb():Sys.UI.Control.prototype.set_visible.call(this,la);return la}Grb(){this.formulaAssistanceUIControl&&(this.Qq=null,this.xQ&&this.eH.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Aka=null,this.pr.kf=
!1)}show(la){this.Ok||(this.formulaAssistanceTelemetryManager.dG(["argumentAssistanceRender"]),this.k1a.setVisible(!!la),this.formulaAssistanceTelemetryManager.UE(["argumentAssistanceRender"]),this.HVc&&(this.HVc=!1,this.formulaAssistanceTelemetryManager.lIa("argumentAssistanceOverall")))}MJd(){if(!this.Z3||this.ARa){this.Z3||this.formulaAssistanceTelemetryManager.dG(["argumentAssistanceOverall"]);this.formulaAssistanceTelemetryManager.dG(["argumentAssistanceComputation"]);var la=A.g(this.$).Di,jb=
{content:la.text,caretPosition:la.textBox.caretPosition};(this.Waa?this.pluginScheduler.getRequester().argumentAssistance(jb,0):this.pluginScheduler.requester().argumentAssistance(jb)).then(ra=>{0===ra.kind?ra.payload?(this.formulaAssistanceTelemetryManager.UE(["argumentAssistanceComputation"]),this.Ayj(this.rDd(ra.payload),la.textBox.domElement)):this.Grb():this.formulaAssistanceTelemetryManager.UE(["argumentAssistanceComputation"],!1);return null})}}update(la,jb,ra,hb){if(!this.Ok&&la){this.formulaAssistanceTelemetryManager.dG(["argumentAssistanceComputation",
"argumentAssistanceOverall"]);this.HVc=!0;var Eb=this.$.listSeparator;try{var fc=$get(w.$ad,this.tj);const Mc=$get(w.Uad,this.tj);fc.innerText="";Mc.innerText="";const xd=$get(w.cUe,this.tj),Hd=la.Params.split(w.d9c);fc=[];for(let Md=0,ae=xd.rows.length;Md<ae;Md++){const me=xd.rows[Md];oa.DOMElementExtensions.setVisible(me,Md<Hd.length);let Re=Hd[Md];const Xe=w.tVi+Md+"_",qf=la.NameDataStrings;$get(Xe+w.kFb,me).innerText=qf;$get(Xe+w.VBd,me).innerText=qf;if(Re){const uf=Hd[Md].split(Eb),Cf=ve.Cmd(uf[uf.length-
1]),Jf=ve.rji(la);Cf&&(Jf&&(2<uf.length?(uf[uf.length-2]+="1",uf[uf.length-3]+="1"):l.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",qf,uf.length.toString(),jb)),ve.JJg(uf,Jf,jb,la));Re=uf.join(Eb.toString()+" ");Hd[Md]=Re;ra<uf.length?(fc[Md]=uf[ra],l.ULS.shipAssertTag(537162072,0,!!uf[ra]&&1<=uf[ra].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",
ra,uf.length,qf,Md),uf[ra]=`${"<b>"}${uf[ra]}${"</b>"}`,Re=uf.join(Eb.toString()+" ")):l.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+ra+"currRowParamsArray.Length = "+uf.length+", current row = "+Md);hb&&l.ULS.sendTraceTag(558474578,0,50,`formula '${qf}', ${uf.length} params, isElipsis = ${Cf}, isPairsParamsFormula = ${Jf}, currentParameterIndex = ${jb}`)}$get(Xe+w.WBd,me).innerHTML="("+(Re||"")+")"}hb?this.raiseEvent("FAFunctionNameUpdated",
new hc(la.NameDataStrings,Hd)):this.raiseEvent("FAParameterSelectionChangedOld",new ub(Hd,fc,ra));xd.className=nb.a.Koh+(this.functionInfoManager.lfc(la)?"-udf":"")}catch(Mc){throw l.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",la.NameDataStrings,jb,Mc),Mc;}this.formulaAssistanceTelemetryManager.UE(["argumentAssistanceComputation"])}}dispose(){this.Ok||(this.Gc.JC(),L.a.Ia(this.Gc),A.g(this.$).view.Pq(this.mt),L.a.Ia(this.k1a),
this.k1a=null);this.Ok&&L.a.Ia(this.pr);this.Z3&&A.g(this.$).hc.yl(this.Jf);this.functionInfoManager=this.$=null;super.dispose()}rDd(la){const jb=new Db;jb.functionRenderingInfo=la;jb.cardMode=this.S1;this.iHd(jb);return jb}iHd(la){la.callbacks=new Nc;la.callbacks.onHelpLink=this.ydd(la.functionRenderingInfo);la.callbacks.onCardModeChange=this.onCardModeChange;la.callbacks.onFeedback=this.OQa;this.Z3&&(la.callbacks.onDismissClick=this.onDismissClick)}Ayj(la,jb){if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.dG(["argumentAssistanceRender"]);
const ra={};ra.zoomLevel=H(this.$);this.formulaAssistanceUIControl.updateContext(ra);this.Qq=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,jb,la)};this.Qq();this.wCd(la);this.xQ&&this.eH.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Qq,()=>this.formulaAssistanceUIControl.dismiss(this.domElement));this.pr.kf=!0;this.formulaAssistanceTelemetryManager.UE(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.lIa("argumentAssistanceOverall")}}ydd(la){return()=>
{X(this.$,la.helpID,la.isUDF)}}VNd(){const la=zb.a.get(x.a.DZb);this.S1=la?parseInt(la,10):ve.J4c;this.formulaAssistanceTelemetryManager.KXf(this.S1)}wCd(la){var jb=la.functionRenderingInfo.functionName;this.Aka&&bb.a.equals(this.Aka,jb,!0)?(jb=ic.a.map(la.functionRenderingInfo.signatures,ra=>{let hb="";0<=ra.signatureParams.activeParam&&ra.signatureParams.activeParam<ra.signatureParams.params.length&&(hb=ra.signatureParams.params[ra.signatureParams.activeParam]);return hb}),this.raiseEvent("FAParameterSelectionChanged",
new Za(jb))):(this.Aka=jb,la=ic.a.map(la.functionRenderingInfo.signatures,ra=>ra.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new hc(jb,la)))}BNb(la){this.S1=la;try{zb.a.Mw(x.a.DZb,la.toString(),Qb.AFrame.Uda)}catch(jb){l.ULS.sendTraceTag(537162070,0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${jb.message}`)}}static Cmd(la){return bb.a.contains(la,w.p6b,!0)}static rji(la){return!!la&&bb.a.v1a(la.NameDataStrings,"IFS")}static JJg(la,
jb,ra,hb){try{if(!la||2>la.length)l.ULS.shipAssertTag(537162069,0,!1,`Requested not on elipsis function, formula '${hb.NameDataStrings}', ${la?la.length.toString():"currRowParamsArray == null"} params, isPairsParamsFormula = ${jb}, currentParameterIndex = ${ra}.`);else{var Eb=la.pop().toString();for(let fc=la.length-1;fc<ra;fc++){const Mc=la[fc].trim();if(jb){const xd=la[fc-1].trim();la.push(ve.lFh(xd,Mc))}else{const xd=ve.V8e(Mc);la.push(ve.EUe(xd))}}la.push(Eb)}}catch(fc){throw l.ULS.shipAssertTag(537162068,
0,!1,`AppendNewOptionalParameters Exception. formula '${hb.NameDataStrings}', ${la?la.length.toString():"currRowParamsArray == null"} params, isPairsParamsFormula = ${jb}, currentParameterIndex = ${ra}. 
Exception: ${fc}`),fc;}}static lFh(la,jb){la=ve.V8e(la);const ra=ve.I_e(la);jb=ve.I_e(jb);return ve.EUe(la,!0,!!ra&&!!jb&&ra!==jb)}static V8e(la){var jb=la.match(ve.Lxd);la=bb.a.trimEnd(bb.a.trimStart(la,w.yEf),w.xEf);if(jb&&jb.length){jb=jb[jb.length-1];const ra=Number.parseLocale(jb)+1;la=la.replace(jb,ra.toString())}else la=`${la}${1}`;return la}static EUe(la,jb=!1,ra=!1){let hb="[{0}]";jb&&(hb=ra?"[{0}":"{0}]");return String.format(hb,la)}static I_e(la){return(la=la.match(ve.Lxd))&&la.length?
la[0]:null}static nJa(la){if(la)return document.createElement("div");la=String.format(w.jFf,w.hFf,w.VBd,nb.a.kMe,w.kFb,nb.a.jMe,w.WBd);var jb=String.format(w.jFf,w.iFf,w.VBd,nb.a.kMe,w.kFb,nb.a.jMe,w.WBd);la=String.format(w.ADh,w.BDh,nb.a.eNe,nb.a.Jlh,m.a.Np,w.cUe,la,jb);jb=document.createElement("div");jb.innerHTML=la;return jb.firstChild}}ve.Lxd=RegExp("\\d+");ve.J4c=0;Object(d.a)(ve,"FormulaArgumentAssistanceControlDeprecated",wb.a,[617]);class Td{constructor(){this.gha=this.osa=this.psa=!1;this.oEf=
40;this.Aye=41;this.w_a=this.zBd=this.ABd=this.lFb=0;this.jvf=!0;this.fAd=!1;this.oSe=this.dMd=-1}}Object(d.a)(Td,"ParseContext",null,[]);var ke=a(412),xe=a(908),le=a(320);class Je extends xe.a{constructor(la,jb,ra,hb){super(la,jb);this.formulaAssistanceControl=ra;this.formulaAssistanceTelemetryManager=hb;this.YDf=!1;this.ERa=null;this.Jjd=0;this.zHa=this.DEc=null;this.MP=0;this.Qnb=jb.textBox;this.Ok=D.a.a4();this.R9i=Pa.EwaSettings.xb();this.E1=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance")}get jyb(){return Object(ke.a)(xa,
this.$.rb.gh)}get lK(){return this.formulaAssistanceControl.qe}set lK(la){this.formulaAssistanceControl.qe=la}get a5a(){return this.Ya.a5a}get A7h(){var la=this.Qnb.text;let jb=!1;if(0>=la.length)return jb;const ra=this.$.Ib.Bc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),hb=A.g(this.$).ha.sa.activeCell.clone();var Eb=la.charCodeAt(0);this.zHa="";this.MP=this.IUg(la,this.Qnb.caretPosition);Eb=61===Eb&&-1!==this.MP;if(!Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))Eb&&
(jb=!0);else if(Eb){if(Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){Eb=0;for(var fc=this.MP-1;1<=fc&&!(this.MP-fc>Je.Tof);fc--)if(Je.dte.includes(la.charAt(fc))){Eb=fc;break}Eb=la.substring(Eb+1,this.MP);la=""!==Eb?this.$.zb.getItemByName(Eb):null;fc=this.MP;for(var Mc=this.MP+1;Mc<=this.Ya.textBox.caretPosition;Mc++)if("["===this.Ya.text.charAt(Mc))fc=Mc;else break;this.MP=fc}else{Eb=la.lastIndexOf("[");fc=0;for(Mc=Eb-1;1<=Mc&&!(Eb-Mc>Je.Tof);Mc--)if(Je.dte.includes(la.charAt(Mc))){fc=
Mc;break}Eb=la.substring(fc+1,Eb);la=""!==Eb?this.$.zb.getItemByName(Eb):null}la&&2===la.type?(jb=!0,this.zHa=Eb):A.g(this.$).Db.Yj(hb)&&(jb=!0,this.zHa="")}ra.stop();this.Jjd=ra.uc;l.ULS.sendTraceTag(575776011,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is ${this.Jjd} milliseconds`);return jb}get key(){return v.a.Stb}get calcManager(){this.DEc||(this.DEc=this.$.da.za(266,!1));return this.DEc}get wQd(){if(null!=
this.ERa)return this.ERa;if(!Pa.EwaSettings.ma(135))return this.ERa=!1;const la=A.g(this.$).ha.sa.activeCell.clone();if(1!==la.wof||!la.left||A.g(this.$).ha.sa.Lfc())return!1;let jb=this.formulaAssistanceControl.tableManager.Fm(la);if(jb)return this.ERa=!1;--la.left;--la.right;if(!la.xz)return!1;jb=this.formulaAssistanceControl.tableManager.Fm(la);return this.ERa=!!jb&&la.top===jb.top&&this.formulaAssistanceControl.tableManager.g3g(jb,A.g(this.$))}Th(la,jb){this.formulaAssistanceControl.Ya=this.Ya;
-1470715894!==jb&&-1231471547!==jb||!this.FGe()||(this.lK=!1);return super.Th(la,jb)}jyd(){var la=this.a5a;if(la||this.wQd)if(this.formulaAssistanceControl.Ya=this.Ya,this.formulaAssistanceTelemetryManager.Vnb.formulaAssistanceRequestAttemptedCounter++,this.FGe())if(!la&&this.wQd)this.formulaAssistanceControl.ere();else if(Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.A7h){if(la=this.$.Ib.Bc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),
this.formulaAssistanceControl.gre(),la.stop(),this.Qnb.text.endsWith("[")&&"["!==this.Qnb.text.charAt(this.Qnb.text.length-2)){const jb=""===this.zHa?this.formulaAssistanceControl.tableManager.Jg:Object(Na.a)(le.a,this.$.zb.getItemByName(this.zHa));l.ULS.sendTraceTag(575776010,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id ${jb.ej} in ${la.uc} ms with cell edit regression time of ${this.Jjd} ms and popup visibility - ${this.lK}`)}}else this.formulaAssistanceControl.Enb(),
this.YDf&&(this.YDf=this.lK=!1);else this.formulaAssistanceTelemetryManager.Vnb.formulaAssistanceRequestOptimizedCounter++;else this.lK=!1}nh(){this.R9i||(this.ERa=null,this.wQd&&this.formulaAssistanceControl.KY())}Jf(){this.lK=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.ysc();this.Ok&&this.Wti()}OEd(la,jb){return this.formulaAssistanceControl.Th(la,jb)}Wti(){Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.formulaAssistanceControl.q$&&
!this.formulaAssistanceControl.Iha&&!this.formulaAssistanceControl.rna&&(this.formulaAssistanceTelemetryManager.tJ.dismissSmartSuggestionImplicitlyCounter++,this.formulaAssistanceControl.q$=!1);this.formulaAssistanceControl.HD&&(this.formulaAssistanceTelemetryManager.CM.smartSuggestionShownCounter++,this.formulaAssistanceControl.HD=!1);this.formulaAssistanceControl.rna&&(this.formulaAssistanceTelemetryManager.CM.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.rna=!1);this.formulaAssistanceControl.$Ra&&
(this.formulaAssistanceTelemetryManager.CM.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.$Ra=!1);this.E1&&(this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.CM.isCellContentOnlyEqualDuringEditCounter++,this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit=!1),this.formulaAssistanceControl.sLa&&(this.formulaAssistanceTelemetryManager.CM.isCellContentFormulaCounter++,this.formulaAssistanceControl.sLa=!1))}IUg(la,jb){let ra=
0,hb;for(;-1!==ra;)if(ra=la.indexOf("[",ra+1),-1!==ra&&ra<jb&&(hb=la.indexOf("]",ra+1),-1===hb||hb>=jb))return ra;return-1}FGe(){const la=this.Ya.text,jb=this.Ya.textBox.caretPosition,ra=this.formulaAssistanceControl.axa,hb=this.formulaAssistanceControl.JMa;if(this.lK&&bb.a.equals(la,ra,!0)&&jb===hb)return!1;this.formulaAssistanceControl.axa=la;this.formulaAssistanceControl.JMa=jb;return!0}}Je.dte=" !%&'()*+,-/:;<=>@[]^{|}~".split("");Je.Tof=255;Object(d.a)(Je,"FormulaAutoCompleteListAutoCompleteBehavior",
xe.a,[]);var Fe=a(30),eb;(function(la){la[la.function=0]="function";la[la.field=1]="field";la[la.definedName=2]="definedName";la[la.letVariable=3]="letVariable";la[la.tableColHeaderName=4]="tableColHeaderName";la[la.tableSpecialStructRef=5]="tableSpecialStructRef";la[la.pendingData=6]="pendingData";la[la.tableNamedObject=7]="tableNamedObject"})(eb||(eb={}));Object(d.b)("ItemType",eb);var Xb=a(1088),oc=a(1087);class Gc{constructor(la){this.index=la}execute(la){la.push(this.index)}}Object(d.a)(Gc,"AppendIndexOperation",
null,[646]);class Vc{execute(){}}Object(d.a)(Vc,"NopIndexOperation",null,[646]);class P{constructor(la,jb){this.r_i=la;this.arf=jb}execute(la){for(let jb=0;jb<la.length;jb++)la[jb]===this.r_i&&(la[jb]=this.arf)}}Object(d.a)(P,"ReplaceIndexOperation",null,[646]);var Ta=a(79);class pb{constructor(la,jb){this.$=la;this.items=jb;this.VU=D.a.VU(this.$)}jDe(la,jb){const ra=new Gc(jb);if(!this.VU)return ra;la=this.ioi(la,jb);return null!=la?this.items[la].Fzb?new P(la,jb):new Vc:ra}ioi(la,jb){const ra=this.items[jb];
l.ULS.shipAssertTag(537162075,0,!!ra,"Internal error: invalid item index");la=Ta.where(Ta.asEnumerable(la),hb=>this.items[hb].name===ra.name);return Ta.Ct(la)?Ta.first(la):null}}Object(d.a)(pb,"FilterItemOperationFactory",null,[]);var Yb=a(116),Ac=a(835);class Zc{constructor(){this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.isPrefixed=this.detail=this.type=null}}Object(d.a)(Zc,"CompletionItem",null,[]);const id=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='${"description_cell"}{4}' class='${m.a.Np}'>{3}</td>\r\n\t<td id='${"item_type_cell"}' class='${m.a.Np}'>{5}</td>\r\n</tr>`,
gd=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${m.a.Np}'></td>\r\n\t<td id='${"item_type_cell"}' class='${m.a.Np}'>{2}</td>\r\n</tr>`,Ub=`<td>\r\n\t<div class='${m.a.PA}'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>`,Lc=`<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${m.a.Np}'>{5}</td>\r\n\t<td id='${"item_type_cell"}' class='${m.a.Np}'>{2}</td>\r\n</tr>`;
class hd extends Xb.a{constructor(la,jb,ra,hb,Eb){super(la,jb);this.Iqa=null;this.HLb=this.Ytc=0;this.Upb=null;this.dUe=ra;this.Qtb=hb;this.formulaAssistanceControl=Eb;this.mr=[];this.BV=[];this.lef=(this.Ok=D.a.a4())&&Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5931218_FaAvoidDomOperations")}lUc(la){this.addHandler("FLBSelectedRowChanged",la)}JId(la){this.removeHandler("FLBSelectedRowChanged",la)}pYb(la){this.addHandler("ACLBUpdated",la)}Brc(la){this.removeHandler("ACLBUpdated",la)}get Tgc(){return 0<
this.HLb&&this.HLb===this.mr.length}get qe(){return super.qe}set qe(la){super.qe=la;la||(this.Ytc=0,this.ee=null);0===this.Ytc?oa.DOMElementExtensions.setVisible(this.Qtb,la&&!this.Ok):oa.DOMElementExtensions.setVisible(this.Qtb,!1)}get Ej(){return this.Iqa}set Ej(la){this.OAa(this.Ej);if(la){this.dUe.innerText="";this.Iqa=la;var jb=this.OAa(this.Ej);const ra=la.rowIndex+1,hb=$get("description_cell"+ra,la);this.Qtb.innerText=hb.innerText;const Eb=$get("item_type_cell",la);this.ee=jb=jb.innerText;
this.Ytc="field"===Eb.innerText?1:"definedName"===Eb.innerText?2:"letVariable"===Eb.innerText?3:"tableColHeaderName"===Eb.innerText?4:"tableSpecialStructRef"===Eb.innerText?5:"pendingData"===Eb.innerText?6:"tableNamedObject"===Eb.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new oc.a(this.mr.length,ra,jb,hb.innerText));this.Ktc(la)}}get RSa(){return this.Qtb}get PFa(){return this.formulaAssistanceControl}get N_(){return this.Ytc}dispose(){super.dispose();this.Iqa=this.dUe=this.Qtb=null}kyc(la,
jb,ra,hb=0){this.lef||this.X6(!1);let Eb="";ra&&(Eb+=`<table aria-live='off' id='${"list_column_header"}'><tr><td class='${nb.a.pZg}'>${ra}</td></tr></table>`);Eb+=`<table class='${this.zba}' aria-live='off'><tbody>`;const fc=new Jb.a;for(let xd=0,Hd=this.BV.length;xd<Hd;xd++)Eb+=this.a2e(la[this.BV[xd]],xd+1,jb,hb),this.Ok&&fc.add(this.CWe(la[this.BV[xd]]));let Mc=this.BV.length;for(let xd=0,Hd=this.mr.length;xd<Hd;xd++)this.BV.includes(this.mr[xd])||(Mc++,Eb+=this.a2e(la[this.mr[xd]],Mc,jb,hb),
this.Ok&&fc.add(this.CWe(la[this.mr[xd]])));this.gg.innerHTML=Eb+"</tbody></table>";this.qn=oa.DOMElementExtensions.Kj(this.domElement,this.zba);this.Ok&&(this.Upb=fc.toArray());this.lef?(this.qe=!0,this.PFa.set_visible(!0)):(this.X6(!0),this.EHg(!!ra))}PIa(la,jb,ra,hb="",Eb=0,fc=!1){if(la){var Mc=[],xd=[];this.HLb=0;var Hd=new pb(this.$,la);if(jb){var Md=!!jb&&0<Eb,ae=Md&&91===jb.charCodeAt(Eb+1)?Eb+2:Eb+1;fc=Md?jb.length===ae:!1;Md&&jb.length===Eb&&Pa.EwaSettings.ma(135)&&(fc=!0);var me=null;!fc&&
Md&&jb.length>Eb+1&&(me=jb.substring(ae,jb.length));if(jb)for(let Re=0,Xe=la.length;Re<Xe;Re++)if(Md=la[Re].name,!la[Re].efi){ae=Hd.jDe(Mc,Re);la[Re].Fzb&&this.HLb++;if(!me&&!fc||0===la[Re].itemType)({a9e:Mc,oHf:xd}=this.tRe(jb,Md,ra,ae,Mc,xd));me&&1===la[Re].itemType&&({a9e:Mc,oHf:xd}=this.tRe(me,Md,!0,ae,Mc,xd));fc&&1===la[Re].itemType&&ae.execute(Mc)}}else for(ra=0;ra<la.length;++ra)if(la[ra].Fzb||fc)me=Hd.jDe(Mc,ra),me.execute(Mc),me.execute(xd),la[ra].Fzb&&this.HLb++;this.BV=xd;this.mr=Mc;this.kyc(la,
jb,hb,Eb)}}URj(la){if(la&&!(1<la.length)){var jb=[],ra=[];jb.push(0);ra.push(0);this.BV=jb;this.mr=ra;this.kyc(la,"","",0)}}Fxa(){this.Ej&&super.Fxa()}Q2i(la,jb){this.raiseEvent("ACLBUpdated",new oc.a(la,void 0,void 0,jb))}rdg(la){const jb=this.qn.rows[la];return(!this.Ej||this.Ej!==jb)&&la<this.qn.rows.length?(this.Ej=jb,!0):!1}static DWe(la){switch(la){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}}onItemClick(la){pa.g(la.Ca);
0===this.N_||2===this.N_||3===this.N_||4===this.N_||5===this.N_||7===this.N_?(this.raiseEvent(Ac.a.d4a),this.Fxa()):1===this.N_?this.PFa.Ny(!1):(this.PFa.Ny(!1),la=A.g(this.$),la.Go(!1),la.focus());return!0}EHg(la){this.rra();if(la){var jb=this.qn.offsetWidth+(this.mr.length>this.$H?Yb.a.mu:0);la=$get("list_column_header");la.offsetWidth>jb&&oa.DOMElementExtensions.Dv(this.gg,la.offsetWidth);jb=this.gg.getElementsByClassName(this.IZ);for(let ra=0;ra<jb.length;ra++)jb[ra].style.width=z.HelperMethods.pc(la.offsetWidth)}}a2e(la,
jb,ra,hb){if(1===la.itemType){const Eb=Fe.a.Eg(la.name),fc=Fe.a.Eg(hb?ra.substring(hb+1,ra.length):ra);let Mc=0;Eb.substring(0,fc.length).toLowerCase()!==fc.toLowerCase()&&(Mc=hd.mEj(Eb,w.rgg,fc));ra="";ra=0<=Mc?ra+(Eb.substring(0,Mc)+"<b>"+Eb.substring(Mc,Mc+fc.length)+"</b>"+Eb.substring(Mc+fc.length,Eb.length)):ra+Eb;hb=hb?String.format(Ub,m.a.GNe,Fe.a.$Y(ea.a.hf(0)),r.a.instance.ga(717)):"";return String.format(gd,hb,jb,eb[la.itemType],this.IZ,ra)}if(5===la.itemType)return String.format(Lc,"",
jb,eb[la.itemType],this.IZ,Fe.a.Eg(la.name),Fe.a.Eg(la.Iia));if(4===la.itemType)return String.format(Lc,"(...)",jb,eb[la.itemType],this.IZ,Fe.a.Eg(la.name));if(6===la.itemType)return hb=hb?String.format(Ub,m.a.GNe,Fe.a.$Y(ea.a.hf(0)),r.a.instance.ga(717)):"",String.format(id,hb,this.IZ,Fe.a.Eg(la.name),Fe.a.Eg(la.Iia),jb,eb[la.itemType]);hb=String.format(Ub,2===la.itemType||3===la.itemType?m.a.bsh:m.a.$rh,Fe.a.$Y(ea.a.hf(0)),r.a.instance.ga(714));return String.format(id,hb,this.IZ,Fe.a.Eg(la.name),
Fe.a.Eg(la.Iia),jb,eb[la.itemType])}CWe(la){const jb=new Zc;jb.label=la.label;jb.textEdit=la.textEdit;jb.kind=hd.DWe(la.itemType);jb.type=la.Fzb?1:0;if(Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===jb.kind){const ra=this.formulaAssistanceControl.nOh(la.label);jb.detail=ra?ra:la.Iia}else jb.detail=la.Iia;return jb}tRe(la,jb,ra,hb,Eb,fc){bb.a.equals(jb,"Pretend this is the line.",!1)&&0<Eb.length||bb.a.jL(jb,la)?(hb.execute(Eb),hb.execute(fc)):ra&&la.length>=
w.j3g&&hd.Tch(jb,w.rgg,la)?hb.execute(Eb):!ra&&la.length>=w.i3g&&bb.a.contains(jb,la,!0)&&hb.execute(Eb);return{a9e:Eb,oHf:fc}}static Tch(la,jb,ra){for(const hb of jb)if(jb=la.split(hb),!(2>jb.length))for(const Eb of jb)if(bb.a.jL(Eb,ra))return!0;return!1}static mEj(la,jb,ra){for(const hb of jb)if(jb=la.toLowerCase().indexOf((hb+ra).toLowerCase()),0<jb)return jb+1;return-1}}Object(d.a)(hd,"FormulaAutoCompleteListBox",Xb.a,[598]);class Kd{constructor(){this.G8=this._name=null}get name(){return this._name}get toolTip(){return this.G8}}
Object(d.a)(Kd,"LETVariableInfo",null,[]);class Wd{constructor(){this._name=null}get name(){return this._name}}Object(d.a)(Wd,"TableColHeaderNameInfo",null,[]);class oe{constructor(){this._name=null}get name(){return this._name}}Object(d.a)(oe,"TableNamedObjectInfo",null,[]);class We{constructor(){this.G8=this._name=null}get name(){return this._name}get toolTip(){return this.G8}}Object(d.a)(We,"TableSpecialStructRefInfo",null,[]);var Ze=a(113),Be=a(173),af=a(29),ff=a(100),Pe=a(905),Ne=a(250),se=a(51),
Wa=a(171);class Sb{constructor(){this.onRestoreFocus=this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}}Object(d.a)(Sb,"FormulaAutoCompleteCallbacks",null,[]);class wc{constructor(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}}Object(d.a)(wc,"FormulaAutoCompleteRenderingInfo",null,[]);class Uc{}Object(d.a)(Uc,"RunExperimentRequest",null,[]);class ob extends Lb.a{constructor(la,jb,ra,hb,Eb,fc,Mc,xd,Hd){super(la);this.functionInfoManager=
jb;this.calcManager=hb;this.instantaneousSupportInformationManager=Eb;this.formulaAssistanceUIControl=Mc;this.formulaAssistanceTelemetryManager=xd;this.pluginScheduler=Hd;this.pcc=!1;this.H4=this.Hqd=this.aV=this.Jg=this.QFa=this.pr=null;this.Z3b=this.oMb=this.Trb=this.XHe=this.T2=this.r9b=this.I2a=0;this.gwc=!1;this.moc=this.lia=null;this.columnName="";this.yve=this.U4c=!1;this.cJa=[];this.LP=null;this.S6=[];this.z7=this.abd=this.Qq=null;this.Iha=this.q$=this.sLa=this.isCellContentOnlyEqualDuringEdit=
this.$Ra=this.rna=this.HD=this.afa=!1;this.axa=null;this.JMa=0;this.X0d=null;this.oCb=0;this.tld=!1;this.onRestoreFocus=()=>{};this.nfb=void 0;this.Waa=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.Tdf=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.Zyb=Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",!1);this.Fgd=()=>{this.Ok&&this.raiseEvent(ob.had,
null)};this.pRe=()=>{this.lia=!1;this.aV=this.Ya.text;this.$g.PIa(this.gr,this.aV,!0,this.columnName,void 0,!1);1===this.$g.mr.length&&1===this.$g.BV.length?(this.set_visible(!1),this.yve||this.Djd()):this.show()};this.vLi=Md=>{if(yc.a(Md))-315732528!==Md.Errors[0].MessageId&&l.ULS.sendTraceTag(537162013,0,10,`FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : ${af.a.yc(Md.Errors)}`);else if((Md=Md.Result)&&Md.length){this.Jg.mO||(this.Jg.mO={},this.Jg.mO.HeadersList=
[]);this.Jg.mO.IsFullTableHeaders=!0;for(let ae=0;ae<Md.length;++ae)this.Jg.mO.HeadersList[ae]={},this.Jg.mO.HeadersList[ae].Index=ae,this.Jg.mO.HeadersList[ae].Name=Md[ae];this.MGf(!0);this.aV=this.$1e();this.$g.PIa(this.gr,this.aV,!0,void 0,void 0,!0);this.show()}else l.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};this.uLi=Md=>{Md=Wb.a.lf(Md.data);l.ULS.sendTraceTag(537162011,0,10,`FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: ${af.a.yc(Md)}`)};
this.Usf=(Md,ae)=>{this.gridView.eb||this.gridView.xi||this.NNa(null===ae||void 0===ae?void 0:ae.cell)};this.nh=(Md,ae)=>{this.NNa(null===ae||void 0===ae?void 0:ae.Bia)};this.r5=(Md,ae)=>{this.qLd(ae.newValue)};this.Vc=()=>{(Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")||this.Ok)&&this.set_visible(!1)};this.Pwf=()=>{this.z7=this.QFa=null};this.Gh=()=>{this.Ok&&this.Z0a()};this.onFunctionInfoLoaded=()=>{this.Enb()};this.aya=()=>{this.Hja?(this.QFa=
this.z7=null,this.Enb()):this.Rg.Qk&&this.ere()};this.Yba=()=>{this.LP&&X(this.$,this.LP.HelpId,this.LP.IsDynamicUdf);return!0};this.$ba=(Md,ae)=>{0==ae.Lq&&(170==ae.xf.operation.operationName&&this.formulaAssistanceTelemetryManager.mic++,this.$.userOperationManager.Co(this.$ba))};this.jOa=(Md,ae)=>{0==ae.Lq&&(12==ae.xf.operation.operationName&&this.$.userOperationManager.Hr(this.$ba),this.$.userOperationManager.Co(this.jOa))};this.Z0a=()=>{this.Ok&&this.Lsd();Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&
this.HD&&(this.q$=!0);this.sF&&this.Ya.eb&&this.lma();this.Qq=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.e_b),this.pr.kf=!1);this.tld=!1};this.JBf=()=>{this.sF&&this.lma();this.t3f(!1);1===this.wWf.type&&Pa.EwaSettings.xb()&&!this.Ya.text.includes("\n")&&this.IDd(this.wWf)};this.onDismiss=()=>{this.qe=!1;this.gridView.Di.textBox.focus()};this.OQa=()=>{const Md={};this.$g.Tgc?Md[x.a.rU]="SmartSuggestionsCard":Md[x.a.rU]="FunctionAndSmartSuggestionsCard";this.$.ud(802602464,
0,8,Md)};this.Lyd=(Md,ae)=>{this.$g.rdg(ae);this.Ok&&(this.RHa=!0)};this.Kyd=Md=>{this.Ok&&(this.OHa=!0);this.sF?(this.Gze(),this.S8&&this.YUf(),this.gridView.A$.BXf(),this.gridView.Di.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):Md.textEdit?this.Ppb(Md.textEdit):this.Ny(!0)};this.fq=A.g(la);this.domElement.className=nb.a.sLe;this.Rg=fc.s2c(la,ra);this.P4b=new Tb(la);this.Dwg=ra;ob.ajd||(ob.ajd=ob.nJa());this.domElement.innerHTML=ob.ajd;this.Lxd=RegExp("\\d+");Ne.d(this.style,
this.$.isChromeRtl);this.Cia=new ve(this.$,this.domElement,this.functionInfoManager,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager,this.pluginScheduler);jb=$get(w.Yad,this.domElement);ra=$get(w.Uad,this.domElement);hb=$get(w.$ad,this.domElement);this.Eog=new hd(this.$,jb,hb,ra,this);this.Rg.hYb(this.aya);this.functionInfoManager.aYa(this.onFunctionInfoLoaded);this.functionInfoManager.xEg(this.Pwf);this.e_b=this.domElement;this.Ok&&(this.$.xa.Pf(this.Gh),this.$g.lUc(this.JBf),
Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&(this.e_b=document.createElement("div")));this.rSa(!0);this.L6f(!0);this.$.domElement.appendChild(this.e_b);this.kPc=0;(ra=Ze.a(la))&&this.cJa.push(new Je(la,ra,this,this.formulaAssistanceTelemetryManager));this.cJa.push(new Je(la,this.fq.Xb,this,this.formulaAssistanceTelemetryManager));this.Jtb=this.cJa[0];this.apb=this.cJa[this.cJa.length-1];la.da.Ga(221,this);this.instantaneousSupportInformationManager||
this.$.da.Za(268,Md=>{this.instantaneousSupportInformationManager=Md});this.HQe=Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);Pa.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&(void 0===this.formulaAssistanceTelemetryManager.C6.anyPluginInitialized?l.ULS.sendTraceTag(523511372,0,15,"FormulaAssistanceControl - tried to initiailize mockSetActiveCellExperimentStage before pluginInitialized data is set."):this.formulaAssistanceTelemetryManager.C6.anyPluginInitialized||
(this.oCb=Pa.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)));this.pAa=D.a.VU(this.$);this.gxc=D.a.Iwa(this.$);this.lxd=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.E1=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");this.ZWc=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");D.a.UU()&&this.ykd();D.a.WM(this.$)&&jb.classList.add("ewa-fb-refactor");
this.Ok?this.gridView.ha.NG(this.Vc):this.gridView.ha.cT(this.Vc);this.pr=new Oc(this.$,this.formulaAssistanceUIControl,1,Ha.a.Bad,this.Fgd);this.amd=Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1);this.S8=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");this.rhi=Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceGridView",!1)}ime(la){this.addHandler(ob.Had,la)}HPf(la){this.removeHandler(ob.Had,
la)}gme(la){this.addHandler(ob.had,la)}FPf(la){this.removeHandler(ob.had,la)}hme(la){this.addHandler("FormulaAutoCompleteShown",la)}GPf(la){this.removeHandler("FormulaAutoCompleteShown",la)}get Ot(){return this.$g}get gr(){return this.z7}get wJb(){return this.$g.ee}get $Te(){return this.$g}get CTe(){return this.Cia}get $g(){return this.Eog}get q0a(){return this.pAa?this.Ya?this.Ya.text:null:this.aV}get pef(){var la;return 0===(null===(la=this.nSe)||void 0===la?void 0:la.type)}get Vli(){var la;return 1===
(null===(la=this.nSe)||void 0===la?void 0:la.type)}get_visible(){return void 0!==this.nfb?this.nfb:this.nfb=super.get_visible()}set_visible(la){if(this.nfb===la)return this.Ok&&!la&&this.Z0a(),la;this.Cia.set_visible(la);this.Ok&&!la&&this.Z0a();Sys.UI.Control.prototype.set_visible.call(this,la);return this.nfb=la}get qe(){return this.Ot.qe}set qe(la){this.Ok&&!la&&this.Z0a();this.Ot.qe=la}get tableManager(){return this.Dwg}get Hja(){return 0<this.rY}get sF(){return this.afa}get gridView(){return this.rhi?
this.fq:A.g(this.$)}get Db(){return this.gridView.Db}RTg(la,jb){this.qe&&(la+=w.openParen,jb++,this.$Bd(la,jb));var ra=jb===la.length||la.charAt(jb)===w.closeParen;if(!(0<jb&&la.charAt(jb-1)===w.openParen&&ra))return l.ULS.sendTraceTag(537162053,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments Caret position: ${jb} is invalid. Is cell empty: ${!la.length}. Function exists in cell: ${!!this.LP}`),!1;ra=la.substring(0,jb).lastIndexOf(this.$.listSeparator);const hb=la.substring(0,jb-1).lastIndexOf(w.openParen);
la=la.substring(-1===ra&&-1===hb?1:Math.max(ra,hb)+1,jb-1).trim();return this.functionInfoManager.qdd(la)?!0:(l.ULS.sendTraceTag(537162052,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: ${!!this.LP}`),!1)}$ai(la,jb){var ra=this.RTg(la,jb);if(!ra||!this.LP)return l.ULS.shipAssertTag(537162051,0,!ra||ra&&!!this.LP,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,Xqf:0,
pSe:0};ra=this.LP.Params;ra=ra.replace(RegExp("[\\[\\]]","g"),"");const hb=la.charAt(jb-1)===w.openParen,Eb=hb?"":"(",fc=jb===la.length?")":"";var Mc=this.$.listSeparator;Mc=ra.includes(Mc)?ra.indexOf(Mc):ra.length;return{returnValue:la.substring(0,jb)+Eb+ra+fc+la.substring(jb,la.length),Xqf:hb?jb:jb+1,pSe:Mc}}mt(la,jb){this.Ok&&void 0!==this.Qq&&null!==this.Qq&&this.Qq();this.Ok||super.mt(la,jb)}get OZb(){return this.X0d}get rY(){return this.XHe}set rY(la){this.XHe=la;la||(this.T2=0)}get Kwj(){if(null==
this.moc){const la=this.$.jc;this.moc=!!la&&!la.inEmbedView}return this.moc}get wWf(){return this.$g.Upb[this.$g.Ej.rowIndex]}get nSe(){var la,jb;return null===(jb=null===(la=this.$g)||void 0===la?void 0:la.Upb)||void 0===jb?void 0:jb[0]}get gUe(){!this.abd&&this.pluginScheduler&&(this.abd=this.pluginScheduler.getFunctionsShortDescriptions());return this.abd}dispose(){if(this.$){this.rSa(!1);const la=this.gridView;this.S8&&(this.$.userOperationManager.Co(this.$ba),this.$.userOperationManager.Co(this.jOa));
la&&(la.ha&&(this.Ok?la.ha.RF(this.Vc):la.ha.rR(this.Vc),D.a.UU()&&4!==this.oCb&&(this.Zyb?la.hc.tk(this.nh):la.ha.mma(this.Usf))),la.view.Pq(this.gmc));this.Ok&&this.$.xa&&this.$.xa.zg(this.Gh)}this.functionInfoManager&&(this.functionInfoManager.Rab(this.onFunctionInfoLoaded),this.functionInfoManager.Gaj(this.Pwf));this.Rg&&this.Rg.trc(this.aya);this.Ok&&this.$g&&this.$g.JId(this.JBf);D.a.lec&&this.Ya&&this.Ya.GHb(this.r5);this.L6f(!1);L.a.Ia(this.$g);L.a.Ia(this.OZb);L.a.Ia(this.Cia);L.a.Ia(this.pr);
this.Ya=this.functionInfoManager=this.Rg=null;L.a.qc(this.cJa);this.Jg=this.z7=this.Cia=this.cJa=null;super.dispose()}rwa(){return!this.gr}$hi(){return!this.QFa}HPj(la){this.Vli&&1872288872===la&&(this.formulaAssistanceTelemetryManager.UE(["autoCompleteSmartSuggestionActiveDismissing"]),this.Iha=!0)}Th(la,jb){if(!this.rwa()){Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.HPj(jb);if(this.Ok&&this.sF){if(125627505===jb||267796030===jb)return this.Ok&&this.lAc(jb),
this.Gze(),this.S8&&this.YUf(),!1;if(1872288872===jb)return this.lma(),this.qe=!1,!0;if(this.$g.Tgc&&(-798660877===jb||137938150===jb))return!1}if(1!==this.$g.N_||125627505!==jb&&267796030!==jb)if(6===this.$g.N_){var ra=la.keyCode;13!==ra&&9!==ra||this.Ny(!1)}else{if(4===this.$g.N_||5===this.$g.N_)return super.Th(la,jb,!0);1===this.$g.BV.length&&(ra=la.keyCode,this.yve=8===ra||127===ra||46===ra?!0:!1)}else{if(this.Ny(!1)&&!this.Hja)return this.gridView.ha.Th(la,jb);if(125627505===jb&&this.Hja)return!0}}return super.Th(la,
jb)}ysc(){this.Rg.qbb();this.z7=null;null==this.lia||this.lia||this.Oic("NoFieldChosen",1,2,1);this.lia=null;this.rY=0;this.H4=this.Hqd=this.moc=null}Enb(){this.Tdf&&this.formulaAssistanceTelemetryManager.dG(["argumentAssistanceOverall"]);const la=!!this.Ya&&!Xa.f(this.$.pa);let jb=null;this.E1&&la&&(jb=this.Ya.text,jb.startsWith("=")&&(this.sLa=!0,1===jb.length&&(this.isCellContentOnlyEqualDuringEdit=!0)));if((this.pAa||this.gxc)&&la){this.E1||(jb=this.Ya.text);const ra={content:jb,caretPosition:null};
(this.Waa?this.pluginScheduler.getRequester().functionSuggestion(ra,0):this.pluginScheduler.requester().functionSuggestion(ra)).then(hb=>{if(0===hb.kind){l.ULS.shipAssertTag(537162050,0,!!hb&&!!hb.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion");const Eb=Ta.toArray(Ta.select(Ta.asEnumerable(hb.payload.items),fc=>ob.Z1g(fc)));this.gxc&&this.gridView.A$.aOd(hb.payload,jb);this.pAa&&(this.S6=Eb,Ja.AFrameworkApplication.Ng||(this.ZWc&&this.Db.s4(this.gridView.ha.sa.activeCell)?
this.formulaAssistanceTelemetryManager.CM.smartSuggestionWouldSuggestInsidePivotCounter++:this.fre(la,!0)))}return null})}this.pAa&&la||this.fre(la,!1)}$1e(){if(Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var la=this.gridView.lm?this.Jtb.MP:this.apb.MP;this.oMb="@"===this.Ya.text.charAt(la+1)&&this.Ya.textBox.caretPosition>la+1?la+2:la+1}else{la=this.Ya.text.lastIndexOf(w.Ajf);const jb=this.Ya.text.lastIndexOf("[");this.oMb=la+1>=jb?la+2:jb+1}return this.Ya.text.substring(this.oMb,
this.Ya.textBox.caretPosition)}gre(){this.F3f()&&(this.S9g(),this.gr&&(this.lia=!1,this.aV=this.$1e(),this.$g.PIa(this.gr,this.aV,!0,void 0,void 0,!0),this.show(),Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.Cia.Grb()))}ere(){this.F3f()&&(this.OZb&&this.OZb.cancel(),this.Rg.O5a?(this.rwa()&&this.UBe(!0),this.get_visible()?this.pRe():this.X0d=Be.AsyncMethodContext.lr(this.pRe,w.pch,Sa.a.yCh,this.OZb)):this.KY())}F3f(){return this.Ya?0<this.$.rb.eR||
!this.Ya.text||!this.Ya.eb?(this.set_visible(!1),!1):Xa.f(this.$.pa)?!1:!0:!1}Ppb(la){this.Ya&&this.qe&&(this.Nkd(this.Ya.text,la),this.Ya.textBox.caretPosition=la.range.start.character+la.newText.length,this.set_visible(!1))}Ny(){var la;if(!this.Ya||!this.qe)return!1;const jb=this.$g.N_;this.formulaAssistanceTelemetryManager.S8e(hd.DWe(jb));let ra="";var hb=0;const Eb=this.gridView;var fc=this.Ya.text,Mc=0,xd=this.$g.ee,Hd=!1;if(0===jb||2===jb||3===jb||7===jb)ra+=fc.substr(0,this.I2a)+this.$g.ee,
0!==jb||this.$g.ee.endsWith(")")||(ra+="("),hb=ra.toString().length,ra+=fc.substr(this.r9b),2===jb&&(Mc=4,xd="DefinedName",Hd=!0,this.set_visible(!1));else if(1===jb)if(this.lia=!0,this.Hja){ra+=fc.substr(0,this.rY+2);!ra.toString().endsWith(Ab.a.aU)&&Pa.EwaSettings.ma(135)&&(ra+=Ab.a.aU);Mc=this.$g.ee;Mc=Mc.replace("'","''");Mc=Mc.replace("[","'[");Mc=Mc.replace("]","']");if(this.U4c||this.eyh(Mc))Mc=Ab.a.Qqi+Mc+Ab.a.Ihj,Hd=!0;ra+=Mc;hb=ra.length;Mc=3;Wa.a("PulloutFieldAccepted")}else return this.Ya.text=
this.$g.ee,this.set_visible(!1),Eb.Go(!1),Eb.focus(),this.Oic("FieldName",1,1,1),Wa.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===jb)l.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),ra+=fc.substr(0,this.oMb),bb.a.equals(this.$g.ee,"@ - "+this.instantaneousSupportInformationManager.De.ThisRowStructRefString,!1)?ra+="@":(ra+=this.$g.ee,Hd=!0,this.set_visible(!1)),hb=ra.length;else if(4===jb){l.ULS.sendTraceTag(575776009,
0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");ra+=fc.substr(0,this.oMb);Hd="";hb=!1;var Md=[39,91,93,64,35];for(let ae=0;ae<this.$g.ee.length;ae++){const me=this.$g.ee.charCodeAt(ae);Md.includes(me)&&(Hd+="'");Hd+=this.$g.ee.charAt(ae).toString();hb||bb.a.isNumeral(me)||bb.a.Gdf(me)||(hb=!0)}Md=this.gridView.lm?this.Jtb.MP:this.apb.MP;fc=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?"@"===fc.charAt(Md+
1)&&hb:fc.lastIndexOf(w.Ajf)+1>=fc.lastIndexOf("[")&&hb;ra+=fc?"["+Hd+"]":Hd;Hd=!0;this.set_visible(!1);hb=ra.toString().length}else if(6===jb)ra+=fc.substr(0,this.Trb);else return l.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;this.Ya.text=ra;this.Ya.textBox.caretPosition=hb;this.Ya.Jwa()&&(null===(la=Eb.Mr)||void 0===la?0:la.lua)&&Eb.Mr.EJb(this.Ya.text,this.Ya.textBox.caretPosition,this.Ya.textBox.caretPosition,this.Ya.textBox.ty.length);Eb.lm&&
(la=Eb.Xb,la.text=this.Ya.text,la.setCaretPosition(this.Ya.textBox.caretPosition));xd=(null==this.lia?0:this.lia)?"FieldName":xd;this.$g.Ej.sectionRowIndex>=this.$g.BV.length?this.Oic(xd,4,Mc,0):this.Oic(xd,1,Mc,0);Hd||(5===jb||4===jb?this.gre():this.Enb());return!0}KY(la=null,jb=null){la?(this.Rg.qbb(),this.Rg.KY(la,!1,!1,jb)):(la=this.gridView,la.ha.sa.wg&&(la=nc.v(la.ha.sa.Wc,this.$),this.Rg.KY(la,!0,!0,jb)))}lma(){this.afa=!1;this.Ya.fHe()}nOh(la){la=this.calcManager.getWorksheetFuncId(la);return this.gUe?
this.gUe.descriptionsMap.get(la):null}UBe(la){if(this.$hi()){if(this.Rg.O5a&&this.Rg.Qk&&(!this.Rg.Qk.length||!this.Rg.Qk[0].FieldInfoDataList))return;this.TPj(la)}la=Ta.asEnumerable(this.QFa);la=Ta.concat(la,this.pQh(this.Ya.text));Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&this.Ok&&(la=Ta.concat(la,this.xRh()));Ta.OBc(la,jb=>jb.name,new Pe.a);this.pAa&&(la=Ta.concat(Ta.asEnumerable(this.S6),la),Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&
(Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")?0<this.S6.length?(this.HD||this.formulaAssistanceTelemetryManager.dG(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),this.HD=!0):this.HD&&this.pef&&(this.q$=!0):0<this.S6.length&&(this.HD=!0),this.S6=[]));this.z7=Ta.toArray(la)}S9g(){var la=this.Ya.text;if(Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var jb=this.gridView.lm?this.Jtb.zHa:
this.apb.zHa,ra=!0;if(Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==jb&&(this.Jg=Object(Na.a)(le.a,this.$.zb.getItemByName(jb))),this.Jg||(this.Jg=this.tableManager.Jg,ra=!1),!this.Jg){l.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d");return}}else this.Jg=Object(Na.a)(le.a,this.$.zb.getItemByName(jb)),
this.Jg||(this.Jg=this.tableManager.Jg,ra=!1);this.Jg.mO&&this.Jg.mO.IsFullTableHeaders?this.MGf(ra):tb.d(this.Jg)?(l.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s"),gb.p(this.$.oa.va,this.Jg.ej,this.vLi,this.uLi,null,null)):l.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.")}else if(this.calcManager&&this.tableManager.Jg)if(jb=
this.calcManager.W3a(this.tableManager.Jg))if(this.calcManager.sIg(this.tableManager.Jg,jb)){la=Ta.empty();if(91===this.Ya.text.charCodeAt(this.Ya.text.length-1)){const hb=this.l0a("@ - "+this.instantaneousSupportInformationManager.De.ThisRowStructRefString);la=Ta.concat(la,(ra=new Jb.a,ra.add(hb),ra))}la=Ta.concat(la,Ta.select(Ta.asEnumerable(jb.toArray()),hb=>{const Eb=new bc,fc=new Wd;fc._name=hb.toString();Eb.A_f(fc);return Eb}));this.z7=Ta.toArray(la)}else la.endsWith("[")&&"["!==la.charAt(la.length-
2)&&l.ULS.sendTraceTag(572381130,0,50,`FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with ${jb.count} columns for a table with id ${this.tableManager.Jg.ej} of size ${this.tableManager.Jg.usedRange.right-this.tableManager.Jg.usedRange.left+1}`);else la.endsWith("[")&&"["!==la.charAt(la.length-2)&&l.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")}eyh(la){if(!la)return!1;
let jb=la.charCodeAt(0);if(46===jb||48<=jb&&57>=jb||63===jb)return!0;for(let ra=0;ra<la.length;ra++,jb=la.charCodeAt(ra))if(!((Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?bb.a.isLetter(jb):bb.a.Ind(jb))||92===jb||95===jb||63===jb||48<=jb&&57>=jb))return!0;return!1}$Bd(la,jb){let ra=!1,hb=!1;var Eb=!1,fc=0;let Mc=0;this.I2a=0;this.r9b=jb;this.Z3b=1;for(let xd=jb-1;0<=xd;--xd)switch(la.charCodeAt(xd)){case 39:hb=!hb;break;case 34:ra=
!ra;break;case 91:++fc;Eb=fc>Mc;break;case 93:++Mc}Eb=Object(Ob.a)(new Td,{osa:!ra,psa:!hb,gha:!Eb,lFb:1});fc=this.PVi(la,jb,Eb);jb=this.QVi(la,jb,Eb.osa,Eb.psa,Eb.gha);this.Z3b=fc+jb;if(this.kPc=fc-1)this.gwc=!1;this.Uyh(la,ra,hb,Eb.zBd,Eb.ABd)}ykd(){4!==this.oCb&&(this.Zyb?this.gridView.hc.Nk(this.nh):this.gridView.ha.iga(this.Usf));const la=D.a.Oxb()?this.fq.Vb(null):void 0;this.NNa(la);D.a.lec&&this.gridView.Di.YXa(this.r5);ob.sLd(this.pluginScheduler);this.pAa&&this.iWg()}txh(){return this.pAa||
this.HQe}RVi(){var la=this.H4;if(!this.Kwj||!la)return this.rY=0,this.QFa=this.z7=null,!1;la=la.endsWith(Ab.a.aU);let jb;if(Pa.EwaSettings.ma(135)&&({sheetRange:jb}=this.nNj(this.H4.substring(0,this.T2))).returnValue){const ra=this.H4.substring(0,this.rY);if(la&&ra!==this.Hqd)return this.Hqd=ra,this.rY=this.H4.length-(la?1:0),this.KY(jb,this.H4),this.lia=!1,l.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),!0}return!1}pQh(la){const jb=new Jb.a;this.calcManager&&Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&
l.ULS.shipAssertTag(537162014,0,!!this.calcManager.Bsa(db.Range.Uc(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.HQe&&(la=this.calcManager.extractLetVariables(la,this.Ya.textBox.caretPosition)))for(const ra of la){la=new Kd;la._name=ra;la.G8=r.a.instance.ga(2216);const hb=new bc;hb.Dqj(la);jb.add(hb)}return jb}xRh(){const la=new Jb.a,jb=this.$.zb.items;for(let hb=0,Eb=jb.length;hb<Eb;hb++){var ra=jb[hb];if(!Xa.n(ra))continue;const fc=
new oe;fc._name=ra.name;ra=new bc;ra.Tsj(fc);la.add(ra)}return la}l0a(la){const jb=new bc,ra=new We;ra._name=la;jb.Usj(ra);return jb}MGf(la){const jb=new Jb.a,ra=this.Ya.text.charCodeAt(this.Ya.text.length-1),hb=this.Ya.textBox.caretPosition-1;if(Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?91===this.Ya.text.charCodeAt(hb):91===ra){var Eb=this.l0a("@ - "+this.instantaneousSupportInformationManager.De.ThisRowStructRefString);jb.add(Eb)}for(var fc of this.Jg.mO.HeadersList){Eb=
new bc;const Mc=new Wd;Mc._name=fc.Name;Eb.A_f(Mc);jb.add(Eb)}fc=this.gridView.lm?this.Jtb.MP:this.apb.MP;Eb=this.Ya.text.charCodeAt(fc+1);(Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!la||hb!==fc&&35!==Eb:!la||91!==ra&&35!==ra)||(la=this.l0a("#"+this.instantaneousSupportInformationManager.De.AllStructRefString),jb.add(la),la=this.l0a("#"+this.instantaneousSupportInformationManager.De.DataStructRefString),jb.add(la),la=this.l0a("#"+this.instantaneousSupportInformationManager.De.HeadersStructRefString),
jb.add(la),la=this.l0a("#"+this.instantaneousSupportInformationManager.De.TotalsStructRefString),jb.add(la));jb&&(this.z7=jb.toArray())}TPj(la){let jb=Ta.empty();!la&&this.functionInfoManager.qZ&&(jb=Ta.concat(jb,Ta.select(Ta.asEnumerable(this.functionInfoManager.q9b),ra=>{const hb=new bc;hb.cZf(ra);return hb})),la=this.P4b.MFe,0<la.length&&(jb=Ta.OBc(Ta.concat(jb,Ta.select(Ta.asEnumerable(la),ra=>{const hb=new bc;hb.apj(ra);return hb})),ra=>ra.name,new Pe.a)));if(this.Rg.O5a&&this.Rg.Qk){if(!this.Rg.Qk.length||
!this.Rg.Qk[0].FieldInfoDataList)return;jb=Ta.OBc(Ta.concat(jb,Ta.select(Ta.asEnumerable(this.Rg.Qk[0].FieldInfoDataList),ra=>{const hb=new bc;hb.Apj(ra);return hb})),ra=>ra.name,new Pe.a);this.columnName=this.Rg.Qk[0].ColumnName}this.QFa=Ta.toArray(jb)}NNa(la){var jb;if(1!==this.oCb){var ra=this.gridView.ha.sa.activeCell;if(ra){var hb=this.calcManager.Bsa(ra,!this.amd);if(hb){var Eb=this.$.xa,fc=hb.sheet.index;0>=Eb.count||0>fc||fc>=Eb.count||(fc=Eb=null,this.lxd&&void 0!==this.calcManager&&null!==
this.calcManager&&(la=null!==(jb=null===la||void 0===la?void 0:la.cell)&&void 0!==jb?jb:this.gridView.Ea.Sr(ra))&&(jb=this.calcManager.lac(la.Gk),void 0!==jb&&null!==jb&&(Eb=jb.FormatString,fc=jb.Builtin)),2!==this.oCb&&this.pluginScheduler.notifier().setActiveCell({colIndex:hb.range.col,rowIndex:hb.range.row,sheetIndex:this.$.xa.getItem(hb.sheet.index).sheetId,docName:hb.sheet.document.name,docPath:hb.sheet.document.path,formatString:Eb,builtIn:fc}))}}}}YUf(){this.formulaAssistanceTelemetryManager.TH=
{Ck:this.gridView.ha.sa.activeCell,cpb:this.gridView.Xb.text,Rpb:!0};this.formulaAssistanceTelemetryManager.RAb=this.$.ea.Ke;this.formulaAssistanceTelemetryManager.lic=this.$.xa.pa.sheetId;this.$.userOperationManager.Hr(this.jOa)}iWg(){this.gridView.lm?this.Jtb.ZX(!1):this.apb.ZX(!1)}jhf(la){let jb;jb=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?bb.a.isLetter(la):bb.a.Ind(la);return 48<=la&&57>=la||46===la||95===la||jb}show(){if(this.gr){var la=
this.$g.rdg(0);this.Ok?0<this.$g.mr.length?la||this.t3f(!0):this.Z0a():((la=0<this.$g.mr.length)&&this.formulaAssistanceTelemetryManager.dG(["autoCompleteRender"]),!this.qe&&this.columnName&&la&&this.$g.Q2i(this.$g.mr.length,this.columnName),this.qe=la,this.Cia.show(this.LP),this.eBa(!0),this.$g.Fxa(),la&&this.formulaAssistanceTelemetryManager.UE(["autoCompleteRender"]))}}QVi(la,jb,ra,hb,Eb){for(ra=Object(Ob.a)(new Td,{oEf:41,Aye:40,osa:ra,psa:hb,gha:Eb});jb<la.length&&!this.nFf(la,jb,ra);++jb);return ra.lFb}PVi(la,
jb,ra){for(--jb;0<=jb&&!this.nFf(la,jb,ra);--jb);return ra.lFb}nFf(la,jb,ra){const hb=la.charCodeAt(jb);0>=this.T2&&(this.T2=la.substring(0,jb).lastIndexOf(Ab.a.aU));46===hb&&(jb<this.T2?this.T2=jb:jb>this.Trb&&(this.rY=this.Trb=jb));if(!this.jhf(hb)&&!ob.Cni(hb)&&(!this.Hja||jb<=this.T2||!ob.a7h(hb,ra))){ra.jvf&&(ra.jvf=!1,this.I2a=jb+1);if(ra.fAd){ra.ABd=jb+1;if(this.functionInfoManager.qdd(la.substring(ra.ABd,ra.zBd)))return!0;ra.fAd=!1}switch(hb){case 39:ra.psa=!ra.psa;break;case 34:ra.osa=!ra.osa;
break;case 91:ra.gha=!1;break;case 93:ra.gha=!0}hb===this.$.listSeparator.toString().charCodeAt(0)&&ra.psa&&ra.osa&&!ra.w_a&&(!this.Hja||ra.gha)&&(jb<ra.dMd||-1===ra.dMd)&&(ra.lFb+=1,this.Z3b++);hb===ra.Aye&&ra.osa&&ra.psa&&(!this.Hja||ra.gha)?ra.w_a+=1:hb===ra.oEf&&ra.osa&&ra.psa&&(!this.Hja||ra.gha)?0<ra.w_a?--ra.w_a:(ra.dMd=ra.oSe,ra.oSe=jb,0<jb&&this.jhf(la.charCodeAt(jb-1))&&(ra.fAd=!0,ra.zBd=jb)):this.Hja&&46===hb&&jb>this.T2&&(jb<this.T2?this.T2=jb:jb>this.Trb&&(this.rY=this.Trb=jb))}return!1}Uyh(la,
jb,ra,hb,Eb){this.r9b>this.I2a&&0<=this.I2a?jb||ra||(this.aV=la.substring(this.I2a,this.r9b)):this.aV=null;hb!==Eb?(la=la.substring(Eb,hb),this.LP&&bb.a.equals(this.LP.NameDataStrings,la,!0)||(this.gwc=!0),this.LP=this.functionInfoManager.qdd(la)):(this.gwc=!1,this.LP=null)}L6f(la){const jb=$get(w.hFf+"_"+w.kFb,this.domElement),ra=$get(w.iFf+"_"+w.kFb,this.domElement);la&&!this.pcc?(jb&&lb.a.instance.ra(Pb.a.click,jb,this.Yba),ra&&lb.a.instance.ra(Pb.a.click,ra,this.Yba),this.pcc=!0):this.pcc&&(jb&&
lb.a.instance.Ba(Pb.a.click,jb,this.Yba),ra&&lb.a.instance.Ba(Pb.a.click,ra,this.Yba),this.pcc=!1)}nNj(la){let jb;jb=null;var ra;if(({sheetName:hb,range:ra}=nc.Z(la,this.$.ea.xa)).returnValue&&ra){if(!hb){var hb=Object(Na.a)(ff.a,this.$.pa);if(!hb)return{returnValue:!1,sheetRange:jb};hb=hb.name}jb=nc.v(ra,this.$);jb.SheetName=hb;this.U4c=!1;return{returnValue:!0,sheetRange:jb}}return({sheetName:hb,range:ra}=this.P4b.XMj(la)).returnValue?(jb=nc.v(ra,this.$),jb.SheetName=hb,this.U4c=!0,{returnValue:!0,
sheetRange:jb}):{returnValue:!1,sheetRange:jb}}qLd(la){la={content:la,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.Waa?this.pluginScheduler.getRequester().runAuthoringExperiment(la,0):this.pluginScheduler.requester().runAuthoringExperiment(la)}Djd(){if(1===this.$g.BV.length&&this.gr.length){var la=this.gr[this.$g.BV[0]];if(1===la.itemType){var jb=la.name;la=this.Ya.text;jb=jb.substring(la.length,jb.length);jb.length&&(this.Ya.text=la+jb,this.Ya.textBox.selectRange(la.length,
this.Ya.text.length))}}else l.ULS.shipAssertTag(537162007,0,!1,`InCellAutoComplete should only be called when there is 1 item (number of items: ${this.$g.BV.length})`)}Oic(la,jb,ra,hb){const Eb={};Eb.a=la;Eb.b=jb;Eb.c=ra;Eb.d=hb;se.b().Le(38,Eb,!0)}fre(la,jb){if(!this.functionInfoManager.qZ){if(la)if(this.$Bd(this.Ya.text,this.Ya.textBox.caretPosition),this.pAa||this.aV){const ra={};ra.Filter=this.aV?this.aV.charAt(0).toString():"";ra.FilterType=1;ra.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.z1a(ra)}else Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&
this.get_visible()&&this.set_visible(!1);if(!jb)return}0<this.$.rb.eR||this.Ya&&!this.Ya.eb?this.set_visible(!1):la&&(this.$Bd(this.Ya.text,this.Ya.textBox.caretPosition),this.Cia.update(this.LP,this.Z3b,this.kPc,this.gwc),this.H4=this.Ya.text.substring(1,this.Ya.textBox.caretPosition),this.T2=this.H4.indexOf(Ab.a.aU),this.rY=this.H4.lastIndexOf(Ab.a.aU),this.RVi()?(la=new bc,la.srj(),this.QFa=this.z7=la=[la],this.$g.URj(la),this.show()):((this.txh()||this.rwa())&&this.UBe(!1),0<this.rY?this.$g.PIa(this.gr,
this.H4,!1,void 0,this.H4.lastIndexOf(Ab.a.aU),!1):this.$g.PIa(this.gr,this.aV,!1,void 0,this.rY,!1),this.show(),this.Ok&&(this.$g.mr.length||this.gridView.Di.lI?this.Cia.Grb():(this.Cia.MJd(),this.Ok&&this.Z0a()))))}t3f(la){if(0<this.$g.mr.length){this.formulaAssistanceTelemetryManager.dG(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){const jb={};jb.zoomLevel=H(this.$);this.formulaAssistanceUIControl.updateContext(jb);this.Qq=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.e_b,
this.gridView.Di.textBox.domElement,this.mdd())};this.Qq();this.Ok&&this.$g.Tgc&&this.raiseEvent(ob.Had,null);this.tld||this.$g.Tgc||this.raiseEvent("FormulaAutoCompleteShown");this.tld=this.pr.kf=!0;la&&this.formulaAssistanceTelemetryManager.T8e(this.$g.Upb)}this.formulaAssistanceTelemetryManager.UE(["autoCompleteRender"]);Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")?!Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&
void 0!==this.S6&&null!==this.S6&&0<this.S6.length?(this.HD||this.formulaAssistanceTelemetryManager.dG(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),this.HD=!0):this.HD&&this.pef&&(this.q$=!0):!Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.S6&&null!==this.S6&&0<this.S6.length&&(this.HD=!0)}}Lsd(){this.QHa&&(this.formulaAssistanceTelemetryManager.tJ.selectByArrowKeyCounter++,this.QHa=!1);this.RHa&&(this.formulaAssistanceTelemetryManager.tJ.selectByMouseHoverCounter++,
this.RHa=!1);this.PHa&&(this.formulaAssistanceTelemetryManager.tJ.commitByTabKeyCounter++,this.PHa=!1);this.NHa&&(this.formulaAssistanceTelemetryManager.tJ.commitByEnterKeyCounter++,this.NHa=!1);this.OHa&&(this.formulaAssistanceTelemetryManager.tJ.commitByMouseClickCounter++,this.OHa=!1);Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.Iha&&(this.formulaAssistanceTelemetryManager.tJ.dismissSmartSuggestionExplicitlyCounter++,this.Iha=!1)}mdd(){const la=new wc;
la.completionItems=this.$g.Upb;la.activeItemIndex=this.$g.Ej?this.$g.Ej.rowIndex:-1;this.dHd(la);return la}dHd(la){la.callbacks=new Sb;la.callbacks.onCompletionItemSelected=this.Lyd;la.callbacks.onCompletionItemCommitted=this.Kyd;la.callbacks.onFeedback=this.OQa;la.callbacks.onDismiss=this.onDismiss;la.callbacks.onRestoreFocus=this.onRestoreFocus}IDd(la){this.afa=!0;const jb=la.textEdit.newText;this.Ya.ddb(jb.substring(this.Ya.text.length-la.textEdit.range.start.character,jb.length))}Gze(){Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&
this.formulaAssistanceTelemetryManager.UE(["autoCompleteSmartSuggestionAccepted"]);this.Ny(!0);this.afa=this.qe=!1;this.$Ra=this.rna=!0}Nkd(la,jb){this.Ya.text=la.substring(0,jb.range.start.character)+jb.newText+la.substring(jb.range.end.character,la.length);this.gridView.lm&&(this.gridView.Xb.text=this.Ya.text)}static sLd(la){Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUse")?la.getRequester().runExperiment(new Uc,0):la.requester().runExperiment(new Uc)}static Z1g(la){const jb=
bc.B9g(),ra={IsCompatibility:!1};ra.NameDataStrings=la.label;ra.Help=la.detail;jb.cZf(ra);jb.textEdit=la.textEdit;return jb}static nJa(){const la=String.format(w.CDh,w.$ad,va.a.nMe),jb=String.format(w.xDh,w.Yad,nb.a.i8c,m.a.Zo,m.a.Np),ra=String.format(w.vDh,w.Uad,nb.a.i8c,m.a.Zo,nb.a.eNe,m.a.Np);return`${la}
${jb}
${ra}`}static Cni(la){return 36===la||58===la||33===la||39===la||32===la}static a7h(la,jb){return 32===la||91===la||!jb.gha}}ob.Had="FACardOpened";ob.had="FAFocusOnSmartSuggestionsCard";ob.ajd=null;Object(d.a)(ob,"FormulaAssistanceControl",Lb.a,[566,555,2,567,568]);class Zb extends wb.a{constructor(la,jb,ra){super(Zb.nJa());this.$=la;this.formulaAssistanceUIControl=jb;this.formulaAssistanceTelemetryManager=ra;this.S1=0;this.Aka=this.Qq=this.pr=null;this.xQ=this.Ov=!1;this.Vc=()=>{this.visible=!1};
this.onCardModeChange=hb=>{this.BNb(hb);1===hb?this.formulaAssistanceTelemetryManager.r9.argumentAssistanceCollapseCounter++:this.formulaAssistanceTelemetryManager.r9.argumentAssistanceExpandCounter++};this.OQa=hb=>{const Eb={};Eb[x.a.rU]="ArgumentAssistanceCard";const fc={};fc.FunctionName=hb.functionName;Eb[x.a.L9c]=fc;this.$.ud(802602464,0,8,Eb)};this.mt=()=>{void 0!==this.Qq&&null!==this.Qq&&this.Qq()};this.onDismissClick=()=>{this.formulaAssistanceTelemetryManager.r9.argumentAssistanceDismissCounter++;
this.dismiss();this.raiseEvent("DC");this.xQ&&this.eH.clear();0===this.S1&&this.BNb(1)};this.Jf=()=>{this.xQ&&this.eH.clear()};this.Z3=Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.VNd();this.pr=new Oc(this.$,this.formulaAssistanceUIControl,0,Ha.a.zad);A.g(this.$).view.Ls(this.mt);A.g(this.$).ha.NG(this.Vc);if(this.xQ=Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",
!1))this.eH=new Nd(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager),A.g(this.$).hc.em(this.Jf);Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}kme(la){this.addHandler("FAFunctionNameUpdated",la)}IPf(la){this.removeHandler("FAFunctionNameUpdated",la)}$me(la){this.addHandler("FAParameterSelectionChangedOld",la)}gQf(la){this.removeHandler("FAParameterSelectionChangedOld",la)}Zme(la){this.addHandler("FAParameterSelectionChanged",
la)}fQf(la){this.removeHandler("FAParameterSelectionChanged",la)}bEg(la){this.addHandler("DC",la)}paj(la){this.removeHandler("DC",la)}get visible(){return this.Ov}set visible(la){la||this.dismiss();this.Ov=la}dismiss(){this.Ov=!1;this.formulaAssistanceUIControl&&(this.Qq=null,this.xQ&&this.eH.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Aka=null,this.pr.kf=!1)}show(la,jb){this.Ov=!0;const ra=this.rDd(la);this.formulaAssistanceUIControl&&(this.formulaAssistanceTelemetryManager.dG(["argumentAssistanceRender"]),
la={},la.zoomLevel=H(this.$),this.formulaAssistanceUIControl.updateContext(la),Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Qq=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,jb,ra)},this.Qq()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,jb,ra),this.wCd(ra),this.xQ&&this.eH.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Qq,
()=>this.formulaAssistanceUIControl.dismiss(this.domElement)),this.pr.kf=!0,this.formulaAssistanceTelemetryManager.UE(["argumentAssistanceRender"]),this.formulaAssistanceTelemetryManager.lIa("argumentAssistanceOverall"))}dispose(){if(this.$){const la=A.g(this.$);la&&(la.ha&&la.ha.RF(this.Vc),la.view.Pq(this.mt),this.xQ&&la.hc.yl(this.Jf))}L.a.Ia(this.pr);this.$=null}rDd(la){const jb=new Db;jb.functionRenderingInfo=la;jb.cardMode=this.S1;this.iHd(jb);return jb}iHd(la){la.callbacks=new Nc;la.callbacks.onHelpLink=
this.ydd(la.functionRenderingInfo);la.callbacks.onCardModeChange=this.onCardModeChange;la.callbacks.onFeedback=this.OQa;this.Z3&&(la.callbacks.onDismissClick=this.onDismissClick)}ydd(la){return()=>{X(this.$,la.helpID,la.isUDF)}}VNd(){const la=zb.a.get(x.a.DZb);this.S1=la?parseInt(la,10):Zb.J4c;this.formulaAssistanceTelemetryManager.KXf(this.S1)}wCd(la){var jb=la.functionRenderingInfo.functionName;this.Aka&&bb.a.equals(this.Aka,jb,!0)?(jb=ic.a.map(la.functionRenderingInfo.signatures,ra=>{let hb="";
0<=ra.signatureParams.activeParam&&ra.signatureParams.activeParam<ra.signatureParams.params.length&&(hb=ra.signatureParams.params[ra.signatureParams.activeParam]);return hb}),this.raiseEvent("FAParameterSelectionChanged",new Za(jb))):(this.Aka=jb,la=ic.a.map(la.functionRenderingInfo.signatures,ra=>ra.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new hc(jb,la)))}BNb(la){this.S1=la;try{zb.a.Mw(x.a.DZb,la.toString(),Qb.AFrame.Uda)}catch(jb){l.ULS.sendTraceTag(537162074,0,
15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${jb.message}`)}}static nJa(){return document.createElement("div")}}Zb.J4c=0;Object(d.a)(Zb,"FormulaArgumentAssistanceControl",wb.a,[621]);var Bc;(function(la){la[la.Dismissed=0]="Dismissed";la[la.Smart=1]="Smart";la[la.Simple=2]="Simple";la[la.Mixed=3]="Mixed"})(Bc||(Bc={}));Object(d.b)("UIState",Bc);class bd extends wb.a{constructor(la,jb,ra){super(bd.nJa());this.$=la;this.formulaAssistanceUIControl=jb;this.formulaAssistanceTelemetryManager=
ra;this.pr=this.Ya=this.gridView=null;this.q$=this.Iha=this.OHa=this.NHa=this.PHa=this.RHa=this.QHa=!1;this.gr=null;this.gW=0;this.Qq=null;this.$Ra=this.rna=this.HD=this.afa=this.Ov=!1;this.pNb=Bc.Dismissed;this.onRestoreFocus=()=>{};this.dismiss=()=>{this.Ov=!1;this.a6a&&(this.HD||this.mSd)&&this.ILa&&(this.q$=!0);this.Lsd();this.sF&&this.Ya.eb&&this.lma();this.Qq=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.domElement),this.pr.kf=!1,this.pNb=Bc.Dismissed)};
this.Fgd=()=>{this.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};this.$ba=(hb,Eb)=>{0==Eb.Lq&&(170==Eb.xf.operation.operationName&&this.formulaAssistanceTelemetryManager.mic++,this.$.userOperationManager.Co(this.$ba))};this.jOa=(hb,Eb)=>{0==Eb.Lq&&(12==Eb.xf.operation.operationName&&this.$.userOperationManager.Hr(this.$ba),this.$.userOperationManager.Co(this.jOa))};this.lIi=()=>{this.dismiss();this.gridView.Di.textBox.focus()};this.OQa=()=>{const hb={};this.ZDf?hb[x.a.rU]="SmartSuggestionsCard":
hb[x.a.rU]="FunctionAndSmartSuggestionsCard";this.$.ud(802602464,0,8,hb)};this.Jf=()=>{this.ILa&&this.dIg()};this.Lyd=(hb,Eb)=>{this.Teb(Eb);this.RHa=!0};this.Vc=()=>{this.visible=!1};this.Kyd=hb=>{this.OHa=!0;this.Ppb(hb)};this.Gh=()=>{this.dismiss()};this.mt=()=>{void 0!==this.Qq&&null!==this.Qq&&this.Qq()};this.gridView=A.g(this.$);this.pr=new Oc(this.$,this.formulaAssistanceUIControl,1,Ha.a.Bad,this.Fgd);this.gridView.view.Ls(this.mt);this.gridView.ha.NG(this.Vc);this.$.xa.Pf(this.Gh);this.ILa=
Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");this.S8=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");this.a6a=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6650011_LogSuggestionsDismissal");this.ILa&&this.gridView.hc.em(this.Jf);Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement);this.pii=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")}ime(la){this.addHandler("FACardOpened",
la)}HPf(la){this.removeHandler("FACardOpened",la)}gme(la){this.addHandler("FAFocusOnSmartSuggestionsCard",la)}FPf(la){this.removeHandler("FAFocusOnSmartSuggestionsCard",la)}hme(la){this.addHandler("FormulaAutoCompleteShown",la)}GPf(la){this.removeHandler("FormulaAutoCompleteShown",la)}lUc(la){this.addHandler("SelectedRowChanged",la)}JId(la){this.removeHandler("SelectedRowChanged",la)}pYb(la){this.addHandler("ListBoxUpdated",la)}Brc(la){this.removeHandler("ListBoxUpdated",la)}dispose(){this.$&&(this.S8&&
(this.$.userOperationManager.Co(this.$ba),this.$.userOperationManager.Co(this.jOa)),this.gridView&&(this.gridView.ha&&this.gridView.ha.RF(this.Vc),this.gridView.hc&&this.ILa&&this.gridView.hc.yl(this.Jf),this.gridView.view.Pq(this.mt)),this.$.xa&&this.$.xa.zg(this.Gh));L.a.Ia(this.pr);this.$=null}QDg(la){this.addHandler("CVIC",la)}caj(la){this.removeHandler("CVIC",la)}get visible(){return this.Ov}set visible(la){la||this.dismiss();this.Ov=la}get sF(){return this.afa}get mSd(){var la,jb;return 1===
(null===(jb=null===(la=this.gr)||void 0===la?void 0:la.items[0])||void 0===jb?void 0:jb.type)}get ZDf(){return 1===this.gr.items.length&&this.mSd}Th(la,jb){if(!this.visible)return!1;this.lAc(jb);let ra;return(ra=this.w2h(jb)).Wbc?ra.result:this.pwj(jb)}Yvb(la){if(!this.visible)return!1;let jb=!1;switch(la){case 1872288872:this.sF&&this.lma();this.a6a&&this.mSd&&(this.formulaAssistanceTelemetryManager.UE(["autoCompleteSmartSuggestionActiveDismissing"]),this.Iha=!0);this.visible=!1;jb=!0;break;case -798660877:this.Teb(this.Evb(this.gW+
1));jb=!0;break;case 137938150:this.Teb(this.Evb(this.gW-1));jb=!0;break;case 2091832999:this.Teb(this.Evb(this.gW+8));jb=!0;break;case 742457698:this.Teb(this.Evb(this.gW-8));jb=!0;break;case 125627505:case 267796030:this.Ppb(this.gr.items[this.gW]),jb=!0}return jb}show(la){this.Ya=this.gridView.Di;this.Ov=!0;this.gW=0;this.gr=la;0<this.gr.items.length&&(this.render(),this.Teb(this.Evb(this.gW)),this.a6a?this.ILa&&(1===this.gr.items[0].type?(this.HD||this.formulaAssistanceTelemetryManager.dG(["autoCompleteSmartSuggestionActiveDismissing",
"autoCompleteSmartSuggestionAccepted"]),this.HD=!0):this.HD&&(this.q$=!0)):1===this.gr.items[0].type&&this.ILa&&(this.HD=!0));this.formulaAssistanceTelemetryManager.T8e(la.items)}lma(){this.afa=!1;this.Ya.fHe()}pwj(la){return[1872288872,-798660877,137938150,2091832999,742457698,125627505,267796030].includes(la)}w2h(la){return this.sF?125627505===la||267796030===la?(this.Ppb(this.gr.items[this.gW]),{Wbc:!0,result:!1}):!this.ZDf||-798660877!==la&&137938150!==la?{Wbc:!1}:{Wbc:!0,result:!1}:{Wbc:!1}}render(){this.formulaAssistanceTelemetryManager.dG(["autoCompleteRender"]);
if(this.formulaAssistanceUIControl){const la={};la.zoomLevel=H(this.$);this.formulaAssistanceUIControl.updateContext(la);this.Qq=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.domElement,this.Ya.textBox.domElement,this.mdd())};this.Qq();this.F2i();this.pr.kf=!0;this.Vjh()}}Vjh(){this.formulaAssistanceTelemetryManager.UE(["autoCompleteRender"]);this.formulaAssistanceTelemetryManager.lIa("autoCompleteOverall");const la=this.gr.items.some(ra=>1===ra.type),jb=this.gr.items.some(ra=>
0===ra.type);la&&jb?this.formulaAssistanceTelemetryManager.lIa("autoCompleteOverallSimpleAndSmart"):la?this.formulaAssistanceTelemetryManager.lIa("autoCompleteOverallSmartOnly"):jb&&this.formulaAssistanceTelemetryManager.lIa("autoCompleteOverallSimpleOnly")}F2i(){const la=this.pNb;this.pNb=this.SYh(this.gr.items);la!==Bc.Dismissed&&la!==Bc.Smart||this.pNb!==Bc.Simple&&this.pNb!==Bc.Mixed||this.raiseEvent("FormulaAutoCompleteShown")}l3i(){var la;if(this.pii&&0!==this.gr.items.length){var jb=0<=this.gW?
this.gW:0,ra=this.gr.items[jb];ra={YF:ra.label,description:null!==(la=ra.detail)&&void 0!==la?la:"",selectedIndex:jb+1,length:this.gr.items.length};this.raiseEvent("SelectedRowChanged",ra)}}Ppb(la){if(this.Ya&&this.visible){var jb=la.textEdit;this.Nkd(this.Ya.text,jb);this.Ya.textBox.caretPosition=jb.range.start.character+jb.newText.length;this.sF&&(this.afa=!1,this.ILa&&(this.a6a&&this.formulaAssistanceTelemetryManager.UE(["autoCompleteSmartSuggestionAccepted"]),this.$Ra=this.rna=!0),this.S8&&this.Iqj(),
this.gridView.A$.BXf(),this.Ya.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",{shouldRequestAutocompleteOnCommit:la.shouldRequestAutocompleteOnCommit});this.formulaAssistanceTelemetryManager.S8e(la.kind)}}Iqj(){this.formulaAssistanceTelemetryManager.TH={Ck:this.gridView.ha.sa.activeCell,cpb:this.gridView.Xb.text,Rpb:!0};this.formulaAssistanceTelemetryManager.lic=this.$.xa.pa.sheetId;this.formulaAssistanceTelemetryManager.RAb=this.$.ea.Ke;this.$.userOperationManager.Hr(this.jOa)}dIg(){this.a6a&&
this.q$&&!this.Iha&&!this.rna&&(this.formulaAssistanceTelemetryManager.tJ.dismissSmartSuggestionImplicitlyCounter++,this.q$=!1);this.HD&&(this.formulaAssistanceTelemetryManager.CM.smartSuggestionShownCounter++,this.HD=!1);this.rna&&(this.formulaAssistanceTelemetryManager.CM.smartSuggestionSelectedCounter++,this.rna=!1);this.$Ra&&(this.formulaAssistanceTelemetryManager.CM.smartSuggestionCommittedCounter++,this.$Ra=!1)}mdd(){const la=new wc;la.completionItems=this.gr.items;la.activeItemIndex=this.gW;
this.dHd(la);return la}dHd(la){la.callbacks=new Sb;la.callbacks.onCompletionItemSelected=this.Lyd;la.callbacks.onCompletionItemCommitted=this.Kyd;la.callbacks.onFeedback=this.OQa;la.callbacks.onDismiss=this.lIi;la.callbacks.onRestoreFocus=this.onRestoreFocus}IDd(la){this.afa=!0;const jb=la.textEdit.newText;this.Ya.ddb(jb.substring(this.Ya.text.length-la.textEdit.range.start.character,jb.length))}Teb(la){const jb=this.gW;this.gW=la;const ra=this.gr.items[la];this.sF&&this.lma();jb!==la&&this.render();
1===ra.type&&Pa.EwaSettings.xb()&&!this.gridView.Di.text.includes("\n")&&this.IDd(ra);this.l3i()}Evb(la){return 0>la?0:Math.min(la,this.gr.items.length-1)}Nkd(la,jb){this.Ya.text=la.substring(0,jb.range.start.character)+jb.newText+la.substring(jb.range.end.character,la.length);this.gridView.lm&&(this.gridView.Xb.text=this.Ya.text)}Lsd(){this.QHa&&(this.formulaAssistanceTelemetryManager.tJ.selectByArrowKeyCounter++,this.QHa=!1);this.RHa&&(this.formulaAssistanceTelemetryManager.tJ.selectByMouseHoverCounter++,
this.RHa=!1);this.PHa&&(this.formulaAssistanceTelemetryManager.tJ.commitByTabKeyCounter++,this.PHa=!1);this.NHa&&(this.formulaAssistanceTelemetryManager.tJ.commitByEnterKeyCounter++,this.NHa=!1);this.OHa&&(this.formulaAssistanceTelemetryManager.tJ.commitByMouseClickCounter++,this.OHa=!1);this.a6a&&this.Iha&&(this.formulaAssistanceTelemetryManager.tJ.dismissSmartSuggestionExplicitlyCounter++,this.Iha=!1)}lAc(la){switch(la){case -798660877:case 137938150:case 2091832999:case 742457698:this.QHa=!0;break;
case 125627505:this.PHa=!0;break;case 267796030:this.NHa=!0}}static nJa(){return document.createElement("div")}SYh(la){return la.reduce((jb,ra)=>jb|=0===ra.type?Bc.Simple:Bc.Smart,Bc.Dismissed)}}Object(d.a)(bd,"FormulaAutoCompleteControl",wb.a,[618,2,567]);var Ed=a(750);class ge{constructor(la,jb){var ra,hb;this.Rg=la;this.$=jb;this.aya=()=>{this.d8b.resolve(this.Rg.Qk);this.Fag()};this.Xwf=()=>{this.d8b.reject(null);this.Fag()};this.Jf=()=>{this.Rg.qbb();this.lrd=null};null===(hb=null===(ra=A.g(this.$))||
void 0===ra?void 0:ra.hc)||void 0===hb?void 0:hb.em(this.Jf);this.LBj=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6476169_skipGetFieldInfoListContextIfContextLoaded")}getRichValueFieldListContext(la,jb,ra,hb){const Eb={K9:la,YHe:jb};var fc;if(fc=Object(Ed.b)(this.lrd))fc=this.lrd,fc=!(Eb.K9.FirstRow===fc.K9.FirstRow&&Eb.K9.FirstColumn===fc.K9.FirstColumn&&Eb.K9.LastRow===fc.K9.LastRow&&Eb.K9.LastColumn===fc.K9.LastColumn&&Eb.K9.SheetName===fc.K9.SheetName&&Eb.YHe===fc.YHe);fc&&this.Rg.qbb();this.lrd=
Eb;this.LBj&&this.Rg.O5a||this.Rg.KY(la,ra,hb,jb);this.d8b=new Ed.a;this.Rg.O5a?this.d8b.resolve(this.Rg.Qk):this.q7i();return this.d8b.promise}dispose(){var la,jb;null===(jb=null===(la=A.g(this.$))||void 0===la?void 0:la.hc)||void 0===jb?void 0:jb.yl(this.Jf)}q7i(){this.Rg.hYb(this.aya);this.Rg.zEg(this.Xwf)}Fag(){this.Rg.trc(this.aya);this.Rg.Iaj(this.Xwf)}}Object(d.a)(ge,"ServerDataProvider",null,[597]);var be=a(317),qe=a(576),ze=a(338),Ce=a(870);class Ve{constructor(la){this.iK=this.jK=this.qF=
this.rF=!1;this.uZ=la}}Object(d.a)(Ve,"MarqueeRangeData",null,[]);class we{constructor(la,jb,ra,hb=!1){this.zUd=la;this.BMb=jb;this.t6a=hb;ra?(this.uZ=ra.uZ,this.rF=ra.rF,this.qF=ra.qF,this.jK=ra.jK,this.iK=ra.iK):l.ULS.shipAssertTag(524039642,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}}Object(d.a)(we,"MarqueeMetadata",null,[]);const vc="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");
class ed{constructor(la,jb){this.$=la;this.pluginScheduler=jb;this.hK=this.Edb=!1;this.Qga=void 0;this.nh=()=>{this.Qga=void 0};this.Vxa=()=>{this.hK=!1;this.Qga=void 0};this.gridView=A.g(la);this.gridView.Xb.em(this.Vxa);this.Qzb=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6635594_updatedTriggeringX10FormulaHighlighting")}get coloredReferencesManager(){this.wUa||(this.wUa=this.$.da.za(281));return this.wUa}LNj(la,jb,ra){return isNullOrUndefined(this.coloredReferencesManager)?!1:this.coloredReferencesManager.ueb(la,
jb,ra)}ueb(la,jb,ra){var hb;if(this.Edb||la.sF)return!1;const Eb=isNullOrUndefined(jb)?la.text:jb;if(1>=Eb.length)return this.edg(la,Eb,Object(Ed.b)(jb));ra=this.bZh(la,jb,ra);if(this.Qzb&&this.Jxj(la,{content:Eb,selection:ra}))return!0;var fc=null===(hb=this.w3a(Eb,ra))||void 0===hb?void 0:hb.formulaHighlights;if(!fc)return l.ULS.sendTraceTag(512349465,0,50,"FormulaHighlightsControl.tryUpdateFormulaHighlights: formulaHighlights is null (might be an invalid formula)"),this.edg(la,Eb,Object(Ed.b)(jb));
hb=[];ra=new sc.a(!1);const Mc=[],xd=[],Hd=[];var Md=0;const ae=this.dja();for(const me of fc){this.iE(Mc,Eb,Md,me.span.start,null);switch(me.kind){case 0:case 1:case 2:fc=nc.B(me.rangeInfo.sharedRange);if(isNullOrUndefined(fc)){l.ULS.sendTraceTag(512349464,0,10,`FormulaHighlightsControl.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:${me.kind.toString()}`);this.iE(Mc,Eb,me.span.start,me.span.end,null);break}Md=this.JY(fc,ra,1);this.iE(Mc,Eb,me.span.start,
me.span.end,Md);hb.push(new ze.a(fc,ae));xd.push({Start:me.span.start,End:me.span.end});fc=Mc.length-1;Hd.push(new we(fc,Mc[fc].text,c(me)));break;case 3:this.iE(Mc,Eb,me.span.start,me.span.end,null,"rgba(229, 229, 229, 1)")}Md=me.span.end}this.iE(Mc,Eb,Md,Eb.length);this.svc(la,Mc,!!jb);jb=la.textBox.text;if(!bb.a.equals(jb,Eb,!1))return l.ULS.shipAssertTag(38114182,0,!1,`FormulaHighlightsControl.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [${jb.length}], updatedTextLength [${Eb.length}]`),
jb=la.textBox.caretPosition,la.textBox.text=Eb,la.textBox.caretPosition=jb,!0;this.lz(hb,ra,Hd);return this.hK=!0}edg(la,jb,ra){this.lz(null,null);this.Qga=void 0;if(this.hK){this.hK=!1;const hb=la.textBox.caretPosition;la.textBox.setPlainText(jb);la.textBox.caretPosition=Math.min(hb,jb.length);if(ra)return!0}return!1}Jxj(la,jb){var ra,hb,Eb,fc;const Mc=(null===(ra=this.Qga)||void 0===ra?void 0:ra.vM)===la&&(null===(hb=this.Qga)||void 0===hb?void 0:hb.v6c.content)===jb.content&&(null===(Eb=this.Qga)||
void 0===Eb?void 0:Eb.v6c.selection.index)===jb.selection.index&&(null===(fc=this.Qga)||void 0===fc?void 0:fc.v6c.selection.length)===jb.selection.length;Mc||(this.Qga={v6c:jb,vM:la});return Mc}bZh(la,jb,ra){let hb=ra;Object(Ed.b)(jb)?Object(Ed.b)(ra)||(hb={index:jb.length,length:0}):hb=la.textBox.selection;return hb}uCb(la,jb,ra){if(!la||!jb||!ra)return l.ULS.shipAssertTag(512349463,0,!!la,"FormulaHighlightsControl.MoveMarqueeRange: cellContentEditor is null"),l.ULS.shipAssertTag(512349462,0,!!jb,
"FormulaHighlightsControl.MoveMarqueeRange: highlightState is null"),l.ULS.shipAssertTag(512349461,0,!!ra,"FormulaHighlightsControl.MoveMarqueeRange: newRange is null"),!1;const hb=Object(Na.a)(we,jb.metadata);if(!hb)return l.ULS.shipAssertTag(512349460,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: marqueeMetadata is null"),!1;var Eb=hb.zUd,fc=hb.BMb,Mc=this.gridView.Db.zmd(ra)?ra.Fub(hb.qF,hb.rF):ra.RJa(hb.qF,hb.rF,hb.iK,hb.jK);if(!Mc)return l.ULS.shipAssertTag(512349459,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: newText is null"),
!1;const xd=fc.indexOf("!");-1!==xd&&(Mc=fc.substring(0,xd+1)+Mc);if(!la.textBox.changeTextInExistingTextPart(Eb,fc,Mc))return l.ULS.shipAssertTag(38926105,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: failed to change the text part"),!1;hb.BMb=Mc;Eb=!0;for(fc=1;4>=fc;fc++)(Mc=A.g(this.$).lb.dv(3,fc,jb.xT))?(Mc.range=ra,Mc.metadata=hb):(l.ULS.shipAssertTag(512349458,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: highlightStateInPane is null"),Eb=!1);this.gridView.lb.update(!1,!1);this.gridView.lm&&
(this.gridView.hc.textBox.text=la.text);this.gridView.hc.lPa(new be.a({oyb:!0}));return Eb}xii(la){if(3!==la.xq)return l.ULS.shipAssertTag(512349457,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: not HighlightDivIndex.Marquee."),!1;la=Object(Na.a)(we,la.metadata);return la?la.uZ&&!la.t6a:(l.ULS.shipAssertTag(512349456,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: marqueeMetadata is null."),!1)}zAa(la,jb){l.ULS.sendTraceTag(512349455,0,50,"FormulaHighlightsControl.SuspendResumeColoredReferences: "+
(jb?"suspending":"resuming")+" colored references");jb&&this.hK&&(this.hK=!1,this.lz(null,null),la.textBox.Hxe());this.Edb=jb}dispose(){var la;this.gridView&&this.gridView.Xb&&this.gridView.Xb.yl(this.Vxa);(null===(la=this.gridView)||void 0===la?0:la.hc)&&this.gridView.hc.tk(this.nh);this.Qga=void 0}IKa(la){var jb=this.w3a(la,Ce.a);if(isNullOrUndefined(jb))this.Qaa&&this.lz(null,null);else{var ra=this.dja(),hb=[],Eb=new sc.a(!1),fc=[];jb=jb.formulaHighlights;for(const Mc of jb)if(jb=Mc.kind,0===jb||
2===jb||1===jb)jb=nc.B(Mc.rangeInfo.sharedRange),Object(Ed.b)(jb)&&(hb.push(new ze.a(jb,ra)),this.JY(jb,Eb,1),fc.push(new we(Mc.span.start,la.substring(Mc.span.start,Mc.span.end),c(Mc),!0)));this.lz(hb,Eb,fc)}}w3a(la,jb){la=this.pluginScheduler.syncRequester().formulaHighlighting({content:la,caretPosition:null===jb||void 0===jb?void 0:jb.index,selectionLength:null===jb||void 0===jb?void 0:jb.length});if(isNullOrUndefined(la)||isNullOrUndefined(la.formulaHighlights))l.ULS.sendTraceTag(512349454,0,
10,`FormulaAssistanceManager.getFormulaHighlights: formulaHighlightingResult is null or undefined, formulaHighlights array is null:${!isNullOrUndefined(la)}`);else return la}JY(la,jb,ra){let hb=jb.getItem(la.toString());hb||(hb=vc[jb.count%vc.length],jb.add(la.toString(),hb));return String.format(hb,ra)}iE(la,jb,ra,hb,Eb=null,fc=null){l.ULS.shipAssertTag(512349453,0,ra<=hb,"FormulaHighlightsControl.AddTextPart: startIndex cannot be larger than endIndex");ra<hb&&(jb=jb.substring(ra,hb),la.push(Object(Ob.a)(new qe.a,
{text:jb,color:Eb,backgroundColor:fc})))}lz(la,jb,ra=null){la&&la.length?(l.ULS.sendTraceTag(512349452,0,50,"FormulaHighlightsControl.HighlightRanges: number of ranges to highlight: "+la.length),la.reverse(),ra.reverse(),this.gridView.lb.vv(la,[3],!0,(hb,Eb)=>{if(hb&&hb.range&&Eb){l.ULS.shipAssertTag(512349448,0,jb.mb(hb.range.toString()),`FormulaHighlightsControl.HighlightRanges: The range '${hb.range.toString()}' doesn't exist in the range to color dictionary`);var fc=this.JY(hb.range,jb,.1),Mc=
this.JY(hb.range,jb,1);this.$.frame&&this.$.frame.ZC&&this.$.frame.ZC.Zaa||(Eb.style.background=fc);Eb.style.borderColor=Mc;ra&&(Eb.setAttribute(x.a.c5a,hb.xT.toString()),hb.metadata=ra[hb.xT])}else l.ULS.shipAssertTag(512349451,0,!!hb,"FormulaHighlightsControl.HighlightRanges: state is null"),l.ULS.shipAssertTag(512349450,0,!!hb.range,"FormulaHighlightsControl.HighlightRanges: state.Range is null"),l.ULS.shipAssertTag(512349449,0,!!Eb,"FormulaHighlightsControl.HighlightRanges: div is null")})):(la=
this.$.Ib.Bc("UserAction","HideRangesHighlightsStopwatch"),this.gridView.lb.Mg([3]),this.gridView.lb.fRa(new ze.a(null,this.dja()),[3]),la.stop())}svc(la,jb,ra){const hb=la.textBox;hb.kF=!0;var Eb=hb.selection;const fc=Eb.index;Eb=fc+Eb.length;hb.setTextFromTextParts(jb);jb=hb.text.length;hb.selectRange(Math.min(fc,jb),Math.min(Eb,jb));ra&&la.lPa(new be.a);hb.kF=!1}rac(){return this.gridView.Mq&&this.gridView.Mq.LF?this.gridView.Mq.LF:this.$.pa}dja(){return this.rac().sheetId}}Object(d.a)(ed,"FormulaHighlightsControl",
null,[596,2]);class Id{constructor(la,jb,ra,hb,Eb,fc,Mc){this.$=la;this.functionInfoManager=jb;this.calcManager=ra;this.pluginScheduler=hb;this.formulaAssistanceUIControl=Eb;this.formulaAssistanceTelemetryManager=fc;this.Rg=Mc;this.ARa=!0;this.sLa=this.isCellContentOnlyEqualDuringEdit=!1;this.axa=null;this.JMa=-1;this.wV=0;this.Waa=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.Zyb=Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",
!1);this.Fh=(xd,Hd)=>{this.gridView.eb||this.gridView.xi||this.NNa(null===Hd||void 0===Hd?void 0:Hd.cell)};this.nh=(xd,Hd)=>{this.NNa(null===Hd||void 0===Hd?void 0:Hd.Bia)};this.onFunctionInfoLoaded=()=>{this.functionInfoManager.Rab(this.onFunctionInfoLoaded);this.TSj();this.Uca()};this.stf=()=>{this.ARa=!1};this.Atf=(xd,Hd)=>{var Md=this.Ya;xd=Md.text;Md=Md.textBox.caretPosition;0<this.wV&&this.formulaAssistanceTelemetryManager.tJ.commitWhileRequestPending++;this.formulaAssistanceTelemetryManager.dG(["argumentAssistanceComputation",
"argumentAssistanceOverall"]);Hd.shouldRequestAutocompleteOnCommit?this.LWf(xd,Md):this.MJd(xd,Md)};this.Jf=()=>{this.E1&&(this.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.CM.isCellContentOnlyEqualDuringEditCounter++,this.isCellContentOnlyEqualDuringEdit=!1),this.sLa&&(this.formulaAssistanceTelemetryManager.CM.isCellContentFormulaCounter++,this.sLa=!1));this.ARa=!0;Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&this.t5b()};this.r5=
(xd,Hd)=>{this.qLd(Hd.newValue)};this.Li=()=>{this.lcg()};this.lcg=()=>{this.pluginScheduler.notifier().setDefinedNamesInfo(this.P4b.MFe)};this.w3a=(xd,Hd)=>{xd=this.pluginScheduler.syncRequester().formulaHighlighting({content:xd,caretPosition:null===Hd||void 0===Hd?void 0:Hd.index,selectionLength:null===Hd||void 0===Hd?void 0:Hd.length});if(isNullOrUndefined(xd)||isNullOrUndefined(xd.formulaHighlights))l.ULS.sendTraceTag(521211933,0,10,`FormulaAssistanceManager.getFormulaHighlights: formulaHighlightingResult is null or undefined, formulaHighlights array is null:${!isNullOrUndefined(xd)}`);
else return xd};this.functionInfoManager=jb;this.formulaAssistanceUIControl=Eb;this.pluginScheduler=hb;this.gridView=A.g(this.$);this.jef=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");this.Z3=Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.lxd=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.E1=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");
this.ZWc=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");this.Jgi=Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6646054_FixNoPreviewBugEnabled");this.jef&&(this.P4b=new Tb(la),this.gridView.Ea.kx(this.Li),this.lcg());this.ypa=new Zb(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.X7=new bd(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.ehi=D.a.TU(la);this.Iwa=D.a.Iwa(la);this.VU=D.a.VU(la);
this.ehi&&(this.zpa=new ed(this.$,this.pluginScheduler));la.da.Ga(464,this);this.calcManager=ra;D.a.UU()&&this.ykd();this.E1&&this.gridView.hc.em(this.Jf);this.Z3&&(this.E1||this.gridView.hc.em(this.Jf),this.ypa.bEg(this.stf));this.amd=Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1)}get Eia(){return this.X7}get BTe(){return this.ypa}get ez(){return this.zpa}get v$a(){return this.Ya.Xji?1:0}get Ya(){return this.gridView.Di}get Db(){return this.gridView.Db}dispose(){if(this.$){const la=
this.gridView;la&&(la.ha&&D.a.UU()&&(this.Zyb?la.hc.tk(this.nh):la.ha.mma(this.Fh)),this.jef&&la.Ea&&la.Ea.sv(this.Li))}this.E1&&this.gridView.hc.yl(this.Jf);this.Z3&&(this.E1||this.gridView.hc.yl(this.Jf),this.ypa.paj(this.stf));this.X7.caj(this.Atf);this.functionInfoManager&&this.functionInfoManager.Rab(this.onFunctionInfoLoaded);D.a.lec&&this.Ya&&this.Ya.GHb(this.r5);L.a.Ia(this.ypa);L.a.Ia(this.X7);this.X7=this.ypa=this.functionInfoManager=this.$=null}afj(){this.JMa=-1;this.axa=null}t5b(){this.X7.visible=
!1;this.ypa.visible=!1}Th(){this.Uca();return!1}Uca(){if(!this.Ya.lI)if(this.formulaAssistanceTelemetryManager.Vnb.formulaAssistanceRequestAttemptedCounter++,this.$wj()){this.functionInfoManager.qZ||(this.functionInfoManager.aYa(this.onFunctionInfoLoaded),this.functionInfoManager.z1a({}));var la=this.Ya,jb=la.text;la=la.textBox.caretPosition;this.E1&&jb.startsWith("=")&&(this.sLa=!0,1===jb.length&&(this.isCellContentOnlyEqualDuringEdit=!0));!this.Z3||this.ARa?(this.formulaAssistanceTelemetryManager.dG("argumentAssistanceComputation autoCompleteComputation argumentAssistanceOverall autoCompleteOverall autoCompleteOverallSmartOnly autoCompleteOverallSimpleOnly autoCompleteOverallSimpleAndSmart".split(" ")),
this.LWf(jb,la)):(this.formulaAssistanceTelemetryManager.dG(["autoCompleteComputation","autoCompleteOverall"]),this.Kej(jb,la));Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutoCompleteWrapperPluginRequest",!1)&&this.Jej(jb,la)}else this.formulaAssistanceTelemetryManager.Vnb.formulaAssistanceRequestOptimizedCounter++}LWf(la,jb){jb=this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:la,caretPosition:jb},argumentAssistance:{content:la,
caretPosition:jb}});this.wV+=1;jb.then(ra=>{--this.wV;0===ra.kind&&(this.U3e(ra.payload.argumentAssistance),this.y4e(ra.payload.functionSuggestion,la));return null})}Kej(la,jb){jb={content:la,caretPosition:jb};jb=this.Waa?this.pluginScheduler.getRequester().functionSuggestion(jb,this.v$a):this.pluginScheduler.requester().functionSuggestion(jb);this.wV+=1;jb.then(ra=>{--this.wV;0===ra.kind&&this.y4e(ra.payload,la);return null})}Jej(la,jb){jb={content:la,caretPosition:jb,enableAutocompleteWrapperPlugin:this.Iwa&&
!this.VU&&"="===la};this.Waa&&(jb=this.pluginScheduler.getRequester().runPerCharacterExperiment(jb,this.v$a),this.wV+=1,jb.then(ra=>{--this.wV;if(0===ra.kind)for(const hb of ra.payload.results)0===hb.kind&&this.gridView.A$.aOd(hb.value,la);return null}))}MJd(la,jb){la={content:la,caretPosition:jb};la=this.Waa?this.pluginScheduler.getRequester().argumentAssistance(la,this.v$a):this.pluginScheduler.requester().argumentAssistance(la);this.wV+=1;la.then(ra=>{--this.wV;0===ra.kind&&this.U3e(ra.payload)})}$wj(){var la=
this.Ya;const jb=la.text;la=la.textBox.caretPosition;if(this.X7.visible&&bb.a.equals(jb,this.axa,!0)&&(!this.Jgi||!Oa.e(jb))&&la===this.JMa)return!1;this.axa=jb;this.JMa=la;return!0}sLd(){this.Waa?this.pluginScheduler.getRequester().runExperiment(new Uc,this.v$a):this.pluginScheduler.requester().runExperiment(new Uc)}U3e(la){la&&this.Ya.eb?(this.formulaAssistanceTelemetryManager.UE(["argumentAssistanceComputation"]),this.ypa.show(la,this.Ya.textBox.domElement)):this.ypa.dismiss()}y4e(la,jb){la&&0<
la.items.length&&this.Ya.eb&&this.Ya.text===this.axa?this.ZWc&&this.Db.s4(this.gridView.ha.sa.activeCell)?(this.formulaAssistanceTelemetryManager.CM.smartSuggestionWouldSuggestInsidePivotCounter++,this.X7.dismiss()):(this.formulaAssistanceTelemetryManager.UE(["autoCompleteComputation"]),this.X7.show(la)):this.X7.dismiss();this.Iwa&&this.gridView.A$.aOd(la,jb)}qLd(la){la={content:la,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.Waa?this.pluginScheduler.getRequester().runAuthoringExperiment(la,
this.v$a):this.pluginScheduler.requester().runAuthoringExperiment(la)}NNa(la){var jb;const ra=this.gridView.ha.sa.activeCell;if(ra){var hb=this.calcManager.Bsa(ra,!this.amd);if(hb){var Eb=this.$.xa,fc=hb.sheet.index;0>=Eb.count||0>fc||fc>=Eb.count||(fc=Eb=null,this.lxd&&void 0!==this.calcManager&&null!==this.calcManager&&(la=null!==(jb=null===la||void 0===la?void 0:la.cell)&&void 0!==jb?jb:this.gridView.Ea.Sr(ra))&&(jb=this.calcManager.lac(la.Gk),void 0!==jb&&null!==jb&&(Eb=jb.FormatString,fc=jb.Builtin)),
this.pluginScheduler.notifier().setActiveCell({colIndex:hb.range.col,rowIndex:hb.range.row,sheetIndex:this.$.xa.getItem(hb.sheet.index).sheetId,docName:hb.sheet.document.name,docPath:hb.sheet.document.path,formatString:Eb,builtIn:fc}))}else l.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}}TSj(){this.pluginScheduler.notifier().setFunctionsInfo(this.functionInfoManager.q9b)}ykd(){this.Zyb?this.gridView.hc.Nk(this.nh):this.gridView.ha.iga(this.Fh);
const la=D.a.Oxb()?this.gridView.Vb(null):void 0;this.NNa(la);D.a.lec&&this.Ya.YXa(this.r5);this.sLd();this.X7.QDg(this.Atf);this.pluginScheduler.setServerDataProvider(new ge(this.Rg,this.$));this.Uca()}ueb(la,jb,ra){ra=Object(Ed.b)(jb)?this.w3a(jb,Object(Ed.b)(ra)?ra:Ce.a):this.w3a(la.text,la.textBox.selection);return this.zpa.LNj(la,jb,ra)}}Object(d.a)(Id,"FormulaAssistanceManager",null,[560,2]);a(196);class Ld extends Ya.a{constructor(la){super();this.$=la;this.Fb()}create(){const la=D.a.UU(),
jb=Pa.EwaSettings.ma(373),ra=Pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1),hb=D.a.SU(this.$),Eb=this.$.da,fc=e.GetServiceTaskFactory.create(Eb,134,this.la,this.hb),Mc=e.GetServiceTaskFactory.Ra(this.$.da,12,477,this.hb);let xd;xd=D.a.a4()?e.GetServiceTaskFactory.create(this.$.da,449,this.$.la,1):T.Task.Ta(null);let Hd;Hd=D.a.UU()?e.GetServiceTaskFactory.create(this.$.da,414,this.$.la,1):T.Task.Ta(null);if(ra||la){const Md=e.GetServiceTaskFactory.Ra(Eb,266,
265,this.hb),ae=e.GetServiceTaskFactory.Ra(Eb,219,220,this.hb),me=e.GetServiceTaskFactory.Ra(Eb,491,492,this.hb);k.TaskExtensions.Aa(k.TaskExtensions.Wd([Md,Hd,xd,ae,me],this.la),()=>{const Re=Eb.za(19)||new Rb(this.$,Hd.result),Xe=ae.result;if(hb){var qf=Eb.za(464);qf||(qf=new Id(this.$,Re,Md.result,Hd.result,xd.result,me.result,Mc.result.s2c(this.$,fc.result)),Xe.fWc(qf.BTe),Xe.gWc(qf.Eia),Pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")&&Xe.hWc(qf.Eia))}else qf=Eb.za(221),
qf||(qf=new ob(this.$,Re,fc.result,Md.result,null,Mc.result,xd.result,me.result,Hd.result),Xe.fWc(qf.CTe),Xe.hWc(qf.$Te),Xe.gWc(qf)),jb&&(Eb.za(317)||new yb(this.$));this.qb(Re)},this.la,3)}else{const Md=e.GetServiceTaskFactory.Ra(Eb,219,220,this.hb),ae=e.GetServiceTaskFactory.Ra(Eb,491,492,this.hb);k.TaskExtensions.Aa(k.TaskExtensions.Wd([Md,xd,Hd],this.la),()=>{const me=Eb.za(19)||new Rb(this.$,Hd.result),Re=Md.result;let Xe=Eb.za(221);Xe||(Xe=new ob(this.$,me,fc.result,null,null,Mc.result,xd.result,
ae.result,Hd.result),Re.fWc(Xe.CTe),Re.hWc(Xe.$Te),Re.gWc(Xe));jb&&(Eb.za(317)||new yb(this.$));this.qb(me)},this.la,3)}}static ka(la){la.da.Ga(153,new Ld(la))}}Object(d.a)(Ld,"FunctionInfoManagerFactory",Ya.a,[]);a.d(C,"a",function(){return ce});const ce=()=>{b.a.Fa(la=>{sa.ka(la);Ca.ka(la);Ld.ka(la)})}},1132:function(t,C,a){var c=a(0),b=a(691),d=a(148),f=a(7),e=a(15),k=a(82),l=a(4),m=a(155),v=a(1069),n=a(1067),w=a(714),r=a(5),u=a(458),y=a(559),x=a(77),B=a(58),z=a(904),A=a(131),I=a(43),F=a(513),
U=a(170),X=a(61),S=a(50),H=a(748),D=a(145),J=a(37),M=a(121),G=a(209),T=a(90),K=a(71),L=a(35),V=a(29),W=a(281),da=a(1),qa=a(182),O=a(14),ea=a(63),R=a(280),oa=a(21),pa=a(132),Pa=a(767),Z=a(768),Ra=a(125),Ga=a(112),Ba=a(51),fa=a(34),Y=a(418);class ja{constructor(){this.Sections=this.Id=null}}Object(c.a)(ja,"AutoFilterMenu",null,[]);class ca{constructor(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=
this.IconName=null}}Object(c.a)(ca,"MenuItem",null,[]);class aa{constructor(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}}Object(c.a)(aa,"MenuSection",null,[]);class ta{constructor(){this.isSuccess=!1}}Object(c.a)(ta,"ApplyFilterByValueResponse",null,[]);class xa{constructor(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}}Object(c.a)(xa,"FilterByValueItem",null,[]);class ia{constructor(){this.selectedSortIcon=this.selectedSortFontColor=
this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=null}}Object(c.a)(ia,"GetColorsAndIconsResponse",null,[]);class ya{constructor(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}}Object(c.a)(ya,"GetFilterByValueItemsResponse",null,[]);class ib{constructor(){this.autoFilterMenu=this.targetPoint=null}}Object(c.a)(ib,"ShowSortFilterMenuParams",null,[]);class wa{constructor(){this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=
null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}}Object(c.a)(wa,"SortFilterControllerFactoryParams",null,[]);class sa{constructor(){this.top=this.left=0}}Object(c.a)(sa,"TargetPoint",null,[]);var Ya=a(55),bb=a(196),mb=a(33),Ca=a(161),$a=a(225),Kb=a(8);const rb=r.a.w1g;class cc extends w.a{constructor(ra,hb,Eb,fc){super(ra,"PopulateAutoFilterContextMenu",1675506831,1651433993,rb,!0,!1,"AutoFilterContextMenuRoot",hb,Eb,!1,fc);this.tVc=this.USa=this.sheetName=this.Xqb=null;this.h2a=
this.ykf=!1;this.A3c=this.i$a=this.CEe=this.OOa=this.qac=this.b9c=this.JLb=this.TFb=null;this.kV=()=>{this.jxc();this.$.ea.Wn(this.kV)};this.qKi=Mc=>{this.h2a||pa.b(this.$).Cd(A.a.Ywf,this.km(),void 0,!0);var xd={};this.$.Xj(xd);var Hd=this.$.ea.isNamedObjectViewMode;const Md=B.a.Vh(this.tVc);Md.SheetName=Hd?xd.NamedObjectName:xd.SheetName;Md.NamedObjectView=Hd;Hd=!!Mc.searchText;xd=586;this.h2a&&(Hd&&(Md.ItemListOptions=this.k4g(Mc.searchText),xd=597),pa.b(this.$).Cd(A.a.Ywf,{["UserOperation"]:xd.toString()},
void 0,!0));const ae=this.rzd(Hd),me=this.rKi(),Re=this.$.oa.va.Sb();Mc=(Xe,qf,uf)=>this.A3c=X.n(this.$.oa.va,Md,R.b(Xe,ae),this.h2a?R.a(qf,me):qf,uf,null,Re);this.CEe=Re.RequestId;this.h2a&&this.qac&&!this.qac.dequeueUtcTime&&(this.$.userOperationManager.ita(this.qac),this.kUg());Mc=da.EwaSettings.dc()?new U.a(xd,0,Mc,80):new F.a(xd,0,Mc,16);this.qac=this.$.userOperationManager.Ub(Mc,null);this.i$a=this.A3c;this.OOa=this.CEe};this.onMenuItemClick=(Mc,xd,Hd)=>{pa.b(this.$).Cd(A.a.nPi,this.km(),void 0,
!0);xd={["CommandValueId"]:xd,["MenuItemId"]:xd,["InputMethod"]:Hd,["TopCellAddress"]:this.USa};const Md=new T.a(Mc,Hd,this.$.isEditMode?2:1,19,null);this.$.Ka.Mb(Md,xd);e.ULS.sendTraceTag(537167131,0,50,`AutoFilterContextMenu::OnMenuItemClick ${Mc}, ${Hd}`)};this.pFi=Mc=>{if(Mc.checkedItems&&Mc.checkedItems.length){pa.b(this.$).Cd(A.a.qtf,this.km(),void 0,!0);var xd=B.a.Vh(this.tVc),Hd={};this.$.Xj(Hd);Hd.FirstRow=0;Hd.FirstColumn=xd.Column;var Md=this.$.ea.isNamedObjectViewMode;xd.NamedObjectView=
Md;xd.SheetName=Md?Hd.NamedObjectName:Hd.SheetName;var ae=Xe=>{if(Pa.a.iwc(Xe)){const qf=Pa.a.O9b(Xe);this.WLa?Pa.a.WPa(Z.a.applyItemFilter,qf.MessageIdName,Ga.a.Lra,!0,Pa.a.isSessionEndingError(qf.MessageId)):e.ULS.sendTraceTag(537167129,0,10,`AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -${qf.MessageIdName}`)}W.a(Xe)||(e.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),pa.b(this.$).Cd(A.a.Swf,this.km(),void 0,!0),
Xe=Object(f.a)(new ta,{isSuccess:!0}),this.JLb.onApplyFilterByValueFinish(Xe),this.sL(this.USa))},me=this.f2c(xd,Hd),Re=new U.a(208,0,(Xe,qf,uf)=>X.a(this.$.oa.va,me,Mc.checkedItems,R.b(Xe,ae),qf,uf,null,null),6,()=>new z.a(Mc.checkedItems,me));this.dAj(()=>{this.$.userOperationManager.Ub(Re,null)})}else e.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};this.nKg=Mc=>{const xd=I.o(this.USa,this.$),Hd=I.v(this.USa,this.$);
var Md=Object(f.a)(new v.a,{SortConditionType:Mc.type,RowColOffset:xd.FirstColumn-Hd.FirstColumn,SortColor:Mc.color,SortIconSet:Mc.icon.IconSet,SortIcon:Mc.icon.Icon,IsAscending:!0});Md=Object(f.a)(new n.a,{OperationType:1,ActiveCell:xd,SelectedRange:Hd,SortConditions:[Md],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1});const ae={};ae.SortOptions=Md;ae.SelectedRange=Hd;ae.OriginalActiveCell=xd;ae.ShouldRestoreSelection=!1;ae.ShouldPromptNamedSheetViewTeachingDialog=!0;e.ULS.sendTraceTag(537167119,
0,50,`AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: ${Mc.type}`);this.$.ud(-1089513346,x.a.Eb,19,{["CustomSortCommandData"]:ae})};this.WLa=Pa.a.uld();this.nz=da.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")}get Bw(){return"PopulateAutoFilterContextMenu"}get wB(){return r.a.YKf}executeCommand(ra,hb,Eb){ra=hb.command;switch(ra){case 1701016594:return w.a.iwh(Eb),Ya.Task.Ta(!0);case 966232027:if(da.EwaSettings.fl()){const fc=new m.a;J.TaskExtensions.Aa(S.GetServiceTaskFactory.Ra(this.$.da,
8,9,0),Mc=>{this.g5e(hb,Eb,Mc.result);fc.setResult(!0)},this.la,3).continueWith(()=>{fc.setResult(!1)},5,this.la,$a.a.instance);return fc.task}this.g5e(hb,Eb);return Ya.Task.Ta(!0);default:return qa.a(ra)}}g5e(ra,hb,Eb){const fc=hb.domEvent;if(K.e(fc.rawEvent)&&(K.g(fc),fc.target)){var Mc=new D.a(this.$.xa);if(Mc.Ud(4096)||Mc.Ud(2048)){var xd=B.a.Vh(hb[x.a.Zf]);this.D1f(xd)&&(this.ykf?this.Yrc(fc,fc.target,xd,ra,Eb):(this.TFb=()=>{this.D1f(xd)&&(this.iai(),this.Yrc(fc,fc.target,xd,ra,Eb),this.h2a=
da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",!1),this.ykf=!0)},this.jxc()))}}}Cc(ra,hb,Eb){if(ra=!!Eb)switch(hb.command){case 1701016594:case 966232027:da.EwaSettings.fl()||u.a(this.$)||(ra=!1,hb=Ba.b().nj(hb.command),e.ULS.sendTraceTag(537167137,0,15,`AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was ${hb}`));break;default:ra=!1}return ra}RCd(ra){ra.MenuSectionList.push(...this.Xqb)}iai(){Y.a(()=>{this.JLb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(f.a)(new wa,
{getFilterByValueItemsRequest:this.qKi,applyFilterByValueRequest:this.pFi,onMenuItemClick:this.onMenuItemClick,autoFilterMenuWidth:cc.Rre,applySortByColorOrIconRequest:this.nKg}))});this.b9c=k.a.instance.vh("Common.IExternalUICommandDefinitionMapping")||new y.a(this.$.Bb,this.$)}Yrc(ra,hb,Eb,fc,Mc){pa.b(this.$).Cd(A.a.Yrc,this.km(),void 0,!0);e.ULS.shipAssertTag(537167135,0,!!Eb,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");ra=this.FHh(Eb,Mc);fc=Sys.UI.DomElement.getBounds(hb);
hb=fc.x+fc.width;fc=fc.y;if(this.nz&&!Eb.IsHeaderSnapped){if(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!w.a.Zld(this.$,Eb.Cell))return;Eb=w.a.mcd(this.$,Eb.Cell,!0);hb=Eb.x;fc=Eb.y}Eb=oa.g(this.$).rtl?new Sys.UI.Point(hb-fa.a(this.$).wFa(cc.Rre),fc):new Sys.UI.Point(hb,fc);Eb=fa.a(this.$).gja(Eb);Eb=Object(f.a)(new ib,{targetPoint:Object(f.a)(new sa,{left:Eb.x,top:Eb.y}),autoFilterMenu:ra});this.JLb.showSortFilterMenu(Eb);this.$.ud(-544117314,-1,0,null)}D1f(ra){return(null===
ra||void 0===ra?0:ra.Cell.SheetName)?oa.g(this.$).p4?ra.Cell.SheetName===this.$.pa.name:ra.Cell.SheetName===this.$.pa.sheetName:!0}FHh(ra,hb){return(ra=this.GHh(ra,hb))?this.IIf(ra):null}IIf(ra){const hb=[];for(const Eb of ra.Sections){if(Object(Ca.f)(this.$)&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&Eb.Title===O.a.instance.ga(1948))continue;const fc=this.g0i(Eb);hb.push(fc)}return Object(f.a)(new ja,{Id:ra.Id,Sections:hb})}g0i(ra){const hb=[];for(const Eb of ra.MenuItems)if(2===
Eb.Identifier)this.tVc=Eb.CommandData;else switch(Eb.Type){case 3:case 2:hb.push(this.e0i(Eb,2===Eb.Type));break;case 1:hb.push(this.f0i(Eb))}return Object(f.a)(new aa,{MenuItems:hb,DisplayType:ra.DisplayType,Id:this.YEh(ra)})}f0i(ra){({label:Mc,QKa:fc}=this.HUe(ra));const hb=this.IIf(ra.SubMenu),Eb=this.xUe(ra);var fc=this.b9c.E$b(fc);var Mc=Mc||ra.Label;return Object(f.a)(new ca,{Disabled:ra.Disabled,Type:ra.Type,Identifier:ra.Identifier,Id:Eb,CommandData:ra.CommandData,Label:Mc,SubMenu:hb,IsChecked:ra.IsChecked,
IconName:"MissingIcon_20"===fc?null:fc})}e0i(ra,hb){let Eb;({label:hb,QKa:Mc,tr:Eb}=this.x9b(ra,hb&&ra.IsChecked));const fc=this.lbd(ra,hb);var Mc=this.b9c.E$b(Mc);return Object(f.a)(new ca,{Disabled:ra.Disabled,Type:ra.Type,Identifier:ra.Identifier,Id:fc,RibbonCommand:Eb,CommandData:ra.CommandData,Label:hb||ra.Label,SubMenu:null,IsChecked:ra.IsChecked,IconName:"MissingIcon_20"===Mc?null:Mc})}GHh(ra,hb){var Eb;this.USa=Eb=I.C(ra.Cell);this.sheetName=this.$.pa.sheetName;hb=hb||u.a(this.$);if(ra.IsHeaderSnapped)Eb=
hb.m8b.TOh(Eb);else{hb=oa.g(this.$).Ea.OJa(Eb);if(!hb)return this.WLa?Pa.a.WPa(Z.a.$Kf,Ra.a.m0h,Ga.a.iZa,!0,!1):(ra=oa.g(this.$).view.visibleArea,e.ULS.sendTraceTag(537167134,0,10,`AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested ${Eb}, visible range: ${ra}`)),null;Eb=hb.autoFilterMenu}if(!Eb)return this.WLa?Pa.a.WPa(Z.a.$Kf,Ra.a.hzi,Ga.a.iZa,!0,!1):e.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),
null;this.Lrb=ra.Cell.FirstRow+"_"+ra.Cell.FirstColumn;return Eb}jxc(){if(this.$.ea.Fg){const ra=S.GetServiceTaskFactory.Ra(this.$.da,283,284,1);J.TaskExtensions.Aa(ra,()=>{this.WLa?ra.result.Zn.loadScript("sortFilter").then(()=>{this.TFb()},hb=>{ea.a.uk(hb,"AutoFilterContextMenu.SortFilterScriptLoad");Pa.a.WPa(Z.a.jxc,Ra.a.PCj,Ga.a.iZa,!1,!1)}):J.TaskExtensions.Aa(bb.c(ra.result.Zn.loadScript("sortFilter")),()=>{this.TFb()},this.$.la,3)},this.$.la,3)}else this.$.ea.El(this.kV)}k4g(ra){const hb={};
hb.SearchText=ra;hb.Page=1;hb.DateNodeType=-1;return hb}kUg(){this.OOa&&(e.ULS.sendTraceTag(537167132,0,15,`AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID=${this.OOa}`),X.h(this.$.oa.va,this.OOa,null,null,null),this.OOa=null);this.i$a&&(l.AFrameworkApplication.vd.tu(this.i$a.Nt),this.i$a=null)}rzd(ra){return hb=>{this.i$a=this.OOa=null;if(Pa.a.iwc(hb)){var Eb=Pa.a.O9b(hb);this.WLa?Pa.a.WPa(ra?Z.a.searchAutoFilterItemList:Z.a.getAutoFilterItemList,
Eb.MessageIdName,Ga.a.iZa,!0,!0):e.ULS.sendTraceTag(537167127,0,10,`AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -${Eb.MessageIdName}`)}if(!W.a(hb)){e.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");hb=hb.Result;Eb=new L.a(!0);const fc=hb.AutoFilterDateNodes?!0:!1;hb.AutoFilterItems&&Eb.add("AutoFilterItemsCount",hb.AutoFilterItems.length);fc&&Eb.add("AutoFilterDateItemsCount",hb.AutoFilterDateNodes.length);
Eb.add("Location","contextMenu");pa.b(this.$).Cd(A.a.rzd,Eb.gu,void 0,!0);Eb=this.h2a?Object(f.a)(new ya,{filterByValueItems:this.VAe(hb),hasMoreRecords:hb.ItemListMaxExceeded,searchText:hb.SearchText}):Object(f.a)(new ya,{filterByValueItems:this.VAe(hb),hasMoreRecords:hb.ItemListMaxExceeded});this.JLb.onGetFilterByValueItemsFinish(Eb);ra||(e.ULS.shipAssertTag(529063959,0,null!==hb.FontColors&&null!==hb.CellColors&&null!==hb.Icons&&null!==hb.SelectedSortFontColors&&null!==hb.SelectedSortCellColors&&
null!==hb.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),hb=Object(f.a)(new ia,{fontColors:hb.FontColors,cellColors:hb.CellColors,icons:hb.Icons,selectedSortFontColor:0<hb.SelectedSortFontColors.length?hb.SelectedSortFontColors[0]:null,selectedSortCellColor:0<hb.SelectedSortCellColors.length?hb.SelectedSortCellColors[0]:null,selectedSortIcon:0<hb.SelectedSortIcons.length?hb.SelectedSortIcons[0]:null,getColorName:this.getColorName}),
this.JLb.onGetColorsAndIconsFinish(hb))}}}rKi(){return ra=>{this.i$a=this.OOa=null;ra=M.a.lf(ra.data);ra=V.a.yc(ra);e.ULS.sendTraceTag(537167125,0,10,`AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [${ra}].`)}}VAe(ra){const hb=this.Y1g(ra),Eb=this.e2g(ra.AutoFilterItems),fc=[],Mc=[];let xd=0,Hd=0;ra.HasBlanks&&(ra=cc.t2c(O.a.instance.ga(787),ra.IsBlanksSelected?1:0,r.a.Qre),fc[xd++]=ra);for(const Md of hb)fc[xd++]=Md;if(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6892133_ErrorsOnTop_FilterMenu_Fix"))for(const Md of Eb)-1!==
Array.indexOf(Kb.a.I7c,Md.displayText)?Mc[Hd++]=Md:fc[xd++]=Md;else for(const Md of Eb)fc[xd++]=Md;return Array.prototype.concat(Mc,fc)}Y1g(ra){const hb=[];if(!ra.AutoFilterDateNodes||!ra.AutoFilterDateNodes.length)return hb;const Eb=[this.B3a(ra.YearKeys,ra.YearValues),this.B3a(ra.MonthKeys,ra.MonthValues),this.B3a(ra.DayKeys,ra.DayValues),this.B3a(ra.HourKeys,ra.HourValues),this.B3a(ra.MinuteKeys,ra.MinuteValues),this.B3a(ra.SecondKeys,ra.SecondValues)];let fc=!1,Mc=!1,xd=0;var Hd=null;const Md=
Array(6);var ae=null;for(const me of ra.AutoFilterDateNodes){Md[0]&&(ae.Year!==me.Year?(fc=!0,xd=0,Hd=null):ae.Month!==me.Month?(Mc=!0,xd=1,Hd=Md[0]):ae.Day!==me.Day?(xd=2,Hd=Md[1]):ra.ShowTime&&(ae.Hour!==me.Hour?(xd=3,Hd=Md[2]):ae.Minute!==me.Minute?(xd=4,Hd=Md[3]):(xd=5,Hd=Md[4])));for(;6>xd;){let Re;switch(xd){case 0:Re=me.Year;ae=Eb[0].getItem(Re.toString());break;case 1:Re=me.Month;ae=Eb[1].getItem(Re.toString());break;case 2:Re=me.Day;ae=Eb[2].getItem(Re.toString());break;case 3:Re=me.Hour;
ae=Eb[3].getItem(Re.toString());break;case 4:Re=me.Minute;ae=Eb[4].getItem(Re.toString());break;case 5:Re=me.Second;ae=Eb[5].getItem(Re.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}ae=cc.t2c(ae,-1!==me.NodeType&&xd>=me.NodeType?1:0,Hd?Hd.key+";"+Re:r.a.tWc+Re,!1,[]);Hd=Hd?Hd.children:hb;Hd=Hd[Hd.length]=ae;Md[xd]=ae;switch(xd){case 5:xd=6;break;case 2:xd=ra.ShowTime?xd+1:6;break;default:xd++}}ae=me}fc||(Md[0].expanded=!0,Mc||(Md[1].expanded=!0));return hb}e2g(ra){const hb=
[];if(!ra)return hb;let Eb=0;for(const fc of ra)hb[Eb++]=cc.t2c(fc.DisplayString,fc.Selected?1:0,r.a.uWc+fc.DisplayString);return hb}B3a(ra,hb){const Eb=new L.a(!0);if(!ra||!hb)return Eb;const fc=ra.length<hb.length?ra.length:hb.length;for(let Mc=0;Mc<fc;Mc++)Eb.add(ra[Mc].toString(),hb[Mc]);return Eb}f2c(ra,hb){const Eb={};Eb.Location=hb;Eb.FieldId=ra.Id.toString();Eb.DataSourceIndex=-1;Eb.FilterType=ra.AutoFilterType;Eb.AnchorType=0;Eb.ChartId=null;Eb.AnchorValue1=-1;Eb.AnchorValue2=-1;Eb.Property=
ra.RichProperty;return Eb}sL(ra){mb.a.gba(this.$)&&J.TaskExtensions.Aa(S.GetServiceTaskFactory.Ra(this.$.da,430,431,1),hb=>{hb.result.g7(ra);e.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},this.$.la,3)}km(){return{["Location"]:"contextMenu"}}getColorName(ra){return H.a.NJa(G.a.lH(ra))}dAj(ra){J.TaskExtensions.Aa(S.GetServiceTaskFactory.Ra(this.$.da,309,310,3),hb=>{hb.result.ORa().continueWith(Eb=>{Eb.result&&ra()})},
this.$.la,3)}static t2c(ra=null,hb=0,Eb=null,fc=!1,Mc=null){return Object(f.a)(new xa,{displayText:ra?w.a.Ah(ra):ra,state:hb,key:Eb,parent:null,children:Mc,indentationLevel:0,expanded:fc})}}cc.Rre=268;Object(c.a)(cc,"AutoFilterContextMenu",w.a,[]);var nc=a(722),Wb=a(84),Ea=a(185),ua=a(67),ma=a(19);class fb{}fb.qRe=26;fb.g$c=[230,231,0,99,0,95,94];Object(c.a)(fb,"Constants",null,[]);class sb{constructor(ra,hb,Eb,fc){this.gsg=ra;this.Qmg=hb;this.Umg=Eb;this.uwg=fc}get Aii(){return 3===this.G3b}get lmi(){return 4===
this.G3b&&!!this.subMenu}get subMenu(){return this.uwg}get jpf(){return this.gsg}get G3b(){return this.Qmg}get P3c(){return this.Umg}}Object(c.a)(sb,"FiltersMenuData",null,[]);class Ua extends sb{constructor(ra,hb){super(ra,2,0,null);this.Sre=hb}}Object(c.a)(Ua,"AutoFilterFiltersMenuData",sb,[]);class ab{}ab.XHj=[new sb(100,2,0,null),new sb(101,2,1,null),new sb(0,3,0,null),new sb(172,2,2,null),new sb(174,2,4,null),new sb(0,3,0,null),new sb(176,2,6,null),new sb(177,2,7,null),new sb(0,3,0,null),new sb(108,
0,0,null)];ab.PDi=[new sb(100,2,0,null),new sb(101,2,1,null),new sb(0,3,0,null),new sb(102,2,8,null),new sb(103,2,10,null),new sb(104,2,12,null),new sb(0,3,0,null),new sb(105,1,0,null),new Ua(106,1),new Ua(107,2),new sb(0,3,0,null),new sb(108,0,0,null)];ab.Zah=[new sb(100,2,0,null),new sb(0,3,0,null),new sb(112,2,10,null),new sb(113,2,8,null),new sb(104,2,12,null),new sb(0,3,0,null),new Ua(110,8),new Ua(109,9),new Ua(111,10),new sb(0,3,0,null),new Ua(115,11),new Ua(114,12),new Ua(116,13),new sb(0,
3,0,null),new Ua(117,14),new Ua(118,15),new Ua(119,16),new sb(0,3,0,null),new Ua(120,17),new Ua(121,18),new Ua(122,19),new sb(0,3,0,null),new Ua(123,20),new Ua(124,21),new Ua(125,22),new sb(0,3,0,null),new Ua(126,23),new sb(127,2,12,[new Ua(128,24),new Ua(129,25),new Ua(130,26),new Ua(131,27),new sb(0,3,0,null),new Ua(132,28),new Ua(133,29),new Ua(134,30),new Ua(135,31),new Ua(136,32),new Ua(137,33),new Ua(138,34),new Ua(139,35),new Ua(140,36),new Ua(141,37),new Ua(142,38),new Ua(143,39)]),new sb(0,
3,0,null),new sb(108,0,0,null)];Object(c.a)(ab,"Constants",null,[]);var na=a(905),Na=a(79);class Va extends w.a{constructor(ra,hb,Eb,fc){super(ra,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,Va.Xxh,!0,!1,Va.KIb,hb,Eb,!1,fc);this.im=null}get Bw(){return"PopulateAutoFilterFieldListContextMenu"}get wB(){return r.a.ZKf}executeCommand(ra,hb,Eb){ra=hb.command;switch(ra){case -699941697:this.applyAutoFilterFieldList(hb,Eb);break;case 216058793:break;case -1494291901:break;default:return qa.a(ra)}return Ya.Task.Ta(!0)}dcd(ra,
hb){return!ra||ra.length<=hb?(e.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(ra[hb],10)}wEd(ra,hb,Eb,fc,Mc,xd){const Hd=this.dcd(Mc,xd);0>Hd&&e.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(fb.g$c[Hd]){case 99:ra=new T.a(-2058042992,hb.method,hb.mode,hb.Re,hb.tabName);this.im.TG.Tsb(this.$,fc,0,ra);break;case 230:ra=new T.a(504133448,hb.method,hb.mode,hb.Re,hb.tabName);
this.im.TG.Tsb(this.$,fc,0,ra);break;case 231:ra=new T.a(-798968736,hb.method,hb.mode,hb.Re,hb.tabName);this.im.TG.Tsb(this.$,fc,0,ra);break;case 235:ra=new T.a(-1677817820,hb.method,hb.mode,hb.Re,hb.tabName);this.im.TG.Tsb(this.$,fc,0,ra);break;case 95:this.YIf(ra,hb,fc,Eb,Mc,xd+1);break;case 94:this.im.TG.jqi(this.$,fc)}}YIf(ra,hb,Eb,fc,Mc,xd){const Hd=this.dcd(Mc,xd);0>Hd&&e.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!fc||Hd>=
fc.length)e.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(fc=fc[Hd],fc.G3b){case 1:this.im.TG.Eqi(this.$,Eb);break;case 2:(Mc=Object(Wb.a)(Ua,fc))?(ra=new T.a(-2058042992,hb.method,hb.mode,hb.Re,hb.tabName),this.im.TG.Tsb(this.$,Eb,Mc.Sre,ra)):this.im.TG.qjf(this.$,ra,Eb,fc.P3c);break;case 0:this.im.TG.qjf(this.$,ra,Eb,fc.P3c);break;case 4:this.YIf(ra,hb,Eb,fc.subMenu,Mc,xd+1)}}applyAutoFilterFieldList(ra,hb){var Eb=hb[nc.a.bG];
if(Eb)if(Eb=Eb.split(ua.a.aU),3>Eb.length)e.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var fc=this.dcd(Eb,1),Mc=this.AJa(fc),xd=this.epf(fc).returnValue;xd?this.wEd(hb,ra,xd,Mc,Eb,2):e.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+fc.toString()+ua.a.aU)}else e.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")}Cc(ra,
hb){if(ra=this.$.isEditMode)switch(hb.command){case 216058793:break;case -699941697:break;case -1494291901:ra=!0;break;default:ra=!1}return ra}b0(ra,hb,Eb){this.$.isEditMode&&((this.im=Object(Wb.a)(462,Eb))||e.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.hY(),super.b0(ra,hb,null,null,!0))}n2c(){if(!this.im||!this.im.Qk||1!==this.im.Qk.length)return e.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),
null;const ra=this.im.Qk[0];let hb=new Ea.a;hb.add(O.a.instance.ga(251));hb=Na.OBc(Na.concat(hb,Na.select(Na.asEnumerable(ra.FieldInfoDataList),Eb=>Eb.Name)),Eb=>Eb,new na.a);return Na.toArray(hb)}fieldIndex(ra){if(!this.im||!this.im.Qk||1!==this.im.Qk.length||!this.im.Qk[0].FieldInfoDataList)return-1;for(let hb=0;hb<this.im.Qk[0].FieldInfoDataList.length;++hb)if(this.im.Qk[0].FieldInfoDataList[hb].Name===ra)return hb;return-1}AJa(ra){return 0>ra||!this.im||!this.im.Qk||1!==this.im.Qk.length||!this.im.Qk[0].FieldInfoDataList||
this.im.Qk[0].FieldInfoDataList.length<ra?null:this.im.Qk[0].FieldInfoDataList[ra].Name}hY(){var ra=this.n2c();if(!ra||!ra.length)return null;const hb=this.Sa,Eb=hb.zc();for(let Hd=0;Hd<ra.length;++Hd){const Md=ra[Hd],ae=0<Hd?this.fieldIndex(Md):-1,me=Va.G4f+ae.toString()+ua.a.aU;let Re=null;const Xe=this.im.TG.X3h(0<Hd?Md:null),qf=this.w2c(hb,Xe,Va.G4f+ae.toString(),Md);for(let uf=0;uf<fb.g$c.length;++uf){var fc=fb.g$c[uf],Mc=me+uf.toString();Re||(Re=hb.zc());switch(fc){case 230:Re.buttons.push(hb.Ic(223,
Mc,-699941697,this.im.TG.Wli(0<Hd?Md:null)?ma.a.r7b:ma.a.uIa,8,230,!1,null));break;case 231:Re.buttons.push(hb.Ic(224,Mc,-699941697,this.im.TG.Xli(0<Hd?Md:null)?ma.a.s7b:ma.a.vIa,8,231,!1,null));break;case 235:Re.buttons.push(hb.Ic(225,Mc,-699941697,ma.a.p7b,1,235,!1,null));break;case 99:fc=this.MQg(Md);Mc=hb.bHa(Mc+(Xe?".enabled":".disabled"),fc,-699941697,null,"None",null,!Xe,void 0,!0);Mc.HR("Image16by16",8,ma.a.T1a);Re.buttons.push(Mc);break;case 95:var xd=void 0;const Cf=({zRe:xd,isChecked:fc}=
this.epf(ae)).returnValue;if(!Cf)return null;xd=this.w2c(hb,fc&&Xe,Mc,xd);Mc=this.MUe(xd.menu,hb,Mc+ua.a.aU,Cf,fc&&Xe);xd.menu.nc.push(Mc);Re.buttons.push(xd);break;case 0:Re&&(qf.menu.nc.push(Re),Re=null);break;default:Mc=hb.bHa(Mc,O.a.instance.ga(fc),-699941697,null,"None",null,!1,void 0,!0),this.dYf(Mc,Xe&&94===fc&&this.im.TG.filter(),O.a.instance.ga(fc)),Re.buttons.push(Mc)}}qf.menu.nc.push(Re);Eb.buttons.push(qf)}ra=hb.sq(this.menuId);ra.nc.push(Eb);return ra}MUe(ra,hb,Eb,fc,Mc){let xd=null;
for(let Re=0;Re<fc.length;++Re){var Hd=fc[Re],Md=Eb+Re.toString(),ae=!1;switch(Hd.G3b){case 1:ae=Mc&&this.im.TG.Qh.IsTop10;break;case 2:ae=Object(Wb.a)(Ua,Hd);ae=Mc&&this.im.TG.rfi(ae?ae.Sre:0,Hd.P3c);break;case 0:ae=Mc&&this.im.TG.Qh.IsCustomSupportedAndNotPresent}xd||(xd=hb.zc());if(Hd.Aii)xd&&(ra.nc.push(xd),xd=null);else if(Hd.lmi){var me=O.a.instance.ga(Hd.jpf);me=this.w2c(hb,ae,Md,me);me.menu.nc.push(this.MUe(me.menu,hb,Md+ua.a.aU,Hd.subMenu,ae));xd.buttons.push(me)}else Hd=O.a.instance.ga(Hd.jpf),
Md=hb.bHa(Md,Hd,-699941697,null,"None",null,!1,void 0,!0),this.dYf(Md,ae,Hd),xd.buttons.push(Md)}return xd}dYf(ra,hb,Eb){hb?ra.HR("Image16by16",8,ma.a.Sta):ra.HR("None",0,null);ra.FR(Eb);ra.label=Eb}w2c(ra,hb,Eb,fc){return hb?ra.o2c(Eb,this.menuId,fc,798637440,8,ma.a.Sta):ra.Ru(Eb,this.menuId,fc,798637440)}Dh(ra){return!ra||!ra.length}epf(ra){var hb=0>ra?0:this.im.Qk[0].FieldInfoDataList[ra].MajorityDataTypeForField;var Eb=null;ra=this.im.TG.W3h(hb);switch(hb){case 0:Eb=96;hb=ab.XHj;break;case 1:Eb=
95;hb=ab.PDi;break;case 2:Eb=97;hb=ab.Zah;break;default:return e.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,zRe:Eb,isChecked:ra}}Eb=O.a.instance.ga(Eb);return{returnValue:hb,zRe:Eb,isChecked:ra}}MQg(ra){return!ra||this.Dh(ra.trim())?O.a.instance.ga(98):ra.length>fb.qRe?String.format(O.a.instance.ob(155),ra.substring(0,fb.qRe)):String.format(O.a.instance.ob(156),ra)}}Va.Xxh=r.a.v1g;Va.KIb="AutoFilterFieldListContextMenuRoot";
Va.G4f="ApplyAutoFilterFieldList.";Object(c.a)(Va,"AutoFilterFieldListContextMenu",w.a,[]);var Sa=a(546),vb=a(834),Oa=a(11),yb=a(122),Ob=a(369);class Ja extends w.a{constructor(ra,hb,Eb,fc,Mc="PopulateFloatingObjectContextMenu",xd=-2017893763,Hd=1350204367,Md=r.a.C1g,ae=!0,me=!1){super(ra,Mc,xd,Hd,Md,ae,me,Md,hb,Eb,!0,fc);this.floatingObject=null;this.tb=0;this.Rjc=!0}get Bw(){return"PopulateFloatingObjectContextMenu"}get wB(){return r.a.gLf}executeCommand(ra,hb,Eb){ra=Object(Wb.a)(Sa.a,Eb.eventArgs);
switch(hb.command){case -1372040782:Eb=oa.g(this.$).ha.Pa.$b;e.ULS.shipAssertTag(537167048,0,!!Eb);Eb&&(this.floatingObject=Eb.floatingObject,this.tb=hb.method,hb=this.l$b(ra),this.Bp(hb,!0,ra.tb));break;case 848910589:ra&&(hb=[vb.a.p0f],ra=new Sys.UI.Point(ra.Ca.clientX,ra.Ca.clientY),this.showFloatie(hb,new Sys.UI.Bounds(ra.x,ra.y,0,0),2))}return Ya.Task.Ta(!0)}Cc(ra,hb,Eb){switch(hb.command){case -1372040782:return!!Eb&&this.wgf(ra);case 848910589:return ra=oa.g(this.$).ha.Pa.$b,!!Eb&&!!ra&&ra.eb;
default:return!1}}wgf(ra){switch(ra){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}}XSc(ra,hb,Eb){Ob.a(this.$)?oa.g(this.$).ib.mj||(fa.a(this.$).zQd()?Eb.buttons.push(ra.pb(265)):Eb.buttons.push(ra.pb(264))):(this.$.isEditMode&&3===this.tb&&!this.Q8b()&&Eb.buttons.push(ra.pb(101)),5!==this.floatingObject.type||yb.a.HH(this.floatingObject.Ab)||this.floatingObject.Ab.IsGroup||(this.lpd()?Eb.buttons.push(ra.pb(186)):Eb.buttons.push(ra.pb(147))),this.Q8b()||this.lpd()||Eb.buttons.push(ra.pb(146)),
da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeFOZOrder",!1)&&(this.YDh(Eb),this.BFh(Eb)),da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&Eb.buttons.push(ra.pb(287)),da.EwaSettings.ma(166)&&0===this.floatingObject.type&&Eb.buttons.push(ra.pb(249)),5===this.floatingObject.type&&oa.g(this.$).ha.Pa.$b.w4()&&this.$.gka&&this.$.p9&&Eb.buttons.push(ra.pb(273)))}DJa(ra){const hb=[];if(Ob.a(this.$))return hb;3===ra?(ra=
!!this.$.me.get(5)&&this.floatingObject.CTd(),this.Q8b()||(this.$.isEditMode?(ra&&hb.push(vb.a.$Ah),5===oa.g(this.$).ha.Pa.SA.floatingObject.type&&hb.push(vb.a.ouj)):ra&&hb.push(vb.a.copy)),hb.push(vb.a.aBh)):2===ra&&(da.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?oa.g(this.$).ha.Pa.$b&&this.KZe(oa.g(this.$).ha.Pa.$b,hb):this.KZe(oa.g(this.$).ha.Pa.SA,hb));return hb}hY(){const ra=this.Sa,hb=ra.sq(this.menuId);var Eb=Ob.a(this.$);if(this.$.isEditMode){var fc=
ra.zc();this.XSc(ra,hb,fc);hb.nc.push(fc)}this.$.me.get(5)&&this.floatingObject.CTd()&&!this.Q8b()&&!Eb&&(fc=ra.zc(),this.mAg(ra,fc),hb.nc.push(fc));(fc=this.$.xa.pa)&&fc.Ed&&(fc=fc.Ed.lv||fc.Ed.OH,!da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||this.$.ea.isNamedObjectViewMode||Eb||this.$.isMobileMode||fc||(Eb=ra.zc(),this.kCg(ra,Eb),hb.nc.push(Eb)));return hb}l$b(ra){var hb=oa.g(this.$).ha.Pa.$b;ra=ra&&1!==ra.tb&&ra.clientPoint?
ra.clientPoint:Sys.UI.DomElement.getLocation(hb.domElement);const Eb=this.$.domElement,fc=oa.g(this.$).rtl;(hb=Oa.HelperMethods.VC(hb.kg.domElement,Eb,fc))?(ra.y=Math.max(ra.y,hb.y),ra.x=Math.max(ra.x,hb.x)):e.ULS.sendTraceTag(537167047,5,15,`FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : ${l.AFrameworkApplication.Ng}`);return ra}lpd(){const ra=oa.g(this.$).ha.Pa.$b;return!!ra&&ra.eb}mAg(ra,hb){if(this.$.isEditMode){hb.buttons.push(ra.pb(42));
hb.buttons.push(ra.pb(43));const Eb=this.$.da.za(254,!0);(Eb&&2===Eb.GAb()||this.lpd())&&hb.buttons.push(ra.pb(44))}else hb.buttons.push(ra.pb(43))}kCg(ra,hb){hb.buttons.push(ra.pb(274))}Q8b(){return da.EwaSettings.ma(465)&&!!oa.g(this.$).ha.Pa.Yn}KZe(ra,hb){5===ra.floatingObject.type?ra.eb?hb.push(vb.a.p0f):hb.push(vb.a.kuj):hb.push(w.a.GSe)}YDh(ra){const hb=this.Sa.zc();hb.buttons.push(this.Sa.pb(282));hb.buttons.push(this.Sa.pb(281));const Eb=this.Sa.Ru("BringToFront","BringToFrontMenuId",O.a.instance.ga(827),
-1777747317);Eb.menu.nc.push(hb);ra.buttons.push(Eb)}BFh(ra){const hb=this.Sa.zc();hb.buttons.push(this.Sa.pb(284));hb.buttons.push(this.Sa.pb(283));const Eb=this.Sa.Ru("SendToBack","SendToBackMenuId",O.a.instance.ga(828),-1777747317);Eb.menu.nc.push(hb);ra.buttons.push(Eb)}}Object(c.a)(Ja,"FloatingObjectContextMenu",w.a,[]);var lb=a(783),Pb=a(102),Jb=a(554),Lb=a(514);const Ab=r.a.y1g;class nb extends Ja{constructor(ra,hb,Eb,fc){super(ra,hb,Eb,fc,"PopulateChartContextMenu",-498523270,1640762262,Ab);
this.isPivotChart=this.refresh=this.yY=this.yva=this.iAa=!1}get Bw(){return"PopulateChartContextMenu"}get wB(){return r.a.aLf}executeCommand(ra,hb,Eb){const fc=this.$;this.tb=hb.method;hb=Eb[nb.CZc];if(!(ra&68)){if(!hb){if(8===ra)hb=Lb.a(fc).Tc;else{var Mc=oa.g(fc).ha.Pa.$b;if(null===Mc||void 0===Mc?0:Mc.floatingObject)hb=Mc.floatingObject.Tc}if(!hb)return Ya.Task.Ta(!0)}this.isPivotChart=!!(hb.Attributes&4)}if(this.isPivotChart||fc.isEditMode)if(this.refresh=this.yY=this.yva=this.iAa=!1,Mc=oa.g(this.$).ha.Pa.$b,
e.ULS.shipAssertTag(537167107,0,!!Mc),Mc){this.floatingObject=Mc.floatingObject;Mc=Jb.a(fc);if(null===Mc||void 0===Mc?0:Mc.XPd)this.iAa=Mc=Pb.f(fc.pg),this.yva=!Mc;Mc=fc.jc;this.yY=!!lb.a(fc)&&!!hb&&!!(hb.Attributes&512)&&!(ra&8)&&Mc.R1(32768);Mc.allowManualDataRefresh&&Mc.allowInteractivity&&(this.refresh=!0);ra=this.l$b(Object(Wb.a)(Sa.a,Eb.eventArgs));this.Bp(ra,!0)}return Ya.Task.Ta(!0)}Cc(ra,hb,Eb){return-149612405===hb.command&&!!Eb&&this.wgf(ra)}XSc(ra,hb,Eb){this.isPivotChart&&(this.refresh&&
Eb.buttons.push(ra.pb(100)),this.yY&&Eb.buttons.push(ra.pb(99)),this.iAa?Eb.buttons.push(ra.pb(59)):this.yva&&Eb.buttons.push(ra.pb(58)));super.XSc(ra,hb,Eb)}static get CZc(){return"chartMetaData"}}Object(c.a)(nb,"ChartContextMenu",Ja,[]);var va=a(12);const db=r.a.A1g;class Xa extends w.a{constructor(ra,hb,Eb,fc){super(ra,"PopulateFieldListContextMenu",-1045020714,-170383950,db,!0,!1,db,hb,Eb,!1,fc);this.vL=this.qo=null;this.ETd=this.isOlap=this.XU=this.lZ=!1}get Bw(){return"PopulateFieldListContextMenu"}get wB(){return r.a.HFd}executeCommand(ra,
hb,Eb){ra=hb.command;switch(ra){case 330754562:hb=Eb.domElement;this.isOlap=Eb.isOlap;this.vL=Eb.versionkey;this.qo=Eb.fieldItem;this.lZ=Eb.isChart;this.XU=Eb.isPpm;this.ETd="supportsImplicitMeasures"in Eb?Eb.supportsImplicitMeasures:!1;oa.g(this.$).Go(!0);hb=va.DOMElementExtensions.getBounds(hb);hb=new Sys.UI.Point(hb.x+hb.width,hb.y+hb.height/2);"isKeyboardInput"in Eb&&Eb.isKeyboardInput?this.Bp(hb,!1,1):this.Bp(hb,!1);break;case 926905850:this.ETd&&this.qo&&5===this.qo.TypeTag&&!this.qo.IsCollapsible&&
e.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");Jb.a(this.$).MJ(this.qo,8,-1,this.vL,hb);break;case -67292059:Jb.a(this.$).MJ(this.qo,1,-1,this.vL,hb);break;case 745182485:Jb.a(this.$).MJ(this.qo,2,-1,this.vL,hb);break;case 359279088:Jb.a(this.$).MJ(this.qo,4,-1,this.vL,hb);break;case 547535945:Jb.a(this.$).f4i(this.qo);break;default:return qa.a(ra)}return Ya.Task.Ta(!0)}Cc(ra,hb,Eb){ra=!1;switch(hb.command){case 330754562:ra=!!Eb;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:ra=
!0}return ra}hY(){const ra=this.Sa.sq(this.menuId);this.BYi(ra);this.lZ||this.isOlap||this.AYi(ra);return ra}BYi(ra){const hb=this.Sa,Eb=hb.zc();let fc=!1;da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(fc=this.isOlap&&!this.XU&&this.ETd&&5===this.qo.TypeTag&&!this.qo.IsCollapsible);3!==this.qo.TypeTag&&37!==this.qo.TypeTag||this.qo.IsSet?17===this.qo.TypeTag||this.XU?(Eb.buttons.push(hb.pb(79)),Eb.buttons.push(hb.pb(this.lZ?91:80)),Eb.buttons.push(hb.pb(this.lZ?
92:81)),Eb.buttons.push(hb.pb(82))):13===this.qo.TypeTag||this.qo.IsSet?(Eb.buttons.push(hb.pb(83)),Eb.buttons.push(hb.pb(this.lZ?91:80)),Eb.buttons.push(hb.pb(this.lZ?92:81)),Eb.buttons.push(hb.pb(86))):(Eb.buttons.push(hb.pb(79)),Eb.buttons.push(hb.pb(this.lZ?91:80)),Eb.buttons.push(hb.pb(this.lZ?92:81)),Eb.buttons.push(hb.pb(fc?82:86))):(Eb.buttons.push(hb.pb(83)),Eb.buttons.push(hb.pb(this.lZ?93:84)),Eb.buttons.push(hb.pb(this.lZ?94:85)),Eb.buttons.push(hb.pb(82)));ra.nc.push(Eb)}AYi(ra){const hb=
this.Sa.zc();hb.buttons.push(this.Sa.pb(78));ra.nc.push(hb)}}Object(c.a)(Xa,"FieldListContextMenu",w.a,[]);var gb=a(412),Ha=a(65);class tb{constructor(ra){this.$=ra;this.iN={}}get(ra,hb,Eb){const fc=this.M$f(ra,"PivotFilterContextMenuCache.Get");return fc&&this.iN[fc]?this.iN[fc][tb.Ydd(hb,this.$,ra,Eb)]:null}set(ra,hb,Eb,fc){const Mc=this.M$f(ra,"PivotFilterContextMenuCache.Set");Mc&&(this.iN[Mc]||(this.iN[Mc]={}),this.iN[Mc][tb.Ydd(hb,this.$,ra,fc)]=Eb)}e6b(ra){ra in this.iN&&this.iN[ra]&&(this.iN[ra]=
null)}M$f(ra,hb){return Ha.f(this.$.pa)?this.$.activeItemName:(ra=this.LMj(ra,hb))?ra.Od:null}LMj(ra,hb){ra=I.C(ra);ra=oa.g(this.$).Ea.Oua(ra,this.$.activeItemName);e.ULS.shipAssertTag(537167008,0,!!ra,`PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: ${hb}`);return ra}static Ydd(ra,hb,Eb,fc){return da.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===fc?hb.pa.index+"_"+
ra.id+"_"+Eb.FirstRow.toString()+"_"+Eb.FirstColumn.toString():hb.pa.index+"_"+ra.id}}Object(c.a)(tb,"PivotFilterContextMenuCache",null,[]);class bc{constructor(){this.cell=null;this.dataSourceIndex=0;this.Bo=this.pivotName=null}}Object(c.a)(bc,"ShowPivotFilterData",null,[]);var tc=a(453),Ma=a(1284),Tb=a(54);const zb=r.a.JAe;class ic extends w.a{constructor(ra,hb,Eb,fc,Mc,xd,Hd,Md=zb){super(ra,hb,Eb,fc,Md,!0,!1,"PivotFilterMenuRootName",Mc,xd,!1,Hd);this.glc=this.Mxd=this.pivotData=this.Dlb=this.Bif=
this.R3b=null;this.KX=this.U0b=this.fDb=0;this.Xqb=null;this.KKi=(ae,me)=>{if(me)if(W.a(ae))this.Oud(me,!1);else if(ae=ae.Result){this.Lrb=tb.Ydd(me,this.$,this.pivotData.cell,this.KX);var Re=this.fpf(ae.MenuModel.Sections);this.Xqb=Re;ic.iN.set(this.pivotData.cell,me,Re,this.KX);Ma.a(this.$).tFj(ae);this.Oud(me,!0)}};this.JKi=(ae,me)=>{this.Oud(me,!1)};this.nf=(ae,me)=>{ic.iN.e6b(me.fd.hash)};this.Lm=(ae,me)=>{ic.iN.e6b(me.fd.hash)};this.$ya=null;this.Dwe=this.U0b=this.Nxd=this.fDb=-1;this.Doe=this.KX=
0;this.nz=da.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");ic.iN||(ic.iN=new tb(this.$),oa.g(this.$).Ea.Ks(this.nf),oa.g(this.$).Ea.MG(this.Lm),oa.g(this.$).Ea.jga(this.nf))}h9c(ra,hb){const Eb=ra.rawEvent,fc=ra.cell,Mc=ra.requiresConfirmation;tc.a(this.$).wx(Mc,xd=>{if(xd){xd=Eb?new Sys.UI.DomEvent(Eb):null;this.pivotData=new bc;this.pivotData.pivotName=ra.pivotName;this.pivotData.dataSourceIndex=ra.dataSourceIndex;this.pivotData.cell=fc;this.pivotData.Bo=ra.optionalPivotMenuAnchorParameter;
if(this.pivotData.Bo&&0<this.pivotData.Bo.AnchorType){this.glc=ra.objectId;this.fDb=ra.objectVersion;const Hd=this.pivotData.Bo.AnchorType;if(4===Hd||5===Hd||6===Hd||11===Hd||9===Hd||10===Hd||8===Hd)this.Dlb=ra.location}else this.Mxd=this.glc=null,this.Nxd=this.fDb=-1;oa.g(this.$).Go(!0);this.$.Xj(fc);this.b0(xd,xd?xd.target:ra.domElement,this.pivotData,hb,this.zLa())}});return!0}b0(ra,hb,Eb,fc){if(Object(gb.a)(bc,Eb)){this.pivotData=Eb;this.R3b=hb;this.Bif=ra;this.U0b=this.pivotData.Bo?this.pivotData.Bo.AnchorValue1:
-1;this.KX=this.pivotData.Bo?this.pivotData.Bo.AnchorType:0;var Mc=!1,xd=null;xd=ic.iN.get(this.pivotData.cell,hb,this.KX);Mc=!!xd;var Hd=!0;switch(this.KX){case 4:case 5:case 6:this.$ya=new Sys.UI.Point(this.Dlb.x,this.Dlb.y);Hd=!1;break;case 7:var Md=Sys.UI.DomElement.getBounds(hb);Hd=Md.x+(0<=Md.x?0:Md.width);Md=Md.y+(0<=Md.y?0:Md.height);this.$ya=new Sys.UI.Point(0<=Hd?Hd:0,0<=Md?Md:0);Hd=!1;break;case 8:case 10:case 9:case 11:this.$ya=new Sys.UI.Point(this.Dlb.x,this.Dlb.y);break;default:this.$ya=
null}Mc&&this.glc===this.Mxd&&this.fDb===this.Nxd&&this.U0b===this.Dwe&&this.KX===this.Doe?(e.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.Xqb=xd,this.$ya?this.Bp(this.$ya,this.zLa()):this.nz?(!da.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")||w.a.Zld(this.$,this.pivotData.cell))&&this.Bp(w.a.mcd(this.$,this.pivotData.cell,!1),this.zLa()):super.b0(ra,hb,Eb,fc,this.zLa())):1!==
ic.bNh(hb)&&(Hd&&(hb.parentNode.menuFetchStates=1,this.Ooj(hb),this.MXf(!0)),this.$.userOperationManager.Ub(new U.a(126,0,(ae,me,Re)=>{const Xe=this.$;return X.p(Xe.oa.va,this.pivotData.cell,this.pivotData.dataSourceIndex,this.pivotData.pivotName,Xe.domElement.id,Xe.isChromeRtl,Xe.workbookContext.NovMode,R.b(ae,this.KKi),R.a(me,this.JKi),Re,hb,this.pivotData.Bo)},16),fc))}}RCd(ra){ra.MenuSectionList.push(...this.Xqb)}Oud(ra,hb){ra.parentNode.menuFetchStates=2;this.MXf(!1);if(hb){if(this.R3b!==ra||
this.izi())this.Bp(this.$ya,this.zLa());else if(this.nz&&!this.$ya){if(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!w.a.Zld(this.$,this.pivotData.cell))return;this.Bp(w.a.mcd(this.$,this.pivotData.cell,!1),this.zLa())}else super.b0(this.Bif,ra,null,null,this.zLa());this.Mxd=this.glc;this.Nxd=this.fDb;this.Doe=this.KX;this.Dwe=this.U0b}}zLa(){return 8!==this.KX&&9!==this.KX&&10!==this.KX&&11!==this.KX}izi(){switch(this.pivotData.Bo?this.pivotData.Bo.AnchorType:
0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}}MXf(ra){const hb=this.R3b;if(hb){if(da.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var Eb=va.DOMElementExtensions.HY(hb,"ewaprevsrc","");Eb=!!Eb&&"null"!==Eb}else Eb=!!va.DOMElementExtensions.HY(hb,"ewaprevsrc","");ra&&Eb||!ra&&!Eb||(ra?(hb.setAttribute("ewaprevsrc",hb.src),hb.src=Tb.a.current.Rn(99)):(ra=va.DOMElementExtensions.HY(hb,"ewaprevsrc",""),hb.src=ra,hb.setAttribute("ewaprevsrc",
null)))}}Ooj(ra){this.R3b=ra}static bNh(ra){const hb=ra.parentNode.menuFetchStates;void 0===hb&&(ra.parentNode.menuFetchStates=0);return hb}}ic.iN=null;Object(c.a)(ic,"PivotFilterContextMenuBase",w.a,[]);const Qb="FieldList"+r.a.JAe;class wb extends ic{constructor(ra,hb,Eb,fc){super(ra,"PopulateFieldListPivotMenu",-1793121409,1378457149,hb,Eb,fc,Qb)}get Bw(){return"PopulateFieldListPivotMenu"}get wB(){return r.a.eLf}executeCommand(ra,hb,Eb){return this.h9c(Eb,hb)?Ya.Task.Ta(!0):qa.a(hb.command)}Cc(ra,
hb,Eb){return-1065117584===hb.command&&!!Eb}}Object(c.a)(wb,"FieldListPivotContextMenu",ic,[]);var hc=a(262),Za=a(30),ub=a(86),uc=a(731);class Oc{}Object(c.a)(Oc,"PivotValueFieldSettingsApplyData",null,[]);class Bb{}Bb.Eah="dataFieldCustomLabel";Bb.PEe="dataFieldSourceLabel";Bb.IRd="showValueAsSelect";Bb.GRd="showValueAsBaseFieldSelect";Bb.HRd="showValueAsBaseItemSelect";Bb.TYd="valueFieldsSettingsFieldName";Bb.Weg="valueFieldSettingTabs";Object(c.a)(Bb,"CssElementIds",null,[]);var Nb=a(117);class dc{constructor(ra,
hb,Eb){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=ra;this.baseFieldIndex=hb;this.baseItemIndex=Eb}}Object(c.a)(dc,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);class sc{constructor(ra,hb,Eb,fc,Mc){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=ra;this.activeCell=hb;this.pivotFieldTitle=Eb;this.summarizeBy=fc;this.showAsValueParameters=Mc}getActiveCell(){return this.activeCell}}
Object(c.a)(sc,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[101]);var yc=a(235);class cd{}Object(c.a)(cd,"PivotValueFieldShowValueAsApplyData",null,[]);var pd=a(724),Rb=a(42);const Dc=`<div id='showValueAsControlBody'><label for='${Bb.IRd}' class='${Nb.a.Mn} valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='${Bb.IRd}' class='${Nb.a.VE}'></select></div><div class='showValueAsControlSelectRegion'><label for='${Bb.GRd}'>{1}</label><div><select size=6 id='${Bb.GRd}' class='${Nb.a.VE}'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='${Bb.HRd}'>{2}</label><div><select size=6 id='${Bb.HRd}' class='${Nb.a.VE}'></select></div></div></div>`;
class nd extends yc.a{constructor(ra,hb,Eb,fc,Mc,xd,Hd,Md){super(ra);this.x3d=this.j1d=this.i1d=this.n_b=this.x4b=this.eD=null;this.mvf=()=>{var ae=parseInt(this.K2.ee.value,10);this.ZTg(ae)?(this.kP.Yp.disabled=!0,this.lP.Yp.disabled=!0,this.lP.clear(),nd.Gaf(ae)?(this.kP.Yp.disabled=!1,this.zNb(!da.EwaSettings.isChangeGateEnabled("OfficeVSO:6857026_ShowValueAsControlOKButtonFix"))):nd.Haf(ae)?(this.kP.Yp.disabled=!1,this.lP.Yp.disabled=!1,this.zNb(!0),this.ekf()):this.zNb(!1)):(ae=V.a.Yc(1,0,0,
1129,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),Rb.a(this.$).vr([ae]),this.K2.Hgj())};this.EFi=()=>{0>this.kP.selectedIndex||this.lP.Yp.disabled||(this.zNb(!0),this.ekf())};this.HLi=ae=>{this.eD.nSa();this.lP.Yp.style.overflowY="scroll";if(ae&&!W.a(ae)){ae=ae.Result;this.lP.clear();for(const me of ae.BaseItems)this.lP.YL(me.DisplayString,me.Id.toString(),me.Id===ae.SelectedBaseItem);this.zNb(!1)}};this.get_visible=this.pja;this.set_visible=this.$ma;this.$=hb;this.cell=Eb;this.Bo=fc;this.externalSourceIndex=
Mc;this.Jd=xd;this.rha=Hd;this.Wii=Md;this.gSj=da.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");this.Jja()}pja(){return this.isVisible}$ma(ra){return this.isVisible=ra}get title(){return O.a.instance.ga(1117)}get qvb(){const ra=this.K2.ee?parseInt(this.K2.ee.value,10):-1,hb=this.kP.ee?parseInt(this.kP.ee.value,10):-1,Eb=this.lP.ee?parseInt(this.lP.ee.value,10):-1;return Object(f.a)(new cd,{SelectedDataFormat:0<=ra?ra:-1,SelectedBaseField:hb,SelectedBaseItem:Eb})}get kP(){return this.i1d}get lP(){return this.j1d}get K2(){return this.x3d}setFocus(){va.DOMElementExtensions.setFocus(this.K2.Yp)}render(ra){ra.appendChild(this.domElement)}dispose(){ub.a.qc([this.K2,
this.kP,this.lP,this.x4b,this.n_b]);super.dispose()}xrj(ra){ub.a.qc([this.x4b,this.n_b]);this.K2.clear();for(const hb of ra.DataFormatTypes)this.K2.YL(nd.nLh(hb),hb.toString(),hb===ra.SelectedDataFormat);this.x4b=this.ue.Zd(this.K2.domElement);this.x4b.ka("change",this.mvf);this.kP.clear();for(const hb of ra.BaseFieldList)this.kP.YL(hb.DisplayString,hb.Id.toString(),hb.Id===ra.SelectedBaseField);this.n_b=this.ue.Zd(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6857021_ShowValueAsControlBaseFieldSelectionFix")?
this.kP.domElement:this.K2.domElement);this.n_b.ka("change",this.EFi);this.eD=this.rha.Rqb(this.lP.Yp.parentNode,1E3,null,"",741);da.EwaSettings.isChangeGateEnabled("OfficeVSO:6857019_ShowValueAsControlLoadingIndicatorFix")&&this.eD.nSa();this.mvf(null)}sQ(ra){this.K2.sQ(ra);this.kP.sQ(ra);this.lP.sQ(ra)}Jja(){this.domElement.innerHTML=String.format(Dc,O.a.instance.ga(1118),O.a.instance.ga(1119),O.a.instance.ga(1120));this.x3d=new pd.a(va.DOMElementExtensions.getElementById(this.domElement,Bb.IRd),
!1);this.i1d=new pd.a(va.DOMElementExtensions.getElementById(this.domElement,Bb.GRd),!1);this.j1d=new pd.a(va.DOMElementExtensions.getElementById(this.domElement,Bb.HRd),!1)}ZTg(ra){return this.Wii||!nd.Gaf(ra)&&!nd.Haf(ra)?!0:!!this.kP.count}getValueFieldSettingsShowValueAsBaseItemsInfo(){this.$.userOperationManager.Ub(new U.a(108,0,(ra,hb,Eb)=>{var fc=this.$.oa.va,Mc=parseInt(this.kP.ee.value,10);ra=R.b.call(null,ra,this.HLi);const xd=X.L(fc,this.cell,this.externalSourceIndex,this.Bo);xd.selectedBaseField=
Mc;return X.g(fc,"GetPivotValueFieldSettingsShowValueAsBaseItems",xd,ra,hb,Eb,null,4)},16),this.Jd)}ekf(){this.lP.clear();this.kP.ee&&(this.eD.hSa(),this.lP.Yp.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())}zNb(ra){const hb=document.getElementById("WACDialogActionButton");this.gSj&&hb&&(hb.disabled=ra)}static nLh(ra){switch(ra){case 0:return O.a.instance.ga(1121);case 1:return O.a.instance.ga(1122);case 2:return O.a.instance.ga(1123);case 3:return O.a.instance.ga(1124);
case 4:return O.a.instance.ga(1125);case 5:return O.a.instance.ga(1126);case 6:return O.a.instance.ga(1127);case 7:return O.a.instance.ga(1128);case 8:return O.a.instance.ga(1130);case 9:return O.a.instance.ga(1131);case 10:return O.a.instance.ga(1132);case 11:return O.a.instance.ga(1133);case 12:return O.a.instance.ga(1134);case 13:return O.a.instance.ga(1135);case 14:return O.a.instance.ga(1136);default:return""}}static Gaf(ra){return 11===ra||12===ra||14===ra||13===ra||4===ra}static Haf(ra){return 1===
ra||3===ra||2===ra}}Object(c.a)(nd,"ShowValueAsControl",yc.a,[448,2]);class od{}Object(c.a)(od,"PivotValueFieldSummarizeValueByApplyData",null,[]);const wd="<div id='summarizeValuesByControlBody'>"+`<label class='${Nb.a.Mn} valueFielsSettingsControlTitle' for='${"pivotDataFieldSelect"}'>{0}</label>`+`<div id='${"pivotDataFieldSelectDescription"}' class='${Nb.a.Mn} summarizeValuesByControlDescription'>{1}</div>`+`<div><select class='${Nb.a.VE}' size=6 id='${"pivotDataFieldSelect"}' style='width: 100%' ${r.a.QG}='${"pivotDataFieldSelectDescription"}'></select></div>`+
"</div>";class Pc extends yc.a{constructor(ra){super(ra);this.yce=null;this.get_visible=this.pja;this.set_visible=this.$ma;this.Jja()}get qvb(){const ra=this.jl.ee?parseInt(this.jl.ee.value,10):-1;return Object(f.a)(new od,{Aggregation:0<=ra?ra:-1})}pja(){return this.isVisible}$ma(ra){return this.isVisible=ra}get title(){return O.a.instance.ga(1116)}get enabled(){return!this.jl.Yp.disabled}set enabled(ra){this.jl.Yp.disabled=!ra}get jl(){return this.yce}setFocus(){va.DOMElementExtensions.setFocus(this.jl.Yp)}render(ra){ra.appendChild(this.domElement)}dispose(){ub.a.Ia(this.jl);
super.dispose()}focus(){va.DOMElementExtensions.setFocus(this.jl.Yp)}wrj(ra){this.jl.ESd();for(const hb of ra.AggregationTypes){const Eb=hb===ra.SelectedAggregation;this.jl.VSc(Pc.NGh(hb),hb.toString(),Eb,"")}this.jl.V6c();this.jl.Yp.disabled=ra.AggregationsDisabled}Dgj(){this.jl.Egj()}Jja(){this.domElement.innerHTML=String.format(wd,O.a.instance.ga(1101),O.a.instance.ga(1102));this.yce=new pd.a(va.DOMElementExtensions.getElementById(this.domElement,Pc.dGf),!1)}static NGh(ra){switch(ra){case 0:return O.a.instance.ga(1104);
case 1:return O.a.instance.ga(1105);case 2:return O.a.instance.ga(1106);case 3:return O.a.instance.ga(1107);case 4:return O.a.instance.ga(1108);case 5:return O.a.instance.ga(1109);case 6:return O.a.instance.ga(1110);case 7:return O.a.instance.ga(1111);case 8:return O.a.instance.ga(1112);case 9:return O.a.instance.ga(1113);case 10:return O.a.instance.ga(1114);case 11:return O.a.instance.ga(1115);default:return""}}}Pc.dGf="pivotDataFieldSelect";Object(c.a)(Pc,"SummarizeValuesByControl",yc.a,[448,2]);
var Hb=a(210),Nc=a(464),Db=a(1230);class Cc extends uc.a{constructor(ra,hb,Eb,fc,Mc,xd,Hd,Md,ae){super(Mc,O.a.instance.ob(61),!0,2,!0);this.g2f=!0;this.vQc=this.e4c=this.lrb=this.jfa=this.SRa=this.aie=null;this.tFi=me=>{hc.a.any(me.Errors,Re=>-103190598===Re.MessageId)&&this.vSa.Dgj()};this.GLi=me=>{me&&!W.a(me)&&(me=me.Result,this.e4c.innerHTML=O.a.instance.ga(1099)+Za.a.Eg(me.ValueFieldSourceName),this.isOlap&&!this.XU?(this.vSa.enabled=!1,this.jfa.activeTab=this.jfa.myc-1):(this.vSa.enabled=!0,
this.jfa.activeTab=0),this.vSa.wrj(me.PivotValueFieldSettingsSummarizeValueByInfo),this.SRa.xrj(me.PivotValueFieldShowValueAsInitialInfo),this.Ff())};this.cell=ra;this.Bo=hb;this.externalSourceIndex=Eb;this.Veg=fc;this.Jd=xd;this.rha=Hd;this.isOlap=Md;this.XU=ae}get oc(){return"ValueFieldSettingsDialog"}get tBa(){return this.aie}get DCb(){return this.jfa}get vSa(){return this.vQc}get Rw(){return 560}dispose(){this.e4c=this.lrb=this.SRa=this.vQc=null;ub.a.Ia(this.jfa);this.jfa=null;super.dispose()}initialize(){let ra=
"<div id='"+Bb.PEe+"' class='"+Nb.a.Mn+"'></div><div id='"+Bb.Eah+"' class='"+Nb.a.Mn+"'><label for='"+Bb.TYd+"'>{0}</label><input type='text' id='"+Bb.TYd+"' value='{1}' class='"+Nb.a.VE+" UIFont' /></div><div id='"+Bb.Weg+"'></div>";ra=String.format(ra,O.a.instance.ga(1100),Za.a.Eg(this.Veg));this.Lb.innerHTML=ra;this.Pe||(this.T8(),this.hn());this.aie=[-103190598];this.AZh();super.initialize()}close(ra){1===ra&&(this.g2f=!1);super.close(ra)}NGe(ra){this.UM=ra;this.domElement.disabled=ra;const hb=
["input","option","select"];for(let Eb=0,fc=hb.length;Eb<fc;++Eb){const Mc=this.domElement.getElementsByTagName(hb[Eb]);for(let xd=0;xd<Mc.length;++xd)Mc[xd].disabled=ra}}hn(){this.lrb=document.getElementById(Bb.TYd);this.e4c=va.DOMElementExtensions.getElementById(this.Lb,Bb.PEe);const ra=va.DOMElementExtensions.getElementById(this.Lb,Bb.Weg);this.vQc=new Pc(document.createElement("div"));this.SRa=new nd(document.createElement("div"),this.$,this.cell,this.Bo,this.externalSourceIndex,this.Jd,this.rha,
!this.isOlap);let hb;this.jfa=new Db.a(ra,(hb=new Ea.a,hb.add(this.vSa),hb.add(this.SRa),hb));this.jfa.yQf()}bDd(){const ra=new Cc(this.cell,this.Bo,this.externalSourceIndex,this.Veg,this.$,this.Jd,this.rha,this.isOlap,this.XU);ra.initialize();ra.Ff()}rOb(){const ra=new Nc.a;if(!this.g2f)return ra.isValid=!0,ra;this.lrb.value.length?ra.isValid=!0:(this.NGe(!0),ra.error=V.a.Yc(1,0,756,771,0,1783218700,"PivotTableValueFieldNoBlank"),this.UM=!0,this.Pe||(this.Uy.disabled=!0),ra.isValid=!1);return ra}j4e(){this.UM=
!1;this.Pe||(this.Uy.disabled=!1);this.NGe(!1)}Zxa(ra){const hb=new T.a(2105621672,0,this.$.Mc,30,null);this.$.Ka.Mb(hb);this.TV(5,ra.tb,"Number Format");return!0}Fo(){this.Kna=String.format(O.a.instance.ob(61),null);super.Fo()}setFocus(){if(this.Pe){const ra=va.DOMElementExtensions.getElementById(this.Lb,Pc.dGf);Hb.a.Izc(ra)}else this.jfa.setFocus()}jj(){const ra=this.SRa.qvb,hb=new dc(ra.SelectedDataFormat,ra.SelectedBaseField,ra.SelectedBaseItem);return()=>new sc(this.externalSourceIndex,this.cell,
this.lrb.value,this.vSa.qvb.Aggregation,hb)}KA(){const ra=Object(f.a)(new Oc,{PivotValueFieldSummarizeValueByApplyData:this.vSa.qvb,PivotValueFieldShowValueAsApplyData:this.SRa.qvb,PivotValueFieldTitle:this.lrb.value});return(hb,Eb,fc)=>{var Mc=this.$.oa.va;hb=R.b(hb,this.tFi);const xd=X.L(Mc,this.cell,this.externalSourceIndex,this.Bo);xd.pivotValueFieldSettingsApplyData=ra;return X.g(Mc,"ApplyPivotValueFieldSettings",xd,hb,Eb,fc,null,0)}}sQ(ra){this.$.da.Za(40,()=>{this.SRa.sQ(ra)})}AZh(){this.$.userOperationManager.Ub(new U.a(123,
0,(ra,hb,Eb)=>{var fc=this.$.oa.va;ra=R.b.call(null,ra,this.GLi);const Mc=X.L(fc,this.cell,this.externalSourceIndex,this.Bo);return X.g(fc,"GetPivotValueFieldSettingsInitial",Mc,ra,hb,Eb,null,4)},16),this.Jd)}}Object(c.a)(Cc,"ValueFieldSettingsDialog",uc.a,[]);const Xc=r.a.B1g;class ld extends w.a{constructor(ra,hb,Eb,fc){super(ra,"PopulateFieldWellContextMenu",1374696078,495005930,Xc,!0,!1,Xc,hb,Eb,!1,fc);this.Bo=this.qo=this.cell=null;this.d_d=this.externalSourceIndex=-1;this.cSa=0;this.lxc=-1;
this.vL=null;this.g2a=this.XU=this.isOlap=!1}get Bw(){return"PopulateFieldWellContextMenu"}get wB(){return r.a.IFd}executeCommand(ra,hb,Eb,fc){ra=hb.command;switch(ra){case -1453503574:fc=Eb.domElement;this.qo=Eb.fieldItem;this.d_d=Eb.zoneCount;this.cSa=Eb.sourceAxis;this.lxc=Eb.sourceAxisPos;this.Bo=Eb.optionalPivotMenuAnchorParameter;this.vL=Eb.versionkey;this.isOlap=Eb.isOlap;this.XU=Eb.isPpm;this.g2a="fieldItemsupportsImplicitMeasures"in Eb?Eb.fieldItemsupportsImplicitMeasures:!1;this.cell=Eb.cell;
this.externalSourceIndex=Eb.externalSourceIndex;oa.g(this.$).Go(!0);fc=va.DOMElementExtensions.getBounds(fc);ra=new Sys.UI.Point(fc.x,fc.y+fc.height);this.$.isChromeRtl&&(ra.x+=fc.width);"isKeyboardInput"in Eb&&Eb.isKeyboardInput?this.Bp(ra,!1,1):this.Bp(ra,!1);break;case 495005930:break;case -1170196828:Jb.a(this.$).MJ(this.qo,this.cSa,this.lxc-1,this.vL,hb);break;case -889576107:Jb.a(this.$).MJ(this.qo,this.cSa,this.lxc+2,this.vL,hb);break;case 2033235475:Jb.a(this.$).MJ(this.qo,this.cSa,this.d_d,
this.vL,hb);break;case 389774337:Jb.a(this.$).MJ(this.qo,this.cSa,0,this.vL,hb);break;case -96230454:Jb.a(this.$).MJ(this.qo,4,-1,this.vL,hb);break;case 74086617:Jb.a(this.$).MJ(this.qo,1,-1,this.vL,hb);break;case 1529312473:Jb.a(this.$).MJ(this.qo,2,-1,this.vL,hb);break;case 563292088:this.g2a&&e.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");Jb.a(this.$).MJ(this.qo,8,-1,this.vL,hb);break;case -1092351914:Jb.a(this.$).MJ(this.qo,0,-1,this.vL,hb);break;case -2141589616:const Mc=
S.GetServiceTaskFactory.Ra(this.$.da,12,477,fc.ija());return J.TaskExtensions.Aa(Mc,()=>{(new Cc(this.cell,this.Bo,this.externalSourceIndex,this.qo.Name,this.$,hb,Mc.result,this.isOlap,this.XU)).initialize()},this.la);default:return qa.a(ra)}return Ya.Task.Ta(!0)}Cc(ra,hb,Eb){ra=!1;switch(hb.command){case -1453503574:ra=!!Eb;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:ra=
!0}return ra}hY(){const ra=this.Sa.sq(this.menuId);this.IYi(ra,this.lxc,this.d_d);this.JYi(ra,this.cSa);this.KYi(ra);8===this.cSa&&this.GYi(ra);return ra}IYi(ra,hb,Eb){const fc=this.Sa,Mc=fc.zc();hb||hb!==Eb-1?!hb&&hb<Eb-1?(Mc.buttons.push(fc.pb(64)),Mc.buttons.push(fc.pb(61)),Mc.buttons.push(fc.pb(66)),Mc.buttons.push(fc.pb(63))):0<hb&&hb<Eb-1?(Mc.buttons.push(fc.pb(60)),Mc.buttons.push(fc.pb(61)),Mc.buttons.push(fc.pb(62)),Mc.buttons.push(fc.pb(63))):0<hb&&hb===Eb-1&&(Mc.buttons.push(fc.pb(60)),
Mc.buttons.push(fc.pb(65)),Mc.buttons.push(fc.pb(62)),Mc.buttons.push(fc.pb(67))):(Mc.buttons.push(fc.pb(64)),Mc.buttons.push(fc.pb(65)),Mc.buttons.push(fc.pb(66)),Mc.buttons.push(fc.pb(67)));ra.nc.push(Mc)}JYi(ra,hb){const Eb=this.Sa,fc=Eb.zc(),Mc=1!==hb&&(!this.isOlap||this.XU||8!==hb||this.g2a),xd=2!==hb&&(!this.isOlap||this.XU||8!==hb||this.g2a),Hd=8!==hb&&-2!==this.qo.PivotTableIndex&&(!this.isOlap||this.XU||this.g2a);fc.buttons.push(Eb.pb(4===hb||this.qo.IsSet||-2===this.qo.PivotTableIndex||
this.isOlap&&!this.XU&&8===hb&&!this.g2a?72:68));8===this.Bo.AnchorType||10===this.Bo.AnchorType?(fc.buttons.push(Eb.pb(Mc?95:97)),fc.buttons.push(Eb.pb(xd?96:98))):(fc.buttons.push(Eb.pb(Mc?69:73)),fc.buttons.push(Eb.pb(xd?70:74)));fc.buttons.push(Eb.pb(Hd?71:75));ra.nc.push(fc)}KYi(ra){const hb=this.Sa.zc();hb.buttons.push(this.Sa.pb(76));ra.nc.push(hb)}GYi(ra){const hb=this.Sa.zc();hb.buttons.push(this.Sa.pb(77));ra.nc.push(hb)}}Object(c.a)(ld,"FieldWellContextMenu",w.a,[]);var Dd=a(1210);class Od extends ic{constructor(ra,
hb,Eb,fc){super(ra,"PopulatePivotContextMenu",2123758504,912277356,hb,Eb,fc)}get Bw(){return"PopulatePivotContextMenu"}get wB(){return r.a.kLf}executeCommand(ra,hb,Eb){let fc=!1;const Mc=hb.command;switch(Mc){case 37023044:fc=this.h9c(Eb,hb);break;case 541421805:case -569786022:fc=this.nhd(ra,hb)}return fc?Ya.Task.Ta(!0):qa.a(Mc)}Cc(ra,hb,Eb){ra=!1;switch(hb.command){case 37023044:ra=!!Eb;break;case 541421805:case -569786022:ra=!0}return ra}nhd(ra,hb){var Eb=8===ra,fc=this.$,Mc=Lb.a(fc),xd=oa.g(fc).ha.Pa.$b;
let Hd=ra=null;Eb&&Mc?(ra=Mc.chartId,Hd=Mc.Tc):!Eb&&xd&&(ra=xd.floatingObject.id,Hd=xd.floatingObject.Tc);return Od.Cqe(Hd,260)?(Eb={},fc.Xj(Eb),Eb.FirstColumn=Eb.FirstRow=-1,fc={["rawEvent"]:null,["pivotName"]:null,["cell"]:Eb,["requiresConfirmation"]:Od.Cqe(Hd,64),["dataSourceIndex"]:Hd.ExternalSourceIndex},xd?(Mc=xd.floatingObject,fc.domElement=xd.domElement,fc.objectId=Mc.id,fc.objectVersion=Mc.version):Mc&&(fc.domElement=Mc.ul,fc.objectId=Mc.chartId,fc.objectVersion=Mc.Gwe),xd={AnchorType:7},
xd.ChartId=ra,xd.AnchorValue1=-1,xd.AnchorValue2=-1,fc.optionalPivotMenuAnchorParameter=xd,this.h9c(fc,hb)):!1}static Cqe(ra,hb){return(ra.Attributes&hb)===hb}}Object(c.a)(Od,"PivotFilterContextMenu",ic,[]);var Qd=a(1283),Nd=a(833);const he=(ra,hb,Eb,fc,Mc,xd,Hd,Md,ae,me=null)=>{me=ra.Na(41,me);me.activeCell=hb;me.operationType=Eb;me.fieldCaption=fc;me.prevFieldCaption=Mc;return X.g(ra,"ExecutePivotTableOperation",me,xd,Hd,Md,ae,0)},ve=(ra,hb,Eb,fc,Mc,xd,Hd,Md=null)=>{Md=ra.Na(41,Md);Md.activeCell=
hb;Md.pivotValueFieldSettingsApplyData=Eb;return X.g(ra,"ApplyValueFieldSettingsToPivotTable",Md,fc,Mc,xd,Hd,0)};var Td=a(147),ke=a(368),xe=a(247),le=a(28),Je=a(22);const Fe=r.a.F1g,eb=Fe+".RemoveField",Xb=Fe+".Subtotal",oc=Fe+".ClearFilter",Gc=Fe+".LayoutSameColumn",Vc=Fe+".LayoutNextColumn";class P extends w.a{constructor(ra,hb,Eb,fc){super(ra,"PopulatePivotTableContextMenu",-1475408662,1114549926,Fe,!0,!1,"PivotTableContextMenuRootName",hb,Eb,!0,fc);this.GZd=this.activeCell=this.kc=null;this.yY=
this.refresh=this.expandCollapse=this.Qmd=this.chc=!1;this.E$a=this.ub=this.X_a=this.dA=this.xe=null;this.cba=!1;this.WKi=Mc=>{Mc&&!V.a.rg(Mc.Errors)&&this.kc&&(this.kc.Qo=Mc.Result,this.YJb());this.showPivotTableContextMenu()};this.VKi=()=>{};this.KOi=()=>{this.pbb()};this.JOi=()=>{this.pbb()};this.zFi=()=>{this.pbb()};this.yFi=()=>{this.pbb()};this.ey=()=>{this.bXd();this.cba=!1};this.Jq=()=>{if(this.cba){e.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");
const Mc=this.kc;this.grid.Db.fp(this.grid.ha.sa.activeCell)!==Mc&&(this.pbb(),this.x5h())}};this.Ygh=new DOMParser;this.Ivj=!0;this.grid=oa.g(ra);this.Rjc=!0}get Bw(){return"PopulatePivotTableContextMenu"}get wB(){return r.a.lLf}executeCommand(ra,hb,Eb){hb=hb.command;ra=null;this.grid=oa.g(this.$);this.activeCell=I.o(this.grid.ha.sa.activeCell,this.$);if(this.$.isEditMode&&(this.kc=this.grid.Db.fp(this.grid.ha.sa.activeCell),!this.kc))return e.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),
J.TaskExtensions.raa();this.GZd=this.$.oa.va;this.X_a=Object(Wb.a)(Sa.a,Eb.eventArgs);switch(hb){case 671488277:this.txj()?this.XSh():(this.pbb(),this.showPivotTableContextMenu());break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,
2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.dA.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.dA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.dA.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.dA.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.dA.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.dA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.dA.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.dA.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.dA.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.dA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.dA.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.dA.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.pRa(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.pRa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);
break;case 786592977:this.pRa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.pRa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.pRa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.pRa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:Eb=Number.parseInvariant(Eb.MenuItemId.split(".")[2]);this.pRa(11,Eb);this.applyValueFieldSettingsToPivotTable(-2031744961);break;
case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.ud(-1556797033,x.a.Eb,8,null);break;case 1514686611:this.qqi();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:Eb=Number.parseInvariant(Eb.MenuItemId);this.IXg(Eb);break;case 1778578888:Eb=Number.parseInvariant(Eb.MenuItemId);this.$Jg(Eb);break;case 2059542618:this.performPivotTableOperation(2059542618,11);break;case 713270357:this.performPivotTableOperation(713270357,
12);break;case -1842411134:this.performPivotTableOperation(-1842411134,13);break;case 2054968064:this.performPivotTableOperation(2054968064,14);break;case 74278997:this.performPivotTableOperation(74278997,15);break;case 8572743:this.performPivotTableOperation(8572743,16);break;case 833996216:this.performPivotTableOperation(833996216,17);break;case 139202061:this.performPivotTableOperation(139202061,18);break;default:ra=qa.a(hb)}return ra||J.TaskExtensions.raa()}Cc(ra,hb){ra=!1;switch(hb.command){case 671488277:ra=
Nd.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:ra=!0;break;case 1600778266:ra=!0;break;case -556893687:ra=!0;break;case -1966978671:ra=!0;break;case -1951357930:ra=!0;break;case -1390365353:case -1457478532:ra=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:ra=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:ra=
!0;break;case -1007663920:case 234234584:case 1194992911:ra=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:ra=!0;break;case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:ra=da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)}return ra}txj(){if(!this.$.isEditMode||this.kc.Yec)return!1;let ra=this.f1f(!1);return da.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?
!this.kc.isOlap||ra:!this.kc.Ufc()||ra}Nc(ra,hb){let Eb=!1;switch(hb){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:Eb=this.JR();break;case -1007663920:case 234234584:Eb=this.Zvj()||this.JR();break;case 1194992911:Eb=this.$vj()||this.JR();break;
case 1217404289:Eb=!Qd.j(this.ub.LabelOrDateFilterType)||this.JR();break;case -743135194:Eb=!Qd.m(this.ub.ValueFilterType)&&!Qd.l(this.ub.ValueFilterType)||this.JR();break;case 771421327:Eb=0===this.ub.LabelOrDateFilterType&&0===this.ub.ValueFilterType&&!this.ub.HasManualFilter||this.JR();break;case 1015867427:Eb=!Qd.i(this.ub.LabelOrDateFilterType)||this.JR();break;case 1105960559:Eb=!Qd.k(this.ub.LabelOrDateFilterType)||this.JR()}return Eb||super.Nc(ra,hb)}pbb(){this.E$a=this.ub=this.xe=null}qTd(){this.grid.aT(this.Jq);
this.$.Ka.fYa(this.ey)}bXd(){this.grid.QN(this.Jq);this.$.Ka.NHb(this.ey)}YJb(){if(this.kc&&this.kc.Qo){this.xe=this.kc.Qo;this.ub=this.kc.p$b();if(this.T1f()){const ra=this.kc.YK[4===this.xe.CellType?this.kc.g4c-1:this.xe.CurrentFieldIndex-1];ra&&(this.E$a=-2===ra.Index?this.kc.UEe:ra.Caption)}this.i9h();this.ub&&8===this.xe.CellArea&&(this.dA.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.ub.DataFieldAggregationType,this.dA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.ub.DataFieldFormatType,
this.dA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.ub.BaseFieldIndex,this.dA.PivotValueFieldTitle=this.ub.Caption)}}f1f(ra){return this.kc?this.kc.isOlap&&!this.kc.rMa(!ra):!1}gwj(){const ra=da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.ub.MeasureType&&(!this.kc.kff||ra&&2===this.ub.MeasureType)}hY(){const ra=this.Sa.sq(this.menuId),hb=this.Sa.zc(),Eb=oa.g(this.$).Vb(null);if(this.kc)this.xe&&this.kc.Qo&&this.xe!==this.kc.Qo&&
e.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.ub&&this.ub!==this.kc.p$b()&&e.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return ra;this.bEh(ra);if(this.$.isEditMode){this.refresh&&this.uFh(ra);if(this.xe&&this.ub){var fc=this.Sa.zc();this.JFh(fc);this.rEh(fc);ra.nc.push(fc)}this.yY&&hb.buttons.push(this.Sa.pb(99));this.xe&&this.ub&&this.QEh(ra);if(this.expandCollapse){fc=this.Sa.Ru("ContextMenu.PivotExpandCollapse",
null,O.a.instance.ga(1165),589118293);const Mc=this.Sa.zc();Mc.buttons.push(this.Sa.pb(243));Mc.buttons.push(this.Sa.pb(244));Mc.buttons.push(this.Sa.pb(245));Mc.buttons.push(this.Sa.pb(246));fc.menu.nc.push(Mc);fc&&0<Mc.buttons.length&&hb.buttons.push(fc)}this.xe&&(fc=this.Sa.zc(),da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&this.aFh(fc),this.vFh(fc),0<fc.buttons.length&&ra.nc.push(fc));this.xe&&this.ub&&8===this.xe.CellArea&&8!==this.xe.CellType&&
(fc=this.Sa.zc(),this.gwj()&&this.LFh(fc),3!==this.xe.CellType&&this.GFh(fc),ra.nc.push(fc));!this.kc.Ufc()&&""!==(null===Eb||void 0===Eb?void 0:Eb.text)&&this.xe&&0===this.xe.CellType&&da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.FFh(ra);this.Hji()?hb.buttons.push(this.Sa.pb(257)):hb.buttons.push(this.Sa.pb(258));this.Qmd?hb.buttons.push(this.Sa.pb(59)):hb.buttons.push(this.Sa.pb(58))}ra.nc.push(hb);return ra}GRa(){return this.ub&&this.ub.Caption?
20<this.ub.Caption.length:!1}BJa(ra){return this.ub&&this.ub.Caption?ra?this.ub.Caption.substring(0,20)+"...":this.ub.Caption:""}Pua(ra){return da.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?Je.a.hashCode(ra).toString():ra}JFh(ra){if(this.xe&&this.ub&&4!==this.xe.CellArea){var hb=this.Lia(this.pH("PivotTableContextMenu.Sort",this.Pua(this.ub.Caption)),-1777747317,0,0!==this.ub.SortInfo,O.a.instance.ga(229)),Eb=this.Sa.zc();Eb.buttons.push(this.Rd("PivotTableContextMenu.SortAscending",
-1007663920,0,1===this.ub.SortInfo,O.a.instance.ga(230)));Eb.buttons.push(this.Rd("PivotTableContextMenu.SortDescending",234234584,0,2===this.ub.SortInfo,O.a.instance.ga(231)));1!==this.xe.CellArea&&2!==this.xe.CellArea||Eb.buttons.push(this.Rd("PivotTableContextMenu.SortByValue",1194992911,0,3===this.ub.SortInfo||4===this.ub.SortInfo,O.a.instance.ga(156)));hb.menu.nc.push(Eb);hb&&0<Eb.buttons.length&&ra.buttons.push(hb)}}rEh(ra){if(this.xe&&this.ub&&(1===this.xe.CellArea||2===this.xe.CellArea)){var hb=
this.sxj();const xd=this.Lia(this.pH("PivotTableContextMenu.Filter",this.Pua(this.ub.Caption)),-1777747317,0,hb,O.a.instance.ga(656)),Hd=this.Sa.zc();var Eb="",fc=this.GRa(),Mc=String.format(O.a.instance.ob(156),this.BJa(fc));fc&&(Eb=String.format(O.a.instance.ob(156),this.ub.Caption));hb=this.Pua(this.ub.Caption)+"."+(hb?"enabled":"disabled");Eb=this.Rd(this.pH(oc,hb),771421327,0,!1,Mc,"0",Eb,8,ma.a.T1a);hb=this.Pua(this.ub.Caption)+"."+this.ub.LabelOrDateFilterType.toString();this.ub.IsDateField?
(Mc=this.Lia(this.pH("PivotTableContextMenu.DateFilter",hb),-1777747317,0,0!==this.ub.LabelOrDateFilterType,O.a.instance.ga(97)),this.fEh(Mc.menu)):(Mc=this.Lia(this.pH("PivotTableContextMenu.LabelFilter",hb),-1777747317,0,0!==this.ub.LabelOrDateFilterType,O.a.instance.ga(654)),this.PEh(Mc.menu));hb=this.Pua(this.ub.Caption)+"."+this.ub.ValueFilterType.toString();hb=this.Lia(this.pH("PivotTableContextMenu.ValueFilter",hb),-1777747317,0,0!==this.ub.ValueFilterType,O.a.instance.ga(655));this.XFh(hb.menu);
fc=this.Sa.zc();fc.buttons.push(this.Rd("PivotTableContextMenu.ManualFilter",1514686611,0,this.ub.HasManualFilter,O.a.instance.ga(94)));Hd.buttons.push(Eb);Hd.buttons.push(Mc);Hd.buttons.push(hb);xd.menu.nc.push(Hd);xd.menu.nc.push(fc);xd&&0<Hd.buttons.length&&ra.buttons.push(xd)}}fEh(ra){ra.nc.push(this.K$b(!0,!1));ra.nc.push(this.rLh());ra.nc.push(this.qLh());ra.nc.push(this.gNh());ra.nc.push(this.jNh());ra.nc.push(this.hNh());ra.nc.push(this.iNh());ra.nc.push(this.kNh());ra.nc.push(this.lNh());
ra.nc.push(this.eLh())}UDh(ra){ra.nc.push(this.K$b(!0,!0));ra.nc.push(this.VTh());ra.nc.push(this.hRh())}PEh(ra){ra.nc.push(this.K$b(!0,!1));ra.nc.push(this.CXe(!0));ra.nc.push(this.LHh());ra.nc.push(this.oKh());ra.nc.push(this.BWe(!0));ra.nc.push(this.HVe(!0))}XFh(ra){ra.nc.push(this.K$b(!1,!1));ra.nc.push(this.CXe(!1));ra.nc.push(this.BWe(!1));ra.nc.push(this.HVe(!1));ra.nc.push(this.uYh())}uYh(){const ra=this.Sa.zc();ra.buttons.push(this.Rd("PivotTableContextMenu.Top10",-1611233597,0,Qd.l(this.ub.ValueFilterType),
O.a.instance.ga(105)));return ra}oKh(){const ra=this.Sa.zc();this.ub&&(ra.buttons.push(this.Rd("PivotTableContextMenu.Contains",786260386,0,10===this.ub.LabelOrDateFilterType,O.a.instance.ga(657),"10")),ra.buttons.push(this.Rd("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.ub.LabelOrDateFilterType,O.a.instance.ga(658),"11")));return ra}LHh(){const ra=this.Sa.zc();this.ub&&(ra.buttons.push(this.Rd("PivotTableContextMenu.BeginsWith",786260386,0,6===this.ub.LabelOrDateFilterType,O.a.instance.ga(659),
"6")),ra.buttons.push(this.Rd("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.ub.LabelOrDateFilterType,O.a.instance.ga(660),"7")),ra.buttons.push(this.Rd("PivotTableContextMenu.EndsWith",786260386,0,8===this.ub.LabelOrDateFilterType,O.a.instance.ga(661),"8")),ra.buttons.push(this.Rd("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.ub.LabelOrDateFilterType,O.a.instance.ga(662),"9")));return ra}CXe(ra){const hb=this.Sa.zc();if(this.ub){const Eb=ra?Qd.c:Qd.f;hb.buttons.push(this.Rd(this.pH("PivotTableContextMenu.Equals",
Eb),786260386,0,ra?4===this.ub.LabelOrDateFilterType:18===this.ub.ValueFilterType,O.a.instance.ga(100),ra?"4":"18"));hb.buttons.push(this.Rd(this.pH("PivotTableContextMenu.DoesNotEqual",Eb),786260386,0,ra?5===this.ub.LabelOrDateFilterType:19===this.ub.ValueFilterType,O.a.instance.ga(101),ra?"5":"19"))}return hb}BWe(ra){const hb=this.Sa.zc();if(this.ub){const Eb=ra?Qd.c:Qd.f;hb.buttons.push(this.Rd(this.pH("PivotTableContextMenu.GreaterThan",Eb),786260386,0,ra?12===this.ub.LabelOrDateFilterType:20===
this.ub.ValueFilterType,O.a.instance.ga(102),ra?"12":"20"));hb.buttons.push(this.Rd(this.pH("PivotTableContextMenu.GreaterThanOrEqualTo",Eb),786260386,0,ra?13===this.ub.LabelOrDateFilterType:21===this.ub.ValueFilterType,O.a.instance.ga(663),ra?"13":"21"));hb.buttons.push(this.Rd(this.pH("PivotTableContextMenu.LessThan",Eb),786260386,0,ra?14===this.ub.LabelOrDateFilterType:22===this.ub.ValueFilterType,O.a.instance.ga(103),ra?"14":"22"));hb.buttons.push(this.Rd(this.pH("PivotTableContextMenu.LessThanOrEqualTo",
Eb),786260386,0,ra?15===this.ub.LabelOrDateFilterType:23===this.ub.ValueFilterType,O.a.instance.ga(664),ra?"15":"23"))}return hb}HVe(ra){const hb=this.Sa.zc();if(this.ub){const Eb=ra?Qd.c:Qd.f;hb.buttons.push(this.Rd(this.pH("PivotTableContextMenu.Between",Eb),786260386,0,ra?16===this.ub.LabelOrDateFilterType:24===this.ub.ValueFilterType,O.a.instance.ga(104),ra?"16":"24"));hb.buttons.push(this.Rd(this.pH("PivotTableContextMenu.NotBetween",Eb),786260386,0,ra?17===this.ub.LabelOrDateFilterType:25===
this.ub.ValueFilterType,O.a.instance.ga(665),ra?"17":"25"))}return hb}K$b(ra,hb){const Eb=this.Sa.zc();if(this.ub){var fc=O.a.instance.ga(98);const xd=ra?this.ub.LabelOrDateFilterType.toString():this.ub.ValueFilterType.toString();var Mc=["PivotTableContextMenu.ClearFilter",this.Pua(this.ub.Caption),xd];ra=ra?this.ub.IsDateField?hb?1015867427:1105960559:1217404289:-743135194;Mc.push(ra.toString());Mc=Mc.join(".");fc=this.Rd(Mc,ra,0,!1,fc,xd,fc,8,ma.a.T1a);Eb.buttons.push(fc)}return Eb}rLh(){const ra=
this.Sa.zc();this.ub&&ra.buttons.push(this.Rd(this.pH("PivotTableContextMenu.Equals",Qd.d),786260386,0,26===this.ub.LabelOrDateFilterType,O.a.instance.ga(100),"26"));return ra}qLh(){const ra=this.Sa.zc();this.ub&&(ra.buttons.push(this.Rd("PivotTableContextMenu.Before",786260386,0,27===this.ub.LabelOrDateFilterType,O.a.instance.ga(112),"27")),ra.buttons.push(this.Rd("PivotTableContextMenu.After",786260386,0,28===this.ub.LabelOrDateFilterType,O.a.instance.ga(113),"28")),ra.buttons.push(this.Rd("PivotTableContextMenu.Between",
786260386,0,29===this.ub.LabelOrDateFilterType,O.a.instance.ga(104),"29")));return ra}gNh(){const ra=this.Sa.zc();this.ub&&(ra.buttons.push(this.Rd("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.ub.LabelOrDateFilterType,O.a.instance.ga(110),"30")),ra.buttons.push(this.Rd("PivotTableContextMenu.Today",1778578888,0,31===this.ub.LabelOrDateFilterType,O.a.instance.ga(109),"31")),ra.buttons.push(this.Rd("PivotTableContextMenu.Yesterday",1778578888,0,32===this.ub.LabelOrDateFilterType,O.a.instance.ga(111),
"32")));return ra}jNh(){const ra=this.Sa.zc();this.ub&&(ra.buttons.push(this.Rd("PivotTableContextMenu.NextWeek",1778578888,0,33===this.ub.LabelOrDateFilterType,O.a.instance.ga(115),"33")),ra.buttons.push(this.Rd("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.ub.LabelOrDateFilterType,O.a.instance.ga(114),"34")),ra.buttons.push(this.Rd("PivotTableContextMenu.LastWeek",1778578888,0,35===this.ub.LabelOrDateFilterType,O.a.instance.ga(116),"35")));return ra}hNh(){const ra=this.Sa.zc();this.ub&&
(ra.buttons.push(this.Rd("PivotTableContextMenu.NextMonth",1778578888,0,36===this.ub.LabelOrDateFilterType,O.a.instance.ga(117),"36")),ra.buttons.push(this.Rd("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.ub.LabelOrDateFilterType,O.a.instance.ga(118),"37")),ra.buttons.push(this.Rd("PivotTableContextMenu.LastMonth",1778578888,0,38===this.ub.LabelOrDateFilterType,O.a.instance.ga(119),"38")));return ra}iNh(){const ra=this.Sa.zc();this.ub&&(ra.buttons.push(this.Rd("PivotTableContextMenu.NextQuarter",
1778578888,0,39===this.ub.LabelOrDateFilterType,O.a.instance.ga(120),"39")),ra.buttons.push(this.Rd("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.ub.LabelOrDateFilterType,O.a.instance.ga(121),"40")),ra.buttons.push(this.Rd("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.ub.LabelOrDateFilterType,O.a.instance.ga(122),"41")));return ra}kNh(){const ra=this.Sa.zc();this.ub&&(ra.buttons.push(this.Rd("PivotTableContextMenu.NextYear",1778578888,0,42===this.ub.LabelOrDateFilterType,
O.a.instance.ga(123),"42")),ra.buttons.push(this.Rd("PivotTableContextMenu.ThisYear",1778578888,0,43===this.ub.LabelOrDateFilterType,O.a.instance.ga(124),"43")),ra.buttons.push(this.Rd("PivotTableContextMenu.LastYear",1778578888,0,44===this.ub.LabelOrDateFilterType,O.a.instance.ga(125),"44")));return ra}lNh(){const ra=this.Sa.zc();if(this.ub){ra.buttons.push(this.Rd("PivotTableContextMenu.YearToDate",1778578888,0,45===this.ub.LabelOrDateFilterType,O.a.instance.ga(126),"45"));const hb=this.Lia("PivotTableContextMenu.AllDatesInThePeriod",
1778578888,0,Qd.i(this.ub.LabelOrDateFilterType),O.a.instance.ga(127));this.UDh(hb.menu);ra.buttons.push(hb)}return ra}eLh(){const ra=this.Sa.zc();this.ub&&ra.buttons.push(this.Rd("PivotTableContextMenu.CustomFilter",786260386,0,this.pxj(this.ub.LabelOrDateFilterType),O.a.instance.ga(108),"26"));return ra}VTh(){const ra=this.Sa.zc();this.ub&&(ra.buttons.push(this.Rd("PivotTableContextMenu.Quarter1",1778578888,0,46===this.ub.LabelOrDateFilterType,O.a.instance.ga(128),"46")),ra.buttons.push(this.Rd("PivotTableContextMenu.Quarter2",
1778578888,0,47===this.ub.LabelOrDateFilterType,O.a.instance.ga(129),"47")),ra.buttons.push(this.Rd("PivotTableContextMenu.Quarter3",1778578888,0,48===this.ub.LabelOrDateFilterType,O.a.instance.ga(130),"48")),ra.buttons.push(this.Rd("PivotTableContextMenu.Quarter4",1778578888,0,49===this.ub.LabelOrDateFilterType,O.a.instance.ga(131),"49")));return ra}hRh(){const ra=this.Sa.zc();this.ub&&(ra.buttons.push(this.Rd("PivotTableContextMenu.January",1778578888,0,50===this.ub.LabelOrDateFilterType,O.a.instance.ga(132),
"50")),ra.buttons.push(this.Rd("PivotTableContextMenu.February",1778578888,0,51===this.ub.LabelOrDateFilterType,O.a.instance.ga(133),"51")),ra.buttons.push(this.Rd("PivotTableContextMenu.March",1778578888,0,52===this.ub.LabelOrDateFilterType,O.a.instance.ga(134),"52")),ra.buttons.push(this.Rd("PivotTableContextMenu.April",1778578888,0,53===this.ub.LabelOrDateFilterType,O.a.instance.ga(135),"53")),ra.buttons.push(this.Rd("PivotTableContextMenu.May",1778578888,0,54===this.ub.LabelOrDateFilterType,O.a.instance.ga(136),
"54")),ra.buttons.push(this.Rd("PivotTableContextMenu.June",1778578888,0,55===this.ub.LabelOrDateFilterType,O.a.instance.ga(137),"55")),ra.buttons.push(this.Rd("PivotTableContextMenu.July",1778578888,0,56===this.ub.LabelOrDateFilterType,O.a.instance.ga(138),"56")),ra.buttons.push(this.Rd("PivotTableContextMenu.August",1778578888,0,57===this.ub.LabelOrDateFilterType,O.a.instance.ga(139),"57")),ra.buttons.push(this.Rd("PivotTableContextMenu.September",1778578888,0,58===this.ub.LabelOrDateFilterType,
O.a.instance.ga(140),"58")),ra.buttons.push(this.Rd("PivotTableContextMenu.October",1778578888,0,59===this.ub.LabelOrDateFilterType,O.a.instance.ga(141),"59")),ra.buttons.push(this.Rd("PivotTableContextMenu.November",1778578888,0,60===this.ub.LabelOrDateFilterType,O.a.instance.ga(142),"60")),ra.buttons.push(this.Rd("PivotTableContextMenu.December",1778578888,0,61===this.ub.LabelOrDateFilterType,O.a.instance.ga(143),"61")));return ra}QEh(ra){const hb=this.Sa.zc();if(this.T1f()){var Eb=this.kc.YK[4===
this.xe.CellType?this.kc.g4c-1:this.xe.CurrentFieldIndex-1];if(Eb&&this.E$a){var fc=this.Sa.Ru("ContextMenu.PivotTableLayout",null,O.a.instance.ga(652),-1777747317);var Mc=this.Sa.zc();const xd=String.format(O.a.instance.ob(169),this.E$a),Hd=String.format(O.a.instance.ob(170),this.E$a);Mc.buttons.push(this.Rd(Vc,-1457478532,0,!Eb.IsCompactLayout,xd));Mc.buttons.push(this.Rd(Gc,-1390365353,0,Eb.IsCompactLayout,Hd));fc.menu.nc.push(Mc);fc&&hb.buttons.push(fc)}}if(1===this.xe.CellArea||2===this.xe.CellArea)this.ub.Caption&&
(Eb="",Mc=this.GRa(),fc=String.format(O.a.instance.ob(159),this.BJa(Mc)),Mc&&(Eb=String.format(O.a.instance.ob(159),this.ub.Caption)),1===this.xe.CellArea?(Eb=this.Lia("ContextMenu.PivotTableSubtotal",1801458190,0,this.ub.ShowSubtotal,fc),fc=this.Sa.zc(),fc.buttons.push(this.Sa.pb(259)),fc.buttons.push(this.Rd("ContextMenu.PivotTableSubtotalOnTop",671485366,644,this.ub.ShowSubtotal&&this.ub.ShowSubtotalAtTop)),fc.buttons.push(this.Rd("ContextMenu.PivotTableSubtotalOnBottom",772221736,645,this.ub.ShowSubtotal&&
!this.ub.ShowSubtotalAtTop)),Eb.menu.nc.push(fc),Eb&&0<fc.buttons.length&&hb.buttons.push(Eb)):(Mc=Mc?this.pH(Xb,this.Pua(fc)):Xb,hb.buttons.push(this.Rd(Mc,1801458190,0,this.ub.ShowSubtotal,fc,null,Eb)))),hb.buttons.push(this.Rd("ContextMenu.RepeatItemLabels",-556893687,647,this.ub.RepeatItemLabels));1===this.xe.CellArea&&hb.buttons.push(this.Rd("ContextMenu.PivotBlankLineAfterEachItem",1600778266,646,this.ub.ShowBlankLineAfterEachItem));ra.nc.push(hb)}FFh(ra){const hb=this.Sa.zc();hb.buttons.push(this.Sa.pb(247));
ra.nc.push(hb)}aFh(ra){if(this.$.isEditMode&&this.grid){var hb=this.grid.ha.sa.activeRange;if(hb.top===hb.bottom&&hb.left===hb.right&&0!==this.xe.MoveItemsMenuState){hb=this.Lia("PivotTableContextMenu.Move",-1777747317,0,!1,O.a.instance.ga(73));var Eb=this.Sa.zc();this.pua(Eb,"PivotTableContextMenu.MoveToBeginning",2059542618,String.format(O.a.instance.ob(162),this.xe.MoveItemName),0===(this.xe.MoveItemsMenuState&1));this.pua(Eb,"PivotTableContextMenu.MoveUp",713270357,String.format(O.a.instance.ob(163),
this.xe.MoveItemName),0===(this.xe.MoveItemsMenuState&2));this.pua(Eb,"PivotTableContextMenu.MoveDown",-1842411134,String.format(O.a.instance.ob(160),this.xe.MoveItemName),0===(this.xe.MoveItemsMenuState&4));this.pua(Eb,"PivotTableContextMenu.MoveToEnd",2054968064,String.format(O.a.instance.ob(161),this.xe.MoveItemName),0===(this.xe.MoveItemsMenuState&8));hb.menu.nc.push(Eb);Eb=this.Sa.zc();this.pua(Eb,"PivotTableContextMenu.MoveDataItemTop",74278997,String.format(O.a.instance.ob(167),this.BJa(this.GRa())),
0===(this.xe.MoveItemsMenuState&16));this.pua(Eb,"PivotTableContextMenu.MoveDataItemUp",8572743,String.format(O.a.instance.ob(164),this.BJa(this.GRa())),0===(this.xe.MoveItemsMenuState&32));this.pua(Eb,"PivotTableContextMenu.MoveDataItemDown",833996216,String.format(O.a.instance.ob(165),this.BJa(this.GRa())),0===(this.xe.MoveItemsMenuState&64));this.pua(Eb,"PivotTableContextMenu.MoveDataItemBottom",139202061,String.format(O.a.instance.ob(166),this.BJa(this.GRa())),0===(this.xe.MoveItemsMenuState&
128));hb.menu.nc.push(Eb);ra.buttons.push(hb)}}}vFh(ra){var hb="";let Eb="";var fc=!1;3===this.xe.CellType?hb=O.a.instance.ga(649):8===this.xe.CellType?this.kc&&(hb=String.format(O.a.instance.ob(168),this.kc.UEe)):this.ub&&((fc=this.GRa())&&(Eb=String.format(O.a.instance.ob(168),this.ub.Caption)),hb=String.format(O.a.instance.ob(168),this.BJa(fc)));hb&&(fc=fc?this.pH(eb,this.Pua(hb)):eb,hb=this.Rd(fc,-1951357930,0,!1,hb,null,Eb,8,ma.a.F8c),ra.buttons.push(hb))}bEh(ra){const hb=this.Sa.zc();hb.buttons.push(this.Sa.pb(43));
this.ub&&this.xe&&this.$.isEditMode&&(0===this.xe.CellType||4===this.xe.CellType)&&hb.buttons.push(this.Sa.pb(136));ra.nc.push(hb)}uFh(ra){const hb=this.Sa.zc();hb.buttons.push(this.Sa.pb(100));ra.nc.push(hb)}LFh(ra){const hb=2===this.ub.MeasureType&&!this.ub.IsNumeric,Eb=this.Sa.Ru("ContextMenu.SummarizeValuesBy",null,O.a.instance.ga(650),-249874296),fc=this.Sa.zc();fc.buttons.push(this.Rd("ContextMenu.SummarizeValuesBySum",-1255320719,1104,0===this.ub.DataFieldAggregationType,void 0,void 0,void 0,
void 0,void 0,hb));fc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByCount",1746132849,1105,1===this.ub.DataFieldAggregationType));fc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByAverage",-771066011,1106,2===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,hb));fc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByMax",835007294,1107,3===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,hb));fc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByMin",
929115636,1108,4===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,hb));fc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByProduct",1935475057,1109,5===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,this.f1f(!0)||hb));2!==this.ub.MeasureType&&(fc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1110,6===this.ub.DataFieldAggregationType)),fc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByStdDeviation",588680636,1111,7===this.ub.DataFieldAggregationType)),
fc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1112,8===this.ub.DataFieldAggregationType)),fc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByVariant",1668427539,1113,9===this.ub.DataFieldAggregationType)),fc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1114,10===this.ub.DataFieldAggregationType)));this.kc&&this.kc.Ufc()&&fc.buttons.push(this.Rd("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1115,11===this.ub.DataFieldAggregationType));
Eb.menu.nc.push(fc);ra.buttons.push(Eb)}GFh(ra){const hb=this.Sa.Ru("ContextMenu.ShowValuesAs",null,O.a.instance.ga(651),-1128612833),Eb=this.Sa.zc();Eb.buttons.push(this.Rd("ContextMenu.ShowValuesAsNoCalculation",-841863025,1121,0===this.ub.DataFieldFormatType));Eb.buttons.push(this.Rd("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1128,7===this.ub.DataFieldFormatType));Eb.buttons.push(this.Rd("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1127,6===this.ub.DataFieldFormatType));
Eb.buttons.push(this.Rd("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1126,5===this.ub.DataFieldFormatType));Eb.buttons.push(this.Rd("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1131,9===this.ub.DataFieldFormatType));Eb.buttons.push(this.Rd("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1132,10===this.ub.DataFieldFormatType));if(this.kc&&this.kc.YK&&0<this.kc.YK.length||this.kc.X9&&0<this.kc.X9.length){const fc=this.Lia("ContextMenu.ShowValuesAsPercentOfParentTotal",
-1128612833,1133,11===this.ub.DataFieldFormatType),Mc=this.Sa.zc(),xd=this.KFh();for(let Hd=0;Hd<xd.length;Hd++){const Md=xd[Hd];Mc.buttons.push(this.Rd("ContextMenu.ShowValuesAsPercentOfParentTotal."+Md.Caption,-2031744961,1133,11===this.ub.DataFieldFormatType&&this.ub.BaseFieldIndex===Md.Index,Md.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+Md.Index))}fc.menu.nc.push(Mc);Eb.buttons.push(fc)}hb.menu.nc.push(Eb);ra.buttons.push(hb)}showPivotTableContextMenu(){this.Qmd=!0;this.expandCollapse=
this.yY=this.refresh=!1;var ra=this.$,hb=oa.g(ra),Eb=tc.a(ra).SJa();if(Eb){var fc=Jb.a(ra);if(null===fc||void 0===fc?0:fc.XPd)this.Qmd=Pb.f(ra.pg);fc=ra.jc;this.yY=Eb.supportsBIExplore&&!!lb.a(ra)&&fc.R1(32768);fc.allowInteractivity&&(ra=hb.Vb(null),(null===ra||void 0===ra?0:ra.cell)&&(ra.cell.vYc||ra.cell.Q1f)&&(this.expandCollapse=!0),fc.allowManualDataRefresh&&(this.refresh=!0))}ra=null;Eb=1;this.X_a&&1!==this.X_a.tb?(ra=new Sys.UI.Point(this.X_a.clientPoint.x,this.X_a.clientPoint.y),Eb=this.X_a.tb):
(hb=Nd.e(hb,this.$))&&(ra=new Sys.UI.Point(hb.x+(this.$.isChromeRtl?0:hb.width),hb.y+hb.height));x.a.Eb=Eb;this.chc=3===Eb;this.Bp(ra,!0,Eb);this.cba=!0;this.qTd()}x5h(){const ra=new T.a(1114549926,0,this.$.Mc,19,null);this.$.Ka.Mb(ra)}XSh(){if(this.kc&&this.kc.Qo){var ra=this.kc.Qo.CurrentCol;if(this.kc.Qo.CurrentRow===this.activeCell.FirstRow&&ra===this.activeCell.FirstColumn){this.YJb();this.showPivotTableContextMenu();return}}ra=new U.a(228,0,(hb,Eb,fc)=>xe.k(this.$.oa.va,this.activeCell,R.b(hb,
this.WKi),R.a(Eb,this.VKi),fc,null),16);this.$.userOperationManager.Ub(ra,null)}Hji(){if(mb.a.Ad(this.$)){var ra=this.$.da.za(441);if(ra)return ra.Qr}else if(ra=this.$.da.za(346))return ra.Qr;return!1}pH(ra,hb){return ra+"."+hb}performPivotTableOperation(ra,hb){const Eb=le.a.Wa.Nb;if(!this.kc||!this.ub&&this.xe&&3!==this.xe.CellType)this.oj();else{var fc=this.kc.isOlap;tc.a(this.$).wx(fc,Mc=>{Mc&&this.$.Ub(ra,(xd,Hd,Md)=>he(this.GZd,this.activeCell,hb,this.ub?this.ub.Caption:null,this.E$a,R.b(xd,
this.KOi),R.a(Hd,this.JOi),Md,null,this.$.oa.va.Sb()),Eb,0,4,229)})}}applyValueFieldSettingsToPivotTable(ra,hb=!1){const Eb=le.a.Wa.Nb;this.kc&&this.ub?(hb&&2===this.ub.MeasureType&&e.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),hb=this.kc.isOlap,tc.a(this.$).wx(hb,fc=>{fc&&this.$.Ub(ra,(Mc,xd,Hd)=>ve(this.GZd,this.activeCell,this.dA,R.b(Mc,this.zFi),R.a(xd,this.yFi),Hd,null,this.$.oa.va.Sb()),Eb,0,4,231)})):this.oj()}Rd(ra,hb,Eb,
fc,Mc=null,xd=null,Hd=null,Md=8,ae=null,me=!1){fc&&(ra+=".Checked");me&&(ra+=".Disabled");this.Sa.Dld(ra)&&this.Sa.zHd(ra);Eb=Mc||O.a.instance.ga(Eb);ra=this.Sa.bHa(ra,Eb,hb,null,"None",xd,me,null);ra.Puc(null);Hd&&ra.FR(Hd);fc?ra.HR("Image16by16",3,ma.a.G$):ae?ra.HR("Image16by16",Md,ae):ra.k1b();return ra}Lia(ra,hb,Eb,fc,Mc=null){Eb=Mc||O.a.instance.ga(Eb);this.Sa.Dld(ra)?this.Sa.zHd(ra):this.Sa.zHd(ra+".Checked");fc&&(ra+=".Checked");this.Ivj&&(Eb=this.Ygh.parseFromString(Eb,"text/html").body.innerText);
ra=this.Sa.o2c(ra,null,Eb,hb,3,ma.a.G$);ra.F8e=fc;!fc&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&ra.k1b();return ra}i9h(){this.dA=Object(f.a)(new Oc,{PivotValueFieldSummarizeValueByApplyData:Object(f.a)(new od,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(f.a)(new cd,{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})}pRa(ra,hb){this.dA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=
ra;this.dA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=hb;this.dA.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1}KFh(){const ra=[];if(this.kc&&this.kc.X9&&0<this.kc.X9.length)for(const hb of this.kc.X9)hb&&ra.push(hb);if(this.kc&&this.kc.YK&&0<this.kc.YK.length)for(const hb of this.kc.YK)hb&&ra.push(hb);ra.sort((hb,Eb)=>hb.Index-Eb.Index);return ra}T1f(){if(!this.xe||!this.kc||!this.kc.YK)return!1;const ra=1===this.xe.CellArea||4===this.xe.CellType&&this.xe.IsRowAxis,hb=4===this.xe.CellType?
0<this.kc.g4c:0<this.xe.CurrentFieldIndex;return 1<this.kc.YK.length&&ra&&hb}DJa(ra){const hb=[];3===ra?this.$.isEditMode?hb.push(...[vb.a.fGf,vb.a.hGf,vb.a.qXi]):hb.push(...[vb.a.copy]):2===ra&&hb.push(vb.a.gwe);return hb}oj(){const ra=V.a.Yc(1,0,0,653,0,104573951,"PivotTableContextMenuOperationFailure");Rb.a(this.$).oj(ra)}sxj(){return this.ub?0!==this.ub.LabelOrDateFilterType||0!==this.ub.ValueFilterType||this.ub.HasManualFilter:!1}pxj(ra){return 62<=ra&&65>=ra}qqi(){if(this.activeCell&&this.ub&&
this.kc){var ra={};ra.cell=this.activeCell;ra.dataSourceIndex=this.kc.externalSourceIndex;ra.fieldId=this.ub.Index.toString();ra.isOlap=this.kc.isOlap;ra.confirmationRequired=this.kc.confirmationRequiredForDataOps;var hb={};hb.showPivotFilterDialogCommandData=ra;this.$.ud(492140419,x.a.Eb,19,hb)}}IXg(ra){this.activeCell&&this.ub&&this.kc&&this.$.userOperationManager.Ub(new U.a(153,0,(hb,Eb,fc)=>X.A(this.$.oa.va,this.activeCell,this.kc.externalSourceIndex,this.ub.Index.toString(),ra,hb,Eb,fc,null,
null)),null)}$Jg(ra){!(30>ra||61<ra)&&this.activeCell&&this.ub&&this.kc&&this.$.userOperationManager.Ub(new U.a(152,0,(hb,Eb,fc)=>X.e(this.$.oa.va,this.activeCell,this.kc.externalSourceIndex,this.ub.Index.toString(),ra,hb,Eb,fc,null,null)),null)}applyPivotSort(ra){if(this.kc&&this.ub&&this.activeCell&&this.xe){var hb=1===this.xe.CellArea||2===this.xe.CellArea;8===this.xe.CellArea?ke.a(this.$.userOperationManager,(Eb,fc,Mc)=>xe.b(this.$.oa.va,this.activeCell,ra,this.ub.Caption,Eb,fc,Mc,null),Eb=>new U.a(1015,
0,Eb,void 0,null),null):hb&&(hb=1===this.xe.CellArea?1:2,this.$.ma(688)?Td.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.kc.externalSourceIndex,this.ub.Index.toString(),this.ub.Caption,this.kc.isOlap?"":this.ub.Caption,hb,1===ra):Td.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.kc.externalSourceIndex,this.ub.Index.toString(),1===ra))}}JR(){return!this.kc||!this.kc.isActionable}Zvj(){return(this.xe||this.kc)&&4!==this.xe.CellType&&
(0!==this.xe.CellType||8!==this.xe.CellArea||this.kc.X9&&this.kc.X9.length||this.kc.YK&&this.kc.YK.length)?!1:!0}$vj(){return this.xe&&this.kc&&(1===this.xe.CellArea||2===this.xe.CellArea)&&this.kc.uOb&&this.kc.uOb.length?!1:!0}pua(ra,hb,Eb,fc,Mc){ra.buttons.push(this.Rd(hb,Eb,0,!1,fc,null,null,8,null,Mc))}}Object(c.a)(P,"PivotTableContextMenu",w.a,[]);class Ta{compare(ra,hb){return(ra||"").localeCompare(hb||"",void 0,{numeric:!0,sensitivity:"accent"})}}Object(c.a)(Ta,"DigitsAsNumberComparer",null,
[480]);var pb=a(1078),Yb=a(153),Ac=a(340),Zc=a(261),id=a(24),gd=a(171);const Ub=r.a.H1g;class Lc extends w.a{constructor(ra,hb,Eb,fc){super(ra,"PopulateTableFieldListContextMenu",-751848458,-1085236154,Ub,!0,!1,"TableFieldListContextMenuRoot",hb,Eb,!1,fc);this.W3b=null;this.Cxd=0;this.ZDa=null;this.grid=oa.g(ra)}get Bw(){return"PopulateTableFieldListContextMenu"}get wB(){return r.a.nLf}get MK(){this.ZDa||(this.ZDa=this.$.da.za(261));return this.ZDa}executeCommand(ra,hb,Eb){ra=hb.command;switch(ra){case 639960842:this.applyTableFieldList(Eb);
this.MK.Wca();break;case -1085236154:e.ULS.sendTraceTag(537166999,0,50,`TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, ${this.Cxd}`);this.MK.Wca();break;case 1833782813:this.MK.showCallout();break;default:return qa.a(ra)}return Ya.Task.Ta(!0)}applyTableFieldList(ra){var hb=ra.MenuItemId.toString();da.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&(hb=hb.replace("'","''"),hb=hb.replace("[","'["),hb=hb.replace("]","']"));var Eb=
Object(Wb.a)(String,ra.SourceControlId);const fc={};fc.PulloutField=hb;fc.PulloutCardPath=ra.SourceCardKeyPath;fc.PulloutCardSourceRow=ra.SourceCardRow;fc.PulloutCardSourceColumn=ra.SourceCardColumn;if(this.MK.bN){e.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");fc.ParameterType=2;ra=ra.ColumnIndex;if(void 0===ra||null===ra){if(void 0===Eb||null===Eb){e.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");
return}ra=0<=this.MK.oJf?this.MK.oJf:parseInt(Eb.substring(20+hb.length+1,Eb.length),10);if(isNaN(ra)){e.ULS.shipAssertTag(537166997,0,!1,`TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, ${Eb}`);return}}fc.PulloutRichColumnSourceIndex=ra;if(this.ZDa.yHg){this.lIg(hb,fc);return}}else e.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),fc.ParameterType=4,Eb=this.MK.selectedRange.right,mb.a.hyb()&&this.ZDa.dwa&&(fc.ParameterType=8,ra=this.MK.$ka.top,ra=
id.Range.xP(Eb)+ra,hb==pb.d?(hb="=DAYS("+ra+", TODAY())",gd.a("DateFormulaPulledOut_DaysFromToday")):hb==pb.g?(hb="=IF(TODAY() < "+ra+", DATEDIF(TODAY(), "+ra+', "Y"), DATEDIF('+ra+', TODAY(), "Y"))',gd.a("DateFormulaPulledOut_YearsFromToday")):hb==pb.c?(hb="=TEXT("+ra+', "dddd")',gd.a("DateFormulaPulledOut_DayOfWeek")):hb==pb.f?(hb="=TEXT("+ra+', "mmmm")',gd.a("DateFormulaPulledOut_MonthOfYear")):hb==pb.e?(hb="EOMONTH("+ra+", 0)",hb="=DATE(YEAR("+hb+"), MONTH("+hb+"), DAY("+hb+"))",gd.a("DateFormulaPulledOut_EndOfMonth")):
hb==pb.b&&(hb="="+ra+" + 1",gd.a("DateFormulaPulledOut_AddOneDay"))),void 0!==fc.PulloutCardSourceColumn&&null!==fc.PulloutCardSourceColumn&&(Eb=fc.PulloutCardSourceColumn+1),fc.PulloutRichColumnSourceIndex=Eb;this.HNd(hb,fc)}HNd(ra,hb,Eb=0){e.ULS.sendTraceTag(537166996,0,50,`TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, ${this.Cxd}, SelectedColumnIndex, ${hb.PulloutRichColumnSourceIndex}`);ra=Object(f.a)(new Zc.a,{Text:ra});this.grid.setCell(ra,this.MK.$ka,0,127,hb,Eb);this.grid.focus();
this.W3b=null;this.MK.Wca();this.MK.Cfj()}Cc(ra,hb,Eb){if(ra=this.$.isEditMode&&da.EwaSettings.ma(135)&&!!this.MK)switch(hb.command){case -1085236154:break;case 639960842:ra=!!Eb;break;case 1833782813:ra=this.MK.Tva&&this.MK.UAb;break;default:ra=!1}return ra}b0(ra,hb,Eb){this.$.isEditMode&&(this.W3b=this.WEh(Object(Wb.a)(460,Eb)),super.b0(ra,hb,null,null,!1))}hY(){return this.W3b}n2c(ra){if(!this.MK||!ra||!ra.Qk)return e.ULS.shipAssertTag(537166994,0,!!this.MK,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),
e.ULS.shipAssertTag(537166993,0,!!ra,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),ra&&e.ULS.shipAssertTag(537166992,0,!!ra.Qk,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;let hb=new Ea.a;for(const fc of ra.Qk){ra=new Ea.a;ra.add(fc.ColumnName);ra.add(fc.ColumnIndex.toString());let Mc=new Ea.a;var Eb=null;mb.a.hyb()&&this.ZDa.dwa?Mc=Na.toList(Na.select(Na.asEnumerable(fc.FieldInfoDataList),xd=>xd.Name)):(Eb=
da.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new Ta:new na.a,Mc=Na.OBc(Na.concat(Mc,Na.select(Na.asEnumerable(fc.FieldInfoDataList),xd=>xd.Name)),xd=>xd,Eb));Eb=new Ea.a;Eb.add(Na.toArray(Na.concat(ra,Mc)));hb=Na.toList(Na.concat(hb,Eb))}return Na.toArray(hb)}WEh(ra){var hb=this.n2c(ra);if(!hb||!hb.length)return this.W3b=null;ra=this.Sa;const Eb=ra.sq(this.menuId);let fc=ra.zc();const Mc=1<hb.length,xd=mb.a.hyb()&&this.ZDa.dwa;this.Cxd=hb.length;
for(const Hd of hb){xd?fc.title="Calculate Date Information":Mc||(fc.title=Hd[0]);hb=ra.zc();for(let Md=2,ae=Hd.length;Md<ae;++Md)!xd||Hd[Md]!=pb.d&&Hd[Md]!=pb.e||(Eb.nc.push(fc),fc=ra.zc()),(Mc?hb.buttons:fc.buttons).push(ra.bHa("ApplyTableFieldList."+Hd[Md]+"."+Hd[1],Hd[Md],639960842,null,"None",Hd[Md],!1,void 0,!0));if(Mc){const Md=ra.Ru("ApplyTableFieldList."+Hd[0],this.menuId,Hd[0],798637440);Md.menu.nc.push(hb);fc.buttons.push(Md)}}Eb.nc.push(fc);return Eb}lIg(ra,hb){const Eb=V.a.Yc(12,1,0,
903,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(da.EwaSettings.wz()){const fc=new Ac.a(this.$,Eb);fc.cP(()=>{2===fc.returnValue&&this.HNd(ra,hb,8)})}else{const fc=new Yb.ErrorDialog(this.$,Eb);fc.cP(()=>{2===fc.returnValue&&this.HNd(ra,hb,8)});fc.Ff()}}}Object(c.a)(Lc,"PulloutFieldListContextMenu",w.a,[]);const hd=r.a.pLf;class Kd extends w.a{constructor(ra,hb,Eb,fc){super(ra,"PopulateRichTextContextMenu",679816325,1151222423,hd,!0,!1,hd,hb,Eb,!0,fc);this.grid=oa.g(ra)}get Bw(){return"PopulateRichTextContextMenu"}get wB(){return r.a.pLf}Cc(ra,
hb,Eb){return-1687037502===hb.command&&!!Eb&&this.grid.eb}executeCommand(ra,hb,Eb){this.showRichTextFloatie(Eb);return Ya.Task.Ta(!0)}DJa(){return[vb.a.mVg]}showRichTextFloatie(ra){var hb=Object(Wb.a)(Sa.a,ra.eventArgs);hb&&(ra=this.DJa(hb.tb),hb=new Sys.UI.Point(hb.Ca.clientX,hb.Ca.clientY),this.showFloatie(ra,new Sys.UI.Bounds(hb.x,hb.y,0,0),2))}}Object(c.a)(Kd,"RichTextContextMenu",w.a,[]);var Wd=a(100),oe=a(572);const We=r.a.G1g;class Ze extends w.a{constructor(ra,hb,Eb,fc){super(ra,"PopulateSheetOpsContextMenu",
274207288,-1497523576,We,!0,!1,"SheetTabContextMenuRootName",hb,Eb,!1,fc);this.Vgc=this.ufc=!1}get Bw(){return"PopulateSheetOpsContextMenu"}get wB(){return r.a.qLf}executeCommand(ra,hb,Eb){if(Ob.a(this.$))return Ya.Task.Ta(!0);this.$.isEditMode&&(ra=Eb[r.a.N0f],ra=ra.x&&ra.y?new Sys.UI.Point(ra.x+(this.$.isChromeRtl?10:-10),ra.y):va.DOMElementExtensions.getLocation(Eb[r.a.O0f]),this.Bp(ra,!1));return Ya.Task.Ta(!0)}Cc(ra,hb,Eb){return-1075099431===hb.command&&!!Eb}hY(){const ra=this.Sa.sq(this.menuId),
hb=this.$.isEditMode;this.dTj();this.KEh(ra,hb);this.zEh(ra);this.EFh(ra);return ra}NXb(ra,hb,Eb,fc){ra.push(this.Sa.pb(hb?Eb:fc))}KEh(ra,hb){var Eb=this.Sa;const fc=Eb.zc();fc.buttons.push(Eb.pb(54));this.NXb(fc.buttons,this.Vgc,127,56);fc.buttons.push(Eb.pb(55));hb&&this.NXb(fc.buttons,this.Vgc,126,125);fc.buttons.push(Eb.pb(158));hb=this.$.xa.pa;da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.mK&&!this.$.ea.isNamedObjectViewMode&&!this.$.isMobileMode&&
hb&&hb.Ed&&(hb.Ed.lv||hb.Ed.OH||fc.buttons.push(Eb.pb(300)));this.$.ea.IKb&&(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6540166_CheckIsSdxAllowedForProtectionPane")?l.AFrameworkApplication.kpd(oe.a):this.$.ya.ExcelSheetProtectionSettingsEnabled)&&(hb=Object(Wb.a)(Wd.a,this.$.pa))&&Ha.p(hb)&&this.$.isEditMode&&(fc.buttons.push(Eb.pb(277)),hb.isLockPausedInSession?fc.buttons.push(Eb.pb(279)):hb.li&&fc.buttons.push(Eb.pb(278)));hb=Eb.Ru("ContextMenu.TabColor",null,O.a.instance.ga(523),1841703919);
Eb=Eb.k2c(467002767,1549407384,546,-221093529,this.wB);hb.menu.nc.push(Eb);fc.buttons.push(hb);ra.nc.push(fc)}zEh(ra){const hb=this.Sa.zc();this.NXb(hb.buttons,this.Vgc,114,112);this.NXb(hb.buttons,!this.ufc,115,113);ra.nc.push(hb)}EFh(ra){if(da.EwaSettings.ma(480)&&!Ha.e(this.$.xa.pa)){var hb=this.Sa,Eb=hb.zc();Eb.buttons.push(hb.pb(263));ra.nc.push(Eb)}}dTj(){let ra,hb;({X1c:ra,zBe:hb}=this.$.W1c());this.Vgc=1===ra;this.ufc=0<hb}}Object(c.a)(Ze,"SheetOpsContextMenu",w.a,[]);var Be=a(515);class af extends w.a{constructor(ra,
hb,Eb,fc){super(ra,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",hb,Eb,!0,fc)}get Bw(){return"PopulateSlicerContextMenu"}get wB(){return r.a.rLf}Nc(ra,hb){var Eb=!0;switch(hb){case -231711729:Eb=!1;break;case -1909381757:Eb=this.Mac();Eb=!!Eb&&Eb.Fgi;break;case 1312363469:Eb=!0}return!Eb||super.Nc(ra,hb)}executeCommand(ra,hb,Eb){if(!this.$.isEditMode)return J.TaskExtensions.raa();ra=hb.command;hb=this.Mac();let fc=null;switch(ra){case 2108047455:hb&&
hb.bye();break;case -231711729:e.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:hb&&hb.s1b();break;case 1312363469:this.showSlicerContextMenu(Eb);break;default:fc=qa.a(ra)}return fc||J.TaskExtensions.raa()}Cc(ra,hb,Eb){ra=!1;switch(hb.command){case -231711729:case 2108047455:case -1909381757:ra=!0;break;case 1312363469:ra=!!Eb}return ra}hY(){const ra=this.Sa.sq(this.menuId);var hb=this.Sa.zc();hb.buttons.push(this.Sa.pb(252));hb.buttons.push(this.Sa.pb(253));
hb.buttons.push(this.Sa.pb(254));ra.nc.push(hb);hb=this.Sa.zc();this.Tli()?hb.buttons.push(this.Sa.pb(266)):hb.buttons.push(this.Sa.pb(267));ra.nc.push(hb);return ra}Tli(){if(mb.a.Ad(this.$)){var ra=this.$.da.za(439);if(ra)return ra.Qr}else if(ra=this.$.da.za(371))return ra.Qr;return!1}showSlicerContextMenu(ra){var hb=Object(Wb.a)(Sa.a,ra.eventArgs);ra=this.l$b(Object(Wb.a)(Sa.a,ra.eventArgs));hb=hb.tb;x.a.Eb=hb;this.Bp(ra,!1,hb)}LUe(ra){const hb=this.Sa.zc(),Eb=this.Sa.zc();Eb.buttons.push(this.Sa.pb(255));
Eb.buttons.push(this.Sa.pb(256));const fc=this.Sa.o2c("ContextMenu.SlicerSort",null,O.a.instance.ga(2178),-814639094,0,ma.a.INe);fc.menu.nc.push(Eb);hb.buttons.push(fc);ra.nc.push(hb)}Ixj(ra){return da.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&ra.Cb.className===ma.a.q8c||da.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===ra.tb}l$b(ra){var hb=oa.g(this.$).ha.Pa.$b;let Eb=ra&&1!==ra.tb&&
ra.clientPoint?ra.clientPoint:Sys.UI.DomElement.getLocation(hb.domElement);if(this.Ixj(ra)){var fc=this.Mac();fc&&(ra.Cb.className===ma.a.q8c&&(Eb=Oa.HelperMethods.qub(ra.Ca)),1===ra.tb&&(Eb=fa.a(this.$).gja(va.DOMElementExtensions.getLocation(fc.frame))))}else if(ra=this.Mac())ra=this.eOh(ra.frame),(fc=Oa.HelperMethods.VC(this.$.Cf,this.$.domElement,oa.g(this.$).rtl,!1))?(ra.x=fa.a(this.$).si(ra.x-fc.x)+fc.x,ra.y=fa.a(this.$).si(ra.y-fc.y)+fc.y):e.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),
Eb.y+=ra.y,Eb.x+=ra.x;ra=this.$.domElement;fc=oa.g(this.$).rtl;hb=Oa.HelperMethods.VC(hb.kg.domElement,ra,fc);Eb.y=Math.max(Eb.y,hb.y);Eb.x=Math.max(Eb.x,hb.x);return Eb}Mac(){const ra=oa.g(this.$).ha.Pa.$b;e.ULS.shipAssertTag(537166988,0,!!ra);return Be.a(this.$).vH(ra.floatingObject.id)}eOh(ra){let hb=new Sys.UI.Point(ra.offsetParent.offsetLeft,ra.offsetParent.offsetTop);var Eb=oa.g(this.$);if(!Eb)return hb;const fc=oa.g(this.$).rtl;hb=Oa.HelperMethods.VC(ra,this.$.dr.ownerDocument.body,fc);Eb.rBe(hb);
hb.x=fc?this.$.dr.clientWidth-hb.x-ra.clientWidth:hb.x;ra=Eb.view.nob;Eb=fc?-Eb.BR.Rba(ra.x):ra.x;hb.x-=Eb;hb.y-=ra.y;return hb}}Object(c.a)(af,"SlicerContextMenu",w.a,[]);class ff{constructor(ra,hb,Eb){this.type=ra;this.E1g=hb;this.tr=Eb}}Object(c.a)(ff,"TimeSlicerRibbonButtonParameter",null,[]);class Pe extends w.a{constructor(ra,hb,Eb,fc){super(ra,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,Pe.XIj,!0,!1,Pe.KIb,hb,Eb,!1,fc);this.u0a=0;this.UIe=this.MJa=this.esa=null}get Bw(){return"PopulateTimeSlicerLevelMenu"}get wB(){return r.a.uLf}executeCommand(ra,
hb,Eb){ra=hb.command;switch(ra){case 2000085697:ra=Eb.DOMElement;this.esa=Eb.ChangeLevelCallback;this.MJa=Eb.GetLevelLabelCallback;this.u0a=Eb.CurrentLevel;const fc=Eb.DomEvent;K.g(fc);const Mc=Eb.location;Eb=Eb.levelLabelText;this.UIe=va.DOMElementExtensions.qz(document.activeElement,"iframe")&&Eb?Eb.parentNode:null;Eb=Sys.UI.DomElement.getBounds(Eb);Eb.x=Mc.x;Eb.y=Mc.y;this.b0(fc,ra,Eb,hb,!0);break;case -649826274:this.esa(0);break;case 149600865:this.esa(1);break;case -2012435159:this.esa(2);break;
case -1979934975:this.esa(3);break;case 1634477200:va.DOMElementExtensions.setFocus(this.UIe);break;default:return qa.a(ra)}return Ya.Task.Ta(!0)}Cc(ra,hb,Eb){ra=!1;switch(hb.command){case 2000085697:ra=!!Eb;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:ra=!0}return ra}b0(ra,hb,Eb){ra=Sys.UI.DomElement.getBounds(hb);Eb.x=fa.a(this.$).si(Eb.x);Eb.y=fa.a(this.$).si(Eb.y);ra.x=fa.a(this.$).si(ra.x);ra.y=fa.a(this.$).si(ra.y);ra=new Sys.UI.Point(ra.x+Eb.x,ra.y+
Eb.y);this.showContextMenu(new Sys.UI.Bounds(ra.x,ra.y-Eb.height,Eb.width,Eb.height))}hY(){const ra=this.Sa,hb=ra.sq(this.menuId),Eb=ra.zc();for(let Mc=0;3>=Mc;Mc++){const xd=this.MJa(Mc);var fc=Pe.zIh(Mc);fc=ra.H3g(fc.E1g,fc.tr,this.u0a===Mc,Pe.dxe);fc.label=xd;fc.FR(xd);this.u0a===Mc?fc.HR("Image16by16",8,Pe.dxe):fc.k1b();Eb.buttons.push(fc)}hb.nc.push(Eb);return hb}static zIh(ra){let hb=null;switch(ra){case 0:hb=new ff(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:hb=new ff(88,
"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:hb=new ff(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:hb=new ff(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return hb}}Pe.XIj=r.a.I1g;Pe.KIb="TimeSlicerLevelMenuRootName";Pe.dxe=ma.a.Sta;Object(c.a)(Pe,"TimeSlicerLevelMenu",w.a,[]);var Ne=a(312),se=a(3);class Wa extends b.a{constructor(ra){super(ra)}yd(){const ra=this.$,hb=$a.a.m0a(Ba.b(),this.la,"Task","IRootUser"),Eb=d.a(ra);let fc=null;fc=(Hd,Md)=>{Eb.aQf(fc);
hb.setResult(Md.G2b)};Eb.Hme(fc);Eb.y_e();const Mc=S.GetServiceTaskFactory.create(ra.da,102,ra.la,this.hb),xd=S.GetServiceTaskFactory.Ra(ra.da,342,338,this.hb);J.TaskExtensions.Aa(J.TaskExtensions.Wd([hb.task,Mc,xd],this.la),()=>{const Hd=Mc.result,Md=hb.task.result,ae=xd.result;this.gd([new cc(ra,Md,Hd,ae),new nb(ra,Md,Hd,ae),new Xa(ra,Md,Hd,ae),new wb(ra,Md,Hd,ae),new ld(ra,Md,Hd,ae),new Ja(ra,Md,Hd,ae),new Dd.GridContextMenu(ra,Md,Hd,ae),new Od(ra,Md,Hd,ae),new Ze(ra,Md,Hd,ae),new Pe(ra,Md,Hd,
ae),new Lc(ra,Md,Hd,ae),new Va(ra,Md,Hd,ae),new P(ra,Md,Hd,ae),new af(ra,Md,Hd,ae),new Kd(ra,Md,Hd,ae)])},ra.la,3)}static initData(){const ra=Ne.a.O8;ra(2000085697,20479,0,0);ra(-227942804,se.a.wc|24576,0,0);ra(1634477200,se.a.wc|131072,0,0);ra(-649826274,4095,0,0);ra(149600865,4095,0,0);ra(-2012435159,4095,0,0);ra(-1979934975,4095,0,0);ra(1247109494,se.a.wc|24576,0,0);ra(-2064931494,se.a.wc|131072,0,0);ra(-1396319072,se.a.Ha,128,0);ra(-425234874,se.a.Ha,128,0);ra(-1253126584,se.a.Ha,0,0);ra(274207288,
se.a.wc|24576,0,0);ra(-1497523576,se.a.wc|131072,0,0);ra(-498523270,se.a.wc|24576,64,0);ra(1640762262,se.a.wc|131072,64,0);ra(-2017893763,se.a.wc|24576,0,0);ra(1350204367,se.a.wc|131072,0,0);ra(-889576107,se.a.Uv,128,0);ra(-1170196828,se.a.Uv,128,0);ra(389774337,se.a.Uv,128,0);ra(1529312473,se.a.Uv,128,0);ra(2033235475,se.a.Uv,128,0);ra(-96230454,se.a.Uv,128,0);ra(74086617,se.a.Uv,128,0);ra(563292088,se.a.Uv,128,0);ra(-1092351914,se.a.Uv,128,0);ra(-2141589616,se.a.Uv|16384,128,0);ra(745182485,se.a.Uv,
0,0);ra(359279088,se.a.Uv,128,0);ra(-67292059,se.a.Uv,128,0);ra(926905850,se.a.Uv,128,0);ra(547535945,se.a.Uv,128,0);ra(1374696078,se.a.wc|24576,0,0);ra(495005930,se.a.wc|212992,0,0);ra(-1045020714,se.a.wc|24576,0,0);ra(-170383950,se.a.wc|212992,0,0);ra(324156914,se.a.Ha,0,0);ra(-1085236154,se.a.Nu,0,0);ra(-751848458,se.a.ql|16384,0,0);ra(216058793,se.a.Nu,0,0);ra(474690375,se.a.ql|16384,0,0);ra(-1920954846,se.a.wc|24576,0,0);ra(723126814,se.a.wc|131072,0,0);ra(2108047455,128,128,0);ra(-231711729,
128,128,0);ra(-1909381757,128,128,0);ra(-814639094,128,128,0);ra(1701016594,se.a.wc|3072,128,0);ra(-1475408662,se.a.wc|24576,0,0);ra(1114549926,se.a.wc|131072,32,0)}static ka(ra){b.a.Nd(10,new Wa(ra))}}Object(c.a)(Wa,"ContextMenuCommandHandlerFactory",b.a,[]);var Sb=a(221),wc=a(1390),Uc=a(91),ob=a(212);class Zb{constructor(ra,hb){this.iqb=hb;this.$=ra}dispose(){}s$(){this.iqb.P2()}MC(){this.iqb.MC()}WQd(ra,hb,Eb){Nd.h(this.$,Nd.b);this.iqb.showContextMenu(Object(f.a)(new wc.a,{x:hb.x,y:hb.y}),Eb,
ra);Uc.EventHandlerManager.instance.sad()}Bwc(ra,hb,Eb){Nd.h(this.$,Nd.b);this.iqb.showFloatie(Object(f.a)(new wc.a,{x:hb.x,y:hb.y}),ra,Eb);ob.a(()=>{Uc.EventHandlerManager.instance.sad()},this.$.la)}VQd(ra,hb,Eb,fc){Nd.h(this.$,Nd.b);this.iqb.VQd(Object(f.a)(new wc.a,{x:hb.x,y:hb.y}),ra,Eb,fc)}}Object(c.a)(Zb,"ReactContextMenuController",null,[397,2]);class Bc extends Sb.a{constructor(ra){super();this.r9e=!1;this.dkd=()=>{let hb;(hb=this.$.da.za(342))?this.qb(hb):this.$.Qx(Eb=>{Eb.qdc().then(fc=>
{(hb=this.$.da.za(342))?this.qb(hb):(hb=new Zb(this.$,fc),this.qb(this.$.da.Ga(342,hb)))})})};this.$=ra;this.Fb()}dispose(){this.r9e&&this.$&&this.$.ea.Wn(this.dkd);super.dispose()}create(){this.$.ea.Fg?(e.ULS.sendTraceTag(537167065,0,50,`ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = ${this.$.ea.Fg}`),this.dkd(null,null)):(this.r9e=!0,this.$.ea.El(this.dkd))}static ka(ra){ra.da.Ga(338,new Bc(ra))}}Object(c.a)(Bc,"ContextMenuControllerFactory",Sb.a,[]);var bd=
a(154);class Ed{constructor(){this.dictionary=this.Jd=null}}Object(c.a)(Ed,"RibbonCommandParams",null,[]);class ge{constructor(){this.menuModel=null;this.lEe=0}}Object(c.a)(ge,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);class be{constructor(){this.kcc={}}LIh(ra){return(ra=this.kcc[ra.toString()])?ra.menuModel:null}zSg(ra,hb){this.kcc[hb.toString()]=Object(f.a)(new ge,{menuModel:ra,lEe:Oa.HelperMethods.Tb()})}e6b(ra){this.kcc[ra.toString()]=null}lYh(ra){return(ra=this.kcc[ra.toString()])?ra.lEe:
-1}}Object(c.a)(be,"FilterMenuCache",null,[]);var qe=a(13),ze=a(188),Ce=a(222);class Ve{constructor(){this.Od=this.Tre=this.cell=null}}Object(c.a)(Ve,"AutoFilterEventRegistrationArgs",null,[]);class we{constructor(ra){this.hZa=null;this.mQd=!1;this.WAb=0;this.T7c=1;this.lLe=0;this.UDb=hb=>{this.OJf(hb.domElement,hb.hashCode)};this.DNf=hb=>{let Eb=0;for(;window.performance.now()-hb<this.Elh&&0<this.hZa.length;)this.Tke(this.hZa.shift()),Eb++;e.ULS.sendTraceTag(537167052,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: ${this.T7c}, Events Registered in this frame: ${Eb}, Events in queue: ${this.hZa.length}`);
0<this.hZa.length?this.WAb=window.requestAnimationFrame(this.DNf):(hb=window.performance.now()-this.lLe,e.ULS.sendTraceTag(537167051,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: ${this.T7c}, Total time in MS: ${hb}`),this.T7c++,this.WAb=0)};this.onPointerDown=hb=>{Td.a.slim(hb.Ca.rawEvent);return!1};this.$=ra;this.gridView=oa.g(this.$);this.q8h();this.Elh=this.$.ya.AutoFilterEventRegistrationTimeLimit}dispose(){window.cancelAnimationFrame(this.WAb);this.gridView&&
this.gridView.xrc(this.UDb);this.gridView=null}q8h(){if(this.mQd=Oa.HelperMethods.q6a)this.hZa=[];this.JBg();this.gridView.kYb(this.UDb)}JBg(){for(const ra of this.gridView.tn){const hb=ra.wBa;for(let Eb in hb){const fc=hb[Eb];this.OJf(fc.domElement,fc.hashCode)}}}OJf(ra,hb){if(oa.g(this.$).Ea.qm.c1a(hb))if(ra){ra=ra.querySelectorAll('[id^="'+r.a.f$c+'"]');for(let Mc=0;Mc<ra.length;Mc++){var Eb=ra[Mc],fc=Eb.getAttribute(r.a.dzh);const xd=Eb.getAttribute(r.a.Xyh);e.ULS.shipAssertTag(537167053,0,!!fc&&
!!xd,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: ${Eb.id}, BlockHash: ${hb}`);fc=id.Range.Uc(parseInt(fc,10),parseInt(xd,10));Eb=Object(f.a)(new Ve,{cell:fc,Tre:Eb,Od:hb});this.mQd?(this.hZa.push(Eb),this.WAb||(this.lLe=window.performance.now(),this.WAb=window.requestAnimationFrame(this.DNf))):this.Tke(Eb)}}else e.ULS.sendTraceTag(537167054,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: ${hb}`);
else e.ULS.sendTraceTag(537167055,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: ${hb}`)}Tke(ra){const hb=this.gridView.Ea.OJa(ra.cell,ra.Od);hb?this.IBg(ra.Tre,hb):e.ULS.sendTraceTag(537167050,1,10,`FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: ${ra.Od}, AutoFilter Cell: ${ra.cell}`)}IBg(ra,hb){hb.hasAutoFilter?this.Gzg(ra,
hb.ftb):hb.K3?this.GBg(ra,hb.ftb,hb.uod):e.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");bd.a.instance.ra(qe.a.Af,ra,this.onPointerDown);ze.a.instance.ra(qe.a.Ixa,ra,this.onPointerDown)}Gzg(ra,hb){Ce.a.instance.ra(qe.a.click,ra,Eb=>{hb&&Td.a.hrc(Eb.Ca.rawEvent,966232027,hb,null);return!0})}GBg(ra,hb,Eb){const fc=B.a.Vh(hb);Ce.a.instance.ra(qe.a.click,ra,Mc=>{Eb?Td.a.spf(document.getElementById(fc.EwaElementId),
fc.Cell,fc.DataSourceIndex,fc.FieldId,fc.IsOlap,fc.RequiresConfirmation,Mc.Ca.rawEvent,fc.OptionalPivotMenuAnchor):Td.a.spfm(Mc.Ca.rawEvent,fc.RequiresConfirmation,fc.Cell,fc.DataSourceIndex,fc.PivotName,fc.OptionalPivotMenuAnchor);return!1})}}Object(c.a)(we,"FilterMenuPointerEventsManager",null,[2]);class vc{constructor(ra){this.uRe=null;this.$=ra;this.n8a=new be;da.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||
(this.uRe=new we(this.$))}dispose(){da.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.uRe.dispose();this.$=null}TOh(ra){const hb=oa.g(this.$).Ea.z9(ra,this.$.activeItemName);return hb&&hb.blockPresentInViewportTimeStamp>this.n8a.lYh(ra.left)?hb.Tr(ra).autoFilterMenu:this.n8a.LIh(ra.left)}QLi(ra,hb,Eb){this.n8a&&this.n8a.zSg(ra.menuModel[hb],Eb)}RLi(ra){this.n8a&&this.n8a.e6b(ra)}}Object(c.a)(vc,"FilterMenuManager",
null,[395,2]);var ed=a(204),Id=a(167);class Ld{constructor(ra,hb,Eb){this.$wc={};this.zd=!1;this.Ql=(fc,Mc=null)=>{this.showContextMenu(Mc)};this.fvf=(fc,Mc)=>{Mc.lzi===Ld.d0h&&oa.g(this.$).focus()};this.YQ=(fc,Mc)=>{fc=this.$.Ka.eaa(Mc.Jd.command);(null===fc||void 0===fc?0:fc.dismissesContextualUI)&&this.P2()};this.XQ=()=>{this.$.da.XT(342);J.TaskExtensions.Aa(S.GetServiceTaskFactory.create(this.$.da,338,this.$.la,3),fc=>{fc=fc.result;for(let Mc of this.$wc)Mc.nNf(fc)},this.$.la)};this.$=ra;this.contextMenuController=
Eb;this.n5d=new vc(this.$);ra.da.Ga(8,this);for(Eb=0;Eb<hb.length;Eb++)this.$wc[Ld.J1g[Eb]]=hb[Eb];this.ha=oa.g(ra).ha;this.ha.dYb(this.Ql);this.$.Ka.fYa(this.fvf);bd.a.instance.Dsj();da.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka.fFa(this.YQ);da.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.GX(this.XQ)}get m8b(){return this.n5d}lcd(ra){return L.a.Dc(this.$wc,ra)}dispose(){this.zd?
e.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.zd=!0,this.$&&(this.$.Al(Ld.$c),this.$.da.XT(8),this.ha&&this.ha.orc(this.Ql),this.$.Ka.NHb(this.fvf),da.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka&&this.$.Ka.mza(this.YQ),da.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.z_(this.XQ)),this.$=this.ha=null,this.m8b.dispose(),
this.$wc=this.n5d=null)}showContextMenu(ra,hb=null,Eb=null){this.oxj(ra)&&(Nd.h(this.$,Nd.i),ra=this.S4g(ra,hb,Eb),this.$.Ka.Mb(ra.Jd,ra.dictionary))}P2(){this.contextMenuController?this.contextMenuController.s$():e.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")}oxj(ra){return Rb.a(this.$).Sp()?(e.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),
Rb.a(this.$).HV(Id.a.grid,ed.a.showContextMenu),!1):!this.$.Ka.Bwh&&(!ra||ra.Cb!==oa.g(this.$).domElement&&!Je.a.equals(ra.Cb.tagName,"INPUT",!0))}S4g(ra,hb=null,Eb=null){Eb={["eventArgs"]:ra,["creationParams"]:Eb};ra=ra?ra.tb:-1;const fc=this.ha.Pa.$b;let Mc=1441131127;fc?(hb=fc.floatingObject,e.ULS.shipAssertTag(537167059,0,!!hb,"floatingObj shouldn't be null."),Ld.Gpd(hb)?Mc=1312363469:Ld.isPivotChart(hb)?(Eb[nb.CZc]=hb?hb.Tc:null,Mc=-149612405):Mc=-1372040782):Ld.Lef(hb)?(Eb[nb.CZc]=hb,Mc=-149612405):
!Nd.g(this.$)&&Nd.f(oa.g(this.$))&&(Mc=671488277);hb=new T.a(Mc,ra,this.$.Mc,30,null);return Object(f.a)(new Ed,{Jd:hb,dictionary:Eb})}static ka(ra){ra.el(Ld.$c)}static isPivotChart(ra){return!!ra&&0===ra.type&&Ld.Lef(ra.Tc)}static Gpd(ra){return!!ra&&2===ra.type}static Lef(ra){return!!ra&&!!(ra.Attributes&4)}}Ld.J1g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
Ld.d0h="GridContextMenu";Ld.$c=ra=>{(ra=Object(Wb.a)(7,ra))&&S.GetServiceTaskFactory.create(ra.da,9,ra.la,0)};Object(c.a)(Ld,"ContextMenuManager",null,[381,2]);class ce extends Sb.a{constructor(ra){super();this.$=ra;this.Fb()}create(){const ra=this.$,hb=ra.jc;if(hb.allowSelection||hb.allowEdits||hb.allowFiltering||hb.allowSorting||hb.allowPivotSpecificOperations){const Eb=S.GetServiceTaskFactory.create(ra.da,10,ra.la,this.hb),fc=S.GetServiceTaskFactory.Ra(ra.da,342,338,this.hb);J.TaskExtensions.Aa(J.TaskExtensions.Wd([Eb,
fc],this.la),()=>{this.qb(u.a(ra)||new Ld(ra,Eb.result,fc.result))},this.$.la,3)}else e.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),ra.da.XT(8),this.qb(null)}static ka(ra){ra.da.Ga(9,new ce(ra))}}Object(c.a)(ce,"ContextMenuManagerFactory",Sb.a,[]);var la=a(10);a.d(C,"a",function(){return jb});const jb=()=>{Wa.initData();la.a.Fa(ra=>{Bc.ka(ra);ce.ka(ra);Wa.ka(ra);Ld.ka(ra)})}},1143:function(t,C,a){var c=
a(10);t=a(0);var b=a(691),d=a(15);const f=xa=>{switch(xa){case 0:xa="Between";break;case 1:xa="NotBetween";break;case 2:xa="Equal";break;case 3:xa="NotEqual";break;case 4:xa="GreaterThan";break;case 5:xa="LessThan";break;case 6:xa="GreaterThanOrEqual";break;case 7:xa="LessThanOrEqual";break;default:xa="Unknown"}return xa},e=xa=>{switch(xa){case 0:xa="AnyValue";break;case 1:xa="WholeNumber";break;case 2:xa="Decimal";break;case 3:xa="List";break;case 4:xa="Date";break;case 5:xa="Time";break;case 6:xa=
"TextLength";break;case 7:xa="Custom";break;default:xa="Unknown"}return xa};var k=a(131),l=a(43),m=a(368),v=a(170),n=a(247);class w{constructor(xa=null){this.h4=xa?xa.IsIgnoreBlank:!0;this.i4=xa?xa.IsInCellDropDown:!0;this.CN=xa?xa.LowerBoundary:"";this.DN=xa?xa.UpperBoundary:"";this.yB=xa?xa.ConditionType:0;this.ruleType=xa?xa.RuleType:0;this.jZ=xa?xa.IsAlertBlocking:!0;this.fT=xa?xa.AlertTitle:"";this.eT=xa?xa.AlertMessage:"";this.OU=xa?xa.InputMessage:"";this.mF=xa?xa.InputTitle:"";this.y4=xa?
xa.IsShowErrorAlert:!0;this.z4=xa?xa.IsShowInputMessage:!0}isEqual(xa){return xa?this.h4===xa.h4&&this.i4===xa.i4&&this.CN===xa.CN&&this.DN===xa.DN&&this.yB===xa.yB&&this.ruleType===xa.ruleType&&this.jZ===xa.jZ&&this.fT===xa.fT&&this.eT===xa.eT&&this.OU===xa.OU&&this.mF===xa.mF&&this.y4===xa.y4&&this.z4===xa.z4:(d.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)}}Object(t.a)(w,"DataValidationEditDialogState",null,[]);var r=a(281),u=a(182),y=a(280),
x=a(21),B=a(132),z=a(51),A=a(55);class I{constructor(xa,ia){this.KB=this.F0a=this.selectedRanges=null;this.CIe=!1;this.Yh=null;this.bKi=ya=>{d.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!ya||r.a(ya)?d.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):(this.F0a=ya.Result,this.d_i())};this.Iwh=ya=>{this.TV("DataValidationEdit.ExpandExisitngDialog",
ya);this.KB.c=I.Hha(ya);1===ya?this.cHa(new w(this.F0a)):2===ya?this.cHa(new w):this.dmf()};this.aVi=ya=>{this.TV("DataValidationEdit.OverrideExisitngDialog",ya);this.KB.c=I.Hha(ya);1===ya?this.cHa(new w):this.dmf()};this.$=xa;this.j4c=ia}Nc(){return!1}executeCommand(xa,ia){-1728432249!==ia.command&&u.a(ia.command);this.selectedRanges=l.r(x.g(this.$).ha.sa.selectedRanges,this.$);x.g(this.$).QRa(!0);this.getDataValidationInitialState();this.Yh=this.$.Ib.Bc("UserAction","DataValidationEditTimeToDialogOpen");
this.CIe?d.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(d.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.CIe=!0);return A.Task.Ta(!0)}Cc(xa,ia){return-1728432249===ia.command}Rc(){return!1}getDataValidationInitialState(){const xa=this.$.oa.va.Sb();m.a(this.$.userOperationManager,(ia,ya,ib)=>n.f(this.$.oa.va,this.selectedRanges,y.b(ia,this.bKi),y.a(ya),ib,xa),ia=>new v.a(120,0,ia,16),null)}d_i(){var xa=
this.KB={};let ia;switch(this.F0a.Command){case 0:ia="CreateNew";break;case 1:ia="CreateNewFromRule";break;case 2:ia="ExpandExisitng";break;case 3:ia="OverrideExisitng";break;default:ia="Unknown"}xa.a=ia;this.Yh&&(this.Yh.stop(),this.KB.r=this.Yh.id);switch(this.F0a.Command){case 0:this.KB.b=!1;this.KB.c="None";this.cHa(new w);break;case 1:this.KB.b=!1;this.KB.c="None";this.cHa(new w(this.F0a));break;case 2:this.KB.b=!0;this.j4c.Q3g(this.$,this.Iwh);break;case 3:this.KB.b=!0;this.j4c.S3g(this.$,this.aVi);
break;default:d.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}}cHa(xa){this.j4c.cHa(this.$,this.selectedRanges,xa,this.F0a.Command);this.Tvi(xa)}Tvi(xa){I.Drb(xa,this.KB);this.KB.d=!0;z.b().Le(48,this.KB,!0)}dmf(){this.KB.d=!1;z.b().Le(48,this.KB,!0)}TV(xa,ia){xa={["ButtonType"]:I.Hha(ia),["DialogName"]:xa,["Location"]:"dialog",["NumberOfSelectedRanges"]:x.g(this.$).ha.sa.EK};B.b(this.$).Cd(k.a.c5b,xa)}static Drb(xa,ia){ia.e=e(xa.ruleType);
ia.f=f(xa.yB);ia.g=!!xa.CN;ia.h=!!xa.DN;ia.i=xa.h4;ia.j=xa.i4;ia.k=xa.z4;ia.l=!!xa.mF;ia.m=!!xa.OU;ia.n=xa.y4;ia.o=xa.jZ;ia.p=!!xa.fT;ia.q=!!xa.eT}static Hha(xa){switch(xa){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return d.ULS.shipAssertTag(537163281,0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}}}Object(t.a)(I,"DataValidationEditCommandHandler",null,[195]);var F=a(133),U=a(794),X;(function(xa){xa[xa.between=0]="between";xa[xa.notBetween=
1]="notBetween";xa[xa.equal=2]="equal";xa[xa.notEqual=3]="notEqual";xa[xa.greaterThan=4]="greaterThan";xa[xa.lessThan=5]="lessThan";xa[xa.greaterThanOrEqual=6]="greaterThanOrEqual";xa[xa.lessThanOrEqual=7]="lessThanOrEqual"})(X||(X={}));Object(t.b)("DataValidationRuleConditionType",X);var S;(function(xa){xa[xa.anyValue=0]="anyValue";xa[xa.wholeNumber=1]="wholeNumber";xa[xa.decimal=2]="decimal";xa[xa.list=3]="list";xa[xa.date=4]="date";xa[xa.time=5]="time";xa[xa.textLength=6]="textLength";xa[xa.custom=
7]="custom"})(S||(S={}));Object(t.b)("DataValidationRuleType",S);var H=a(144),D=a(183);class J{static get ag(){return H.a.ap(J.Bk,"")}static get eeh(){return H.a.ap(J.ieh,D.a.ga(1671),D.a.ga(1686),D.a.ga(1687),D.a.ga(1688),D.a.ga(1689),D.a.ga(1690),D.a.ga(1691),D.a.ga(1692),D.a.ga(1693),D.a.ga(1672),D.a.ga(1696),D.a.ga(1697),D.a.ga(1698),D.a.ga(1699),D.a.ga(1700),D.a.ga(1701),D.a.ga(1702),D.a.ga(1703),D.a.ga(1673),D.a.ga(1674),D.a.ga(1694),D.a.ga(1695),D.a.ga(1685),"255")}static get leh(){return H.a.ap(J.jeh,
D.a.ga(1708),D.a.ga(1712),D.a.ga(1713),"255","32")}static get peh(){return H.a.ap(J.keh,D.a.ga(1707),D.a.ga(1710),D.a.ga(1709),D.a.ga(1711),D.a.ga(1712),D.a.ga(1713),"255","32")}}J.u8f=255;J.Bk="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";J.ieh="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
J.jeh="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
J.keh="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(t.a)(J,"DataValidationEditDialogHtml",null,[]);var M=a(85),G=a(552),T=a(13),K=a(185),L=a(235),V=a(12),W=a(14);class da extends L.a{constructor(xa,ia,ya){super(ia);this.vBd=this.Nnc=this.EOa=this.T9a=this.XMa=this.$4a=this.sya=this.rya=this.IK=this.gT=this.idc=this.Fva=null;this.DAh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];this.Pkj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,
1],[12,12]];this.lmc=ib=>{let wa=!1;(null===ib||void 0===ib?0:ib.Ca)&&(ib.Ca.keyCode===M.a.moa||ib.Ca.keyCode===M.a.$h)&&(wa=this.Zba(ib),this.gT.blur(),this.IK.blur());return wa};this.Zba=()=>{const ib=this.gT.selectedIndex,wa=this.IK.selectedIndex;this.Nnc.innerText=this.Kub(ib,wa);this.vBd.innerText=this.ffd(ib,wa);switch(ib){case 0:return this.IK.disabled=!0,V.DOMElementExtensions.setVisible(this.T9a,!1),V.DOMElementExtensions.setVisible(this.EOa,!1),V.DOMElementExtensions.setVisible(this.$4a,
!1),V.DOMElementExtensions.setVisible(this.XMa,!1),this.Fva.disabled=!0,!1;case 3:return this.IK.disabled=!0,V.DOMElementExtensions.setVisible(this.T9a,!0),V.DOMElementExtensions.setVisible(this.EOa,!1),V.DOMElementExtensions.setVisible(this.$4a,!0),V.DOMElementExtensions.setVisible(this.XMa,!0),this.Fva.disabled=!1;case 7:return this.IK.disabled=!0,V.DOMElementExtensions.setVisible(this.T9a,!0),V.DOMElementExtensions.setVisible(this.EOa,!1),V.DOMElementExtensions.setVisible(this.$4a,!1),V.DOMElementExtensions.setVisible(this.XMa,
!1),this.Fva.disabled=!1;default:this.Fva.disabled=!1,V.DOMElementExtensions.setVisible(this.T9a,!0),V.DOMElementExtensions.setVisible(this.XMa,!1)}switch(wa){case 0:case 1:V.DOMElementExtensions.setVisible(this.EOa,!0);break;default:V.DOMElementExtensions.setVisible(this.EOa,!1)}this.IK.disabled=!1;this.Nnc.disabled=!1;V.DOMElementExtensions.setVisible(this.$4a,!1);V.DOMElementExtensions.setVisible(this.XMa,!1);return!1};this.get_visible=this.pja;this.set_visible=this.$ma;this.HQ=new K.a;this.HQ.add(W.a.instance.ga(1673));
this.HQ.add(W.a.instance.ga(1674));this.HQ.add(W.a.instance.ga(1677));this.HQ.add(W.a.instance.ga(1675));this.HQ.add(W.a.instance.ga(1676));this.HQ.add(W.a.instance.ga(1678));this.HQ.add(W.a.instance.ga(1679));this.HQ.add(W.a.instance.ga(1680));this.HQ.add(W.a.instance.ga(1681));this.HQ.add(W.a.instance.ga(1682));this.HQ.add(W.a.instance.ga(1683));this.HQ.add(W.a.instance.ga(1684));this.HQ.add("");this.$=xa;this.Hk=ya;this.Jja()}get title(){return W.a.instance.ga(1704)}get d0g(){return this.gT.selectedIndex}Sza(xa){this.gT.selectedIndex=
xa.ruleType;this.IK.selectedIndex=xa.yB;this.idc.checked=xa.i4;this.Fva.checked=xa.h4;this.rya.value=xa.CN;this.sya.value=xa.DN;this.Zba(null)}Fob(xa){xa.h4=this.Fva.checked;xa.i4=this.idc.checked;xa.yB=this.IK.selectedIndex;xa.ruleType=this.gT.selectedIndex;xa.CN=this.rya.value;xa.DN=this.sya.value}dispose(){this.ek();this.Hk=this.vBd=this.Nnc=this.EOa=this.T9a=this.XMa=this.$4a=this.idc=this.sya=this.rya=this.IK=this.gT=this.Fva=null;super.dispose()}render(xa){xa.appendChild(this.domElement)}pja(){return this.isVisible}$ma(xa){return this.isVisible=
xa}setFocus(){}Kub(xa,ia){return this.u_e(xa,ia,this.DAh)}ffd(xa,ia){return 0!==ia&&1!==ia?"":this.u_e(xa,ia,this.Pkj)}Jja(){this.domElement.innerHTML=J.eeh;this.Fva=V.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.gT=V.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.IK=V.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.rya=V.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");
this.sya=V.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.Nnc=V.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId1");this.vBd=V.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.$4a=V.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.XMa=V.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.T9a=V.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");
this.EOa=V.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.idc=V.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownCheckboxId");this.Bj()}u_e(xa,ia,ya){return ya.length<xa||ya[xa].length<ia?(d.ULS.sendTraceTag(537163280,0,10,`DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption=${xa} operatorOption=${ia}, cannot get label.`),""):this.HQ.na(ya[xa][ia])}Bj(){G.a.instance.ra(T.a.Kb,this.gT,this.lmc);G.a.instance.ra(T.a.Kb,this.IK,
this.lmc);G.a.instance.ra(T.a.change,this.gT,this.Zba);G.a.instance.ra(T.a.change,this.IK,this.Zba);G.a.instance.ra(T.a.change,this.IK,this.Hk);G.a.instance.ra(T.a.change,this.gT,this.Hk);G.a.instance.ra(T.a.change,this.rya,this.Hk);G.a.instance.ra(T.a.Kb,this.rya,this.Hk);G.a.instance.ra(T.a.change,this.sya,this.Hk);G.a.instance.ra(T.a.Kb,this.sya,this.Hk)}ek(){G.a.instance.Ba(T.a.Kb,this.gT,this.lmc);G.a.instance.Ba(T.a.Kb,this.IK,this.lmc);G.a.instance.Ba(T.a.change,this.gT,this.Zba);G.a.instance.Ba(T.a.change,
this.IK,this.Zba);G.a.instance.Ba(T.a.change,this.IK,this.Hk);G.a.instance.Ba(T.a.change,this.gT,this.Hk);G.a.instance.Ba(T.a.change,this.rya,this.Hk);G.a.instance.Ba(T.a.Kb,this.rya,this.Hk);G.a.instance.Ba(T.a.change,this.sya,this.Hk);G.a.instance.Ba(T.a.Kb,this.sya,this.Hk)}static Oia(){let xa;return xa=new K.a,xa.add("operatorInputId1"),xa.add("operatorInputId2"),xa}}Object(t.a)(da,"DataValidationEditConditionsControl",L.a,[448,2,451]);var qa=a(61);const O=(xa,ia,ya,ib,wa,sa,Ya,bb=null)=>{bb=
xa.Na(9,bb);bb.selectedRanges=ia;bb.ruleOptions=ya;return qa.g(xa,"CreateOrEditDataValidation",bb,ib,wa,sa,Ya,0)};var ea=a(29),R=a(22),oa=a(200);class pa extends U.a{constructor(xa,ia,ya,ib){super(xa);this.fMd=this.ntb=null;this.vMa=this.disposed=this.Tja=!1;this.Yh=null;this.fVj=(wa,sa)=>{let Ya;this.t$b(wa);if(({errorString:wa,tq:Ya}=this.NYd()).returnValue)return this.gLa(121,this.oLh(this.$,sa),0,this.n4,!1),"";this.Gka("OkInvalidByClient",Ya);return wa};this.i4c=wa=>{this.TV(wa);this.Yh=this.$.Ib.Bc("UserAction",
"DataValidationEditTimeToDialogTryClose");0===wa&&this.lla()};this.selectedRanges=ia;this.UQb=ya;this.command=ib;3===ib&&(this.Tja=!0);this.Rb=2;this.Hv=!1}get rd(){return this.UQb}get oc(){return"DataValidationEditDialog"}FRd(){var xa={["RuleType"]:this.rd.ruleType,["RuleOperatorType"]:this.rd.yB,["OperatorInput1"]:this.rd.CN,["OperatorInput2"]:this.rd.DN,["IsIgnoreBlank"]:this.rd.h4,["IsInCellDropDown"]:this.rd.i4,["IsAlertBlocking"]:this.rd.jZ,["AlertTitle"]:this.rd.fT,["AlertMessage"]:this.rd.eT,
["InputTitle"]:this.rd.mF,["InputMessage"]:this.rd.OU,["IsShowErrorAlert"]:this.rd.y4,["IsShowInputMessage"]:this.rd.z4};this.rc(2,W.a.instance.ga(1670));xa={[pa.Tu]:this.oc,["validateDialogValues"]:this.fVj,["RangePickerController"]:x.g(this.$).Df.Aac(),["isModal"]:!1,["bodyProps"]:xa};this.initializeAndShow(W.a.instance.ga(1669),this.i4c,xa);d.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")}dispose(){this.disposed||(super.dispose(),this.disposed=!0)}get I0b(){return 3===
this.rd.ruleType}Oia(){return da.Oia()}oLh(xa,ia){return(ya,ib,wa)=>{const sa=xa.oa.va.Sb();return O(this.$.oa.va,this.selectedRanges,this.DQg(),this.f_a(ya,this.Pyd(ia)),y.a(ib),wa,sa)}}Pyd(xa){return ia=>{d.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");let ya;r.a(ia)?(d.ULS.sendTraceTag(537163276,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: ${ia?ea.a.yc(ia.Errors):null}.`),ia.Errors&&1===ia.Errors.length&&
((ya=this.xcd(ia.Errors[0].MessageId))?this.Gka("OkInvalidByServer",ia.Errors[0].MessageIdName):(this.Gka("OkValid","None"),this.hide()),xa(ya)),d.ULS.sendTraceTag(537163275,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${ea.a.yc(ia.Errors)}`)):this.hide()}}DQg(){const xa={};xa.Command=this.command;xa.RuleType=this.rd.ruleType;xa.ConditionType=this.rd.yB;xa.IsIgnoreBlank=this.rd.h4;xa.IsInCellDropDown=this.rd.i4;xa.LowerBoundary=this.rd.CN;xa.UpperBoundary=
this.rd.DN;xa.IsAlertBlocking=this.rd.jZ;xa.IsShowErrorAlert=this.rd.y4;xa.IsShowInputMessage=this.rd.z4;xa.AlertTitle=this.rd.fT;xa.AlertMessage=this.rd.eT;xa.InputTitle=this.rd.mF;xa.InputMessage=this.rd.OU;xa.ShouldIgnoreFormulaError=this.vMa;return xa}xcd(xa){switch(xa){case 1173235830:return W.a.instance.ga(1719);case 43935303:return W.a.instance.ga(1720);case -1323438439:return W.a.instance.ga(1722);case 2112020473:return W.a.instance.ga(1716);case -219503282:return W.a.instance.ga(1717);case 1689335445:return W.a.instance.ga(1718);
case 2146493810:return W.a.instance.ga(1721);case -2104909922:return String.format(W.a.instance.ob(105),this.ntb,this.fMd);case -869372599:return String.format(W.a.instance.ob(104),this.ntb);case -1181828368:return W.a.instance.ga(1724);case -758480861:return W.a.instance.ga(1725);case -13729088:return W.a.instance.ga(1726);case -846654055:return W.a.instance.ga(1727);case 751854001:return W.a.instance.ga(1728);case -453846397:return W.a.instance.ga(1729);case 1102013489:return W.a.instance.ga(1730);
case 835813260:return W.a.instance.ga(1731);case 1577787509:return W.a.instance.ga(1732);case 2083564019:return W.a.instance.ga(1723);default:d.ULS.sendTraceTag(537163274,0,15,`DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: ${xa.toString()}.`)}return null}lla(){this.Gka("Cancel","None")}TV(xa){d.ULS.sendTraceTag(537163273,0,50,`DataValidationEditDialog ${1===xa?"Ok":"Cancel"} was clicked.`);xa={["ButtonType"]:pa.Hha(xa),["DialogName"]:this.oc,["Location"]:"dialog",
["NumberOfSelectedRanges"]:x.g(this.$).ha.sa.EK};B.b(this.$).Cd(k.a.c5b,xa)}Gka(xa,ia){const ya={};pa.Drb(this.rd,ya);ya.o=xa;ya.p=ia;ya.n=this.Tja;this.Yh&&(this.Yh.stop(),ya.q=this.Yh.id);z.b().Le(49,ya,!0)}t$b(xa){this.rd.ruleType=xa.RuleType;this.rd.yB=xa.RuleOperatorType;this.rd.CN=xa.OperatorInput1;this.rd.DN=xa.OperatorInput2;this.rd.jZ=xa.IsAlertBlocking;this.rd.y4=xa.IsShowErrorAlert;this.rd.fT=xa.AlertTitle;this.rd.eT=xa.AlertMessage;this.rd.z4=xa.IsShowInputMessage;this.rd.mF=xa.InputTitle;
this.rd.OU=xa.InputMessage;this.rd.h4=xa.IsIgnoreBlank;this.rd.i4=xa.IsInCellDropDown;this.ntb=xa.firstOperatorLabel;this.fMd=xa.secondOperatorLabel}qOb(xa,ia,ya){let ib,wa;wa=ib=null;if(!xa)return ya?(ib=String.format(W.a.instance.ob(105),this.ntb,this.fMd),wa="DataValidationEditNoMinMaxError"):(ib=String.format(W.a.instance.ob(104),this.ntb),wa="DataValidationEditNoValueError"),{returnValue:!1,errorString:ib,tq:wa};if(xa.length>J.u8f)return ib=W.a.instance.ga(1723),{returnValue:!1,errorString:ib,
tq:wa};if(oa.d(xa))return{returnValue:!0,errorString:ib,tq:wa};if(1===ia||2===ia||6===ia){if(!R.a.q4(xa))return ib=W.a.instance.ga(1716),{returnValue:!1,errorString:ib,tq:wa};if(1===ia&&!R.a.isInteger(xa))return ib=W.a.instance.ga(1717),{returnValue:!1,errorString:ib,tq:wa};if(6===ia){if(!R.a.isInteger(xa))return ib=W.a.instance.ga(1717),{returnValue:!1,errorString:ib,tq:wa};if(0>parseInt(xa,10))return ib=W.a.instance.ga(1718),{returnValue:!1,errorString:ib,tq:wa}}}return{returnValue:!0,errorString:ib,
tq:wa}}NYd(){let xa,ia;ia=xa=null;const ya=this.rd.CN,ib=this.rd.DN,wa=S[this.rd.ruleType];var sa=X[this.rd.yB];if(0===wa)return{returnValue:!0,errorString:xa,tq:ia};sa=(0===sa||1===sa)&&3!==wa&&7!==wa;return!({errorString:xa,tq:ia}=this.qOb(ya,wa,sa)).returnValue||sa&&!({errorString:xa,tq:ia}=this.qOb(ib,wa,sa)).returnValue?{returnValue:!1,errorString:xa,tq:ia}:sa&&(1===wa||2===wa||6===wa)&&!oa.d(ya)&&!oa.d(ib)&&parseFloat(ya)>parseFloat(ib)?(xa=W.a.instance.ga(1721),{returnValue:!1,errorString:xa,
tq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:xa,tq:ia}}static Hha(xa){switch(xa){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return d.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static Drb(xa,ia){ia.a=e(xa.ruleType);ia.b=f(xa.yB);ia.c=!!xa.CN;ia.d=!!xa.DN;ia.e=xa.h4;ia.f=xa.i4;ia.g=xa.z4;ia.h=!!xa.mF;ia.i=!!xa.OU;ia.j=xa.y4;ia.k=xa.jZ;ia.l=!!xa.fT;ia.m=!!xa.eT}}Object(t.a)(pa,
"DataValidationEditDialog",U.a,[]);var Pa=a(86);U=a(260);class Z{}Z.Tah="DataValidationDialogPanel";Z.Sah="DataValidationButtonPanel";Z.Rah="DataValidationButtonClearAll";Object(t.a)(Z,"CssClassNames",null,[]);class Ra extends L.a{constructor(xa,ia){super(xa);this.Haa=this.Iaa=this.Gaa=null;this.nmc=()=>{this.Gaa.checked?(this.Iaa.disabled=!1,this.Haa.disabled=!1):(this.Iaa.disabled=!0,this.Haa.disabled=!0);return!1};this.get_visible=this.pja;this.set_visible=this.$ma;this.Hk=ia;this.Jja()}get title(){return W.a.instance.ga(1706)}render(xa){xa.appendChild(this.domElement)}pja(){return this.isVisible}$ma(xa){return this.isVisible=
xa}setFocus(){}dispose(){this.ek();this.Hk=this.Iaa=this.Haa=this.Gaa=null;super.dispose()}Jja(){this.domElement.innerHTML=J.leh;this.Gaa=V.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");V.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.Iaa=V.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.Haa=V.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.Gaa.checked=!0;this.Bj();this.nmc(null)}Sza(xa){this.Iaa.value=
void 0===xa.mF||null===xa.mF?"":xa.mF;this.Haa.value=void 0===xa.OU||null===xa.OU?"":xa.OU;this.Gaa.checked=xa.z4;this.nmc(null)}Fob(xa){xa.mF=this.Iaa.value;xa.OU=this.Haa.value;xa.z4=this.Gaa.checked}Bj(){G.a.instance.ra(T.a.change,this.Gaa,this.nmc);G.a.instance.ra(T.a.change,this.Gaa,this.Hk);G.a.instance.ra(T.a.change,this.Iaa,this.Hk);G.a.instance.ra(T.a.Kb,this.Iaa,this.Hk);G.a.instance.ra(T.a.change,this.Haa,this.Hk);G.a.instance.ra(T.a.Kb,this.Haa,this.Hk)}ek(){G.a.instance.Ba(T.a.change,
this.Gaa,this.nmc);G.a.instance.Ba(T.a.change,this.Gaa,this.Hk);G.a.instance.Ba(T.a.change,this.Iaa,this.Hk);G.a.instance.Ba(T.a.Kb,this.Iaa,this.Hk);G.a.instance.Ba(T.a.change,this.Haa,this.Hk);G.a.instance.Ba(T.a.Kb,this.Haa,this.Hk)}}Object(t.a)(Ra,"DataValidationEditInputControl",L.a,[448,2,450]);class Ga extends L.a{constructor(xa,ia){super(xa);this.g9=this.h9=this.JTa=this.Fga=this.f9=null;this.mmc=()=>{this.f9.checked?(this.Fga.disabled=!1,this.JTa.disabled=!1,this.h9.disabled=!1,this.g9.disabled=
!1):(this.Fga.disabled=!0,this.JTa.disabled=!0,this.h9.disabled=!0,this.g9.disabled=!0);return!1};this.get_visible=this.pja;this.set_visible=this.$ma;this.Hk=ia;this.Jja()}get title(){return W.a.instance.ga(1705)}render(xa){xa.appendChild(this.domElement)}pja(){return this.isVisible}$ma(xa){return this.isVisible=xa}setFocus(){}dispose(){this.ek();this.Hk=this.h9=this.g9=this.JTa=this.Fga=this.f9=null;super.dispose()}Jja(){this.domElement.innerHTML=J.peh;this.f9=V.DOMElementExtensions.getElementById(this.domElement,
"showAlertCheckBoxId");this.Fga=V.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.JTa=V.DOMElementExtensions.getElementById(this.domElement,"warningId");this.h9=V.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.g9=V.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.f9.checked=!0;this.Fga.checked=!0;this.Bj();this.mmc(null)}Sza(xa){this.Fga.checked=xa.jZ;this.JTa.checked=!xa.jZ;this.h9.value=void 0===xa.fT||null===
xa.fT?"":xa.fT;this.g9.value=void 0===xa.eT||null===xa.eT?"":xa.eT;this.f9.checked=xa.y4;this.mmc(null)}Fob(xa){xa.fT=this.h9.value;xa.eT=this.g9.value;xa.jZ=this.Fga.checked;xa.y4=this.f9.checked}Bj(){G.a.instance.ra(T.a.change,this.f9,this.mmc);G.a.instance.ra(T.a.change,this.f9,this.Hk);G.a.instance.ra(T.a.change,this.Fga,this.Hk);G.a.instance.ra(T.a.change,this.JTa,this.Hk);G.a.instance.ra(T.a.change,this.h9,this.Hk);G.a.instance.ra(T.a.Kb,this.h9,this.Hk);G.a.instance.ra(T.a.change,this.g9,this.Hk);
G.a.instance.ra(T.a.Kb,this.g9,this.Hk)}ek(){G.a.instance.Ba(T.a.change,this.f9,this.mmc);G.a.instance.Ba(T.a.change,this.f9,this.Hk);G.a.instance.ra(T.a.change,this.Fga,this.Hk);G.a.instance.ra(T.a.change,this.JTa,this.Hk);G.a.instance.Ba(T.a.change,this.h9,this.Hk);G.a.instance.Ba(T.a.Kb,this.h9,this.Hk);G.a.instance.Ba(T.a.change,this.g9,this.Hk);G.a.instance.Ba(T.a.Kb,this.g9,this.Hk)}}Object(t.a)(Ga,"DataValidationEditMessagesControl",L.a,[448,2,449]);class Ba{constructor(xa,ia){this.options=
this.cellRange=null;this.cellRange=xa;this.options=ia}}Object(t.a)(Ba,"MacroRecorderRangeDataValidationChangedPayload",null,[101]);var fa=a(1230);class Y extends U.a{constructor(xa,ia,ya,ib){super(xa);this.u2=this.Hdc=this.akc=this.DCb=null;this.vMa=this.disposed=this.Tja=!1;this.Yh=null;this.Pyd=wa=>{d.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");if(this.disposed)d.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");
else{if(r.a(wa)){d.ULS.sendTraceTag(537163267,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: ${wa?ea.a.yc(wa.Errors):null}.`);if(wa.Errors&&1===wa.Errors.length){const sa=wa.Errors[0].MessageId,Ya=this.xcd(sa);if(Ya){this.Zxj(sa)?this.ltj(Ya):this.vr(Ya);this.Gka("OkInvalidByServer",wa.Errors[0].MessageIdName);return}}d.ULS.sendTraceTag(537163266,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${ea.a.yc(wa.Errors)}`)}this.Gka("OkValid",
"None");this.hide()}};this.i4c=wa=>{this.TV(wa);2!==wa&&(this.Yh=this.$.Ib.Bc("UserAction","DataValidationEditTimeToDialogTryClose"));1===wa?this.A9a():2===wa?this.Zxa():this.lla()};this.Zba=()=>{this.rQj();this.vMa?this.Wxe():this.Fxe();return this.Tja=!1};this.selectedRanges=ia;this.UQb=ya;this.command=ib;3===ib&&(this.Tja=!0);this.Rb=2;this.Hv=!1;this.ag=J.ag}get rd(){return this.UQb}get oc(){return"DataValidationEditDialog"}FRd(){const xa={["key"]:this.rd};this.initializeAndShow(W.a.instance.ga(1669),
this.i4c,xa);d.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")}dispose(){this.disposed||(this.Hdc=this.akc=this.u2=null,Pa.a.Ia(this.DCb),this.DCb=null,B.b(this.$)&&B.b(this.$).cTd("DataValidationDialogCorellation"),super.dispose(),this.disposed=!0)}get cy(){return()=>{this.TV(1);this.A9a()}}uv(xa){super.uv(xa);this.rc(2,W.a.instance.ga(1670));xa=this.zU(2);var ia=this.zU(1),ya=this.zU(0),ib=ia.parentNode;ib.appendChild(xa);ib.appendChild(ia);ib.appendChild(ya);
xa.parentNode.classList.add(Z.Sah);xa.classList.add(Z.Rah);xa=document.getElementById("dataValidationTabsId");ia=new da(this.$,document.createElement("div"),this.Zba);ya=new Ra(document.createElement("div"),this.Zba);ib=new Ga(document.createElement("div"),this.Zba);this.pai(ia,ya,ib);let wa;this.DCb=new fa.a(xa,(wa=new K.a,wa.add(ia),wa.add(ya),wa.add(ib),wa));this.DCb.yQf();this.lU=document.getElementById("validationErrorMessageId");this.Sza();B.b(this.$)&&B.b(this.$).MSd("DataValidationDialogCorellation")}BI(){super.BI();
document.getElementById(this.hi("WACDialogPanel")).classList.add(Z.Tah)}get UX(){return!1}get I0b(){return 3===this.u2.d0g}Oia(){return da.Oia()}Mcd(){return"validationErrorMessageId"}pai(xa,ia,ya){this.u2=xa;this.Hdc=ia;this.akc=ya}Vlj(){const xa={};xa.IsClearAll=this.Tja;xa.Command=this.command;xa.RuleType=this.rd.ruleType;xa.ConditionType=this.rd.yB;xa.IsIgnoreBlank=this.rd.h4;xa.IsInCellDropDown=this.rd.i4;xa.LowerBoundary=this.rd.CN;xa.UpperBoundary=this.rd.DN;xa.IsAlertBlocking=this.rd.jZ;xa.IsShowErrorAlert=
this.rd.y4;xa.IsShowInputMessage=this.rd.z4;xa.AlertTitle=this.rd.fT;xa.AlertMessage=this.rd.eT;xa.InputTitle=this.rd.mF;xa.InputMessage=this.rd.OU;xa.ShouldIgnoreFormulaError=this.vMa;const ia=this.$.oa.va.Sb(),ya=()=>new Ba(this.selectedRanges,xa);m.a(this.$.userOperationManager,(ib,wa,sa)=>O(this.$.oa.va,this.selectedRanges,xa,y.b(ib,this.Pyd),y.a(wa),sa,ia),ib=>new v.a(121,0,ib,void 0,ya),null)}Zxj(xa){return 1577787509===xa}ltj(xa){this.lU.innerText=xa;this.yI(this.zU(0));this.vMa=!0}Wxe(){this.vMa=
!1;this.lU.innerText=""}xcd(xa){switch(xa){case 1173235830:return W.a.instance.ga(1719);case 43935303:return W.a.instance.ga(1720);case -1323438439:return W.a.instance.ga(1722);case 2112020473:return W.a.instance.ga(1716);case -219503282:return W.a.instance.ga(1717);case 1689335445:return W.a.instance.ga(1718);case 2146493810:return W.a.instance.ga(1721);case -2104909922:return String.format(W.a.instance.ob(105),this.u2.Kub(this.rd.ruleType,this.rd.yB),this.u2.ffd(this.rd.ruleType,this.rd.yB));case -869372599:return String.format(W.a.instance.ob(104),
this.u2.Kub(this.rd.ruleType,this.rd.yB));case -1181828368:return W.a.instance.ga(1724);case -758480861:return W.a.instance.ga(1725);case -13729088:return W.a.instance.ga(1726);case -846654055:return W.a.instance.ga(1727);case 751854001:return W.a.instance.ga(1728);case -453846397:return W.a.instance.ga(1729);case 1102013489:return W.a.instance.ga(1730);case 835813260:return W.a.instance.ga(1731);case 1577787509:return W.a.instance.ga(1732);case 2083564019:return W.a.instance.ga(1723);default:d.ULS.sendTraceTag(537163265,
0,15,`DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: ${xa.toString()}.`)}return null}A9a(){d.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.t$b();let xa,ia;if(!({errorString:xa,tq:ia}=this.NYd()).returnValue)return this.vr(xa),this.Gka("OkInvalidByClient",ia),!1;this.Vlj();return!0}lla(){this.t$b();this.Gka("Cancel","None");this.hide()}Zxa(){d.ULS.sendTraceTag(537163235,0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");
this.vMa?this.Wxe():this.Fxe();this.ifj();this.Tja=!0}TV(xa){xa={["ButtonType"]:Y.Hha(xa),["DialogName"]:this.oc,["Location"]:"dialog",["NumberOfSelectedRanges"]:x.g(this.$).ha.sa.EK};B.b(this.$).Cd(k.a.c5b,xa)}ifj(){this.UQb=new w;this.Sza()}Sza(){this.akc.Sza(this.rd);this.Hdc.Sza(this.rd);this.u2.Sza(this.rd)}t$b(){this.u2.Fob(this.rd);this.akc.Fob(this.rd);this.Hdc.Fob(this.rd)}Gka(xa,ia){const ya={};Y.Drb(this.rd,ya);ya.o=xa;ya.p=ia;ya.n=this.Tja;this.Yh&&(this.Yh.stop(),ya.q=this.Yh.id);z.b().Le(49,
ya,!0)}qOb(xa,ia){let ya,ib;ib=ya=null;if(!xa)return ia?(ya=String.format(W.a.instance.ob(105),this.u2.Kub(this.rd.ruleType,this.rd.yB),this.u2.ffd(this.rd.ruleType,this.rd.yB)),ib="DataValidationEditNoMinMaxError"):(ya=String.format(W.a.instance.ob(104),this.u2.Kub(this.rd.ruleType,this.rd.yB)),ib="DataValidationEditNoValueError"),{returnValue:!1,errorString:ya,tq:ib};if(xa.length>J.u8f)return ya=W.a.instance.ga(1723),{returnValue:!1,errorString:ya,tq:ib};if(oa.d(xa))return{returnValue:!0,errorString:ya,
tq:ib};if(1===this.rd.ruleType||2===this.rd.ruleType||6===this.rd.ruleType){if(!R.a.q4(xa))return ya=W.a.instance.ga(1716),{returnValue:!1,errorString:ya,tq:ib};if(1===this.rd.ruleType&&!R.a.isInteger(xa))return ya=W.a.instance.ga(1717),{returnValue:!1,errorString:ya,tq:ib};if(6===this.rd.ruleType){if(!R.a.isInteger(xa))return ya=W.a.instance.ga(1717),{returnValue:!1,errorString:ya,tq:ib};if(0>parseInt(xa,10))return ya=W.a.instance.ga(1718),{returnValue:!1,errorString:ya,tq:ib}}}return{returnValue:!0,
errorString:ya,tq:ib}}NYd(){let xa,ia;ia=xa=null;if(this.Tja||0===this.rd.ruleType)return{returnValue:!0,errorString:xa,tq:ia};const ya=(0===this.rd.yB||1===this.rd.yB)&&3!==this.rd.ruleType&&7!==this.rd.ruleType;return!({errorString:xa,tq:ia}=this.qOb(this.rd.CN,ya)).returnValue||ya&&!({errorString:xa,tq:ia}=this.qOb(this.rd.DN,ya)).returnValue?{returnValue:!1,errorString:xa,tq:ia}:ya&&(1===this.rd.ruleType||2===this.rd.ruleType||6===this.rd.ruleType)&&!oa.d(this.rd.CN)&&!oa.d(this.rd.DN)&&parseFloat(this.rd.CN)>
parseFloat(this.rd.DN)?(xa=W.a.instance.ga(1721),{returnValue:!1,errorString:xa,tq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:xa,tq:ia}}set cy(xa){super.cy=xa}static Hha(xa){switch(xa){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return d.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static Drb(xa,ia){ia.a=e(xa.ruleType);ia.b=f(xa.yB);ia.c=!!xa.CN;ia.d=!!xa.DN;ia.e=
xa.h4;ia.f=xa.i4;ia.g=xa.z4;ia.h=!!xa.mF;ia.i=!!xa.OU;ia.j=xa.y4;ia.k=xa.jZ;ia.l=!!xa.fT;ia.m=!!xa.eT}}Object(t.a)(Y,"DataValidationEditDialogDeprecated",U.a,[]);var ja=a(1);class ca{cHa(xa,ia,ya,ib){ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?(new pa(xa,ia,ya,ib)).FRd():(new Y(xa,ia,ya,ib)).FRd()}Q3g(xa,ia){const ya=new F.StandardDialog;ya.Rb=3;ya.jAa(xa.rb.Mia,W.a.instance.ga(1714),ia)}S3g(xa,ia){const ya=new F.StandardDialog;ya.Rb=1;ya.oW(xa.rb.Mia,
W.a.instance.ga(1715),ia)}}Object(t.a)(ca,"DataValidationEditDialogFactory",null,[399]);class aa extends b.a{constructor(xa){super(xa)}yd(){this.gd([new I(this.$,new ca)])}static ka(xa){b.a.Nd(245,new aa(xa))}}Object(t.a)(aa,"DataValidationEditCommandHandlerFactory",b.a,[]);a.d(C,"a",function(){return ta});const ta=()=>{c.a.Fa(aa.ka)}},1148:function(t,C,a){function c(na,Na,Va,Sa,vb,Oa){if(0===Sa)return Object(fa.a)(ma.UnsupportedZeroResize);if(0>Sa||0===Va.length)return Object(fa.a)(ma.InvalidInput);
if(na.u4h())return Object(fa.a)(ma.UnsupportedSkeletonInView);const yb=na.Yd;if(!yb)return Object(fa.a)(ma.NullSPD);var Ob=yb.FYe(Va);if(Ob&&0<Ob.length)return Object(fa.a)(Ob.length.toString()+" "+ma.UnsupportedHiddenInRange);a:{for(const lb of Va)vb?lb.right=O.a.mh:lb.bottom=O.a.dh;Ob=na.i$("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",Va);try{for(Ob.$$rst();Ob.$$mn();)if(Ob.Hn.dDj){var Ja=!0;break a}}finally{Ob&&Ob.dispose()}Ja=!1}if(Ja)return Object(fa.a)(ma.UnsupportedMergeCell);if(X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",
!1)&&!vb&&"undefined"!==typeof gridRenderer)for(const lb of Va)gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(lb.left);na=na.Ea;Ja=ua.a.create().toString();yb.odg(Va,Sa,vb);Oa=na.aQj(vb,Oa);Na.m6i(Va,vb);na.l2i(Oa,Ja,vb?"row":"column");return Object(fa.d)(Sa)}var b=a(10);t=a(0);var d=a(221),f=a(7),e=a(15),k=a(86);a(262);var l=a(185),m=a(412),v=a(84),n=a(769),w=a(184),r=a(265),u=a(24),y=a(869),x=a(43);class B{}B.JDh="GalleryGeneral";B.LDh="GalleryNumber";B.HDh="GalleryCurrency";B.FDh="GalleryAccounting";
B.ODh="GalleryShortDate";B.KDh="GalleryLongDate";B.QDh="GalleryTime";B.MDh="GalleryPercentage";B.IDh="GalleryFraction";B.NDh="GalleryScientific";B.PDh="GalleryText";B.QRg="ButtonComma";B.buttonPercentage="ButtonPercentage";B.keyboardNumber="KeyboardNumber";B.keyboardCurrency="KeyboardCurrency";B.keyboardDate="KeyboardDate";B.keyboardTime="KeyboardTime";B.keyboardPercentage="KeyboardPercentage";Object(t.a)(B,"RibbonFormatKind",null,[]);var z=a(61),A=a(292),I=a(616),F=a(615),U=a(614),X=a(1);class S extends A.a{constructor(na,
Na,Va,Sa,vb,Oa,yb,Ob,Ja,lb,Pb,Jb=null,Lb=null){super(11,0,Ob,Pb);this.gCh=na;this.xad=Na;this.format=Sa;this.activeCell=Va;this.mqe=vb;this.lGf=Oa;this.gGf=yb;this.HEa=Ja;this.clientCorrelationId=lb;this.flb=Jb;this.zhb=Lb}get KF(){return X.EwaSettings.dc()?super.KF:0}get wt(){return this.flb}get N$(){return this.zhb}get mBc(){return this.HEa}a2(na){return super.a2(na)||this.gCh.a2(this.xad,this.activeCell,this.format,this.mqe,this.lGf,this.gGf,this.aZb,this.HEa,this.clientCorrelationId,this.flb,
this.zhb)}jj(){const na=[];if(this.Abc)for(const Na of this.Abc)na.push(U.a(Na));else na.push(new F.a(this.format,this.xad,this.activeCell));return()=>new I.a(na)}Zdb(){const na={OperationType:0};na.FormatCellsMultiRange=this.xad;na.ActiveCell=this.activeCell;na.Format=this.format;na.ApplyFormatOnPivotTableValueField=this.mqe;na.PivotTableXluid=this.lGf;na.PivotTableFieldCaption=this.gGf;return na}}Object(t.a)(S,"FormatCellsBatchOperation",A.a,[]);var H=a(33),D=a(208);class J{}J.editCell="Edited";
J.dependentCell="Dependents";Object(t.a)(J,"RecalcPriorityGroupType",null,[]);var M=a(197);const G=na=>{switch(na.alignment){case "Center":return 2;case "Left":return 1;case "Right":return 3;default:return e.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}},T=na=>{if(na=na.color){if("String"===Object.getType(na).getName())return M.a.cp(na);if("Number"===Object.getType(na).getName())return null}else return null;e.ULS.sendTraceTag(537162193,
0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null},K=(na,Na)=>{na=excelOnlineCalc.calc.getCellValueKind(na.rangeDelta.data.value);switch(na){case "number":case "string":case "boolean":return!0;case "Blank":return!0;case "Error":if(X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcErrorValueTypeSupported",!1))return!0;Na.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return Na.numberOfUnsupportedRichCellTypes++,!1;default:return e.ULS.shipAssertTag(537162192,
0,!1,`CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type ${na}`),!1}},L=na=>{na=excelOnlineCalc.calc.getCellValueKind(na.rangeDelta.data.value);let Na=0;switch(na){case "number":Na=1;break;case "string":Na=2;break;case "boolean":Na=3;break;case "Error":Na=4;break;case "Blank":Na=0;break;default:e.ULS.shipAssertTag(537162191,0,!1,`CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type ${na}`)}return Na},V=na=>{const Na=na.value;switch(na.type){case 2:return void 0===
Na||null===Na?"":Na;case 1:return na=parseFloat(Na),isNaN(na)?null:na;case 3:return na=parseFloat(Na),isNaN(na)?null:1===na;case 4:return na=parseFloat(Na),isNaN(na)?null:excelOnlineCalc.calc.errorValue(na);default:return excelOnlineCalc.calc.blankValue}},W=(na,Na)=>{const Va=da(Na);var Sa=!(void 0===Na.rangeDelta.data.format||null===Na.rangeDelta.data.format);e.ULS.shipAssertTag(537162187,0,0===Va||!Sa,`CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only ${Na.priorityGroup}`);
na=Math.max(na.cell.Gk,0);Sa&&(Sa=excelOnlineCalc.calc.getCellFormatKind(Na.rangeDelta.data.format.format),"number"===Sa?na=Na.rangeDelta.data.format.format:"string"===Sa?e.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===Sa?e.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):e.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));
return na},da=na=>{if(na.priorityGroup===J.editCell)return 0;if(na.priorityGroup===J.dependentCell)return 1;e.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2},qa=na=>{na=da(na);if(0===na)return 1;if(1===na)return 2;e.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0};var O=a(8);class ea{constructor(na=0,Na="",Va=0,Sa="",vb=""){this.wJ=na;this.cellValue=Na;this.ifmt=
Va;this.priorityGroup=Sa;this.Nx=vb}}Object(t.a)(ea,"RecalcAccuracyObject",null,[]);class R{}R.string="String";R.blank="Blank";R.general="General";R.SAh="Flexible";Object(t.a)(R,"FormattedUnitKind",null,[]);class oa{constructor(na=0,Na=0,Va=0,Sa=0,vb=0,Oa=0,yb=0,Ob=0,Ja=0,lb=0,Pb=0,Jb=0,Lb=0,Ab=0,nb=0,va=!1,db="",Xa=0,gb=null,Ha=null,tb=null,bc=null,tc=null,Ma=null,Tb=null){this.numberOfDependentRecalcedCellsInBatch=this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=
this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=
this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=na;this.numberOfNonUpdatedCells=Na;this.numberOfUpdatedCells=Va;this.numberOfCellsUpdatedAlreadyByServer=Sa;this.numberOfCellsSkippedDueToTimeout=vb;this.numberOfCellsWithNoFormattedCell=Oa;this.numberOfUnsupportedErrorCellTypes=yb;this.numberOfUnsupportedBlankCellTypes=
Ob;this.numberOfUnsupportedRichCellTypes=Ja;this.numberOfSkippedCellsDueToMissingLocaleInfo=lb;this.totalExecutionTime=Pb;this.originalProcessingTimeLimit=Jb;this.newProcessingTimeLimit=Lb;this.numberOfEditedRecalcedCellsInBatch=Ab;this.numberOfDependentRecalcedCellsInBatch=nb;this.isNewTask=va;this.lastSetCellInstantaneousOperation=db;this.taskId=Xa;this.isNewNumberFormatter=gb;this.numberOfRecalcedCellsWithFormattedValue=Ha;this.numberOfRecalcedCellsWithoutFormattedValue=tb;this.totalNumberFormatterTime=
bc;this.newNumberFormatterFinalizeFailures=tc;this.numberOfMeasureTextWidthCalls=Ma;this.numberOfHashFormattedValues=Tb}}Object(t.a)(oa,"RecalcResultProcessingStatistics",null,[]);class pa{constructor(na,Na,Va,Sa){this.rangeDelta=na;this.stateId=Na;this.isFinished=Va;this.priorityGroup=Sa}}Object(t.a)(pa,"RecalcedCellInfo",null,[]);var Pa=a(109),Z=a(11),Ra=a(22),Ga=a(55),Ba=a(64),fa=a(455);class Y{constructor(na,Na,Va){this.Bca=[];this.calcManager=this.cyc=this.lastSetCellInstantaneousOperation=null;
this.VIf=Sa=>{var vb;if(Sa&&Sa.rangeDeltas){var Oa=this.Bca.length;for(let yb=0;yb<Sa.rangeDeltas.length;yb++)(null===(vb=Sa.rangeDeltas[yb])||void 0===vb?0:vb.data)&&void 0!==Sa.rangeDeltas[yb].data.value&&null!==Sa.rangeDeltas[yb].data.value&&void 0!==Sa.rangeDeltas[yb].range&&null!==Sa.rangeDeltas[yb].range&&this.Bca.push(new pa(Sa.rangeDeltas[yb],Sa.stateId,Sa.isFinished,Sa.priorityGroup));e.ULS.sendTraceTag(574993422,0,50,`CalcResultProcessor.ProcessResults stateId=${Sa.stateId}, priorityGroup=${Sa.priorityGroup}, recalcFinished=${Sa.isFinished}, cellsFromCalc=${Sa.rangeDeltas.length}, initialCellsToRender=${Oa}, recalcedCells=${this.Bca.length}, lastSetCellInstantaneousOperation=${this.lastSetCellInstantaneousOperation}`);
!Oa&&this.Bca.length&&this.CAf(!1,0)}};this.$=na;this.grid=Na;this.ug=Va;this.xca=Y.BFe;this.$.da.Za(268,Sa=>{this.cyc=Sa});this.$.da.Za(266,Sa=>{this.calcManager=Sa});this.Rzb=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.Dqd=X.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.coi=X.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}dispose(){this.calcManager=
this.cyc=this.ug=this.grid=this.$=null}i$c(na,Na,Va,Sa,vb,Oa,yb){if(!Na)return Object(fa.a)("Null");var Ob=excelOnlineCalc.numfmt.renderCallback(Sa,lb=>gridRenderer.CanvasRendererGlobals.measureTextWidth(lb,vb,!0,X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1)),yb);let Ja=na.renderValue(Na,Ob);if(!excelOnlineCalc.util.isSuccess(Ja))return Object(fa.a)("Finalize");Sa=null;if(yb=excelOnlineCalc.numfmt.isHashesValue(Ja.value)){if(Ja=na.renderHashesValue(Ja.value,
Ob),!excelOnlineCalc.util.isSuccess(Ja))return Object(fa.a)("Hashes")}else Sa=Y.rCh(Na,Ja.value);Ob=Ja.value;na=excelOnlineCalc.numfmt.renderedValueToString(Ob);Na=G(Ob);Ob=T(Ob);return Object(fa.d)({text:na,valueType:Va,fontColor:Ob,Gk:Oa,ONa:Sa,horizontalAlignment:Na,isHashesValue:yb})}CAf(na,Na){this.$&&this.grid&&this.calcManager&&this.cyc&&this.calcManager.jD?(na&&(this.xca=this.cyc.u$e),this.D0i(this.grid,this.calcManager.jD,na,Na),!this.xca&&this.Bca.length?Ga.Task.delay(0).Uo(Va=>{this.CAf(!0,
Va.id);return!0},0,null,Ba.a.current):Ga.Task.Ta(!0)):(e.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),Ga.Task.Ta(!1))}D0i(na,Na,Va,Sa){const vb=Z.HelperMethods.Tb();for(Va=new oa(this.Bca.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.xca,void 0,void 0,void 0,Va,void 0,Sa,!0,0,0,0,0,0,0);0<this.Bca.length;){Sa=Z.HelperMethods.Tb()-vb;if(!this.xca||Sa>this.xca){Va.numberOfCellsSkippedDueToTimeout=
this.Bca.length;break}Sa=Array.dequeue(this.Bca);if(K(Sa,Va)){var Oa=u.Range.Uc(Sa.rangeDelta.range.row+1,Sa.rangeDelta.range.column+1);(Oa=na.Vb(Oa))?Y.ITg(Sa.stateId,Oa.cell)?(Y.Ukc(na,Oa,Sa,Va),this.kKg(Na,Oa,Sa,Va)):Va.numberOfCellsUpdatedAlreadyByServer++:Va.numberOfCellsWithNoFormattedCell++}}Sa=Math.round(Z.HelperMethods.Tb()-vb);this.CTj(Sa);this.hGj(Va,Sa);this.rej(Va)}kKg(na,Na,Va,Sa){var vb,Oa,yb,Ob,Ja=W(Na,Va);const lb=Va.rangeDelta.data.formatted,Pb=L(Va),Jb=da(Va);na=this.i$c(na,lb,
Pb,Na.cell.FAa,Na.cell.zha,Ja,!1);Ja=Na.cell.CCc;if(Object(fa.c)(na))if(this.Rzb&&this.Dqd){if(0===Jb||Na.text!==na.value.text)this.coi&&0===Jb&&this.kQd(Ja,na.value)&&(Na.cell.Bh=Ja),this.ug.MYa(Na,na.value),Va=qa(Va),this.ug.X6c(Na,this.lastSetCellInstantaneousOperation,2,Va,!0,!0),0===Jb&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")&&(this.calcManager?this.calcManager.Grf(Na.range):e.ULS.sendTraceTag(521171802,0,15,"CalcResultsProcessor.applyRecalcResultOnCell: Unable to call notifyEditedCellRecalcComplete as calcManager member is null.")),
Sa.numberOfUpdatedCells++}else Na.text!==na.value.text&&(this.ug.MYa(Na,na.value),Va=qa(Va),this.ug.X6c(Na,this.lastSetCellInstantaneousOperation,2,Va,!0,!0),Sa.numberOfUpdatedCells++);else switch(na.reason){case "Null":Sa.numberOfRecalcedCellsWithoutFormattedValue=(null!==(vb=Sa.numberOfRecalcedCellsWithoutFormattedValue)&&void 0!==vb?vb:0)+1;break;case "Hashes":Sa.numberOfHashFormattedValues=(null!==(Oa=Sa.numberOfHashFormattedValues)&&void 0!==Oa?Oa:0)+1;break;case "Finalize":Sa.newNumberFormatterFinalizeFailures=
(null!==(yb=Sa.newNumberFormatterFinalizeFailures)&&void 0!==yb?yb:0)+1}Object(fa.b)(na)&&"Null"!==na.reason&&(Sa.numberOfRecalcedCellsWithFormattedValue=(null!==(Ob=Sa.numberOfRecalcedCellsWithFormattedValue)&&void 0!==Ob?Ob:0)+1);Sa=0===Jb?Na.cell.userInput:Na.formulaBarText;Ob=Object(fa.c)(na)?na.value.text:"";Va=Object(fa.b)(na)?na.reason:"";e.ULS.sendTraceTag(537162180,0,50,`CalcResultProcessor.ApplyRecalcResultOnCell: (${Na.range.top}, ${Na.range.left}) 2nd pass formatting, success: ${na.success}, reason: ${Va}, priority: ${Jb}, ifmt: ${Na.cell.Gk}, input: '${Sa?
Ra.a.cM(Sa):"null"}', prediction: '${Ob?Ra.a.cM(Ob):"null"}',`)}CTj(na){this.xca=Math.max(this.xca-Math.max(na,1),0)}hGj(na,Na){na.numberOfNonUpdatedCells=this.Bca.length;na.totalExecutionTime=Na;na.newProcessingTimeLimit=this.xca;na.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation}rej(na){na=Sys.Serialization.JavaScriptSerializer.serialize(na);e.ULS.sendTraceTag(574993417,0,50,`CalcResultProcessor.ReportRecalcProcessingStatistics:${na}`)}static rCh(na,Na){na=na.units;var Va=
Na.units;if(na.length!==Va.length)return e.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;Na=[];let Sa=-1;for(let vb=0;vb<na.length;vb++)switch(na[vb].kind){case R.blank:Na.push(...Pa.h(" ",Va[vb].str.length));break;case R.string:Na.push(na[vb].str);break;case R.SAh:Na.push("");Sa=vb;break;case R.general:Na.push(Va[vb].str);break;default:e.ULS.sendTraceTag(537162178,
0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=Sa||""===Va[Sa].str)return null;Va={};Va.Start=Na.slice(0,Sa).join("");Va.Separator=na[Sa].str;Va.End=Na.slice(Sa+1,Na.length).join("");return Va}static cJh(na){return na&&na&&na.Sx?na.Sx.uJ:O.a.Ce}static ITg(na,Na){if(!Na)return!1;Na=Y.cJh(Na);return Na===O.a.Ce||Na===na}static Ukc(na,Na,Va,Sa){var vb=Va.rangeDelta.data.value.toString();const Oa=L(Va),yb=W(Na,Va);vb=new ea(Oa,vb,yb,Va.priorityGroup);Na.cell.Ukc(vb,
na.Ea.R4);1===da(Va)?Sa.numberOfDependentRecalcedCellsInBatch++:Sa.numberOfEditedRecalcedCellsInBatch++}kQd(na,Na){return null==na?!1:!!na.TextRuns&&!!na.Fonts&&na.Text===Na.text&&2===Na.valueType}}Y.BFe=20;Object(t.a)(Y,"CalcResultProcessor",null,[313,2]);class ja{constructor(na,Na=null,Va=""){this.success=na;this.Zkc=Na;this.reason=Va}}Object(t.a)(ja,"GetRibbonNumberFormatResult",null,[]);var ca=a(906);class aa{constructor(na,Na){this.nx=null;this.Ea=na;this.d2a=Na}lcb(na,Na,Va,Sa,vb=!1,Oa=!1){na&&
(na.V_(Na,Va,vb,Oa),na.verticalAlignment=Sa)}UJb(na,Na,Va){this.nx||(this.nx=new ca.a(this.Ea,this.d2a));this.nx.UJb(na,Na,Va)}}Object(t.a)(aa,"FormatCellsActionModelAccessor",null,[314]);var ta=a(209),xa=a(28),ia=a(29),ya=a(281),ib=a(250),wa=a(280),sa=a(75);class Ya{constructor(){this.Zeg=this.IWj=!1;this.source=0;this.Nva=this.rgc=!1}}Object(t.a)(Ya,"FormatCellInstantaneousResult",null,[]);class bb{constructor(na,Na){this.success=na;this.Nx=Na}}Object(t.a)(bb,"FormatStringResult",null,[]);var mb=
a(21),Ca=a(200),$a=a(1081),Kb=a(42),rb=a(517),cc=a(51),nc=a(199),Wb=a(261),Ea=a(79),ua=a(172),ma;(function(na){na.InvalidInput="invalid input";na.UnsupportedZeroResize="resizing to 0 - ignore";na.UnsupportedSkeletonInView="skeleton in view - ignore";na.NullSPD="ActiveSheetProcessedData is null";na.UnsupportedHiddenInRange="hiddens in resizeRanges";na.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(ma||(ma={}));Object(t.b)("InstantaneousRowColumnResizeFailureReason",ma);
var fb=a(175);class sb{constructor(na){this.nx=this.calcManager=this.mz=this.WRa=null;this.EJi=(Na,Va)=>{if(Na&&!ya.a(Na)&&Va){const Sa=!!Na&&!!Na.RequestTelemetryData;mb.g(this.$).Gi.Pka(Va.toString(),Na.StateId,Sa?Na.RequestTelemetryData.EcsOperationDuration:0,Sa?Na.RequestTelemetryData.EcsRequestDuration:0,Sa?Na.RequestTelemetryData.WfeRequestDuration:0)}};this.$=na;this.$.da.Za(268,Na=>{this.mz=Na});this.hCh=new aa(mb.g(this.$).Ea,this.$);this.Uga=new Y(this.$,mb.g(this.$),this);this.$.da.Za(266,
Na=>{this.calcManager=Na});this.xb=X.EwaSettings.xb();this.Im=X.EwaSettings.Im();this.Rzb=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.Dqd=X.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.mMa=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);this.doi=X.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}get jua(){return this.hCh}get jD(){return void 0===
this.calcManager||null===this.calcManager?null:this.calcManager.jD}get localeInfo(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}dispose(){k.a.qc([this.WRa,this.Uga]);this.$=this.Uga=this.WRa=null}MRa(na,Na,Va,Sa,vb=!1,Oa="",yb,Ob=0,Ja=null){return this.Tzj(na,Na,Va,vb,Ob,Oa,void 0,Ja)}X6c(na,Na,Va,Sa,vb,Oa){na.cell.Sx.FJ|=Sa;sb.Q_g(mb.g(this.$),na,Va,vb);this.Uga.lastSetCellInstantaneousOperation=Na;Oa&&mb.g(this.$).Gi.e0(Na,sa.BasicTelemetryCalculator.vQ)}wda(na,
Na,Va,Sa=!1,vb=null,Oa=null){Oa=Oa||na.ha.sa.selectedRanges;if(!(-1690267012===Na&&1<Oa.length)){-1690267012===Na&&e.ULS.shipAssertTag(537162176,0,1===Oa.length,`FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = ${Oa.length}`);Oa=na.i$("FormatCellsAction.ShowInstantaneousFormatting",Oa);try{Oa.$$rst();let yb=!1;for(;Oa.$$mn();){let Ob;const Ja=Oa.$$cu().KH?na.sJb(Oa.$$cu().range):(Ob=new l.a,Ob.add(Oa.$$cu()),Ob);for(let lb of Ja)if(mb.g(this.$),!lb||Oa.gb.contains(lb.range))if(this.U2f(Na,
lb,Va,Sa,vb,Oa.$$cu().KH),yb||(na.Ea.RU(),yb=!0),vb)break}}finally{Oa&&Oa.dispose()}}}MYa(na,Na,Va=null){Va&&(Va.Nva=!0);Va=!Na.text;const Sa=Ra.a.xef(Na.text);let vb;const Oa=na.KH?mb.g(this.$).sJb(na.range):(vb=new l.a,vb.add(na),vb);for(let yb of Oa)this.iKg(this.$,yb,Na.text,Na.horizontalAlignment,Na.fontColor,Na.Gk,na.cell.Gk,Va,Sa,Na.valueType,Na.ONa);na.cell.bBc()}zWi(na,Na,Va,Sa,vb=null){try{const Oa=x.D(Na);let yb=x.D(Va);if(na.Db.c6a(Oa)||na.Db.c6a(yb))return 8;if(-185374993!==Sa&&this.Yli(na,
Oa,yb))return 9;if(-185374993!==Sa&&(na.Db.u4(yb)||na.Db.kzb(Oa)))return 10;if(1804571062!==Sa&&na.Db.s4(yb))return 11;if(this.Tgh(yb))return 12;if(this.Rmi(Oa,yb))return 13;const Ob=this.$.Ib.Bc("UserAction","PasteInstantaneous");Ob.start();rb.a(Ob);vb&&cc.b().DA(Ob.id,vb.id,"actions","actions");!Oa.isSingle&&yb.isSingle&&(yb=sb.expandRange(Oa,yb),na.ha.updateSelection(yb,yb,0));switch(Sa){case 237279923:case 808159687:if(!this.RWi(Oa,yb))return 14;this.L1c(na,Oa,yb,!0,!1);break;case 1804571062:this.L1c(na,
Oa,yb,!0,!1);break;case -185374993:this.L1c(na,Oa,yb,!1,!0);break;default:return 2}e.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(Oa){return e.ULS.sendTraceTag(537162145,0,10,`FormatCellsAction.PasteInstantaneous: failed with the following error: ${JSON.stringify(Oa)}`),15}}LXg(na,Na){for(const Va of na)this.m_c(Va,!0,Na)}m_c(na,Na,Va=""){if(na){var Sa=mb.g(this.$);if(Na){if(Na=Sa.mk("FormatCellsAction.ClearRangeInstantaneous",na),Sa=
na.isSingle?null:na,Na.$$mn()&&void 0!==Na.$$cu()&&null!==Na.$$cu())for(na=Object(f.a)(new Wb.a,{Text:""}),this.MRa(Na.$$cu(),na,!1,void 0,H.a.Cnd(this.$),Va,void 0,void 0,Sa);Na.$$mn();)void 0!==Na.$$cu()&&null!==Na.$$cu()&&this.MRa(Na.$$cu(),na,!1,void 0,!1,Va)}else this.wda(Sa,-1228228458,{},void 0,void 0,[na])}else e.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")}m6i(na,Na){if(!Na){Na=Z.HelperMethods.Tb();var Va=mb.g(this.$),Sa=Va.i$("FormatCellsAction.ReformatCells",
na);try{Sa.$$rst();let vb=!1;for(;Sa.$$mn();){const Oa=Sa.$$cu().cell;if(0===Oa.wJ||2===Oa.wJ)this.updateSpillInformation(Oa,na),vb||(Va.Ea.RU(),vb=!0)}}finally{Sa&&Sa.dispose()}e.ULS.sendTraceTag(537162143,0,50,`FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: ${Z.HelperMethods.Tb()-Na}.`)}}xhd(na,Na){if(this.xb){if(na.formulaBarText)return!Ra.a.equals(Na.Text,na.formulaBarText,!1);let Va=na.cell.Bh;Va=ib.a(Va,na.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(Va,
Na).isEqual}return!Ra.a.equals(Na.Text,na.text,!1)}xTe(na,Na,Va,Sa){if(void 0===Na||null===Na)return new bb(!1,na);const vb={};vb.value=na;vb.type=1;Na=this.y2a(vb,Na,Va,Sa);return Object(fa.b)(Na)?new bb(!1,na):new bb(!0,Na.value.text)}Uzj(na,Na,Va,Sa){return c(na,this,Na,Va,Sa,!0)}Rzj(na,Na,Va){if(!this.xhd(Na,Va))return Object(fa.d)("Skip unchanged cell content");Na=Na.cell;Va=this.zTe(Va.Text,Na.Gk,Na.FAa,Na.zha,!0);if(Object(fa.b)(Va))na=Va;else{Va=Va.value;var Sa=Na.hasRichValueIcon?"Unsupported rich value icon":
Na.s7?"Unsupported wrapped text":Na.nhf||null!=Na.pL&&0!==Na.pL?"Unsupported rotated text":!0;!0!==Sa?na=Object(fa.a)(Sa):(Na.isCellWidthFixed?Sa="Skip fixed width cell":(Sa=Va.valueType,Sa=0===Sa?"Skip empty cell value":2===Sa?"Skip string cell value":Na.tF&&!Na.Rli?"Skip merged cell":Na.Twc?"Skip shrunk to fit":Va.isHashesValue?"Skip hashes cell value":!0),!0!==Sa?na=Object(fa.d)(Sa):(Va=Na.s1g(Va.text),Va>Na.offsetWidth?(Na=[Na.getRange().clone()],na=c(na,this,Na,Va,!1,!1),na=Object(fa.b)(na)?
na:Object(fa.d)(Va)):na=Object(fa.d)("Column is wide enough")))}return na}wTe(na,Na,Va,Sa,vb){const Oa={};Oa.value=na;Oa.type=Va;Na=this.y2a(Oa,Na,Sa,vb);return Object(fa.b)(Na)?new bb(!1,na):new bb(!0,Na.value.text)}updateSpillInformation(na,Na){const Va=na.getRange();let Sa=!1;for(const vb of Na)if(Va.left===vb.left){Sa=!0;break}na.qQj(Sa)}Tzj(na,Na,Va,Sa,vb,Oa="",yb=1,Ob=null){this.Rzb&&this.doi&&(na.cell.CCc=Na);const Ja=new Ya;Ja.source=0;Ja.Nva=!1;na.cell.YEb=na.cell.Gk;let lb=Na.Text;const Pb=
!lb,Jb=Ra.a.xef(lb);Ra.a.Aq(lb)&&(e.ULS.shipAssertTag(537162142,0,!((void 0===lb||null===lb)&&void 0!==Na.TextRuns&&null!==Na.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),Na=Object(f.a)(new Wb.a,{Text:""}),lb="");na.cell.userInput=lb;if(!this.xhd(na,Na))return this.nVg(na,vb,Pb,Jb,Ja);Va?this.gVg(na,lb,this.$.workbookContext.DefaultHyperlinkStyle,Ja):this.aVg(na,Na,lb,Pb,Jb,Sa,Ja,Ob);this.X6c(na,Oa,vb,yb,Ja.rgc,Ja.Nva);return Ja}nVg(na,Na,
Va,Sa,vb){vb.Zeg=!0;vb.rgc=!0;vb.Nva=!1;0===Na&&mb.g(this.$).Ea.RU();0===na.cell.tya&&(Va?na.cell.V_(0,!1):Sa&&na.cell.V_(1,!1));this.yWd(na.range,"FormatCellsAction.cellUnchangedDataEntryCSE");return vb}gVg(na,Na,Va,Sa){Sa.Nva=!0;na.insertHyperlink(Na,D.a.Q$c(Na),Va);this.yWd(na.range,"FormatCellsAction.cellDataEntryCSE")}aVg(na,Na,Va,Sa,vb,Oa,yb,Ob=null){yb.Nva=!1;const Ja=na.cell;this.mz||(this.mz=this.$.da.za(268));this.bMj(this.mz,Ja.Gk);Sa||vb?this.cVg(na,Sa,vb,yb):(Sa=this.zTe(Va,Ja.Gk,Ja.FAa,
Ja.zha,!1),Object(fa.c)(Sa)?(this.kQd(Na.TextRuns,Na.Fonts)&&this.eVg(na,Na,Sa.value),this.MYa(na,Sa.value,yb),this.yWd(na.range,"FormatCellsAction.cellDataEntryCSE")):this.Rzb&&this.Dqd?this.kVg(na,Na.Text,yb):this.lVg(na,Na.Text),Na=Object(fa.c)(Sa)?Sa.value.text:"",vb=Object(fa.b)(Sa)?Sa.reason:"",e.ULS.sendTraceTag(559724065,0,50,`FormatCellsAction.CellDataEntryCSE: (${na.range.top}, ${na.range.left}) 1st pass formatting, success: ${Sa.success}, reason: ${vb}, ifmt: ${Ja.Gk}, input: '${Ra.a.GYa(Ja.userInput)}', prediction: '${Ra.a.GYa(Na)}',`));
Ja.formulaBarText=Va;Oa&&this.ALj(this.mz,na,Va,Ob);yb.rgc=!0}cVg(na,Na,Va,Sa){Sa.Nva=!0;na.text="";na.formulaBarText="";na.cell.userInput="";this.E0b(na,null,null,Na,Va)}eVg(na,Na,Va){Na.Text===Va.text&&2===Va.valueType&&(na.cell.Bh=Na)}kVg(na,Na,Va){Va&&(Va.Nva=!0);na.text=Na;na.formulaBarText=Na;this.E0b(na,1)}lVg(na,Na){na.text=Na;na.formulaBarText=Na;this.E0b(na,1)}E0b(na,Na,Va=null,Sa=!1,vb=!1,Oa=!1){let yb=na.horizontalAlignment;Va=null!=Va?Va:na.verticalAlignment;0===na.cell.tya&&(null!=Na||
Sa||vb||Oa)&&(Sa?yb=0:vb||Oa?yb=1:null!=Na&&(yb=Na),this.jua.lcb(na,yb,!1,Va,!0))}yWd(na,Na){if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")){const Va=mb.g(this.$),Sa=()=>{this.calcManager?this.calcManager.Grf(na):e.ULS.sendTraceTag(521172961,0,50,`FormatCellsAction.cellUnchangedDataEntryCSE: Unable to call notifyEditedCellRecalcComplete as calcManager member is null. caller: ${Na}, cell ${na}`);Va.Xb.yl(Sa)};Va.Xb.em(Sa)}}bMj(na,Na){(null===na||void 0===na?0:
na.Pxa)&&Na>=sb.AAh&&Na>na.Pxa.length-1&&(e.ULS.sendTraceTag(537162141,0,50,`FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:${Na}. Triggering refresh...`),na.oTe())}ALj(na,Na,Va,Sa=null){if(void 0!==na&&null!==na)if(this.mz.Rkd)e.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");else{var vb=this.$.da.za(266);vb&&(this.Uga.xca=Y.BFe,na&&(this.Uga.xca=na.u$e),vb.ZSg(Na,Va,this.Uga.VIf,Sa))}}y2a(na,Na,Va,Sa){var vb=
this.$.da.za(266);if(!vb)return Object(fa.a)("calcManager is null");if(!vb.jD)return Object(fa.a)("calcManager.NumberFormatter is null");if(!this.mz)return Object(fa.a)("instantaneousManager is null");let Oa;if("number"===typeof Na||"string"===typeof Na){var yb=vb.jac(Na);if(!Object(fa.c)(yb))return yb;Oa=yb.value}else Oa=Na;yb=vb.jD;const Ob=V(na);if(void 0===Ob||null===Ob)return Object(fa.a)("cellValue is null");vb=excelOnlineCalc.calc.cellValueToReadOper(vb.config.mathpack,Ob);if(void 0===vb||
null===vb)return Object(fa.a)("readOper is null");vb=yb.applyFormat(Oa,vb,X.EwaSettings.isChangeGateEnabled("OfficeVSO:6328006_applyFormatDisplaysZeroes"));return excelOnlineCalc.util.isSuccess(vb)?this.Uga.i$c(yb,vb.value,na.type,Va,Sa,"number"===typeof Na?Na:-1,!1):Object(fa.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(vb.reason.kind))}zTe(na,Na,Va,Sa,vb){var Oa=this.$.da.za(266);if(void 0===Oa||null===Oa)return Object(fa.a)("calcManager is null");if(void 0===Oa.jD||null===Oa.jD)return Object(fa.a)("calcManager.NumberFormatter is null");
if(void 0===this.mz||null===this.mz)return Object(fa.a)("instantaneousManager is null");if(this.Rzb&&!vb)return Object(fa.a)("No main thread number formatter");var yb=Oa.jac(Na);if(!Object(fa.c)(yb))return yb;var Ob=yb.value;yb=Oa.jD;na=yb.parseEdit(na,Ob);if(!excelOnlineCalc.util.isSuccess(na))return Object(fa.a)(`ParseEdit failure: reason=${na.reason.kind}, features=${na.reason.features}`);if(na.value.kind===y.a.formula)return Object(fa.a)("Main thread - skipping formula edit");Oa=excelOnlineCalc.numfmt.applyValueEdit(yb,
Oa.localeInfo,Ob,na.value);if(!excelOnlineCalc.util.isSuccess(Oa))return Object(fa.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(Oa.reason.kind));na=na.value;e.ULS.shipAssertTag(537162190,0,na.kind!==y.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");na=excelOnlineCalc.numfmt.getValueEditOperKind(na);Ob=0;switch(na){case 0:case 128:Ob=0;break;case 1:Ob=1;break;case 2:Ob=2;break;case 4:Ob=3;break;case 8:Ob=4;break;case 16:case 32:case 64:case 256:e.ULS.sendTraceTag(537162189,
0,15,`CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind ${na} to a CellValueType`);break;default:e.ULS.shipAssertTag(537162188,0,!1,`CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind ${na}`)}return this.Uga.i$c(yb,Oa.value,Ob,Va,Sa,"number"===typeof Na?Na:-1,vb)}Yli(na,Na,Va){if(Na.width<Va.width){const Sa=na.mk("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new u.Range(Na.top,Na.left,Na.bottom,Na.left,!0,!0));for(;Sa.$$mn();){let vb=Sa.$$cu();if(vb&&
vb.uKa())return e.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0}}if(Na.height<Va.height)for(na=na.mk("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new u.Range(Na.top,Na.left,Na.top,Na.right,!0,!0));na.$$mn();)if((Na=na.$$cu())&&Na.xKa())return e.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1}L1c(na,Na,Va,Sa,vb){const Oa=Na.WR().FirstRow,yb=Na.WR().LastRow;
var Ob=Va.WR().FirstRow;const Ja=Va.WR().LastRow;let lb=Oa;for(;Ob<=Ja;Ob++,lb++){lb>yb&&(lb=Oa);const Pb=Na.WR();Pb.FirstRow=Pb.LastRow=lb;const Jb=Va.WR();Jb.FirstRow=Jb.LastRow=Ob;this.R2g(na,w.a.bQ(Pb),w.a.bQ(Jb),Sa,vb)}}RWi(na,Na){const Va=this.$.da.za(266);return void 0!==Va&&null!==Va?(Va.USg(na,Na.topLeft,this.Uga.VIf),!0):!1}Rmi(na,Na){const Va=na.right-na.left+1;na=na.bottom-na.top+1;const Sa=Na.right-Na.left+1;Na=Na.bottom-Na.top+1;if(Sa>Va&&Na>na){if(!(Sa%Va&&Na%na))return!0}else if(Sa===
Va&&Na>na){if(!(Na%na))return!0}else if(Sa>Va&&Na===na&&!(Sa%Va))return!0;return!1}Tgh(na){if(X.EwaSettings.ma(102)){na=mb.g(this.$).FW(na).gridView.getRangeInformation(na);for(const Na of na)if(Object(m.a)(r.DynamicArrayRange,Na)&&!Object(v.a)(r.DynamicArrayRange,Na).Mkc)return!0}return!1}pBe(na,Na,Va,Sa,vb,Oa){for(let yb of Na)Va&&(this.V2g(yb,vb),yb.setCell(!0)),Sa&&(Oa=this.q2h(vb,yb)),Oa||(na.Ea.RU(),Oa=!0);return Oa}$Nh(na,Na,Va){Na=new u.Range(Na,Va,Na,Va,!0,!0);return na.Vb(Na)}R2g(na,Na,
Va,Sa,vb){if(Va){this.WRa&&Va.equals(this.WRa.range)||(k.a.Ia(this.WRa),this.WRa=na.mk("FormatCellsAction.CopyBetweenRows",Va));Va=this.WRa;Va.$$rst();var Oa=!1;if(X.EwaSettings.getBooleanFeatureGate(fb.a.oEe,!1)){var yb=Na.WR().FirstColumn+1,Ob=Na.WR().LastColumn+1;Na=Na.WR().FirstRow+1;let lb=yb;for(;Va.$$mn();){lb>Ob&&(lb=yb);const Pb=this.$Nh(na,Na,lb);lb+=1;var Ja=void 0;const Jb=Va.$$cu().KH?na.sJb(Va.$$cu().range):(Ja=new l.a,Ja.add(Va.$$cu()),Ja);Pb&&(Oa=this.pBe(na,Jb,Sa,vb,Pb,Oa));Ea.lastOrDefault(Jb)}}else for(Ja=
na.mk("FormatCellsAction.CopyBetweenRows2",Na);Va.$$mn();)Ja.$$mn()||(Ja.$$rst(),Ja.$$mn()),Ob=Ja.$$cu(),Na=Va.$$cu().KH?na.sJb(Va.$$cu().range):(yb=new l.a,yb.add(Va.$$cu()),yb),Ob&&(Oa=this.pBe(na,Na,Sa,vb,Ob,Oa)),Ea.lastOrDefault(Na)}else e.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")}n3f(){const na=ia.a.Yc(1,0,0,653,0,104573951,"PivotTableContextMenuOperationFailure");Kb.a(this.$).oj(na)}Ixi(na,Na){const Va={ValidMembers:32},Sa=Na.NumberFormat;switch(na){case 1890566896:if(1001===
Sa||1002===Sa||1003===Sa){Va.NumberFormat=14;Va.NumberFormatOptions={};switch(Sa){case 1001:Va.NumberFormatOptions.TimeType=2;break;case 1002:Va.NumberFormatOptions.DateType=7;break;case 1003:Va.NumberFormatOptions.DecimalPlaces=0}Va.NumberFormatOptions.NumberFormatCategory=this.YJg(Sa)}else Va.NumberFormat=Sa;break;case 1886928607:Va.NumberFormat=13;break;case -992833457:Va.NumberFormat=11;break;case 218524921:Va.NumberFormat=12;break;case 996232352:Va.NumberFormat=14;Va.NumberFormatOptions=Object(f.a)(new n.a,
{DecimalPlaces:0});Va.NumberFormatOptions.NumberFormatCategory=6;break;default:return Na}return Va}formatCells(na,Na,Va,Sa=null,vb=null,Oa=null,yb=null){const Ob=this.$.Ib.Bc("UserAction","FormatCellsInstantaneous, command = "+cc.b().nj(na)),Ja=this.$.Ib.Og("UserAction","FormatCellsInstantaneousFrame");Ja.start();rb.a(Ja);var lb=cc.b().nj(na);const Pb=this.$,Jb=mb.g(Pb);var Lb=Jb.ha.sa,Ab=vb||Lb.selectedRanges,nb=Pa.g(Ab,Ha=>Ha.WG);lb=`${lb}, cellCount=${nb}`;mb.g(this.$).Gi.T6(1,Ob.id,lb);Ab=x.r(Ab,
this.$);Lb=Lb.activeCell;lb=-168056295===Va.command;var va=nb=null;if(lb){va=Jb.Db.fp(Lb);if(!va){this.n3f();return}nb=va.mca.substring(1,va.mca.length-1);va=va.p$b();if(!va){this.n3f();return}va=va.Caption}Jb.Df.XG(!1,!0);const db=x.o(Lb,Pb),Xa=Pb.oa.va.Sb({MZ:!0,dZ:1}),gb=this.Ixi(Va.command,Na);lb||this.wda(Jb,na,Na,!1,Sa,vb);Ob.stop();mb.g(this.$).Gi.e0(Ob.id,sa.BasicTelemetryCalculator.vQ);Va.rbi=xa.a.Wa.Nb;Sa=this.$.Ib.Bc("UserAction","FormatCellsUserAction");this.Vti(na,Va.taskId,Na,Ab,Lb,
Sa.id);cc.b().DA(Ob.id,Sa.id,"actions","actions");cc.b().DA(Ja.id,Sa.id,"actions","actions");X.EwaSettings.dc()?Pb.userOperationManager.Ub(new S(this,Ab,db,gb,lb,nb,va,Xa,Sa,Ob.id,64,Oa,yb),Va):Pb.userOperationManager.Ub(new S(this,Ab,db,gb,lb,nb,va,Xa,Sa,Ob.id,0,Oa,yb),Va)}a2(na,Na,Va,Sa,vb,Oa,yb,Ob,Ja,lb,Pb){const Jb=this.$;return(Lb,Ab,nb)=>{Jb.ry();Lb=[Lb,this.EJi];Ab=[Ab];lb&&Lb.push(lb);Pb&&Ab.push(Pb);return z.l(Jb.oa.va,na,Na,Va,Sa,vb,Oa,!1,wa.b(...Lb),wa.a(...Ab),nb,Ja,yb,Ob)}}U2f(na,Na,
Va,Sa,vb,Oa,yb=null){if(Na&&Va){var Ob=Va.Font,Ja=Va.HorizontalAlignment,lb=Va.VerticalAlignment;Va.ValidMembers&2||(Ja=Na.horizontalAlignment);Va.ValidMembers&1||(lb=Na.verticalAlignment);var Pb=0!==Ja;sb.Bdi(na)&&0===Ja&&(Ja=this.IYe(Na));var Jb=!1;switch(na){case -394785302:this.jua.lcb(Na,Ja,Pb,0);break;case 1041132226:this.jua.lcb(Na,Ja,Pb,1);break;case -571165336:this.jua.lcb(Na,Ja,Pb,2);break;case -1150205178:case -1142465846:case -286432209:this.jua.lcb(Na,Ja,Pb,lb,!1,!1);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:this.mMa&&
this.toj(Na,Va,Pb);break;case 1650812936:this.setFillColor(Na,Va,Oa);break;case -287251124:Na.bold=Ob.Bold;break;case -1690267012:mb.g(this.$).ha.sa.wg&&(Ob=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1)?yb?yb:mb.g(this.$).ha.sa.Wc:mb.g(this.$).ha.sa.Wc,this.jua.UJb(Na,Va,Ob));break;case 1970784898:Va=M.a.cp(Na.color,Na.backgroundColor);if(ta.a.compare(Va,ta.a.red)&&(Ra.a.q4(Na.text)||Ra.a.I5e(Na.text)))break;Va=ta.a.lH(Ob.FontColor);Na.color=
nc.e(M.a.hG(Va));break;case -1925065947:Na.italic=Ob.Italic;break;case -1293291468:Na.fontName=Ob.FontName;this.Im&&Na.aZf(Ob.FontScheme);break;case 862890474:case 963349338:Na.fontSize=Ob.FontSize;this.$.qf();break;case -1077965542:Na.fontSize=Ob.FontSize;break;case 1764140053:Na.underline=Ob.Underline;break;case -1685033574:Na.doubleUnderline=Ob.DoubleUnderline;break;case -1590502662:Na.fontStrikethrough=Ob.Strikethrough;break;case -848953656:case 2045211913:Jb=Na.ppb();break;case 2105621672:Va=
Object(v.a)($a.a,vb);if(!Va)break;Ob=ta.a.kDh(Va.color);Na.color=nc.e(M.a.hG(Ob));this.sqe(Na,Va.clc);break;case -1409276245:this.sqe(Na,Va.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.hKg(Na,Va);break;case -1228228458:Na.ppb();Na.clearFormat();this.wVc(Na,0);Jb=!0;break;case -730106152:Na.clearFormat();this.wVc(Na,0);break;case 932244020:this.soj(Na,Va,Oa);break;case -1942512156:case -1920201820:this.sqj(Na,Va)}Sa||(Jb?Na.pHb(!0):Na.setCell(!0))}else e.ULS.shipAssertTag(537162135,
0,!Na,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),e.ULS.shipAssertTag(537162134,0,!Va,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")}V2g(na,Na){na&&Na?(na.ypb(Na),na.G_c(Na),this.wVc(na,Na.cell.Gk)):e.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")}wVc(na,Na){if(0>Na)this.Bba({caller:"ApplyNumberFormatIndexOnCell",cell:na,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: negative format index was supplied"});
else{var Va=this.y2a(na.Sw,Na,na.cell.FAa,na.cell.zha);Object(fa.b)(Va)?this.Bba({caller:"ApplyNumberFormatIndexOnCell",cell:na,kind:"failure",reason:Va.reason}):(this.MYa(na,Va.value),this.Bba({caller:"ApplyNumberFormatIndexOnCell",cell:na,kind:"success",Nx:Va.value,format:Na}))}}sqe(na,Na){if(void 0===Na||null===Na)this.Bba({caller:"ApplyNumberFormatStringOnCell",cell:na,kind:"failure",reason:"ApplyNumberFormatStringOnCell: no format string was supplied"});else{var Va=this.y2a(na.Sw,Na,na.cell.FAa,
na.cell.zha);Object(fa.b)(Va)?this.Bba({caller:"ApplyNumberFormatStringOnCell",cell:na,kind:"failure",reason:Va.reason}):(this.MYa(na,Va.value),this.Bba({caller:"ApplyNumberFormatStringOnCell",cell:na,kind:"success",Nx:Va.value,format:Na}))}}hKg(na,Na=null){if(Na)if(Na=this.iVh(na,Na),Na.success){var Va=this.y2a(na.Sw,Na.Zkc,na.cell.FAa,na.cell.zha);Object(fa.b)(Va)?this.Bba({caller:"ApplyNumberFormatCategoryOnCell",cell:na,kind:"failure",reason:Va.reason,format:Na.Zkc}):(this.MYa(na,Va.value),this.Bba({caller:"ApplyNumberFormatCategoryOnCell",
cell:na,kind:"success",Nx:Va.value,format:Na.Zkc}))}else this.Bba({caller:"ApplyNumberFormatCategoryOnCell",cell:na,kind:"failure",reason:Na.reason,format:Na.Zkc});else this.Bba({caller:"ApplyNumberFormatCategoryOnCell",cell:na,kind:"failure",reason:"ApplyNumberFormatCategoryOnCell: no format was supplied"})}YJg(na){switch(na){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<na?-1:na}iVh(na,
Na){if(!this.mz||!this.localeInfo||!Na)return na=this.mz?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new ja(!1,void 0,"GetRibbonNumberFormat: "+na);Na=Na.NumberFormat;switch(Na){case 0:na=B.JDh;break;case 1:na=B.LDh;break;case 2:na=B.HDh;break;case 3:na=B.FDh;break;case 4:na=B.ODh;break;case 5:na=B.KDh;break;case 6:na=B.QDh;break;case 7:na=B.MDh;break;case 8:na=B.IDh;break;case 9:na=B.NDh;break;case 10:na=B.PDh;break;case 11:case 12:return this.mz.oTe(),
this.uLh(na,Na);case 13:na=B.QRg;break;case 1006:na=B.buttonPercentage;break;case 1004:na=B.keyboardNumber;break;case 1005:na=B.keyboardCurrency;break;case 1002:na=B.keyboardDate;break;case 1001:na=B.keyboardTime;break;case 1003:na=B.keyboardPercentage;break;case 14:return na="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",e.ULS.shipAssertTag(537162132,0,!1,na),new ja(!1,void 0,na);default:return na="GetRibbonNumberFormat: unknown NumberFormatType!",e.ULS.shipAssertTag(537162131,
0,!1,na),new ja(!1,void 0,na)}return na?(na=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,na))?new ja(!0,na):new ja(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format..."):new ja(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...")}uLh(na,Na){if(!this.calcManager||!this.jD)return Na=this.calcManager?"numberFormatter is null":"calcManager is null",new ja(!1,void 0,"GetDecimalChangeNumberFormat: "+Na);na=
this.calcManager.jac(na.cell.Gk);if(!Object(fa.c)(na))return new ja(!1,void 0,`getDecimalChangeNumberFormat: ${na.reason}`);Na=this.jD.changeFormatDecimals(na.value,11===Na?1:-1);return excelOnlineCalc.util.isSuccess(Na)?void 0===Na.value||null===Na.value?new ja(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result"):new ja(!0,Na.value):new ja(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure")}Bba(na){const Na=na.caller,Va=na.cell;var Sa=na.format;Sa=
null==Sa?"null":"number"===typeof Sa?Sa:"string"===typeof Sa?Ra.a.GYa(Sa):Ra.a.GYa(Sa.formatString);const vb=Ra.a.GYa(Va.Sw.value)||"null",Oa="success"===na.kind?Ra.a.GYa(na.Nx.text):"null";na=JSON.stringify({caller:Na,"range.top":Va.range.top,"range.left":Va.range.left,result:na.kind,reason:"success"===na.kind?"":na.reason,value:vb,valueType:Va.Sw.type,ifmt:Sa,prediction:Oa});e.ULS.sendTraceTag(537162130,0,50,`FormatCellsAction.LogNumberFormatEdit: ${na}`)}iKg(na,Na,Va,Sa,vb,Oa,yb,Ob=!1,Ja=!1,lb=
0,Pb=null){const Jb=Na.cell;Jb.wJ=lb;lb=Na.text;lb!==Va&&(Jb.text=Va);Jb.ONa=Pb;Ca.f(lb)?Na.formulaBarText=lb:Na.formulaBarText="";na=mb.g(na).Db.cff(Na.range);this.E0b(Na,Sa,null,Ob,Ja,na);vb&&(Na.color=nc.e(M.a.hG(vb)));Na.cell.Gk=Oa;Na.cell.YEb=yb;Na.cell.uxc=Oa}Vti(na,Na,Va,Sa,vb,Oa){const yb={};yb.a=this.$.ya.UserSessionId;yb.b=Na;yb.c=Sa.Ranges.length;yb.d=this.T6g(Sa.Ranges);yb.e=vb.toString();yb.f=na;yb.h=Oa;1890566896===na?yb.g=Va.NumberFormat.toString():2105621672===na&&(yb.g=Va.NumberFormatOptions.NumberFormatCategory.toString());
cc.b().Le(3,yb,!0)}T6g(na){let Na=0,Va=0,Sa=0;for(let vb=0;vb<na.length;vb++){const Oa=x.B(na[vb]).WG;Na+=Oa;Oa>Sa&&(Sa=Oa,Va=vb)}na=x.B(na[Va]).toString();return"TotalCellCount:"+Na+"; Max range:"+na+"; MaxRangeSize:"+Sa+";"}soj(na,Na,Va){64===(Na.ValidMembers&64)&&this.setFillColor(na,Na,Va);16===(Na.ValidMembers&16)&&sb.Wpj(na,Na);128===(Na.ValidMembers&128)&&this.jua.UJb(na,Na,na.range);if(2===(Na.ValidMembers&2)||1===(Na.ValidMembers&1)){Va=Na.VerticalAlignment;Na=Na.HorizontalAlignment;const Sa=
0!==Na;X.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!Sa&&this.IYe(na);this.jua.lcb(na,Na,Sa,Va)}}setFillColor(na,Na,Va){(X.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?na.vaa:na.vaa&&na.gwb&&!na.jwb&&!na.nwb)||(Na=-1===Na.FillColor?Va?M.a.hG(ta.a.white):null:M.a.hG(ta.a.lH(Na.FillColor)),na.backgroundColor=Na?nc.e(Na):null)}sqj(na,Na){0!==na.horizontalAlignment&&2!==na.horizontalAlignment||na.V_(1,!1);0<=
na.indentation+Na.IndentationIncrease&&(na.indentation+=Na.IndentationIncrease)}toj(na,Na,Va){let Sa=na.pL,vb=Na.TextOrientation;vb!==O.a.verticalText&&(0>vb||180<vb)&&e.ULS.shipAssertTag(523090050,0,!1,`FormatCellsAction.setCellTextOrientation: invalid value for text orientation in server ${vb}`);Sa===vb||Sa===O.a.btc&&vb===O.a.ctc||Sa===O.a.dtc&&vb===O.a.etc?Na.TextOrientation=0:(na.pL=Na.TextOrientation,Va||na.V_(0<=na.pL?1:3,!1))}IYe(na){na=this.y2a(na.Sw,na.cell.Gk,na.cell.FAa,na.cell.zha);return Object(fa.b)(na)?
0:null!=na.value.horizontalAlignment?na.value.horizontalAlignment:0}Erj(na,Na,Va){this.nx||(this.nx=new ca.a(mb.g(this.$).Ea,this.$));this.nx.UJb(na,Na,Va)}q2h(na,Na){const Va=new Wb.a;if(na.cell.formulaBarText&&na.cell.formulaBarText.startsWith("'"))Va.Text=na.cell.formulaBarText;else{let Sa=na.cellValue;Sa&&4!==na.cell.wJ||(Sa=na.text);Va.Text=Sa}this.MRa(Na,Va,!1,void 0,H.a.Cnd(this.$));return!0}kQd(na,Na){return this.xb&&!!na&&!!Na}static Q_g(na,Na,Va,Sa){Sa&&Na.setCell(!0);0===Va&&na.Ea.RU()}static expandRange(na,
Na){Na=Na.clone();Na.height<na.height&&(Na.bottom=Na.top+na.height-1);Na.width<na.width&&(Na.right=Na.left+na.width-1);return Na}static Bdi(na){switch(na){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;default:return!1}}static Wpj(na,Na){Na=Na.Font;var Va=0!==(Na.ValidMembers&16);const Sa=0!==(Na.ValidMembers&16),vb=0!==(Na.ValidMembers&16);na.bold=0!==(Na.ValidMembers&4);na.italic=0!==(Na.ValidMembers&8);Va&&(na.underline=Va);Sa&&(na.doubleUnderline=
Sa);vb&&(na.fontStrikethrough=vb);na.fontName=Na.FontName;na.fontSize=Na.FontSize;Va=M.a.cp(na.color,na.backgroundColor);ta.a.compare(Va,ta.a.red)&&(Ra.a.q4(na.text)||Ra.a.I5e(na.text))||(Na=ta.a.lH(Na.FontColor),na.color=nc.e(M.a.hG(Na)))}}sb.AAh=36;Object(t.a)(sb,"FormatCellsAction",null,[287,2]);class Ua extends d.a{constructor(na){super();this.$=na;this.Fb()}create(){this.qb(new sb(this.$))}static ka(na){na.da.Ga(18,new Ua(na))}}Object(t.a)(Ua,"FormatCellsActionFactory",d.a,[]);a.d(C,"a",function(){return ab});
const ab=()=>{b.a.Fa(Ua.ka)}},1156:function(t,C,a){var c=a(10);t=a(0);var b=a(221),d=a(1),f=a(15),e=a(194),k=a(78),l=a(37),m=a(47),v=a(45),n=a(638),w=a(28),r=a(118);class u{constructor(){this.startTime=w.a.Wa.Nb;this.rx=new n.a}xXe(){return r.a(w.a.Wa,this.startTime)}}Object(t.a)(u,"OngoingAction",null,[]);class y extends k.a{constructor(Ua,ab,na,Na,Va=null){super();this.xOa=this.Xmb=null;this.RXc=0;this.Knc=null;this.ZPi=()=>{const Sa=this.xOa.xXe();f.ULS.sendTraceTag(537153861,0,50,`ActionAggregator<${this.Lka}>.OnRunningLong: Operation running for more than ${Sa}ms`);
this.Knc=m.a.instance.create(this.J5,Math.max(this.fue-Sa,0),v.a.Oie)};this.J5=()=>{f.ULS.sendTraceTag(537153860,0,50,`ActionAggregator<${this.Lka}>.OnTimeout: Operation running for more than ${this.xOa.xXe()}ms, timing out. Has pending actions: ${this.q5a}`);this.RXc++;this.RXc>this.eue&&f.ULS.sendTraceTag(537153859,0,50,`ActionAggregator<${this.Lka}>.OnTimeout: passed the allowed bypassed count`);this.xOa.rx.cancel();this.dSe()};this.pla=()=>{this.q5a&&f.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.Lka}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.jLa}, AggregatedActionParams not null: ${this.q5a}`);
this.Xkd()};this.Myg=Ua;this.Nyg=ab;this.documentVisibilityObserver=na;this.Lka=Na;this.nL=Va;na&&this.documentVisibilityObserver.Cmb(this.pla);this.QXc=!!na&&d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);this.eue=d.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);ab=d.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);this.fue=Ua.wbd(ab);
Ua=d.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);this.bSg=Math.max(this.fue-ab,0)+Ua}get jLa(){return!!this.xOa}get q5a(){return!!this.Xmb}SFf(Ua){f.ULS.sendTraceTag(537153864,0,50,`ActionAggregator<${this.Lka}>.PerformThrottledAction: Start. IsActionOngoing: ${this.jLa}, AggregatedActionParams not null: ${this.q5a}`);this.Xmb=this.Nyg.RUc(Ua,this.Xmb);this.Xkd()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.Pab(this.pla);
this.Kve();super.dispose()}OZf(Ua){this.QXc?(this.xOa=Ua?new u:null,Ua?this.startTimer():this.Kve()):this.xOa=Ua?{}:null}dSe(Ua=null){this.QXc&&Ua&&Ua.kK?f.ULS.sendTraceTag(537153863,0,50,`ActionAggregator<${this.Lka}>.FinishedCallback: timedout, skipping`):(f.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.Lka}>.FinishedCallback: Start. IsActionOngoing: ${this.jLa}, AggregatedActionParams not null: ${this.q5a}`),this.OZf(!1),this.Xkd())}Xkd(){if(!this.dLb()){var Ua=this.Xmb;this.Xmb=null;
this.OZf(!0);f.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.Lka}>.InternalPerformAction: Calling PerformAction.`);var ab=this.QXc?this.xOa.rx.token:e.a.none;l.TaskExtensions.Aa(this.Myg.uCd(Ua),()=>{this.dSe(ab)},ab,0,this.nL)}}dLb(){return!this.q5a||this.jLa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.Ii?(f.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.Lka}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}Kve(){this.Knc&&this.Knc.cancel()}startTimer(){this.RXc<=
this.eue&&(this.Knc=m.a.instance.create(this.ZPi,this.bSg,v.a.Oie))}}Object(t.a)(y,"ActionAggregator",k.a,[628,2]);var x=a(27),B=a(85),z=a(108),A=a(13),I=a(44),F=a(38),U=a(19),X=a(5),S=a(127),H=a(14),D=a(21),J=a(55);class M extends F.a{constructor(Ua){super();this.ow=this.firstElement=null;this.HLa=!1;this.As=null;this.qvj=x.a.Tf;this.pyf=ab=>{const na=ab.Ca.keyCode;return na===B.a.$h?this.MIi():na===B.a.cA&&ab.Ca.shiftKey?this.Ewh(this.firstElement):!1};this.NDf=ab=>{if(!this.HLa||ab.Ca.keyCode!==
B.a.uL)return!1;M.o7e();J.Task.delay(1).Uo(()=>{this.ow.focus();return!0},0,this.la);return!0};this.vTi=()=>{document.activeElement&&document.activeElement.id===this.ow.id||(M.o7e(),J.Task.delay(1).Uo(()=>{this.ow.focus();return!0},0,this.la))};this.twf=()=>{this.$9f(this.ow)};this.oyf=ab=>{ab.stopPropagation();ab.preventDefault();this.HLa&&(this.HLa=!1)};this.$=Ua;(Ua=this.$.ea.jc)&&f.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${Ua.usa}; InWebPart = '${Ua.inWebPart?"Classic":
"Non Classic"}', InEmbedView = '${Ua.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);Ua&&(Ua.inWebPart||Ua.inEmbedView)?f.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${Ua.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${Ua.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.K5g(),this.J6g(),z.KeyInputManager.instance.ra(A.a.Kb,this.$.domElement,this.NDf));
this.$.da.Ga(238,this)}$Eg(Ua){this.addHandler("KBIS",Ua)}abj(Ua){this.removeHandler("KBIS",Ua)}dispose(){this.firstElement&&I.a.removeHandler(this.firstElement,A.a.focus,this.twf);this.As&&this.As.detach("focus");this.ow&&(I.a.removeHandler(this.ow,A.a.focus,this.oyf),I.a.removeHandler(this.ow,A.a.blur,M.onBlur),z.KeyInputManager.instance.Ba(A.a.Kb,this.ow,this.pyf));z.KeyInputManager.instance.Ba(A.a.Kb,this.$.domElement,this.NDf);this.As=this.ow=this.firstElement=this.$=null;super.dispose()}K5g(){this.qvj?
(this.firstElement=document.documentElement,this.As=S.a.instance.aH(document.parentWindow),this.As.ka("focus",this.vTi)):(this.firstElement=M.zCe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),I.a.addHandler(this.firstElement,A.a.focus,this.twf))}J6g(){this.ow=M.zCe();this.ow.id=X.a.xJe;this.ow.setAttribute(X.a.Mt,H.a.instance.ga(867));document.body.appendChild(this.ow);I.a.addHandler(this.ow,A.a.focus,this.oyf);I.a.addHandler(this.ow,A.a.blur,M.onBlur);z.KeyInputManager.instance.ra(A.a.Kb,
this.ow,this.pyf)}Ewh(Ua){this.$9f(Ua);return!1}MIi(){this.HLa=!0;D.g(this.$).focus();D.g(this.$).ha.s4e();this.raiseEvent("KBIS");return!0}$9f(Ua){this.HLa?this.HLa=!1:(this.HLa=!0,Ua&&Ua.focus())}static zCe(){const Ua=document.createElement("div");Ua.tabIndex=0;return Ua}static o7e(){document.body.classList.add(U.a.XLe)}static onBlur(){document.body.classList.remove(U.a.XLe)}}Object(t.a)(M,"EmbedViewFocusControl",F.a,[627,2]);var G=a(4),T=a(1078),K=a(60),L=a(519),V=a(24),W=a(43),da=a(368),qa=a(170),
O=a(247),ea=a(121),R=a(29),oa=a(281),pa=a(280),Pa=a(61);const Z=(Ua,ab,na,Na,Va,Sa,vb,Oa,yb,Ob,Ja=null)=>{Ja=Ua.Na(1,Ja);Ja.selectedRange=ab;Ja.richValueKeyPath=na;Ja.singleColumn=Na;Ja.searchForRange=Va;Ja.calculateMajorityDataType=Sa;return Pa.g(Ua,"GetRichValueFieldListContextList",Ja,vb,Oa,yb,Ob,4)};var Ra=a(33);class Ga extends F.a{constructor(Ua,ab){super();this.zIb=this.Ucd=this.Jub=this.PO=null;this.ZSb=!1;this.n3d=null;this.iFd=!1;this.jKi=(na,Na,Va)=>{f.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+
Va);this.zIb&&this.zIb.stop();this.PO=null;this.raiseEvent(T.h)};this.kKi=na=>{oa.a(na)||(this.zIb&&this.zIb.stop(),this.ZSb=!1,(this.PO=na.Result)&&0<this.PO.length&&f.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.PO.length} rich value field list context for autocomplete`),this.BVa=!0,this.Qpc())};this.BVa=!1;this.jb=Ua;this.LRb=-1;this.tableManager=ab;this.iFd=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults")&&Ra.a.SU(Ua)}hYb(Ua){this.addHandler(T.a,
Ua)}trc(Ua){this.removeHandler(T.a,Ua)}zEg(Ua){this.addHandler(T.h,Ua)}Iaj(Ua){this.removeHandler(T.h,Ua)}get O5a(){return this.BVa}get vsi(){return this.ZSb}get VTe(){return this.LRb}get L3c(){return this.n3d}get $(){return this.jb}get Qk(){return this.PO}get cNh(){return!!this.Jub}dispose(){this.jb=null;this.qbb();super.dispose()}gYi(){var Ua=Array(6);var ab={};ab.Name=T.f;Ua[0]=ab;ab={};ab.Name=T.c;Ua[1]=ab;ab={};ab.Name=T.d;Ua[2]=ab;ab={};ab.Name=T.g;Ua[3]=ab;ab={};ab.Name=T.e;Ua[4]=ab;ab={};
ab.Name=T.b;Ua[5]=ab;ab={ColumnName:"",ColumnIndex:-1};ab.FieldInfoDataList=Ua;Ua=[];Ua[0]=ab;this.FNd(Ua)}KY(Ua,ab,na,Na=null){if(Ua){this.IYc();this.u0b();var Va=null,Sa=!1;if(!Na&&({f$a:Sa,Qk:Va}=this.OMj(Ua,ab,na)).returnValue)if(this.iFd||this.FNd(Va),this.ZSb=!0,this.PO=Va,this.iFd){if(!Sa){this.BVa=!0;this.Qpc();return}}else if(this.PO&&0<this.PO.length&&(this.BVa=!0,this.Qpc()),!Sa)return;this.Lcg(Ua,Na,ab,na,!1)}}Lcg(Ua,ab,na,Na,Va){if(this.$.ea.fc){this.$.Ib&&(this.zIb=this.$.Ib.Bc("WebServiceCall",
"GetRichValueFieldInfoListContext"));this.Jub=null;var Sa=this.$.oa.va.Sb();this.Jub=Z(this.$.oa.va,Ua,ab,na,Na,Va,this.kKi,this.jKi,null,Sa)}else this.PO=null}qbb(){this.PO=null;this.BVa=!1;this.IYc();this.u0b();this.Jub=null;this.LRb=-1}IYc(){Ga.Yob(this.Jub)}u0b(){Ga.Yob(this.Ucd)}Qpc(){this.raiseEvent(T.a)}Fm(Ua){Ua=W.D(Ua);--Ua.left;--Ua.right;return this.tableManager.Fm(Ua)}zJa(Ua){Ua.FirstColumn=Ua.FirstColumn;Ua.LastColumn=Ua.LastColumn;Ua.FirstRow=Ua.FirstRow;Ua.LastRow=Ua.LastRow;this.u0b();
this.Ucd=null;return da.a(this.$.userOperationManager,(ab,na,Na)=>O.h(this.$.oa.va,Ua,pa.b(ab,Va=>{this.uKi(Va)}),pa.a(na,na,Va=>{this.tKi(Va)}),Na,null),ab=>new qa.a(264,0,ab,80),null)}tKi(Ua){Ua=ea.a.lf(Ua.data);f.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${R.a.yc(Ua)}`)}uKi(Ua){if(oa.a(Ua))-315732528!==Ua.Errors[0].MessageId&&f.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${R.a.yc(Ua.Errors)}`);
else if(Ua&&Ua.Result){Ua=Ua.Result;var ab=Ua.HasHeaderRow;ab=new L.AutofilterRange(Ua.TableRange.FirstRow+(ab?1:0)+1,Ua.TableRange.FirstColumn+1,Ua.TableRange.LastRow+1,Ua.TableRange.LastColumn+1,null,null,null,0,ab);this.LRb=Ua.TableRange.FirstColumn;(Ua=this.XIf(!1,!0,ab))||f.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.FNd(Ua)}else f.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}OMj(Ua,
ab,na){let Na,Va;Va=null;Na=!1;if(Ua.SheetName!==this.$.ea.pa.sheetName)return{returnValue:!1,f$a:Na,zJa:!1,Qk:Va};let Sa;this.LRb=-1;if(na){Sa=this.Fm(Ua);if(!Sa||!Sa.yaa)return{returnValue:!1,f$a:Na,zJa:!1,Qk:Va};var vb=D.g(this.$).Db.M0e(Sa);this.n3d=Sa;if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&vb&&0<vb.count)return--Ua.FirstColumn,--Ua.LastColumn,this.Ucd=this.zJa(Ua),{returnValue:!0,f$a:Na,zJa:!0,Qk:Va};Sa.top+=1;
Sa.right=W.D(Ua).right-1}else Sa=new L.AutofilterRange(Ua.FirstRow+1,Ua.FirstColumn+1,Ua.LastRow+1,Ua.LastColumn+1,null,null,null,0,!1);if(Sa.top>Sa.bottom||Sa.left>Sa.right)return{returnValue:!0,f$a:Na,zJa:!1,Qk:Va};Ua=D.g(this.$);var Oa=Ua.ib.width,yb=Ua.ib.height;vb=Ua.view.visibleArea;Oa=new K.a(vb.x-Oa,vb.y-yb,vb.width+Oa,vb.height+yb);yb=Ua.mg(Sa);if(!vb||!yb||!Ua.vgc(Sa))return{returnValue:!1,f$a:Na,zJa:!1,Qk:Va};Oa.contains(yb)||(Na=!0);Va=this.XIf(ab,na,Sa);return{returnValue:!0,f$a:Na,zJa:!1,
Qk:Va}}FNd(Ua){Ua&&f.ULS.sendTraceTag(25264348,0,50,`Retrieved ${Ua.length} rich value field contexts from block cache`);this.ZSb=!0;(this.PO=Ua)&&0<this.PO.length&&(this.BVa=!0,this.Qpc())}XIf(Ua,ab,na){let Na;Na=null;const Va=na.clone();if(ab)for(let Sa=na.right,vb=0;Sa>=na.left;--Sa){if(Va.left=Sa,Va.right=Sa,ab=this.LXe(Va,!0,na.left)){Na||(Na=[]);Na[vb]=ab;if(Ua)break;++vb}}else if(Ua=this.LXe(Va,!1))Na=[],Na[0]=Ua;return Na}LXe(Ua,ab,na=0){var Na=null;if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var Va=
D.g(this.$).Db.lVh(Ua);if(Va&&0<Va.count){var Sa=Array(Va.count);Na=0;for(var vb of Va.values)Va={},Va.Name=vb,Sa[Na]=Va,++Na;vb="";Va=-1;0<Ua.top&&ab&&(Ua=new V.Range(Ua.top-1,Ua.left,Ua.top-1,Ua.left,!1,!1),null!=D.g(this.$).Vb(Ua)&&null!=D.g(this.$).Vb(Ua).originalText&&(vb=D.g(this.$).Vb(Ua).originalText),Va=Ua.left-na);Na={};Na.ColumnName=vb;Na.ColumnIndex=Va;Na.FieldInfoDataList=Sa}}else if((vb=D.g(this.$).Db.M0e(Ua))&&0<vb.count){Sa=Array(vb.count);Na=0;for(Va of vb)vb={},vb.Name=Va,Sa[Na]=
vb,++Na;vb="";Va=-1;0<Ua.top&&ab&&(Ua=new V.Range(Ua.top-1,Ua.left,Ua.top-1,Ua.left,!1,!1),vb=D.g(this.$).Vb(Ua).originalText,Va=Ua.left-na);Na={};Na.ColumnName=vb;Na.ColumnIndex=Va;Na.FieldInfoDataList=Sa}return Na}static Yob(Ua){Ua&&G.AFrameworkApplication.vd.tu(Ua.Nt)}}Object(t.a)(Ga,"FieldInfoManager",F.a,[460,2]);class Ba extends Ga{constructor(Ua,ab,na,Na){super(Ua,ab);this.o1a=null;this.nwf=()=>{this.trc(this.nwf);if(this.Qk&&this.Qk.length&&this.contextMenuManager){var Va=this.contextMenuManager.lcd("autoFilterRichFieldList"),
Sa=window.document.getElementById(this.o1a);Va.b0(null,Sa,this,null,!0)}};this.Wkg=na;this.contextMenuManager=Na}get TG(){return this.Wkg}mNh(Ua,ab){this.o1a=ab;f.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${Ua.FirstRow}, ${Ua.FirstColumn}, ${Ua.LastRow}, ${Ua.LastColumn})`);this.Lcg(Ua,null,!0,!1,!0)}}Object(t.a)(Ba,"FilterInfoManager",Ga,[462,460,2]);var fa=a(835),Y=a(1089),ja=a(30),ca=
a(86),aa=a(8);class ta{}ta.Cqh="ewa-sharedUi-launchButton";ta.Fqh="ewa-sharedUi-launchButtonWithText";ta.Dqh="ewa-sharedUi-launchButtonClick";ta.Gqh="ewa-sharedUi-launchButtonWithTextClick";ta.Eqh="ewa-sharedUi-launchButtonText";Object(t.a)(ta,"CssClassNames",null,[]);var xa=a(65);a(514);var ia=a(236),ya=a(222);F=a(235);var ib=a(284),wa=a(71),sa=a(11),Ya=a(250),bb=a(34);class mb extends F.a{constructor(Ua,ab,na,Na,Va,Sa,vb,Oa){super(document.createElement("div"));this.Rif=null;this.JRd=!1;this.zMb=
this.TRa=null;this.xN=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.wN=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.vBj=()=>{this.Zie()};this.ed=yb=>{this.raiseEvent(this.LFb,yb);this.JFb();return!0};this.sIi=yb=>{100<r.a(w.a.Wa,this.Rif)&&this.Xgd(new Sys.UI.Point(Math.round(yb.clientX),Math.round(yb.clientY)))};this.rN=yb=>{wa.g(yb.Ca,!1);return!1};this.qY=this.ue.eHa();this.set_visible(!1);this.Ugc=Va;this.LFb=Sa;this.Okc=Ua;this.r1b=ab;this.Ugc&&(this.TRa=m.a.instance.create(this.vBj,
3E4,"OnObjectButton.ShyTimerFired",!1,!1));Ua&&this.domElement.classList.add(Ua);this.IZa=document.createElement("div");this.domElement.appendChild(this.IZa);na&&this.IZa.classList.add(na);Na&&(this.IZa.innerHTML=Na);vb&&(this.zMb=document.createElement("div"),this.domElement.appendChild(this.zMb),this.zMb.classList.add(Oa),this.zMb.innerText=vb,this.domElement.style.padding="3px",ia.a.instance.ra(A.a.pointerDown,this.domElement,this.rN));this.yZa=new ib.a(this.domElement,7);ya.a.instance.ra(A.a.click,
this.domElement,this.ed);d.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&ia.a.instance.ra(A.a.pointerDown,this.domElement,this.rN);Ua=yb=>{wa.g(yb)};this.Gc.ka("mouseup",Ua);this.Gc.ka("click",Ua);this.Gc.ka("dblclick",Ua)}J1(Ua){this.addHandler(this.LFb,Ua)}Nca(Ua){this.get_events().removeHandler(this.LFb,Ua)}qFg(Ua){this.addHandler("OnObjectButtonMouseOver",Ua)}pbj(Ua){this.get_events().removeHandler("OnObjectButtonMouseOver",Ua)}pFg(Ua){this.addHandler("OnObjectButtonMouseOut",
Ua)}obj(Ua){this.get_events().removeHandler("OnObjectButtonMouseOut",Ua)}Sbg(Ua){Ua&&(this.IZa.innerHTML=Ua)}fQj(Ua,ab,na){this.IZa.innerHTML="";Ua?Ua.Jaa(ab,16,16,this.IZa,16,16,void 0,na):f.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}gQj(Ua,ab){Ua&&(this.zMb.innerText=Ua);this.domElement.title=ab}dispose(){this.get_isInitialized()&&(this.hide(),this.Gc.JC(),ca.a.qc([this.qY,this.yZa]),ya.a.instance.Ba(A.a.click,this.domElement,this.ed),
ia.a.instance.Ba(A.a.pointerDown,this.domElement,this.rN),this.TRa&&this.TRa.dispose(),super.dispose())}obb(){this.r1b&&this.domElement.classList.remove(this.r1b);this.Okc&&this.domElement.classList.add(this.Okc)}JFb(){this.Okc&&this.domElement.classList.remove(this.Okc);this.r1b&&this.domElement.classList.add(this.r1b);this.C1a()}C1a(){this.Ugc&&(this.TRa.cancel(),this.U5f(),this.setOpacity(1));this.set_visible(!0)}Bp(Ua,ab,na,Na,Va=!1){Ua=bb.a(Na).si(Ua);ab=bb.a(Na).si(ab);bb.a(Na).gvc(this.domElement);
this.domElement.style.top=sa.HelperMethods.pc(ab);this.domElement.style.left=this.domElement.style.right="";ab=Ua;Va&&(ab=Ua-this.domElement.offsetWidth);Ya.c(this.domElement.style,na,sa.HelperMethods.pc(ab));this.set_visible(!0);this.setOpacity(1);this.Ugc&&(this.JRd=!1,this.kEj(),this.TRa.Rq())}hide(){this.obb();this.set_visible(!1);this.Ugc&&(this.U5f(),this.TRa.cancel())}u6b(){this.Gc.ka("mouseover",this.xN,!0);this.Gc.ka("mouseout",this.wN,!0)}kEj(){this.qY.ln("mousemove")||this.qY.ka("mousemove",
this.sIi)}U5f(){this.qY.ln("mousemove")&&this.qY.detach("mousemove")}Xgd(Ua){if(this.domElement.parentNode){var ab=Sys.UI.DomElement.getBounds(this.domElement);const na=new Sys.UI.Point(Math.round(ab.x+ab.width),Math.round(ab.y+ab.height));ab=Math.abs(na.x-Ua.x);Ua=Math.abs(na.y-Ua.y);Ua=ab>Ua?ab:Ua;this.JRd?this.setOpacity(mb.fTg(Ua)):100>=Ua&&this.Zie()}}Zie(){this.JRd=!0;this.TRa.cancel()}setOpacity(Ua){x.a.setOpacity(this.domElement,Ua);this.Rif=w.a.Wa.Nb}static fTg(Ua){return 100>=Ua?1:250<=
Ua?0:.01*(100-(Ua-100)/150*100)}}Object(t.a)(mb,"OnObjectButton",F.a,[650,222,2]);var Ca=a(786);const $a=ta.Eqh;class Kb extends k.a{constructor(Ua,ab,na,Na,Va,Sa,vb,Oa=""){super();this.Jva=null;this.V7e=!1;this.lkc=this.mkc=null;this.buttons={};this.hLe={};this.$=Ua;this.svgIconProvider=ab;this.OGi=na;this.cdc=Na;this.bdc=Va;this.altText=Sa;this.LFb=vb;this.buttonText=Oa}get jz(){return bb.a(this.$).wFa(aa.a.qOi)}get T0b(){return aa.a.pOi}get buttonWidth(){return bb.a(this.$).wFa(aa.a.rOi)}dispose(){this.Nfh();
this.$=null;super.dispose()}getButton(Ua,ab=!0){return this.yua(Ua,ab)}yua(Ua,ab=!0){const na=Ua.toString();na in this.buttons||this.L6g(Ua,ab);return this.buttons[na]}Bp(Ua,ab,na,Na,Va=!0,Sa=!1){this.hide();if(this.$.ea.isNamedObjectViewMode&&xa.i(this.$.pa)){var vb=D.g(this.$).BR.domElement;const Oa=Ua+this.buttonWidth-vb.scrollWidth;vb=ab+this.buttonWidth-vb.scrollHeight;Ua=0<Oa?Ua-Oa:Ua;ab=0<vb?ab-vb:ab}this.yua(Na,Va).Bp(Ua,ab,na,this.$,Sa)}hide(){const Ua=this.buttons;for(let ab in Ua)Ua[ab].hide()}u6b(Ua,
ab){!this.V7e&&(ab=this.buttons[ab.toString()])&&(this.mkc=(na,Na)=>{Ua(Na,!0)},ab.qFg(this.mkc),this.lkc=(na,Na)=>{Ua(Na,!1)},ab.pFg(this.lkc),this.V7e=!0,ab.u6b())}L6g(Ua,ab){this.Jva=String.format(this.cdc===U.a.j7b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',ja.a.Eg(this.cdc),ja.a.Eg(this.bdc),"{0}");var na=String.format(this.Jva,ja.a.Eg(this.altText));ab=new mb(""===this.buttonText?
ta.Cqh:ta.Fqh,""===this.buttonText?ta.Dqh:ta.Gqh,U.a.PA,na,ab,this.LFb,this.buttonText,$a);na=(Na,Va)=>{this.OGi(Va,Ua)};ab.J1(na);this.buttons[Ua.toString()]=ab;this.hLe[Ua.toString()]=na;na=D.g(this.$).Lf(Ua);na.domElement.insertBefore(ab.domElement,na.domElement.firstChild)}Nfh(){for(const Ua of Ca.a(this.buttons)){const ab=this.buttons[Ua];ab.Nca(this.hLe[Ua]);ca.a.Ia(ab);delete this.buttons[Ua];this.mkc&&ab.pbj(this.mkc);this.lkc&&ab.obj(this.lkc)}}domElement(Ua){return this.yua(Ua).domElement}C1a(Ua){this.yua(Ua).C1a()}Jcg(Ua,
ab){this.cdc=Ua;this.bdc=ab}ZNb(Ua,ab,na=!0){this.Jva=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',ja.a.Eg(this.cdc),ja.a.Eg(this.bdc),"{0}");Ua=String.format(this.Jva,ja.a.Eg(Ua));this.yua(ab,na).Sbg(Ua)}pTa(Ua,ab,na){this.yua(na,!1).gQj(Ua,ab)}Hcg(){this.Jva=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",ja.a.Eg(this.bdc),"{1}");const Ua=String.format(this.Jva,void 0,
ja.a.Eg(void 0));this.yua(void 0,!1).Sbg(Ua)}Icg(Ua,ab,na){this.yua(na,!1).fQj(this.svgIconProvider,Ua,ab)}}Object(t.a)(Kb,"OnObjectLaunchButton",k.a,[626,2]);k=a(93);class rb extends k.a{constructor(Ua,ab){super(Ua);this.pBb=null;this.xfh=()=>{this.display()};this.Y7h=Math.max(1,ab)}dispose(){ca.a.Ia(this.pBb);this.pBb=null;super.dispose()}hSa(){ca.a.Ia(this.pBb);this.pBb=m.a.instance.create(this.xfh,this.Y7h,v.a.zsi)}nSa(){ca.a.Ia(this.pBb);this.hide()}}Object(t.a)(rb,"LoadingIndicatorBehavior",
k.a,[606,2]);class cc extends rb{constructor(Ua,ab,na,Na){super(Ua,ab);this.oBb=null;this.tng=na;this.g5h=Na;this.bBg()}dispose(){this.oBb=null;super.dispose()}display(){this.tng(this.oBb)}hide(){this.g5h(this.oBb)}bBg(){this.oBb=document.createElement("div");this.domElement.appendChild(this.oBb)}}Object(t.a)(cc,"ShimmerLoadingIndicatorBehavior",rb,[]);var nc=a(72),Wb=a(54),Ea=a(12);class ua extends rb{constructor(Ua,ab,na=null,Na=null,Va=0){super(Ua,ab);this.bNa=null;this.hdc=na||Wb.a.current.Rn(104);
this.Akf=Va;this.O3c=Na;this.aBg()}dispose(){this.bNa=null;super.dispose()}display(){Ea.DOMElementExtensions.setVisible(this.bNa,!0)}hide(){Ea.DOMElementExtensions.setVisible(this.bNa,!1)}aBg(){this.bNa=document.createElement("div");this.bNa.classList.add(nc.a.dph);const Ua=document.createElement("div");Ua.classList.add(nc.a.eph);this.O3c&&""!=this.O3c&&Ua.classList.add(this.O3c);const ab=0===this.Akf?"":H.a.instance.ga(this.Akf),na=String.format('<div class="'+nc.a.fph+'">{0}</div>',ab);Ua.innerHTML=
this.hdc?`<img src="${this.hdc}" alt="${ab}" title="${ab}"/>`+na:na;this.bNa.appendChild(Ua);this.domElement.appendChild(this.bNa)}}Object(t.a)(ua,"SpinnerLoadingIndicatorBehavior",rb,[]);class ma{Q2c(Ua,ab,na){return new fa.a(Ua,ab,na)}r3b(Ua,ab,na,Na,Va,Sa,vb,Oa,yb,Ob){return new Y.a(Ua,ab,na,Na,Va,Sa,vb,Oa,yb,Ob)}Rqb(Ua,ab,na,Na,Va=0){return new ua(Ua,ab,na,Na,Va)}ued(Ua){return Ua.da.za(238)||new M(Ua)}u3b(Ua,ab,na,Na,Va,Sa,vb,Oa=""){return new Kb(Ua,ab,na,Na,Va,Sa,vb,Oa)}s2c(Ua,ab){return new Ga(Ua,
ab)}F5g(Ua,ab,na,Na){return new Ba(Ua,ab,na,Na)}Z1c(Ua,ab,na,Na){return new y(Ua,ab,na,Na)}}Object(t.a)(ma,"SharedUIControlsFactory",null,[547]);class fb extends b.a{constructor(Ua){super();this.$=Ua;this.Fb()}create(){d.EwaSettings.fl()?this.qb(this.$.da.za(12)||new ma):this.qb(new ma)}static ka(Ua){Ua.da.Ga(477,new fb(Ua))}}Object(t.a)(fb,"SharedUIControlsFactoryServiceFactory",b.a,[]);a.d(C,"a",function(){return sb});const sb=()=>{c.a.Fa(fb.ka)}},1160:function(t,C,a){var c=a(10);t=a(0);var b=a(221),
d=a(50),f=a(37),e=a(1),k=a(804);class l extends b.a{constructor(Ja){super();this.$=Ja;this.Fb()}create(){const Ja=d.GetServiceTaskFactory.create(this.$.da,18,this.la,this.hb),lb=d.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb);f.TaskExtensions.Aa(f.TaskExtensions.Wd([Ja,lb],this.la),()=>{this.qb(this.$.da.za(296)||this.$.da.Ga(296,new k.BorderFormatManager(this.$,Ja.result,lb.result)))},this.la,3)}static ka(Ja){e.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&
Ja.da.Ga(468,new l(Ja))}}Object(t.a)(l,"BorderFormatManagerFactory",b.a,[]);var m=a(691),v=a(15),n=a(262),w=a(172),r=a(819),u=a(27),y=a(39),x=a(30),B=a(94),z=a(259),A=a(350),I=a(346),F=a(98),U=a(185),X=a(8),S;(function(Ja){Ja[Ja.insert=1]="insert";Ja[Ja.delete=2]="delete";Ja[Ja.rows=4]="rows";Ja[Ja.columns=8]="columns";Ja[Ja.cellsShiftHorizontal=16]="cellsShiftHorizontal";Ja[Ja.cellsShiftVertical=32]="cellsShiftVertical";Ja[Ja.insertRows=5]="insertRows";Ja[Ja.insertColumns=9]="insertColumns";Ja[Ja.insertCellsShiftRight=
17]="insertCellsShiftRight";Ja[Ja.insertCellsShiftDown=33]="insertCellsShiftDown";Ja[Ja.deleteRows=6]="deleteRows";Ja[Ja.deleteColumns=10]="deleteColumns";Ja[Ja.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";Ja[Ja.deleteCellsShiftUp=34]="deleteCellsShiftUp";Ja[Ja.insertRowsBelow=37]="insertRowsBelow"})(S||(S={}));Object(t.b)("InsertDeleteCellFlags",S);var H=a(5),D=a(419),J=a(65),M=a(77);class G{constructor(Ja){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=Ja}}Object(t.a)(G,
"MacroRecorderRangeInsertedOrDeletedPayload",null,[101]);var T=a(1076),K=a(43),L=a(513),V=a(368),W=a(170),da=a(61),qa=a(247),O=a(145),ea=a(453),R=a(113),oa=a(54),pa=a(197),Pa=a(90),Z=a(35),Ra=a(29),Ga=a(281),Ba=a(256),fa=a(11),Y=a(182),ja=a(22),ca=a(280);class aa{constructor(Ja,lb,Pb,Jb,Lb=0){this.Cog=Ja;this.Dog=lb;this.qwg=Pb;this.IVb=Jb;this.WBh=Lb}get Bia(){return this.Cog}get Bh(){return this.Dog}get style(){return this.qwg}get size(){return this.IVb}get FY(){return this.WBh}static JQg(Ja,lb){return new aa(Ja,
lb,null,null,null)}static IXc(Ja,lb){return new aa(Ja,null,lb,null,null)}static KQg(Ja,lb){return new aa(Ja,null,null,lb,null)}static IQg(Ja,lb,Pb){return new aa(Ja,null,lb,null,Pb)}}Object(t.a)(aa,"CachedPreviewCellGroup",null,[]);var ta=a(84);b=a(282);var xa=a(100),ia=a(14);class ya extends b.a{constructor(Ja,lb,Pb){super(Ja);this.Gl=null;this.n5c=0;this.Yai=(Jb,Lb)=>{if(0===Jb)v.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");else{Jb=
{};var Ab="",nb=1035996630;switch(Lb.selectedKey){case 0:Ab=1896159024===this.tr?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:Ab=1896159024===this.tr?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===this.tr?(Ab="InsertRows",nb=-1113896058):(Ab="DeleteRows",nb=1554436520);break;case 3:1896159024===this.tr?(Ab="InsertColumns",nb=1415868706):(Ab="DeleteColumns",nb=674605324)}v.ULS.sendTraceTag(574993490,0,50,`InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:${Ab}`);
Lb=new Pa.a(nb,1,2,8,null);Jb[M.a.Pc]=Ab;this.$.Ka.Mb(Lb,Jb)}};this.tr=lb;this.selectedRanges=Pb;this.isRtl=Object(ta.a)(xa.a,this.$.xa.pa).displayRtl}get oc(){return"InsertDeleteCellsDialog"}vg(){1896159024===this.tr?(this.Gl=ia.a.instance.ga(23),this.n5c=0):(this.Gl=ia.a.instance.ga(22),this.n5c=1);const Ja=this.selectedRanges[0].xZ&&!this.selectedRanges[0].D4?0:1;this.Rb=1;this.initializeAndShow(this.Gl,this.Yai,{[ya.Tu]:this.oc,["dialogToDisplay"]:this.n5c,["defaultSelectedKey"]:Ja,["isRtl"]:this.isRtl})}}
Object(t.a)(ya,"InsertDeleteCellsDialog",b.a,[]);const ib=(Ja,lb,Pb,Jb,Lb,Ab,nb=null)=>{nb=Ja.Na(41,nb);nb.insertDeleteMultiRangeParameters=lb;return da.g(Ja,"InsertDeleteCells",nb,Pb,Jb,Lb,Ab,0)};class wa{constructor(Ja,lb,Pb,Jb){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=Ja;this.targetSheetRange=lb;this.fillRangeType=Pb;this.fillRangeDirection=Jb}}Object(t.a)(wa,"MacroRecorderRangeFilledPayload",null,[101]);var sa=a(7),Ya=
a(24);class bb{constructor(){this.nQa=this.VFa=this.QMa=this.TSa=0}}Object(t.a)(bb,"RangeBorders",null,[]);class mb{constructor(){this.scenario=0;this.$P=null}}Object(t.a)(mb,"ScenarioInfo",null,[]);var Ca=a(906),$a=a(21),Kb=a(261),rb=a(209),cc=a(79);class nc{constructor(Ja,lb){this.$=Ja;this.ug=lb;this.nx=new Ca.a($a.g(this.$).Ea,this.$);this.$ef=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5412627_MergeCellRangeBorderScenariosTelemetry");this.cyb=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");
this.Qnd=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");this.Jfc=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.Wcf=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");this.ufi=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix");this.ahf=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",
!1);this.ugc=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6147046_MergeCellCSERangeBorderScenarioFix");this.Tyb=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellMultipleBlocksScenarioCse",!1);this.Kfc=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1);this.Bii=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6327711_MergeCellMultiBlockUnmergeBitFix");this.Bfi=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6350260_MergeCellCSEDataLossScenarioUnmergeConditionFix");
this.Taf=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6209366_MergeCellCSECellFormatAssertFix");this.Tcf=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6402649_HiddenCellsAvoidCseFixEnabled");this.Sii=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6476102_MergeCellCSEMultiBlockMergeFlagsFix");this.Zni=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6665369_MergeCellCSEWrapTextFixForUnmergeScenarios")}dispose(){this.$=null}Afi(Ja,lb){return!(void 0===lb||null===lb)&&!!(lb.scenario&16384)&&!this.Cfi(Ja,lb)&&
this.Maf(lb,Ja)}DZe(){var Ja=y.a.Sd(),lb=$a.g(this.$),Pb=lb.ha.sa.selectedRanges;let Jb=0;var Lb=0,Ab=Pb.length;const nb=new mb;if(1<Ab)return nb.scenario=4,nb;if(this.Tcf&&lb.Yd.bgc(Pb[0]))return nb.scenario=262144,nb;this.Qnd&&$a.g(this.$).rtl&&(Jb|=65536);if(!lb.nK(Pb[0]))if(this.cyb)Jb|=32;else return nb.scenario=32,nb;if(lb=lb.Ea.HJa(Pb[0],this.$.activeItemName)){nb.cXc=lb;for(var va of lb)if(Lb+=1,1<Lb){this.cyb?(Jb|=256,nb.scenario=Jb):nb.scenario=256;if(!this.Tyb)return nb;break}}Lb=$a.g(this.$).Ea.Nia(Pb[0]);
if(!Lb)return nb.scenario=32768,nb;va=Lb.length;Pb=Pb[0];lb=Pb.bottom-Pb.top+1;Ab=Pb.right-Pb.left+1;const db=new bb;for(let Xa=0;Xa<va;Xa++)if(this.$ef&&this.cUh(Lb[Xa],Pb,db),Jb=Jb|(void 0!==Lb[Xa].text&&null!==Lb[Xa].text&&""!==Lb[Xa].text?1:0)|(Lb[Xa].tF?2:0)|(Lb[Xa].pva?8:0)|(Lb[Xa].hwb?16:0)|(Lb[Xa].gF?64:0)|(Lb[Xa].vaa?128:0),void 0!==Lb[Xa].text&&null!==Lb[Xa].text&&""!==Lb[Xa].text||Lb[Xa].pva)if(void 0===nb.$P||null===nb.$P)nb.$P=$a.g(this.$).Vb(Lb[Xa].getRange());else{if(Lb[Xa].getRange().top<
nb.$P.range.top||Lb[Xa].getRange().top==nb.$P.range.top&&Lb[Xa].getRange().left<nb.$P.range.left)nb.$P=$a.g(this.$).Vb(Lb[Xa].getRange());Jb|=16384}this.$ef&&(db.TSa===Ab&&(Jb|=512),db.VFa===Ab&&(Jb|=2048),db.QMa===lb&&(Jb|=4096),db.nQa===lb&&(Jb|=1024),0<db.TSa&&db.TSa<Ab||0<db.VFa&&db.VFa<Ab||0<db.QMa&&db.QMa<lb||0<db.nQa&&db.nQa<lb)&&(Jb|=8192);!e.EwaSettings.isChangeGateEnabled("OfficeVSO:6217608_Add_Entire_Row_Column_Selection_flag")||Pb.right!==Pb.maxColumns&&Pb.bottom!==Pb.maxRows||(Jb|=131072);
Ja=y.a.Sd()-Ja;v.ULS.sendTraceTag(537159424,0,50,`Execution time of GetMergeCellScenario is : ${Ja}`);nb.scenario=Jb;return nb}lpf(Ja,lb){const Pb=Ja.command;if(void 0===lb||null===lb)lb=this.DZe();if(!this.Maf(lb,Pb))return!1;Ja=$a.g(this.$).ha.sa.selectedRanges;var Jb=$a.g(this.$).Ea.Nia(Ja[0]);if(!Jb)return!1;if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===Jb.length&&!Jb[0].tF)return-167499203===Pb?(Jb[0].V_(2,!0),!0):!1;Jb=$a.g(this.$).ha.sa.Xr;const Lb=
this.$.pa.sheetName;let Ab=!0;switch(Pb){case -167499203:2===(lb.scenario&2)&&this.Jfc?this.Uag(lb.scenario,Ja,Pb):Ab=this.mzi(lb,Ja);break;case 1097660126:(lb=this.mpf(lb,Ja))&&0!=lb.length||(Ab=!1);break;case 155820588:this.Uag(lb.scenario,Ja,Pb);break;default:return!1}$a.g(this.$).WY(Ja,Jb,Lb,null,Ja[0],null,null,0,"MergeCellCommandAction");return this.Tyb?Ab:!0}Maf(Ja,lb){const Pb=this.mei(Ja,lb);if(!this.Wcf)return Pb;const Jb=$a.g(this.$).ha.sa.selectedRanges[0].hz(!1);v.ULS.sendTraceTag(526149324,
0,50,`Merge Cell Command: ${lb.toString()}; Scenario Number: ${Ja.scenario}; IsCSEPossible result: ${Pb}; Range: ${Jb}`);return Pb}mei(Ja,lb){if(-255094134===lb)return!1;var Pb=Ja.scenario;if(this.Tcf&&262144===Pb||this.Qnd&&65536===(Pb&65536))return!1;if(this.$gf(lb,Ja))return Pb=$a.g(this.$).ha.sa.selectedRanges,0===Pb.length?!1:this.dni(lb,Ja,Pb[0]);this.cyb&&32===(Pb&32)&&(Pb&=-33);if(256==(Pb&256))if(this.Rii(Ja))Pb&=-257;else return!1;return 32768===Pb||4===Pb||128===(Pb&128)||!this.cyb&&32===
Pb?!1:-167499203!=lb&&1097660126!==lb||!this.Bld(Ja)?void 0!==Ja.$P&&null!==Ja.$P&&Ja.$P.s7?!1:0===Pb?!0:16384===(Pb&16384)?e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(Pb&1)&&8!==(Pb&8)||!e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:this.Kfc}ngi(Ja){return 131072===(Ja.scenario&131072)?!0:!1}Rii(Ja){if(!this.Tyb)return!1;let lb="Multi block",Pb=!0;this.Bld(Ja)&&(lb+=" with border",Pb=!1);this.ngi(Ja)&&
(Pb=!1,lb+=" with entire row or column selected",16384===(Ja.scenario&16384)&&(lb+=" and a data loss scenario"));Pb||v.ULS.sendTraceTag(523511383,0,50,`CSE for ${lb}, is not enabled`);return Pb}Bld(Ja){return 16===(Ja.scenario&16)||this.whd(Ja.scenario)||this.Qhd(Ja.scenario)||this.Hhd(Ja.scenario)||this.Shd(Ja.scenario)||8192===(Ja.scenario&8192)?!0:!1}Cfi(Ja,lb){return this.Bfi?this.$gf(Ja,lb):155820588===Ja}$gf(Ja,lb){return 155820588===Ja||(-167499203===Ja||1097660126===Ja)&&2===(lb.scenario&
2)&&this.Jfc?!0:!1}cni(Ja){return this.Shd(Ja.scenario)||this.Hhd(Ja.scenario)||this.whd(Ja.scenario)||this.Qhd(Ja.scenario)?!0:!1}g4h(Ja){Ja=$a.g(this.$).Ea.Nia(Ja);if(!Ja||0===Ja.length)return!1;for(let lb=0;lb<Ja.length;lb++)if(Ja[lb].tF&&Ja[lb].s7)return!0;return!1}dni(Ja,lb,Pb){if(1097660126===Ja&&2===(lb.scenario&2))return!1;if(this.Zni){if(this.g4h(Pb))return!1}else if(this.ufi&&void 0!==lb.$P&&null!==lb.$P&&lb.$P.s7)return!1;this.cyb&&32===(lb.scenario&32)&&(lb.scenario&=-33);return 32768===
lb.scenario||4===lb.scenario||256===(lb.scenario&256)&&this.Bii||128===(lb.scenario&128)?!1:2===(lb.scenario&2)?this.cni(lb)?e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1):e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",!1):!1}cUh(Ja,lb,Pb){const Jb=Ja.getRange();if(Jb.top===lb.top)if(Ja.xKa)Pb.TSa+=Jb.right-Jb.left+1;else{var Lb=this.nx.dQ(Jb,0);if(Lb)for(const nb of Lb)nb.sKa&&(Pb.TSa+=
nb.getRange().right-nb.getRange().left+1)}if(Jb.left===lb.left)if(Ja.uKa)Pb.QMa+=Jb.bottom-Jb.top+1;else if(Lb=this.nx.dQ(Jb,2))for(var Ab of Lb)Ab.vKa&&(Pb.QMa+=Ab.getRange().bottom-Ab.getRange().top+1);if(Jb.bottom===lb.bottom)if(Ja.sKa)Pb.VFa+=Jb.right-Jb.left+1;else if(Ab=this.nx.dQ(Jb,1))for(const nb of Ab)nb.xKa&&(Pb.VFa+=nb.getRange().right-nb.getRange().left+1);if(Jb.right===lb.right)if(Ja.vKa)Pb.nQa+=Jb.bottom-Jb.top+1;else if(Ja=this.nx.dQ(Jb,3))for(const nb of Ja)nb.uKa&&(Pb.nQa+=nb.getRange().bottom-
nb.getRange().top+1)}u9i(Ja,lb){for(let Pb of lb.cXc){lb=Ja.Ge(Pb.rf);lb=$a.g(this.$).Ea.Nia(lb);const Jb=lb.length;for(let Lb=1;Lb<Jb;Lb++){const Ab=$a.g(this.$).Vb(lb[Lb].getRange());this.Kfc?Ab.cell.deleteCellFromModel():(Ab.ppb(),Ab.clearFormat(),Ab.cell.v9i());Ab.pHb(!0)}}}ATj(Ja,lb){Ja.backgroundColor=lb.backgroundColor;Ja.color=lb.color}Phg(Ja,lb){return{SpansBlocks:!0,OriginRow:Ja,OriginColumn:lb,IsOrigin:!1,Columns:0,Rows:0,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0}}Lzg(Ja,lb,Pb,Jb,
Lb){Pb=Ja.Ge(Pb.rf);if(!Pb)return v.ULS.sendTraceTag(523547158,0,15,"blockRange(intersection of block's range and the selected range) can't be null as the blocks we are checking are returned as the intersecting blocks"),null;var Ab=new Ya.Range(Ja.top,Ja.left,Pb.top,Pb.left,!1,!1);let nb;Pb.top==Ja.top?nb=0:(Ab.bottom=Pb.top-1,nb=lb.Oed(Ab));Pb.left==Ja.left?Ab=0:(Ab.right=Pb.left-1,Ab=lb.Ped(Ab));lb=this.Phg(Ja.top-1,Ja.left-1);lb.OriginDeltaY=nb;lb.OriginDeltaX=Ab;lb.Rows=Pb.bottom-Pb.top;lb.Columns=
Pb.right-Pb.left;lb.Height=Lb;lb.Width=Jb;Pb.top==Ja.top&&Pb.left==Ja.left&&(lb.IsOrigin=!0);Ja=$a.g(this.$).Vb(Pb.topLeft);Ja.cell.CZf(lb);return Ja}hOd(Ja,lb){let Pb=[];const Jb=$a.g(this.$).Yd;if(!Jb)return Pb;const Lb=Jb.Oed(Ja),Ab=Jb.Ped(Ja);if(lb.cXc)for(const nb of lb.cXc)if(lb=this.Lzg(Ja,Jb,nb,Ab,Lb))Pb.push(lb);else{Pb=[];break}return Pb}cVh(Ja,lb,Pb,Jb){var Lb=Pb.bottom-Pb.top,Ab=Pb.right-Pb.left;let nb=[];const va=Jb.scenario;if(256===(va&256)){if(nb=this.hOd(Pb,Jb),!nb||0==nb.length)return nb}else lb.cell.hOd(Lb,
Ab),nb.push(lb);Lb=this.i2(this.b4(lb),!0,0,va,"merge");if(void 0!==Ja&&null!==Ja)for(const db of nb){Ab=Ja.cell.Bh;const Xa=Object(sa.a)(new Kb.a,{TextRuns:Ab.TextRuns,Fonts:Ab.Fonts});Xa.Text=void 0!==Ja.cell.originalText&&null!==Ja.cell.originalText?Ja.cell.originalText:void 0!==Ja.cell.userInput&&null!==Ja.cell.userInput?Ja.cell.userInput:Ab.Text;Lb=this.i2(this.b4(db),Lb,1,va,"merge");this.ug.MRa(db,Xa,!1,null,!0,"MergeCells",void 0,2);Lb=this.i2(this.b4(db),Lb,2,va,"merge");this.Qnd?db.ypb(Ja):
this.ATj(db,Ja);Lb=this.i2(this.b4(db),Lb,3,va,"merge");db.cell.T2g(Ja.cell);Lb=this.i2(this.b4(db),Lb,4,va,"merge");db.cell.bBc(!1);Lb=this.i2(this.b4(db),Lb,6,va,"merge")}this.u9i(Pb,Jb);this.i2(this.b4(lb),Lb,5,va,"merge");return nb}Hhd(Ja){return 4096===(Ja&4096)}Shd(Ja){return 512===(Ja&512)}whd(Ja){return 2048===(Ja&2048)}Qhd(Ja){return 1024===(Ja&1024)}U9b(Ja,lb){let Pb=null;for(let Jb=0;Jb<Ja.length;Jb++)if(Ja[Jb].BorderPosition===lb){Pb=Ja[Jb];break}return Pb}kQh(Ja,lb){this.ugc?(lb=this.U9b(lb.cell.FM().Borders,
2))&&Ja.push(lb):(lb=lb.cell.FM().Borders,1<lb.length&&(lb=[lb[1]]),Ja=[...lb,...Ja]);return Ja}vYh(Ja,lb){this.ugc?(lb=this.U9b(lb.cell.FM().Borders,0))&&Ja.push(lb):(lb=lb.cell.FM().Borders,1<lb.length&&(lb=[lb[0]]),Ja=[...lb,...Ja]);return Ja}hIh(Ja,lb){lb=this.nx.dQ(lb.cell.getRange(),1);if(!lb||0===lb.length)return Ja;if(this.ugc){if(lb=lb[0].FM().Borders,lb=this.U9b(lb,0))lb.BorderPosition=1,Ja.push(lb)}else{let Pb=[];0<lb.length&&(Pb=lb[0].FM().Borders);Pb[0].BorderPosition=1;Ja=[...Pb,...Ja]}return Ja}mVh(Ja,
lb){lb=this.nx.dQ(lb.cell.getRange(),3);if(!lb||0===lb.length)return Ja;if(this.ugc){if(lb=lb[0].FM().Borders,lb=this.U9b(lb,2))lb.BorderPosition=3,Ja.push(lb)}else{let Pb=[];0<lb.length&&(Pb=lb[0].FM().Borders);Pb[0].BorderPosition=3;Ja=[...Pb,...Ja]}return Ja}dUh(Ja,lb,Pb){this.Hhd(Ja.scenario)&&(lb=this.kQh(lb,Pb));this.Shd(Ja.scenario)&&(lb=this.vYh(lb,Pb));this.whd(Ja.scenario)&&(lb=this.hIh(lb,Pb));this.Qhd(Ja.scenario)&&(lb=this.mVh(lb,Pb));return lb}IY(Ja){if(0===Ja.length)return null;let lb=
[0,0,0,0],Pb=[1,1,1,1],Jb=0;Ja.forEach(function(Ab){let nb=Ab.BorderPosition;Pb[nb]=Ab.BorderLineStyle;let va=new rb.a(Ab.Color.Red,Ab.Color.Green,Ab.Color.Blue);lb[nb]=va.VR();Jb|=fa.HelperMethods.a3a(Ab.BorderPosition)});Ja={};Ja.LineStyle=Pb;Ja.Color=lb;let Lb={};Lb.BorderFormat=Ja;Lb.Border=Jb;return Lb}U_d(Ja,lb,Pb=null){let Jb=[];Jb=null!==Pb?[...Pb]:this.dUh(lb,Jb,Ja);if(lb=this.IY(Jb))Ja.cell.Hab(Ja.cell.getRange()),this.nx.oHb(Ja.cell.getRange()),this.ug.wda($a.g(this.$),-1690267012,lb,!1,
null,[Ja.cell.getRange()])}aki(Ja){return 512===(Ja.scenario&512)||4096===(Ja.scenario&4096)||1024===(Ja.scenario&1024)||2048===(Ja.scenario&2048)?!0:!1}wYh(Ja){Ja=this.nx.dQ(Ja.cell.getRange(),1);return Ja&&0!==Ja.length?Ja[0].xKa?(Ja=Ja[0].FM().Borders[0],Ja.BorderPosition=1,Ja):null:null}xYh(Ja){Ja=this.nx.dQ(Ja.cell.getRange(),3);return Ja&&0!==Ja.length?Ja[0].uKa?(Ja=Ja[0].FM().Borders[0],Ja.BorderPosition=3,Ja):null:null}a2h(Ja,lb,Pb,Jb,Lb){lb.cell.Tcg();if(this.aki(Ja))this.U_d(lb,Ja);else{const Ab=
8192===(Ja.scenario&8192),nb=lb.cell.getRange();Ab&&this.Taf?(lb.cell.Hab(),this.nx.oHb(nb)):Lb?(Lb=[],null!==Pb&&Lb.push(Pb),null!==Jb&&Lb.push(Jb),0<Lb.length?this.U_d(lb,Ja,Lb):(lb.cell.Hab(),this.nx.oHb(nb))):Ab&&!this.Taf&&(lb.cell.Hab(),this.nx.oHb(nb))}}FPh(Ja,lb){return null===Ja||void 0===Ja?!0:Ja.cell.getRange().top===lb.topLeft.top&&Ja.cell.getRange().left===lb.topLeft.left&&Ja.cell.getRange().bottom===lb.topLeft.bottom&&Ja.cell.getRange().right===lb.topLeft.right?!0:!1}mzi(Ja,lb){lb=this.mpf(Ja,
lb);if(this.Tyb&&(!lb||0==lb.length))return!1;for(let Pb=0;Pb<lb.length;Pb++)lb[Pb].V_(2,!0),this.i2(this.b4(lb[Pb]),!0,8,Ja.scenario,"merge");return!0}YRj(Ja){const lb=$a.g(this.$).Ea.HJa(Ja,this.$.activeItemName);if(lb&&cc.Ct(lb))for(let Pb of lb)Pb.KXd(Ja,!0)}mpf(Ja,lb){const Pb=Ja.$P,Jb=$a.g(this.$).Vb(lb[0]);let Lb=null,Ab=null;this.Kfc&&(Lb=this.wYh(Jb),Ab=this.xYh(Jb));const nb=this.cVh(Pb,Jb,lb[0],Ja);if(this.Tyb&&(!nb||0==nb.length))return nb;this.Sii?this.YRj(lb[0]):$a.g(this.$).Ea.z9(lb[0],
this.$.activeItemName).KXd(lb[0],!0);this.i2(this.b4(Jb),!0,9,Ja.scenario,"merge");if(this.Kfc&&this.Bld(Ja)){lb=this.FPh(Pb,lb[0]);for(const va of nb)this.a2h(Ja,va,Lb,Ab,lb)}return nb}WJg(Ja,lb,Pb){if(!(1>Ja.Borders.length)){var Jb=this.IY(Ja.Borders);Pb.forEach(Lb=>{Lb=$a.g(this.$).Vb(Lb.getRange());this.ug.U2f(-1690267012,Lb,Jb,!1,null,!1,lb)})}}COj(Ja,lb,Pb){const Jb=Ja.length;for(let Ab=0;Ab<Jb;Ab++){Ja[Ab].cell.bBc();const nb=Ja[Ab].cell.getRange(),va=$a.g(this.$).Ea.Nia(nb),db=va.length;if(-167499203===
lb&&this.Jfc){var Lb=0;2===Ja[Ab].cell.ZFd||1===Ja[Ab].cell.wJ?Lb=3:2===Ja[Ab].cell.wJ&&(Lb=1);Ja[Ab].V_(Lb,!1)}for(Lb=1;Lb<db;Lb++)va[Lb].attachCellToModel(),va[Lb].ypb(Ja[Ab]),-167499203===lb&&this.Jfc&&va[Lb].V_(null,!1);this.ahf&&Pb&&this.WJg(Pb[Ab],nb,va)}}dVe(Ja,lb){let Pb=null;for(let Jb=0;Jb<Ja.length;Jb++)if(Ja[Jb].BorderPosition===lb){Pb=Ja[Jb];break}return Pb}gIh(Ja,lb){let Pb=Ja.cell.FM();Ja.sKa()&&Ja.cell.JPa(1);Ja.vKa()&&Ja.cell.JPa(3);if((Ja=this.nx.dQ(lb,0))&&Ja[0].sKa){var Jb=Ja[0].FM().Borders;
Jb=this.dVe(Jb,1);Jb.BorderPosition=0;Pb.Borders.push(Jb);Ja.forEach(Lb=>{Lb.JPa(1)})}(lb=this.nx.dQ(lb,2))&&lb[0].vKa&&(Ja=lb[0].FM().Borders,Ja=this.dVe(Ja,3),Ja.BorderPosition=2,Pb.Borders.push(Ja),lb.forEach(Lb=>{Lb.JPa(3)}));return Pb}Uag(Ja,lb,Pb){var Jb=$a.g(this.$).Ea.Oua(lb[0],this.$.activeItemName);const Lb=$a.g(this.$).Ea.z9(lb[0],this.$.activeItemName),Ab=[];if(void 0!==Jb&&null!==Jb&&(lb=$a.g(this.$).Nua(lb[0],Jb),void 0!==lb&&null!==lb)){lb=lb.$$ge();for(Jb=[];lb.$$mn();){var nb=lb.$$cu();
if(nb.KH){Ab.push(nb);this.i2(this.b4(nb),!0,10,Ja,"unmerge");nb.cell.AXg();const va=nb.cell.getRange();this.i2(this.b4(nb),!1,11,Ja,"unmerge");Lb.KXd(va,!1);this.ahf&&(nb=this.gIh(nb,va),Jb.push(nb))}}0<Ab.length&&(Lb.tf.resetCellLookup(),this.COj(Ab,Pb,Jb))}}i2(Ja,lb,Pb,Jb,Lb){if(!this.Wcf)return!1;Ja!==lb&&v.ULS.sendTraceTag(526149323,0,50,`Merge Information for resultant cell is unexpectedly changed at step: ${Pb}; Scenario: ${Jb}; Command: ${Lb}; Expected: ${lb?"populated":"empty"}; Actual: ${Ja?
"populated":"empty"}`);return Ja}b4(Ja){return!!Ja.cell.cell.Merge}}Object(t.a)(nc,"MergeCellCommandAction",null,[]);var Wb=a(75),Ea=a(97),ua=a(200),ma=a(42),fb=a(456),sb=a(374),Ua=a(51),ab=a(68),na=a(55),Na=a(1083),Va=a(33),Sa=a(338),vb=a(171);class Oa{constructor(Ja,lb,Pb,Jb,Lb,Ab,nb){this.$=Ja;this.gridView=lb;this.ug=Pb;this.uB=Jb;this.borderFormatManager=Lb;this.moreColorsHelper=Ab;this.fontDropdownHelper=nb;this.oC=null;this.PZa=1461300262;this.dx=this.MZa=this.q8a=this.e9b=null;this.sMi=(va,
db)=>{if(!Ga.a(va)&&db){const Xa=!!va&&!!va.RequestTelemetryData;$a.g(this.$).Gi.Pka(db,va.StateId,Xa?va.RequestTelemetryData.EcsOperationDuration:0,Xa?va.RequestTelemetryData.EcsRequestDuration:0,Xa?va.RequestTelemetryData.WfeRequestDuration:0)}};this.tpb=()=>{if(this.gridView.Q5a){const va=this.$.da.za(254,!0);va&&va.Cbj(this.tpb);this.gridView.Q5a=!1;this.gridView.Df.Wl(H.a.jQ);this.gridView.ha.RV(this.yad);$a.g(this.$).$.qf()}};this.yad=()=>{var va=this.e9b;this.e9b=J.d(this.$.xa.pa);va===this.e9b&&
(this.gridView.ha.RV(this.yad),(va=this.$.da.za(254,!0))&&va.xYc(36,$a.g(this.$).ha.sa.selectedRanges)?(va=new Pa.a(1804571062,2,2,0,null),this.$.Ka.Mb(va,{[H.a.skipClipboardAccess]:!0,[H.a.c_c]:!0,[H.a.isFormatPainter]:!0}).continueWith(()=>{this.tpb()})):this.gridView.Df.XG(!1))};this.xb=e.EwaSettings.xb();this.Xjc=new nc(this.$,Pb);this.dD=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Im=e.EwaSettings.Im();this.Hm=Va.a.Hm()}get Tff(){return n.a.all(this.gridView.ha.sa.selectedRanges,
Ja=>Ja.isRow)}get Off(){return n.a.all(this.gridView.ha.sa.selectedRanges,Ja=>Ja.Ze)}get themesManager(){this.dx||(this.dx=this.$.da.za(422));return this.dx}Shi(Ja){return 1896159024===Ja||-1554384558===Ja||-1113896058===Ja||1554436520===Ja||1415868706===Ja||674605324===Ja||1035996630===Ja}Nc(Ja,lb){return 2054778433===lb&&Ja&1?!ea.a(this.$).xgc:600686207===lb?!1:this.Shi(lb)&&n.a.any(this.gridView.ha.sa.selectedRanges,Pb=>Pb.Ze||Pb.isRow)&&!this.Tff&&!this.Off?!0:this.Sgc(Ja,lb)}executeCommand(Ja,
lb,Pb){return this.Mb(lb,Pb)}Cc(Ja,lb,Pb){if(Ja=1===Ja)switch(lb.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:Ja=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);break;case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:Ja=
!!Pb;break;case 862825906:case 1532790410:case 46555851:case -1522760979:Ja=!0;break;default:Ja=!1}return Ja}Rc(Ja,lb,Pb){switch(lb){case "PopulateFontColor":Pb.MenuItems=this.uB.e$b(1970784898,-803000997,null,null,-128950598,2036397036,1688184685,862825906,Pb.MenuId);break;case "PopulateFillColor":Pb.MenuItems=this.uB.e$b(1650812936,null,87208751,2063445891,673562736,1457172838,-446735083,1532790410,Pb.MenuId);break;case "PopulateBorderColor":Pb.MenuItems=this.uB.e$b(-236759591,-1803452024,void 0,
void 0,void 0,void 0,void 0,46555851,Pb.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.u2h(Pb);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":if(this.Hm&&(this.fontDropdownHelper.Sqj(Pb.MenuId),!this.fontDropdownHelper.Sgi()))return!1;Pb.MenuItems=this.fontDropdownHelper.yUe(-1293291468,324978188,-1428968098,Pb.MenuId);break;default:return!1}return!0}Sgc(Ja,lb){const Pb=$a.g(this.$).ha.sa.selectedRanges;return!(new O.a(this.$.xa)).mm(Ja,lb,Pb,this.gridView)}Mb(Ja,
lb){var Pb=this.gridView;const Jb=Ja.command;var Lb=f.TaskExtensions.fk();let Ab=!0;switch(Jb){case -1077965542:Ab=this.w4e(lb,Ja,!1);break;case 909774670:this.Gob(Jb);Ab=this.w4e(lb,Ja,!0);break;case -1293291468:Ab=this.u4e(lb,Ja,!1);break;case 324978188:this.Gob(Jb);Ab=this.u4e(lb,Ja,!0);break;case 862890474:case 963349338:Ab=this.O1h(Ja);break;case -1832800737:Ab=this.Kbc(Jb,lb,!1,Ja);break;case 1970784898:Ab=this.Kbc(Jb,lb,!1,Ja);break;case -803000997:Ab=this.Kbc(Jb,lb,!1,Ja);break;case -128950598:case 1688184685:this.Gob(Jb);
Ab=this.Kbc(Jb,lb,!0,Ja);break;case 1597684571:Ab=this.Xvb(Jb,lb,!1,Ja);break;case 87208751:lb.Color="-1";lb.IntColor=!0;Ab=this.Xvb(Jb,lb,!1,Ja);break;case -446735083:this.Gob(Jb);lb.Color="-1";lb.IntColor=!0;Ab=this.Xvb(Jb,lb,!0,Ja);break;case 1650812936:Ab=this.Xvb(Jb,lb,!1,Ja);break;case 673562736:this.Gob(Jb);Ab=this.Xvb(Jb,lb,!0,Ja);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:this.dTf(Jb);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:Ab=
this.z1h(Jb,Ja);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:Ab=this.H0h(Jb,Ja);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:Ab=this.p2h(Jb,Ja);break;case -1803452024:case -236759591:Ab=this.Hgd(Jb,lb,Ja);break;case -2118943501:Ab=this.borderFormatManager.S0h(lb,Ja);break;case 1012765228:Ab=this.borderFormatManager.J2h(lb,Ja);break;case 1256700402:Ab=this.borderFormatManager.Lgd(Ja);
break;case -1756763834:Ab=this.borderFormatManager.Mgd(Ja);break;case -1418159950:Ab=this.borderFormatManager.i4e(Ja);break;case -1920201820:case -1942512156:Ab=this.P1h(Jb,Ja);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:Ab=this.borderFormatManager.V3e(lb,Ja);this.Vyh(lb);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:Ab=this.l2h(Jb,lb,Ja);break;case -693675336:case 322710748:break;case 1696566924:Ab=this.A1h(Ja);break;
case -167499203:case -255094134:case 1097660126:case 155820588:Lb=this.handleMergeCellsCommand(this.gridView,Ja);break;case 1896159024:case -1554384558:lb=this.gridView.ha.sa.selectedRanges;if(this.vxj(Ja,lb))v.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new ya(this.$,Jb,lb)).vg(),Ab=!0;else if(n.a.any(lb,nb=>this.gridView.Db.XLa(nb))){Pb="";Lb=1461300262;const nb=-1554384558===Jb&&this.gridView.Db.bki(lb[0]);lb=lb[0].height>lb[0].width&&
!nb;switch(Jb){case 1896159024:Pb=lb?"InsertColumnsTable":"InsertRowsTable";Lb=lb?622604322:942362098;break;case -1554384558:Pb=lb?"DeleteColumnsTable":"DeleteRowsTable",Lb=lb?284490184:1405456548}lb=Z.a.aq(Oa.Kkd,Pb,1);new Pa.a(Lb,1,2,6,null);Lb=this.insertOrDeleteCells(lb,Ja,!0)}else Lb=this.insertOrDeleteCells(1896159024===Jb?1:2,Ja,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:Lb=this.insertOrDeleteCells(Z.a.aq(Oa.Kkd,lb[M.a.Pc],1),Ja,!0);break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:Lb=
this.insertOrDeleteCells(Z.a.aq(Oa.Kkd,lb[M.a.Pc],1),Ja,!1);break;case 504848446:Lb=Pb.startEdit(!1,1,lb[H.a.event],void 0,void 0,!0);break;case 1504715724:if($a.g(this.$).oz&&this.borderFormatManager.dU.gB)break;Lb=Pb.startEdit(!0,0,lb[H.a.event],void 0,void 0,!0);break;case 1872288872:this.tpb();break;case 41465729:Lb=this.fill(Pb.ha.sa.Wc,null,0,1,Ja);break;case -1451655532:case 1972143101:Lb=this.fillDownAbsoluteValueAndStartEdit(Pb,lb[H.a.event],-1451655532===Jb);break;case -475861485:Lb=this.fill(Pb.ha.sa.Wc,
null,Pb.rtl?1:2,1,Ja);break;case -978843926:Lb=this.fill(Pb.ha.sa.Wc,null,3,1,Ja);break;case 2098035706:Lb=this.fill(Pb.ha.sa.Wc,null,Pb.rtl?2:1,1,Ja);break;case -2142700828:Lb=this.fill(Pb.ha.sourceRange,Pb.ha.sa.Wc,Oa.OXe(Pb.ha.sa.Wc,Pb.ha.sourceRange),2,Ja);break;case 1405660955:Lb=this.fill(Pb.ha.sourceRange,Pb.ha.sa.Wc,Oa.OXe(Pb.ha.sa.Wc,Pb.ha.sourceRange),4,Ja);break;case 1983983164:Lb=this.fill(Pb.ha.sa.Wc,null,0,0,Ja);break;case 478842689:(Ja=this.$.da.za(376))?(Ja.B2i(),Ab=!0):v.ULS.sendTraceTag(537159509,
0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:Ab=Pb.ha.Mb(null,Jb);break;case -208772570:this.g2h();Ab=!0;break;case -987339782:this.$0h();Ab=!0;break;case -1770246794:Pb.ha.a1h();Ab=!0;break;case 748067091:case -381232414:this.d1h(Jb);Ab=!0;break;case -1522760979:this.gridView.toggleFormulaView();Ab=!0;break;case 886009118:Lb=this.M1h();break;case 894341014:this.R1h();
Ab=!0;break;case 862825906:Lb=this.M4e(1970784898,Ja);break;case 1532790410:Lb=this.M4e(1650812936,Ja);break;case 46555851:Lb=this.c2h(Ja);break;default:Ab=!1}Ab||(Lb=Y.a(Jb));return Lb}Vyh(Ja){Ja&&Ja.MenuItemId&&["OutsideBorders","AllBorders","ThickOutsideBorders"].includes(Ja.MenuItemId)&&e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.qOg(new Sa.a(this.gridView.ha.sa.activeRange,J.d(this.$.xa.pa)))}qOg(Ja){f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ra(this.$.da,
426,427,1),lb=>{void lb.result.XVd(Ja,"BorderActions")},this.$.la,3)}vxj(Ja,lb){const Pb=n.a.all(lb,Ab=>!this.gridView.Db.XLa(Ab)),Jb=1<lb.length&&!!this.gridView.Db.Dfd(lb),Lb=n.a.all(lb,Ab=>!this.gridView.Db.s4(Ab));lb=!n.a.any(lb,Ab=>Ab.isRow||Ab.Ze);return 1===Ja.method&&6===Ja.Re&&(Pb||Jb)&&Lb&&lb}fillDownAbsoluteValueAndStartEdit(Ja,lb,Pb){const Jb=Ja.ha.sa.activeCell,Lb=K.E(Jb,this.gridView.Gs);return Ja.startEdit(!0,0,lb).Uo(()=>{const Ab=Ja.Vb(Lb),nb=Ja.Vb(Jb);if(!Ab||!nb)return v.ULS.shipAssertTag(537159507,
0,!1,`GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: ${Jb.toString()} and above cell: ${Lb.toString()}`),na.Task.Ta(!1);this.gridView.Xb.text=Pb?Ab.t0:Ab.text;this.gridView.Xb.textBox.setCaretPositionToEnd();return na.Task.Ta(!0)})}insertOrDeleteCells(Ja,lb,Pb){const Jb=w.a.create().toString();var Lb=Enum.toString(S,Ja);this.gridView.Gi.T6(17,Jb,Lb);Lb=this.gridView.ha.sa.selectedRanges;var Ab=this.Tff,nb=this.Off;if(!this.$.rq(null,!1,void 0,lb.Re)&&!nb&&!Ab&&
5!==Ja&&9!==Ja)return na.Task.Ta(!0);2===Ja?Ja=nb?10:Ab?6:Lb[0].height>Lb[0].width?18:34:1===Ja?Ja=nb?9:Ab?5:Lb[0].height>Lb[0].width?17:33:18===Ja&&Ab?Ja=34:34===Ja&&nb&&(Ja=18);Lb=this.NHg(Lb,Ja);if((10===Ja||6===Ja)&&!this.$.rq(Lb,!0,1,lb.Re))return na.Task.Ta(!0);const va={};va.InsertDeleteRangeItems=Array(Lb.length);va.SheetName=this.$.pa.sheetName;va.IsTableCommand=Pb;for(Pb=0;Pb<Lb.length;Pb++){Ab=Lb[Pb];nb={};let Ha,tb;Ja&4?(nb.FirstRow=Ab.top-1,nb.LastRow=X.a.Az,nb.FirstColumn=0,nb.LastColumn=
X.a.rw,Ha=Ab.bottom-Ab.top+1,tb=0,6===Ja?(Ab.Ze||(nb.FirstRow=Ab.bottom),Ha=-Ha):vb.b("InsertRowsAbove"),37===Ja&&(nb.FirstRow=Ab.bottom,vb.b("InsertRowsBelow"))):Ja&8?(nb.FirstRow=0,nb.LastRow=X.a.Az,nb.FirstColumn=Ab.left-1,nb.LastColumn=X.a.rw,Ha=0,tb=Ab.right-Ab.left+1,10===Ja&&(Ab.isRow||(nb.FirstColumn=Ab.right),tb=-tb)):Ja&16?(nb.FirstRow=Ab.top-1,nb.LastRow=Ab.bottom-1,nb.FirstColumn=Ab.left-1,nb.LastColumn=X.a.rw,Ha=0,tb=Ab.right-Ab.left+1,18===Ja&&(nb.FirstColumn=Ab.right,tb=-tb)):(nb.FirstRow=
Ab.top-1,nb.LastRow=X.a.Az,nb.FirstColumn=Ab.left-1,nb.LastColumn=Ab.right-1,Ha=Ab.bottom-Ab.top+1,tb=0,34===Ja&&(nb.FirstRow=Ab.bottom,Ha=-Ha));const bc={};bc.InsertDeleteRange=nb;bc.DeltaRow=Ha;bc.DeltaColumn=tb;bc.AdjustedSelectedRange=K.j(Ab);va.InsertDeleteRangeItems[Pb]=bc}this.gridView.Df.XG(!1);const db=e.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");va.IsDecoupleRecalc=db;const Xa=this.$.oa.va.Sb(),gb=()=>new G(va);return V.a(this.$.userOperationManager,
(Ha,tb,bc)=>{db&&!e.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||this.$.ry();return ib(this.$.oa.va,va,ca.b(Ha,this.sMi),tb,bc,Jb,Xa)},Ha=>new W.a(237,0,Ha,void 0,gb),lb)}NHg(Ja,lb){return lb&32?this.tYa(Ja,Pb=>Pb.bottom,Pb=>Pb.top,(Pb,Jb)=>{Pb.bottom=Jb},!1,!0):lb&16?this.gridView.rtl?this.tYa(Ja,Pb=>Pb.left,Pb=>Pb.right,(Pb,Jb)=>{Pb.left=Jb},!1,!1):this.tYa(Ja,Pb=>Pb.right,Pb=>Pb.left,(Pb,Jb)=>{Pb.right=Jb},!1,!1):lb&4?this.tYa(Ja,Pb=>Pb.bottom,Pb=>Pb.top,(Pb,Jb)=>{Pb.bottom=
Jb},!0,!0):lb&8?this.gridView.rtl?this.tYa(Ja,Pb=>Pb.left,Pb=>Pb.right,(Pb,Jb)=>{Pb.left=Jb},!0,!1):this.tYa(Ja,Pb=>Pb.right,Pb=>Pb.left,(Pb,Jb)=>{Pb.right=Jb},!0,!1):Ja}tYa(Ja,lb,Pb,Jb,Lb,Ab){Ja=K.d(Ja);Ja.sort((nb,va)=>lb(va)-lb(nb));if(Lb){Lb=[];Ab=Ab?X.a.dh+1:X.a.mh+1;for(let nb=0;nb<Ja.length;nb++){const va=Ja[nb];Pb(va)<Ab&&(Jb(va,Math.min(lb(va),Ab-1)),Lb.push(va),Ab=Pb(va))}Ja=Lb}return Ja}fill(Ja,lb,Pb,Jb,Lb){const Ab=this.$;if(!Ab.rq([lb],!0))return na.Task.Ta(!0);const nb=K.v(Ja,Ab),va=
lb?K.v(lb,Ab):nb,db=this.$.oa.va.Sb(),Xa=()=>new wa(nb,va,Jb,Pb);return V.a(this.$.userOperationManager,(gb,Ha,tb)=>{this.$.ry();var bc=this.$.oa.va;const tc=bc.Na(9,db);tc.sourceRange=nb;tc.targetRange=va;tc.fillDirection=Pb;tc.fillType=Jb;return da.g(bc,"FillRange",tc,gb,Ha,tb,null,0)},gb=>new W.a(155,0,gb,void 0,Xa),Lb)}l2h(Ja,lb,Pb){const Jb={ValidMembers:32};switch(Ja){case 1890566896:Ja=parseInt(lb[M.a.Pc].toString(),10);if(14===Ja)return Pb=new Pa.a(2105621672,Pb.method,Pb.mode,Pb.Re,Pb.tabName),
lb[M.a.Pc]=null,this.$.Ka.Mb(Pb,lb),v.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),!0;Jb.NumberFormat=Ja;break;case 1886928607:Jb.NumberFormat=13;break;case -992833457:Jb.NumberFormat=11;break;case 218524921:Jb.NumberFormat=12;break;case 996232352:Jb.NumberFormat=1006;break;default:return v.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+Ua.b().nj(Pb.command)),!1}v.ULS.sendTraceTag(537159504,
0,50,`GridCommandHandler.HandleNumberFormatCommand: triggered ${Ua.b().nj(Pb.command)} command, with menu item ${lb[M.a.Pc]}.`);this.ug.formatCells(1890566896,Jb,Pb);this.$.qf();return!0}O1h(Ja){var lb=this.gridView.Vb(this.gridView.ha.sa.activeCell);if(this.xb&&this.gridView.eb){lb=this.gridView.Di.v3a(lb?ua.a(lb).Font:null);if(!lb)return v.ULS.shipAssertTag(537159503,0,!1,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range ${this.gridView.ha.sa.activeCell.toString()} is null while editing`),
!1;var Pb=lb.FontSize}else if(lb)Pb=lb.fontSize;else return!1;lb=Ja.command;let Jb=0;if(862890474===lb)for(;Jb<Oa.$Ia.length-1&&Oa.$Ia[Jb]<=Pb;)Jb++;else if(963349338===lb)for(Jb=Oa.$Ia.length-1;0<Jb&&Oa.$Ia[Jb]>=Pb;)Jb--;v.ULS.sendTraceTag(537159501,0,50,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size ${Pb} to size ${Oa.$Ia[Jb]}`);if(Pb===Oa.$Ia[Jb])return!0;Pb=Oa.Juc(2);Pb.Font.FontSize=Oa.$Ia[Jb];this.xb&&this.gridView.eb?(this.lnb(Ja,!1,Pb),this.$.qf()):this.ug.formatCells(lb,
Pb,Ja);return!0}w4e(Ja,lb,Pb){Ja=Ja[Ja[r.a.IsFreeForm]?r.a.Value:M.a.Zf].toString();if(!Oa.XYi.test(Ja))return v.ULS.sendTraceTag(537159499,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not a number."),e.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;Ja=parseFloat(Ja);if(8>Ja||72<Ja)return v.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not within expected limits (8 - 72)."),
e.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;const Jb=Math.round(2*Ja)/2,Lb=Oa.Juc(2);Lb.Font.FontSize=Jb;this.xb&&this.gridView.eb?(this.lnb(lb,Pb,Lb,!0),Jb===Ja||Pb||this.$.qf()):Pb?this.ug.wda(this.gridView,-1077965542,Lb,Pb):(this.ug.formatCells(-1077965542,Lb,lb),this.p_a());return!0}u4e(Ja,lb,Pb){var Jb=Ja[M.a.Zf];if(this.Hm){var Lb=this.fontDropdownHelper.dyc?this.fontDropdownHelper.dyc[Jb]:null;Lb||(v.ULS.sendTraceTag(523903201,1,15,
`GridCommandHandler.HandleFontFamilyCommand: font in supportedFontFamiliesNew is not found for ${Jb}`),Lb=fa.HelperMethods.QR[Jb])}else Lb=fa.HelperMethods.QR[Jb];let Ab=0;this.Im&&(Ja=Ja.MenuItemId,Ja===Na.b?(Jb==this.themesManager.qL.Lpf&&(Lb=Jb),Ab=2):Ja===Na.a&&(Jb==this.themesManager.qL.aof&&(Lb=Jb),Ab=1));if(!Lb)return!0;Jb=Oa.Juc(1);Jb.Font.FontName=Lb;this.Im&&(Jb.Font.FontScheme=Ab);this.xb&&this.gridView.eb?(this.lnb(lb,Pb,Jb),this.$.qf()):Pb?this.ug.wda(this.gridView,-1293291468,Jb,Pb):
(this.ug.formatCells(-1293291468,Jb,lb),this.p_a());return!0}Kbc(Ja,lb,Pb,Jb){let Lb=-803000997===Ja||1688184685===Ja?"black":lb.Color;this.moreColorsHelper&&(-1832800737===Ja?Lb=ja.a.compare(Lb,"WindowText",!0)?this.moreColorsHelper.rab:"black":Pb||(this.moreColorsHelper.rab=Lb,this.moreColorsHelper.Cca(lb,Lb,Jb)));Ja=Oa.Juc(32);Ja.Font.FontColor=pa.a.mH(Lb,Z.a.og(lb,"IntColor"));this.xb&&this.gridView.eb?this.lnb(Jb,Pb,Ja,17===Jb.Re):Pb?this.ug.wda(this.gridView,1970784898,Ja,Pb):(this.dD&&({themeColor:lb}=
this.getThemeColor(lb)).returnValue&&(Ja.Font.ThemeFontColor=lb,Ja.Font.ColorTypeOption=1),this.ug.formatCells(1970784898,Ja,Jb),this.p_a());return!0}d1h(Ja){var lb=(new Date).format(748067091===Ja?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat);const Pb=this.gridView.lm?R.a(this.gridView.$):this.gridView.Xb;Ja=Pb.textBox;this.gridView.eb?Pb.insertText(lb):(this.gridView.startEdit(!0,0),Pb.text=lb,lb=lb.length,Ja.kcb(lb),Ja.caretPosition=lb)}g2h(){this.gridView.nK(this.gridView.ha.sa.activeCell)||
this.gridView.buc||this.gridView.TLa()||this.gridView.dt(this.gridView.ha.sa.activeCell,3,Ea.a.E3e)}$0h(){if(!(this.gridView.buc||this.gridView.TLa()||this.gridView.eb&&u.a.isMac)){const Ja=this.gridView.ha.sa.q3;this.gridView.Dg(K.v(Ja,this.$),Ja,null,null,60,Ea.a.E3e)}}A1h(Ja){this.e9b=J.d(this.$.xa.pa);const lb=this.$.da.za(254,!0);if(this.gridView.Q5a)return this.gridView.Df.XG(!1),!!lb;if(!lb)return v.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),
!1;this.gridView.ha.IX(this.yad);const Pb=String.format(H.a.Vsa,oa.a.current.Rn(108));this.gridView.Df.Wl(Pb);Ja=new Pa.a(-911352779,Ja.method,Ja.mode,Ja.Re,Ja.tabName);this.$.Ka.Mb(Ja,{[H.a.silentClipboardAccessFailures]:!0,[H.a.isFormatPainter]:!0}).continueWith(Jb=>{(6>Jb.status||6===Jb.status&&!Jb.result)&&this.tpb()});this.gridView.Q5a=!0;lb.LFg(this.tpb);return!0}Xvb(Ja,lb,Pb,Jb){let Lb=87208751===Ja?"-1":lb.Color;this.moreColorsHelper&&(1597684571===Ja?Lb=this.moreColorsHelper.vPa:Pb||(this.moreColorsHelper.vPa=
Lb===Oa.notSet?Oa.SVd:Lb,this.moreColorsHelper.Cca(lb,Lb,Jb)));Ja={ValidMembers:64};Ja.FillColor=pa.a.mH(Lb,Z.a.og(lb,"IntColor"));Pb?this.ug.wda(this.gridView,1650812936,Ja,!0):(this.dD&&({themeColor:lb}=this.getThemeColor(lb)).returnValue&&(Ja.ThemeFillColor=lb,Ja.ColorTypeOption=1),this.ug.formatCells(1650812936,Ja,Jb),this.p_a());return!0}R1h(){v.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");const Ja=this.$.da.za(221);if(Ja){var lb=
this.gridView.Di;if(lb){var Pb,Jb,Lb=({Xqf:Pb,pSe:Jb}=Ja.$ai(lb.text,lb.textBox.caretPosition)).returnValue;Lb?(Ja.qe=!1,lb.text=Lb,lb.textBox.selectRange(Pb,Pb+Jb),v.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):v.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else v.ULS.shipAssertTag(537159491,0,!1,
"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else v.ULS.sendTraceTag(537159492,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")}z1h(Ja,lb){let Pb=0;const Jb=this.gridView,Lb=ua.a(Jb.Vb(null));this.xb&&Jb.eb&&(Lb.Font=Jb.Di.v3a(Lb.Font));let Ab=Lb.Font;Ab||(Ab={ValidMembers:0});switch(Ja){case -287251124:Pb|=4;Ba.e(Ab,4)?Ab.Bold=!Ab.Bold:Ab.Bold=!0;break;case -1925065947:Pb|=8;Ba.e(Ab,8)?Ab.Italic=!Ab.Italic:Ab.Italic=!0;
break;case 1764140053:Pb|=16;Ba.e(Ab,16)?Ab.Underline=!Ab.Underline:Ab.Underline=!0;break;case -1685033574:Pb|=64;Ba.e(Ab,64)?Ab.DoubleUnderline=!Ab.DoubleUnderline:Ab.DoubleUnderline=!0;break;case -1590502662:Pb|=128,Ba.e(Ab,128)?Ab.Strikethrough=!Ab.Strikethrough:Ab.Strikethrough=!0}if(!Pb)return!1;Ab.ValidMembers=Pb;Lb.Font=Ab;Lb.ValidMembers=16;this.xb&&this.gridView.eb?this.lnb(lb,!1,Lb):(e.EwaSettings.ma(651)||Jb.Df.XG(!1),this.ug.formatCells(Ja,Lb,lb));this.$.qf();return!0}H0h(Ja,lb){let Pb=
0;const Jb=this.gridView,Lb=ua.a(Jb.Vb(null));-571165336===Ja||1041132226===Ja||-394785302===Ja?(Pb|=1,Lb.VerticalAlignment=Z.a.aq(Oa.CYa,Ja.toString(),2)):Oa.Dhi(Ja)?(Pb|=2,this.J1h(Lb,Ja)):-1116189897===Ja&&(Pb|=8,Lb.Wrap=Lb.ValidMembers&8?!Lb.Wrap:!0);if(!Pb)return!1;Lb.ValidMembers=Pb;e.EwaSettings.ma(651)||Jb.Df.XG(!1);this.ug.formatCells(Ja,Lb,lb);this.$.qf();return!0}J1h(Ja,lb){!e.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&this.$.isChromeRtl&&
-1142465846!==lb&&(lb=-1150205178===lb?-286432209:-1150205178);lb=Z.a.aq(Oa.CYa,lb.toString(),0);Ja.HorizontalAlignment=lb===Ja.HorizontalAlignment?0:lb}RIf(Ja,lb,Pb,Jb){let Lb=!1;e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&(Lb=this.Xjc.lpf(lb,Pb))&&$a.g(this.$).Gi.e0(this.q8a,Wb.BasicTelemetryCalculator.vQ);return this.rsb(Ja,lb,!1,Lb,Ab=>{this.DNi(Ab,Pb,lb,Lb,Jb)})}handleMergeCellsCommand(Ja,lb){this.q8a=w.a.create().toString();let Pb=null;Pb=this.Xjc.DZe();
var Jb=D.a(lb.command);const Lb=this.Xjc.Afi(lb.command,Pb);let Ab=0;Lb?Ab=y.a.Sd():$a.g(this.$).Gi.T6(4,this.q8a,Jb+", Scenario = "+Pb.scenario.toString());Jb=Ja.ha.sa.selectedRanges;v.ULS.sendTraceTag(537159459,0,50,`GridCommandHandler.HandleMergeCellsCommand: Merge Command: ${Ua.b().nj(lb.command)}, Number of ranges: ${Jb.length}, Ranges: ${K.i(Jb,",",this.$,!1)}`);Jb=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);Ja.Df.XG(!1,Jb);if(10===Z.a.aq(Oa.npf,
lb.command.toString(),10))return na.Task.Ta(!1);const nb=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(Jb&&nb)return Lb?(this.A2f(Pb,lb,!0,!0,Ab),na.Task.Ta(!0)):this.RIf(Ja,lb,Pb,!1);let va=!1;Jb&&(va=this.Xjc.lpf(lb,Pb))&&$a.g(this.$).Gi.e0(this.q8a,Wb.BasicTelemetryCalculator.vQ);return this.rsb(Ja,lb,!1,va,db=>{this.ENi(db,lb,va)})}rsb(Ja,lb,Pb,Jb,Lb=null){const Ab=this.$.oa.va.Sb(),nb=Z.a.aq(Oa.npf,lb.command.toString(),10),va=K.r(Ja.ha.sa.selectedRanges,
Ja.$),db=()=>new T.a(nb,va),Xa=gb=>{const Ha=!!gb&&!!gb.RequestTelemetryData;$a.g(this.$).Gi.Pka(this.q8a,gb.StateId,Ha?gb.RequestTelemetryData.EcsOperationDuration:0,Ha?gb.RequestTelemetryData.EcsRequestDuration:0,Ha?gb.RequestTelemetryData.WfeRequestDuration:0)};Ja=(gb,Ha,tb)=>{this.$.ry();gb=Lb?ca.b(gb,Lb):gb;gb=ca.b(gb,Xa);return da.d(this.$.oa.va,nb,va,Pb,gb,Ha,tb,null,Ab)};return Jb?e.EwaSettings.dc()?V.a(this.$.userOperationManager,Ja,gb=>new W.a(156,0,gb,64,db),lb):V.a(this.$.userOperationManager,
Ja,gb=>new L.a(156,0,gb,void 0,db),lb):V.a(this.$.userOperationManager,Ja,gb=>new W.a(156,0,gb,void 0,db),lb)}A2f(Ja,lb,Pb,Jb=!1,Lb=0){v.ULS.sendTraceTag(537159457,0,50,`Merge cells with multiple values. isCalledBeforeCSE :- ${Pb}`);var Ab=$a.g(this.$).rtl;Ab=Ra.a.Yc(3,2,0,Ab?640:639,0,514846606,"MergeCellsLoseData");f.TaskExtensions.Aa(ma.a(this.$).oj(Ab),nb=>{nb=nb.result;if(Jb){const va=y.a.Sd()-Lb;v.ULS.sendTraceTag(528779355,0,50,`Time taken to show Dialog in Data Loss Scenario is : ${va}, and the user action is : ${nb}`)}0===
nb?(v.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),Pb?(Jb&&(nb=D.a(lb.command),$a.g(this.$).Gi.T6(4,this.q8a,nb+", Scenario = "+Ja.scenario.toString())),this.RIf($a.g(this.$),lb,Ja,!0)):this.rsb(this.gridView,lb,!0,!1)):1===nb&&v.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11)}vti(Ja,lb,Pb,Jb){lb!==Ja&&v.ULS.sendTraceTag(537159454,0,15,`MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- ${lb} and as per server is ${Ja}. The scenario is:- ${Pb}, The CSE is done:- ${Jb}`)}ENi(Ja,
lb,Pb){Ga.b(Ja,514846606)&&(v.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),ab.a(this.$).jd.XL(514846606),Ja=$a.g(this.$).rtl,Ja=Ra.a.Yc(3,2,0,Ja?640:639,0,514846606,"MergeCellsLoseData"),f.TaskExtensions.Aa(ma.a(this.$).oj(Ja),Jb=>{Jb=Jb.result;0===Jb?(v.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.rsb(this.gridView,lb,!0,Pb)):1===Jb&&v.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11))}DNi(Ja,lb,Pb,
Jb,Lb){let Ab=!1;Ga.b(Ja,514846606)&&(Ab=!0,ab.a(this.$).jd.XL(514846606),Jb&&Lb?window.setTimeout(()=>{this.rsb(this.gridView,Pb,!0,!0)},0):this.A2f(lb,Pb,!1));this.vti(Ab,Lb,lb.scenario,Jb)}Gob(Ja){if(this.PZa!==Ja&&1461300262!==this.PZa){this.dTf(this.PZa);var lb=Ua.b().nj(Ja);const Pb=Ua.b().nj(this.PZa);v.ULS.sendTraceTag(537159450,0,50,`GridCommandHandler.CacheFontStyles: Style cached during ${Pb} was restored before caching the style for ${lb} command.`)}this.PZa=Ja;if(this.xb&&this.gridView.eb)this.MZa||
(this.MZa=this.gridView.Di.Bh);else if(!this.oC){this.oC=[];lb=this.gridView.i$("GridCommandHandler.CacheFontStyles",this.gridView.ha.sa.selectedRanges);try{for(lb.$$rst();lb.$$mn();){const Pb=lb.$$cu();if(Pb.cell.hasRichText)this.oC.push(aa.JQg(Pb,Pb.cell.Bh));else switch(Ja){case 673562736:case -446735083:this.oC.push(aa.IXc(Pb,Pb.backgroundColor));break;case -128950598:case 1688184685:this.oC.push(aa.IXc(Pb,Pb.color));break;case 909774670:this.oC.push(aa.KQg(Pb,Pb.fontSize));break;case 324978188:this.Im?
this.oC.push(aa.IQg(Pb,Pb.fontName,Pb.FY)):this.oC.push(aa.IXc(Pb,Pb.fontName))}}}finally{lb&&lb.dispose()}}}OBj(){return this.xb&&this.gridView.eb?!this.MZa:!this.oC}rei(Ja){return!!this.oC&&this.oC.length>Ja&&!!this.oC[Ja].Bh}Rbd(Ja){return this.oC[Ja].style}OIh(Ja){return this.oC[Ja].size}NIh(Ja){return this.oC[Ja].FY}dTf(Ja){if(!this.OBj()){if(this.xb&&this.gridView.eb)this.MZa&&(this.gridView.Xb.Bh=this.MZa);else{const Pb=this.oC.length;for(let Jb=0;Jb<Pb;Jb++){let Lb;var lb=this.oC[Jb].Bia.cell.getRange();
Lb=this.gridView.Vb(lb);if(!Lb){v.ULS.sendTraceTag(537159441,0,50,`GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: ${lb.hz(!1)}`);continue}let Ab;lb=Lb.KH?this.gridView.sJb(Lb.range):(Ab=new U.a,Ab.add(Lb),Ab);for(let nb of lb)if(nb.cell.hasRichText&&1457172838!==Ja)this.rei(Jb)&&(nb.cell.Bh=this.oC[Jb].Bh);else switch(Ja){case 1457172838:nb.backgroundColor=this.Rbd(Jb);break;case 2036397036:nb.color=this.Rbd(Jb);break;case -1904244080:nb.fontSize=this.OIh(Jb);
break;case -1428968098:nb.fontName=this.Rbd(Jb),this.Im&&nb.aZf(this.NIh(Jb))}}}this.PZa=1461300262;this.p_a()}}p_a(){this.xb&&this.gridView.eb?this.MZa=null:this.oC=null}P1h(Ja,lb){const Pb={IndentationIncrease:0};if(-1942512156===Ja)Pb.IndentationIncrease=1;else if(-1920201820===Ja)Pb.IndentationIncrease=-1;else return!0;Pb.ValidMembers=256;this.ug.formatCells(Ja,Pb,lb);return!0}p2h(Ja,lb){var Pb=Ja;!$a.g(this.$).rtl||-1649235364!==Ja&&524773427!==Ja||(Pb=-1649235364===Ja?524773427:-1649235364);
switch(Pb){case -1649235364:Pb=X.a.rotateTextUp45;break;case 524773427:Pb=X.a.ctc;break;case 1886217042:Pb=X.a.rotateTextUp90;break;case 928057943:Pb=X.a.etc;break;case -1526602249:Pb=X.a.verticalText;break;default:return!1}const Jb={ValidMembers:512};Jb.TextOrientation=Pb;this.ug.formatCells(Ja,Jb,lb);return!0}M1h(){const Ja=$a.g(this.$),lb=K.r(Ja.ha.sa.selectedRanges,this.$),Pb=K.o(Ja.ha.sa.activeCell,this.$);v.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");
return V.a(this.$.userOperationManager,(Jb,Lb,Ab)=>qa.q(this.$.oa.va,Pb,lb,Jb,Lb,Ab,null),Jb=>new W.a(201,0,Jb),null)}M4e(Ja,lb){let Pb=null;var Jb=$a.g(this.$).ha.sa.selectedRanges;Jb=this.gridView.i$("MoreColors",Jb,1,!0);try{for(Jb.$$rst();Jb.$$mn();){const Lb=Jb.$$cu().cell;if(!Lb)continue;let Ab=Oa.black;if(1970784898===Ja)Ab=Lb.color;else if(1650812936===Ja){const nb=Lb.backgroundColor;Ab=ja.a.compare(nb,Oa.SVd,!0)&&ja.a.compare(nb,Oa.empty,!0)?Lb.backgroundColor:Oa.white}if(!Pb)Pb=Ab;else if(Pb!==
Ab){Pb=Oa.black;break}}}finally{Jb&&Jb.dispose()}this.xb&&this.gridView.eb&&1970784898===Ja&&this.gridView.Di.textBox.Pse();return this.moreColorsHelper.VAb(Ja,lb,Pb)}c2h(Ja){const lb=x.a.N3a(this.borderFormatManager.C2);return this.moreColorsHelper.VAb(-236759591,Ja,lb)}lnb(Ja,lb,Pb,Jb=!1){lb?this.gridView.Di.UHf(Pb.Font):(this.Hvi(Ja),Jb?window.requestAnimationFrame(()=>{B.FocusManager.instance().Sj(z.AFrame.t$);this.gridView.Di.yTe(Pb.Font)}):(B.FocusManager.instance().Sj(z.AFrame.t$),this.gridView.Di.yTe(Pb.Font)),
this.p_a())}Hvi(Ja){const lb=D.a(Ja.command);Ja=A.a[Ja.Re]+"_"+I.a[Ja.method];const Pb=this.gridView.hc.lwe.toString(),Jb=new Map;Jb.set("Command",lb);Jb.set("Source",Ja);Jb.set("Ribbon","React");Jb.set("CellTextRuns",Pb);F.Health.instance.recordKpiUsage(sb.a.jCh,0,fb.a.HTf,Jb)}Hgd(Ja,lb,Pb){Ja=this.borderFormatManager.Hgd(Ja,lb,Pb);this.moreColorsHelper&&this.moreColorsHelper.Cca(lb,this.borderFormatManager.C2,Pb);return Ja}getThemeColor(Ja){let lb;lb={};let Pb=!1;if((Ja.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return v.ULS.sendTraceTag(537159433,
0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:lb};let Jb;({themeIndex:Ja,KAa:Jb,returnValue:Pb}=this.themesManager.getThemeColor(Ja.Color));Pb&&(lb.ThemeColorIndex=Ja,lb.ThemeColorRow=Jb)}return{returnValue:Pb,themeColor:lb}}static get XYi(){return Oa.Hce||(Oa.Hce=RegExp("^[0-9]+[.]?[0-9]*$"))}static get Kkd(){return Oa.m7d||(Oa.m7d={["InsertRows"]:5,["InsertColumns"]:9,["InsertCellsShiftRight"]:17,["InsertCellsShiftDown"]:33,["DeleteRows"]:6,["DeleteColumns"]:10,
["DeleteCellsShiftLeft"]:18,["DeleteCellsShiftUp"]:34,["DeleteRowsTable"]:6,["DeleteColumnsTable"]:10,["InsertRowsTable"]:5,["InsertColumnsTable"]:9,["InsertRowsBelow"]:37})}static get CYa(){return Oa.Mfb||(Oa.Mfb={["-394785302"]:0,["-571165336"]:2,["1041132226"]:1,["-1150205178"]:1,["-1142465846"]:2,["-286432209"]:3})}static get npf(){return Oa.Z$d||(Oa.Z$d={["-167499203"]:2,["-255094134"]:5,["1097660126"]:6,["155820588"]:7})}static Dhi(Ja){return-1150205178===Ja||-1142465846===Ja||-286432209===
Ja}static Juc(Ja){const lb={},Pb={};lb.ValidMembers=16;lb.Font=Pb;Pb.ValidMembers=Ja;return lb}static OXe(Ja,lb){let Pb;Pb=Ja.top<lb.top?3:Ja.bottom>lb.bottom?0:-1;return Pb=Ja.left<lb.left?1:Ja.right>lb.right?2:Pb}}Oa.SVd="transparent";Oa.notSet="-1";Oa.black="#000000";Oa.empty="";Oa.white="#FFFFFF";Oa.m7d=null;Oa.Mfb=null;Oa.Z$d=null;Oa.Hce=null;Oa.$Ia=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(t.a)(Oa,"GridCommandHandler",null,[195]);class yb extends m.a{constructor(Ja){super(Ja)}yd(){const Ja=
d.GetServiceTaskFactory.create(this.$.da,111,this.la,this.hb),lb=d.GetServiceTaskFactory.create(this.$.da,18,this.la,this.hb),Pb=d.GetServiceTaskFactory.create(this.$.da,397,this.la,this.hb),Jb=d.GetServiceTaskFactory.Ra(this.$.da,502,503,this.hb);if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){const Lb=d.GetServiceTaskFactory.Ra(this.$.da,296,468,this.hb);f.TaskExtensions.Aa(f.TaskExtensions.Wd([Ja,lb,Pb,Lb,Jb],this.la),()=>{this.gd([new Oa(this.$,$a.g(this.$),
lb.result,Ja.result,Lb.result,Pb.result,Jb.result)])},this.la,3)}else{const Lb=d.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb);f.TaskExtensions.Aa(f.TaskExtensions.Wd([Ja,lb,Lb,Pb,Jb],this.la),()=>{this.gd([new Oa(this.$,$a.g(this.$),lb.result,Ja.result,new k.BorderFormatManager(this.$,lb.result,Lb.result),Pb.result,Jb.result)])},this.la,3)}}static ka(Ja){m.a.Nd(80,new yb(Ja))}}Object(t.a)(yb,"GridCommandHandlerFactory",m.a,[]);a.d(C,"a",function(){return Ob});const Ob=()=>{c.a.Fa(yb.ka);
c.a.Fa(l.ka)}},1171:function(t,C,a){t=a(0);var c=a(15),b=a(185),d=a(83),f=a(84),e=a(381),k=a(99),l=a(44);class m{constructor(){this.Dca=this.SUe=null}}Object(t.a)(m,"GestureAdapterInfo",null,[]);var v=a(4),n=a(371),w=a(226);class r{constructor(){this.eGc=null}Qri(){if(!this.eGc){var T="hammer.min.js";v.AFrameworkApplication.fa.lo("IsServerFlavorDebug")&&(T=v.AFrameworkApplication.fa.qa("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");T=v.AFrameworkApplication.aL(String.format("{0}",T),5);T=w.a.create(T,
null,null);n.a.Xha(T);this.eGc=T.L7a}return this.eGc}static get instance(){r.Ma||(r.Ma=new r);return r.Ma}}r.Ma=null;Object(t.a)(r,"HammerJsDependencyLoader",null,[491]);var u=a(13);const y=(T,K,L=null)=>{if(void 0===K||null===K)throw c.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let V=null;switch(T){case u.a.pinch:V=new Hammer.Pinch(L);break;case u.a.pan:V=new Hammer.Pan(L)}V&&(V.manager=K);return V};var x;(function(T){T[T.none=-1]="none";
T[T.pinch=0]="pinch";T[T.pan=1]="pan";T[T.swipe=2]="swipe"})(x||(x={}));Object(t.b)("GestureEvent",x);var B=a(76);class z extends B.a{constructor(T,K,L,V,W,da,qa,O){super(T,L,V,da);this.rgb=K;this.Hfa=qa;this.WW=O;this.Nog=W}get shiftKey(){return this.Hfa}get ctrlKey(){return this.WW}get clientPoint(){return this.rgb}get sua(){return this.Nog}static create(T,K,L,V,W,da){if(L.rawEvent)if(da){var qa=L.rawEvent;qa=new Sys.UI.Point(qa.clientX,qa.clientY)}else qa=B.a.rub(L);else qa=new Sys.UI.Point(L.clientX,
L.clientY);return new z(T,qa,K,L,V,W,L.shiftKey,L.ctrlKey,da)}}Object(t.a)(z,"GestureEventArgs",B.a,[]);class A{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=
null}}Object(t.a)(A,"GestureManagerData",null,[]);class I{}I.djg=2;I.ejg=4;I.fjg=8;I.gjg=8;Object(t.a)(I,"HammerConstants",null,[]);var F=a(91),U=a(205),X=a(30),S=a(79);class H extends l.a{constructor(T,K){super();this.Gpa=e.a.aGh;this.DNc=!!window.PointerEvent;this.ohe=window.hasOwnProperty("ontouchstart");this.mVa=this.Djb=null;this.a8=!1;this.BS=new k.a;this.Yjb=new k.a;this.Oog=new b.a;this.Zoa=null;this.rUa=this.VHc=this.g2d=this.OEc=this.xLc=this.Ode=this.m2d=this.xlb=!1;this.fjb=-1;this.curRecognizer=
this.element=this.handlers=this.session=this.nQc=null;this.Md=F.EventHandlerManager.instance;this.DNc?(c.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.Djb=Object(d.a)(this,this.Wmc,"onPointerEvent"),this.mVa=u.a.cGh):this.ohe?(c.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.Djb=Object(d.a)(this,this.nya,"onTouchEvent"),this.mVa=u.a.touchEvents):(c.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.Djb=Object(d.a)(this,this.Fmc,"onMouseEvent"),this.mVa=u.a.bGh);
this.zh=K;this.Kea=T;v.AFrameworkApplication.fa&&(this.xlb=v.AFrameworkApplication.fa.qa("UsePointerCaptureIsEnabled"),this.m2d=v.AFrameworkApplication.fa.qa("ClearCacheOnPrimaryPointerIsEnabled"),this.Ode=v.AFrameworkApplication.fa.qa("ResetHandledBeforeInputHandlerIsEnabled"),this.xLc=v.AFrameworkApplication.fa.qa("LogCoalescedEventsIsEnabled"),this.OEc=v.AFrameworkApplication.fa.qa("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.g2d=v.AFrameworkApplication.fa.qa("CheckIfHammerExistsAfterDownloadIsEnabled"),
this.VHc=v.AFrameworkApplication.fa.qa("HammerJsPerformanceTimersIsEnabled"),this.rUa=this.xlb&&v.AFrameworkApplication.fa.qa("CancelDragFromGestureInputManagerIsEnabled")&&v.AFrameworkApplication.fa.qa("UseGestureInputManagerPointerCacheIsEnabled"))}tOh(){return this.DNc?0:this.ohe?1:2}jn(T){super.jn(T);this.Md.Kja(this.mVa,T,0,this.Djb)}gm(T){super.gm(T);this.Md.HHa(T,this.mVa)}x7i(T,K,L=null){v.AFrameworkApplication.Ofc()?r.instance.Qri().continueWith(V=>{this.uEj();if(V.Sf||V.Ch)c.ULS.sendTraceTag(591192778,
310,10,"Hammer did not download correctly: {0}",V.status);else{c.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",V.status);if(this.g2d){V=window.Hammer;if("undefined"===typeof V){c.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.Mxc();return}if("undefined"===typeof V.inputHandler){c.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.Mxc();return}}if(!T)throw this.Mxc(),Error.argumentNull("source element can not be null");V=U.a.Sua(T,this.Gpa);
if(void 0===V||null===V)V=new k.a,U.a.rcb(T,this.Gpa,V),this.y7i(T);var W=null;V.mb(x[0])||(W=Object.assign(new m,{Dca:y(x[0],this,null),SUe:K}),V.add(x[0],W));if(void 0!==L&&null!==L)for(let da=0;da<L.length;da++)if(V.mb(x[L[da]])){const qa=V.na(x[L[da]]);W.Dca.recognizeWith(qa.Dca)}}this.Mxc()}):c.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}uEj(){this.VHc&&(this.zh?this.nQc=this.zh.Bc("Task","RegisterGestureAdapterAfterLoad"):c.ULS.sendTraceTag(590387074,
310,10,"_stopwatchBuilder is null"))}Mxc(){this.VHc&&(this.nQc?this.nQc.stop():c.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}y7i(T){this.Oog.add(T);this.Md.Kja(this.mVa,T,0,this.Djb)}recognize(T){var K=Array(T.pointers.length);for(var L=0;L<T.pointers.length;L++)K[L]=T.pointers[L].target;L=null;for(this.Zoa=this.LQh(K);void 0!==this.Zoa&&null!==this.Zoa&&(L=U.a.Sua(this.Zoa,this.Gpa),void 0===L||null===L);this.Zoa=this.Zoa.parentNode);if(void 0!==L&&
null!==L){this.curRecognizer&&this.curRecognizer.state===I.gjg&&(this.curRecognizer=null);K=L.keys;for(let V of K){K=L.na(V);void 0!==K&&null!==K&&void 0!==K.Dca&&null!==K.Dca&&(void 0===this.curRecognizer||null===this.curRecognizer||K.Dca===this.curRecognizer||K.Dca.canRecognizeWith(this.curRecognizer))&&K.Dca.recognize(T);const W=K.Dca.state;this.curRecognizer||I.djg!==W&&I.ejg!==W&&I.fjg!==W||(this.curRecognizer=K.Dca)}}}emit(T,K){if("hammer.input"!==T){this.a8=!1;K=z.create(T,this.Zoa,K.srcEvent,
K,3,this.DNc);var L=U.a.Sua(this.Zoa,this.Gpa);if(this.Eji(T))var V=0;else if(this.tji(T))V=1;else if(this.umi(T))V=2;else{c.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:L}=L.Dc(x[V]));void 0!==L&&null!==L&&((L=L.SUe,L.lhi())?T.endsWith("start")?this.a8=L.RJi(K):T.endsWith("end")?(L.PJi(K),this.a8=!0):T.endsWith("cancel")?(L.OJi(K),this.a8=!0):T.endsWith("move")&&(this.a8=L.QJi(K)):c.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",
T))}}get(T){return Object(f.a)(Hammer.Recognizer,T)}LQh(T){if(1>T.length)return null;if(1===T.length)return T[0];var K=T[0],L=!0;for(let V=1;V<T.length;V++){if(!T[V])return null;if(K!==T[V]){L=!1;break}}if(L)return K;K=this.kVe(T[0]);L=0;for(const V of T){T=this.kVe(V);if(K.na(K.count-1)!==T.na(T.count-1))return null;for(let W=K.count-2,da=T.count-2;W>=L&&0<=da;W--,da--)if(K.na(W)!==T.na(da)){L=W+1;break}}return K.na(L)}kVe(T){const K=new b.a;for(;void 0!==T&&null!==T;T=T.parentNode)K.add(T);return K}WYe(T){switch(T){case u.a.Af:case u.a.B9:return 1;
case u.a.Xf:case u.a.Jga:return 2;case u.a.te:case u.a.ZFa:return 4;case u.a.qzc:case u.a.qXc:return 8}return 0}nya(T,K,L){T=this.WYe(T);K=this.sPh(L);Hammer.inputHandler(this,T,K);this.a8&&L.preventDefault();return this.a8}t5e(){return 1<this.BS.count}w0b(){c.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.xlb)for(let T of this.BS)this.MOf(T.key);else this.BS=new k.a;this.session=null}sBg(T,K,L){c.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",
T);if(!this.Yjb.mb(T)){try{K.setPointerCapture(T)}catch(V){c.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",V)}this.Yjb.add(T,K)}this.BS.ia(T,L);this.rUa&&1<this.BS.count&&this.Kea&&!this.Kea.Vob&&(this.Kea.Vob=!0)}MOf(T){c.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",T);if(this.Yjb.mb(T)){try{this.Yjb.na(T).releasePointerCapture(T)}catch(K){c.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",K)}this.Yjb.remove(T)}else c.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",
T);this.BS.remove(T);this.rUa&&1>=this.BS.count&&this.Kea&&this.Kea.Vob&&(this.Kea.Vob=!1)}Wmc(T,K,L){var V=L.rawEvent.pointerType.toString();const W=L.rawEvent.pointerId.toString();if("touch"!==V)return!1;T=this.WYe(T);if(1!==T&&!this.BS.mb(W))return!1;this.m2d&&1===T&&L.rawEvent.isPrimary&&this.BS.count&&(c.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.w0b());this.xlb?this.sBg(W,K,L):this.BS.ia(W,L);this.xLc&&2===T&&(!this.OEc||this.OEc&&"function"===typeof L.rawEvent.getCoalescedEvents)&&
(K=L.rawEvent.getCoalescedEvents())&&this.t5e()&&(this.fjb=Math.max(this.fjb,K.length));this.Ode&&(this.a8=!1);V=this.rPh(this.BS,L,V);Hammer.inputHandler(this,T,V);if(4===T||8===T)this.xlb?this.MOf(W):this.BS.remove(W),this.BS.count||(this.session=null,this.xLc&&-1!==this.fjb&&(c.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.fjb),this.fjb=-1));this.a8&&L.preventDefault();return this.a8}Fmc(){return!1}sPh(T){const K=new A;var L=T.rawEvent;const V=L.touches;L=L.changedTouches;
K.pointers=Array.clone(V);K.pointers=Array.clone(0<V.length?V:L);K.changedPointers=Array.clone(L);K.srcEvent=T;K.pointerType="touch";return K}rPh(T,K,L){const V=new A;V.pointers=S.toArray(T.values);V.changedPointers=[K];V.pointerType=L;V.srcEvent=K;return V}Eji(T){return X.a.startsWith(T,u.a.pinch)}tji(T){return X.a.startsWith(T,u.a.pan)}umi(T){return X.a.startsWith(T,u.a.swipe)}}Object(t.a)(H,"GestureInputManager",l.a,[358,359]);var D=a(275),J=a(246);class M{constructor(){this.fb=null;this.Ww=!1}get name(){return"Common.App.GestureInputManager"}Rh(T){T.register(H,
"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").tc().Fc(()=>new H(D.a.instance,v.AFrameworkApplication.ta.MD));this.fb=T}init(){this.Ww||(this.fb.resolve("Common.App.GestureManager.GestureInputManager"),this.Ww=!0)}dispose(){}static main(){J.a.instance.yi(new M)}}Object(t.a)(M,"GestureInputManagerPackage",null,[4,5]);a.d(C,"a",function(){return G});const G=()=>{Type.registerNamespace("Common.App.GestureManager");M.main()}},1172:function(t,C,a){function c({x:ea,y:R},
oa,pa=document){let Pa=-1,Z=null;void 0!==pa.caretPositionFromPoint?(ea=pa.caretPositionFromPoint(ea,R),null!==ea&&(Pa=ea.offset,Z=ea.offsetNode)):void 0!==pa.caretRangeFromPoint&&(ea=pa.caretRangeFromPoint(ea,R),null!==ea&&(Pa=ea.startOffset,Z=ea.startContainer));return null===Z||-1===Pa?(w.ULS.sendTraceTag(521446491,0,15,"getEditorCaretPositionFromPoint - failed to get relevant range"),-1):oa.contains(Z)?b(oa,Z,Pa):(w.ULS.sendTraceTag(521446490,0,15,"getEditorCaretPositionFromPoint - relavant node not inside root"),
-1)}function b(ea,R,oa){if(ea===R)return oa;if(R.textContent!==R.parentElement.textContent)for(;null!==R.previousSibling;)R=R.previousSibling,oa+=R.textContent.length,"div"===R.nodeName.toLowerCase()&&(oa+=1);return b(ea,R.parentElement,oa)}function d(ea,R){return ea.text===R.text&&ea.start===R.start&&ea.length===R.length}function f(ea,R,oa){if(ea.has(R))return ea.get(R);oa=oa();ea.set(R,oa);return oa}function e(ea){return JSON.stringify({text:ea.text,start:ea.start,length:ea.length})}var k=a(10);
t=a(0);var l=a(221),m=a(187),v=a(750),n=a(21),w=a(15),r=a(11),u=a(22),y=a(217),x=a(34);class B{constructor(ea,R){this.$=ea;this.bJa=R;this.f9h();this.editBox=Object(n.g)(this.$).Xb}get zoomManager(){this.Die||(this.Die=Object(x.a)(this.$));return this.Die}dispose(){this.hide()}show(ea,R,oa){ea=Object.assign(Object.assign({},R),{vM:ea,LZd:oa});this.Rcb(ea)&&(this.ina(ea)&&this.hide(),this.HC=ea,this.xy(),oa&&this.Z5h())}hide(){if(this.HC){var ea=this.HC.LZd;this.lfh();ea&&this.T9i();this.HC=void 0}}Rcb(ea){var R;
(R=!this.HC)||(R=this.HC,R=!(R.vM===ea.vM&&R.kind===ea.kind&&R.text===ea.text&&R.start===ea.start&&R.length===ea.length&&R.LZd===ea.LZd));return R}ina(ea){var R;if(R=this.HC)R=this.HC,R=!(R.vM===ea.vM&&R.start===ea.start&&R.length===ea.length);return R}Z5h(){this.HC.vM.textBox.formatText(this.HC.start,this.HC.length,{background:"rgba(202,234,216,0.6)"})}T9i(){const ea=this.HC.vM,R=this.HC.start,oa=this.HC.length,pa=ea.text;pa.length<R+oa?w.ULS.shipAssertTag(521019917,0,!1,`FormulaAssistanceValuePreviewControl.removeHighlight - unexpected editor state, ${pa.length}:${R}:${oa}`):
ea.textBox.formatText(R,oa,{background:!1})}xy(){var ea=this.HC.text;switch(this.HC.kind){case 1:case 2:ea={isLoaded:!0,value:ea};break;case 3:ea={isLoaded:!1,value:null};break;default:return}this.GTj();this.bJa.renderValuePreview(this.vs,this.YMb,ea)}lfh(){this.bJa.dismiss(this.vs)}f9h(){this.vs=document.createElement("div");this.YMb=document.createElement("div");this.YMb.style.position="absolute";this.YMb.style.visibility="hidden";this.$.domElement.appendChild(this.YMb)}GTj(){var ea=this.HC.vM,
R=this.HC.start;const oa=this.HC.length,pa=u.a.contains(ea.text.substring(R,R+oa),"\n",!0);ea=excelOnline.utils.getBoundingRectForText(ea.textBox.Se,R,pa?R:R+oa,!1);R=new y.a(this.YMb.style);R.FB.left=this.Ywc(ea.left);R.FB.top=this.Ywc(ea.top);R.FB.width=this.Ywc(ea.width);R.FB.height=this.Ywc(ea.height);R.P1()}Ywc(ea){var R=this.HC.vM;R=Object(v.b)(this.zoomManager)&&R===this.editBox;return r.HelperMethods.pc(R?this.zoomManager.si(ea):ea)}}Object(t.a)(B,"FormulaAssistanceValuePreviewControl",null,
[2]);var z=a(113);class A{constructor(ea){this.cache=ea}clearCache(){this.cache=void 0}}Object(t.a)(A,"Cacheable",null,[]);class I extends A{constructor(ea,R){super();this.$=ea;this.callbacks=R;this.Wlc=(oa,pa)=>{const Pa=this.gridView.Di;if(!(0<(Pa.eb?Pa.textBox.selection:{index:0,length:0}).length))switch(pa.state){case 0:this.Bzd(oa,pa.event);break;case 1:this.YLi(oa);break;default:return w.ULS.shipAssertTag(521446489,0,!1,"FormulaAssistanceValuePreviewHandler.onHoverChange unxpected HoverState"),
pa}};this.Vlc=(oa,pa)=>{var Pa;const Z=0===pa.kind?pa.Bh.Text:oa.text;pa=null!==(Pa=pa.selection)&&void 0!==Pa?Pa:oa.textBox.selection;Pa={kind:F.Editor,text:Z,start:pa.index,length:pa.length};if(0<pa.length)this.onSelectionChange(oa,Pa);else this.KBf(oa,Pa)};this.gridView=Object(n.g)(this.$);this.editBox=this.gridView.hc;this.formulaBar=Object(z.a)(this.$);this.Bj()}dispose(){this.ek()}trigger(){const ea=this.gridView.Di,R=ea.textBox.selection;this.onSelectionChange(ea,{kind:F.Shortcut,text:ea.text,
start:R.index,length:R.length})}Bj(){this.editBox.UTc(this.Wlc);this.formulaBar.UTc(this.Wlc);this.editBox.Tle(this.Vlc);this.formulaBar.Tle(this.Vlc)}ek(){this.editBox.rId(this.Wlc);this.formulaBar.rId(this.Wlc);this.editBox.vPf(this.Vlc);this.formulaBar.vPf(this.Vlc)}Bzd(ea,R){R=new Sys.UI.Point(R.clientX,R.clientY);R=c(R,ea.textBox.Se);if(-1!==R)this.onSelectionChange(ea,{kind:F.Hover,text:ea.text,start:R,length:0})}YLi(ea){this.KBf(ea)}onSelectionChange(ea,R){this.rwj(R)&&(this.cache=R,this.callbacks.HAd(ea,
{index:R.start,length:R.length}))}KBf(ea,R){this.nwj(R)&&(this.clearCache(),this.callbacks.XNa(ea))}rwj(ea){return!this.cache||!d(this.cache,ea)}nwj(ea){return this.cache&&ea?this.cache.kind!==F.Shortcut||!d(this.cache,ea):!0}}Object(t.a)(I,"FormulaAssistanceValuePreviewHandler",A,[2]);var F;(function(ea){ea[ea.Shortcut=0]="Shortcut";ea[ea.Hover=1]="Hover";ea[ea.Editor=2]="Editor"})(F||(F={}));Object(t.b)("TriggerKind",F);var U=a(43),X=a(61),S=a(33);class H{constructor(ea,R){this.$=ea;this.pluginScheduler=
R;this.jbb=new J(e);this.rXf=new J(e);this.IQi=(oa,pa)=>Pa=>{if(Object(v.c)(Pa.Result))pa("No result");else if(Pa=JSON.parse(Pa.Result),Object(v.c)(Pa))pa("Failed to deserialize");else if(1!==Object.keys(Pa).length)pa("Invalid response");else{for(let Ra in Pa)var Z=Pa[Ra];oa(Z)}};this.HQi=oa=>()=>{oa("Request failed")};this.gridView=Object(n.g)(this.$);if(this.Itb=S.a.SU(this.$))this.formulaAssistanceManager=ea.da.za(464)}clearCache(){this.jbb.clear();this.rXf.clear()}request(ea){return Object(m.a)(this,
void 0,void 0,function*(){return f(this.jbb,ea,()=>Object(m.a)(this,void 0,void 0,function*(){const {kind:R,payload:oa}=yield this.pluginScheduler.getRequester().valuePreview(ea,this.formulaAssistanceManager?this.formulaAssistanceManager.v$a:0);if(0!==R)return null;if(Object(v.c)(oa))return{kind:0};switch(oa.kind){case 0:return{kind:0};case 1:case 2:return Object.assign({},oa);case 3:const pa={text:ea.text,start:oa.start,length:oa.length};return this.jbb.has(pa)?yield this.jbb.get(pa):Object.assign(Object.assign({},
oa),{kind:3,next:()=>this.Iej(pa,ea,oa.text)})}}))})}Iej(ea,R,oa){return Object(m.a)(this,void 0,void 0,function*(){return f(this.rXf,ea,()=>{const pa=new Promise(Pa=>Object(m.a)(this,void 0,void 0,function*(){try{const Z=yield this.MSh(oa);Pa({kind:1,text:Z,start:ea.start,length:ea.length})}catch(Z){w.ULS.sendTraceTag(520495426,1,50,`FormulaAssistanceValuePreviewRequester.requestFromServer: getPartialCalcResults failed, ${Z}`),Pa({kind:0})}}));pa.then(()=>{this.jbb.set(ea,pa);this.jbb.set(R,pa)}).catch(Pa=>
{w.ULS.sendTraceTag(520495425,1,15,`FormulaAssistanceValuePreviewRequester.requestFromServer: serverPromise failed, ${Pa}`)});return pa})})}MSh(ea){return Object(m.a)(this,void 0,void 0,function*(){return new Promise((R,oa)=>{const pa={Formula:ea,PartialFormula:ea,SourceRange:Object(U.v)(this.gridView.ha.sa.activeCell,this.$)};D(this.$.oa.va,pa,this.IQi(R,oa),this.HQi(oa),null,null)})})}}Object(t.a)(H,"FormulaAssistanceValuePreviewRequester",null,[]);const D=(ea,R,oa,pa,Pa,Z,Ra=null)=>{Ra=ea.Na(1,
Ra);Ra.getPartialCalcResultsParameters=R;return Object(X.g)(ea,"GetPartialCalcResults",Ra,oa,pa,Pa,Z,4)};class J{constructor(ea){this.YUd=ea;this.map=new Map}has(ea){ea=this.YUd(ea);return this.map.has(ea)}get(ea){ea=this.YUd(ea);return this.map.get(ea)}set(ea,R){ea=this.YUd(ea);this.map.set(ea,R);return this}clear(){this.map.clear()}}Object(t.a)(J,"RequestMap",null,[]);class M{constructor(ea,R,oa){this.$=ea;this.HAd=(pa,Pa)=>Object(m.a)(this,void 0,void 0,function*(){const Z={text:pa.text,start:Pa.index,
length:Pa.length};void this.UIf(Z,this.requester.request.bind(this.requester),pa,0===Z.length)});this.XNa=()=>{this.hide()};this.reset=()=>{this.handler.clearCache();this.requester.clearCache();this.hide()};this.gy=()=>{this.handler.clearCache();this.requester.clearCache()};this.gridView=Object(n.g)(this.$);this.control=new B(this.$,oa);this.requester=new H(this.$,R);this.handler=new I(this.$,{HAd:this.HAd,XNa:this.XNa});this.Bj()}trigger(){this.handler.trigger()}dispose(){this.ek();this.handler.dispose();
this.control.dispose()}Bj(){this.gridView.Xb.em(this.reset);this.gridView.ha.iga(this.reset);this.$.ea.kE(this.gy)}ek(){this.gridView.Xb.yl(this.reset);this.gridView.ha.mma(this.reset);this.$.ea.BD(this.gy)}UIf(ea,R,oa,pa){return Object(m.a)(this,void 0,void 0,function*(){const Pa=Object.assign(Object.assign({},ea),{vM:oa,fQd:pa});this.wHa=Pa;const Z=yield R(ea);Object(v.c)(Z)||this.Fki(Pa)&&void this.U2h(Z)})}U2h(ea){return Object(m.a)(this,void 0,void 0,function*(){const R=this.wHa.text,oa=this.wHa.vM,
pa=this.wHa.fQd;switch(ea.kind){case 0:this.hide();break;case 1:case 2:this.show(oa,ea,pa);break;case 3:if(!this.ani(ea))break;this.show(oa,ea,pa);void this.UIf({text:R,start:ea.start,length:ea.length},ea.next,oa,pa);break;default:return ea}})}show(ea,R,oa){this.wHa=void 0;this.Mki(R)&&(this.control.show(ea,R,oa),this.Zqb=R)}hide(){this.control.hide();this.Zqb=this.wHa=void 0}Fki(ea){var R;if(R=this.wHa)R=this.wHa,R=R.text===ea.text&&R.start===ea.start&&R.length===ea.length&&R.vM===ea.vM&&R.fQd===
ea.fQd;return R}Mki(ea){return Object(v.b)(ea.text)&&""!==ea.text}ani(ea){return!this.Zqb||this.Zqb.start!==ea.start||this.Zqb.length!==ea.length||3===this.Zqb.kind}}Object(t.a)(M,"FormulaAssistanceValuePreview",null,[673,2]);var G=a(50),T=a(37);class K extends l.a{constructor(ea){super();this.$=ea;this.Fb()}static ka(ea){ea.da.Ga(497,new K(ea))}create(){let ea=this.$.da.za(496);ea&&this.qb(ea);const R=G.GetServiceTaskFactory.Ra(this.$.da,413,414,this.hb),oa=G.GetServiceTaskFactory.Ra(this.$.da,448,
449,this.hb),pa=G.GetServiceTaskFactory.Ra(this.$.da,19,153,this.hb);T.TaskExtensions.Aa(T.TaskExtensions.Wd([R,oa,pa],this.la),()=>{ea=this.$.da.za(496);ea||(ea=new M(this.$,R.result,oa.result),this.$.da.Ga(496,ea));this.qb(ea)},this.la,3)}}Object(t.a)(K,"FormulaAssistanceValuePreviewFactory",l.a,[]);var L=a(691),V=a(182),W=a(55);class da{constructor(ea,R){this.formulaAssistanceValuePreview=R;this.gridView=Object(n.g)(ea)}Nc(){return!1}executeCommand(ea,R){ea=!1;R=R.command;switch(R){case -46938080:this.formulaAssistanceValuePreview.trigger(),
ea=!0}return ea?W.Task.Ta(!0):V.a(R)}Cc(ea,R){return-46938080===R.command}Rc(){return!1}}Object(t.a)(da,"FormulaAssistanceValuePreviewCommandHandler",null,[195]);class qa extends L.a{constructor(ea){super(ea)}yd(){const ea=G.GetServiceTaskFactory.Ra(this.$.da,496,497,this.hb);T.TaskExtensions.Aa(ea,()=>{this.gd([new da(this.$,ea.result)])},this.la)}static ka(ea){L.a.Nd(515,new qa(ea))}}Object(t.a)(qa,"FormulaAssistanceValuePreviewCommandHandlerFactory",L.a,[]);a.d(C,"a",function(){return O});const O=
()=>{k.a.Fa(ea=>{K.ka(ea);qa.ka(ea)})}},1183:function(t,C,a){var c=a(10);t=a(0);var b=a(221),d=a(27),f=a(86),e=a(30),k=a(412),l=a(235);class m{}m.Dnh="ewa-dv";m.Enh="ewa-dv-buttonarea";m.Lmh="ewa-dlb";m.iBb="list-table";m.listItem="list-item";m.fBb="list-item-selected";m.jBb="list-table-touch";m.Cnh="ewa-dpb";m.Rhh="dv-prompt-title";m.Qhh="dv-prompt-message";Object(t.a)(m,"CssClassNames",null,[]);var v=a(31),n=a(553),w=a(19),r=a(48),u=a(422),y=a(77),x=a(7),B=a(15),z=a(153),A=a(815),I=a(37),F=a(14),
U=a(21),X=a(261),S=a(64);class H extends z.ErrorDialog{constructor(sa,Ya,bb){super(sa,H.fQ(Ya,sa,bb));this.Vc=()=>{this.setFocus()};U.g(this.$).ha.NG(this.Vc);(sa=sa.da.za(14).i3a(bb))&&sa.options&1&&B.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.")}dispose(){U.g(this.$).ha.RF(this.Vc);super.dispose()}setFocus(){switch(this.error.Severity){case 0:var sa=4;break;case 1:sa=3;break;case 2:sa=0;break;
default:sa=this.lM}(sa=this.getButton(sa))?sa.get_element().focus():super.setFocus()}Opb(){const sa=U.g(this.$);sa.eb&&sa.Xb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.ISd(1);if(2===this.returnValue||0===this.returnValue){const Ya=sa.Vb(null);if(Ya){sa.Ea.RU();const bb=Object(x.a)(new X.a,{Text:Ya.originalText});sa.setCell(bb,Ya.range,0,63,null)}this.$.ud(-798660877,y.a.Eb,8,null)}super.Opb()}Zra(){const sa=U.g(this.$);sa.eb&&sa.Xb.endEdit(!1,
"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.ISd(0);super.Zra()}ISd(sa){const Ya=U.g(this.$);I.TaskExtensions.Aa(Ya.startEdit(!1,sa),()=>{const bb=Ya.Xb.textBox;bb.text&&bb.selectRange(0,bb.text.length)},this.la,11,S.a.current)}static fQ(sa,Ya,bb){bb=Ya.da.za(14).i3a(bb);sa.MessageId=-1083021405;sa.MessageIdName="DataValidationError";sa.MessageIdHash=e.a.Sv(sa.MessageIdName);sa.Severity=bb?bb.J7c:1;Ya=(null===bb||void 0===bb?0:bb.rIa)?e.a.Eg(bb.rIa):null;
bb=(null===bb||void 0===bb?0:bb.error)?e.a.Eg(bb.error):String.format("<p>{0}</p><p>{1}</p>",F.a.instance.ga(899),F.a.instance.ga(900));switch(sa.Severity){case 0:sa.Appearance=18;break;case 1:sa.Appearance=12;bb+=String.format("<p>{0}</p>",F.a.instance.ga(901));break;default:sa.Appearance=3}sa.Caption=Ya;sa.Description=bb;sa.HelpDescription=F.a.instance.ga(1321);sa.HelpTopicId=A.a.WEe;return sa}}Object(t.a)(H,"DataValidationErrorDeprecatedDialog",z.ErrorDialog,[]);z=a(282);var D=a(5),J=a(43),M=a(247),
G=a(190),T=a(54),K=a(29),L=a(281),V=a(11),W=a(280),da=a(157);class qa extends z.a{constructor(sa,Ya,bb){super(sa);this.kU=this.Cx=null;this.wff=!1;this.rW=this.Dm=this.J6e=this.errorMessage=null;this.XEe=mb=>{const Ca=this.$;var $a=this.wff;this.hide();const Kb=U.g(Ca);Kb.eb&&Kb.Xb.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===mb&&$a&&I.TaskExtensions.Aa(Kb.startEdit(!1,1),()=>{const rb=Kb.Xb.textBox;rb.text&&rb.selectRange(0,rb.text.length)},this.la,11,S.a.current);
if(1===mb&&!$a){if($a=Kb.Vb(null)){Kb.Ea.RU();const rb=Object(x.a)(new X.a,{Text:$a.cell.userInput});Kb.setCell(rb,$a.range,0,63,null)}Ca.ud(-798660877,y.a.Eb,8,null)}2===mb&&I.TaskExtensions.Aa(Kb.startEdit(!1,0),()=>{const rb=Kb.Xb.textBox;rb.text&&rb.selectRange(0,rb.text.length)},this.la,11,S.a.current)};this.zzd=()=>{V.HelperMethods.pV(this.$.mG,this.error.HelpTopicId,this.$.$R)};this.ILi=()=>{this.Qwb();this.$.ud(802602464,2,8,this.kU)};this.cKi=()=>{B.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};
this.dKi=mb=>{!mb||L.a(mb)?B.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):(mb=this.uVh(mb.Result),this.Cx.errorInformation=mb,this.kTa(this.rIa,this.R3a(this.XEe),this.Cx))};this.fzd=()=>{this.show(this.VQb)};this.WKe=bb;this.sqmManager=da.a(this.$);this.error=qa.fQ(Ya,sa,bb);this.rb.Vo=this;this.rIa=(this.Su=sa.da.za(14).i3a(this.WKe))&&this.Su.rIa?this.Su.rIa:F.a.instance.ga(1733);this.dpj();this.initializeAndShow(this.rIa,
this.XEe,this.Cx)}get oc(){return"DataValidationErrorDialog"}dispose(){this===this.rb.Vo&&(this.rb.Vo=null);f.a.Ia(this.Dm);this.Dm=null;super.dispose()}dpj(){this.Su&&this.Su.error?this.errorMessage=this.Su.error:this.Su&&this.Su.options&1?(B.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),this.errorMessage=F.a.instance.ga(1735),this.J6e=T.a.current.Rn(120)):(this.errorMessage=F.a.instance.ga(1734),this.pLh(this.WKe));var sa=
this.Su?this.Su.J7c:1;this.Cx={[qa.Tu]:this.oc,["errorDescription"]:this.errorMessage,["helpImageUri"]:this.J6e};switch(sa){case 0:this.Rb=1;this.rc(1,"Retry");this.Cx.dialogIcon=2;this.wff=!0;break;case 1:this.Rb=4;this.Cx.dialogIcon=1;this.Cx.additionalInformation=F.a.instance.ga(901);break;default:this.Rb=1,this.Cx.dialogIcon=3}this.Cx.helpLink={["type"]:"AppLinkProps",[qa.Tu]:this.error.HelpTopicId,["text"]:F.a.instance.ga(1321),["handler"]:this.zzd};sa=K.a.CVc([this.error]);this.kU={[D.a.b8b]:!0,
[D.a.P9c]:sa,[D.a.Q9c]:da.a(this.$).ysb(this.error.MessageIdHash),[D.a.rU]:this.oc,["DismissHandler"]:this.fzd};this.Cx.giveFeedbackLink={["type"]:"AppLinkProps",[qa.Tu]:D.a.pgd,["text"]:F.a.instance.ga(1772),["handler"]:this.ILi}}pLh(sa){const Ya=this.$.oa.va.Sb();M.f(this.$.oa.va,J.q(sa,this.$),W.b(this.dKi),W.a(this.cKi),null,Ya)}uVh(sa){let Ya;switch(sa.RuleType){case 1:switch(sa.ConditionType){case 0:return Ya=F.a.instance.ob(108),String.format(Ya,sa.LowerBoundary,sa.UpperBoundary);case 1:return Ya=
F.a.instance.ob(109),String.format(Ya,sa.LowerBoundary,sa.UpperBoundary);case 2:return Ya=F.a.instance.ob(110),String.format(Ya,sa.LowerBoundary);case 3:return Ya=F.a.instance.ob(111),String.format(Ya,sa.LowerBoundary);case 4:return Ya=F.a.instance.ob(112),String.format(Ya,sa.LowerBoundary);case 5:return Ya=F.a.instance.ob(113),String.format(Ya,sa.UpperBoundary);case 6:return Ya=F.a.instance.ob(114),String.format(Ya,sa.LowerBoundary);case 7:return Ya=F.a.instance.ob(115),String.format(Ya,sa.UpperBoundary);
default:return"we couldn't get the details"}case 2:switch(sa.ConditionType){case 0:return Ya=F.a.instance.ob(116),String.format(Ya,sa.LowerBoundary,sa.UpperBoundary);case 1:return Ya=F.a.instance.ob(117),String.format(Ya,sa.LowerBoundary,sa.UpperBoundary);case 2:return Ya=F.a.instance.ob(118),String.format(Ya,sa.LowerBoundary);case 3:return Ya=F.a.instance.ob(119),String.format(Ya,sa.LowerBoundary);case 4:return Ya=F.a.instance.ob(120),String.format(Ya,sa.LowerBoundary);case 5:return Ya=F.a.instance.ob(121),
String.format(Ya,sa.UpperBoundary);case 6:return Ya=F.a.instance.ob(122),String.format(Ya,sa.LowerBoundary);case 7:return Ya=F.a.instance.ob(123),String.format(Ya,sa.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(sa.ConditionType){case 0:return Ya=F.a.instance.ob(124),String.format(Ya,sa.LowerBoundary,sa.UpperBoundary);case 1:return Ya=F.a.instance.ob(125),String.format(Ya,sa.LowerBoundary,sa.UpperBoundary);case 2:return Ya=F.a.instance.ob(126),String.format(Ya,sa.LowerBoundary);
case 3:return Ya=F.a.instance.ob(127),String.format(Ya,sa.LowerBoundary);case 4:return Ya=F.a.instance.ob(128),String.format(Ya,sa.LowerBoundary);case 5:return Ya=F.a.instance.ob(129),String.format(Ya,sa.UpperBoundary);case 6:return Ya=F.a.instance.ob(130),String.format(Ya,sa.LowerBoundary);case 7:return Ya=F.a.instance.ob(131),String.format(Ya,sa.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(sa.ConditionType){case 0:return Ya=F.a.instance.ob(132),String.format(Ya,sa.LowerBoundary,
sa.UpperBoundary);case 1:return Ya=F.a.instance.ob(133),String.format(Ya,sa.LowerBoundary,sa.UpperBoundary);case 2:return Ya=F.a.instance.ob(134),String.format(Ya,sa.LowerBoundary);case 3:return Ya=F.a.instance.ob(135),String.format(Ya,sa.LowerBoundary);case 4:return Ya=F.a.instance.ob(136),String.format(Ya,sa.LowerBoundary);case 5:return Ya=F.a.instance.ob(137),String.format(Ya,sa.UpperBoundary);case 6:return Ya=F.a.instance.ob(138),String.format(Ya,sa.LowerBoundary);case 7:return Ya=F.a.instance.ob(139),
String.format(Ya,sa.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(sa.ConditionType){case 0:return Ya=F.a.instance.ob(140),String.format(Ya,sa.LowerBoundary,sa.UpperBoundary);case 1:return Ya=F.a.instance.ob(141),String.format(Ya,sa.LowerBoundary,sa.UpperBoundary);case 2:return Ya=F.a.instance.ob(142),String.format(Ya,sa.LowerBoundary);case 3:return Ya=F.a.instance.ob(143),String.format(Ya,sa.LowerBoundary);case 4:return Ya=F.a.instance.ob(144),String.format(Ya,sa.LowerBoundary);
case 5:return Ya=F.a.instance.ob(145),String.format(Ya,sa.UpperBoundary);case 6:return Ya=F.a.instance.ob(146),String.format(Ya,sa.LowerBoundary);case 7:return Ya=F.a.instance.ob(147),String.format(Ya,sa.UpperBoundary);default:return"we couldn't get the details"}case 3:return Ya=F.a.instance.ob(106),String.format(Ya,sa.LowerBoundary);case 7:return Ya=F.a.instance.ob(107),String.format(Ya,sa.LowerBoundary);default:return"we couldn't get the details"}}ISd(sa){const Ya=U.g(this.$);I.TaskExtensions.Aa(Ya.startEdit(!1,
sa),()=>{const bb=Ya.Xb.textBox;bb.text&&bb.selectRange(0,bb.text.length)},this.la,11,S.a.current)}get la(){this.Dm=this.Dm||new G.a;return this.Dm.token}static fQ(sa,Ya,bb){Ya=Ya.da.za(14).i3a(bb);sa.MessageId=-1083021405;sa.MessageIdName="DataValidationError";sa.MessageIdHash=e.a.Sv(sa.MessageIdName);sa.Severity=Ya?Ya.J7c:1;sa.HelpDescription=F.a.instance.ga(1321);sa.HelpTopicId=A.a.WEe;return sa}}Object(t.a)(qa,"DataValidationErrorDialog",z.a,[83,84,2,85]);z=a(908);var O=a(379);class ea extends z.a{constructor(sa,
Ya,bb){super(sa,Ya);this.dataValidationControl=bb}get jyb(){return Object(k.a)(qa,this.$.rb.gh)}get lK(){return this.dataValidationControl.qe}set lK(sa){this.dataValidationControl.qe=sa}get a5a(){return!1}get key(){return O.a.k4c}dispose(){this.dataValidationControl=null;super.dispose()}Th(sa,Ya){this.dataValidationControl.Ya=this.Ya;const bb=sa.keyCode;return 1461300262!==Ya||16!==bb&&17!==bb&&18!==bb?super.Th(sa,Ya):!1}jyd(){this.lK&&(this.dataValidationControl.Ya=this.Ya,this.dataValidationControl.show(this.dataValidationControl.ZM,
!0,!0,d.a.np||3===y.a.Eb))}Jf(){}nh(){this.dataValidationControl.show(this.dataValidationControl.ZM,!0,!0,d.a.np||3===y.a.Eb)}OEd(sa,Ya){return this.dataValidationControl.Th(Ya)}}Object(t.a)(ea,"DataValidationListAutoCompleteBehavior",z.a,[]);var R=a(262);z=a(835);var oa=a(12),pa=a(116),Pa=a(22),Z=a(907),Ra=a(1);class Ga extends z.a{constructor(sa,Ya,bb){super(sa,Ya,new Z.a(m.listItem,m.fBb,m.iBb,m.jBb));this.CHa=this.eV=this.fda=this.ee=this.Mkb=null;this.YMa=0;this.ZEb=[];this.VQj=Ra.EwaSettings.isChangeGateEnabled("OfficeVSO:6172276_UpdateDvListHeightUsingItemHeight");
this.hBb=bb}get Ej(){return this.Mkb}set Ej(sa){this.OAa(this.Mkb);if(sa){this.Mkb=sa;this.hBb.innerText="";this.OAa(this.Mkb);const Ya=this.ZEb[sa.rowIndex];this.ee=this.eV[Ya];this.CHa&&(this.fda=this.CHa[Ya],B.ULS.shipAssertTag(537163286,0,!this.ZEb.length||!!this.fda,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));this.hBb.innerText=this.ee;this.Ktc(sa)}else this.fda=this.ee=null}get eb(){return U.g(this.$).eb}get editText(){return U.g(this.$).Xb.text}dispose(){super.dispose();
this.hBb=this.Mkb=null}Vda(sa,Ya,bb,mb){if(sa&&(!sa||sa.length)){this.X6(!1);this.CHa=sa;this.eV=[];for(var Ca=0;Ca<sa.length;Ca++)this.eV[Ca]=sa[Ca]?sa[Ca].Name:null;Ca=`<table class='${this.zba}' aria-live='polite'><tbody>`;var $a="",Kb="";sa=0;var rb=U.g(this.$).Vb(null);mb=this.eb?mb?mb.text:this.editText:rb?rb.originalText:null;rb=!mb;var cc=0;this.ZEb.length=0;var nc=[],Wb=[],Ea=[],ua=mb?mb.split(" "):[""];mb=mb.trim();for(let fb=0;fb<this.eV.length;fb++){const sb=this.eV[fb];var ma=void 0;
const Ua=sb.split(" ");ma=R.a.all(ua,Na=>R.a.any(Ua,Va=>Pa.a.jL(Va,Na)));const ab=!sb,na=Ea.includes(sb);ab||na||this.eb&&!ma||(ma=sb?e.a.Eg(e.a.T6c(sb)):"",ma=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.IZ,ma),Ea.push(sb),this.eb&&Pa.a.jL(sb,mb)?($a+=ma,nc.push(fb)):(Kb+=ma,Wb.push(fb)),!rb&&Pa.a.equals(mb,sb,!0)&&(sa=this.eb?nc.length-1:cc,rb=!0),cc++)}this.YMa=cc;this.ZEb.push(...nc);this.ZEb.push(...Wb);this.gg.innerHTML=Ca+($a+Kb+"</tbody></table>");Ca=this.qn=oa.DOMElementExtensions.Kj(this.domElement,
this.zba);this.smb(Ca,Ya);this.X6(!0);this.rra(Ya,bb);this.Ej=0<this.YMa?Ca.rows[sa]:null}}WQa(sa){var Ya=!1;this.eb&&sa&&(Ya=!this.YMa,sa.endEdit(Ya,"DataValidationListBox.SetCellContent",0));if(!Ya&&(sa=U.g(this.$),Ya=sa.Vb(null))){let mb=null;if(this.fda&&-1!==this.fda.SheetId&&-1!==this.fda.Row&&-1!==this.fda.Column){var bb={};bb.SheetName=this.fda.SheetId.toString();bb.FirstRow=this.fda.Row;bb.FirstColumn=this.fda.Column;mb={ParameterType:6};mb.SourceRange=bb}bb=Object(x.a)(new X.a,{Text:this.ee});
sa.setCell(bb,Ya.range,0,63,mb)}return!0}rra(sa,Ya){const bb=sa?this.aCb:this.$H;sa=sa?this.Cic:this.Dic;0>=this.YMa?this.gg.style.height=V.HelperMethods.pc(sa):(this.gg.style.height="auto",this.YMa>bb?(oa.DOMElementExtensions.MI(this.gg,this.VQj?Math.floor(sa*bb):Math.floor(this.gg.offsetHeight*bb/this.YMa)),this.gg.style.overflowY="auto"):(this.gg.style.height="auto",this.gg.style.overflowY="hidden"));oa.DOMElementExtensions.Dv(this.gg,Ya);oa.DOMElementExtensions.Dv(this.qn,Ya-(this.YMa>bb?pa.a.mu:
0))}}Object(t.a)(Ga,"DataValidationListBox",z.a,[]);var Ba=a(113),fa=a(250),Y=a(253),ja=a(1089);const ca=`<p class='${m.Rhh}'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>`,aa=`<p class='${m.Qhh}'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>`;var ta=w.a.WLe,xa=w.a.WLe,ia=w.a.lYg;class ya extends l.a{constructor(sa){super(document.createElement("div"));this.V_b=this.lQ=this.KQ=!1;this.Wh=this.Nh=null;this.Ffi=Ra.EwaSettings.isChangeGateEnabled("OfficeVSO:6172290_DataValidationConditionalHideAll");
this.Gfi=Ra.EwaSettings.isChangeGateEnabled("OfficeVSO:6172279_DataValidationConstButtonWidth");this.Eld=this.Fod=this.Knd=!1;this.z4b=[];this.Fh=()=>{this.B2f(!1)};this.iOa=(bb,mb)=>{this.show(this.ZM,!this.qe,!0,d.a.np||3===mb.tb||3===y.a.Eb);this.Qyd(null,null)};this.Qyd=()=>{this.gridView.setFocus()};this.VKa=()=>{this.Ya.textBox.kF=!0};this.mt=()=>{this.Ycg()};this.onContentReady=()=>{this.B2f(this.qe)};this.Ec=()=>{this.Tx()};this.kya=()=>{this.WQa()};this.Svf=()=>{this.Ycg()};this.$=sa;this.gridView=
U.g(this.$);this.VI=this.gridView.Xb;var Ya="<div id='dv_reader_description' class='"+v.a.nMe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+m.Enh+" "+w.a.Np+"'></div>\r\n<div id='dv_list_box' class='"+m.Lmh+" "+w.a.Zo+" "+w.a.Np+"'></div>\r\n<div id='dv_prompt_box' class='"+m.Cnh+" "+w.a.Np+"'></div>";this.domElement.className=m.Dnh;this.domElement.innerHTML=Ya;fa.d(this.style,this.isGridRtl);this.gg=$get("dv_list_box",this.domElement);this.o_=$get("dv_prompt_box",
this.domElement);this.Ura=$get("dv_list_button",this.domElement);this.hBb=$get("dv_reader_description",this.domElement);(Ya=Ba.a(sa))&&this.z4b.push(new ea(sa,Ya,this));this.z4b.push(new ea(sa,this.gridView.Xb,this));this.gridView.ha.pJ(this.Fh);this.gridView.Ku(this.onContentReady);this.gridView.hc.fEg(this.Svf);this.$.kk(this.Ec);Ya=this.gridView.tj;Ya.insertBefore(this.domElement,Ya.firstChild);this.onContentReady(null,null);sa.da.Ga(14,this)}get Ozb(){return!!(this.$.Bd&16)}get $mi(){return this.qe||
this.ZM||this.Wva}get qe(){return oa.DOMElementExtensions.isVisible(this.gg)}set qe(sa){oa.DOMElementExtensions.setVisible(this.gg,sa)}get ZM(){return oa.DOMElementExtensions.isVisible(this.o_)}set ZM(sa){oa.DOMElementExtensions.setVisible(this.o_,sa)}get Wva(){return oa.DOMElementExtensions.isVisible(this.Ura)&&!!this.Nh&&oa.DOMElementExtensions.isVisible(this.Nh.domElement)}set Wva(sa){oa.DOMElementExtensions.setVisible(this.Ura,sa);this.Nh&&oa.DOMElementExtensions.setVisible(this.Nh.domElement,
sa)}get Ya(){return this.VI}set Ya(sa){this.VI=sa}get s4a(){return!!this.activeCell&&this.T5c(this.activeCell.range)}get activeCell(){return this.gridView.Vb(null)}get c6e(){return this.s4a&&!!this.Su&&!!(this.Su.options&2)&&!!this.Su.prompt}get owb(){return this.s4a&&!!this.Su&&!!(this.Su.options&1)}get isGridRtl(){return this.gridView.rtl}get Su(){return this.i3a(this.activeCell.range)}get TNa(){const sa=this.activeCell;return sa?this.Tua(this.gridView,sa):null}dispose(){this.$&&(this.YLb(!1),this.gridView.ha.RK(this.Fh),
this.gridView.py(this.onContentReady),this.gridView.hc.saj(this.Svf),this.$.zl(this.Ec));this.lDe(!1);this.mDe(!1);f.a.qc(this.z4b);this.z4b=this.Ura=this.gg=this.o_=this.VI=this.gridView=this.$=null;super.dispose()}T5c(sa){return!!this.i3a(sa)}zqb(sa,Ya){return Ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new qa(this.$,sa,Ya):new H(this.$,sa,Ya)}i3a(sa){sa=this.gridView.getRangeInformation(sa);for(let Ya=0;Ya<sa.length;Ya++){const bb=sa[Ya];if(Object(k.a)(u.DataValidationRange,
bb))return bb}return null}pHh(){if(!this.s4a)return"";const sa=this.c6e?`${this.Su.hJf} ${this.Su.prompt}`:"",Ya=this.owb?F.a.instance.ga(847):"";return String.format(F.a.instance.ob(17),sa,Ya)}Th(sa){let Ya=!1;if(this.qe||(-569786022===sa||541421805===sa)&&this.owb||1872288872===sa&&this.ZM)switch(sa){case -569786022:case 541421805:this.show(this.ZM,!this.qe,!0,d.a.np||3===y.a.Eb);Ya=!0;break;case 1872288872:this.qe?(this.show(this.ZM,!1,!0,!1),Ya=!0):this.ZM?(this.show(!1,!1,!0,!1),Ya=!0):this.Ya&&
(this.Ya.endEdit(!1,"DataValidationControl.HandleKeyDown",0),Ya=!0);break;case -798660877:this.Wh.lB(1);Ya=!0;break;case 137938150:this.Wh.lB(-1);Ya=!0;break;case 2091832999:this.Wh.lB(this.Wh.$H-1);Ya=!0;break;case 742457698:this.Wh.lB(-(this.Wh.$H-1));Ya=!0;break;case 125627505:case 267796030:Ya=this.WQa()}return Ya}show(sa,Ya,bb,mb){this.Tx();if(this.Ozb&&this.s4a){var Ca=this.TNa;if(Ca){if(sa||Ya||bb)this.isVisible=!0;fa.d(this.style,this.isGridRtl);bb&&this.owb&&(this.mDe(!0),this.Pcg(Ca,!1));
Ya&&this.owb&&this.NRa(mb,Ca);sa&&this.c6e&&this.IAj(Ca);this.$mi||(this.isVisible=!1)}}}Tua(sa,Ya){if(!Ya||!Ya.cell.Dk)return null;var bb=this.gridView.hc.textBox.domElement;var mb=0<oa.DOMElementExtensions.getHeight(bb)&&0<oa.DOMElementExtensions.getWidth(bb)&&0<=bb.offsetTop&&0<=bb.offsetLeft;if(mb)bb=oa.DOMElementExtensions.Tua(bb,sa.tj);else{bb=sa.getCellBounds(Ya.cell);var Ca=oa.DOMElementExtensions.getBoundingClientRect(sa.tj);bb=new Sys.UI.Bounds(bb.x-Ca.x,bb.y-Ca.y,bb.width,bb.height)}if(bb)if(mb)2<
bb.height&&2<bb.height&&(bb.x+=1,bb.y+=1,bb.height-=2,bb.width-=2);else if(mb=U.g(this.$).WJ(Ya.cell))mb=mb.width+1,Ca=Pa.a.equals(Y.a.yub(Ya.cell,sa.rtl),"right",!0),sa.rtl&&Ca&&(bb.x=bb.x+bb.width-mb),Ya.oka&&sa.rtl===Ca&&(bb.width=mb);else return null;return bb}B2f(sa){const Ya=this.s4a;this.YLb(Ya);Ya?this.show(!0,sa,!0,!1):this.Tx()}WQa(){let sa=!1;this.qe&&(sa=this.Wh.WQa(this.Ya),this.show(this.ZM,!1,!0,!1));return sa}Tx(){this.Ffi?(this.qe&&(this.qe=!1),this.Wva&&(this.Wva=!1),this.ZM&&(this.ZM=
!1),this.isVisible&&(this.isVisible=!1)):this.qe=this.Wva=this.ZM=this.isVisible=!1;this.Knd=this.Eld=this.Fod=!1}NRa(sa,Ya){this.owb&&!this.Su.CHa?this.Wva&&this.Nh.disable():(this.lDe(!0),this.Wh.Vda(this.Su.CHa,sa,this.wQh(Ya),this.Ya),this.eBa(Ya,!1))}IAj(sa){this.Su.prompt&&(this.ZM=!0,this.KSj(this.Su.hJf,this.Su.prompt),this.idg(sa,!1))}Pcg(sa,Ya){const bb=sa.y;this.Ura.style.top=V.HelperMethods.pc(bb);sa=this.isGridRtl?sa.x-this.Ura.offsetWidth+1:sa.x+sa.width+1;this.Ura.style.left=V.HelperMethods.pc(sa);
Ya?this.Wva=this.gridView.nhc(new r.a(sa,bb))&&this.Eld:this.Eld=!0}eBa(sa,Ya){const bb=sa.y+sa.height;sa=this.isGridRtl?sa.x+sa.width-this.gg.offsetWidth:sa.x;this.gg.style.top=V.HelperMethods.pc(bb);this.gg.style.left=V.HelperMethods.pc(sa);Ya?this.qe=this.gridView.nhc(new r.a(sa,bb))&&this.Knd:this.Knd=!0}idg(sa,Ya){const bb=sa.y+sa.height+5;var mb=this.activeCell;mb=mb?mb.width/2:32;sa=this.isGridRtl?sa.x-this.o_.offsetWidth+mb:sa.x+sa.width-mb;this.o_.style.top=V.HelperMethods.pc(bb);this.o_.style.left=
V.HelperMethods.pc(sa);Ya?this.ZM=this.gridView.nhc(new r.a(sa,bb))&&this.Fod:this.Fod=!0}KSj(sa,Ya){if(Ya){var bb="";sa&&(bb+=String.format(ca,e.a.Eg(sa)));bb+=String.format(aa,e.a.Eg(Ya));this.o_.innerHTML=bb;sa=oa.DOMElementExtensions.Kj(this.o_,"dv-prompt-titletext");if(Ya=oa.DOMElementExtensions.Kj(this.o_,"dv-prompt-messagetext")){sa=sa?parseInt(String(Math.max(sa.offsetWidth,Ya.offsetWidth)),10):Ya.offsetWidth;sa+=6;oa.DOMElementExtensions.Dv(this.o_,sa);for(let mb=0,Ca=this.o_.children.length;mb<
Ca;mb++)oa.DOMElementExtensions.Dv(this.o_.children[mb],sa)}}}wQh(sa){return this.Gfi?sa.width+17-2+1:sa.width+this.Ura.clientWidth-2+1}mDe(sa){this.$&&!this.Ozb||!sa?(this.K6f(!1),f.a.Ia(this.Nh),this.Nh=null):(this.Nh||(this.Nh=new ja.a(this.Ura,ta,n.a.Aha,1,xa,F.a.instance.ga(898),ia,F.a.instance.ga(897),"",-1),this.K6f(!0)),this.Wva=!0,this.Su.CHa?this.Nh.isEnabled||this.Nh.enable():this.Nh.disable())}lDe(sa){this.$&&!this.Ozb||!sa?(this.rSa(!1),f.a.Ia(this.Wh),this.Wh=null):(this.Wh||(this.Wh=
new Ga(this.$,this.gg,this.hBb),this.rSa(!0)),this.qe=!0)}rSa(sa){this.Wh&&(sa&&!this.KQ?(this.Wh.Y8(this.Qyd),this.Wh.lYb(this.VKa),this.Wh.Mmb(this.kya),this.KQ=!0):!sa&&this.KQ&&(this.Wh.Oca(this.Qyd),this.Wh.yrc(this.VKa),this.Wh.THb(this.kya),this.KQ=!1))}YLb(sa){sa&&!this.lQ?(this.gridView.view.Ls(this.mt),this.lQ=!0):!sa&&this.lQ&&(this.gridView.view.Pq(this.mt),this.lQ=!1)}K6f(sa){this.Nh&&(sa&&!this.V_b?(this.Nh.MTc(this.iOa),this.Nh.ZTc(this.iOa),this.Nh.ymb(this.VKa),this.V_b=!0):!sa&&
this.V_b&&(this.Nh.hId(this.iOa),this.Nh.vId(this.iOa),this.Nh.FHb(this.VKa),this.V_b=!1))}Ycg(){if(this.s4a){var sa=this.TNa;sa&&(this.Pcg(sa,!0),this.eBa(sa,!0),this.idg(sa,!0))}}}Object(t.a)(ya,"DataValidationControl",l.a,[398,2]);class ib extends b.a{constructor(sa){super();this.$=sa;this.Fb()}create(){this.qb(this.$.da.za(14)||new ya(this.$))}}Object(t.a)(ib,"DataValidationControlFactory",b.a,[]);a.d(C,"a",function(){return wa});const wa=()=>{c.a.Fa(sa=>{sa.da.Ga(150,new ib(sa))})}},1191:function(t,
C,a){var c=a(10);t=a(0);var b=a(221),d=a(185);const f={average:0,max:0,median:0,P75:0,P95:0},e={selectByArrowKeyCounter:0,selectByMouseHoverCounter:0,commitByTabKeyCounter:0,commitByEnterKeyCounter:0,commitByMouseClickCounter:0,commitWhileRequestPending:0,dismissSmartSuggestionExplicitlyCounter:0,dismissSmartSuggestionImplicitlyCounter:0},k={formulaAssistanceRequestAttemptedCounter:0,formulaAssistanceRequestOptimizedCounter:0},l={argumentAssistanceCardInitialMode:void 0,argumentAssistanceCollapseCounter:0,
argumentAssistanceExpandCounter:0,argumentAssistanceLearnMoreCounter:0,argumentAssistanceDismissCounter:0,argumentAssistanceDragCounter:0,argumentAssistanceDragTotalCounter:0,argumentAssistanceMoveCounter:0,argumentAssistanceMoveTotalCounter:0},m={smartSuggestionShownCounter:0,smartSuggestionSelectedCounter:0,smartSuggestionCommittedCounter:0,smartSuggestionKeptCounter:0,isCellContentOnlyEqualDuringEditCounter:0,isCellContentFormulaCounter:0,smartSuggestionWouldSuggestInsidePivotCounter:0},v={dialogCommitedCounter:0,
dialogShownCounter:0,argsDialogOpenedByRibbonCounter:0,argsDialogOpenedByDialogCounter:0,argsDialogCommitedCounter:0},n={count:0,countAboveThresholds:void 0,failedCount:0,firstAction:0,includingFirstAction:Object.assign({},f),excludingFirstAction:Object.assign({},f)},w={argumentAssistanceFlight:void 0,autoCompleteUIFlight:void 0,smartFormulaBarAutoCompleteFlight:void 0,smartFormulaBarAutoCompletePluginFlight:void 0,anyPluginInitialized:void 0,formulaAssistanceRedesignFlight:void 0,NewInsertFunctionDialogFlight:void 0,
smartFormulaSuggestionsFeatureEnabled:void 0};var r=a(58),u=a(109),y=a(28),x=a(1);class B{constructor(M){this.Dpf=M;this.i_=Object.assign({},n);this.f6b=[];this.Pjc=-1;(this.Cpf=x.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&M&&(this.i_.countAboveThresholds={},M.forEach(G=>this.i_.countAboveThresholds[G]=0))}iSa(){this.Pjc=y.a.Wa.je.m}Wha(M){-1!==this.Pjc&&(M?(this.pmb(y.a.Wa.je.m-this.Pjc),this.Pjc=-1):this.i_.failedCount++)}jzh(){this.i_.excludingFirstAction=
B.ARe(this.f6b);this.f6b.push(this.i_.firstAction);this.i_.includingFirstAction=B.ARe(this.f6b)}pmb(M){this.i_.count?1E3>this.i_.count&&this.f6b.push(M):this.i_.firstAction=M;this.Cpf&&this.Dpf&&this.Dpf.forEach(G=>{M>G&&this.i_.countAboveThresholds[G]++});this.i_.count++}static ARe(M){const G=Object.assign({},f);0<M.length&&(u.i(M),G.median=M[Math.floor(.5*M.length)],G.P75=M[Math.floor(.75*M.length)],G.P95=M[Math.floor(.95*M.length)],G.max=M[M.length-1],G.average=u.g(M,T=>T)/M.length);return G}}
Object(t.a)(B,"PerformanceMeasurement",null,[]);var z=a(22),A=a(41),I=a(21),F=a(99),U;(function(M){M[M.function=3]="function";M[M.namedRange=100]="namedRange";M[M.tableHeader=101]="tableHeader";M[M.letVariable=102]="letVariable";M[M.richEntity=103]="richEntity";M[M.lambda=104]="lambda";M[M.customFunction=105]="customFunction";M[M.table=106]="table";M[M.tableSpecialStructRef=107]="tableSpecialStructRef";M[M.richEntityEmptyCellRef=108]="richEntityEmptyCellRef"})(U||(U={}));Object(t.b)("CompletionItemKind",
U);var X=a(33);const S={["argumentAssistanceOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverallSimpleAndSmart"]:[50,80,100,130,150,170,200],["autoCompleteOverallSmartOnly"]:[50,80,100,130,150,170,200],["autoCompleteOverallSimpleOnly"]:[50,80,100,130,150,170,200]};class H{constructor(M){this.$=M;this.TH=null;this.RAb=-1;this.lic=null;this.mic=0;this.r9=Object.assign({},l);this.CM=Object.assign({},m);this.tJ=Object.assign({},e);this.Vnb=Object.assign({},
k);this.C6=Object.assign({},w);this.Wnb={};this.H2a=Object.assign(Object.assign({},v),{isReactDialog:X.a.aod()});this.Jf=(G,T)=>{null!=this.TH&&(1==Math.abs(this.RAb-this.$.ea.Ke)&&(G=this.$.xa.pa.sheetId,T.Rpb&&T.Ck.equals(this.TH.Ck)&&this.lic===G&&this.TH.cpb!==T.cpb&&this.mic++),1<=Math.abs(this.RAb-this.$.ea.Ke)&&(this.TH=null,this.RAb=-1,this.lic=null))};this.Ec=()=>{this.ysj();this.S8&&this.Isj();this.$.sendBeaconTraceTag(88392384,50,!1,"{0}",this.getJsonForLogging())};this.S8=x.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");
this.n$a=new F.a;M.kk(this.Ec);this.S8&&I.g(this.$).Di.em(this.Jf)}dispose(){this.$&&this.S8&&I.g(this.$).Di.yl(this.Jf)}dG(M){M.forEach(G=>{this.n$a.mb(G)||this.n$a.ia(G,new B(S[G]));this.n$a.na(G).iSa()})}UE(M,G=!0){M.forEach(T=>{this.n$a.mb(T)&&this.n$a.na(T).Wha(G)})}KXf(M){let G="Undefined";switch(M){case 1:G="Collapsed";break;case 0:G="Expanded";break;case 2:G="Hidden"}this.r9.argumentAssistanceCardInitialMode=G}lIa(M){window.requestAnimationFrame(()=>{this.UE([M])})}T8e(M){M.forEach(G=>{G=
U[G.kind];this.dfg(G);this.Wnb[G].shownCounter++})}S8e(M){M=U[M];this.dfg(M);this.Wnb[M].committedCounter++}getJsonForLogging(){return"{"+this.BT("SessionDetails",this.C6)+","+this.BT("ArgumentAssistanceUsage",this.r9)+","+this.BT("FormulaSuggestionsUsage",this.CM)+","+this.BT("FunctionDialogUsage",this.H2a)+","+this.BT("AutocompleteCardInteraction",this.tJ)+","+this.BT("AutocompleteRenderOptimization",this.Vnb)+","+this.BT("AutocompleteUsageByKind",this.Wnb)+","+this.ZVh()+"}"}Isj(){this.CM.smartSuggestionKeptCounter=
this.CM.smartSuggestionCommittedCounter-this.mic}ysj(){this.C6.argumentAssistanceFlight=this.s3a("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.C6.autoCompleteUIFlight=this.s3a("Microsoft.Office.Excel.","AutoCompleteNewUI");this.C6.smartFormulaBarAutoCompleteFlight=this.s3a("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled");this.C6.smartFormulaBarAutoCompletePluginFlight=this.s3a("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled");this.C6.formulaAssistanceRedesignFlight=
this.s3a("Microsoft.Office.Excel.","FormulaAssistanceRedesign");this.C6.NewInsertFunctionDialogFlight=this.s3a("Microsoft.Office.Excel.","NewInsertFunctionDialog");this.C6.smartFormulaSuggestionsFeatureEnabled=X.a.VU(this.$)}ZVh(){const M=new d.a;for(let G of this.n$a)G.value.jzh(),M.add(`"${G.key}":${r.a.Ac(G.value.i_)}`);return`"PerfMeasurements": {${M.toArray().join(",")}}`}s3a(M,G){return z.a.contains(this.$.ya.FlightHolder.FlightId,G,!0)?x.EwaSettings.getBooleanFeatureGate(M+G,!1)?"T":"C":"None"}BT(M,
G){return`"${M.toString()}":${A.c(G)}`}dfg(M){this.Wnb[M]||(this.Wnb[M]={shownCounter:0,committedCounter:0})}}Object(t.a)(H,"FormulaAssistanceTelemetryManager",null,[545]);class D extends b.a{constructor(M){super();this.$=M;this.Fb()}static ka(M){M.da.Ga(492,new D(M))}create(){var M;this.qb(null!==(M=this.$.da.za(491))&&void 0!==M?M:this.$.da.Ga(491,new H(this.$)))}}Object(t.a)(D,"FormulaAssistanceTelemetryManagerFactory",b.a,[]);a.d(C,"a",function(){return J});const J=()=>{c.a.Fa(M=>{D.ka(M)})}},
1210:function(t,C,a){a.r(C);t=a(0);var c=a(15),b=a(275),d=a(91),f=a(39),e=a(262),k=a(546),l=a(4),m=a(84),v=a(412),n=a(714),w=a(8),r=a(31),u=a(19),y=a(60),x=a(5),B=a(783),z=a(1042),A=a(834),I=a(14),F=a(33);class U{constructor(Wb,Ea,ua,ma,fb,sb,Ua,ab){this.$=Ea;this.Sa=ua;this.kl=ma;this.selectedRanges=fb;this.grid=sb;this.wy=ab;this.Y3=Ua;this.qga=e.a.all(fb,na=>na.isRow);this.vra=e.a.all(fb,na=>na.Ze);this.TCb=e.a.all(fb,na=>!na.isRow&&!na.Ze);Ea=sb.Db.Dfd(fb);this.Fqb=!!Ea;this.bRf=!!Ea&&Ea.hasActiveFilter;
this.menuSection=ua.zc();Wb.nc.push(this.menuSection);this.Kaa=this.qga||this.vra?this.menuSection:ua.zc();this.hta=this.qga||this.vra?this.menuSection:ua.zc()}fbd(){this.GEh();this.jEh();const Wb=this.wy.E6a(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Sa.pb(Wb?149:148))}MEh(){let Wb=0;this.Fqb?this.Y3.mm(942362098)?Wb=this.wy.mm(this.kl,942362098,this.selectedRanges,this.grid)?161:169:this.bRf&&(Wb=this.wy.mm(this.kl,-1113896058,this.selectedRanges,this.grid)?177:181):this.Y3.mm(-1113896058)&&
(Wb=this.qga?this.wy.mm(this.kl,-1113896058,this.selectedRanges,this.grid)?49:116:this.wy.mm(this.kl,-1113896058,this.selectedRanges,this.grid)?177:181);0!==Wb&&this.Kaa.buttons.push(this.Sa.pb(Wb))}LEh(){let Wb;!this.Fqb&&this.Y3.mm(-1113896058)&&(Wb=this.qga?this.wy.mm(this.kl,-1113896058,this.selectedRanges,this.grid)?295:296:this.wy.mm(this.kl,-1113896058,this.selectedRanges,this.grid)?297:298,this.Kaa.buttons.push(this.Sa.pb(Wb)))}HEh(){let Wb=0;this.Fqb?this.Y3.mm(622604322)&&(Wb=this.grid.rtl?
this.wy.mm(this.kl,622604322,this.selectedRanges,this.grid)?191:192:this.wy.mm(this.kl,622604322,this.selectedRanges,this.grid)?162:170):this.Y3.mm(1415868706)&&(Wb=this.vra?this.wy.mm(this.kl,1415868706,this.selectedRanges,this.grid)?50:117:this.wy.mm(this.kl,1415868706,this.selectedRanges,this.grid)?178:182);0!==Wb&&this.Kaa.buttons.push(this.Sa.pb(Wb))}FEh(){this.Y3.mm(1035996630)&&(this.wy.mm(this.kl,1035996630,this.selectedRanges,this.grid)?(this.Kaa.buttons.push(this.Sa.pb(this.grid.rtl?187:
165)),this.Kaa.buttons.push(this.Sa.pb(166))):(this.Kaa.buttons.push(this.Sa.pb(this.grid.rtl?188:173)),this.Kaa.buttons.push(this.Sa.pb(174))))}GEh(){const {GridContextMenu:Wb}=a(1210);let Ea=null;this.TCb&&(Ea=this.Sa.Ru("ContextMenu.InsertCells",null,I.a.instance.ga(350),1896159024),Ea.menu.nc.push(this.Kaa));Wb.IEh(this.Kaa,this.Sa,this.$);this.MEh();l.AFrameworkApplication.XH("XLS-InsertRowsBelowExperiment-Treatment;XLS-InsertRowsBelowExperiment-Control");F.a.ynd()&&this.LEh();this.HEh();this.FEh();
Ea&&0<this.Kaa.buttons.length&&this.menuSection.buttons.push(Ea)}lEh(){let Wb=0;this.Fqb?this.Y3.mm(1405456548)?Wb=this.wy.mm(this.kl,1405456548,this.selectedRanges,this.grid)?163:171:this.bRf&&(Wb=this.wy.mm(this.kl,1554436520,this.selectedRanges,this.grid)?179:183):this.Y3.mm(1554436520)&&(Wb=this.qga?this.wy.mm(this.kl,1554436520,this.selectedRanges,this.grid)?51:118:this.wy.mm(this.kl,1554436520,this.selectedRanges,this.grid)?179:183);0!==Wb&&this.hta.buttons.push(this.Sa.pb(Wb))}kEh(){let Wb=
0;this.Fqb?this.Y3.mm(284490184)&&(Wb=this.wy.mm(this.kl,284490184,this.selectedRanges,this.grid)?164:172):this.Y3.mm(674605324)&&(Wb=this.vra?this.wy.mm(this.kl,674605324,this.selectedRanges,this.grid)?52:119:this.wy.mm(this.kl,674605324,this.selectedRanges,this.grid)?180:184);0!==Wb&&this.hta.buttons.push(this.Sa.pb(Wb))}iEh(){this.Y3.mm(1035996630)&&(this.wy.mm(this.kl,1035996630,this.selectedRanges,this.grid)?(this.hta.buttons.push(this.Sa.pb(this.grid.rtl?189:167)),this.hta.buttons.push(this.Sa.pb(168))):
(this.hta.buttons.push(this.Sa.pb(this.grid.rtl?190:175)),this.hta.buttons.push(this.Sa.pb(176))))}jEh(){let Wb=null;this.TCb&&(Wb=this.Sa.Ru("ContextMenu.DeleteCells",null,I.a.instance.ga(414),-1554384558),Wb.menu.nc.push(this.hta));this.lEh();this.kEh();this.iEh();Wb&&0<this.hta.buttons.length&&this.menuSection.buttons.push(Wb)}}Object(t.a)(U,"CellsContextMenuGenerator",null,[]);class X{constructor(Wb){this.ranges=null;this.ranges=Wb}}Object(t.a)(X,"MacroRecorderRangeHyperlinkRemovedPayload",null,
[101]);var S=a(523),H=a(24),D=a(102),J=a(77),M=a(74),G=a(43),T=a(170),K=a(61),L=a(601),V=a(145),W=a(37),da=a(453),qa=a(554),O=a(1),ea=a(182),R=a(21),oa=a(369),pa=a(34),Pa=a(50),Z=a(239),Ra=a(22),Ga=a(30),Ba=a(1068),fa=a(904),Y=a(131),ja=a(513),ca=a(368),aa=a(247),ta=a(162),xa=a(153),ia=a(340),ya=a(90),ib=a(29),wa=a(281),sa=a(280),Ya=a(132),bb=a(767),mb=a(768),Ca=a(112),$a=a(41),Kb=a(55),rb;(function(Wb){Wb[Wb.none=0]="none";Wb[Wb.once=1]="once";Wb[Wb.twice=2]="twice"})(rb||(rb={}));Object(t.b)("ToggleState",
rb);class cc{constructor(Wb,Ea,ua,ma){this.uVc=this.$db=this.beb=0;this.$=Wb;this.gridView=R.g(this.$);this.namedSheetViewPublic=Ea;this.ug=ua;this.instantaneousSupportInformationManager=ma;this.WLa=bb.a.uld()}lgh(){var Wb=this.yU();Wb={["CommandValueId"]:$a.c(Wb)};const Ea=new ya.a(-2058042992,2,this.$.Mc,19,null);c.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ka.Mb(Ea,Wb)}Bgh(){const Wb=new ya.a(644342024,2,this.$.Mc,
19,null);c.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");return this.$.Ka.Mb(Wb)}qgh(){const Wb=this.gridView.ha.sa.activeCell,Ea=this.$.da.za(66).Jg,ua=this.$.da.za(66).eub(Wb);return Ea||ua?this.sgh(Ea,ua,Wb):this.rgh(Wb)}sgh(Wb,Ea,ua){if(this.UVg(Wb,Ea,ua))return c.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),Kb.Task.Ta(!1);if(null!=
Wb&&Wb.hasAutoFilter||null!=Ea&&Ea.KZa.every(ma=>0!=ma.length))return this.beb=rb.none,this.sVc();this.beb=rb.once;return this.O5b(rb.once)}rgh(Wb){var Ea=G.v(this.gridView.ha.sa.Wc,this.$);Ea=this.gridView.$.xa.getItemByName(Ea.SheetName);const ua=G.D(Ea.$_);if(this.TVg(ua,Wb))return c.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),Kb.Task.Ta(!1);if(Ea.hasAutoFilter){if(ua&&ua.contains(this.gridView.ha.sa.activeCell))return this.beb=
rb.none,this.sVc();this.beb=rb.twice;return this.O5b(rb.twice)}this.beb=rb.once;return this.O5b(rb.once)}O5b(Wb){const Ea=G.v(this.gridView.ha.sa.Wc,this.$);if(!Ea)return Kb.Task.Ta(!1);this.$db||(this.$db=Date.now());const ua=new ya.a(368460465,2,this.$.Mc,19,null),ma=this.$.oa.va.Sb(),fb=()=>new Ba.a(Ea),sb=Ua=>{wa.a(Ua)?c.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}"):(c.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),
Wb===rb.twice?this.O5b(rb.once):this.sVc())};return O.EwaSettings.dc()?ca.a(this.$.userOperationManager,(Ua,ab,na)=>aa.A(this.$.oa.va,Ea,sa.b(Ua,sb),ab,na,null,ma),Ua=>new T.a(516,0,Ua,64,fb),ua):ca.a(this.$.userOperationManager,(Ua,ab,na)=>aa.A(this.$.oa.va,Ea,sa.b(Ua,sb),ab,na,null,ma),Ua=>new ja.a(516,0,Ua,void 0,fb),ua)}UVg(Wb,Ea,ua){return null!=Wb&&ta.d(Wb)&&ua.top===Wb.usedRange.top||null!=Ea&&Ea.yaa&&ua.top===Ea.top?(this.Rpc(this.$,225),!0):null!=Wb&&ta.g(Wb)&&ua.top===Wb.usedRange.bottom?
(this.Rpc(this.$,226),!0):!1}TVg(Wb,Ea){if(Wb&&Wb.contains(Ea)&&Ea.top===Wb.top||!Wb&&this.YUg(Ea.top,Ea.left))return this.Rpc(this.$,227),!0;Wb=new H.Range(Ea.top,Ea.left,Ea.top+1,Ea.left+1,!1,!1);return this.gridView.Db.zwa(Wb)?(this.Rpc(this.$,228),!0):!1}Rpc(Wb,Ea){Ea=ib.a.Yc(1,1,756,Ea,0,147079615,"ContextMenuFilterByCellValueError");O.EwaSettings.wz()?new ia.a(Wb,Ea):(Wb=new xa.ErrorDialog(Wb,Ea),Wb.initialize(),Wb.Ff())}sVc(){this.uVc=Date.now();const Wb=this.BZh();if(!Wb)return c.ULS.sendTraceTag(527500296,
0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),Kb.Task.Ta(!1);const Ea=this.yU(),ua={FirstRow:0};ua.FirstColumn=Ea.Column;ua.SheetName=Ea.SheetName;Ya.b(this.$).Cd(Y.a.qtf,this.km(),void 0,!0);const ma=this.f2c(Ea,ua),fb=Ua=>{c.ULS.sendTraceTag(527500295,0,50,`GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : ${JSON.stringify({["ToggleFilterOperationCount"]:this.beb,["ApplyFilterTime"]:this.uVc?Date.now()-this.uVc:-1,["ToggleAndApplyFilterTime"]:this.$db?Date.now()-
this.$db:-1,["FilterByValueType"]:Ea.AutoFilterType})}`);this.$db&&(this.$db=0);if(bb.a.iwc(Ua)){const ab=bb.a.O9b(Ua);this.WLa?bb.a.WPa(mb.a.filterByCellValue,ab.MessageIdName,Ca.a.Lra,!0,bb.a.isSessionEndingError(ab.MessageId)):c.ULS.sendTraceTag(527500294,0,10,`GridContextMenuFilter::ApplyFilterByValue failed with FilterException -${ab.MessageIdName}`)}wa.a(Ua)?(Ua=ib.a.yc(Ua.Errors),c.ULS.sendTraceTag(527500292,0,50,`GridContextMenuFilter::ApplyFilterByValue service call failed with errors : ${Ua}`)):
(c.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),Ya.b(this.$).Cd(Y.a.Swf,this.km(),void 0,!0),Ua={},Ua.FirstRow=this.nNh(),Ua.FirstColumn=Ea.Column,-1!==Ua.FirstRow&&(Ua=G.C(Ua),this.sL(Ua)))},sb=new T.a(208,0,(Ua,ab,na)=>K.a(this.$.oa.va,ma,Wb,sa.b(Ua,fb),ab,na,null,null),6,()=>new fa.a(Wb,ma));this.namedSheetViewPublic?this.namedSheetViewPublic.ORa().continueWith(Ua=>{Ua.result&&this.$.userOperationManager.Ub(sb,null)}):this.$.userOperationManager.Ub(sb,
null);return Kb.Task.Ta(!0)}sL(Wb){F.a.gba(this.$)&&W.TaskExtensions.Aa(Pa.GetServiceTaskFactory.Ra(this.$.da,430,431,1),Ea=>{Ea.result.g7(Wb);c.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},this.$.la,3)}km(){return{["Location"]:"contextMenu"}}yU(){var Wb=0,Ea=this.gridView.ha.sa.activeCell;var ua=this.$.da.za(66).Jg;const ma=this.$.da.za(66).eub(Ea);if(ua){var fb="Table";Wb=ua.objectId}else ma?(fb="Table",
Wb=ma.id):fb="Sheet";ua=Ea.left;Ea={};Ea.AutoFilterType=fb;Ea.Column=ua;Ea.Id=Wb;fb={};this.$.Xj(fb);fb.FirstRow=0;fb.FirstColumn=Ea.Column;Wb=this.$.ea.isNamedObjectViewMode;Ea.NamedObjectView=Wb;Ea.SheetName=Wb?fb.NamedObjectName:fb.SheetName;Ea.ItemListOptions=null;return Ea}YUg(Wb,Ea){Wb=H.Range.Uc(Wb,Ea);return this.gridView.Ea.z9(Wb,this.$.pa.name)&&(Wb=this.gridView.Ea.OJa(Wb))&&Wb.autoFilterMenu?!0:!1}BZh(){var Wb=null;const Ea=this.gridView.Vb(this.gridView.ha.sa.activeCell);if(!Ea)return null;
const ua=Ea.cell.uxc;let ma;({category:ma}=this.instantaneousSupportInformationManager.ZAa(ua,!1));if(1===Ea.Sw.type)if(3===ma){if(!Ea.cell.ONa)return c.ULS.sendTraceTag(527500290,0,15,`GridContextMenuFilter::GetValueForFilter() for category : ${ma}. NumFmt is null. `),null;Wb=(Ea.cell.ONa.Start+Ea.cell.ONa.End).trim()}else if(!ma&&(Ra.a.V_a(Ea.Sw.value,"E")||Ra.a.V_a(Ea.originalText,"E"))){Wb=this.ug.wTe(Ea.Sw.value,ua,1,Number.POSITIVE_INFINITY,Ea.cell.zha);if(!Wb.success)return c.ULS.sendTraceTag(527500289,
0,50,`GridContextMenuFilter::GetValueForFilter() for category : ${ma}. Failed to acquire formatted value`),null;Wb=Wb.Nx}Wb||(Wb=Ea.originalText);return Ga.a.TZc(Wb)?["[Blanks]"]:["i"+Wb.trim()]}nNh(){const Wb=this.gridView.ha.sa.activeCell;var Ea=this.$.da.za(66).Jg;const ua=this.$.da.za(66).eub(Wb);if(Ea)return Ea.usedRange.top;if(null!=ua)return ua.top;Ea=this.$.xa.getItemByName(this.$.pa.sheetName);return(Ea=G.D(Ea.$_))&&Ea.contains(Wb)?Ea.top:-1}f2c(Wb,Ea){const ua={};ua.Location=Ea;ua.FieldId=
Wb.Id.toString();ua.DataSourceIndex=-1;ua.FilterType=Wb.AutoFilterType;ua.AnchorType=0;ua.ChartId=null;ua.AnchorValue1=-1;ua.AnchorValue2=-1;ua.Property=Wb.RichProperty;return ua}}Object(t.a)(cc,"GridContextMenuFilter",null,[]);a.d(C,"GridContextMenu",function(){return nc});class nc extends n.a{constructor(Wb,Ea,ua,ma){super(Wb,"PopulateGridContextMenu",1247109494,-2064931494,nc.l0h,!0,!1,nc.KIb,Ea,ua,!0,ma);this.chc=this.expandCollapse=this.refresh=this.yY=this.yva=this.iAa=!1;this.$Ce=!0;this.grid=
R.g(Wb);this.Rjc=!0;if(this.Eec=O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1)){const fb=Pa.GetServiceTaskFactory.Ra(this.$.da,309,310,3),sb=Pa.GetServiceTaskFactory.create(this.$.da,18,this.la,3);W.TaskExtensions.Aa(W.TaskExtensions.Wd([fb,sb],this.la),()=>{this.$.da.Za(268,Ua=>{this.g4a=new cc(Wb,fb.result,sb.result,Ua)})},this.la,3)}}get Bw(){return"PopulateGridContextMenu"}get wB(){return x.a.iLf}dispose(){super.dispose();this.grid=null}Nc(Wb,Ea){Wb=
!this.apd(Wb,Ea);if(!Wb)switch(Ea){case -1977666927:Wb=null==this.g4a||this.Qvj();break;case 1549396389:Wb=null==this.g4a||!this.yei();break;case 2045563128:case 1803952894:Wb=null==this.g4a||!this.$.isEditMode&&!this.zei()}return Wb}apd(Wb,Ea){const ua=this.grid.ha.sa.selectedRanges;return(new V.a(this.$.xa)).mm(Wb,Ea,ua,this.grid)}executeCommand(Wb,Ea,ua){const ma=Ea.command;Wb=null;switch(ma){case -1396319072:if(Ea=this.grid.Vb(null))b.a.instance.GYc(!0),d.EventHandlerManager.instance.sad(),nc.RTi(Ea);
break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.sa.selectedRanges,Ea);break;case 324156914:Wb=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(ua);break;case -1977666927:Wb=this.g4a.lgh();break;case 1549396389:Wb=this.g4a.Bgh();break;case 1803952894:Wb=this.g4a.qgh();break;default:Wb=ea.a(ma)}return Wb||W.TaskExtensions.raa()}Cc(Wb,Ea,ua){Wb=!1;switch(Ea.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:Wb=
!0;break;case 1441131127:Wb=!!ua}return Wb}hY(Wb=!1){let Ea=!1,ua=!1,ma=0;O.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(ma=f.a.Sd());const fb=this.Sa.sq(this.menuId);var sb=this.grid.ha.sa;const Ua=sb.wg,ab=Ua&&sb.Wc.Ze,na=Ua&&sb.Wc.isRow;sb=sb.selectedRanges;const Na=e.a.all(sb,Oa=>Oa.Ze),Va=e.a.all(sb,Oa=>Oa.isRow),Sa=G.O(sb),vb=G.P(sb);this.Mef(ab,na)?(Ea=!0,this.pFh(fb)):this.$.isEditMode?oa.a(this.$)?this.qFh(fb,ab,na):(this.mEh(fb,!(na||ab||
!this.chc)),this.JEh(fb,sb,Wb),this.cEh(fb),this.yEh(fb,Na,Va,Sa,vb),this.LUe(fb,Ua,ab,na),this.IFh(fb),this.qUe(fb,ab,na),this.fFh(fb,Ua,ab,na,sb),this.pEh(fb),this.nEh(fb,sb),this.REh(fb),this.DFh(fb,Ua),O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.DEh(fb)):(ua=!0,oa.a(this.$)?this.GUe(fb):this.YFh(fb,Ua,ab,na,sb));O.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Wb=f.a.Sd()-ma,c.ULS.sendTraceTag(537167046,
0,50,`GridContextMenu::CreateMenuModel, ExecutionTimeTotal: ${Wb}, isPivotMenu: ${Ea}, isViewMenu: ${ua}, firstTimeEntry: ${this.$Ce}`));this.$Ce=!1;return fb}DJa(Wb){const Ea=[];if(oa.a(this.$))return Ea;if(3===Wb){Wb=this.grid.ha.sa;const ma=Wb.wg,fb=ma&&Wb.Wc.Ze,sb=ma&&Wb.Wc.isRow;let Ua=!1;var ua=!1;let ab=!1;this.$.isMobileMode&&(ua=Wb.selectedRanges,Ua=G.O(ua),ua=G.P(ua));if(ma){const na=R.e(this.grid);na&&na.range.contains(Wb.Wc)&&this.WU(na)&&(ab=!0)}this.$.isEditMode?this.Mef(fb,sb)?Ea.push(...[A.a.fGf,
A.a.hGf]):fb||sb?(Ea.push(A.a.clipboard),sb?Ea.push(A.a.Xhj):fb&&Ea.push(A.a.qZg)):(Ea.push(...[A.a.edit,A.a.clipboard]),ab?Ea.push(A.a.hyperlink):Ea.push(A.a.color),ma&&Ea.push(A.a.xMg)):(Ea.push(A.a.copy),ab&&Ea.push(A.a.openHyperlink),!sb||this.$.isMobileMode&&ua?!fb||this.$.isMobileMode&&Ua||Ea.push(A.a.YVj):Ea.push(A.a.ZVj));Ea.push(A.a.c0h)}else 2===Wb&&Ea.push(A.a.gwe);return Ea}Mef(Wb,Ea){return(this.iAa||this.yva||this.yY||this.refresh||this.expandCollapse)&&!(Wb||Ea)}showGridContextMenu(Wb){this.expandCollapse=
this.refresh=this.yY=this.yva=this.iAa=!1;var Ea=this.$,ua=da.a(Ea).SJa(),ma=this.grid.ha.sa;const fb=ma.wg;var sb=fb&&ma.Wc.Ze;ma=fb&&ma.Wc.isRow;if(ua&&!sb&&!ma){sb=qa.a(Ea);if(null===sb||void 0===sb?0:sb.XPd)this.iAa=sb=D.f(Ea.pg),this.yva=!sb;sb=Ea.jc;this.yY=ua.supportsBIExplore&&!!B.a(Ea)&&sb.R1(32768);sb.allowInteractivity&&(Ea=this.grid.Vb(null),(null===Ea||void 0===Ea?0:Ea.cell)&&(Ea.cell.vYc||Ea.cell.Q1f)&&(this.expandCollapse=!0),sb.allowManualDataRefresh&&(this.refresh=!0))}Ea=null;ua=
1;sb=Object(m.a)(k.a,Wb.eventArgs);Wb=Object(m.a)(z.a,Wb.creationParams);ma=this.sKh();Wb?(Ea=Wb.clientPoint,ua=Wb.inputMethod):sb&&1!==sb.tb?(Ea=new Sys.UI.Point(sb.clientPoint.x,sb.clientPoint.y),ua=sb.tb):ma&&(Ea=new Sys.UI.Point(ma.x+(this.$.isChromeRtl?0:ma.width),ma.y+ma.height));J.a.Eb=ua;this.chc=3===ua;Wb=r.a.Psb;this.Bp(Ea,!sb||sb.Ca.target.className!==Wb,ua)}removeHyperlinksFromRange(Wb,Ea){if(!O.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||
this.$.rq(Wb,!0)){var ua=G.r(Wb,this.$),ma=this.$.oa.va.Sb();this.$.userOperationManager.Ub(new T.a(125,0,(fb,sb,Ua)=>{this.$.ry();return K.b(this.$.oa.va,ua,"","",!0,!1,127,fb,sb,Ua,null,ma)},void 0,()=>new X(ua)),Ea);this.grid.Df.XG(!1)}}sKh(){var Wb=this.grid.Vb(null);if((null===Wb||void 0===Wb?0:Wb.cell.Dk)&&this.Vdf(Wb))return this.grid.getCellBounds(Wb.cell);Wb=this.grid.ha.sa.activeCell;return(Wb=this.x8b(new H.Range(Wb.top,Wb.left,w.a.dh,Wb.left,!1,!1),2,!0)||this.x8b(new H.Range(1,Wb.left,
Wb.top,Wb.left,!1,!1),2,!1)||this.x8b(new H.Range(Wb.top,Wb.right,Wb.top,w.a.mh,!1,!1),1,!0)||this.x8b(new H.Range(Wb.top,1,Wb.top,Wb.right,!1,!1),1,!1)||null)&&Wb.Dk?this.grid.getCellBounds(Wb):Sys.UI.DomElement.getBounds(this.grid.sva.mc)}Vdf(Wb){var Ea=this.grid.rtl,ua=this.$.isChromeRtl;Wb=Wb.cell;var ma=R.g(this.$).WJ(Wb);return ma?(ma=ma.topLeft,Ea=ma.x+=Ea===ua?Wb.offsetWidth:0,ua=ma.y+=Wb.offsetHeight,this.grid.view.visibleArea.contains(new y.a(Ea,ua,0,0))):!1}x8b(Wb,Ea,ua){Wb=this.grid.mk("GridContextMenu.FindFirstCellInViewportArea",
Wb,Ea,ua);try{for(Wb.$$rst();Wb.$$mn();){const ma=Wb.$$cu();if(ma&&this.Vdf(ma))return ma.cell}}finally{Wb&&Wb.dispose()}return null}pFh(Wb){const Ea=this.Sa,ua=Ea.zc();this.refresh&&ua.buttons.push(Ea.pb(100));this.yY&&ua.buttons.push(Ea.pb(99));this.iAa?ua.buttons.push(Ea.pb(59)):this.yva&&ua.buttons.push(Ea.pb(58));if(this.expandCollapse){let ma;ma=Ea.Ru("ContextMenu.PivotExpandCollapse",null,I.a.instance.ga(1165),589118293);const fb=Ea.zc();fb.buttons.push(Ea.pb(243));fb.buttons.push(Ea.pb(244));
fb.buttons.push(Ea.pb(245));fb.buttons.push(Ea.pb(246));ma.menu.nc.push(fb);ma&&0<fb.buttons.length&&ua.buttons.push(ma)}Wb.nc.push(ua)}LUe(Wb,Ea,ua,ma){if(Ea&&!ua&&!ma){Ea=this.Sa.zc();this.Eec&&!this.$.mK&&this.jbd(Ea);this.qbd(Ea);this.MFh(Ea);if(O.EwaSettings.ma(479)&&R.g(this.$).ha.sa.FH()&&R.g(this.$).ha.sa.C4)switch(O.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Ea.buttons.push(this.Sa.pb(237));break;case 2:Ea.buttons.push(this.Sa.pb(238));
break;default:Ea.buttons.push(this.Sa.pb(236))}Wb.nc.push(Ea)}}qbd(Wb){if(this.$.jc.allowSorting&&(!this.$.isMobileMode||(new V.a(this.$.xa)).Ud(2048))){var Ea=this.Sa.zc();Ea.buttons.push(this.Sa.pb(223));Ea.buttons.push(this.Sa.pb(224));O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PutSelectedItemOnTop",!1)&&(Ea.buttons.push(this.Sa.pb(292)),Ea.buttons.push(this.Sa.pb(293)),Ea.buttons.push(this.Sa.pb(294)));this.$.isMobileMode||Ea.buttons.push(this.Sa.pb(225));var ua=this.Sa.Ru("ContextMenu.sort",
null,I.a.instance.ga(229),-864298118);ua.menu.nc.push(Ea);Wb.buttons.push(ua)}}cEh(Wb){l.AFrameworkApplication.XH("XLS-CreateSampleTable-Treatment;XLS-CreateSampleTable-Control");if(O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateSampleTable",!1)){var Ea=this.Sa.zc();Ea.buttons.push(this.Sa.pb(299));var ua=this.Sa.Ru("ContextMenu.createSampleTable",null,I.a.instance.ga(1966),-605127244);ua.menu.nc.push(Ea);Ea=this.Sa.zc();Ea.buttons.push(ua);Wb.nc.push(Ea)}}jbd(Wb){const Ea=this.Sa.Ru("ContextMenu.filter",
null,I.a.instance.ga(1969),2045563128),ua=this.Sa.zc();var ma=this.QOh();const fb=this.Sa.pb(234);fb.label=ma;ua.buttons.push(fb);ua.buttons.push(this.Sa.pb(235));ma=this.Sa.zc();ma.buttons.push(this.Sa.pb(233));Ea.menu.nc.push(ua);Ea.menu.nc.push(ma);Wb.buttons.push(Ea)}MFh(Wb){if(R.g(this.$).ha.sa.FH()){const Ea=this.Sa.zc();Ea.buttons.push(this.Sa.pb(232));O.EwaSettings.isChangeGateEnabled("OfficeVSO:6680193_FlighRemovalTableAltText")&&(Ea.buttons.push(this.Sa.pb(285)),Ea.buttons.push(this.Sa.pb(286)));
const ua=this.Sa.Ru("ContextMenu.table",null,I.a.instance.ga(1968),-697806646);ua.menu.nc.push(Ea);Wb.buttons.push(ua)}}BUe(Wb,Ea,ua,ma,fb){if(Ea){const Ua=G.K(fb);var sb=R.e(this.grid);if(sb&&!ua&&!ma){ua=new V.a(this.$.xa);if(sb.range.contains(Ua)&&this.WU(sb)){(Ea=!sb.MLa&&!ua.li)&&this.$.isEditMode&&Wb.buttons.push(this.Sa.pb(45));sb.waa&&Wb.buttons.push(this.Sa.pb(53));Ea&&this.$.isEditMode&&Wb.buttons.push(this.Sa.pb(47));return}!sb.MLa&&this.$.isEditMode&&(sb=ua.Ud(128),Wb.buttons.push(this.Sa.pb(sb?
46:121)))}}this.M3i(fb)&&Wb.buttons.push(this.Sa.pb(48));(sb=this.$.xa.pa)&&sb.Ed&&(sb=sb.Ed.lv||sb.Ed.OH,!Ea||this.$.mK||!O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||sb||(Ea=G.K(fb),this.L3i(Ea)?Wb.buttons.push(this.Sa.pb(276)):Ea.Ze||Ea.isRow||Wb.buttons.push(this.Sa.pb(275))))}M3i(Wb){for(const Ea of Wb){Wb=this.grid.getRangeInformation(Ea);for(let ua=0;ua<Wb.length;ua++)if(Object(v.a)(S.HyperlinkRange,
Wb[ua])){const ma=this.grid.Vb(Wb[ua]);if(ma&&this.WU(ma)&&!ma.MLa)return!0}}return!1}L3i(Wb){if(R.g(this.$).ha.sa.FH()){const Ea=R.g(this.$).Db.Yj(Wb);if(Ea&&Ea.usedRange.equals(Wb))return!0}return!1}qUe(Wb,Ea,ua){var ma,fb;if(1===R.g(this.$).ha.Je&&!Ea&&!ua){Ea=oa.a(this.$);ua=this.Sa;var sb=ua.zc(),Ua=this.$.da.za(65);(null===(ma=null===Ua||void 0===Ua?void 0:Ua.Km)||void 0===ma?0:ma.hF)&&!Ea&&sb.buttons.push(ua.pb(227));Ua&&Ua.isCommentOperationEnabled(3)&&sb.buttons.push(ua.pb(221));(null===
(fb=null===Ua||void 0===Ua?void 0:Ua.Km)||void 0===fb?0:fb.Lhd)&&!Ea&&sb.buttons.push(ua.pb(228));(null===Ua||void 0===Ua?0:Ua.hasCommentAtActiveCell)?Ua.wC.isResolved||sb.buttons.push(ua.pb(159)):Ua&&Ua.hasCommentAtActiveCell||(Ua&&Ua.Km&&Ua.Km.hF?Ea||(sb.buttons.push(ua.pb(229)),sb.buttons.push(ua.pb(230))):(sb.buttons.push(ua.pb(160)),Ea||sb.buttons.push(ua.pb(226))));Wb.nc.push(sb)}}IFh(Wb){if(O.EwaSettings.ma(134)){const Ea=this.Sa,ua=Ea.zc();ua.buttons.push(Ea.pb(250));Wb.nc.push(ua)}}JEh(Wb,
Ea,ua){if(!ua){ua=this.$.Ka.qH();var ma=new V.a(this.$.xa),fb=new L.a(ua,Ea,this.grid);(new U(Wb,this.$,this.Sa,ua,Ea,this.grid,fb,ma)).fbd()}}yEh(Wb,Ea,ua,ma,fb){const sb=(new V.a(this.$.xa)).Ud(8),Ua=this.Sa,ab=Ua.zc();Ea&&ab.buttons.push(Ua.pb(sb?152:153));ua&&ab.buttons.push(Ua.pb(sb?150:151));Ea&&(ma||ab.buttons.push(Ua.pb(sb?109:155)),ab.buttons.push(Ua.pb(sb?111:157)));ua&&(fb||ab.buttons.push(Ua.pb(sb?108:154)),ab.buttons.push(Ua.pb(sb?110:156)));Wb.nc.push(ab)}mEh(Wb,Ea){const ua=this.Sa,
ma=ua.zc();Wb.nc.push(ma);Ea&&ma.buttons.push(ua.pb(102));ma.buttons.push(ua.pb(42));ma.buttons.push(ua.pb(43));Ea=this.mFh(ua);Wb.nc.push(Ea)}mFh(Wb){const Ea=Wb.zc();Ea.title=I.a.instance.ga(1145);Ea.L3f=!1;Ea.K3f=!1;Ea.f9f=!1;let ua=5;const ma=F.a.yqd(this.$);ma&&(ua=6);Wb=Wb.FC("PasteOptionsGallery",ua,"Size24by24",Ea.title);Ea.buttons.push(Wb);Wb.Kt("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1146,void 0,"Paste_24",1,u.a.csh);Wb.Kt("ContextMenu.PasteValues",-185374993,
"QueryAdvancedPasteContextMenuGalleryIcon",1147,void 0,"PasteValues_24",1,u.a.hsh);Wb.Kt("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1148,void 0,"PasteFormulas_24",1,u.a.esh);Wb.Kt("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1149,void 0,"PasteTranspose_24",1,u.a.gsh);Wb.Kt("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1150,void 0,"PasteFormatting_24",1,u.a.dsh);ma&&Wb.Kt("ContextMenu.PasteLink",
42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1151,void 0,"PasteLink_24",1,u.a.fsh);return Ea}YFh(Wb,Ea,ua,ma,fb){var sb;const Ua=this.Sa;var ab=Ua.zc();ab.buttons.push(Ua.pb(43));Wb.nc.push(ab);this.Eec&&!this.$.mK&&(ab=this.Sa.zc(),this.jbd(ab),Wb.nc.push(ab));O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.jc.isMobileMode&&this.$.ea.jc.isReadOnlyEditMode&&!this.$.ya.IsMeetingLiveSession||(ab=this.Sa.zc(),this.qbd(ab),Wb.nc.push(ab),c.ULS.sendTraceTag(537167045,
0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));ab=this.$.da.za(65);if(null===(sb=null===ab||void 0===ab?void 0:ab.Km)||void 0===sb?0:sb.hF)sb=this.Sa.zc(),sb.buttons.push(Ua.pb(229)),Wb.nc.push(sb);sb=this.Sa.zc();this.BUe(sb,Ea,ua,ma,fb);Wb.nc.push(sb);l.AFrameworkApplication.isMobileMode&&!M.a(this.$.ya,30)&&(Ea=Ua.zc(),Ea.buttons.push(Ua.pb(272)),Wb.nc.push(Ea))}fFh(Wb,Ea,ua,ma,fb){const sb=
this.Sa.zc();this.gFh(sb);this.BUe(sb,Ea,ua,ma,fb);0<sb.buttons.length&&Wb.nc.push(sb)}gFh(Wb){Wb.buttons.push(this.Sa.pb(135))}DEh(Wb){const Ea=this.Sa.zc();Ea.buttons.push(this.Sa.pb(185));Wb.nc.push(Ea)}DFh(Wb,Ea){O.EwaSettings.ma(480)&&Ea&&(Ea=this.Sa.zc(),Ea.buttons.push(this.Sa.pb(262)),Wb.nc.push(Ea))}REh(Wb){var Ea=this.grid.ha.sa.selectedRanges;if(Ea&&Ea.length){var ua=!1;for(var ma=0;ma<Ea.length;ma++)if(this.grid.Db.Gwa(Ea[ma])){ua=!0;break}if(ua){ua=!1;for(ma=0;ma<Ea.length;ma++){var fb=
this.grid.Db.$Sh(Ea[ma]);if(null!=fb&&null!=fb[0]){for(var sb=0;sb<fb.length;sb++)if(this.grid.Db.Gwa(fb[sb])){ua=!0;break}if(ua)break}}sb=this.Sa;ma=sb.zc();fb=sb.zc();var Ua=1===Ea.length&&(Ea[0].isSingle||this.grid.Db.L6a(Ea[0])),ab=!1,na=!1,Na=!1,Va=!1;for(let Sa=0;Sa<Ea.length&&!(ab&&Na&&na&&Va);Sa++)!ab&&this.grid.Db.bji(Ea[Sa])&&(ab=!0),!Na&&this.grid.Db.Mdf(Ea[Sa],!1)&&(Na=!0),!na&&this.grid.Db.Qod(Ea[Sa])&&(na=!0),!Va&&this.grid.Db.Bei(Ea[Sa])&&(Va=!0);O.EwaSettings.ma(104)&&Ua&&!this.grid.Db.eec(Ea[0])&&
(Va?ma.buttons.push(sb.pb(217)):ma.buttons.push(sb.pb(216)));Va=ab;Va=!(new V.a(this.$.xa)).li&&Va;Na&&!ua&&(O.EwaSettings.ma(130)&&D.l(this.$.pg)&&(O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1)&&(O.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?fb.buttons.push(sb.pb(220)):fb.buttons.push(sb.pb(Va?220:271))),na&&fb.buttons.push(sb.pb(Va?218:269)),Ua&&(this.grid.Db.Qod(Ea[0])||this.grid.Db.eec(Ea[0]))&&fb.buttons.push(sb.pb(Va?
219:270))),fb.buttons.push(sb.pb(Va?215:268)));0<fb.buttons.length&&(Ea=sb.Ru(ab?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,I.a.instance.ga(1780),798637440),Ea.menu.nc.push(fb),ma.buttons.push(Ea));0<ma.buttons.length&&Wb.nc.push(ma)}}}nEh(Wb,Ea){this.grid.Db.Ybf(Ea)&&(Ea=this.Sa.zc(),this.grid.ha.sa.jba()?(Ea.buttons.push(this.Sa.pb(241)),Ea.buttons.push(this.Sa.pb(239))):Ea.buttons.push(this.Sa.pb(240)),Wb.nc.push(Ea))}WU(Wb){return Wb.cell.hasHyperlink}GUe(Wb){this.rFh(Wb);
var Ea=this.Sa.zc();this.qbd(Ea);Wb.nc.push(Ea);this.Eec&&(Ea=this.Sa.zc(),this.jbd(Ea),Wb.nc.push(Ea))}qFh(Wb,Ea,ua){this.GUe(Wb);this.qUe(Wb,Ea,ua)}rFh(Wb){if(this.grid.ha.sa.wg&&!this.grid.ib.mj){var Ea=this.Sa,ua=Ea.zc();pa.a(this.$).zQd()?ua.buttons.push(Ea.pb(265)):ua.buttons.push(Ea.pb(264));Wb.nc.push(ua)}}static RTi(Wb){const Ea=Wb.KJa(nc.fjd);Ea&&Ea.Vkd&nc.fjd&&Wb.invoke(nc.fjd,null)}static IEh(Wb,Ea,ua){if(O.EwaSettings.isChangeGateEnabled("OfficeVSO:5552180_DontAssertIfCopyPasteInfraNotReadyOnContextMenuOpen")){if(ua=
ua.da.za(254),!ua){c.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.");return}}else if(ua=ua.da.za(254,!0),!ua)return;ua.wnd()&&ua.Sif()&&Wb.buttons.push(Ea.pb(212));ua.wnd()&&ua.Yhc()&&Wb.buttons.push(Ea.pb(213))}Qvj(){const Wb=this.$.da.za(66).Jg,Ea=this.grid.ha.sa.activeCell;return null!=Wb&&!Wb.hasActiveFilter||Z.c(this.$,Ea)||!this.Aei(Ea)}Aei(Wb){const Ea=Wb.left;var ua=this.Tac();if(null!=ua&&null!=ua.n8b&&ua.n8b.includes(Ea-
1))return!0;ua=this.Kac();return null!=ua&&G.D(ua).contains(Wb)&&null!=ua.FilteredColumns&&ua.FilteredColumns.includes(Ea-1)?!0:!1}yei(){var Wb=this.$.da.za(66).Jg;const Ea=this.Tac();if(null!=Wb)return Wb.hasAutoFilter&&Wb.hasActiveFilter;if(null!=Ea)return null!=Ea.n8b&&0<Ea.n8b.length;Wb=this.Kac();return null!=Wb&&null!=Wb.FilteredColumns&&0<Wb.FilteredColumns.length}zei(){var Wb=this.$.da.za(66).Jg;const Ea=this.Tac();if(null!=Wb&&Wb.hasAutoFilter||null!=Ea&&Ea.KZa.every(ua=>0!=ua.length))return!0;
Wb=G.D(this.Kac());return null!=Wb&&Wb.contains(this.grid.ha.sa.activeCell)?!0:!1}Tac(){const Wb=this.$.da.za(66);Wb.Fm(this.grid.ha.sa.activeCell);return Wb.eub(this.grid.ha.sa.activeCell)}Kac(){return this.$.xa.getItemByName(this.$.pa.sheetName).$_}QOh(){var Wb=this.grid.ha.sa.activeCell,Ea=0,ua=!1,ma=this.$.da.za(66),fb=this.Tac();ma=ma.Jg;null!=ma?(Ea=ma.usedRange.top,ua=!0):null!=fb?(Ea=fb.top,ua=!0):(fb=this.Kac(),null!=fb&&G.D(fb).contains(Wb)&&(Ea=fb.FirstRow+1,ua=!0));return ua?(Wb=Wb.left,
Ea=H.Range.Uc(Ea,Wb),Ea=this.grid.Vb(Ea),ua="",null!=Ea&&(ua=Ea.text),this.FPg(ua,Wb)):I.a.instance.ga(222)}FPg(Wb,Ea){return null==Wb||Ra.a.Dh(Wb.trim())?String.format(I.a.instance.ob(157),H.Range.xP(Ea)):Wb.length>nc.L_d?String.format(I.a.instance.ob(155),Wb.substring(0,nc.L_d)):String.format(I.a.instance.ob(156),Wb)}}nc.KIb="GridContextMenuRootName";nc.l0h=x.a.IAe;nc.fjd=192;nc.L_d=26;Object(t.a)(nc,"GridContextMenu",n.a,[])},1211:function(t,C,a){a.r(C);t=a(0);var c=a(15),b=a(86),d=a(1086),f=a(8),
e=a(770);class k{}k.W6f="suggested_cells_list_box";Object(t.a)(k,"CssElementIds",null,[]);var l=a(5),m=a(1087);class v{constructor(W,da){this.Vkg=W;this.Ukg=da}get Kra(){return this.Vkg}get pWc(){return this.Ukg}}Object(t.a)(v,"CellAutoCompleteItem",null,[593]);var n=a(4),w=a(84),r=a(908),u=a(379),y=a(43),x=a(1),B=a(22),z=a(21);class A extends r.a{constructor(W,da,qa){super(W,da);this.YPb=null;this.Shc=0;this.l0=this.z7a=null;this.r5=(O,ea)=>{if(O=this.cellAutoCompleteControl.items)if(1===O.length&&
this.cellAutoCompleteControl.q0a.length<O[0].Kra.length&&this.cellAutoCompleteControl.Cva&&B.a.jL(O[0].Kra,this.cellAutoCompleteControl.q0a)&&(ea.newValue=O[0].Kra),this.Ya&&x.EwaSettings.ma(135)){let R=-1;1<O.length?R=this.cellAutoCompleteControl.Qac(this.Ya.text,!0):1===O.length&&(this.cellAutoCompleteControl.Cva||this.cellAutoCompleteControl.Icc)&&(R=0);if(0<=R&&O.length>R&&O[R].pWc){const oa=y.C(O[R].pWc);oa&&z.g(this.$).Db.Gwa(oa)&&(ea.Saf=!0,ea.cwe=O[R].pWc)}}};this.FEb=()=>{this.cellAutoCompleteControl.Cva=
!1};this.Ya.YXa(this.r5);if(this.Uxb=x.EwaSettings.fl())this.YPb=qa;this.l0=this.ue.Zd(this.Ya.textBox.domElement);this.l0.ka("mousedown",this.FEb)}get jyb(){return!1}get lK(){return this.cellAutoCompleteControl.qe}set lK(W){this.cellAutoCompleteControl.qe=W}get a5a(){return!1}get key(){return u.a.kZc}get cellAutoCompleteControl(){if(this.Uxb)return this.YPb;const {CellAutoCompleteControl:W}=a(1211);return this.YPb||(this.YPb=Object(w.a)(W,this.$.da.za(1)))}dispose(){this.Ya.GHb(this.r5);super.dispose()}ZX(W){W&&
!this.cellAutoCompleteControl.qe||super.ZX(W)}Th(W,da){this.cellAutoCompleteControl.Ya=this.Ya;this.Shc=W.keyCode;if(this.Ya.eb){const qa=this.Ya.text;B.a.equals(this.z7a,qa,!1)||(this.z7a=qa)}else this.z7a=null;if(237279923===da)return this.cellAutoCompleteControl.qe=!1;x.EwaSettings.ma(135)&&17===this.Shc&&this.cellAutoCompleteControl.Cva&&(this.cellAutoCompleteControl.Icc=!0);return super.Th(W,da)}jyd(){var W;if(!x.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||
!n.AFrameworkApplication.Ng)if(this.cellAutoCompleteControl.Ya=this.Ya,this.cellAutoCompleteControl.Cva=!1,this.Ya.eb){const da=!B.a.equals(this.z7a,this.Ya.text,!0),qa=this.Ya.umd;qa||!da&&229!==this.Shc?qa&&(this.cellAutoCompleteControl.qe&&(this.cellAutoCompleteControl.qe=!1),null===(W=this.cellAutoCompleteControl.WMa)||void 0===W?void 0:W.cancel()):this.cellAutoCompleteControl.lLg(this.Shc)}else this.z7a=null}nh(){}Jf(){this.lK=!1;this.cellAutoCompleteControl.set_visible(!1);this.z7a=null;this.cellAutoCompleteControl.Cva=
!1;this.cellAutoCompleteControl.Icc=!1;this.cellAutoCompleteControl.WMa&&this.cellAutoCompleteControl.WMa.cancel()}OEd(W,da){return this.cellAutoCompleteControl.Th(W,da)}}Object(t.a)(A,"CellAutoCompleteListAutoCompleteBehavior",r.a,[]);var I=a(30);r=a(1088);var F=a(12),U=a(11),X=a(116);class S extends r.a{constructor(W,da,qa){super(W,da);this.Iqa=this.cellAutoCompleteControl=null;if(this.Uxb=x.EwaSettings.fl())this.cellAutoCompleteControl=qa;this.mr=[]}get Ej(){return this.Iqa}set Ej(W){this.OAa(this.Ej);
this.Iqa=W;const da=this.OAa(this.Ej);this.ee=W?da.innerText:null;this.Ktc(W)}get qe(){return super.qe}set qe(W){super.qe=W;W||(this.Ej=null)}get RSa(){return null}get PFa(){return this.Uxb?this.cellAutoCompleteControl:this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.za(1))}dispose(){super.dispose();this.Iqa=null}kyc(W){this.X6(!1);let da;da=`<table class='${this.zba}' aria-live='polite'><tbody>`;for(let O=0,ea=this.mr.length;O<ea;O++){var qa=I.a.Eg(W[this.mr[O]].Kra);qa=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",
this.IZ,S.lZc,l.a.yoe,qa,I.a.T6c(qa));da+=qa}this.gg.innerHTML=da+"</tbody></table>";this.qn=F.DOMElementExtensions.Kj(this.domElement,this.zba);this.X6(!0);this.rra()}PIa(W,da){if(W&&W.length){var qa=[];if(da)for(let O=0,ea=W.length;O<ea;O++)B.a.jL(W[O].Kra,da)&&qa.push(O);this.mr=qa;this.kyc(W)}else this.qe=!1,this.Iqa=null}Fxa(){}OSg(W,da,qa){let O=Math.min(W,Math.max(200,qa));da&&W<qa&&(O+=X.a.mu);F.DOMElementExtensions.Dv(this.gg,O);da&&(O-=X.a.mu);return O}rra(){super.rra();var W=F.DOMElementExtensions.Kj(this.get_element(),
this.zba),da=this.mr.length>this.$H,qa=z.g(this.$);if(qa=qa.Vb(qa.ha.sa.activeCell))for(W=this.OSg(W.offsetWidth,da,qa.width),da=this.gg.getElementsByClassName(S.lZc),qa=0;qa<da.length;qa++)da[qa].style.maxWidth=U.HelperMethods.pc(W);else c.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")}onItemClick(W){if(W=super.onItemClick(W)){const da=z.g(this.$);da.Go(!1);da.focus()}return W}}S.lZc=e.a.wrh;Object(t.a)(S,"CellAutoCompleteListBox",
r.a,[]);var H=a(24),D=a(65),J=a(113),M=a(173),G=a(45),T=a(35),K=a(250);r=a(19);a.d(C,"CellAutoCompleteControl",function(){return V});const L=`<div id='${k.W6f}' class='${e.a.i8c} ${r.a.Zo}' ></div>`;class V extends d.a{constructor(W,da){super(W);this.sCa=null;this.jZc=[];this.A3d=null;this.Icc=this.Cva=!1;this.i$d=this.iq=null;this.uIe=()=>{this.XX.PIa(this.items,this.sCa);this.raiseEvent("ACLBUpdated",new m.a(this.items.length));this.show()};this.tableManager=da;this.domElement.className=e.a.sLe;
this.domElement.innerHTML=L;F.DOMElementExtensions.setVisible(this.domElement,!1);K.d(this.style,this.$.isChromeRtl);this.vcf=x.EwaSettings.fl();this.bwe=$get(k.W6f,this.domElement);this.XX=new S(this.$,this.bwe,this);this.rSa(!0);this.$.domElement.appendChild(this.domElement);this.Mnb(W,J.a(W));this.Mnb(W,z.g(W).Xb);this.vcf||this.$.da.Ga(1,this);this.Fei=x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",!1)}pYb(W){this.addHandler("ACLBUpdated",W)}Brc(W){this.removeHandler("ACLBUpdated",
W)}L1(W){this.addHandler("ACLBSelectionChanged",W)}Qca(W){this.removeHandler("ACLBSelectionChanged",W)}VEg(W){this.addHandler("ACLBMatchedItem",W)}Waj(W){this.removeHandler("ACLBMatchedItem",W)}get Ot(){return this.XX}get q0a(){return this.sCa}get ee(){return this.XX.ee}get items(){return this.iq}get WMa(){return this.i$d}get activeCell(){return z.g(this.$).ha.sa.activeCell}get dataValidationControl(){return this.A3d||(this.A3d=this.$.da.za(14))}j6f(W){for(let da=0;da<W.length;da++){const qa=W.charCodeAt(da);
if(x.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?B.a.isLetter(qa):B.a.Ind(qa))return!0}return!1}rwa(){return!this.items}dispose(){if(this.$){this.rSa(!1);const W=z.g(this.$);W&&W.view.Pq(this.gmc)}b.a.qc([this.XX,this.WMa]);b.a.qc(this.jZc);this.jZc=this.bwe=this.XX=this.Ya=null;super.dispose()}Th(W,da){let qa=!1;if(this.owj())switch(da){case -798660877:if(1===this.items.length&&this.ee)break;this.Ot.lB(1);this.raiseEvent("ACLBSelectionChanged",
new m.a(this.items.length,this.Qac(this.ee),this.ee));qa=this.Ny(!1);break;case 137938150:if(1===this.items.length&&this.ee)break;this.Ot.lB(-1);this.raiseEvent("ACLBSelectionChanged",new m.a(this.items.length,this.Qac(this.ee),this.ee));qa=this.Ny(!1);break;case 2091832999:this.Ot.lB(this.$H-1);qa=this.Ny(!1);break;case 742457698:this.Ot.lB(-(this.$H-1));qa=this.Ny(!1);break;case 125627505:this.Ya.textBox.caretPosition=this.Ya.text.length;this.qe=!1;qa=!0;break;case 267796030:this.Ny(!0);break;default:qa=
super.Th(W,da)}return qa}show(){this.items&&this.items.length&&(this.XX.Ej=this.ee?this.Ot.qn.rows[this.Qac(this.ee)]:null,this.qe=0<this.XX.mr.length,this.eBa(!0),this.XX.Fxa())}lLg(W){const da=!!this.Ya&&!D.f(this.$.pa);this.Icc=this.Cva=!1;this.Ya&&!this.Ya.eb?this.set_visible(!1):da&&!this.Uah(this.activeCell)&&this.Wzj(W)}Uah(W){return!!this.dataValidationControl&&this.dataValidationControl.T5c(W)}Ny(W){if(!this.Ya||!this.qe)return!1;const da=this.sCa;if(this.ee){var qa=F.DOMElementExtensions.HY(F.DOMElementExtensions.Kj(this.XX.Ej,
S.lZc),l.a.yoe,"");const O=qa.substring(da.length,qa.length);W?this.Ya.text=qa:this.Ya.insertTextAt(O,da.length,this.Ya.text.length)}qa=z.g(this.$);qa.lm&&(qa=qa.Xb,qa.text=this.Ya.text,qa.setCaretPosition(this.Ya.textBox.caretPosition));W?this.qe=!1:this.Ya.textBox.selectRange(da.length,this.Ya.text.length);return!0}Qac(W,da=!1){if(!this.XX.qn)return-1;const qa=this.XX.qn.children[0],O=qa.children.length;let ea;for(let R=0;R<O;++R)if(ea=qa.children[R],B.a.equals(ea.innerText.trim(),W,da))return R;
return-1}Yzg(W,da,qa,O,ea,R,oa){const pa=qa.originalText.replace(V.trf,String.fromCharCode(32)),Pa=new H.Range(W.top-1,W.left,W.bottom-1,W.right,!1,!1),Z=oa?oa.Fm(qa.range):null;(!qa.KH||qa.range.left===W.left)&&1<pa.length&&!O.mb(pa.toUpperCase())&&B.a.jL(pa,da)&&!B.a.equals(pa,da,!0)&&!V.mSe(da)&&this.j6f(pa)&&(!ea&&!Z||!ea&&Z.equals(oa.Fm(Pa))||ea&&qa.range.Dd(R)&&qa.range.top!==R.top)&&(W=qa.formulaBarText,B.a.equals(W,qa.text,!1)||!W)&&(W={},W.FirstRow=qa.range.top-1,W.FirstColumn=qa.range.left-
1,qa=new v(pa,W),O.add(pa.toUpperCase(),qa))}Wzj(W){this.iq=this.tXh();this.WMa&&this.WMa.cancel();0<this.Ya.text.length&&0!==W?this.items&&((1<this.items.length||this.qe)&&this.Bhh(),8!==W&&127!==W&&46!==W&&(1===this.items.length?this.Djd(!1):this.XX.Ej&&this.Ny(!1))):this.qe=!1}Bhh(){this.qe?this.uIe():this.i$d=M.AsyncMethodContext.lr(this.uIe,500,G.a.WUg,this.WMa)}Djd(W){c.ULS.shipAssertTag(537167966,0,!this.rwa()&&1===this.items.length,"Invalid Items");let da=this.items[0].Kra,qa=this.Ya.text,
O=da.substring(qa.length,da.length);if(W&&!O.length)this.Ya.text=da;else if(!W&&0<O.length)this.Ya.appendText(O),this.Ya.textBox.selectRange(qa.length,this.Ya.text.length);else return;this.raiseEvent("ACLBMatchedItem",new m.a(this.items.length,0,da));this.Cva=!0}tXh(){this.iq=null;const W=new T.a(!1);var da=this.activeCell;this.sCa=this.Ya.text.replace(V.trf,String.fromCharCode(32));const qa=this.tableManager.Fm(da),O=da.Dd(qa);if(V.mSe(this.sCa)||!this.j6f(this.sCa))return this.items;const ea=new H.Range(1,
da.left,da.top-1,da.left,!1,!1);var R=new H.Range(da.top+1,da.left,f.a.dh,da.left,!1,!1);let oa;const pa=z.g(this.$);R=pa.mk("CellAutoCompleteControl.GetSuggestedCells",R);try{const Pa=pa.mk("CellAutoCompleteControl.GetSuggestedCells2",ea);try{for(const Z of[Pa,R])for(;Z.$$mn();)oa=Z.$$cu(),this.Yzg(da,this.sCa,oa,W,O,qa,this.tableManager)}finally{Pa&&Pa.dispose()}}finally{R&&R.dispose()}this.iq=Array(W.values.length);for(da=0;da<this.items.length;da++)this.items[da]=W.values[da];this.items.sort((Pa,
Z)=>Pa.Kra.localeCompare(Z.Kra));return this.items}Mnb(W,da){W&&da&&this.jZc.push(new A(W,da,this.vcf?this:void 0))}owj(){return this.Fei?this.q0a&&!this.rwa()&&this.qe?this.get_visible():!1:this.q0a&&!this.rwa()&&this.get_visible()&&this.qe}static get trf(){return V.Oae||(V.Oae=new RegExp(String.fromCharCode(160),"g"))}static mSe(W){W=0<W.length?W.charCodeAt(0):-1;return 35===W||61===W||43===W||45===W||64===W}}V.Oae=null;Object(t.a)(V,"CellAutoCompleteControl",d.a,[554,555,556,2])},1218:function(t,
C,a){t=a(0);var c=a(565),b=a(560),d=a(557),f=a(998);class e{s8g(F,U){if(F&&!(1>F.length)&&U){var X=Object.assign(new d.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.O5g(F,X.ControlList);U.push(X)}}O5g(F,U){const X=Object.assign(new c.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new b.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(U,X);U=Object.assign(new d.a,{Title:"",ControlList:[]});
Array.add(X.Menu.MenuSectionList,U);this.Y7g(F,U.ControlList)}Y7g(F,U){for(let X=0;X<F.length;X++){const S=Object.assign(new f.a,{ExternalId:String.format("CoauthorPersona_{0}",X),Command:"336231556",DisplayName:F[X].userName,LabelText:F[X].userName,ImageBackColor:F[X].color,PersonaId:F[X].email,IsAnonymous:F[X].isAnonymous});Array.add(U,S)}}}Object(t.a)(e,"PresenceContextMenuSectionBuilder",null,[565]);var k=a(83),l=a(4),m=a(176),v=a(558),n=a(107),w=a(133),r=a(86),u=a(82),y=a(106),x=a(25);class B{constructor(F,
U,X,S){this.C1d=this.H0=this.Pi=this.WD=this.C7=null;this.GVb=F;this.Cvg=S;this.GVb.qLa&&(this.Pi=new n.a(3,2,5E3,Object(k.a)(this,this.oMg,"authenticationCheckTask"),2),l.AFrameworkApplication.zi.Ag(this.Pi),this.Gg(U,X));this.GVb.xmb(()=>{this.ytf()});this.GVb.WXa(()=>{this.ztf()})}get businessBar(){return this.H0||(this.H0=u.a.instance.vh("CommonUI.IBusinessBar"))}get Ste(){return this.C1d||(this.C1d=u.a.instance.vh("CommonUI.IBusinessBarEntryFactory"))}Gg(F,U){const X=l.AFrameworkApplication.wb;
X.Ie(x.a.authenticationLost,y.a.frame,F,96);X.Ie(x.a.Lre,y.a.frame,U,96);X.Ob(x.a.Ive,y.a.frame,m.ActionManager.N5c);X.Ob(x.a.Jve,y.a.frame,m.ActionManager.N5c);X.Ob(x.a.Rrd,y.a.frame,m.ActionManager.N5c)}ytf(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);l.AFrameworkApplication.wb.processAction(x.a.authenticationLost,2)}ztf(){this.HHj();l.AFrameworkApplication.wb.processAction(x.a.Lre,2)}oMg(){this.GVb.authenticationCheck()}HHj(){this.WD&&(this.WD.hide(),this.WD.dispose(),this.WD=
null);this.C7&&this.businessBar&&(l.AFrameworkApplication.Ng||this.businessBar.removeEntry(this.C7),this.C7.dispose(),this.C7=null)}showDialog(F){r.a.Ia(this.WD);this.WD=new w.StandardDialog;this.Cvg||(this.WD.ft=!1,this.WD.Rb=0);this.WD.rc(1,CommonUIStrings.l_SignIn);this.WD.oW(CommonUIStrings.l_DefaultDialogTitle,F,Object(k.a)(this,this.$v,"dialogHandler"))}$v(F){1===F?(v.a.T5(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),l.AFrameworkApplication.wb.processAction(x.a.Rrd,
2)):(this.MQd(),l.AFrameworkApplication.wb.processAction(x.a.Jve,2))}MQd(){this.businessBar&&this.Ste&&(this.C7=this.Ste.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.C7.closeable=!0,this.C7.addButton(CommonUIStrings.l_SignIn,B.JRg,""),this.C7.U9=Object(k.a)(this,this.MRg,"businessBarEntryCloseHandler"),this.businessBar.gC(this.C7,!1))}MRg(){this.Xeh();l.AFrameworkApplication.wb.processAction(x.a.Ive,2)}Xeh(){this.Pi&&(l.AFrameworkApplication.zi.Xo(this.Pi),
this.Pi=null)}dispose(){this.Pi=this.WD=this.C7=null}static JRg(){v.a.T5();l.AFrameworkApplication.wb.processAction(x.a.Rrd,2)}}Object(t.a)(B,"SignOutResponseUI",null,[2]);var z=a(246);class A{get name(){return"Common.App.UI"}Rh(F){F.register(e,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").tc()}init(){}dispose(){r.a.Ia(A.m1);A.m1=null}static main(){z.a.instance.yi(new A)}}A.m1=null;Object(t.a)(A,"CommonAppUIPackage",null,[4,5]);a.d(C,"a",
function(){return I});const I=()=>{Type.registerNamespace("CAUI");A.main()}},1219:function(t,C,a){t=a(0);var c=a(221),b=a(1211),d=a(50),f=a(37),e=a(1),k=a(696);class l extends c.a{constructor(y){super();this.$=y;this.Fb()}create(){const y=this.$.da,x=d.GetServiceTaskFactory.create(y,134,this.la,this.hb),B=d.GetServiceTaskFactory.Ra(y,213,214,this.hb);f.TaskExtensions.Aa(f.TaskExtensions.Wd([x,B],this.la),()=>{if(e.EwaSettings.fl())this.qb(Object(k.c)(this.$.da,1,()=>{const z=new b.CellAutoCompleteControl(this.$,
x.result);B.result.ka(z);return z}));else{let z=y.za(1);z||(z=new b.CellAutoCompleteControl(this.$,x.result),B.result.ka(z));this.qb(z)}},this.la,3)}static ka(y){y.da.Ga(151,new l(y))}}Object(t.a)(l,"CellAutoCompleteControlFactory",c.a,[]);var m=a(15),v=a(14);class n{constructor(y,x){this.gZa=null;this.tAf=(B,z)=>{1<z.length&&(B=v.a.instance.ga(862),this.ariaLiveNotifier.yLf(B,z.length))};this.uAf=(B,z)=>{m.ULS.shipAssertTag(537167961,0,0<=z.selectedIndex&&0<=z.length&&z.selectedIndex<z.length,"Invalid ListEventArgs: SelectedIndex/Length");
m.ULS.shipAssertTag(537167960,0,!!z.YF,"ListEventArgs: SelectedValue should not be null");this.ariaLiveNotifier.Q4i(z.YF,z.selectedIndex+1,z.length)};this.vAf=(B,z)=>{this.ariaLiveNotifier.pPa(z.YF)};this.ariaLiveNotifier=y;e.EwaSettings.fl()||x.Ga(213,this)}dispose(){this.UWd();this.gZa=null}ka(y){y&&(this.gZa=y,y.pYb(this.tAf),y.L1(this.uAf),y.VEg(this.vAf))}UWd(){this.gZa&&(this.gZa.Brc(this.tAf),this.gZa.Qca(this.uAf),this.gZa.Waj(this.vAf))}}Object(t.a)(n,"CellAutoCompleteReadoutHandler",null,
[558,2]);class w extends c.a{constructor(y){super();this.$=y;this.Fb()}create(){const y=this.$.da;f.TaskExtensions.Aa(d.GetServiceTaskFactory.Ra(y,211,212,this.hb),x=>{if(e.EwaSettings.fl())this.qb(Object(k.c)(y,213,()=>new n(x.result,y)));else{const B=y.za(213)||new n(x.result,y);this.qb(B)}},this.la,3)}static ka(y){y.da.Ga(214,new w(y))}}Object(t.a)(w,"CellAutoCompleteReadoutHandlerFactory",c.a,[]);var r=a(10);a.d(C,"a",function(){return u});const u=()=>{r.a.Fa(l.ka);r.a.Fa(w.ka)}},1220:function(t,
C,a){var c=a(10);t=a(0);var b=a(233),d=a(221),f=a(50),e=a(37),k=a(1),l=a(15),m=a(86),v=a(4),n=a(78),w=a(8),r=a(24),u=a(65),y=a(43),x=a(145),B=a(47),z=a(45),A=a(12),I=a(14),F=a(21),U=a(27),X=a(19),S=a(54);class H extends n.a{constructor(K,L,V,W){super();this.isMac=U.a.isMac;this.dwa=!1;this.$=K;this.ariaLiveNotifier=W;this.jo=V.u3b(K,null,L,X.a.MNe,S.a.hf(9),I.a.instance.ga(1737),"PulloutPointerDown")}Rbg(K){this.dwa!==K&&(this.hide(),(this.dwa=K)?this.jo.Jcg(X.a.jth,S.a.hf(3)):this.jo.Jcg(X.a.MNe,
S.a.hf(9)))}get jz(){return this.jo.jz}get buttonWidth(){return this.jo.buttonWidth}dispose(){this.jo.dispose();this.$=null;super.dispose()}domElement(K){return this.jo.domElement(K)}getButton(K){return this.jo.getButton(K,!1)}ZNb(K,L){this.jo.ZNb(K,L,!1)}hAa(K,L){const V=F.g(this.$),W=V.ib.Vi(K);this.jo.ZNb(this.dwa?I.a.instance.ga(1739):L?I.a.instance.ga(1737):I.a.instance.ga(1738),W);L=this.isMac?L?I.a.instance.ga(1742):I.a.instance.ga(1743):L?I.a.instance.ga(1740):I.a.instance.ga(1741);var da=
V.mg(K,W);K=V.Lf(W).Mm;if(da&&0<=da.x&&0<=da.y){const qa=da.bottomRight.x+this.jz;da=da.topLeft.y-this.jz-this.buttonWidth;if(da<K.topLeft.y+this.jz){if(V.ib.VSa){this.hide();return}da=K.topLeft.y+this.jz}this.Bp(qa,da,V.rtl,W);this.ariaLiveNotifier.pPa(L)}else this.hide()}Bp(K,L,V,W){this.jo.Bp(K,L,V,W,!1)}hide(){this.jo.hide()}}Object(t.a)(H,"PulloutLaunchButton",n.a,[]);var D=a(33),J=a(22);class M extends n.a{constructor(K,L,V,W,da){super();this.SWa=this.zMc=this.Ptc=this.UEa=this.wR=this.yO=null;
this.dde=0;this.ABb=this.gyb=this.nDc=!1;this.yg=()=>{this.Tva&&(this.gridView?1===this.gridView.ha.Je?(this.gridView.ha.sa.activeCell.equals(this.UEa)||this.bN||this.Tx(),this.Hnb.Rq()):this.Tx():l.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};this.nh=()=>{this.Tx()};this.$c=()=>{this.mW()};this.Ec=()=>{this.Tx()};this.ed=()=>{this.showCallout()};this.aya=()=>{if(this.Rg.Qk&&this.Rg.Qk.length)if(this.NXc)this.Rg.vsi||(this.nDc=this.Rg.Qk[0].BlockingDataForExpand),this.Rg.cNh&&
l.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),this.dde=this.Rg.L3c&&this.Rg.VTe<this.Rg.L3c.left-1?this.Rg.L3c.left-1-this.Rg.VTe:-1,this.showCallout();else if(this.gridView.ha.sa.wg){var qa=this.gridView.ha.sa.activeCell;if(qa&&this.wR){var O=this.tableManager.Fm(qa);this.oKc=!!O;const ea=this.gridView.ha.sa.Wc;O=this.bN&&this.wR.Dd(O);const R=this.Agd&&!this.bN&&ea.equals(this.selectedRange);O||R?(l.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),
this.e8b=!0,k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!this.bN&&this.tableManager.eja(qa)?l.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):(k.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.bN?this.Eh.hAa(this.wR,this.bN):this.Eh.hAa(ea,this.bN):this.Eh.hAa(this.wR,this.bN),this.ysc())):l.ULS.shipAssertTag(537154138,0,
!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};this.Yi=()=>{this.h6a()&&this.Eh.hide();1===this.gridView.ha.Je&&this.mW()};this.ZQ=()=>{const qa=this.gridView.ha.Je;this.gridView.ha.sa.activeCell&&1===qa&&this.mW()};this.mt=()=>{if(k.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(this.bN){if(this.wR&&this.UEa){var qa=this.tableManager.Fm(this.UEa);qa&&1<qa.bottom-qa.top&&(--qa.bottom,this.gridView.t4(qa)&&this.Hnb.Rq())}}else this.gridView.ha.sa.wg&&
this.gridView.t4(this.gridView.ha.sa.Wc)&&this.Hnb.Rq();else this.wR&&this.UEa&&this.bN&&(qa=this.tableManager.Fm(this.UEa))&&1<qa.bottom-qa.top&&(--qa.bottom,this.gridView.t4(qa)&&this.Hnb.Rq())};this.mW=()=>{if(this.$&&this.gridView){if(this.e8b&&this.bN){const qa=this.gridView.ha.sa.activeCell;this.wR=this.VRe();const O=!!this.Ptc&&this.Ptc.contains(qa);if(this.wR&&(qa.equals(this.UEa)||O)){this.Eh.hAa(this.wR,this.bN);return}}this.e8b=!1;(this.wR=this.VRe())&&this.$ka&&this.gridView&&this.gridView.Ea.Sr(this.$ka)?
(this.NXc=!1,this.KY()):(this.Rg.IYc(),this.Rg.u0b());this.e8b||this.Eh.hide()}};this.$=K;this.tableManager=V;this.contextMenuManager=W;this.Eh=new H(K,this.ed,L,da);this.Rg=L.s2c(K,V);this.e8b=this.NXc=!1;this.Agd=k.EwaSettings.ma(135);this.oKc=!0;this.jDa=!1;this.gridView=F.g(this.$);this.gridView.Xb.Nk(this.nh);this.gridView.Ku(this.ZQ);this.$.el(this.$c);this.$.kk(this.Ec);this.$.EA(this.Yi);this.gridView.view.Ls(this.mt);this.gridView.ha.cT(this.yg);this.Hnb=B.a.instance.create(this.mW,250,z.a.g1i);
l.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");this.Rg.hYb(this.aya);D.a.hyb()&&(this.gyb=!0);this.mW();K.da.Ga(261,this)}get mc(){return this.Eh.domElement(1)}get $ka(){return this.zMc}get selectedRange(){return this.SWa}get bN(){return this.oKc}get dwa(){return this.jDa}get oJf(){return this.dde}get UAb(){const K=this.Eh.domElement(this.bea);return K?A.DOMElementExtensions.isVisible(K):!1}get Tva(){return this.$.isEditMode&&k.EwaSettings.ma(135)?!(new x.a(this.$.xa)).li:!1}get yHg(){return this.nDc}get bea(){return this.$ka?
this.gridView.ib.Vi(this.yO):1}dispose(){this.gridView&&(this.gridView.ha.rR(this.yg),this.gridView.view.Pq(this.mt),this.gridView.Xb&&this.gridView.Xb.tk(this.nh));if(this.$){const K=this.$;K.Al(this.$c);K.zl(this.Ec);K.zD(this.Yi);F.g(K).py(this.ZQ)}this.Rg&&this.Rg.trc(this.aya);m.a.Ia(this.Eh);this.Rg=this.$=this.gridView=this.Hnb=this.Eh=null;super.dispose()}Tx(){this.Eh.hide()}Wca(){this.Eh?this.Eh.getButton(this.bea).obb():l.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")}Cfj(){this.wR=
null}JIf(){this.Eh&&this.Eh.hide()}yZh(){if(!this.Agd||1!==this.selectedRange.width)return null;const K=this.selectedRange.clone();for(;this.gridView.t4(K);){K.left+=1;K.right+=1;if(!this.gridView.Lf(this.gridView.ib.Vi(K)).gi.Ge(K))break;if(!this.gridView.Ea.Sr(K))continue;const L=this.gridView.mk("PulloutManager.GetValidatedRangeToFill",K,2);try{if(M.WUj(L))return K}finally{L&&L.dispose()}}return null}ysc(){this.Rg.qbb()}showCallout(){this.Tva&&(this.Rg.O5a?(this.Eh.getButton(this.bea).JFb(),k.EwaSettings.fl()?
e.TaskExtensions.Aa(f.GetServiceTaskFactory.Ra(this.$.da,8,9,0),K=>{this.n2f(K.result)},this.$.la,3):this.n2f(this.contextMenuManager)):(this.NXc=!0,this.KY()))}n2f(K){K.lcd("tableFieldList").b0(null,this.Eh.domElement(this.bea),this.Rg,null,!0);this.ysc()}VRe(){if(!this.Tva||!this.gridView||this.gridView.ha.Pa.$b||!this.gridView.ha.sa.wg)return null;var K=this.gridView.ha.sa.activeCell,L=F.g(this.$).ib.Vi(K);if(!K)return null;this.UEa=K.clone();var V=this.tableManager.Fm(K);this.oKc=!!V;if(this.bN){this.Eh.ZNb(I.a.instance.ga(1737),
L);this.yO=M.Seg(V);if(!this.yO)return null;K=!1;L=({PX:K}=this.tableManager.wBe(V,this.gridView)).returnValue||K;this.nDc=K;if(L)return this.Ptc=new r.Range(V.top,V.left,V.bottom,V.right,!1,!1),this.zMc=new r.Range(this.yO.top,this.yO.right+1,this.yO.top,this.yO.right+1,!1,!1),this.gyb&&(this.jDa=!1,this.Eh.Rbg(this.jDa)),this.yO}else if(this.Agd){this.SWa=this.gridView.ha.sa.Wc.clone();V=this.selectedRange.isSingle&&F.g(this.$).Db.Bbf(this.selectedRange);const W=F.g(this.$).Db.Gwa(this.selectedRange);
this.gyb&&(this.jDa=V&&!W);this.Eh.ZNb(this.jDa?I.a.instance.ga(1739):I.a.instance.ga(1738),L);V&&!W&&!this.ABb&&k.EwaSettings.isChangeGateEnabled("OfficeVSO:6253558_DatePulloutExperimentTrigger")&&J.a.equals(v.AFrameworkApplication.uiCulture,"en-us",!0)&&(v.AFrameworkApplication.XH("XLS-DateSuggestionV2-Treatment;XLS-DateSuggestionV2-Control"),this.ABb=!0);this.yO=M.Seg(this.selectedRange);if(!(this.gyb&&V||W)||!this.yO||!this.selectedRange||k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",
!1)&&this.tableManager.eja(this.selectedRange))return null;this.zMc=this.yZh();if((k.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.gridView.t4(this.selectedRange):this.gridView.t4(this.yO))&&this.$ka)return this.gyb&&this.Eh.Rbg(this.jDa),this.Ptc=this.yO,l.ULS.sendTraceTag(537154137,0,50,`PulloutManager:FindSelection, NextRange, ${this.$ka?this.$ka.toString():"null"}, RightColumnHeader, ${this.yO?this.yO.toString():"null"}, ActiveCell, ${K?
K.toString():"null"}`),this.yO}return null}KY(){this.bN?this.Rg.KY(y.v(this.$ka,this.$),!1,!0):this.jDa?this.Rg.gYi():k.EwaSettings.ma(135)&&this.Rg.KY(y.v(this.selectedRange,this.$),!0,!1)}h6a(){return this.$.ea.isNamedObjectViewMode&&u.f(this.$.pa)}static WUj(K){for(;K.$$mn();)if(K.$$cu().text||K.$$cu().KH||K.$$cu().Ii||K.Hn.W5e)return!1;return!0}static Seg(K){return K.right===w.a.mh?null:new r.Range(K.top,K.right,K.top,K.right,!1,!1)}}Object(t.a)(M,"PulloutManager",n.a,[546,2]);class G extends d.a{constructor(K){super();
this.$=K;this.Fb()}create(){c.a.Fa(K=>{const L=f.GetServiceTaskFactory.Ra(K.da,12,477,this.hb),V=f.GetServiceTaskFactory.Ra(K.da,66,134,this.hb),W=f.GetServiceTaskFactory.Ra(K.da,211,212,this.hb);let da=b.a.Ta(null);const qa=!k.EwaSettings.fl();qa&&(da=f.GetServiceTaskFactory.Ra(K.da,8,9,this.hb));e.TaskExtensions.Aa(e.TaskExtensions.Wd([L,V,da,W],K.la),()=>{qa?this.qb(this.$.da.za(261)||new M(this.$,L.result,V.result,da.result,W.result)):this.qb(this.$.da.za(261)||new M(this.$,L.result,V.result,
null,W.result))},K.la)})}static ka(K){K.da.Ga(262,new G(K))}}Object(t.a)(G,"PulloutManagerFactory",d.a,[]);a.d(C,"a",function(){return T});const T=()=>{c.a.Fa(K=>{K.ma(135)&&G.ka(K)})}},1230:function(t,C,a){t=a(0);var c=a(185);class b{GGj(r,u){r.set_visible(!1);u.set_visible(!0)}}Object(t.a)(b,"DefaultTabSwitchBehaviour",null,[463]);class d{}d.tHj="TabsContainer";d.cHj="TabTitlesContainer";d.aHj="TabTitle";d.bHj="TabTitleText";d.$Td="TabTitleActive";Object(t.a)(d,"MultitabControlStyles",null,[]);
var f=a(83),e=a(44),k=a(85),l=a(88),m=a(56);class v{constructor(r,u,y){this.gk=r;this.Gp=u;this.WEc=y;this.$ea=document.createElement("a");m.a.Uuc(this.$ea,this.Gp);Sys.UI.DomElement.addCssClass(this.$ea,d.bHj);Sys.UI.DomElement.addCssClass(this.gk,d.aHj);this.gk.appendChild(this.$ea);this.$ea.tabIndex=0;this.kAc();e.a.addHandler(this.gk,"click",this.WEc);e.a.addHandler(this.gk,"keyup",Object(f.a)(this,this.H9a,"onTitleKeyUp"))}get mc(){return this.gk}get title(){return this.Gp}get isActive(){return Sys.UI.DomElement.containsCssClass(this.gk,
d.$Td)}set isActive(r){this.setActive(r)}dispose(){e.a.removeHandler(this.gk,"keyup",Object(f.a)(this,this.H9a,"onTitleKeyUp"));e.a.removeHandler(this.gk,"click",this.WEc);this.gk=this.$ea=null}setActive(r){r?Sys.UI.DomElement.addCssClass(this.gk,d.$Td):Sys.UI.DomElement.removeCssClass(this.gk,d.$Td);this.$ea&&this.$ea.setAttribute(l.a.wga,r)}H9a(r){r.keyCode!==k.a.$h&&r.keyCode!==k.a.moa||this.WEc(r)}kAc(){this.gk.setAttribute(l.a.Kd,l.a.Ns);this.$ea.setAttribute(l.a.Mt,this.Gp);this.$ea.setAttribute(l.a.Kd,
l.a.znb)}}Object(t.a)(v,"TabTitleControl",null,[2]);var n=a(39);a.d(C,"a",function(){return w});class w{constructor(r,u=null,y=null){this.ilb=this.qlb=null;this.D0=-1;this.gk=r;this.Nfa=u||new c.a;this.Bwg=y||new b;this.wEa=new c.a;r=0;for(let x of this.Nfa)this.qqd(this.D0)||(this.D0=r),u=r++,this.wEa.add(new v(document.createElement("li"),x.title,this.A5g(u)))}get myc(){return this.Nfa.count}get activeTab(){return this.D0}set activeTab(r){this.r7f(r)}get mc(){return this.gk}get visible(){return n.a.isVisible(this.gk)}set visible(r){this.gk.style.visibility=
r?"visible":"hidden"}yQf(){this.qlb=document.createElement("ul");this.qlb.className=d.cHj;this.ilb=document.createElement("div");this.ilb.className=d.tHj;for(let r=0;r<this.myc;++r){const u=this.Nfa.na(r),y=this.wEa.na(r);u.set_visible(!1);y.isActive=!1;const x=document.createElement("div");u.render(x);this.ilb.appendChild(x);this.qlb.appendChild(y.mc)}this.mc.appendChild(this.qlb);this.mc.appendChild(this.ilb);this.qqd(this.D0)&&(this.wEa.na(this.D0).isActive=!0,this.Nfa.na(this.D0).set_visible(!0))}dispose(){for(let r=
0;r<this.myc;++r)this.Nfa.na(r).dispose(),this.wEa.na(r).dispose();this.wEa=this.Nfa=this.gk=this.ilb=this.qlb=null}setFocus(){this.Nfa.na(this.D0).setFocus()}qqd(r){return 0<=r&&r<this.myc}r7f(r){this.D0!==r&&this.qqd(r)&&(this.Bwg.GGj(this.Nfa.na(this.D0),this.Nfa.na(r)),this.wEa.na(this.D0).isActive=!1,this.wEa.na(r).isActive=!0,this.D0=r,this.setFocus())}A5g(r){return()=>{this.r7f(r)}}}Object(t.a)(w,"MultitabControl",null,[453,2])},1242:function(t,C,a){var c=a(10);t=a(0);var b=a(7),d=a(221),f=
a(50),e=a(37);class k{constructor(){this.isFeedbackAllowed=!1;this.zoomLevel=0}}Object(t.a)(k,"FormulaAssistanceUIContext",null,[]);var l=a(196);class m extends d.a{constructor(n){super();this.jkj="formulaAssistance";this.$=n;this.Fb()}create(){let n=this.$.da.za(448);if(n)this.qb(n);else{var w=f.GetServiceTaskFactory.Ra(this.$.da,283,284,this.hb);e.TaskExtensions.Aa(w,()=>{e.TaskExtensions.Aa(l.c(w.result.Zn.loadScript(this.jkj)),()=>{n=this.$.da.za(448);if(!n){const r=Object(b.a)(new k,{isFeedbackAllowed:this.$.isFeedbackEnabled});
n=this.$.da.Ga(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(r));this.$.Uwe(()=>{const u={};u.isFeedbackAllowed=this.$.isFeedbackEnabled;n.updateContext(u)})}this.qb(n)},this.$.la,3)},this.$.la,3)}}static ka(n){n.da.Ga(449,new m(n))}}Object(t.a)(m,"FormulaAssistanceUIControlFactory",d.a,[]);a.d(C,"a",function(){return v});const v=()=>{c.a.Fa(n=>{m.ka(n)})}},1243:function(t,C,a){var c=a(10);t=a(0);var b=a(221),d=a(50),f=a(37),e=a(21),k=a(15),l=a(31),m=a(211),v=a(24),n=a(65),w=a(1),
r=a(1084),u=a(11);class y{constructor(z,A){this.KMa=1;this.Zfa=[];this.active=!1;this.xw=()=>{const I=this.gridView.Rfd();if(!(0>=I||I===this.KMa||this.gridView.$p)){var F=!1,U=[],X=[];for(var S=this.Zfa.length-1;0<=S;S--){var H=this.Zfa[S];if(this.Qfd(H)>I||H.bottom<I)U.push(H),this.Zfa.splice(S,1),F=!0}for(S=this.tableManager.rangeList.length-1;0<=S;S--){H=this.tableManager.rangeList[S];var D=this.Qfd(H);D<=I&&H.bottom>=I&&!(D<=this.KMa&&H.bottom>=this.KMa)&&H.yaa&&(X.push(H),F=!0)}if(F){H=this.gridView.coc;
for(let M of H)for(let G of M)for(let T of G){S=T.Sn;D=r.a(T.L3);for(var J=U.length-1;0<=J;J--)H=U[J],this.czc(H,!1,D,S)&&U.splice(J,1);for(J=X.length-1;0<=J;J--)H=X[J],this.czc(H,!0,D,S)&&this.Zfa.push(H);F&&T.TNd(D)}}else k.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");this.KMa=I}};this.Bxf=(I,F)=>{F.isRow||F.vUc(this.zKa)};this.Cxf=(I,F)=>{F.isRow||(this.tableManager.rangeList.length||this.deactivate(),F.TId(this.zKa))};this.zKa=
(I,F)=>{if(this.Ud())this.activate();else if(I=this.active,this.deactivate(),!I){k.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlockHtml: detected an opportunity for bailing out");return}(F=F.$t)&&this.C4f(F.Sn[0],F.Sn[F.Sn.length-1],F.L3,F.Sn)};this.nAf=(I,F)=>{!this.gridView.$p&&(this.Ud()?this.activate():(I=this.active,this.deactivate(),I||k.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),F=F.$t)&&
(I=r.a(F.L3),this.C4f(F.Sn[0],F.Sn[F.Sn.length-1],I,F.Sn)&&F.TNd(I))};this.re=()=>{this.gridView.ib.J3?this.deactivate():this.activate()};this.tableManager=z;this.gridView=A;this.$=A.$;z.Sme(this.nAf);A.DEg(this.Bxf);A.EEg(this.Cxf);this.$.xa.Pf(this.re);this.$.zb.Pf(this.re);this.rqe(I=>{I.vUc(this.zKa)});this.Ud()&&(this.activate(),this.xw(this,null));this.$.da.Ga(68,this)}dispose(){this.deactivate();this.gridView&&(this.tableManager.cQf(this.nAf),this.gridView.Kaj(this.Bxf),this.gridView.Laj(this.Cxf),
this.$.xa.zg(this.re),this.$.zb.zg(this.re),this.rqe(z=>{z.TId(this.zKa)}));this.gridView=this.tableManager=this.Zfa=null}czc(z,A,I,F){if(!n.b(this.$.pa)||this.$.ea.isNamedObjectViewMode||this.gridView.ib.VSa)return!0;if(!I.length)return!1;var U=F.length;if(F[U-1]<z.left)return!1;var X=u.HelperMethods.mx(new m.a(F),0,U,z.left,u.HelperMethods.iD);if(0>X)return!1;const S=z.i9f,H=!!z.KZa&&0<z.KZa.length,D=!!z.menuModel&&0<z.menuModel.length;for(let M=X,G=0,T=Math.min(S.length+X,U);M<T;M++,G++)if(U=I[M],
!w.EwaSettings.isChangeGateEnabled("OfficeVSO:5317457_ToggleHeaderSnapping_JSCrash_Fix")||U){X=null;var J=U.getElementsByClassName(l.a.T8c);J&&(X=J[0]);if(X&&X.innerText){if(J=U.getElementsByClassName(l.a.aoe))for(let K=J.length-1;0<=K;K--)U.removeChild(J[K]);J=F[M];A?(X.innerText=S[G],U.classList.add(l.a.jPe),H&&z.KZa[G]&&(X=document.createElement("div"),X.innerHTML=z.KZa[G],D&&z.menuModel[G]&&this.jBg(z,G,J),U.appendChild(X.firstChild))):(U.classList.remove(l.a.jPe),X.textContent=v.Range.xP(J),
this.Chh(J))}}z.aSa=A;return!0}jBg(z,A,I){this.$.da.Za(8,F=>{F.m8b.QLi(z,A,I)})}Chh(z){this.$.da.Za(8,A=>{A.m8b.RLi(z)})}C4f(z,A,I,F){let U=!1;const X=this.YYh(z,A);for(let S=this.Zfa.length-1;0<=S;S--){const H=this.Zfa[S];A>=H.left&&z<=H.right&&(this.czc(H,!1,I,F),this.Zfa.splice(S,1),U=!0)}for(let S=0,H=X.length;S<H;S++)this.czc(X[S],!0,I,F)&&(this.Zfa.push(X[S]),U=!0);return U}activate(){this.Ud()&&!this.active&&(this.gridView.view.Ls(this.xw),this.active=!0)}deactivate(){this.active&&(this.gridView.view.Pq(this.xw),
this.active=!1)}Ud(){return n.b(this.$.pa)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.ib.wL&&0<this.tableManager.rangeList.length}rqe(z){const A=this.gridView.coc;for(let I of A)for(let F of I)for(let U of F)z(U)}YYh(z,A){const I=[];if(!this.active)return I;this.KMa=this.gridView.Rfd();for(let F=this.tableManager.rangeList.length-1;0<=F;F--){const U=this.tableManager.rangeList[F];U.bottom>=this.KMa&&this.Qfd(U)<=this.KMa&&U.left>=z&&U.right<=A&&U.yaa&&I.push(U)}return I}Qfd(z){const A=this.gridView.Db.Yj(z);
return A&&this.tableManager.Pcf(z,A.usedRange.topLeft)?z.top+1:z.top}}Object(t.a)(y,"HeaderSnappingFeature",null,[2]);class x extends b.a{constructor(z){super();this.$=z;this.Fb()}create(){const z=d.GetServiceTaskFactory.create(this.$.da,134,this.la,this.hb);f.TaskExtensions.Aa(f.TaskExtensions.Wd([z],this.la),()=>{this.qb(this.$.da.za(68)||new y(z.result,e.g(this.$)))},this.la,11)}static ka(z){z.da.Ga(67,new x(z))}}Object(t.a)(x,"HeaderSnappingFactory",b.a,[]);a.d(C,"a",function(){return B});const B=
()=>{c.a.Fa(x.ka)}},1268:function(t,C,a){var c=a(10);t=a(0);var b=a(15),d=a(871),f=a(27),e=a(194),k=a(221),l=a(225),m=a(1),v=a(51),n=a(55),w=a(196),r=a(33);class u{constructor(){this._list={}}addHandler(A,I){var F;this._list[A]=[...(null!==(F=this._list[A])&&void 0!==F?F:[]),I]}removeHandler(A,I){const F=this._list[A];void 0!==F&&(I=F.indexOf(I),0<=I&&(this._list[A]=[...F.slice(0,I),...F.slice(I+1)]))}getHandler(A){const I=this._list[A];return I&&0!==I.length?(F,U)=>{for(const X of I)X(F,U)}:null}static dIb(){Sys.EventHandlerList.prototype.addHandler=
u.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=u.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=u.prototype.removeHandler}}Object(t.a)(u,"EventHandlerListOptimized",null,[]);class y{constructor(){this._list={}}addHandler(A,I){this.invalidate(A);void 0===this._list[A]?this._list[A]=[I]:this._list[A].push(I)}invalidate(A){void 0!==this.mA&&this.mA.delete(A)}removeHandler(A,I){const F=this._list[A];void 0!==F&&0!==F.length&&(I=F.indexOf(I),0<=I&&(this.invalidate(A),
F.splice(I,1)))}getHandler(A){void 0===this.mA&&(this.mA=new Map);var I=this.mA.get(A);return void 0===I?(I=this.makeHandler(A),this.mA.set(A,I),I):I}makeHandler(A){A=this._list[A];if(!A||0===A.length)return null;const I=[...A];return(F,U)=>{for(let X=0;X<I.length;++X)I[X](F,U)}}static dIb(){Sys.EventHandlerList.prototype.addHandler=y.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=y.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=y.prototype.removeHandler;Sys.EventHandlerList.prototype.makeHandler=
y.prototype.makeHandler;Sys.EventHandlerList.prototype.invalidate=y.prototype.invalidate}}Object(t.a)(y,"EventHandlerListMemoized",null,[]);class x{constructor(A){this.a=A;this.preventDefault=x.BEf.preventDefault;this.stopPropagation=x.BEf.stopPropagation;const I=this.type=A.type.toLowerCase();this.rawEvent=A;this.altKey=A.altKey;"undefined"!==typeof A.button&&(this.button="undefined"!==typeof A.which?A.button:4===A.button?Sys.UI.MouseButton.middleButton:2===A.button?Sys.UI.MouseButton.rightButton:
Sys.UI.MouseButton.leftButton);"keypress"===I?this.charCode=A.charCode||A.keyCode:this.keyCode=A.keyCode&&46===A.keyCode?127:A.keyCode;this.clientX=A.clientX;this.clientY=A.clientY;this.ctrlKey=A.ctrlKey;this.target=A.target?A.target:A.srcElement;this.screenX=A.screenX;this.screenY=A.screenY;this.shiftKey=A.shiftKey}get offsetX(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetX)return this.rawEvent.offsetX;if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientX){const A=
Sys.UI.DomElement.getLocation(this.target);return(Sys.UI.DomElement._getWindow(this.target).pageXOffset||0)+this.clientX-A.x}}}get offsetY(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetY)return this.rawEvent.offsetY;if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientY){const A=Sys.UI.DomElement.getLocation(this.target);return(Sys.UI.DomElement._getWindow(this.target).pageYOffset||0)+this.clientY-A.y}}}static dIb(){Sys.UI.DomEvent=x;x.registerClass("Sys.UI.DomEvent",
void 0,void 0)}}x.addHandler=Sys.UI.DomEvent.addHandler;x.addHandlers=Sys.UI.DomEvent.addHandlers;x.removeHandler=Sys.UI.DomEvent.removeHandler;x.clearHandlers=Sys.UI.DomEvent.clearHandlers;x._removeHandler=Sys.UI.DomEvent._removeHandler;x._clearHandlers=Sys.UI.DomEvent._clearHandlers;x._disposeHandlers=Sys.UI.DomEvent._disposeHandlers;x.BEf=Sys.UI.DomEvent.prototype;x.registerClass=function(A,I,F){this.prototype.constructor=this;this.__typeName=A;this.__class=!0;I&&(this.__baseType=I,this.__basePrototypePending=
!0);Sys.__upperCaseTypes[A.toUpperCase()]=this;if(F){this.__interfaces=[];for(let U=2,X=arguments.length;U<X;U++)this.__interfaces.push(arguments[U])}return this};Object(t.a)(x,"DomEventLazy",null,[524]);class B extends k.a{constructor(A){super();this.w3b=null;this.$=A;this.Fb()}create(){b.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");d.a.then(this.f8g(),A=>{this.qb(A)})}f8g(){if(this.w3b)return this.w3b;const A=l.a.m0a(v.b(),e.a.none,"LoadResource","x10Scheduler loading");
if(m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNativeStartsWithEndsWith",!1)){var I=String.prototype;if(void 0===I.startsWithOriginal||void 0===I.endsWithOriginal)if(m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RetrieveOriginalStringUsingIFrameHack",!1)){const F=document.createElement("frame");document.body.appendChild(F);const U=F.contentWindow.String.prototype;document.body.removeChild(F);I.startsWithOriginal=U.startsWith;I.endsWithOriginal=U.endsWith}else I.startsWithOriginal=
function(F,U=0){return this.lastIndexOf(F,U)===U},I.endsWithOriginal=function(F){return-1!==this.indexOf(F,this.length-F.length)};I.startsWith=I.startsWithOriginal;I.endsWith=I.endsWithOriginal}m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseImmutableHandlers",!1)&&u.dIb();m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMemoizedHandlers",!1)&&y.dIb();m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseLazyDomEvent",!1)&&x.dIb();if(m.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&
f.a.kv)return I=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance(),this.$.da.Ga(413,I),A.setResult(I),this.w3b=A.task;this.$.da.Za(266,F=>{m.EwaSettings.isChangeGateEnabled("OfficeVSO:6600721_doGracefullyFallIfTryToLoadSchedulerWithoutCalc")&&!F.tec?(b.ULS.sendTraceTag(520901762,0,15,"PluginSchedulerFactory.createPluginSchedulerAsync: Calc is not initialized, pluginScheduler creation canceled"),A.ps()):this.$.da.Za(283,U=>{const X=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();U=
w.b(n.Task.Ta(U.Zn));(m.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed")?Promise.all([excelOnlineCalc.x10.ensureGroupAttached(U,0),r.a.ULg(this.$)?excelOnlineCalc.x10.ensureGroupAttached(U,2):Promise.resolve(0)]).then(S=>S.some(H=>0<H)):excelOnlineCalc.x10.ensureAllPluginsAttached(U)).then(S=>{this.$.da.Ga(413,X);A.setResult(X);m.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&this.$.da.Za(491,H=>{H.C6.anyPluginInitialized=S})})})});
return this.w3b=A.task}static ka(A){A.da.Ga(414,new B(A))}}Object(t.a)(B,"PluginSchedulerFactory",k.a,[]);a.d(C,"a",function(){return z});const z=()=>{c.a.Fa(A=>{B.ka(A)})}},1431:function(t,C,a){a.r(C);var c=a(1075),b=a(0),d=a(691),f=a(15),e=a(177),k=a(61);const l=(wb,hc,Za,ub,uc,Oc,Bb,Nb,dc,sc)=>{sc=wb.Na(9,sc);sc.selectedRange=hc;sc.activeCell=Za;sc.autoSumType=ub;sc.topLeftCell=uc;return k.g(wb,"AutoSum",sc,Oc,Bb,Nb,dc,0)},m=(wb,hc,Za,ub,uc,Oc)=>{if(hc){const Bb=wb.textBox;wb.eb||wb.startEdit(hc,
!0);wb.Eod=!0;wb.text=Za;Bb.caretPosition=uc;uc<Oc&&(ub&&wb.rAa(),Bb.selectRange(0,Oc+1),Bb.selectRange(uc,Oc))}};var v=a(77);class n{constructor(wb,hc){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=wb;this.type=hc}S3a(){return this.sharedSheetRange}}Object(b.a)(n,"MacroRecorderAutoSumPayload",null,[101]);var w=a(43),r=a(513),u=a(368),y=a(170),x=a(50),B=a(37),z=a(153),A=a(340),I=a(29),F=a(1),U=a(182),X=a(280),S=a(21),H=a(125),D=a(562),J=a(55);class M extends e.a{constructor(wb){super();
this.Ctf=hc=>{const Za=S.g(this.$);if(hc=hc.Result){let ub=w.D(hc.NewSelection),uc=w.D(hc.NewActiveCell);if(ub&&uc)if(!hc.Committed&&hc.AutoSumFormula){const Oc=Za.Vb(uc);Oc&&(Za.ha.updateSelection(ub,uc,60),ub=uc=w.D(hc.MarkedArea),Za.NJ=2,m(Za.hc,Oc,hc.AutoSumFormula,!!ub,hc.FormulaMarkStart,hc.FormulaMarkEnd),ub&&uc&&Za.ha.updateSelection(ub,uc,0),Za.hc.Eod=!1,B.TaskExtensions.Aa(x.GetServiceTaskFactory.create(this.$.da,153,this.la,0),Bb=>{Bb.result.z1a(null)},this.la,3))}else Za.ha.updateSelection(ub,
uc,60)}};this.$=wb}Nc(){return!1}executeCommand(wb,hc,Za){wb=hc.command;switch(wb){case 1220954656:hc=this.DHe(0,hc);break;case -1537138325:hc=this.DHe(parseInt(Za[v.a.Pc].toString(),10),hc);break;default:hc=U.a(wb)}return hc}Cc(wb,hc){if(wb=1===wb)switch(hc.command){case 1220954656:case -1537138325:break;default:wb=!1}return wb}Rc(){return!1}DHe(wb,hc){const Za=S.g(this.$);Za.Df.XG(!1);if(!S.g(this.$).ha.sa.wg)return hc=S.g(this.$).ha.sa.EK,f.ULS.sendTraceTag(537170308,0,50,`AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type ${wb} due to discontinuous selection. Number of selected ranges is ${hc}`),
this.Gya(),J.Task.Ta(!1);const ub=Za.wH();if(!ub)return null;const uc=w.v(Za.ha.sa.Wc,this.$),Oc=w.o(Za.ha.sa.activeCell,this.$),Bb=w.o(ub,this.$),Nb=this.$.oa.va.Sb(),dc=()=>new n(uc,wb);return this.$.rq(Za.ha.sa.selectedRanges,!0)?F.EwaSettings.dc()?u.a(this.$.userOperationManager,(sc,yc,cd)=>l(this.$.oa.va,uc,Oc,wb,Bb,X.b(sc,this.Ctf),yc,cd,wb,Nb),sc=>new y.a(502,0,sc,64,dc),hc):u.a(this.$.userOperationManager,(sc,yc,cd)=>l(this.$.oa.va,uc,Oc,wb,Bb,X.b(sc,this.Ctf),yc,cd,wb,Nb),sc=>new r.a(502,
0,sc,void 0,dc),hc):J.Task.Ta(!1)}Gya(){D.a(H.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);var wb=I.a.Yc(1,1,756,2191,0,371863010,"DiscontinuousSelectionBlocking");F.EwaSettings.wz()?new A.a(this.$,wb):(wb=new z.ErrorDialog(this.$,wb),wb.initialize(),wb.Ff())}}Object(b.a)(M,"AutoSumCommandHandler",e.a,[195]);class G extends d.a{constructor(wb){super(wb)}yd(){this.gd([new M(this.$)])}static ka(wb){d.a.Nd(96,new G(wb))}}Object(b.a)(G,"AutoSumCommandHandlerFactory",d.a,[]);var T=a(10),
K=a(172),L=a(262),V=a(38),W=a(317),da=a(1076),qa=a(281),O=a(75);class ea extends V.a{constructor(wb,hc,Za){super();this.IGi=(ub,uc)=>{if(!qa.a(ub)&&uc){const Oc=!!ub&&!!ub.RequestTelemetryData;S.g(this.$).Gi.Pka(uc.toString(),ub.StateId,Oc?ub.RequestTelemetryData.EcsOperationDuration:0,Oc?ub.RequestTelemetryData.EcsRequestDuration:0,Oc?ub.RequestTelemetryData.WfeRequestDuration:0)}};this.$=wb;this.tableManager=hc;this.ug=Za}GDg(wb){this.addHandler("ekcvc",wb)}V$i(wb){this.removeHandler("ekcvc",wb)}Nc(){return!1}executeCommand(wb,
hc){wb=hc.command;switch(wb){case -730106152:hc=this.Igd(hc,3);break;case -1228228458:hc=this.Igd(hc,4);break;case -848953656:case 2045211913:if(this.Pji()){hc=J.Task.Ta(!0);break}hc=this.Igd(hc,1);break;default:hc=U.a(wb)}return hc}Cc(wb,hc){if(wb=1===wb)switch(hc.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:wb=!1}return wb}Rc(){return!1}Igd(wb,hc){var Za=S.g(this.$);const ub=Za.ha.sa.selectedRanges,uc=wb.command,Oc=K.a.create().toString();if(!this.$.rq(ub,
!0)&&-730106152!==uc)return J.Task.Ta(!0);const Bb=w.r(ub,this.$);this.Szj(uc,Za,ub,Oc);F.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.o2i();const Nb=this.$.oa.va.Sb({MZ:!0,dZ:1});Za=(sc,yc,cd)=>{this.$.ry();return k.d(this.$.oa.va,hc,Bb,!1,X.b(sc,this.IGi),yc,cd,Oc,Nb)};const dc=()=>new da.a(hc,Bb);return F.EwaSettings.dc()?u.a(this.$.userOperationManager,Za,sc=>new y.a(508,0,sc,67,dc),wb):u.a(this.$.userOperationManager,Za,sc=>new r.a(508,0,sc,
3,dc),wb)}Szj(wb,hc,Za,ub){if(-848953656!==wb&&2045211913!==wb&&-730106152!==wb&&-1228228458!==wb)f.ULS.sendTraceTag(537167938,0,10,`ClearCommandHandler.ShowInstantaneousClear: Unexpected command ${wb}.`);else if(!L.a.any(Za,Oc=>0<hc.getRangeInformation(Oc).length)){var uc=L.a.any(Za,Oc=>this.tableManager.Tpd(Oc));if(-730106152!==wb&&-1228228458!==wb||!uc)this.LDj(hc,wb,ub,Za),-730106152!==wb&&-1228228458!==wb||this.ug.wda(hc,-730106152,{}),-1228228458!==wb&&2045211913!==wb&&-848953656!==wb||this.ug.LXg(Za,
ub),hc.Gi.e0(ub,O.BasicTelemetryCalculator.vQ)}}LDj(wb,hc,Za,ub){let uc="";switch(hc){case -1228228458:uc="ClearAll";break;case 2045211913:case -848953656:uc="ClearContent";break;case -730106152:uc="ClearFormat";break;default:f.ULS.sendTraceTag(537167937,0,15,`ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command ${hc}.`)}hc=ub.length;ub=w.b(ub);wb.Gi.T6(15,Za,uc+(", ranges to clear: "+hc+", cells to clear: "+ub))}o2i(){this.raiseEvent("ekcvc",new W.a)}Pji(){if(S.g(this.$).oz){const wb=
this.$.da.za(296);return!!wb&&wb.dU.gB}return!1}}Object(b.a)(ea,"ClearCommandHandler",V.a,[195,563]);class R extends d.a{constructor(wb){super(wb)}yd(){const wb=x.GetServiceTaskFactory.create(this.$.da,134,this.la,this.hb),hc=x.GetServiceTaskFactory.create(this.$.da,18,this.la,this.hb);B.TaskExtensions.Aa(B.TaskExtensions.Wd([wb,hc],this.la),()=>{const Za=new ea(this.$,wb.result,hc.result);this.gd([Za]);this.$.da.Ga(313,Za)},this.la,3)}static ka(wb){d.a.Nd(101,new R(wb))}}Object(b.a)(R,"ClearCommandHandlerFactory",
d.a,[]);var oa=a(1218),pa=a(1077),Pa=a(1132),Z=a(1079),Ra=a(1080),Ga=a(1143),Ba=a(86),fa=a(221),Y=a(4),ja=a(106),ca=a(44),aa=a(11),ta=a(83),xa=a(144);class ia{}ia.HTML='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(b.a)(ia,"FileUploadDialogHTML",null,[]);var ya=a(151),ib=a(25);class wa extends xa.a{constructor(wb){super(!1,!1,wa.wu);this.gud=!1;this.Onf=!0;this.Xmf=0;this.Rb=1;this.rc(1,CommonUIStrings.l_Send);this.rc(0,CommonUIStrings.l_NoThanks);this.ag=ia.HTML;this.Qmf=wb;this.ze=wa.lSg}oj(wb,hc,Za,ub=!1,uc=!0){this.gud=ub;this.czj(hc);this.Xmf=wb;uc&&Y.AFrameworkApplication.TF(wb)}czj(wb){if(wa.wu)this.KAj(wb);else{var hc={};hc[wa.hSg]=wb;hc[wa.nSg]=CommonUIStrings.l_SendFileErrorReportMessage;hc[wa.oSg]=
CommonUIStrings.l_SendFileErrorReportTextCaption;hc[wa.$Xc]="";hc[wa.kSg]=CommonUIStrings.l_UserReportLinkText;hc[wa.$_b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(ta.a)(this,this.Uqi,"legacyDialogHandler"),hc);this.jW(wa.tSg)}}KAj(wb){wb={["id"]:this.ze,["bodyControls"]:{["reportErrorCheckboxProps"]:this.gud?{["label"]:CommonUIStrings.l_UserReportLinkText}:null,["textAreaProps"]:this.Onf?{}:null,["privacyStatementLinkProps"]:{["text"]:CommonUIStrings.l_PrivacyStatement,
["handler"]:{["href"]:Y.AFrameworkApplication.ama,["target"]:"_blank"}}},["errorMessage"]:wb,["errorReportMessage"]:CommonUIStrings.l_SendFileErrorReportMessage,["errorTextPrompt"]:CommonUIStrings.l_SendFileErrorReportTextCaption};this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(ta.a)(this,this.GFd,"reactDialogHandler"),wb)}l9a(){if(!wa.wu){var wb=document.getElementById(wa.qSg);wb&&(wb.className=wa.pSg,wb.appendChild(ya.createClusteredImage(32,32,wa.mSg,null,!0,CommonUIStrings.l_DialogError)));
if(wb=document.getElementById(wa.rSg))wb.innerText=CommonUIStrings.l_PrivacyStatement,wb.href=Y.AFrameworkApplication.ama,ca.a.addHandler(wb,"click",Object(ta.a)(this,this.aPi,"onPrivacyClickHandler"));this.Onf||(wb=document.getElementById(wa.$Xc))&&wb.parentNode&&wb.parentNode.removeChild(wb);this.gud||(wb=document.getElementById(wa.jSg))&&wb.parentNode&&wb.parentNode.removeChild(wb)}}BI(){wa.wu||(super.BI(),document.getElementById(this.hi("WACDialogPanel")).style.width=String.format("{0}px",400))}Uqi(wb,
hc){const Za=hc[wa.$Xc]||"";let ub=!0;void 0!==hc[wa.$_b]&&null!==hc[wa.$_b]&&(ub=hc[wa.$_b]);this.$v(wb,Za,ub)}GFd(wb,hc){this.$v(wb,hc.text||"",hc.reportErrorChecked)}$v(wb,hc,Za){this.Qmf&&(Za&&f.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.Xmf),this.Qmf(wb,hc,Za))}aPi(wb){Y.AFrameworkApplication.wb.de(ib.a.lGb,2,wb)}get UX(){return!1}static get wu(){return Y.AFrameworkApplication.ta.Oa.mv&&Y.AFrameworkApplication.ta.Oa.pki}}wa.hSg="WACDialogErrorMessage";wa.nSg="WACDialogErrorReportMessage";
wa.oSg="WACDialogErrorTextPrompt";wa.$Xc="WACDialogInput";wa.rSg="WACDialogPrivacyText";wa.qSg="WACDialogIconPanel";wa.mSg="CancelRequest_32x32x32";wa.pSg="WACDialogIcon";wa.tSg="WACDialogTextPanel";wa.$_b="WACDialogSendFileCheckbox";wa.jSg="WACDialogSendFileCheckboxContainer";wa.kSg="WACDialogSendFileCheckboxText";wa.lSg="FileUploadErrorDialog";Object(b.a)(wa,"FileUploadErrorDialog",xa.a,[]);class sa extends V.a{constructor(wb){super();this.$Hf=0;this.gH=null;this.N9i=hc=>{this.daj(hc)};this.cZg=
(hc,Za)=>{if(1===hc&&this.gH.FileCollectionErrorStateId){hc=this.$.oa.va;var ub=this.gH.MessageId,uc=this.gH.OriginalEcsServerId,Oc=this.gH.FileCollectionErrorStateId;const Bb=hc.Na(0);Bb.errorMessageId=ub;Bb.ecsServerId=uc;Bb.fileCollectionErrorStateId=Oc;Bb.userComment=Za;hc.rYc("CollectFile",Bb,null,null,null,null,0)}this.raiseEvent("fileCollectionComplete",null,this)};this.$=wb}RDg(wb){this.addHandler("fileCollectionComplete",wb)}daj(wb){this.removeHandler("fileCollectionComplete",wb)}bZg(wb,
hc,Za){this.$Hf=hc;this.gH=wb;this.RDg(Za);Y.AFrameworkApplication.ama=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;wb=new wa(this.cZg);Y.AFrameworkApplication.wb.Ob(ib.a.lGb,ja.a.frame,sa.a0i);wb.oj(0,"",null,!1,!1)}static a0i(wb,hc,Za,ub,uc){ca.a.Qt(uc);Y.AFrameworkApplication.ama&&aa.HelperMethods.Ve(Y.AFrameworkApplication.ama,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32}}Object(b.a)(sa,"FileCollectionOperation",V.a,[564,2]);class Ya extends fa.a{constructor(wb){super();
this.wRb=null;this.$=wb;this.Fb()}get hyh(){return this.wRb||(this.wRb=new sa(this.$))}create(){B.TaskExtensions.Aa(x.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),()=>{this.qb(this.hyh)},this.la,3)}dispose(){Ba.a.Ia(this.wRb);this.wRb=null;super.dispose()}static ka(wb){wb.da.Ga(125,new Ya(wb))}}Object(b.a)(Ya,"FileCollectionCommandHandlerFactory",fa.a,[]);var bb=a(1148),mb=a(1082),Ca=a(1242),$a=a(7),Kb=a(641);class rb{}Object(b.a)(rb,"FreezePanesCommandParameters",null,[]);var cc=a(8),
nc=a(181),Wb=a(24),Ea=a(383),ua=a(28),ma=a(267),fb=a(269),sb=a(116);const Ua=(wb,hc,Za,ub,uc,Oc,Bb=null)=>{Bb=wb.Na(9,Bb);Bb.freezeSettings=hc;return k.g(wb,"FreezeOrUnfreezePanes",Bb,Za,ub,uc,Oc,0)};class ab{constructor(wb){this.freezeOptions=null;this.freezeOptions=wb}getSheetName(){return this.freezeOptions.SheetName}}Object(b.a)(ab,"MacroRecorderSheetPaneFrozenPayload",null,[101]);var na=a(42);class Na{constructor(wb,hc){this.l9b=this.KEd=null;this.Kwf=()=>{F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",
!1)||this.Asc();if(this.l9b){const Za=ma.a(ua.a.Wa.je,this.l9b);f.ULS.sendTraceTag(570949840,5,50,`FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: ${Za}`);this.l9b=null}this.sEf()};this.$=wb;this.gridView=S.g(wb);this.eD=hc.Rqb(this.$.domElement,500,null,null);this.mKa=this.lKa=-1}Nc(wb,hc){let Za=!1;switch(hc){case 1844679312:Za=1!==wb&&!this.gridView.ib.J3}return Za}executeCommand(wb,hc){wb=this.gridView.ib;const Za=this.gridView.ggd();
Y.AFrameworkApplication.ta.Oa.lw&&this.$.wZ&&(1844679312===hc.command||340334732===hc.command||-806625837===hc.command)&&Kb.ShyRibbon.xJ(1,2);switch(hc.command){case 1844679312:return this.setFreezePanes(hc,Za,wb.mj);case 340334732:return wb.G8b?J.Task.Ta(!1):this.aqj(hc,Za);case -806625837:return wb.VSa?J.Task.Ta(!1):this.bqj(hc,Za)}return J.Task.Ta(!1)}Cc(wb,hc){wb=!1;switch(hc.command){case 1844679312:case 340334732:case -806625837:case 1745254833:wb=!0}return wb}Rc(){return!1}setFreezePanes(wb,
hc,Za){if(Za)return this.huc(wb,!1,0,0,0,0,hc,null);var ub=this.gridView.ha.sa;Za=ub.activeCell.clone();ub=ub.activeRange;ub.Ze&&(f.ULS.sendTraceTag(537159585,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${Za.top}) and firstUnfreezeCell.Bottom (${Za.bottom}) to equal topLeftRange.Top (${hc.top})`),Za.top=Za.bottom=hc.top);ub.isRow&&(f.ULS.sendTraceTag(537159584,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${Za.left}) and firstUnfreezeCell.Right (${Za.right}) to equal topLeftRange.Left (${hc.left})`),
Za.left=Za.right=hc.left);Za.top===hc.top&&Za.left===hc.left&&(Za=Wb.Range.Uc(Za.top+1,Za.left));ub=Za.top-1;const uc=Za.left-1,Oc=ub-(hc.top-1),Bb=uc-(hc.left-1);return this.hVj(Za,Oc,Bb)?this.huc(wb,!0,ub,uc,Oc,Bb,hc,Za):(this.$.qf(),this.sEf(),J.Task.Ta(!0))}aqj(wb,hc){return this.huc(wb,!0,0,hc.left,0,1,hc,null)}bqj(wb,hc){return this.huc(wb,!0,hc.top,0,1,0,hc,null)}hVj(wb,hc,Za){const ub=this.gridView.mg(wb),uc=this.gridView.view.visibleArea;return!ub||uc.topLeft.y>ub.bottomRight.y||uc.topLeft.x>
ub.bottomRight.x||uc.bottomRight.y<ub.bottomRight.y||uc.bottomRight.x<ub.bottomRight.x?(f.ULS.sendTraceTag(537159583,0,50,`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${wb}, rangeViewportArea=${ub?ub.toString():"null"}, visibleArea=${uc.toString()}`),wb=I.a.Yc(1,0,26,1492,0,2105967339,"FreezePaneSelectionNotInViewErr"),F.EwaSettings.wz()?new A.a(this.$,wb):(wb=new z.ErrorDialog(this.$,wb),wb.initialize(),wb.Ff()),!1):0>=
hc&&0>=Za?(f.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),wb=S.g(this.$).rtl?1494:1493,hc=S.g(this.$).rtl?-2131054257:-1953454131,wb=I.a.Yc(1,0,26,wb,0,hc,"FreezePaneA1SelectedErr"),F.EwaSettings.wz()?new A.a(this.$,wb):(wb=new z.ErrorDialog(this.$,wb),wb.initialize(),wb.Ff()),!1):!0}huc(wb,hc,Za,ub,uc,Oc,Bb,Nb){this.KEd=na.a(this.$).X8(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.aT(this.Kwf);this.eD.hSa();
this.gridView.oEj(hc?"":"UnsetFreezePane");this.tsj(wb,hc,this.gridView.ib);const dc=Object($a.a)(new rb,{SheetName:this.$.pa.name,Freeze:hc,FrozenRows:uc,FrozenColumns:Oc,FirstRow:Za,FirstColumn:ub});f.ULS.sendTraceTag(573101852,0,50,`FreezePanesCommandHandler.SendFreezePanesRequest: Freeze=${hc}, FrozenRows=${uc}, FrozenColumns=${Oc}, FirstRow=${Za}, FirstColumn=${ub} `);const sc=()=>new ab(dc);this.l9b=ua.a.Wa.je;return u.a(this.$.userOperationManager,(yc,cd,pd)=>{if(F.EwaSettings.ma(60)){var Rb=
window.performance;Rb.clearMarks();Rb.mark("FreezePanes request sent")}Rb=this.gridView.Gs;F.EwaSettings.isChangeGateEnabled("OfficeVSO:6661123_RequestContentOnFreezePaneOperation")&&Rb?(Rb=this.qlh(dc,Rb,Bb,Nb),this.CLj(Rb)):this.$.ry();return Ua(this.$.oa.va,dc,yc,cd,pd,hc)},yc=>new y.a(151,0,yc,void 0,sc),wb)}qlh(wb,hc,Za,ub){f.ULS.shipAssertTag(537159580,1,!!hc,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!wb.Freeze)return null;const uc=
fb.a();uc.State=1;uc.IsEstimated=!0;let Oc=!1,Bb=!1;const Nb=hc.AU(Wb.Range.Uc(Za.top,Za.left));let dc=wb.FrozenRows;var sc=wb.FrozenColumns;1!==wb.FrozenRows||wb.FrozenColumns?wb.FrozenRows||1!==wb.FrozenColumns?(sc=hc.AU(Wb.Range.Uc(wb.FirstRow+1,wb.FirstColumn+1)),hc=hc.AU(Wb.Range.Uc(Za.top,Za.left)),uc.Width=sc.sj-Nb.sj,uc.Height=sc.Dj-Nb.Dj,0<wb.FrozenRows&&(uc.AbsoluteTop=sc.Dj,Bb=!0),0<wb.FrozenColumns&&(uc.AbsoluteLeft=sc.sj,Oc=!0),dc=sc.uI-hc.uI,sc=sc.YG-hc.YG):(uc.Width=hc.Ped(nc.a.Uc(Za.top,
Za.left)),ub=Wb.Range.Uc(Za.top,Za.left+1),uc.AbsoluteLeft=Nb.sj+uc.Width,Oc=!0):(uc.Height=hc.Oed(nc.a.Uc(Za.top,Za.left)),ub=Wb.Range.Uc(Za.top+1,Za.left),uc.AbsoluteTop=Nb.Dj+uc.Height,Bb=!0);Bb&&(uc.FirstFrozenRow=Za.top,uc.FirstScrollableRow=ub.top);Oc&&(uc.FirstFrozenColumn=Za.left,uc.FirstScrollableColumn=ub.left);uc.VisibleRows=dc;uc.VisibleColumns=sc;return uc}CLj(wb){J.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(()=>{this.$.pa&&this.$.ea&&(this.$.ea.BW(cc.a.Ce,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),
Ea.b(this.$.pa,wb,-1,void 0,!0))})}tsj(wb,hc,Za){if(!F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",!1))switch(wb.command){case 1844679312:if(hc||-1===this.lKa&&-1===this.mKa)this.lKa=Za.ix-Za.width+this.gridView.scrollLeft,this.mKa=Za.jx-Za.height+this.gridView.scrollTop;break;case 340334732:if(hc||-1===this.lKa)this.lKa=Za.ix-Za.width+this.gridView.scrollLeft;break;case -806625837:if(hc||-1===this.mKa)this.mKa=Za.jx-Za.height+this.gridView.scrollTop}}Asc(){const wb=
this.gridView.ib;0<wb.width?this.gridView.scrollLeft=sb.a.K_b(this.gridView.domElement,S.g(this.$).rtl,0):-1!==this.lKa&&(this.gridView.scrollLeft=this.lKa,this.lKa=-1);0<wb.height?this.gridView.scrollTop=0:-1!==this.mKa&&(this.gridView.scrollTop=this.mKa,this.mKa=-1)}sEf(){this.eD.nSa();Ba.a.Ia(this.KEd);this.KEd=null;this.gridView.QN(this.Kwf)}}Object(b.a)(Na,"FreezePanesCommandHandler",null,[195]);class Va extends d.a{constructor(wb){super(wb)}yd(){B.TaskExtensions.Aa(x.GetServiceTaskFactory.Ra(this.$.da,
12,477,this.hb),wb=>{this.gd([new Na(this.$,wb.result)])},this.$.la)}static ka(wb){wb.da.Ga(116,new Va(wb))}}Object(b.a)(Va,"FreezePanesCommandHandlerFactory",d.a,[]);var Sa=a(1160),vb=a(27),Oa=a(560),yb=a(557),Ob=a(30),Ja=a(992),lb=a(1083);a(308);var Pb=a(14),Jb=a(33);class Lb{constructor(wb,hc){this.$=wb;this.fontServiceManager=hc;this.menuId=this.PXc=this.QR=this.iua=null;this.mad=0;this.Uzi="+mn-lt";this.$wi="+mj-lt";this.DJi=()=>{this.yYf()};this.YOi=Za=>{this.Pef=!0;this.$.Qx(ub=>{ub.XOa("FontName_New")});
f.ULS.sendTraceTag(520710160,1,15,`PreviewFont Status is ${Za}`)};this.hei=!!String.fromCodePoint&&!vb.a.fu&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.Pef=!1;this.Im=F.EwaSettings.Im();this.gridView=S.g(this.$);(this.Hm=Jb.a.Hm())&&this.fontServiceManager&&(this.fontServiceManager.gfc?this.yYf():this.fontServiceManager.Jme(this.DJi))}get themesManager(){this.dx||(this.dx=this.$.da.za(422));return this.dx}yYf(){this.QR=this.fontServiceManager.dyc;this.iua=
this.fontServiceManager.VBh;this.mad=2}get dyc(){return this.QR}yUe(wb,hc,Za,ub=null){const uc=Object.assign(new Oa.a,{Id:"FontDropdownMenu"});uc.MenuSectionList=[];if(this.Im&&this.themesManager){this.themesManager.Y9c(ub);if(null==this.themesManager.qL||this.themesManager.Zpd)return uc;ub=Object.assign(new yb.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:Pb.a.instance.ga(1338),ControlList:this.cYh(wb,hc,Za)});uc.MenuSectionList.push(ub)}ub=Object.assign(new yb.a,{ControlsId:"FontsMenuSectionControl"});
if(this.Im||this.Hm)ub.Title=Pb.a.instance.ga(1339);ub.ControlList=this.PNh(wb,hc,Za);uc.MenuSectionList.push(ub);return uc}cYh(wb,hc,Za){var ub;const uc=[];var Oc=this.gridView.ha.Pa.$b;Oc=5===(null===(ub=null===Oc||void 0===Oc?void 0:Oc.floatingObject)||void 0===ub?void 0:ub.type);let Bb,Nb;this.themesManager.qL?(Bb=this.themesManager.qL.Lpf,Nb=this.themesManager.qL.aof):f.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");null!=Nb?(ub=this.aEe(Nb,1,Oc,wb,hc,Za),uc.push(ub)):f.ULS.sendTraceTag(520710164,
1,15,"Major Theme Font is Null");null!=Bb?(wb=this.aEe(Bb,2,Oc,wb,hc,Za),uc.push(wb)):f.ULS.sendTraceTag(520710163,1,15,"Minor Theme Font is Null");return uc}aEe(wb,hc,Za,ub,uc,Oc){var Bb=2===hc?this.Uzi:this.$wi;Za=Za?Bb:Ob.a.gf(wb);Bb=Ob.a.gf(aa.HelperMethods.Yac(wb,hc));wb=Ob.a.gf(wb);return Object.assign(new Ja.a,{MenuItemId:2===hc?lb.b:lb.a,CommandValueId:Za,LabelText:Bb,LabelCss:String.format("font-size:12pt;font-family:{0};",wb),Styles:Lb.nvb(wb),AriaLabel:Bb,Alt:Bb,Command:ub.toString(),CommandPreviewId:uc.toString(),
CommandRevertId:Oc.toString()})}PNh(wb,hc,Za){if(this.PXc)return this.PXc.v4c;const ub=this.hei&&!this.Pef;let uc=!1;this.iua||(this.L9e(),uc=!0);let Oc=this.ACe(wb,hc,Za,this.iua,ub,uc);Oc.Zvc&&!uc&&(f.ULS.sendTraceTag(520710162,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),this.L9e(),Oc=this.ACe(wb,hc,Za,this.iua,ub,Oc.Zvc));this.Hm&&!Oc.Zvc&&(this.PXc=Oc);ub&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.YOi);return Oc.v4c}ACe(wb,
hc,Za,ub,uc,Oc){const Bb=[];let Nb;const dc=this.Hm&&!Oc;Nb=dc?"msofpNew":"msofp";for(let Rb in ub){var sc=Rb,yc=ub[Rb],cd=Ob.a.gf(sc),pd=void 0;if(dc)if(pd=this.QR?this.QR[sc]:null)pd=Ob.a.gf(pd);else return f.ULS.sendTraceTag(520710161,1,15,`FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for ${sc}`),{Zvc:!0,v4c:[]};else pd=Ob.a.gf(aa.HelperMethods.QR[sc]);sc=Ob.a.gf(sc);uc||(yc=0);cd=Object.assign(new Ja.a,{MenuItemId:cd,CommandValueId:cd,
LabelText:uc&&0<yc?Ob.a.gf(String.fromCodePoint(yc)):pd,LabelCss:String.format("font-size:12pt;font-family:{0};",uc&&0<yc?Nb:sc),Styles:Lb.nvb(uc&&0<yc?Nb:sc),AriaLabel:pd,Alt:pd,Command:wb.toString(),CommandPreviewId:hc.toString(),CommandRevertId:Za.toString()});Bb.push(cd)}return{Zvc:Oc,v4c:Bb}}Sqj(wb){this.menuId=wb}Sgi(){return 2!==this.mad&&3!==this.mad?!1:!0}L9e(){this.iua={["Angsana New"]:983046,["Arial Black"]:983051,["Arial"]:983050,["Batang"]:983061,["Book Antiqua"]:983077,["Browallia New"]:983082,
["Calibri"]:983085,["Cambria"]:983089,["Candara"]:983091,["Century"]:983095,["Comic Sans MS"]:983100,["Consolas"]:983101,["Constantia"]:983102,["Corbel"]:983106,["Cordia New"]:983107,["Courier New"]:983109,["DilleniaUPC"]:983121,["Dotum"]:983123,["FangSong"]:983138,["Garamond"]:983154,["Georgia"]:983156,["Gulim"]:983182,["GungSuh"]:983186,["KaiTi"]:983222,["JasmineUPC"]:983218,["Malgun Gothic"]:983258,["Mangal"]:983262,["Meiryo"]:983264,["Microsoft JhengHei"]:983272,["Microsoft YaHei"]:983284,["MingLiU"]:983292,
["MingLiU_HKSCS"]:983296,["MS Gothic"]:983245,["MS Mincho"]:983247,["MS PGothic"]:983249,["MS PMincho"]:983251,["PMingliU"]:983322,["PMingLiU-ExtB"]:983324,["SimHei"]:983382,["SimSun"]:983384,["SimSun-ExtB"]:983386,["Source Sans Pro"]:983396,["Tahoma"]:983405,["THSarabunPSK"]:983404,["Times New Roman"]:983415,["Trebuchet MS"]:983419,["Verdana"]:983443,["Yu Gothic"]:983464,["Yu Mincho"]:983474}}static nvb(wb){const hc={};hc["font-family"]=wb;hc["font-size"]="12pt";wb={};wb.optionText=hc;return wb}}
Object(b.a)(Lb,"FontDropdownHelper",null,[561]);var Ab=a(696);class nb extends fa.a{constructor(wb){super();this.$=wb;this.Fb()}create(){F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)?this.$.da.Za(504,wb=>{this.qb(Object(Ab.c)(this.$.da,502,()=>new Lb(this.$,wb)))}):this.qb(Object(Ab.c)(this.$.da,502,()=>new Lb(this.$,null)))}static ka(wb){wb.da.Ga(503,new nb(wb))}}Object(b.a)(nb,"FontDropdownHelperFactory",fa.a,[]);var va=a(1243),db=a(1085),Xa=a(1219),gb=
a(1183),Ha=a(1131),tb=a(1156),bc=a(1268),tc=a(1220),Ma=a(1191);class Tb{constructor(wb){this.$=wb}Nc(){return!1}executeCommand(wb,hc){wb=!1;hc=hc.command;switch(hc){case 1910465940:wb=!0}return wb?J.Task.Ta(!0):U.a(hc)}Cc(wb,hc){switch(hc.command){case 1910465940:return!0;default:return!1}}Rc(){return!1}}Object(b.a)(Tb,"NameManagerCommandHandler",null,[195]);class zb extends d.a{constructor(wb){super(wb)}yd(){this.gd([new Tb(this.$)])}static ka(wb){d.a.Nd(493,new zb(wb))}}Object(b.a)(zb,"NameManagerCommandHandlerFactory",
d.a,[]);var ic=a(1172),Qb=a(1171);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");
Type.registerNamespace("_Ewa");Object(c.a)();T.a.Fa(G.ka);T.a.Fa(R.ka);Object(oa.a)();Object(pa.a)();Object(Pa.a)();Object(Z.a)();Object(Ra.a)();Object(Ga.a)();T.a.Fa(Ya.ka);Object(bb.a)();Object(mb.a)();Object(Ca.a)();(()=>{T.a.Fa(wb=>{Va.ka(wb)})})();Object(Sa.a)();Object(va.a)();Object(db.a)();Object(Xa.a)();Object(gb.a)();Object(Ha.a)();Object(tb.a)();Object(bc.a)();Object(tc.a)();Object(Qb.a)();Object(Ma.a)();Object(ic.a)();(()=>{T.a.Fa(wb=>{zb.ka(wb)})})();(()=>{T.a.Fa(wb=>{nb.ka(wb)})})()},
714:function(t,C,a){a.d(C,"a",function(){return G});t=a(0);var c=a(7),b=a(15),d=a(560),f=a(86),e=a(557),k=a(372),l=a(586),m=a(565),v=a(110),n=a(262),w=a(82),r=a(412),u=a(1389);C=a(78);var y=a(19),x=a(5),B=a(833),z=a(77),A=a(43),I=a(59),F=a(145),U=a(113),X=a(1),S=a(11),H=a(22),D=a(14),J=a(21),M=a(34);class G extends C.a{constructor(T,K,L,V,W,da,qa,O,ea,R,oa,pa){super();this.Rjc=!1;this.JEc=this.zHc=this.contextMenuController=null;this.Vmd=!1;this.Zsc=this.Lrb=null;this.MC=()=>{this.contextMenuController?
this.contextMenuController.MC():b.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");this.ebg()};this.jb=T;this.ipf=W;this.EOc=R;this.CGf=da;this.populateOnlyOnce=qa;this.Y3h=oa;this.nNf(pa)}get contextMenuRoot(){return this.Zsc}get $(){return this.jb}get Sa(){return this.EOc}get menuId(){return this.$.Bb+this.ipf}get Ktb(){this.zHc||(this.zHc=U.a(this.$));return this.zHc}get dpb(){this.JEc||(this.JEc=
J.g(this.$).Xb);return this.JEc}Nc(T,K){T=!0;switch(K){case 1651433993:case 1675506831:case 966232027:T=this.Ud(4096)||this.Ud(2048);break;case 2045563128:T=this.Ud(4096);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:T=this.Ud(8192)}return!T}Rc(T,K,L){L.IsShadowMenuOpen||B.h(this.$,B.d);T=!1;K===this.Bw&&(L.IsShadowMenuOpen||B.h(this.$,B.a),K=Object(c.a)(new d.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.RCd(K,L.IsShadowMenuOpen),L.MenuItems=K,
L.IsShadowMenuOpen||B.h(this.$,B.c),T=!0);T&&this.Rjc&&S.HelperMethods.L_b&&!L.IsShadowMenuOpen&&B.j(this.$);return T}RCd(T,K){(K=this.hY(K))?(this.a8e(K),T.MenuSectionList.push(...K.rE().MenuSectionList),this.MBg(T)):b.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")}hY(){b.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");
return null}b0(T,K,L,V,W){T=Sys.UI.DomElement.getBounds(K);K=new Sys.UI.Point(T.x,T.y+T.height);this.$.isChromeRtl&&(K.x+=T.width);this.Bp(K,W)}Bp(T,K,L=0){K&&(T=M.a(this.$).gja(T));K=!0;if(this.Y3h){let V;3===L?(V=this.DJa(3))&&0<V.length?(K=!1,this.showFloatie(V,new Sys.UI.Bounds(T.x,T.y,0,0),L)):b.ULS.sendTraceTag(537167075,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: ${this.menuId}`):2===L&&this.$.isEditMode&&
((V=this.DJa(2))&&0<V.length?V[0]!==G.GSe?(K=!1,this.XQd(V,new Sys.UI.Bounds(T.x,T.y,0,0),L)):b.ULS.sendTraceTag(537167074,0,50,`ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: ${this.menuId}`):b.ULS.sendTraceTag(537167073,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: ${this.menuId}`))}K&&this.showContextMenu(new Sys.UI.Bounds(T.x,T.y,0,0),L)}DJa(){return null}Ked(T,
K=null){let L="";3===T?L="touch":2===T&&(L="mouse");return{["ContextMenuId"]:this.menuId,["IsEditMode"]:this.$.isEditMode,["IsSLR"]:!!I.a.tg&&I.a.tg.pK,["IsReactMLR"]:!!I.a.tg&&I.a.tg.YU,["IsNov"]:this.$.ea.isNamedObjectViewMode,["InputType"]:L,["FloatieGroups"]:JSON.stringify(K)}}showContextMenu(T,K=0){const L=this.Ked(K);b.ULS.sendTraceTag(595359709,0,50,`ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: ${JSON.stringify(L)}`);this.contextMenuController?this.wB!==x.a.HFd&&
this.wB!==x.a.IFd||0===K?this.contextMenuController.WQd(this.wB,T,z.a.Eb):this.contextMenuController.WQd(this.wB,T,K):b.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")}showFloatie(T,K,L){const V=this.Ked(L,T);b.ULS.sendTraceTag(595359710,0,50,`ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: ${JSON.stringify(V)}`);this.contextMenuController?(X.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&
this.uNf(),this.contextMenuController.Bwc(T,K,L)):(T=JSON.stringify(T),b.ULS.sendTraceTag(537167071,0,10,`ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups ${T}.`))}XQd(T,K,L){var V=this.Ked(L,T);V=JSON.stringify(V);b.ULS.sendTraceTag(537167070,0,50,`ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: ${V}`);this.contextMenuController?(X.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&
this.uNf(),this.contextMenuController.VQd(T,K,L,this.wB)):b.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")}nNf(T){this.contextMenuController=T}dispose(){this.$&&this.$.Ka.Iab(this);this.jb=null;X.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.ebg();this.Zsc&&(f.a.Ia(this.Zsc),this.Zsc=null);super.dispose()}pEh(T){var K=this.$.da.za(204);
K&&(K=K.XEh(this.ipf))&&T.nc.push(K)}Ud(T){return(new F.a(this.$.xa)).Ud(T)}a8e(T){for(const K of T.nc)if(Object(r.a)(431,K)){T=K;T.title&&(T.title=G.Ah(T.title));for(const L of T.buttons)Object(r.a)(432,L)?(T=L,T.label=G.Ah(T.label),T.FR(G.Ah(T.alt))):Object(r.a)(433,L)&&this.a8e(L.menu)}}fpf(T,K=!1){const L=[];for(const V of T)L.push(this.JT(V,K));return L}JT(T){const K=[];for(const L of T.MenuItems)switch(L.Type){case 3:K.push(this.s4g(L));break;case 2:K.push(this.b$g(L));break;case 1:K.push(this.P5g(L))}return Object(c.a)(new e.a,
{ControlList:K,Title:T.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})}lbd(T,K){K=[this.Lrb,T.RibbonCommand.toString(),K?this.yYe(K):this.yYe(T.Label),T.Disabled?T.Disabled.toString():"False"];let L=T.CommandData;L=H.a.hashCode(L).toString();K.push(L,T.Identifier.toString());K=K.join("_");T.IsChecked&&(K+="_Checked");return K}YEh(T){const K=[this.Lrb,H.a.hashCode(T.Title).toString()];for(const L of T.MenuItems)K.push(L.RibbonCommand.toString());
return K.join("_")}xUe(T){var K=T.Label;K=H.a.hashCode(K).toString();K=[this.Lrb,K];X.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&T.Id&&K.push(H.a.hashCode(T.Id).toString());K=K.join("_");T.IsChecked&&(K+="_Checked");return K}s4g(T){let K,L,V;({label:L,QKa:V,tr:K}=this.x9b(T,!1));const W=this.lbd(T,L);return Object(c.a)(new k.a,{Command:T.Disabled?(-251203935).toString():K.toString(),ExternalId:W,Id:W,Image16by16Class:V,LabelText:L||T.Label,MenuItemId:T.CommandData,
CommandValueId:T.CommandData})}b$g(T){let K,L,V;({label:L,QKa:V,tr:K}=this.x9b(T,T.IsChecked));const W=this.lbd(T,L);return Object(c.a)(new l.a,{Command:T.Disabled?(-251203935).toString():K.toString(),ExternalId:W,Id:W,Image16by16Class:V,LabelText:L||T.Label,MenuItemId:T.CommandData,CommandValueId:T.CommandData,IsChecked:T.IsChecked})}P5g(T){let K;var L;({label:K,QKa:L}=this.HUe(T));const V=Object(c.a)(new d.a,{MenuSectionList:[],UpdateDynamically:!0});V.MenuSectionList.push(...this.fpf(T.SubMenu.Sections,
!0));const W=this.xUe(T);T=K||T.Label;return Object(c.a)(new m.a,{ExternalId:W,Id:W,LabelText:T,PopulateOnlyOnce:!1,Menu:V,Image16by16Class:L,ImageIsVisible:!!L})}HUe(T){let K,L;({label:T,QKa:K,tr:L}=this.x9b(T,!0));return{label:T,QKa:K,tr:L}}x9b(T,K){let L;switch(T.Identifier){case 26:L=912804500;K=y.a.QOe;T=D.a.instance.ga(1948);break;case 3:L=-1902148570;K=K?y.a.G$:null;T=D.a.instance.ga(1908);break;case 4:L=-1902148570;K=K?y.a.G$:null;T=D.a.instance.ga(1909);break;case 5:L=-1902148570;K=K?y.a.G$:
null;T=null;break;case 1:L=-1677817820;K=y.a.p7b;T=D.a.instance.ga(235);break;case 2:L=-1649376918;K=T.IsChecked?y.a.Sta:null;T=D.a.instance.ga(2121);break;case 23:L=1701016594;K=T.IsChecked?y.a.Sta:null;T=D.a.instance.ga(2121);break;case 6:L=-87741481;K=null;T=D.a.instance.ga(2122);break;case 7:L=1948650742;K=y.a.BNe;T=D.a.instance.ga(1946);break;case 8:L=1933713114;K=y.a.ANe;T=D.a.instance.ga(1947);break;case 14:L=504133448;K=y.a.uIa;T=D.a.instance.ga(145);break;case 30:L=504133448;K=y.a.uIa;T=
D.a.instance.ga(149);break;case 32:L=504133448;K=y.a.uIa;T=D.a.instance.ga(151);break;case 34:L=504133448;K=y.a.uIa;T=D.a.instance.ga(153);break;case 27:L=1701016594;K=K?y.a.r7b:y.a.uIa;T=D.a.instance.ga(145);break;case 15:L=-798968736;K=y.a.vIa;T=D.a.instance.ga(147);break;case 31:L=-798968736;K=y.a.vIa;T=D.a.instance.ga(150);break;case 33:L=-798968736;K=y.a.vIa;T=D.a.instance.ga(152);break;case 35:L=-798968736;K=y.a.vIa;T=D.a.instance.ga(154);break;case 28:L=1701016594;K=K?y.a.s7b:y.a.vIa;T=D.a.instance.ga(147);
break;case 21:L=-2058042992;K=y.a.T1a;T=null;break;case 29:L=1701016594;K=y.a.T1a;T=null;break;case 9:L=1701016594;T=K=null;break;case 11:L=-1494291901;T=K=null;break;case 25:L=-1045020714;K=T.IsChecked?y.a.Sta:null;T=null;break;case 13:L=1701016594;K=T.IsChecked?y.a.Sta:null;T=D.a.instance.ga(156);break;case 16:L=1701016594;K=y.a.h7b;T=D.a.instance.ga(1080);break;case 17:L=1701016594;K=y.a.S1a;T=null;break;case 18:L=1701016594;K=y.a.R1a;T=null;break;case 19:L=1701016594;K=y.a.i7b;T=D.a.instance.ga(1085);
break;case 20:L=1701016594;K=y.a.p8c;T=D.a.instance.ga(1086);break;case 24:L=1675506831;T=K=null;break;case 22:L=T.RibbonCommand;K=T.IsChecked?y.a.G$:null;T=null;break;case 36:L=1461300262;K=null;T=D.a.instance.ga(155);break;case 38:L=T.RibbonCommand;K=y.a.LOe;T=D.a.instance.ga(1819);break;default:b.ULS.shipAssertTag(537167069,0,!1,`Unable to map menu item: ${JSON.stringify(T)}`),L=1461300262,T=K=null}return{label:T,QKa:K,tr:L}}yYe(T){return H.a.hashCode(T+S.HelperMethods.Jnj).toString()}MBg(T){if(!this.$.ea.amIAlone){var K=
this.$.da.za(25);if((void 0!==K&&null!==K||!X.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!v.a.isEmpty(K.qBa)&&(K=K.NZh(),!n.a.Dh(K))){var L=[];w.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").s8g(K,L);T.MenuSectionList.push(...L)}}}uNf(){this.Vmd||(this.Ktb&&this.Ktb.nYb(this.MC),this.dpb&&this.dpb.nYb(this.MC),this.Vmd=!!this.Ktb||!!this.dpb)}ebg(){this.Ktb&&this.Ktb.Arc(this.MC);this.dpb&&this.dpb.Arc(this.MC);this.Vmd=!1}static Zld(T,K){K=A.C(K);
T=J.g(T).Ea.OJa(K);return!(null===T||void 0===T||!T.Dk)}static mcd(T,K,L){K=A.C(K);var V=J.g(T).Ea.OJa(K);K=J.g(T).getCellBounds(V);const W=V.AMg;V=V.zMg;let da=K.x+W.x;K=K.y+W.y;L&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(J.g(T).rtl||(da+=V),K-=V);return new Sys.UI.Point(da,K)}static iwh(T){try{Object(u.a)(T.CommandValueId)}catch(K){}}static Ah(T){const K=G.e1a.parseFromString(T,"text/html");return K?K.body.innerText:(b.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),
T)}}G.e1a=new DOMParser;G.GSe="Unsupported";Object(t.a)(G,"ContextMenuBase",C.a,[195,434,2])},770:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.sLe="ewa-ac";c.Jlh="ewa-ac-param";c.jMe="ewa-function-help-link";c.i8c="ewa-lb";c.dMe="ewa-fb-refactor";c.listItem="list-item";c.fBb="list-item-selected";c.jBb="list-table-touch";c.iBb="list-table";c.wrh="ewa-suggested-cell-name";c.pZg="columnName-header";c.eNe="ewa-tt";c.Koh="ewa-function-link-container";c.kMe="ewa-function-udf-name";
c.rtl="rtl";Object(t.a)(c,"CssClassNames",null,[])},804:function(t,C,a){a.r(C);t=a(0);var c=a(15),b=a(811),d=a(722),f=a(5),e=a(77),k=a(54),l=a(197),m=a(35),v=a(1),n=a(14);class w{constructor(K,L,V,W,da,qa,O,ea){this.klg=K;this.llg=L;this.jlg=V;this.Wfa=W;this.nwg=da;this.Csg=qa;this.Qib=O;this.Crg=ea}get Zse(){return this.klg}get C_b(){return this.llg}get Yse(){return this.jlg}get width(){return this.Wfa}get EFj(){return this.nwg}get aEi(){return this.Csg}get lineHeight(){return this.Qib}get qri(){return this.Crg}static tPg(){return new w("BorderStyleSolidLine",
1960,1,"1","",1,8,0)}static pPg(){return new w("BorderStyleDashedLine",1961,3,"1","5,3",1,8,0)}static qPg(){return new w("BorderStyleDottedLine",1962,4,"1","1,1",1,8,0)}static sPg(){return new w("BorderStyleMediumLine",1963,2,"2","",1,8,0)}static uPg(){return new w("BorderStyleThickLine",1964,5,"3","",1,8,0)}static rPg(){return new w("BorderStyleDoubleLine",1965,6,"1","",2,8,3)}}Object(t.a)(w,"BorderLineStyleProperties",null,[]);class r{constructor(){this.iconName=this.title=this.key=null}}Object(t.a)(r,
"BorderLineStyleProps",null,[]);class u{constructor(K){K.ENf()}getBorderLineStyleProps(){const K=a(804).BorderFormatManager.vZa,L=Array(Object.keys(K).length);let V=0;for(let qa in K){var W=qa,da=K[qa];L[V]=new r;L[V].key=W;W=da;L[V].title=n.a.instance.ga(W.C_b);L[V].iconName=W.Zse;V++}return L}}Object(t.a)(u,"BorderMenuController",null,[304]);var y=a(262),x=a(85),B=a(236),z=a(13),A=a(108),I=a(24),F=a(47),U=a(45),X=a(209),S=a(11),H=a(97),D=a(21),J=a(34),M=a(43);class G{constructor(K,L){this.dGb=this.ribbonCommandInfo=
this.cellFormat=this.Jr=this.lb=this.ha=null;this.Eqc=!1;this.XHf=this.dLa=this.cEd=this.S6d=this.Mya=this.Xla=null;this.E_b=this.zta=this.dIf=0;this.borderStyle=this.wZa=this.borderColor=null;this.gB=!1;this.z0a=this.H$a=null;this.D_=()=>{if(!this.gB||D.g(this.$).oz)this.gB=!1,D.g(this.$).oz=!1,this.zta=0,D.g(this.$).Df.Wl(f.a.jQ),1===this.$.Ka.qH()&&(D.g(this.$).WY(v.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?M.d(this.cEd):y.a.clone(this.cEd),this.dIf,this.$.pa?this.$.pa.sheetName:
null,null,this.XHf.clone(),null,null,0,H.a.whh,!0),D.g(this.$).QRa(!0)),this.Cv(),this.RWd(),this.ek(),this.Eqc=!1,this.Mya=this.Xla=null,this.Jr&&(this.Jr.cancel(),this.Jr.dispose()),c.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=V=>{try{if(V=this.Td(V),D.g(this.$).oz=!0,this.Xla={},this.Mya={},this.H$a=null,this.sob(this.E_b),2===V.tb){const W=D.g(this.$).ha.Vn(V.clientPoint,V.Cb,5,void 0,void 0,!1);W&&(this.z0a=this.dLa=W,this.j7i())}}catch(W){D.g(this.$).oz=
!1}return!0};this.Hh=V=>{try{V=this.Td(V);const W=D.g(this.$).ha.Vn(V.clientPoint,V.Cb,5,void 0,void 0,!1),da=D.g(this.$).Ea.Sr(W);if(!this.dGb||da&&(da.rQ!==this.dGb.rQ||da.qQ!==this.dGb.qQ))if(this.gB=!0,this.dGb=da,W){let qa=new I.Range(this.dLa.top,this.dLa.left,this.dLa.top,this.dLa.left,!0,!1);qa.union(W);qa=D.g(this.$).ha.bUh(qa);this.J_b(W);this.bTf(this.H$a,qa);if(this.bottomRightCorner(qa.bottom,qa.right))return c.ULS.sendTraceTag(537159515,0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),
!1;const O=new I.Range(qa.top,qa.left,qa.bottom+1,qa.right+1,!0,!1),ea=D.g(this.$).i$("DrawBorderBehavior.OnPointerMove",[O]);if(this.Xla&&this.Mya)for(;ea.$$mn();){const R=ea.$$cu(),oa=R.cell.getRange().toString();oa in this.Xla&&1!==this.zta||(this.Xla[oa]=R,this.Mya[oa]=R.cell.FM())}this.H$a=O;this.z0a=qa;D.g(this.$).WY([qa],0,this.$.pa.sheetName,null,qa.topLeft,null,null,0,H.a.thh,!0);this.ug.wda(D.g(this.$),-1690267012,this.cellFormat,!0,null,[qa])}return!0}catch(W){return D.g(this.$).oz=!1}};
this.Kf=V=>{V=this.Td(V);(V=D.g(this.$).ha.Vn(V.clientPoint,V.Cb,5,void 0,void 0,!1))?this.gB&&(this.J_b(V),this.dLa.union(V),3===this.zta?this.sob(0):this.sob(this.E_b),D.g(this.$).WY([this.dLa],0,this.$.pa.sheetName,null,null,null,null,0,H.a.uhh,!0),this.ug.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo)):(3===this.zta?this.sob(0):this.sob(this.E_b),D.g(this.$).WY([this.z0a],0,this.$.pa.sheetName,null,null,null,null,0,H.a.vhh,!0),this.ug.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo));
this.gB=!1;this.RWd();this.Mya=this.Xla=null;return!0};this.onKeyDown=V=>{V=this.Td(V);if(this.gB||[17,16,18,20].includes(V.Ca.keyCode))return!0;this.D_();return!1};this.onKeyUp=V=>{V=this.Td(V);if(V.Ca.keyCode===x.a.uL&&this.gB)return this.gB=!1,this.bTf(this.H$a,this.z0a,!0),this.RWd(),!0;if(this.gB||V.Ca.keyCode===x.a.r7||V.Ca.keyCode===x.a.W_d||V.Ca.keyCode===x.a.V_d||[17,16,18,20,37,39,38,40,33,34,9,13].includes(V.Ca.keyCode)||V.Ca.keyCode===x.a.Jjg||V.Ca.keyCode===x.a.Fjg||V.Ca.keyCode===x.a.Bjg)return!0;
this.D_();return!1};this.YQ=(V,W)=>{D.g(this.$).oz&&!this.$6h.includes(W.Jd.command)&&(V=JSON.stringify(W.Jd),c.ULS.sendTraceTag(537159512,0,50,`DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : ${V} `),this.D_())};this.$=K;this.ug=L}get $6h(){return this.S6d||(this.S6d=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}Tyg(K){c.ULS.sendTraceTag(537159517,
0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ha=D.g(this.$).ha;this.lb=D.g(this.$).lb;this.ribbonCommandInfo=K;this.cEd=v.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?M.d(this.ha.sa.selectedRanges):y.a.clone(this.ha.sa.selectedRanges);this.dIf=this.ha.sa.Xr;this.XHf=this.ha.sa.activeCell.clone();this.lb&&this.lb.pid();this.rv();this.Bj()}dispose(){this.D_();this.dGb=this.ribbonCommandInfo=this.cellFormat=null}sob(K){var {BorderFormatManager:L}=
a(804);this.cellFormat={};const V={};this.borderColor=this.borderColor||L.B4c;var W=l.a.mH(this.borderColor,!1);V.Color=[W,W,W,W];v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.wZa&&(V.ThemeBorderColor=[this.wZa,this.wZa,this.wZa,this.wZa],V.ColorTypeOption=1);W=a(804).BorderFormatManager.vZa;this.borderStyle=this.borderStyle||L.borderStyleSolidLine;L=W[this.borderStyle].Yse;V.LineStyle=[L,L,L,L];this.cellFormat.BorderFormat=V;this.cellFormat.ValidMembers=128;this.cellFormat.Border=
K}rv(){for(const K of D.g(this.$).tn)B.a.instance.ra(z.a.pointerDown,K.domElement,this.onPointerDown);A.KeyInputManager.instance.ra(z.a.Kb,document.documentElement,this.onKeyDown);A.KeyInputManager.instance.ra(z.a.Fd,document.documentElement,this.onKeyUp)}j7i(){for(const K of D.g(this.$).tn)B.a.instance.ra(z.a.zj,K.domElement,this.Hh),B.a.instance.ra(z.a.Mf,K.domElement,this.Kf);B.a.instance.ra(z.a.Mf,document.documentElement,this.Kf);B.a.instance.ra(z.a.ky,document.documentElement,this.Kf);this.Eqc=
!0}Cv(){try{for(const K of D.g(this.$).tn)B.a.instance.Ba(z.a.pointerDown,K.domElement,this.onPointerDown);A.KeyInputManager.instance.Ba(z.a.Kb,document.documentElement,this.onKeyDown);A.KeyInputManager.instance.Ba(z.a.Fd,document.documentElement,this.onKeyUp)}catch(K){D.g(this.$).oz=!1,c.ULS.sendTraceTag(537159514,0,10,`DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception ${K}`)}}RWd(){if(this.Eqc)try{this.Eqc=!1;for(const K of D.g(this.$).tn)B.a.instance.Ba(z.a.zj,
K.domElement,this.Hh),B.a.instance.Ba(z.a.Mf,K.domElement,this.Kf);B.a.instance.Ba(z.a.Mf,document.documentElement,this.Kf);B.a.instance.Ba(z.a.ky,document.documentElement,this.Kf)}catch(K){D.g(this.$).oz=!1,c.ULS.sendTraceTag(537159513,0,10,`DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception ${K}`)}}Bj(){this.$.xa.Pf(this.D_);D.g(this.$).Xb.Nk(this.D_);D.g(this.$).hC(this.D_);this.$.Ka.fFa(this.YQ)}ek(){this.$.xa.zg(this.D_);D.g(this.$).Xb.tk(this.D_);D.g(this.$).AD(this.D_);
this.$.Ka.mza(this.YQ)}bTf(K,L,V=!1){if(K&&this.Xla&&this.Mya)for(K=D.g(this.$).i$("DrawBorderBehavior.ApplyBordersOnPreviewCells",[K]);K.$$mn();){var W=K.$$cu().cell.getRange();if(V||!L.contains(W)||1===this.zta){W=W.toString();const da=m.a.Dc(this.Xla,W);if(da){const qa=m.a.Dc(this.Mya,W);this.setBorders(da,qa);delete this.Xla[W];delete this.Mya[W]}}}}setBorders(K,L){var V=K.cell;const W=V.getRange();V.Hab();W.right!==this.H$a.right&&(V=new I.Range(W.top,W.left-1,W.bottom,W.left-1,!0,!1),D.g(this.$).Ea.Sr(V).JPa(3));
W.bottom!==this.H$a.bottom&&(V=new I.Range(W.top-1,W.left,W.top-1,W.right,!0,!1),D.g(this.$).Ea.Sr(V).JPa(1));if(null===L||void 0===L?0:L.Borders.length){V={};let O=0;const ea=Array(4),R=Array(4);for(var da=0;4>da;da++)ea[da]=1,R[da]=0;for(var qa of L.Borders)L=qa.BorderPosition,ea[L]=qa.BorderLineStyle,da=new X.a(qa.Color.Red,qa.Color.Green,qa.Color.Blue),R[L]=da.VR(),O|=S.HelperMethods.a3a(qa.BorderPosition);V.LineStyle=ea;V.Color=R;qa={};qa.BorderFormat=V;qa.Border=O;this.ug.Erj(K,qa,W)}}J_b(K){const L=
new I.Range(Math.max(1,K.top-1),Math.max(1,K.left-1),K.bottom+1,K.right+1,!1,!1);D.g(this.$).nK(L)||this.Jr&&this.Jr.Bq||(this.Jr=F.a.instance.create(()=>{D.g(this.$).dt(L,60,H.a.rhh)},40,U.a.shh))}bottomRightCorner(K,L){return 1048576<=K||16384<=L?!0:!1}Td(K){return J.a(this.$).Td(K)}}Object(t.a)(G,"DrawBorderBehavior",null,[2]);a.d(C,"BorderFormatManager",function(){return T});class T{constructor(K,L,V){this.KPb=null;this.NF={};this.AQb=this.dx=null;c.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");
this.$=K;this.h3d=T.B4c;this.i3d=T.borderStyleSolidLine;this.ug=L;this.Sa=V;v.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ga(296,this);this.dU=new G(this.$,this.ug);this.dD=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);c.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName 296")}get oHa(){return this.i3d}get C2(){return this.h3d}get Psa(){return this.AQb}get themesManager(){this.dx||
(this.dx=this.$.da.za(422));return this.dx}V3e(K,L){c.ULS.sendTraceTag(537159564,0,50,`HandleBorderCommand : Begin handling, Command being executed: ${L.command.toString()}`);const V={},W={};var da=l.a.mH(this.C2,!1);W.Color=[da,da,da,da];this.dD&&this.Psa&&(W.ThemeBorderColor=[this.Psa,this.Psa,this.Psa,this.Psa],W.ColorTypeOption=1);K=-600086683===L.command?"OutsideBorders":K[e.a.Pc];W.LineStyle=m.a.Dc(T.hHf,K);W.LineStyle?c.ULS.sendTraceTag(537159562,0,50,`RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is ${K}`):
(da=T.vZa[this.oHa].Yse,W.LineStyle=[da,da,da,da],c.ULS.sendTraceTag(537159563,0,50,`RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is ${this.oHa}`));da=m.a.aq(T.rOg,K,0);c.ULS.sendTraceTag(40732555,0,50,`RibbonCommand.Border is using the BorderFormat information, the border type requested is ${K}, the border color selected is ${this.C2}`);V.BorderFormat=W;4!==da&&8!==da||!this.$.pa.displayRtl||(da=4===da?8:4);V.ValidMembers=128;V.Border=da;this.ug.formatCells(-1690267012,
V,L);c.ULS.sendTraceTag(537159561,0,50,`HandleBorderCommand : Successfully handled, Command executed: ${L.command.toString()}`);return!0}Hgd(K,L,V){c.ULS.sendTraceTag(537159560,0,50,`RibbonCommand:${K.toString()} is being executed, the previous border color is ${this.C2}`);if(this.dD){if((L.SqmControlId||"").includes("ThemeColorPicker")){let W,da;({themeIndex:W,KAa:da}=this.themesManager.getThemeColor(L.Color)).returnValue?(this.AQb={},this.Psa.ThemeColorIndex=W,this.Psa.ThemeColorRow=da):this.AQb=
null}else this.AQb=null;this.dU.wZa=this.Psa}this.h3d=-1803452024===K?T.B4c:L.Color;this.dU.borderColor=this.C2;this.KJe(V);this.$.qf();c.ULS.sendTraceTag(40944211,0,50,`RibbonCommand:${K.toString()} is being executed, the updated border color is ${this.C2}`);return!0}u2h(K){c.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");const L=this.Sa.sq();var V=this.Sa.zc();L.nc.push(V);const W=this.Sa.FC("StyleDashGallery",1,"Size120by20");V.buttons.push(W);V=T.vZa;
for(let da in V){const qa=da,O=V[da],ea=n.a.instance.ga(O.C_b);W.Kt(qa,-2118943501,"QueryBorderStyle",O.C_b,qa,qa,void 0,void 0,ea)}c.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");K.MenuItems=L.rE();c.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")}S0h(K,L){c.ULS.sendTraceTag(537159555,0,50,`RibbonCommand.BorderStyle: Begin handling, Current Border Style is ${this.oHa}`);K=K[e.a.Pc];if(T.pni(K))this.i3d=K,c.ULS.sendTraceTag(537159554,0,50,`RibbonCommand.BorderStyle: Updated Border Style is ${this.oHa}`);
else return c.ULS.sendTraceTag(537159553,0,15,`RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : ${K}`),!0;this.dU.borderStyle=this.oHa;this.KJe(L);this.$.qf();c.ULS.sendTraceTag(40944220,0,50,`RibbonCommand.BorderStyle: Successfully handled Current Border Style is ${this.oHa}`);return!0}Lgd(K){c.ULS.sendTraceTag(537159552,0,50,`HandleDrawBorderCommand : Begin handling, Command being executed: ${K.command.toString()}`);this.nSc(K,64,this.C2,110,1);return!0}Mgd(K){c.ULS.sendTraceTag(537159523,
0,50,`HandleDrawBorderGridCommand : Begin handling, Command being executed: ${K.command.toString()}`);this.nSc(K,112,this.C2,111,2);return!0}i4e(K){c.ULS.sendTraceTag(537159522,0,50,`HandleEraseBorderCommand : Begin handling, Command being executed: ${K.command.toString()}`);this.nSc(K,112,"white",112,3);return!0}y2h(K){this.kqj(this.tOg,K,K.MenuItemId?K.MenuItemId:T.borderStyleSolidLine)}kqj(K,L,V){V in K?(K=K[V],c.ULS.sendTraceTag(537159521,0,50,`HandleQueryBorderStyleCommand:SetIcon command ${V}`),
this.mqj(L,K)):c.ULS.sendTraceTag(537159520,0,15,`HandleQueryBorderStyleCommand: cannot find dashes '${V}' in BorderLineStyleButtons dictionary`)}J2h(K,L){const V=K[e.a.Pc];return"DrawBorder"===V?this.Lgd(L):"DrawBorderGrid"===V?this.Mgd(L):"EraseBorder"===V?this.i4e(L):this.V3e(K,L)}ENf(){this.KPb||this.vPg()}fIh(){return new u(this)}get tOg(){this.ENf();return this.KPb}vPg(){this.KPb={};let K=0;const L=T.vZa;for(let V in L){const W=L[V],da=W.Zse;n.a.instance.ga(W.C_b);this.KPb[da]=da;this.Aab(da,
()=>appChrome.buildBorderStyleIconNew(W.EFj,W.width,W.aEi,W.lineHeight,W.qri));K++}}Aab(K,L){if(!(K in this.NF)){const V={};L=L();V[K]=L;appChrome.api.registerIconProvider(()=>V);this.NF[K]=!0}return K}mqj(K,L){K.MenuItemId&&(K[b.a.On]=K.MenuItemId===this.oHa,K[d.a.Icon]=L)}nSc(K,L,V,W,da){c.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.fWg(K,da)?(c.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),
this.dU.D_()):(D.g(this.$).oz&&this.dU.D_(),k.a.current&&(W=String.format(f.a.Vsa,k.a.current.Rn(W)),D.g(this.$).Df.Wl(W)),this.dU.E_b=L,this.dU.borderColor=V,D.g(this.$).oz=!0,this.dU.Tyg(K),this.dU.zta=da)}KJe(K){if(K)switch(this.dU.zta){case 2:this.Mgd(K);break;default:this.Lgd(K)}}fWg(K,L){return this.dU.zta===L&&-236759591!==K.command&&-2118943501!==K.command?!0:!1}static get vZa(){return T.v1d||(T.v1d={["BorderStyleSolidLine"]:w.tPg(),["BorderStyleDashedLine"]:w.pPg(),["BorderStyleDottedLine"]:w.qPg(),
["BorderStyleMediumLine"]:w.sPg(),["BorderStyleThickLine"]:w.uPg(),["BorderStyleDoubleLine"]:w.rPg()})}static get rOg(){return T.u1d||(T.u1d={["NoBorder"]:0,["BottomBorder"]:1,["TopBorder"]:2,["LeftBorder"]:4,["RightBorder"]:8,["OutsideBorders"]:64,["AllBorders"]:112,["ThickOutsideBorders"]:64,["InsideBorders"]:48,["InsideHorizontalBorders"]:16,["InsideVerticalBorders"]:32,["BottomDoubleBorder"]:1,["ThickBottomBorder"]:1,["TopBottomBorder"]:3,["TopThickBottomBorder"]:3,["TopDoubleBottomBorder"]:3})}static get hHf(){return T.Kce||
(T.Kce={["ThickOutsideBorders"]:[2,2,2,2],["BottomDoubleBorder"]:[1,6,1,1],["ThickBottomBorder"]:[1,2,1,1],["TopBottomBorder"]:T.Ubh,["TopThickBottomBorder"]:[1,2,1,1],["TopDoubleBottomBorder"]:[1,6,1,1]})}static pni(K){return K?K in T.hHf||K in T.vZa:!1}}T.u1d=null;T.v1d=null;T.Kce=null;T.B4c="black";T.borderStyleSolidLine="BorderStyleSolidLine";T.Ubh=[1,1,1,1];Object(t.a)(T,"BorderFormatManager",null,[293])},833:function(t,C,a){a.d(C,"i",function(){return"ContextMenuPerf.A"});a.d(C,"b",function(){return"ContextMenuPerf.B"});
a.d(C,"d",function(){return"ContextMenuPerf.C1"});a.d(C,"a",function(){return"ContextMenuPerf.C2"});a.d(C,"c",function(){return"ContextMenuPerf.D"});a.d(C,"e",function(){return m});a.d(C,"f",function(){return w});a.d(C,"g",function(){return r});a.d(C,"h",function(){return u});a.d(C,"j",function(){return y});var c=a(15),b=a(316),d=a(8),f=a(60),e=a(24),k=a(11),l=a(21);const m=(B,z)=>{var A=B.Vb(null);if((null===A||void 0===A?0:A.cell.Dk)&&v(A,B,z))return B.getCellBounds(A.cell);A=B.ha.sa.activeCell;
return(z=n(new e.Range(A.top,A.left,d.a.dh,A.left,!1,!1),2,!0,B,z)||n(new e.Range(1,A.left,A.top,A.left,!1,!1),2,!1,B,z)||n(new e.Range(A.top,A.right,A.top,d.a.mh,!1,!1),1,!0,B,z)||n(new e.Range(A.top,1,A.top,A.right,!1,!1),1,!1,B,z)||null)&&z.Dk?B.getCellBounds(z):Sys.UI.DomElement.getBounds(B.sva.mc)},v=(B,z,A)=>{var I=z.rtl,F=A.isChromeRtl;B=B.cell;return(A=l.g(A).WJ(B))?(A=A.topLeft,I=A.x+=I===F?B.offsetWidth:0,F=A.y+=B.offsetHeight,z.view.visibleArea.contains(new f.a(I,F,0,0))):!1},n=(B,z,A,
I,F)=>{B=I.mk("ContextMenuHelper.FindFirstCellInViewportArea",B,z,A);try{for(B.$$rst();B.$$mn();){const U=B.$$cu();if(U&&v(U,I,F))return U.cell}}finally{B&&B.dispose()}return null},w=B=>B.Db.s4(B.ha.sa.activeCell),r=B=>{B=l.g(B).ha.sa;return B.wg&&(B.Wc.isRow||B.Wc.Ze)},u=(B,z)=>{k.HelperMethods.sXc&&window.performance.mark(z)},y=()=>{if(b.a.oob){const B=x("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),z=x("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),A=x("EWAPopulation",
"ContextMenuPerf.C2","ContextMenuPerf.D");c.ULS.sendTraceTag(537167064,0,50,`ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[${B}], PrepInfraWork=[${z}], EWAPopulation =[${A}]`)}},x=(B,z,A)=>{window.performance.measure(B,z,A);z=window.performance.getEntriesByName(B);z.length||c.ULS.sendTraceTag(537167063,0,10,`ContextMenuHelper.MeasureTime: measure name [${B}] returned no measures.`);return z[z.length-1]?z[z.length-1].duration:-1}},834:function(t,C,a){a.d(C,"a",function(){return c});
t=a(0);class c{}c.edit="Edit";c.clipboard="Clipboard";c.copy="Copy";c.color="Color";c.xMg="AutoFill";c.Xhj="RowOperations";c.qZg="ColumnOperations";c.ZVj="ViewModeRowOperations";c.YVj="ViewModeColumnOperations";c.hyperlink="Hyperlink";c.openHyperlink="OpenHyperlink";c.ouj="ShapeStyle";c.$Ah="FloatingObjectClipboard";c.fGf="PivotTableCopyDelete";c.hGf="PivotTableFieldListActions";c.gwe="CellFloatie";c.kuj="ShapeFloatie";c.contextMenu="ContextMenu";c.c0h="GridContextMenu";c.qXi="PivotTableContextMenu";
c.aBh="FloatingObjectContextMenu";c.mVg="CellRTEFloatie";c.p0f="ShapeRTEFloatie";Object(t.a)(c,"FloatieGroupIdentifiers",null,[])},835:function(t,C,a){a.d(C,"a",function(){return m});t=a(0);var c=a(86),b=a(222),d=a(13),f=a(236);C=a(235);var e=a(12),k=a(71),l=a(21);class m extends C.a{constructor(v,n,w){super(n);this.Eic=this.KQ=!1;this.qn=this._selectedRowListBox=this.VMa=null;this.ayf=r=>this.onItemClick(r);this.Lzd=r=>{k.g(r.Ca);this.raiseEvent(m.d4a);this.raiseEvent(m.pNd);return!0};this.onScroll=
r=>{k.g(r);this.lFd();this.raiseEvent(m.d4a)};this.onBlur=r=>{k.g(r);this.lFd()};this.onPointerDown=()=>{this.lFd();this.raiseEvent(m.d4a);this.raiseEvent(m.UOa);return!1};this.YDb=r=>{const u=r.Ca;if(u.button===Sys.UI.MouseButton.leftButton||u.button===Sys.UI.MouseButton.rightButton||u.type.includes("touch"))this.Ej=this.a$b(u),this.onPointerDown(r);this.raiseEvent(m.Iqd);return!1};this.jb=v;this.eBb=w;this.wAa(!0)}Y8(v){this.get_events().addHandler(m.d4a,v)}Oca(v){this.get_events().removeHandler(m.d4a,
v)}lYb(v){this.get_events().addHandler(m.mjd,v)}yrc(v){this.get_events().removeHandler(m.mjd,v)}Mmb(v){this.get_events().addHandler(m.pNd,v)}THb(v){this.get_events().removeHandler(m.pNd,v)}Kmb(v){this.get_events().addHandler(m.UOa,v)}QHb(v){this.get_events().removeHandler(m.UOa,v)}XTc(v){this.get_events().addHandler(m.Iqd,v)}uId(v){this.get_events().removeHandler(m.Iqd,v)}get Ej(){return this._selectedRowListBox}set Ej(v){this.OAa(this._selectedRowListBox);v?(this._selectedRowListBox=v,this.OAa(this._selectedRowListBox),
this.Ktc(v)):this._selectedRowListBox=null}get IZ(){return this.eBb.ListCellClass}get zba(){return this.eBb.ListTableClass}get $H(){return 8}get aCb(){return 5}get Dic(){return 24}get Cic(){return 35}get gg(){return this.domElement}get $(){return this.jb}dispose(){this.X6(!1);this.wAa(!1);c.a.qc([this.VMa]);this.VMa=null;super.dispose()}a$b(v){return e.DOMElementExtensions.Zcd(v.target,"tr",!0)}lB(v){if(v){if(!this.Ej){var n=this.qn;if(!n||!n.rows.length)return;this.Ej=n.rows[0];0<v?v--:v++}n=this.Ej;
for(let w=0,r=Math.abs(v);w<r;w++)if(0>v){if(!n.previousSibling)break;n=n.previousSibling}else{if(!n.nextSibling)break;n=n.nextSibling}n&&(this.Ej=n)}}smb(v,n){e.DOMElementExtensions.toggleCssClass(v,this.eBb.ListTableClassInTouch,n)}X6(v){const n=this.qn;n&&(v&&!this.Eic?(b.a.instance.ra(d.a.click,n,this.ayf),b.a.instance.ra(d.a.qk,n,this.Lzd),f.a.instance.ra(d.a.pointerDown,n,this.YDb),this.Eic=!0):this.Eic&&(b.a.instance.Ba(d.a.click,n,this.ayf),b.a.instance.Ba(d.a.qk,n,this.Lzd),f.a.instance.Ba(d.a.pointerDown,
n,this.YDb),this.Eic=!1))}OAa(v){let n=null;v&&(n=e.DOMElementExtensions.Kj(v,this.eBb.ListCellClass))&&n.classList.toggle(this.eBb.ListCellSelectedClass);return n}wAa(v){this.gg&&(v&&!this.KQ?(this.VMa=this.ue.Zd(this.gg),this.VMa.ka("scroll",this.onScroll),this.VMa.ka("blur",this.onBlur),f.a.instance.ra(d.a.pointerDown,this.domElement,this.onPointerDown),this.KQ=!0):this.KQ&&(c.a.Ia(this.VMa),this.VMa=null,f.a.instance.Ba(d.a.pointerDown,this.domElement,this.onPointerDown),this.KQ=!1))}onItemClick(v){return this.Lzd(v)}Ktc(v){if(v){var n=
v.offsetTop,w=this.gg.scrollTop;n<w?this.WVf(!0):n+v.offsetHeight>w+this.gg.clientHeight&&this.WVf(!1)}}WVf(v){this.gg.scrollTop=v?this.Ej.offsetTop:this.Ej.offsetTop+this.Ej.offsetHeight-this.gg.clientHeight}lFd(){l.g(this.$).eb&&this.raiseEvent(m.mjd)}}m.d4a="GotFocus";m.mjd="IgnoreBlur";m.pNd="SetCell";m.UOa="PointerDown";m.Iqd="ItemPointerDown";Object(t.a)(m,"ListBox",C.a,[452,2])},905:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);var c=a(22);class b{compare(d,f){return c.a.compare(d,
f,!0)}}Object(t.a)(b,"IgnoreCaseComparer",null,[480])},906:function(t,C,a){a.d(C,"a",function(){return f});t=a(0);var c=a(24),b=a(11),d=a(200);class f{constructor(e,k){this.Ea=e;this.d2a=k}UJb(e,k,l){const m=k.Border;k=k.BorderFormat;let v=0,n=!1;if(0===m)e.cell.Hab(),this.oHb(e.cell.getRange());else{for(let w=0;3>=w;w++)f.yvj(e,l,w,m)&&(v|=b.HelperMethods.a3a(w),this.lXd(e.cell.getRange(),w,k),n=!0);b.HelperMethods.AQ(m,16)&&!d.c(e,0,l)&&(v|=2,this.lXd(e.cell.getRange(),0,k),n=!0);b.HelperMethods.AQ(m,
32)&&!d.c(e,2,l)&&(v|=4,this.lXd(e.cell.getRange(),2,k),n=!0);n&&(l=e.cell.Sx.rf,b.HelperMethods.AQ(v,2)&&this.C1f(e,l,0)&&(v&=-3),b.HelperMethods.AQ(v,1)&&this.B1f(e,l,1)&&(v&=-2),b.HelperMethods.AQ(v,4)&&this.C1f(e,l,2)&&(v&=-5),b.HelperMethods.AQ(v,8)&&this.B1f(e,l,3)&&(v&=-9),e.cell.setBorders(k,v,!1))}}dQ(e,k){e=f.eVe(e,k);return e.xz?(e=this.Ea.Nia(e))&&e.length?e:null:null}oHb(e){for(let l=0;3>=l;l++){var k=f.eVe(e,l);if(!k.xz)continue;k=this.Ea.Nia(k);if(!k||!k.length)continue;const m=f.v_e(l);
for(let v=0;v<k.length;v++)k[v].JPa(m)}}lXd(e,k,l){if(e=this.dQ(e,k)){var m=f.v_e(k),v=b.HelperMethods.a3a(m);for(let n=0;n<e.length;n++){const w=e[n];this.eei(w,m)&&f.setBorders(w,l,v,k,m)}}}eei(e,k){const l=e.Sx.rf;var m=e.getRange();m=this.dQ(m,k);let v=!1,n=!1,w=!1,r=!1;m&&(v=f.b6a(m,!0),n=f.b6a(m,!1),r=f.Rnd(m),w=1===m.length?!0:!1);switch(k){case 0:return f.vdi(e,l,r,n,w);case 1:return f.sdi(e,l,r,v,w);case 2:return f.tdi(e,l,r,v,w);case 3:return f.udi(e,l,r,n,w)}return!1}C1f(e,k,l){if(!e.cell.tF)return!1;
const m=e.range,v=this.dQ(m,l),n=d.c(e,l,k);let w=!1;k=0===l?m.top<k.top:m.left<k.left;!f.Uyb(e.cell)&&v&&1!==v.length&&(w=(0===l?f.b6a(v,!0):f.b6a(v,!1))?!1:!0);return!n&&w||k?!0:!1}B1f(e,k,l){const m=e.cell,v=this.dQ(m.getRange(),l);e=d.c(e,l,k);k=!1;if(v){const w=f.b6a(v,!0);var n=f.b6a(v,!1);const r=w&&!n;n=n&&!w;1!==l||f.Tzb(m)?3!==l||f.Jyb(m)||f.Fvj(m,v,n,r)&&(k=!0):f.Evj(m,v,w,n)&&(k=!0)}return!e&&k||f.Uyb(m)?!0:!1}static oPg(e,k,l){const m={};m.LineStyle=Array(4);m.LineStyle[l]=e.LineStyle[k];
m.Color=Array(4);m.Color[l]=e.Color[k];return m}static Jaf(e,k,l,m,v){return b.HelperMethods.AQ(e,v)&&d.c(k,l,m)}static yvj(e,k,l,m){return f.Jaf(m,e,l,k,b.HelperMethods.a3a(l))||f.Jaf(m,e,l,k,64)||112===m}static setBorders(e,k,l,m,v){k=f.oPg(k,m,v);e.setBorders(k,l,!1)}static eVe(e,k){switch(k){case 0:return new c.Range(e.top-1,e.left,e.top-1,e.right,!1,!1);case 2:return new c.Range(e.top,e.left-1,e.bottom,e.left-1,!1,!1);case 1:return new c.Range(e.bottom+1,e.left,e.bottom+1,e.right,!1,!1);case 3:return new c.Range(e.top,
e.right+1,e.bottom,e.right+1,!1,!1)}return e}static v_e(e){switch(e){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}}static b6a(e,k){for(let l=0;l<e.length;l++){const m=e[l];if(m.tF)return k?f.Jyb(m):f.Tzb(m)}return!1}static Uyb(e){const k=e.Sx.rf,l=e.getRange();return e.tF&&(l.top<k.top||l.bottom>k.bottom||l.left<k.left||l.right>k.right)?!0:!1}static Rnd(e){for(let k=0;k<e.length;k++)if(f.Uyb(e[k]))return!0;return!1}static Evj(e,k,l,m){if(!e.tF){if(!l||f.Rnd(k))return!0}else if(f.Jyb(e)&&
(1===k.length&&f.CKg(e,k[0])||!l))return!0;return m}static Fvj(e,k,l,m){if(!e.tF){if(!l||f.Rnd(k))return!0}else if(f.Tzb(e)&&(1===k.length&&f.DKg(e,k[0])||!l))return!0;return e.oka||m}static vdi(e,k,l,m,v){const n=e.getRange();return f.Jyb(e)?f.Uyb(e)||v:k.top===n.top||!m||l}static sdi(e,k,l,m,v){const n=e.getRange();return f.Jyb(e)?k.bottom===n.bottom&&v:m&&!l||k.bottom===n.bottom}static tdi(e,k,l,m,v){const n=e.getRange();return f.Tzb(e)?f.Uyb(e)||v:k.left===n.left||!m||l}static udi(e,k,l,m,v){const n=
e.getRange();return e.oka?!1:f.Tzb(e)?k.right===n.right&&v:m&&!l||k.right===n.right}static Jyb(e){return 0<e.getRange().right-e.getRange().left}static Tzb(e){return 0<e.getRange().bottom-e.getRange().top}static DKg(e,k){e=e.getRange();k=k.getRange();return e.top===k.top&&e.bottom===k.bottom}static CKg(e,k){e=e.getRange();k=k.getRange();return e.left===k.left&&e.right===k.right}}Object(t.a)(f,"BorderModelAccessorHelper",null,[])},908:function(t,C,a){a.d(C,"a",function(){return e});t=a(0);var c=a(86);
C=a(93);var b=a(47),d=a(45),f=a(71);class e extends C.a{constructor(k,l){super(l.textBox.domElement);this.qWc=null;this.AFi=()=>{this.jyd()};this.Uvf=(m,v)=>{this.Jf(m,v)};this.Yvf=(m,v)=>{this.nh(m,v)};this.jb=k;this.VI=l;l.U1&&(l.U1.add(this),l.Nk(this.Yvf),l.em(this.Uvf))}get $(){return this.jb}get Ya(){return this.VI}dispose(){const k=this.VI;if(null===k||void 0===k?0:k.U1)k.U1.remove(this),k.tk(this.Yvf),k.yl(this.Uvf);c.a.Ia(this.qWc);this.VI=null;super.dispose()}Th(k,l){switch(l){case -1470715894:case -1231471547:this.ZX(!1);
break;default:if(this.OEd(k,l))return f.g(k),!0;e.Xii(l)||this.ZX(!1)}return!1}ZX(){c.a.Ia(this.qWc);this.qWc=b.a.instance.create(this.AFi,10,d.a.zri)}nh(){this.ZX(!1)}static Xii(k){switch(k){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1}}Object(t.a)(e,"ListAutoCompleteBehavior",C.a,[467,2])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kpae.js.map/89c36185e38bbc05e18741c1c76418ea/EwaDSEsNext.kpae.js.map