var otelFull=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"j",(function(){return i})),n.d(t,"l",(function(){return a})),n.d(t,"k",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return v}));var r="function",i="object",a="undefined",o="prototype",s="hasOwnProperty",c="default",u=Object,l=u[o],f=u.assign,d=u.create,p=u.defineProperty,v=l[s]},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(0),i=null;function a(e){return void 0===e&&(e=!0),i&&e||(typeof globalThis!==r.l&&globalThis&&(i=globalThis),typeof self!==r.l&&self&&(i=self),typeof window!==r.l&&window&&(i=window),typeof global!==r.l&&global&&(i=global)),i}function o(e){throw new TypeError(e)}function s(e){var t=r.c;if(t)return t(e);if(null==e)return{};var n=typeof e;function i(){}return n!==r.j&&n!==r.h&&o("Object prototype may only be an Object:"+e),i[r.k]=e,new i}},,,function(e,t,n){"use strict";n.r(t);var r,i=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}(),a=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e.prototype.setCorrelationId=function(){},e}(),o=new(function(){function e(){this.externalLogger=new a}return e.prototype.setCorrelationId=function(e){this.externalLogger.setCorrelationId(e)},e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,n,r){this.externalLogger.sendTraceTag(e,t,n,r)},e.prototype.debugAssertTag=function(e,t,n,r){this.externalLogger.debugAssertTag(e,t,n,r)},e.prototype.shipAssertTag=function(e,t,n,r){this.externalLogger.shipAssertTag(e,t,n,r)},e}());!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(r={}));var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var u=function(){return(u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.create;Object.create;var l,f=(l=[],{fireEvent:function(e){l.forEach((function(t){return t(e)}))},addListener:function(e){e&&l.push(e)}});function d(e,t,n){f.fireEvent({level:e,category:t,message:n})}function p(e,t,n){d(0,e,(function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)}))}var v={};function g(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?v[e]?(t.ariaTenantToken&&(v[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(v[e].dnmToken=t.dnmToken)):v[e]=t:d(0,0,(function(){return"Namespace: ".concat(e)}))}function h(e,t){for(var n=e.length;n>0;){var r=e.substr(0,n);if(v[r]){var i=v[r];return t.ariaTenantToken=i.ariaTenantToken,t.dnmToken=i.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var m=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,y=/^[a-zA-Z0-9_\.]{1,95}$/;function T(e){if(!function(e){if(!e||e.length>98)return!1;return m.test(e)}(e.eventName))throw new Error("Invalid eventName");var t=e.eventContract;if(t){if(t.name&&!b(t.name))throw new Error("Invalid eventContract");S(t.dataFields)}S(e.dataFields)}function b(e){return y.test(e)}function S(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!b(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}function _(e,t,n){return{name:e,dataType:1,value:t,classification:n||4}}function E(e,t,n){return{name:e,dataType:2,value:t,classification:n||4}}function C(e,t,n){return{name:e,dataType:3,value:t,classification:n||4}}function O(e,t,n){return{name:e,dataType:0,value:t,classification:n||4}}function w(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?u({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var x=function(){function e(e,t,n){var r,i,a;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(r=this.persistentDataFields).push.apply(r,e.persistentDataFields),this.config=u(u({},e.getConfig()),this.config),(i=this.partAFields).push.apply(i,e.partAFields)),t&&(a=this.persistentDataFields).push.apply(a,t)}return e.prototype.addEventContentType=function(e,t){e.push(E("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=w(e),n=t.telemetryProperties;if((n.nexusTenantToken=-1,!n.ariaTenantToken)&&(!h(t.eventName,n)&&!n.ariaTenantToken))return void d(0,0,(function(){return"No tenant token: "+e.eventName}));this.sendTelemetryEventInternal(t,1)},e.prototype.sendCustomerContent=function(e){var t=w(e),n=t.telemetryProperties,r=n.customerContentVersion;return(!r||r>1)&&(n.customerContentVersion=1),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=w(e),n=t.telemetryProperties;if(!n.dnmToken&&(!h(t.eventName,n)&&!n.dnmToken))return void d(0,0,(function(){return"No dnm token: "+t.eventName}));this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):d(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void p(0,"SendTelemetryEvent",e)}try{this.telemetrySinks.forEach((function(n){2===t?n.sendCustomerContent&&n.sendCustomerContent(e):3===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}))}catch(e){}}else d(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var n,r,i;if(e.dataFields&&(null===(i=e.dataFields)||void 0===i||i.unshift(O("OTelJS.Version","4.11.0")),3!==t&&this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.partAFields.length>0){var a=e.eventContract||{name:"",dataFields:[]};(r=a.dataFields).push.apply(r,this.partAFields),e.eventContract=a}this.config.disableValidation||T(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var r=n[t],i=r[0],a=r[1];this.sendTelemetryEventInternal(i,a)}},e.prototype.setTenantToken=function(e,t,n){g(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){g(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return w(e)},e.prototype.getConfig=function(){return this.config},e}();function k(e,t,n,r){var i=!0;if(t)for(var a=function(t){var a=t.classification,o=t.dataType,s=t.name;if(a&&!(4===a||1===a||2===r&&32===a||3===r&&2048===a))return i=!1,"break";if(3===r&&n&&3!==o&&1!==o&&2!==o&&"OTelJS.Version"!==s&&"OTelJS.Sink"!==s)return d(0,1,(function(){return"DNM: Invalid field type "+s})),i=!1,"break";var c=void 0;c=n?"zC."===s.substr(0,3)?"zC.Data."+s.substr(3):"Data."+s:s;var u=void 0;switch(o){case 3:u=6;break;case 2:u=4;break;case 4:u=8;break;case 0:return e[c]="string"==typeof t.value?t.value.substr(0,25e3):t.value,"continue";case 1:default:return e[c]=t.value,"continue"}var l={value:t.value,propertyType:u};e[c]=l},o=0,s=t;o<s.length;o++){if("break"===a(s[o]))break}return i}function P(e,t){try{return e()}catch(e){return p(1,"1DS Sink",e),t}}function I(e){return e.timestamp?new Date(e.timestamp):new Date}function N(e,t){for(var n=function(n){var r=t[n];if(!r.processEvent(e))return d(2,1,(function(){return"".concat(e.eventName," suppressed by ").concat(r.name)})),{value:!1}},r=0;r<t.length;r++){var i=n(r);if("object"==typeof i)return i.value}return!0}var M;function D(e){d(0,1,(function(){return"Invalid "+e}))}function A(e,t){return e?e+"."+t:t}function F(e,t,n,r){n&&r.push(O("".concat(A(e,t)),n))}function L(e,t,n,r){"boolean"==typeof n&&r.push(_("".concat(A(e,t)),n))}function U(e,t,n,r){"number"==typeof n&&r.push(E("".concat(A(e,t)),n))}!function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",e.CUSTOMER_CONTENT="https://office-c.events.data.microsoft.com/OneCollector/1.0/",e.EUDB="https://eu-office.events.data.microsoft.com/OneCollector/1.0/"}(M||(M={}));var R=function(e){var t=[];return U("Activity.Result","Code",e.code,t),F("Activity.Result","Type",e.type,t),U("Activity.Result","Tag",e.tag,t),L("Activity.Result","IsExpected",e.isExpected,t),t.push(O("zC.Activity.Result","Office.System.Result")),t},W={contractName:"Office.System.Activity",getFields:function(e){var t=[];return F("Activity","CV",e.cV,t),U("Activity","Duration",e.duration,t),U("Activity","Count",e.count,t),U("Activity","AggMode",e.aggMode,t),L("Activity","Success",e.success,t),e.result&&t.push.apply(t,R(e.result)),t.push(O("zC.Activity",this.contractName)),t}},B=function(e){var t=[];return F("User","PrimaryIdentityHash",e.primaryIdentityHash,t),F("User","PrimaryIdentitySpace",e.primaryIdentitySpace,t),F("User","TenantId",e.tenantId,t),F("User","TenantGroup",e.tenantGroup,t),L("User","IsAnonymous",e.isAnonymous,t),t},z=function(e){var t=[];return U("UserAction","Id",e.id,t),F("UserAction","Name",e.name,t),F("UserAction","CommandSurface",e.commandSurface,t),F("UserAction","ParentName",e.parentName,t),F("UserAction","TriggerMethod",e.triggerMethod,t),U("UserAction","TimeOffsetMs",e.timeOffsetMs,t),t},H=function(e){var t=[];return F("App","Name",e.name,t),F("App","Platform",e.platform,t),F("App","Version",e.version,t),t},j=function(e){var t=[];return F("Session","Id",e.id,t),F("Session","EcsETag",e.ecsETag,t),t},V=function(e){var t=[];return F("Release","AudienceGroup",e.audienceGroup,t),t},K=n(0),q=n(5),J=Object,G=J.getPrototypeOf,Q=J.getOwnPropertyNames,X=0;function $(e,t){return e&&J.prototype.hasOwnProperty.call(e,t)}function Z(e){return e&&(e===J.prototype||e===Array.prototype)}function Y(e){return Z(e)||e===Function.prototype}function ee(e){var t;if(e){if(G)return G(e);var n=e.__proto__||e.prototype||(e.constructor?e.constructor.prototype:null);t=e._dyn__proto__||n,$(e,"_dyn__proto__")||(delete e._dynInstProto,t=e._dyn__proto__=e._dynInstProto||e._dyn__proto__,e._dynInstProto=n)}return t}function te(e,t){var n=[];if(Q)n=Q(e);else for(var r in e)"string"==typeof r&&$(e,r)&&n.push(r);if(n&&n.length>0)for(var i=0;i<n.length;i++)t(n[i])}function ne(e,t,n){return"constructor"!==t&&"function"==typeof e[t]&&(n||$(e,t))}function re(e){throw new TypeError("DynamicProto: "+e)}function ie(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function ae(e,t,n,r){var i=null;if(e&&$(n,"_dynClass")){var a=e._dynInstFuncs||{};if((i=(a[n._dynClass]||{})[t])||re("Missing ["+t+"] function"),!i._dynInstChk&&!1!==a._dynInstChk){for(var o=!$(e,t),s=ee(e),c=[];o&&s&&!Y(s)&&!ie(c,s);){var u=s[t];if(u){o=u===r;break}c.push(s),s=ee(s)}try{o&&(e[t]=i),i._dynInstChk=1}catch(e){a._dynInstChk=!1}}}return i}function oe(e,t,n){var r=t[e];return r===n&&(r=ee(t)[e]),"function"!=typeof r&&re("["+e+"] is not a function"),r}function se(e,t,n,r,i){if(!Z(e)){var a=n._dynInstFuncs=n._dynInstFuncs||{},o=a[t]=a[t]||{};!1!==a._dynInstChk&&(a._dynInstChk=!!i),te(n,(function(t){ne(n,t,!1)&&n[t]!==r[t]&&(o[t]=n[t],delete n[t],(!$(e,t)||e[t]&&!e[t]._isDynProxy)&&(e[t]=function(e,t){var n=function(){var r=ae(this,t,e,n)||oe(t,e,n);return r.apply(this,arguments)};return n._isDynProxy=1,n}(e,t)))}))}}function ce(e,t){return $(e,"prototype")?e.name||t||"_unknown_":((e||{}).constructor||{}).name||t||"_unknown_"}function ue(e,t,n,r){$(e,"prototype")||re("theClass is an invalid class definition.");var i=e.prototype;(function(e,t){if(G){for(var n=[],r=ee(t);r&&!Y(r)&&!ie(n,r);){if(r===e)return!0;n.push(r),r=ee(r)}return!1}return!0})(i,t)||re("["+ce(e)+"] is not in class hierarchy of ["+ce(t)+"]");var a=null;$(i,"_dynClass")?a=i._dynClass:(a="_dynCls$"+ce(e,"_")+"$"+X,X++,i._dynClass=a);var o=ue._dfOpts,s=!!o.useBaseInst;s&&r&&void 0!==r.useBaseInst&&(s=!!r.useBaseInst);var c=function(e){var t={};return te(e,(function(n){!t[n]&&ne(e,n,!1)&&(t[n]=e[n])})),t}(t);n(t,function(e,t,n,r){function i(e,t,n){var i=t[n];if(i._isDynProxy&&r){var a=e._dynInstFuncs||{};!1!==a._dynInstChk&&(i=(a[t._dynClass]||{})[n]||i)}return function(){return i.apply(e,arguments)}}var a={};te(n,(function(e){a[e]=i(t,n,e)}));for(var o=ee(e),s=[];o&&!Y(o)&&!ie(s,o);)te(o,(function(e){!a[e]&&ne(o,e,!G)&&(a[e]=i(t,o,e))})),s.push(o),o=ee(o);return a}(i,t,c,s));var u=!!G&&!!o.setInstFuncs;u&&r&&(u=!!r.setInstFuncs),se(i,a,t,c,!1!==u)}ue._dfOpts={setInstFuncs:!0,useBaseInst:!0};var le=K.d,fe=K.b.freeze,de=(K.b.seal,K.b.keys),pe=String[K.k],ve=pe.trim,ge=pe.endsWith,he=pe.startsWith,me=Date[K.k].toISOString,ye=Array.isArray,Te=K.f.toString,be=K.e.toString,Se=be.call(K.b),_e=/-([a-z])/g,Ee=/([^\w\d_$])/g,Ce=/^(\d+[\w\d_$])/,Oe=Object.getPrototypeOf;function we(e,t){return typeof e===t}function xe(e){return void 0===e||typeof e===K.l}function ke(e){return null===e||xe(e)}function Pe(e){return!ke(e)}function Ie(e,t){return!(!e||!K.e.call(e,t))}function Ne(e){return!(!e||typeof e!==K.j)}function Me(e){return!(!e||typeof e!==K.h)}function De(e){var t=e;return t&&ze(t)&&(t=(t=(t=t.replace(_e,(function(e,t){return t.toUpperCase()}))).replace(Ee,"_")).replace(Ce,(function(e,t){return"_"+t}))),t}function Ae(e,t){if(e)for(var n in e)K.e.call(e,n)&&t.call(e,n,e[n])}function Fe(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=ge?e.endsWith(t):function(e,t){var n=!1,r=t?t.length:0,i=e?e.length:0;if(r&&i&&i>=r&&!(n=e===t)){for(var a=i-1,o=r-1;o>=0;o--){if(e[a]!=t[o])return!1;a--}n=!0}return n}(e,t)),n}function Le(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=he?e.startsWith(t):function(e,t){var n=!1,r=t?t.length:0;if(e&&r&&e.length>=r&&!(n=e===t)){for(var i=0;i<r;i++)if(e[i]!==t[i])return!1;n=!0}return n}(e,t)),n}function Ue(e,t){return!(!e||!t)&&-1!==e.indexOf(t)}function Re(e){return!(!e||"[object Date]"!==Te.call(e))}var We=ye||function(e){return!(!e||"[object Array]"!==Te.call(e))};function Be(e){return!(!e||"[object Error]"!==Te.call(e))}function ze(e){return"string"==typeof e}function He(e){return"number"==typeof e}function je(e){return"boolean"==typeof e}function Ve(e){var t=!1;if(e&&"object"==typeof e){var n=Oe?Oe(e):function(e){if(e){if(Oe)return Oe(e);var t=e.__proto__||e[K.k]||e.constructor;if(t)return t}return null}(e);n?(n.constructor&&K.e.call(n,"constructor")&&(n=n.constructor),t=typeof n===K.h&&be.call(n)===Se):t=!0}return t}function Ke(e){if(e)return me?e.toISOString():function(e){if(e&&e.getUTCFullYear){var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function qe(e,t,n){var r=e.length;try{for(var i=0;i<r&&(!(i in e)||-1!==t.call(n||e,e[i],i,e));i++);}catch(e){}}function Je(e,t,n){if(e){if(e.indexOf)return e.indexOf(t,n);var r=e.length,i=n||0;try{for(var a=Math.max(i>=0?i:r-Math.abs(i),0);a<r;a++)if(a in e&&e[a]===t)return a}catch(e){}}return-1}function Ge(e,t,n){var r;if(e){if(e.map)return e.map(t,n);var i=e.length,a=n||e;r=new Array(i);try{for(var o=0;o<i;o++)o in e&&(r[o]=t.call(a,e[o],e))}catch(e){}}return r}function Qe(e,t,n){var r;if(e){if(e.reduce)return e.reduce(t,n);var i=e.length,a=0;if(arguments.length>=3)r=arguments[2];else{for(;a<i&&!(a in e);)a++;r=e[a++]}for(;a<i;)a in e&&(r=t(r,e[a],a,e)),a++}return r}function Xe(e){return e&&(e=ve&&e.trim?e.trim():e.replace?e.replace(/^\s+|\s+$/g,""):e),e}var $e=!{toString:null}.propertyIsEnumerable("toString"),Ze=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function Ye(e){var t=typeof e;if(t===K.h||t===K.j&&null!==e||Object(q.c)("objKeys called on non-object"),!$e&&de)return de(e);var n=[];for(var r in e)e&&K.e.call(e,r)&&n.push(r);if($e)for(var i=Ze.length,a=0;a<i;a++)e&&K.e.call(e,Ze[a])&&n.push(Ze[a]);return n}function et(e,t,n,r){if(le)try{var i={enumerable:!0,configurable:!0};return n&&(i.get=n),r&&(i.set=r),le(e,t,i),!0}catch(e){}return!1}function tt(e){return e}function nt(e){return fe&&Ae(e,(function(e,t){(We(t)||Ne(t))&&fe(t)})),rt(e)}var rt=fe||tt;function it(){var e=Date;return e.now?e.now():(new e).getTime()}function at(e){return Be(e)?e.name:""}function ot(e,t,n,r,i){var a=n;return e&&((a=e[t])===n||i&&!i(a)||r&&!r(n)||(a=n,e[t]=a)),a}function st(e,t,n){var r;return e?!(r=e[t])&&ke(r)&&(r=xe(n)?{}:n,e[t]=r):r=xe(n)?{}:n,r}function ct(e,t){return ke(e)?t:e}function ut(e){return!!e}function lt(e){throw new Error(e)}function ft(e,t){var n=null,r=null;return Me(e)?n=e:r=e,function(){var e=arguments;if(n&&(r=n()),r)return r[t].apply(r,e)}}function dt(e,t,n,r,i){e&&t&&n&&(!1!==i||xe(e[t]))&&(e[t]=ft(n,r))}function pt(e,t,n,r){return e&&t&&Ne(e)&&We(n)&&qe(n,(function(n){ze(n)&&dt(e,n,t,n,r)})),e}function vt(e){return e&&K.a&&(e=Object(K.b)(Object(K.a)({},e))),e}function gt(e,t,n,r,i,a){var o=arguments,s=o[0]||{},c=o.length,u=!1,l=1;for(c>0&&je(s)&&(u=s,s=o[l]||{},l++),Ne(s)||(s={});l<c;l++){var f=o[l],d=We(f),p=Ne(f);for(var v in f){var g=d&&v in f||p&&K.e.call(f,v);if(g){var h=f[v],m=void 0;if(u&&h&&((m=We(h))||Ve(h))){var y=s[v];m?We(y)||(y=[]):Ve(y)||(y={}),h=gt(u,y,h)}void 0!==h&&(s[v]=h)}}}return s}var ht=null,mt=null,yt=!1,Tt=null,bt=null;function St(e,t){var n=!1;if(e){try{if(!(n=t in e)){var r=e[K.k];r&&(n=t in r)}}catch(e){}if(!n)try{n=!xe((new e)[t])}catch(e){}}return n}function _t(e){var t=Object(q.a)();return t&&t[e]?t[e]:"window"===e&&Et()?window:null}function Et(){return Boolean(typeof window===K.j&&window)}function Ct(){return Et()?window:_t("window")}function Ot(){return Boolean(typeof document===K.j&&document)?document:_t("document")}function wt(){return Boolean(typeof navigator===K.j&&navigator)}function xt(){return wt()?navigator:_t("navigator")}function kt(e){if(e&&yt){var t=_t("__mockLocation");if(t)return t}return typeof location===K.j&&location?location:_t("location")}function Pt(){return _t("performance")}function It(){return Boolean(typeof JSON===K.j&&JSON||null!==_t("JSON"))}function Nt(){return It()?JSON||_t("JSON"):null}function Mt(){var e=xt();return!(!e||!e.product)&&"ReactNative"===e.product}function Dt(){var e=xt();if(e&&(e.userAgent!==mt||null===ht)){var t=((mt=e.userAgent)||"").toLowerCase();ht=Ue(t,"msie")||Ue(t,"trident/")}return ht}function At(e){var t=Object[K.k].toString.call(e),n="";return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":It()&&(n=Nt().stringify(e)),t+n}function Ft(){return null===bt&&(bt=wt()&&Boolean(xt().sendBeacon)),bt}function Lt(e){var t=!1;try{t=!!_t("fetch");var n=_t("Request");t&&e&&n&&(t=St(n,"keepalive"))}catch(e){}return t}function Ut(){return null===Tt&&(Tt=typeof XDomainRequest!==K.l)&&Rt()&&(Tt=Tt&&!St(_t("XMLHttpRequest"),"withCredentials")),Tt}function Rt(){var e=!1;try{e=!!_t("XMLHttpRequest")}catch(e){}return e}var Wt,Bt=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],zt=null;function Ht(e,t){return function(){var n=arguments,r=jt(t);if(r){var i=r.listener;i&&i[e]&&i[e].apply(i,n)}}}function jt(e){var t,n=zt;return n||!0===e.disableDbgExt||(n=zt||((t=_t("Microsoft"))&&(zt=t.ApplicationInsights),zt)),n?n.ChromeDbgExt:null}function Vt(e){return e?'"'+e.replace(/\"/g,"")+'"':""}function Kt(e,t){var n=typeof console!==K.l?console:_t("console");if(n){var r="log";n[e]&&(r=e),Me(n[r])&&n[r](t)}}var qt=function(){function e(e,t,n,r){void 0===n&&(n=!1);this.messageId=e,this.message=(n?"AI: ":"AI (Internal): ")+e;var i="";It()&&(i=Nt().stringify(r));var a=(t?" message:"+Vt(t):"")+(r?" props:"+Vt(i):"");this.message+=a}return e.dataType="MessageData",e}();var Jt=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n,r,i,a,o=0,s={};ue(e,this,(function(e){function c(t,n){if(!(o>=i)){var a=!0,c="AITR_"+n.messageId;if(s[c]?a=!1:s[c]=!0,a&&(t<=r&&(e.queue.push(n),o++,u(1===t?"error":"warn",n)),o===i)){var l="Internal events throttle limit per PageView reached for this app.",f=new qt(23,l,!1);e.queue.push(f),1===t?e.errorToConsole(l):e.warnToConsole(l)}}}function u(e,n){var r=jt(t||{});r&&r.diagLog&&r.diagLog(e,n)}!function(e){n=ct(e.loggingLevelConsole,0),r=ct(e.loggingLevelTelemetry,1),i=ct(e.maxMessageLimit,25),a=ct(e.enableDebugExceptions,!1)}(t||{}),e.consoleLoggingLevel=function(){return n},e.telemetryLoggingLevel=function(){return r},e.maxInternalMessageLimit=function(){return i},e.enableDebugExceptions=function(){return a},e.throwInternal=function(t,r,i,o,l){void 0===l&&(l=!1);var f=new qt(r,i,l,o);if(a)throw At(f);var d=1===t?"errorToConsole":"warnToConsole";if(xe(f.message))u("throw"+(1===t?"Critical":"Warning"),f);else{if(l){var p=+f.messageId;!s[p]&&n>=t&&(e[d](f.message),s[p]=!0)}else n>=t&&e[d](f.message);c(t,f)}},e.warnToConsole=function(e){Kt("warn",e),u("warning",e)},e.errorToConsole=function(e){Kt("error",e),u("error",e)},e.resetInternalMessageCount=function(){o=0,s={}},e.logInternalMessage=c}))}return e.__ieDyn=1,e}();function Gt(e){return e||new Jt}function Qt(e,t,n,r,i,a){void 0===a&&(a=!1),Gt(e).throwInternal(t,n,r,i,a)}function Xt(e,t){Gt(e).warnToConsole(t)}var $t=null,Zt=null,Yt=null,en=Ot(),tn={},nn={};function rn(e,t){var n=on._ckMgr||nn._ckMgr;return n||(n=on._ckMgr=on(e,t),nn._ckMgr=n),n}function an(e){return!e||e.isEnabled()}function on(e,t){var n,r=function(e){var t=e.cookieCfg=e.cookieCfg||{};if(ot(t,"domain",e.cookieDomain,Pe,ke),ot(t,"path",e.cookiePath||"/",null,ke),ke(t.enabled)){var n=void 0;xe(e.isCookieUseDisabled)||(n=!e.isCookieUseDisabled),xe(e.disableCookiesUsage)||(n=!e.disableCookiesUsage),t.enabled=n}return t}(e||nn),i=r.path||"/",a=r.domain,o=!1!==r.enabled,s=((n={isEnabled:function(){var e=o&&sn(t),n=nn._ckMgr;return e&&n&&s!==n&&(e=an(n)),e}}).setEnabled=function(e){o=!1!==e},n.set=function(e,t,n,o,c){var u=!1;if(an(s)){var l={},f=Xe(t||""),d=f.indexOf(";");if(-1!==d&&(f=Xe(t.substring(0,d)),l=cn(t.substring(d+1))),ot(l,"domain",o||a,ut,xe),!ke(n)){var p=Dt();if(xe(l.expires)){var v=it()+1e3*n;if(v>0){var g=new Date;g.setTime(v),ot(l,"expires",un(g,p?"toGMTString":"toUTCString")||un(g,p?"toGMTString":"toUTCString")||"",ut)}}p||ot(l,"max-age",""+n,null,xe)}var h=kt();h&&"https:"===h.protocol&&(ot(l,"secure",null,null,xe),null===Zt&&(Zt=!pn((xt()||{}).userAgent)),Zt&&ot(l,"SameSite","None",null,xe)),ot(l,"path",c||i,null,xe),(r.setCookie||dn)(e,ln(f,l)),u=!0}return u},n.get=function(e){var t="";return an(s)&&(t=(r.getCookie||fn)(e)),t},n.del=function(e,t){var n=!1;return an(s)&&(n=s.purge(e,t)),n},n.purge=function(e,n){var i,a=!1;if(sn(t)){var o=((i={}).path=n||"/",i.expires="Thu, 01 Jan 1970 00:00:01 GMT",i);Dt()||(o["max-age"]="0"),(r.delCookie||dn)(e,ln("",o)),a=!0}return a},n);return s._ckMgr=s,s}function sn(e){if(null===$t){$t=!1;try{$t=void 0!==(en||{}).cookie}catch(t){Qt(e,2,68,"Cannot access document.cookie - "+at(t),{exception:At(t)})}}return $t}function cn(e){var t={};e&&e.length&&qe(Xe(e).split(";"),(function(e){if(e=Xe(e||"")){var n=e.indexOf("=");-1===n?t[e]=null:t[Xe(e.substring(0,n))]=Xe(e.substring(n+1))}}));return t}function un(e,t){return Me(e[t])?e[t]():null}function ln(e,t){var n=e||"";return Ae(t,(function(e,t){n+="; "+e+(ke(t)?"":"="+t)})),n}function fn(e){var t="";if(en){var n=en.cookie||"";Yt!==n&&(tn=cn(n),Yt=n),t=Xe(tn[e]||"")}return t}function dn(e,t){en&&(en.cookie=e+"="+t)}function pn(e){return!!ze(e)&&(!(!Ue(e,"CPU iPhone OS 12")&&!Ue(e,"iPad; CPU OS 12"))||(!!(Ue(e,"Macintosh; Intel Mac OS X 10_14")&&Ue(e,"Version/")&&Ue(e,"Safari"))||(!(!Ue(e,"Macintosh; Intel Mac OS X 10_14")||!Fe(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(!(!Ue(e,"Chrome/5")&&!Ue(e,"Chrome/6"))||(!(!Ue(e,"UnrealEngine")||Ue(e,"Chrome"))||!(!Ue(e,"UCBrowser/12")&&!Ue(e,"UCBrowser/11")))))))}var vn=!1,gn=123456789,hn=987654321;function mn(e){e<0&&(e>>>=0),gn=123456789+e&4294967295,hn=987654321-e&4294967295,vn=!0}function yn(){try{var e=2147483647&it();mn((4294967296*Math.random()^e)+e)}catch(e){}}function Tn(e){return e>0?Math.floor(bn()/4294967295*(e+1))>>>0:0}function bn(e){var t=0,n=_t("crypto")||_t("msCrypto");return n&&n.getRandomValues&&(t=4294967295&n.getRandomValues(new Uint32Array(1))[0]),0===t&&Dt()&&(vn||yn(),t=4294967295&_n()),0===t&&(t=Math.floor(4294967296*Math.random()|0)),e||(t>>>=0),t}function Sn(e){e?mn(e):yn()}function _n(e){var t=((hn=36969*(65535&hn)+(hn>>16)&4294967295)<<16)+(65535&(gn=18e3*(65535&gn)+(gn>>16)&4294967295))>>>0&4294967295|0;return e||(t>>>=0),t}function En(e){void 0===e&&(e=22);for(var t=bn()>>>0,n=0,r="";r.length<e;)n++,r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(bn()<<2&4294967295|3&t)>>>0,n=0);return r}var Cn=K.d,On="."+En(6),wn=0;function xn(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType}function kn(e,t){var n=t[e.id];if(!n){n={};try{xn(t)&&(function(e,t,n){if(Cn)try{return Cn(e,t,{value:n,enumerable:!1,configurable:!0}),!0}catch(e){}return!1}(t,e.id,n)||(t[e.id]=n))}catch(e){}}return n}function Pn(e,t){return void 0===t&&(t=!1),De(e+wn+++(t?".2.8.5":"")+On)}function In(e){var t={id:Pn("_aiData-"+(e||"")+".2.8.5"),accept:function(e){return xn(e)},get:function(e,n,r,i){var a=e[t.id];return a?a[De(n)]:(i&&((a=kn(t,e))[De(n)]=r),r)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}var Nn=Pn("aiEvtPageHide"),Mn=Pn("aiEvtPageShow"),Dn=/\.[\.]+/g,An=/[\.]+$/,Fn=1,Ln=In("events"),Un=/^([^.]*)(?:\.(.+)|)/;function Rn(e){return e&&e.replace?e.replace(/^\s*\.*|\.*\s*$/g,""):e}function Wn(e,t){var n;if(t){var r="";We(t)?(r="",qe(t,(function(e){(e=Rn(e))&&("."!==e[0]&&(e="."+e),r+=e)}))):r=Rn(t),r&&("."!==r[0]&&(r="."+r),e=(e||"")+r)}var i=Un.exec(e||"")||[];return(n={}).type=i[1],n.ns=(i[2]||"").replace(Dn,".").replace(An,"").split(".").sort().join("."),n}function Bn(e,t,n){void 0===n&&(n=!0);var r=Ln.get(e,"events",{},n),i=r[t];return i||(i=r[t]=[]),i}function zn(e,t,n,r){e&&t&&t.type&&(e.removeEventListener?e.removeEventListener(t.type,n,r):e.detachEvent&&e.detachEvent("on"+t.type,n))}function Hn(e,t,n,r){for(var i=t.length;i--;){var a=t[i];a&&(n.ns&&n.ns!==a.evtName.ns||r&&!r(a)||(zn(e,a.evtName,a.handler,a.capture),t.splice(i,1)))}}function jn(e,t){return t?Wn("xx",We(t)?[e].concat(t):[e,t]).ns.split("."):e}function Vn(e,t,n,r,i){var a;void 0===i&&(i=!1);var o=!1;if(e)try{var s=Wn(t,r);if((o=function(e,t,n,r){var i=!1;return e&&t&&t.type&&n&&(e.addEventListener?(e.addEventListener(t.type,n,r),i=!0):e.attachEvent&&(e.attachEvent("on"+t.type,n),i=!0)),i}(e,s,n,i))&&Ln.accept(e)){var c=((a={guid:Fn++,evtName:s}).handler=n,a.capture=i,a);Bn(e,s.type).push(c)}}catch(e){}return o}function Kn(e,t,n,r,i){if(void 0===i&&(i=!1),e)try{var a=Wn(t,r),o=!1;!function(e,t,n){if(t.type)Hn(e,Bn(e,t.type),t,n);else{var r=Ln.get(e,"events",{});Ae(r,(function(r,i){Hn(e,i,t,n)})),0===Ye(r).length&&Ln.kill(e,"events")}}(e,a,(function(e){return!((!a.ns||n)&&e.handler!==n)&&(o=!0,!0)})),o||zn(e,a,n,i)}catch(e){}}function qn(e,t,n){var r=!1,i=Ct();i&&(r=Vn(i,e,t,n),r=Vn(i.body,e,t,n)||r);var a=Ot();return a&&(r=Vn(a,e,t,n)||r),r}function Jn(e,t,n,r){var i=!1;return t&&e&&e.length>0&&qe(e,(function(e){e&&(n&&-1!==Je(n,e)||(i=qn(e,t,r)||i))})),i}function Gn(e,t,n){e&&We(e)&&qe(e,(function(e){e&&function(e,t,n){var r=Ct();r&&(Kn(r,e,t,n),Kn(r.body,e,t,n));var i=Ot();i&&Kn(i,e,t,n)}(e,t,n)}))}function Qn(e,t,n){return function(e,t,n,r){var i=!1;return t&&e&&We(e)&&!(i=Jn(e,t,n,r))&&n&&n.length>0&&(i=Jn(e,t,null,r)),i}(["beforeunload","unload","pagehide"],e,t,n)}var Xn,$n=null;K.l;function Zn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(nr,(function(e){var t=0|Tn(15);return("x"===e?t:3&t|8).toString(16)}))}function Yn(){var e=Pt();return e&&e.now?e.now():it()}function er(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n="",r=0;r<4;r++)n+=t[15&(e=bn())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var i=t[8+(3&bn())|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+i+n.substr(16,3)+n.substr(19,12)}var tr={_canUseCookies:void 0,isTypeof:we,isUndefined:xe,isNullOrUndefined:ke,hasOwnProperty:Ie,isFunction:Me,isObject:Ne,isDate:Re,isArray:We,isError:Be,isString:ze,isNumber:He,isBoolean:je,toISOString:Ke,arrForEach:qe,arrIndexOf:Je,arrMap:Ge,arrReduce:Qe,strTrim:Xe,objCreate:q.b,objKeys:Ye,objDefineAccessors:et,addEventHandler:qn,dateNow:it,isIE:Dt,disableCookies:function(){rr().setEnabled(!1)},newGuid:Zn,perfNow:Yn,newId:En,randomValue:Tn,random32:bn,mwcRandomSeed:Sn,mwcRandom32:_n,generateW3CId:er},nr=/[xy]/g;function rr(e,t){var n=rn(e,t),r=tr._canUseCookies;return null===$n&&($n=[],Xn=r,et(tr,"_canUseCookies",(function(){return Xn}),(function(e){Xn=e,qe($n,(function(t){t.setEnabled(e)}))}))),-1===Je($n,n)&&$n.push(n),je(r)&&n.setEnabled(r),je(Xn)&&n.setEnabled(Xn),n}var ir,ar=n(11);function or(e){var t={};return Ae(e,(function(e,n){t[e]=n,t[n]=e})),nt(t)}var sr="Failed",cr="Track",ur="Storage",lr=(or({CRITICAL:1,WARNING:2}),or(((ir={})["BrowserDoesNotSupportLocal"+ur]=0,ir["BrowserCannotReadLocal"+ur]=1,ir["BrowserCannotReadSession"+ur]=2,ir["BrowserCannotWriteLocal"+ur]=3,ir["BrowserCannotWriteSession"+ur]=4,ir["BrowserFailedRemovalFromLocal"+ur]=5,ir["BrowserFailedRemovalFromSession"+ur]=6,ir.CannotSendEmptyTelemetry=7,ir.ClientPerformanceMathError=8,ir.ErrorParsingAISessionCookie=9,ir.ErrorPVCalc=10,ir.ExceptionWhileLoggingError=11,ir.FailedAddingTelemetryToBuffer=12,ir.FailedMonitorAjaxAbort=13,ir.FailedMonitorAjaxDur=14,ir.FailedMonitorAjaxOpen=15,ir.FailedMonitorAjaxRSC=16,ir.FailedMonitorAjaxSend=17,ir.FailedMonitorAjaxGetCorrelationHeader=18,ir.FailedToAddHandlerForOnBeforeUnload=19,ir.FailedToSendQueuedTelemetry=20,ir.FailedToReportDataLoss=21,ir.FlushFailed=22,ir.MessageLimitPerPVExceeded=23,ir.MissingRequiredFieldSpecification=24,ir.NavigationTimingNotSupported=25,ir.OnError=26,ir.SessionRenewalDateIsZero=27,ir.SenderNotInitialized=28,ir.StartTrackEventFailed=29,ir.StopTrackEventFailed=30,ir["Start"+cr+sr]=31,ir["Stop"+cr+sr]=32,ir.TelemetrySampledAndNotSent=33,ir[cr+"Event"+sr]=34,ir[cr+"Exception"+sr]=35,ir[cr+"Metric"+sr]=36,ir[cr+"PV"+sr]=37,ir.TrackPVFailedCalc=38,ir[cr+"Trace"+sr]=39,ir.TransmissionFailed=40,ir[sr+"ToSet"+ur+"Buffer"]=41,ir[sr+"ToRestore"+ur+"Buffer"]=42,ir.InvalidBackendResponse=43,ir.FailedToFixDepricatedValues=44,ir.InvalidDurationValue=45,ir.TelemetryEnvelopeInvalid=46,ir.CreateEnvelopeError=47,ir.CannotSerializeObject=48,ir.CannotSerializeObjectNonSerializable=49,ir.CircularReferenceDetected=50,ir.ClearAuthContextFailed=51,ir.ExceptionTruncated=52,ir.IllegalCharsInName=53,ir.ItemNotInArray=54,ir.MaxAjaxPerPVExceeded=55,ir.MessageTruncated=56,ir.NameTooLong=57,ir.SampleRateOutOfRange=58,ir.SetAuthContextFailed=59,ir.SetAuthContextFailedAccountName=60,ir.StringValueTooLong=61,ir.StartCalledMoreThanOnce=62,ir.StopCalledWithoutStart=63,ir.TelemetryInitializerFailed=64,ir.TrackArgumentsNotSpecified=65,ir.UrlTooLong=66,ir.SessionStorageBufferFull=67,ir.CannotAccessCookie=68,ir.IdTooLong=69,ir.InvalidEvent=70,ir.FailedMonitorAjaxSetRequestHeader=71,ir.SendBrowserInfoOnUserInit=72,ir.PluginException=73,ir.NotificationException=74,ir.SnippetScriptLoadFailure=99,ir.InvalidInstrumentationKey=100,ir.CannotParseAiBlobValue=101,ir.InvalidContentBlob=102,ir[cr+"PageActionEvent"+sr]=103,ir.FailedAddingCustomDefinedRequestContext=104,ir.InMemoryStorageBufferFull=105,ir.InstrumentationKeyDeprecation=106,ir))),fr=(or({NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,CustomerContent_GenericContent:32}),or({Normal:1,CostDeferred:2,RealTime:3,Immediate:4}),or({Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9})),dr=(or({Normal:1,Critical:2}),or({NONE:0,ERROR:1,WARNING:2,INFORMATION:3}),rt(Object(ar.a)(Object(ar.a)({},lr),or({AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520}))),function(e,t){var n=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0;var r=[],i=!1,a=!0,o={name:"DiagnosticLevel",processEvent:function(e){var t=e.eventFlags.diagnosticLevel;return i||10===t||110===t||120===t}},s={},c=Zn();this.init=function(){return a=a&&function(e){function t(t){return"string"==typeof e[t]||(D(t),!1)}var n=t("App.Name")&&t("App.Version")&&t("App.Platform")&&t("Session.Id"),r=e["User.IsAnonymous"];if(!1!==r&&void 0!==r||(n=n&&t("User.PrimaryIdentityHash")&&t("User.PrimaryIdentitySpace")),!n)return n;var i=e["App.Version"];/^(\d+\.){3}\d+(-?[a-zA-Z0-9]+)?$/.test(i)||(D("App.Version"),n=!1);var a=/^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$/,o=e["User.TenantId"];return!o||t("User.TenantId")&&a.test(o)||(D("User.TenantId"),n=!1),a.test(e["Session.Id"])||(D("Session.Id"),n=!1),n}(s)},this.getOneDSTelemetryEvent=function(e){return u(e,{eventType:1})},this.getOneDSCustomerContent=function(e){if(t.enableCustomerContent&&e.telemetryProperties.customerContentVersion&&Math.floor(e.telemetryProperties.customerContentVersion)<=1&&1===e.telemetryProperties.customerContentType)return u(e,{eventType:2})};var u=function(e,t){var i=w(e);if(N(i,r)){var a=I(i).toISOString(),o={"Event.Name":i.eventName,"Event.Source":"OTelJS","Event.Time":{value:a,propertyType:fr.DateTime}};for(var u in n.eventsProcessed++,o["Event.Sequence"]={value:n.eventsProcessed,propertyType:fr.Int64},o["Event.Id"]=c+"."+n.eventsProcessed,s)o[u]=s[u];if(!k(o,i.dataFields,!0,t.eventType))return void d(0,1,(function(){return"Dropping Event: "+i.eventName}));var l="custom";i.eventContract&&(i.eventContract.name&&(o["Event.Contract"]=i.eventContract.name,l+="."+i.eventContract.name.toLowerCase().replace(/\./g,"_")),k(o,i.eventContract.dataFields,!1,t.eventType));var f=function(e,t){return 2===t?"b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121":e.telemetryProperties&&(1!==t||e.telemetryProperties.ariaTenantToken)?1===t?e.telemetryProperties.ariaTenantToken:void 0:void d(0,1,(function(){return"Missing Aria Token"}))}(i,t.eventType);if(!f)return;return{iKey:f,name:i.eventName,data:o,time:a,baseType:l,ext:{sdk:{seq:n.eventsProcessed}}}}};this.addPreprocessor=function(e){r.push(e)},this.getOneDSPersistentDataFields=function(){return s},this.getPreprocessors=function(){return r};var l=function(e){k(s,e,!1,1)};this.addPersistentDataFields=l,this.setOptionalEventsEnabled=function(e){i=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,t.enableOptionalEvents&&(i=!0),l(e);var f=t.coreFields;if(f){l(H(f.app)),l(B(f.user)),l(j(f.session));var p=f.release;p&&l(V(p))}this.addPreprocessor(o)}),pr=null,vr=function(){function e(t,n,r){var i,a=this,o=!1;(a.start=it(),a.name=t,a.isAsync=r,a.isChildEvt=function(){return!1},Me(n))&&(o=et(a,"payload",(function(){return!i&&Me(n)&&(i=n(),n=null),i})));a.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?a[t]:(a.ctx||{})[t]:null},a.setCtx=function(t,n){if(t)if(t===e.ParentContextKey)a[t]||(a.isChildEvt=function(){return!0}),a[t]=n;else if(t===e.ChildrenContextKey)a[t]=n;else{(a.ctx=a.ctx||{})[t]=n}},a.complete=function(){var t=0,r=a.getCtx(e.ChildrenContextKey);if(We(r))for(var i=0;i<r.length;i++){var s=r[i];s&&(t+=s.time)}a.time=it()-a.start,a.exTime=a.time-t,a.complete=function(){},!o&&Me(n)&&(a.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),gr=function(){function e(t){this.ctx={},ue(e,this,(function(e){e.create=function(e,t,n){return new vr(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&Me(t.perfEvent)&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e.ctx=e.ctx||{})[t]=n)},e.getCtx=function(t){return(e.ctx||{})[t]}}))}return e.__ieDyn=1,e}();function hr(e,t,n,r,i){if(e){var a=e;if(a.getPerfMgr&&(a=a.getPerfMgr()),a){var o=void 0,s=a.getCtx("CoreUtils.doPerf");try{if(o=a.create(t(),r,i)){if(s&&o.setCtx&&(o.setCtx(vr.ParentContextKey,s),s.getCtx&&s.setCtx)){var c=s.getCtx(vr.ChildrenContextKey);c||(c=[],s.setCtx(vr.ChildrenContextKey,c)),c.push(o)}return a.setCtx("CoreUtils.doPerf",o),n(o)}}catch(e){o&&o.setCtx&&o.setCtx("exception",e)}finally{o&&a.fire(o),a.setCtx("CoreUtils.doPerf",s)}}}return n()}var mr="00000000000000000000000000000000";function yr(e,t,n){return!(!e||e.length!==t||e===n)&&!!e.match(/^[\da-f]*$/)}function Tr(e){return yr(e,32,mr)}function br(e){return yr(e,16,"0000000000000000")}var Sr=In("plugin");function _r(e){return Sr.get(e,"state",{},!0)}function Er(e,t){for(var n,r=[],i=null,a=e.getNext();a;){var o=a.getPlugin();if(o){i&&Me(i.setNextPlugin)&&Me(o.processTelemetry)&&i.setNextPlugin(o);(Me(o.isInitialized)?o.isInitialized():(n=_r(o)).isInitialized)||r.push(o),i=o,a=a.getNext()}}qe(r,(function(r){var i=e.core();r.initialize(e.getCfg(),i,t,e.getNext()),n=_r(r),r.core||n.core||(n.core=i),n.isInitialized=!0,delete n.teardown}))}function Cr(e){return e.sort((function(e,t){var n=0;if(t){var r=Me(t.processTelemetry);Me(e.processTelemetry)?n=r?e.priority-t.priority:1:r&&(n=-1)}else n=e?1:-1;return n}))}var Or=0;function wr(e,t,n,r){var i=null,a=[];null!==r&&(i=r?function(e,t,n){for(;e;){if(e.getPlugin()===n)return e;e=e.getNext()}return Ir([n],t.config||{},t)}(e,n,r):e);var o={_next:function(){var e=i;if(i=e?e.getNext():null,!e){var t=a;t&&t.length>0&&(qe(t,(function(e){try{e.func.call(e.self,e.args)}catch(e){Qt(n.logger,2,73,"Unexpected Exception during onComplete - "+At(e))}})),a=[])}return e},ctx:{core:function(){return n},diagLog:function(){return function(e,t){return(e||{}).logger||new Jt(t)}(n,t)},getCfg:function(){return t},getExtCfg:s,getConfig:function(e,n,r){void 0===r&&(r=!1);var i,a=s(e,null);a&&!ke(a[n])?i=a[n]:t&&!ke(t[n])&&(i=t[n]);return ke(i)?r:i},hasNext:function(){return!!i},getNext:function(){return i},setNext:function(e){i=e},iterate:function(e){var t;for(;t=o._next();){var n=t.getPlugin();n&&e(n)}},onComplete:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];e&&a.push({func:e,self:xe(t)?o.ctx:t,args:n})}}};function s(e,n,r){var i;if(void 0===n&&(n={}),void 0===r&&(r=0),t){var a=t.extensionConfig;a&&e&&(i=a[e])}if(i){if(Ne(n)&&0!==r){var o=gt(!0,n,i);t&&2===r&&Ae(n,(function(e){if(ke(o[e])){var n=t[e];ke(n)||(o[e]=n)}})),i=o}}else i=n;return i}return o}function xr(e,t,n,r){var i=wr(e,t,n,r),a=i.ctx;return a.processNext=function(e){var t=i._next();return t&&t.processTelemetry(e,a),!t},a.createNew=function(e,r){return void 0===e&&(e=null),We(e)&&(e=Ir(e,t,n,r)),xr(e||a.getNext(),t,n,r)},a}function kr(e,t,n){var r=t.config||{},i=wr(e,r,t,n),a=i.ctx;return a.processNext=function(e){var t=i._next();return t&&t.unload(a,e),!t},a.createNew=function(e,n){return void 0===e&&(e=null),We(e)&&(e=Ir(e,r,t,n)),kr(e||a.getNext(),t,n)},a}function Pr(e,t,n){var r=t.config||{},i=wr(e,r,t,n).ctx;return i.processNext=function(e){return i.iterate((function(t){Me(t.update)&&t.update(i,e)}))},i.createNew=function(e,n){return void 0===e&&(e=null),We(e)&&(e=Ir(e,r,t,n)),Pr(e||i.getNext(),t,n)},i}function Ir(e,t,n,r){var i=null,a=!r;if(We(e)&&e.length>0){var o=null;qe(e,(function(e){if(a||r!==e||(a=!0),a&&e&&Me(e.processTelemetry)){var s=function(e,t,n){var r,i=null,a=Me(e.processTelemetry),o=Me(e.setNextPlugin);r=e?e.identifier+"-"+e.priority+"-"+Or++:"Unknown-0-"+Or++;var s={getPlugin:function(){return e},getNext:function(){return i},processTelemetry:function(t,n){u(n=n||c(),(function(n){if(!e||!a)return!1;var r=_r(e);if(r.teardown||r.disabled)return!1;o&&e.setNextPlugin(i);return e.processTelemetry(t,n),!0}),"processTelemetry",(function(){return{item:t}}),!t.sync)||n.processNext(t)},unload:function(t,n){u(t,(function(){var r=!1;if(e){var i=_r(e),a=e.core||i.core;!e||a&&a!==t.core()||i.teardown||(i.core=null,i.teardown=!0,i.isInitialized=!1,e.teardown&&!0===e.teardown(t,n)&&(r=!0))}return r}),"unload",(function(){}),n.isAsync)||t.processNext(n)},update:function(t,n){u(t,(function(){var r=!1;if(e){var i=_r(e),a=e.core||i.core;!e||a&&a!==t.core()||i.teardown||e.update&&!0===e.update(t,n)&&(r=!0)}return r}),"update",(function(){}),!1)||t.processNext(n)},_id:r,_setNext:function(e){i=e}};function c(){var r;return e&&Me(e._getTelCtx)&&(r=e._getTelCtx()),r||(r=xr(s,t,n)),r}function u(t,n,a,o,s){var c=!1,u=e?e.identifier:"TelemetryPluginChain",l=t._hasRun;return l||(l=t._hasRun={}),t.setNext(i),e&&hr(t.core(),(function(){return u+":"+a}),(function(){l[r]=!0;try{var e=i?i._id:"";e&&(l[e]=!1),c=n(t)}catch(e){var o=!i||l[i._id];o&&(c=!0),i&&o||Qt(t.diagLog(),1,73,"Plugin ["+u+"] failed during "+a+" - "+At(e)+", run flags: "+At(l))}}),o,s),c}return rt(s)}(e,t,n);i||(i=s),o&&o._setNext(s),o=s}}))}return r&&!i?Ir([r],t,n):i}function Nr(e,t,n){t&&We(t)&&t.length>0&&(qe(t=t.sort((function(e,t){return e.priority-t.priority})),(function(e){e.priority<500&&lt("Channel has invalid priority - "+e.identifier)})),e.push({queue:rt(t),chain:Ir(t,n.config,n)}))}function Mr(){var e=[];return{add:function(t){t&&e.push(t)},run:function(t,n){qe(e,(function(e){try{e(t,n)}catch(e){Qt(t.diagLog(),2,73,"Unexpected error calling unload handler - "+At(e))}})),e=[]}}}var Dr=function(){function e(){var t,n,r,i,a,o=this;function s(e){void 0===e&&(e=null);var t=e;if(!t){var i=n||xr(null,{},o.core);t=r&&r.getPlugin?i.createNew(null,r.getPlugin):i.createNew(null,r)}return t}function c(e,t,i){e&&ot(e,"extensionConfig",[],null,ke),!i&&t&&(i=t.getProcessTelContext().getNext());var a=r;r&&r.getPlugin&&(a=r.getPlugin()),o.core=t,n=xr(i,e,t,a)}function u(){t=!1,o.core=null,n=null,r=null,a=[],i=Mr()}u(),ue(e,o,(function(e){e.initialize=function(e,n,r,i){c(e,n,i),t=!0},e.teardown=function(t,n){var o,s=e.core;if(s&&(!t||s===t.core())){var c,l=!1,f=t||kr(null,s,r&&r.getPlugin?r.getPlugin():r),d=n||((o={reason:0}).isAsync=!1,o);return e._doTeardown&&!0===e._doTeardown(f,d,p)?c=!0:p(),c}function p(){if(!l){l=!0,i.run(f,n);var e=a;a=[],qe(e,(function(e){e.rm()})),!0===c&&f.processNext(d),u()}}},e.update=function(t,n){var i=e.core;if(i&&(!t||i===t.core())){var a,o=!1,s=t||Pr(null,i,r&&r.getPlugin?r.getPlugin():r),u=n||{reason:0};return e._doUpdate&&!0===e._doUpdate(s,u,l)?a=!0:l(),a}function l(){o||(o=!0,c(s.getCfg(),s.core(),s.getNext()))}},e._addHook=function(e){e&&(We(e)?a=a.concat(e):a.push(e))},dt(e,"_addUnloadCb",(function(){return i}),"add")})),o.diagLog=function(e){return s(e).diagLog()},o.isInitialized=function(){return t},o.setInitialized=function(e){t=e},o.setNextPlugin=function(e){r=e},o.processNext=function(e,t){t?t.processNext(e):r&&Me(r.processTelemetry)&&r.processTelemetry(e,null)},o._getTelCtx=s}return e.__ieDyn=1,e}(),Ar=function(e){function t(){var n,r,i=e.call(this)||this;function a(){n=0,r=[]}return i.identifier="TelemetryInitializerPlugin",i.priority=199,a(),ue(t,i,(function(e,t){e.addTelemetryInitializer=function(e){var t={id:n++,fn:e};return r.push(t),{remove:function(){qe(r,(function(e,n){if(e.id===t.id)return r.splice(n,1),-1}))}}},e.processTelemetry=function(t,n){for(var i=!1,a=r.length,o=0;o<a;++o){var s=r[o];if(s)try{if(!1===s.fn.apply(null,[t])){i=!0;break}}catch(e){Qt(n.diagLog(),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+at(e),{exception:At(e)},!0)}}i||e.processNext(t,n)},e._doTeardown=function(){a()}})),i}return Object(ar.b)(t,e),t.__ieDyn=1,t}(Dr),Fr={loggingLevelConsole:1};function Lr(e,t){return new gr(t)}function Ur(e,t){var n=!1;return qe(t,(function(t){if(t===e)return n=!0,-1})),n}var Rr=function(){function e(){var t,n,r,i,a,o,s,c,u,l,f,d,p,v,g,h,m,y,T,b,S=0;ue(e,this,(function(e){function _(){n=!1,t=gt(!0,{},Fr),e.config=t,e.logger=new Jt(t),e._extensions=[],g=new Ar,r=[],i=null,a=null,o=null,s=null,c=null,l=null,u=[],f=null,d=null,p=null,v=!1,h=null,m=Pn("AIBaseCore",!0),y=Mr(),b=null}function E(){return xr(w(),t,e)}function C(n){var r=function(e,t,n){var r,i=[],a={};return qe(n,(function(n){(ke(n)||ke(n.initialize))&&lt("Plugins must provide initialize method");var r=n.priority,o=n.identifier;n&&r&&(ke(a[r])?a[r]=o:Xt(e,"Two extensions have same priority #"+r+" - "+a[r]+", "+o)),(!r||r<t)&&i.push(n)})),(r={all:n}).core=i,r}(e.logger,500,u);l=r.core,c=null;var i=r.all;if(p=rt(function(e,t,n){var r=[];if(e&&qe(e,(function(e){return Nr(r,e,n)})),t){var i=[];qe(t,(function(e){e.priority>500&&i.push(e)})),Nr(r,i,n)}return r}(d,i,e)),f){var a=Je(i,f);-1!==a&&i.splice(a,1),-1!==(a=Je(l,f))&&l.splice(a,1),f._setQueue(p)}else f=function(e,t){function n(){return xr(null,t.config,t,null)}function r(e,t,n,r){var i=e?e.length+1:1;function a(){0===--i&&(r&&r(),r=null)}i>0&&qe(e,(function(e){if(e&&e.queue.length>0){var r=e.chain,o=t.createNew(r);o.onComplete(a),n(o)}else i--})),a()}var i=!1;return{identifier:"ChannelControllerPlugin",priority:500,initialize:function(t,n,r,a){i=!0,qe(e,(function(e){e&&e.queue.length>0&&Er(xr(e.chain,t,n),r)}))},isInitialized:function(){return i},processTelemetry:function(t,i){r(e,i||n(),(function(e){e.processNext(t)}),(function(){i.processNext(t)}))},update:function(t,n){var i=n||{reason:0};return r(e,t,(function(e){e.processNext(i)}),(function(){t.processNext(i)})),!0},pause:function(){r(e,n(),(function(e){e.iterate((function(e){e.pause&&e.pause()}))}),null)},resume:function(){r(e,n(),(function(e){e.iterate((function(e){e.resume&&e.resume()}))}),null)},teardown:function(t,n){var a=n||{reason:0,isAsync:!1};return r(e,t,(function(e){e.processNext(a)}),(function(){t.processNext(a),i=!1})),!0},getChannel:function(t){var n=null;return e&&e.length>0&&qe(e,(function(e){if(e&&e.queue.length>0&&(qe(e.queue,(function(e){if(e.identifier===t)return n=e,-1})),n))return-1})),n},flush:function(t,i,a,o){var s=1,c=!1,u=null;function l(){s--,c&&0===s&&(u&&(clearTimeout(u),u=null),i&&i(c),i=null)}return o=o||5e3,r(e,n(),(function(e){e.iterate((function(e){if(e.flush){s++;var n=!1;e.flush(t,(function(){n=!0,l()}),a)||n||(t&&null==u?u=setTimeout((function(){u=null,l()}),o):l())}}))}),(function(){c=!0,l()})),!0},_setQueue:function(t){e=t}}}(p,e);i.push(f),l.push(f),e._extensions=Cr(i),f.initialize(t,e,i),Er(E(),i),e._extensions=rt(Cr(l||[])).slice(),n&&function(t){var n=Pr(w(),e);e._updateHook&&!0===e._updateHook(n,t)||n.processNext(t)}(n)}function O(t){var n,r=null,i=null;return qe(e._extensions,(function(e){if(e.identifier===t&&e!==f&&e!==g)return i=e,-1})),!i&&f&&(i=f.getChannel(t)),i&&((n={plugin:i}).setEnabled=function(e){_r(i).disabled=!e},n.isEnabled=function(){var e=_r(i);return!e.teardown&&!e.disabled},n.remove=function(e,t){var n;void 0===e&&(e=!0);var r=[i],a=((n={reason:1}).isAsync=e,n);x(r,a,(function(e){e&&C({reason:32,removed:r}),t&&t(e)}))},r=n),r}function w(){if(!c){var n=(l||[]).slice();-1===Je(n,g)&&n.push(g),c=Ir(Cr(n),t,e)}return c}function x(n,r,i){if(n&&n.length>0){var a=kr(Ir(n,t,e),e);a.onComplete((function(){var e=!1,t=[];qe(u,(function(r,i){Ur(r,n)?e=!0:t.push(r)})),u=t;var r=[];d&&(qe(d,(function(t,i){var a=[];qe(t,(function(t){Ur(t,n)?e=!0:a.push(t)})),r.push(a)})),d=r),i&&i(e)})),a.processNext(r)}else i(!1)}function k(){var n=e.logger?e.logger.queue:[];n&&(qe(n,(function(n){var r,i=((r={}).name=h||"InternalMessageId: "+n.messageId,r.iKey=ct(t.instrumentationKey),r.time=Ke(new Date),r.baseType=qt.dataType,r.baseData={message:n.message},r);e.track(i)})),n.length=0)}function P(e,t,n,r){return f?f.flush(e,t,n||6,r):(t&&t(!1),!0)}function I(t){var n=e.logger;n?Qt(n,2,73,t):lt(t)}_(),e.isInitialized=function(){return n},e.initialize=function(r,a,s,c){v&&lt("SDK is still unloading..."),e.isInitialized()&&lt("Core should not be initialized more than once"),t=r||{},e.config=t,ke(r.instrumentationKey)&&lt("Please provide instrumentation key"),i=c,e._notificationManager=c,function(){var e=ct(t.disableDbgExt);!0===e&&T&&(i.removeNotificationListener(T),T=null);i&&!T&&!0!==e&&(T=function(e){if(!Wt){Wt={};for(var t=0;t<Bt.length;t++)Wt[Bt[t]]=Ht(Bt[t],e)}return Wt}(t),i.addNotificationListener(T))}(),function(){var e=ct(t.enablePerfMgr);!e&&o&&(o=null);e&&st(t,"createPerfMgr",Lr)}(),st(t,"extensionConfig",{}).NotificationManager=i,s&&(e.logger=s);var l=st(t,"extensions",[]);(u=[]).push.apply(u,Object(ar.c)(Object(ar.c)([],a,!1),l,!1)),d=st(t,"channels",[]),C(null),p&&0!==p.length||lt("No channels available"),n=!0,e.releaseQueue()},e.getTransmissionControls=function(){var e=[];return p&&qe(p,(function(t){e.push(t.queue)})),rt(e)},e.track=function(n){n.iKey=n.iKey||t.instrumentationKey,n.time=n.time||Ke(new Date),n.ver=n.ver||"4.0",!v&&e.isInitialized()?E().processNext(n):r.push(n)},e.getProcessTelContext=E,e.getNotifyMgr=function(){var t;return i||(i=Object(q.b)(((t={}).addNotificationListener=function(e){},t.removeNotificationListener=function(e){},t.eventsSent=function(e){},t.eventsDiscarded=function(e,t){},t.eventsSendRequest=function(e,t){},t)),e._notificationManager=i),i},e.addNotificationListener=function(e){i&&i.addNotificationListener(e)},e.removeNotificationListener=function(e){i&&i.removeNotificationListener(e)},e.getCookieMgr=function(){return s||(s=on(t,e.logger)),s},e.setCookieMgr=function(e){s=e},e.getPerfMgr=function(){if(!a&&!o&&ct(t.enablePerfMgr)){var n=ct(t.createPerfMgr);Me(n)&&(o=n(e,e.getNotifyMgr()))}return a||o||pr},e.setPerfMgr=function(e){a=e},e.eventCnt=function(){return r.length},e.releaseQueue=function(){if(n&&r.length>0){var e=r;r=[],qe(e,(function(e){E().processNext(e)}))}},e.pollInternalLogs=function(e){h=e||null;var n=ct(t.diagnosticLogInterval);return n&&n>0||(n=1e4),S&&clearInterval(S),S=setInterval((function(){k()}),n)},e.stopPollingInternalLogs=function(){S&&(clearInterval(S),S=0,k())},pt(e,(function(){return g}),["addTelemetryInitializer"]),e.unload=function(t,r,i){var a;void 0===t&&(t=!0),n||lt("SDK is not initialized"),v&&lt("SDK is still unloading...");var o=((a={reason:50}).isAsync=t,a.flushComplete=!1,a),s=kr(w(),e);function c(t){o.flushComplete=t,v=!0,y.run(s,o),e.stopPollingInternalLogs(),s.processNext(o)}s.onComplete((function(){_(),r&&r(o)}),e),P(t,c,6,i)||c(!1)},e.getPlugin=O,e.addPlugin=function(e,t,n,r){if(!e)return r&&r(!1),void I("Plugins must provide initialize method");var i=O(e.identifier);if(i&&!t)return r&&r(!1),void I("Plugin ["+e.identifier+"] is already loaded!");var a={reason:16};function o(t){u.push(e),a.added=[e],C(a),r&&r(!0)}if(i){var s=[i.plugin];x(s,{reason:2,isAsync:!!n},(function(e){e?(a.removed=s,a.reason|=32,o()):r&&r(!1)}))}else o()},e.evtNamespace=function(){return m},e.flush=P,e.getTraceCtx=function(e){var t,n;return b||(n={},b={getName:function(){return n.name},setName:function(e){t&&t.setName(e),n.name=e},getTraceId:function(){return n.traceId},setTraceId:function(e){t&&t.setTraceId(e),Tr(e)&&(n.traceId=e)},getSpanId:function(){return n.spanId},setSpanId:function(e){t&&t.setSpanId(e),br(e)&&(n.spanId=e)},getTraceFlags:function(){return n.traceFlags},setTraceFlags:function(e){t&&t.setTraceFlags(e),n.traceFlags=e}}),b},e.setTraceCtx=function(e){b=e||null},dt(e,"addUnloadCb",(function(){return y}),"add")}))}return e.__ieDyn=1,e}();function Wr(e,t,n,r){qe(e,(function(e){if(e&&e[t])if(n)setTimeout((function(){return r(e)}),0);else try{r(e)}catch(e){}}))}var Br,zr=function(){function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;ue(e,this,(function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var n=Je(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=Je(e.listeners,t)},e.eventsSent=function(t){Wr(e.listeners,"eventsSent",!0,(function(e){e.eventsSent(t)}))},e.eventsDiscarded=function(t,n){Wr(e.listeners,"eventsDiscarded",!0,(function(e){e.eventsDiscarded(t,n)}))},e.eventsSendRequest=function(t,n){Wr(e.listeners,"eventsSendRequest",n,(function(e){e.eventsSendRequest(t,n)}))},e.perfEvent=function(t){t&&(!n&&t.isChildEvt()||Wr(e.listeners,"perfEvent",!1,(function(e){t.isAsync?setTimeout((function(){return e.perfEvent(t)}),0):e.perfEvent(t)})))}}))}return e.__ieDyn=1,e}(),Hr=function(e){function t(){var n=e.call(this)||this;return ue(t,n,(function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],2)}e.initialize=function(e,n,r,i){t.initialize(e,n,r||new Jt(e),i||new zr(e))},e.track=function(r){hr(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){null===r&&(n(r),lt("Invalid telemetry item")),function(e){ke(e.name)&&(n(e),lt("telemetry name required"))}(r),t.track(r)}),(function(){return{item:r}}),!r.sync)}})),n}return Object(ar.b)(t,e),t.__ieDyn=1,t}(Rr),jr=((Br={})[0]=0,Br[2]=6,Br[1]=1,Br[3]=7,Br[4098]=6,Br[4097]=1,Br[4099]=7,Br);Boolean(Ot()),Boolean(Ct());function Vr(e){return!(""===e||ke(e))}function Kr(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}function qr(e){return!!(e&&He(e)&&e>=1&&e<=4)}function Jr(e,t,n){if(!t&&!Vr(t)||"string"!=typeof e)return null;var r=typeof t;if("string"===r||"number"===r||"boolean"===r||We(t))t={value:t};else if("object"!==r||K.e.call(t,"value")){if(ke(t.value)||""===t.value||!ze(t.value)&&!He(t.value)&&!je(t.value)&&!We(t.value))return null}else t={value:n?JSON.stringify(t):t};if(We(t.value)&&!Zr(t.value))return null;if(!ke(t.kind)){if(We(t.value)||!$r(t.kind))return null;t.value=t.value.toString()}return t}function Gr(e,t,n){var r=-1;if(!xe(e))if(t>0&&(32===t?r=8192:t<=13&&(r=t<<5)),function(e){if(e>=0&&e<=9)return!0;return!1}(n))-1===r&&(r=0),r|=n;else{var i=jr[ei(e)]||-1;-1!==r&&-1!==i?r|=i:6===i&&(r=i)}return r}function Qr(e,t,n,r,i){var a={},o=!1,s=0,c=arguments.length,u=Object[K.k],l=arguments;for("[object Boolean]"===u.toString.call(l[0])&&(o=l[0],s++);s<c;s++){Ae(e=l[s],(function(e,t){o&&t&&Ne(t)?We(t)?(a[e]=a[e]||[],qe(t,(function(t,n){t&&Ne(t)?a[e][n]=Qr(!0,a[e][n],t):a[e][n]=t}))):a[e]=Qr(!0,a[e],t):a[e]=t}))}return a}var Xr=Yn;function $r(e){return 0===e||e>0&&e<=13||32===e}function Zr(e){return e.length>0}function Yr(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=Xr()}function ei(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===K.j&&(t=4,We(e)?(t=4096,e.length>0&&(t|=ei(e[0]))):K.e.call(e,"value")&&(t=8192|ei(e.value)))}return t}K.l,K.j,K.l,q.b;var ti=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],ue(t,n,(function(e,t){e.logger&&e.logger.queue||(e.logger=new Jt({loggingLevelConsole:1})),e.initialize=function(n,r,i,a){hr(e,(function(){return"AppInsightsCore.initialize"}),(function(){var o=e.pluginVersionStringArr;if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var s=n.propertyStorageOverride;!s||s.getProperty&&s.setProperty||lt("Invalid property storage override passed."),n.channels&&qe(n.channels,(function(e){e&&qe(e,(function(e){if(e.identifier&&e.version){var t=e.identifier+"="+e.version;o.push(t)}}))}))}e.getWParam=function(){return"undefined"!=typeof document?0:-1},r&&qe(r,(function(e){if(e&&e.identifier&&e.version){var t=e.identifier+"="+e.version;o.push(t)}})),e.pluginVersionString=o.join(";"),e.pluginVersionStringArr=o;try{t.initialize(n,r,i,a),e.pollInternalLogs("InternalLog")}catch(t){var c=e.logger,u=At(t);-1!==u.indexOf("channels")&&(u+="\n - Channels must be provided through config.channels only!"),Qt(c,1,514,"SDK Initialization Failed - no telemetry will be sent: "+u)}}),(function(){return{config:n,extensions:r,logger:i,notificationManager:a}}))},e.track=function(n){hr(e,(function(){return"AppInsightsCore.track"}),(function(){var r=n;if(r){r.timings=r.timings||{},r.timings.trackStart=Xr(),qr(r.latency)||(r.latency=1);var i=r.ext=r.ext||{};i.sdk=i.sdk||{},i.sdk.ver="1DS-Web-JS-3.2.4";var a=r.baseData=r.baseData||{};a.properties=a.properties||{};var o=a.properties;o.version=e.pluginVersionString||o.version||""}t.track(r)}),(function(){return{item:n}}),!n.sync)}})),n}return Object(ar.b)(t,e),t.__ieDyn=1,t}(Hr),ni=or({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5});function ri(e){var t=(e.ext||{}).intweb;return t&&Vr(t.msfpc)?t.msfpc:null}function ii(e){for(var t=null,n=0;null===t&&n<e.length;n++)t=ri(e[n]);return t}var ai=function(){function e(t,n){var r=n?[].concat(n):[],i=ii(r);this.iKey=function(){return t},this.Msfpc=function(){return i||""},this.count=function(){return r.length},this.events=function(){return r},this.addEvent=function(e){return!!e&&(r.push(e),i||(i=ri(e)),!0)},this.split=function(n,a){var o;if(n<r.length){var s=r.length-n;ke(a)||(s=a<s?a:s),o=r.splice(n,s),i=ii(r)}return new e(t,o)}}return e.create=function(t,n){return new e(t,n)},e}(),oi=function(){function e(){var t=!0,n=!0,r=!0,i="use-collector-delta",a=!1;ue(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){r&&(r=!1,a||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){a||(e?(i=e,n=!0,a=!0):n=!1,t=!0)}}))}return e.__ieDyn=1,e}(),si=function(){function e(){var t={};ue(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var r=(o=e.split(","),s=[],o&&qe(o,(function(e){s.push(Xe(e))})),s);if("this-request-only"===n)return r;for(var i=1e3*parseInt(n,10),a=0;a<r.length;++a)t[r[a]]=it()+i}catch(e){return[]}var o,s;return[]},e.isTenantKilled=function(e){var n=t,r=Xe(e);return void 0!==n[r]&&n[r]>it()||(delete n[r],!1)}}))}return e.__ieDyn=1,e}();function ci(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)}var ui,li=Math.min(2e6,65e3),fi=/\./,di=function(){function e(t,n,r,i){var a=!!i,o=n,s={};ue(e,this,(function(e){function n(e,t,i,c,u,l,f){Ae(e,(function(e,d){var p=null;if(d||Vr(d)){var v=i,g=e,h=u,m=t;if(a&&!c&&fi.test(e)){var y=e.split("."),T=y.length;if(T>1){h&&(h=h.slice());for(var b=0;b<T-1;b++){var S=y[b];m=m[S]=m[S]||{},v+="."+S,h&&h.push(S)}g=y[T-1]}}if(p=!(c&&function(e,t){var n=s[e];return void 0===n&&(e.length>=7&&(n=Le(e,"ext.metadata")||Le(e,"ext.web")),s[e]=n),n}(v))&&o&&o.handleField(v,g)?o.value(v,g,d,r):Jr(g,d,r)){var _=p.value;if(m[g]=_,l&&l(h,g,p),f&&"object"==typeof _&&!We(_)){var E=h;E&&(E=E.slice()).push(g),n(d,_,v+"."+g,c,E,l,f)}}}}))}e.createPayload=function(e,t,n,r,i,a){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:r,sendType:a,sendReason:i}},e.appendPayload=function(n,r,i){var a=n&&r&&!n.overflow;return a&&hr(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=r.events(),a=n.payloadBlob,o=n.numEvents,s=!1,c=[],u=[],l=n.isBeacon,f=l?65e3:3984588,d=l?li:2e6,p=0,v=0;p<t.length;){var g=t[p];if(g){if(o>=i){n.overflow=r.split(p);break}var h=e.getEventBlob(g);if(h&&h.length<=d){var m=h.length;if(a.length+m>f){n.overflow=r.split(p);break}a&&(a+="\n"),a+=h,++v>20&&(a.substr(0,1),v=0),s=!0,o++}else h?c.push(g):u.push(g),t.splice(p,1),p--}p++}if(c&&c.length>0&&n.sizeExceed.push(ai.create(r.iKey(),c)),u&&u.length>0&&n.failedEvts.push(ai.create(r.iKey(),u)),s){n.batches.push(r),n.payloadBlob=a,n.numEvents=o;var y=r.iKey();-1===Je(n.apiKeys,y)&&n.apiKeys.push(y)}}),(function(){return{payload:n,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}})),a},e.getEventBlob=function(e){try{return hr(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+Kr(e.iKey);var r={},i=e.ext;i&&(t.ext=r,Ae(i,(function(e,t){n(t,r[e]={},"ext."+e,!0,null,null,!0)})));var a=t.data={};a.baseType=e.baseType;var o=a.baseData={};return n(e.baseData,o,"baseData",!1,["baseData"],(function(e,t,n){pi(r,e,t,n)}),!0),n(e.data,a,"data",!1,[],(function(e,t,n){pi(r,e,t,n)}),!0),JSON.stringify(t)}),(function(){return{item:e}}))}catch(e){return null}}}))}return e.__ieDyn=1,e}();function pi(e,t,n,r){if(r&&e){var i=Gr(r.value,r.kind,r.propertyType);if(i>-1){var a=e.metadata;a||(a=e.metadata={f:{}});var o=a.f;if(o||(o=a.f={}),t)for(var s=0;s<t.length;s++){var c=t[s];o[c]||(o[c]={f:{}});var u=o[c].f;u||(u=o[c].f={}),o=u}o=o[n]={},We(r.value)?o.a={t:i}:o.t=i}}}var vi=((ui={})[1]="requeue",ui[100]="requeue",ui[200]="sent",ui[8004]="drop",ui[8003]="drop",ui),gi={},hi={};function mi(e,t,n){gi[e]=t,!1!==n&&(hi[t]=e)}function yi(e){try{return e.responseText}catch(e){}return""}function Ti(e,t){var n=!1;if(e&&t){var r=Ye(e);if(r&&r.length>0)for(var i=t.toLowerCase(),a=0;a<r.length;a++){var o=r[a];if(o&&Ie(t,o)&&o.toLowerCase()===i){n=!0;break}}}return n}function bi(e,t,n,r){t&&n&&n.length>0&&(r&&gi[t]?(e.hdrs[gi[t]]=n,e.useHdrs=!0):e.url+="&"+t+"="+n)}mi("AuthMsaDeviceTicket","AuthMsaDeviceTicket",!1),mi("client-version","client-version"),mi("client-id","Client-Id"),mi("apikey","apikey"),mi("time-delta-to-apply-millis","time-delta-to-apply-millis"),mi("upload-time","upload-time"),mi("AuthXToken","AuthXToken");var Si=function(){function e(t,n,r,i,a){this._responseHandlers=[];var o,s,c,u,l,f,d,p="?cors=true&"+"content-type".toLowerCase()+"=application/x-json-stream",v=new si,g=!1,h=new oi,m=!1,y=0,T=!0,b=[],S={},_=[],E=null,C=!1,O=!1,w=!1;ue(e,this,(function(e){var x=!0;function k(e,t){for(var n=0,r=null,i=0;null==r&&i<e.length;)1===(n=e[i])?Ut()?r=P:Rt()&&(r=N):2===n&&Lt(t)?r=I:m&&3===n&&Ft()&&(r=D),i++;return r?{_transport:n,_isSync:t,sendPOST:r}:null}function P(e,t,n){var r=new XDomainRequest;r.open("POST",e.urlString),e.timeout&&(r.timeout=e.timeout),r.onload=function(){var e=yi(r);M(t,200,{},e),q(e)},r.onerror=function(){M(t,400,{})},r.ontimeout=function(){M(t,500,{})},r.onprogress=function(){},n?r.send(e.data):a.set((function(){r.send(e.data)}),0)}function I(e,t,n){var r,i=e.urlString,o=!1,s=!1,c=((r={body:e.data,method:"POST"}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,r);n&&(c.keepalive=!0,2===e._sendReason&&(o=!0,i+="&NoResponseBody=true")),x&&(c.credentials="include"),e.headers&&Ye(e.headers).length>0&&(c.headers=e.headers),fetch(i,c).then((function(e){var n={},r="",i=e.headers;i&&i.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){r=e})),s||(s=!0,M(t,e.status,n,r),q(r))})).catch((function(e){s||(s=!0,M(t,0,{}))})),o&&!s&&(s=!0,M(t,200,{})),!s&&e.timeout>0&&a.set((function(){s||(s=!0,M(t,500,{}))}),e.timeout)}function N(e,t,n){var r=e.urlString;function i(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var r=t.getResponseHeader(n);r&&(e[n]=Xe(r))}return e}function a(e){var t={};return e.getAllResponseHeaders?t=function(e){var t={};if(ze(e)){qe(Xe(e).split(/[\r\n]+/),(function(e){if(e){var n=e.indexOf(": ");if(-1!==n){var r=Xe(e.substring(0,n)).toLowerCase(),i=Xe(e.substring(n+1));t[r]=i}else t[Xe(e)]=1}}))}return t}(e.getAllResponseHeaders()):(t=i(t,e,"time-delta-millis"),t=i(t,e,"kill-duration"),t=i(t,e,"kill-duration-seconds")),t}function o(e,n){M(t,e.status,a(e),n)}n&&e.disableXhrSync&&(n=!1);var s=function(e,t,n,r,i,a){function o(e,t,n){try{e[t]=n}catch(e){}}void 0===r&&(r=!1),void 0===i&&(i=!1);var s=new XMLHttpRequest;return r&&o(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",r),n&&o(s,"withCredentials",n),s.open(e,t,!i),n&&o(s,"withCredentials",n),!i&&a&&o(s,"timeout",a),s}("POST",r,x,!0,n,e.timeout);Ae(e.headers,(function(e,t){s.setRequestHeader(e,t)})),s.onload=function(){var e=yi(s);o(s,e),q(e)},s.onerror=function(){o(s)},s.ontimeout=function(){o(s)},s.send(e.data)}function M(e,t,n,r){try{e(t,n,r)}catch(e){Qt(s,2,518,At(e))}}function D(e,t,n){var r=200,i=e._thePayload,a=e.urlString+"&NoResponseBody=true";try{var o=xt();if(!o.sendBeacon(a,e.data))if(i){var c=[];qe(i.batches,(function(e){if(c&&e&&e.count()>0){for(var t=e.events(),n=0;n<t.length;n++)if(!o.sendBeacon(a,E.getEventBlob(t[n]))){c.push(e.split(n));break}}else c.push(e.split(0))})),J(c,8003,i.sendType,!0)}else r=0}catch(e){Xt(s,"Failed to send telemetry using sendBeacon API. Ex:"+At(e)),r=0}finally{M(t,r,{},"")}}function A(e){return 2===e||3===e}function F(e){return O&&A(e)&&(e=2),e}function L(){return!g&&y<n}function U(){var e=_;return _=[],e}function R(e,t,n){var r=!1;return e&&e.length>0&&!g&&c[t]&&E&&(r=0!==t||L()&&(n>0||h.allowRequestSending())),r}function W(e){var t={};return e&&qe(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function B(e,n,r,i,a){if(e&&0!==e.length)if(g)J(e,1,i);else{i=F(i);try{var o=e,l=0!==i;hr(u,(function(){return"HttpManager:_sendBatches"}),(function(o){o&&(e=e.slice(0));for(var s=[],u=null,f=Xr(),d=c[i]||(l?c[1]:c[0]),p=(O||A(i)||d&&3===d._transport)&&!T&&m&&Ft();R(e,i,n);){var g=e.shift();g&&g.count()>0&&(v.isTenantKilled(g.iKey())?s.push(g):(u=u||E.createPayload(n,r,l,p,a,i),E.appendPayload(u,g,t)?null!==u.overflow&&(e=[u.overflow].concat(e),u.overflow=null,j(u,f,Xr(),a),f=Xr(),u=null):(j(u,f,Xr(),a),f=Xr(),e=[g].concat(e),u=null)))}u&&j(u,f,Xr(),a),e.length>0&&(_=e.concat(_)),J(s,8004,i)}),(function(){return{batches:W(o),retryCount:n,isTeardown:r,isSynchronous:l,sendReason:a,useSendBeacon:A(i),sendType:i}}),!l)}catch(e){Qt(s,2,48,"Unexpected Exception sending batch: "+At(e))}}}function z(e,t){var n={url:p,hdrs:{},useHdrs:!1};t?(n.hdrs=Qr(n.hdrs,S),n.useHdrs=Ye(n.hdrs).length>0):Ae(S,(function(e,t){hi[e]?bi(n,hi[e],t,!1):(n.hdrs[e]=t,n.useHdrs=!0)})),bi(n,"client-id","NO_AUTH",t),bi(n,"client-version","1DS-Web-JS-3.2.4",t);var r="";qe(e.apiKeys,(function(e){r.length>0&&(r+=","),r+=e})),bi(n,"apikey",r,t),bi(n,"upload-time",it().toString(),t);var i=function(e){for(var t=0;t<e.batches.length;t++){var n=e.batches[t].Msfpc();if(n)return encodeURIComponent(n)}return""}(e);if(Vr(i)&&(n.url+="&ext.intweb.msfpc="+i),h.shouldAddClockSkewHeaders()&&bi(n,"time-delta-to-apply-millis",h.getClockSkewHeaderValue(),t),u.getWParam){var a=u.getWParam();a>=0&&(n.url+="&w="+a)}for(var o=0;o<b.length;o++)n.url+="&"+b[o].name+"="+b[o].value;return n}function H(e,t,n){e[t]=e[t]||{},e[t][o.identifier]=n}function j(t,n,i,a){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var l=!!e.sendHook,p=c[t.sendType];!A(t.sendType)&&t.isBeacon&&2===t.sendReason&&(p=c[2]||c[3]||p);var g=w;(t.isBeacon||3===p._transport)&&(g=!1);var m=z(t,g);g=g||m.useHdrs;var b=Xr();hr(u,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var c=0;c<t.batches.length;c++)for(var S=t.batches[c].events(),_=0;_<S.length;_++){var E=S[_];if(C){var w=E.timings=E.timings||{};H(w,"sendEventStart",b),H(w,"serializationStart",n),H(w,"serializationCompleted",i)}E.sendAttempt>0?E.sendAttempt++:E.sendAttempt=1}J(t.batches,1e3+(a||0),t.sendType,!0);var x={data:t.payloadBlob,urlString:m.url,headers:m.hdrs,_thePayload:t,_sendReason:a,timeout:f};xe(d)||(x.disableXhrSync=!!d),g&&(Ti(x.headers,"cache-control")||(x.headers["cache-control"]="no-cache, no-store"),Ti(x.headers,"content-type")||(x.headers["content-type"]="application/x-json-stream"));var k=null;p&&(k=function(n){h.firstRequestSent();var i=function(n,i){!function(t,n,i,a){var s=9e3,c=null,u=!1,l=!1;try{var f=!0;if(typeof t!==K.l){if(n){h.setClockSkew(n["time-delta-millis"]);var d=n["kill-duration"]||n["kill-duration-seconds"];qe(v.setKillSwitchTenants(n["kill-tokens"],d),(function(e){qe(i.batches,(function(t){if(t.iKey()===e){c=c||[];var n=t.split(0);i.numEvents-=n.count(),c.push(n)}}))}))}if(200==t||204==t)return void(s=200);((g=t)>=300&&g<500&&408!=g&&429!=g||501==g||505==g||i.numEvents<=0)&&(f=!1),s=9e3+t%1e3}if(f){s=100;var p=i.retryCnt;0===i.sendType&&(p<r?(u=!0,V((function(){0===i.sendType&&y--,B(i.batches,p+1,i.isTeardown,O?2:i.sendType,5)}),O,ci(p))):(l=!0,O&&(s=8001)))}}finally{u||(h.setClockSkew(),function(t,n,r,i){try{i&&o._backOffTransmission(),200===n&&(i||t.isSync||o._clearBackOff(),function(e){if(C){var t=Xr();qe(e,(function(e){var n,r;e&&e.count()>0&&(n=e.events(),r=t,C&&qe(n,(function(e){H(e.timings=e.timings||{},"sendEventCompleted",r)})))}))}}(t.batches)),J(t.batches,n,t.sendType,!0)}finally{0===t.sendType&&(y--,5!==r&&e.sendQueuedRequests(t.sendType,r))}}(i,s,a,l)),J(c,8004,i.sendType)}var g}(n,i,t,a)},c=t.isTeardown||t.isSync;try{p.sendPOST(n,i,c),e.sendListener&&e.sendListener(x,n,c,t.isBeacon)}catch(e){Xt(s,"Unexpected exception sending payload. Ex:"+At(e)),M(i,0,{})}}),hr(u,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(k)if(0===t.sendType&&y++,l&&!t.isBeacon&&3!==p._transport){var n={data:x.data,urlString:x.urlString,headers:Qr({},x.headers),timeout:x.timeout,disableXhrSync:x.disableXhrSync},r=!1;hr(u,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){r=!0,T||e._thePayload||(e._thePayload=e._thePayload||x._thePayload,e._sendReason=e._sendReason||x._sendReason),k(e)}),t.isSync||t.isTeardown)}catch(e){r||k(x)}}))}else k(x)}))}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:i,sendReason:a}}),t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&J(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&J(t.failedEvts,8002,t.sendType)}function V(e,t,n){t?e():a.set(e,n)}function q(t){var n=e._responseHandlers;try{for(var r=0;r<n.length;r++)try{n[r](t)}catch(e){Qt(s,1,519,"Response handler failed: "+e)}if(t){var i=JSON.parse(t);Vr(i.webResult)&&Vr(i.webResult.msfpc)&&l.set("MSFPC",i.webResult.msfpc,31536e3)}}catch(e){}}function J(e,t,n,r){if(e&&e.length>0&&i){var a=i[function(e){var t=vi[e];Vr(t)||(t="oth",e>=9e3&&e<=9999?t="rspFail":e>=8e3&&e<=8999?t="drop":e>=1e3&&e<=1999&&(t="send"));return t}(t)];if(a){var o=0!==n;hr(u,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){V((function(){try{a.call(i,e,t,o,n)}catch(e){Qt(s,1,74,"send request notification failed: "+e)}}),r||o,0)}),(function(){return{batches:W(e),reason:t,isSync:o,sendSync:r,sendType:n}}),!o)}}}e.initialize=function(e,t,n,r,i){var a;i||(i={}),p=e+p,w=!!xe(i.avoidOptions)||!i.avoidOptions,u=t,l=t.getCookieMgr(),C=!u.config.disableEventTimings;var v=!!u.config.enableCompoundKey;s=(o=n).diagLog();var g=i.valueSanitizer,h=i.stringifyObjects;xe(i.enableCompoundKey)||(v=!!i.enableCompoundKey),f=i.xhrTimeout,d=i.disableXhrSync,m=!Mt(),E=new di(u,g,h,v);var y=r,b=i.alwaysUseXhrOverride?r:null,S=i.alwaysUseXhrOverride?r:null;if(!r){T=!1;var _=kt();_&&_.protocol&&"file:"===_.protocol.toLowerCase()&&(x=!1);var O=[];O=Mt()?[2,1]:[1,2,3];var P=i.transports;P&&(He(P)?O=[P].concat(O):We(P)&&(O=P.concat(O))),r=k(O,!1),y=k(O,!0),r||Xt(s,"No available transport to send events")}(a={})[0]=r,a[1]=y||k([1,2,3],!0),a[2]=b||k([3,2],!0)||y||k([1],!0),a[3]=S||k([2,3],!0)||y||k([1],!0),c=a},e._getDbgPlgTargets=function(){return[c[0],v,E,c]},e.addQueryStringParameter=function(e,t){for(var n=0;n<b.length;n++)if(b[n].name===e)return void(b[n].value=t);b.push({name:e,value:t})},e.addHeader=function(e,t){S[e]=t},e.canSendRequest=function(){return L()&&h.allowRequestSending()},e.sendQueuedRequests=function(e,t){xe(e)&&(e=0),O&&(e=F(e),t=2),R(_,e,0)&&B(U(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!g&&0===y&&0===_.length},e.setUnloading=function(e){O=e},e.addBatch=function(e){if(e&&e.count()>0){if(v.isTenantKilled(e.iKey()))return!1;_.push(e)}return!0},e.teardown=function(){_.length>0&&B(U(),0,!0,2,2)},e.pause=function(){g=!0},e.resume=function(){g=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&(ke(t)&&(t=1),O&&(t=F(t),n=2),B([e],0,!1,t,n||0))}}))}return e.__ieDyn=1,e}();function _i(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout(e,t,n)}function Ei(e){clearTimeout(e)}function Ci(e,t){return{set:e||_i,clear:t||Ei}}var Oi=function(e){function t(){var n,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="3.2.4";var i,a,o,s,c,u,l,f=!1,d=[],p=null,v=!1,g=0,h=500,m=0,y=1e4,T={},b="REAL_TIME",S=null,_=null,E=0,C=0,O={},w=-1,x=!0,k=!1,P=6,I=2;return ue(t,r,(function(e,t){function r(e){"beforeunload"!==(e||Ct().event).type&&(k=!0,a.setUnloading(k)),W(2,2)}function N(e){k=!1,a.setUnloading(k)}function M(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,x&&(e.ext=vt(e.ext),e.baseData&&(e.baseData=vt(e.baseData)),e.data&&(e.data=vt(e.data))),e.sync)if(E||v)e.latency=3,e.sync=!1;else if(a)return x&&(e=vt(e)),void a.sendSynchronousBatch(ai.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var n=e.latency,r=m,i=y;4===n&&(r=g,i=h);var o=!1;if(r<i)o=!H(e,t);else{var s=1,c=20;4===n&&(s=4,c=1),o=!0,function(e,t,n,r){for(;n<=t;){var i=B(e,t,!0);if(i&&i.count()>0){var a=i.split(0,r),o=a.count();if(o>0)return 4===n?g-=o:m-=o,Q("eventsDiscarded",[a],ni.QueueFull),!0}n++}return j(),!1}(e.iKey,e.latency,s,c)&&(o=!H(e,t))}o&&G("eventsDiscarded",[e],ni.QueueFull)}function D(e,t,n){var r=V(e,t,n);return a.sendQueuedRequests(t,n),r}function A(){return m>0}function F(){if(w>=0&&V(w,0,c)&&a.sendQueuedRequests(0,c),g>0&&!_&&!v){var e=T[b][2];e>=0&&(_=U((function(){_=null,D(4,0,1),F()}),e))}var t=T[b][1];!S&&!p&&t>=0&&!v&&(A()?S=U((function(){S=null,D(0===C?3:1,0,1),C++,C%=2,F()}),t):C=0)}function L(){n=null,f=!1,d=[],p=null,v=!1,g=0,h=500,m=0,y=1e4,T={},b="REAL_TIME",S=null,_=null,E=0,C=0,i=null,O={},o=void 0,s=0,w=-1,c=null,x=!0,k=!1,P=6,I=2,u=null,l=Ci(),a=new Si(500,2,1,{requeue:q,send:X,sent:$,drop:Z,rspFail:Y,oth:ee},l),K(),O[4]={batches:[],iKeyMap:{}},O[3]={batches:[],iKeyMap:{}},O[2]={batches:[],iKeyMap:{}},O[1]={batches:[],iKeyMap:{}},te()}function U(e,t){0===t&&E&&(t=1);var n=1e3;return E&&(n=ci(E-1)),l.set(e,t*n)}function R(){return null!==S&&(l.clear(S),S=null,C=0,!0)}function W(e,t){R(),p&&(l.clear(p),p=null),v||D(1,e,t)}function B(e,t,n){var r=O[t];r||(r=O[t=1]);var i=r.iKeyMap[e];return!i&&n&&(i=ai.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function z(t,n){a.canSendRequest()&&!E&&(o>0&&m>o&&(n=!0),n&&null==p&&e.flush(t,null,20))}function H(e,t){x&&(e=vt(e));var n=e.latency,r=B(e.iKey,n,!0);return!!r.addEvent(e)&&(4!==n?(m++,t&&0===e.sendAttempt&&z(!e.sync,s>0&&r.count()>=s)):g++,!0)}function j(){for(var e=0,t=0,n=function(n){var r=O[n];r&&r.batches&&qe(r.batches,(function(r){4===n?e+=r.count():t+=r.count()}))},r=1;r<=4;r++)n(r);m=t,g=e}function V(t,n,r){var i=!1,o=0===n;return!o||a.canSendRequest()?hr(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=4;n>=t;){var r=O[n];r&&r.batches&&r.batches.length>0&&(qe(r.batches,(function(t){a.addBatch(t)?i=i||t&&t.count()>0:e=e.concat(t.events()),4===n?g-=t.count():m-=t.count()})),r.batches=[],r.iKeyMap={}),n--}e.length>0&&G("eventsDiscarded",e,ni.KillSwitch),i&&w>=t&&(w=-1,c=0)}),(function(){return{latency:t,sendType:n,sendReason:r}}),!o):(w=w>=0?Math.min(w,t):t,c=Math.max(c,r)),i}function K(){(T={}).REAL_TIME=[2,1,0],T.NEAR_REAL_TIME=[6,3,0],T.BEST_EFFORT=[18,9,0]}function q(t,n){var r=[],i=P;k&&(i=I),qe(t,(function(t){t&&t.count()>0&&qe(t.events(),(function(t){t&&(t.sync&&(t.latency=4,t.sync=!1),t.sendAttempt<i?(Yr(t,e.identifier),M(t,!1)):r.push(t))}))})),r.length>0&&G("eventsDiscarded",r,ni.NonRetryableStatus),k&&W(2,2)}function J(t,n){var r=e._notificationManager||{},i=r[t];if(i)try{i.apply(r,n)}catch(n){Qt(e.diagLog(),1,74,t+" notification failed: "+n)}}function G(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&J(e,[t].concat(n))}function Q(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&qe(t,(function(t){t&&t.count()>0&&J(e,[t.events()].concat(n))}))}function X(e,t,n){e&&e.length>0&&J("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])}function $(e,t){Q("eventsSent",e,t),F()}function Z(e,t){Q("eventsDiscarded",e,t>=8e3&&t<=8999?t-8e3:ni.Unknown)}function Y(e){Q("eventsDiscarded",e,ni.NonRetryableStatus),F()}function ee(e,t){Q("eventsDiscarded",e,ni.Unknown),F()}function te(){s=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,y/6)}L(),e._getDbgPlgTargets=function(){return[a]},e.initialize=function(s,c,f){hr(c,(function(){return"PostChannel:initialize"}),(function(){var d=c;t.initialize(s,c,f);try{c.addUnloadCb;u=jn(Pn(e.identifier),c.evtNamespace&&c.evtNamespace());var p=e._getTelCtx();s.extensionConfig[e.identifier]=s.extensionConfig[e.identifier]||{},n=p.getExtCfg(e.identifier),l=Ci(n.setTimeoutOverride,n.clearTimeoutOverride),x=!n.disableOptimizeObj&&!!_t("chrome"),function(e){var t=e.getWParam;e.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(d),n.eventsLimitInMem>0&&(y=n.eventsLimitInMem),n.immediateEventLimit>0&&(h=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(o=n.autoFlushEventsLimit),He(n.maxEventRetryAttempts)&&(P=n.maxEventRetryAttempts),He(n.maxUnloadEventRetryAttempts)&&(I=n.maxUnloadEventRetryAttempts),te(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(i=n.httpXHROverride),Vr(s.anonCookieName)&&a.addQueryStringParameter("anoncknm",s.anonCookieName),a.sendHook=n.payloadPreprocessor,a.sendListener=n.payloadListener;var v=n.overrideEndpointUrl?n.overrideEndpointUrl:s.endpointUrl;e._notificationManager=s.extensionConfig.NotificationManager,a.initialize(v,e.core,e,i,n);var g=s.disablePageUnloadEvents||[];Qn(r,g,u),function e(t,n,r){var i=jn(Nn,r),a=Jn(["pagehide"],t,n,i);return n&&-1!==Je(n,"visibilitychange")||(a=Jn(["visibilitychange"],(function(e){var n=Ot();t&&n&&"hidden"===n.visibilityState&&t(e)}),n,i)||a),!a&&n&&(a=e(t,null,r)),a}(r,g,u),function e(t,n,r){var i=jn(Mn,r),a=Jn(["pageshow"],t,n,i);return!(a=Jn(["visibilitychange"],(function(e){var n=Ot();t&&n&&"visible"===n.visibilityState&&t(e)}),n,i)||a)&&n&&(a=e(t,null,r)),a}(N,s.disablePageShowEvents,u)}catch(t){throw e.setInitialized(!1),t}}),(function(){return{coreConfig:s,core:c,extensions:f}}))},e.processTelemetry=function(t,r){Yr(t,e.identifier);var i=(r=e._getTelCtx(r)).getExtCfg(e.identifier),a=!!n.disableTelemetry;i&&(a=a||!!i.disableTelemetry);var o=t;a||f||(n.overrideInstrumentationKey&&(o.iKey=n.overrideInstrumentationKey),i&&i.overrideInstrumentationKey&&(o.iKey=i.overrideInstrumentationKey),M(o,!0),k?W(2,2):F()),e.processNext(o,r)},e._doTeardown=function(e,t){W(2,2),f=!0,a.teardown(),Gn(["beforeunload","unload","pagehide"],null,u),function(e,t){var n=jn(Nn,t);Gn(["pagehide"],e,n),Gn(["visibilitychange"],null,n)}(null,u),function(e,t){var n=jn(Mn,t);Gn(["pageshow"],e,n),Gn(["visibilitychange"],null,n)}(null,u),L()},e.setEventQueueLimits=function(e,t){y=e>0?e:1e4,o=t>0?t:0,te();var n=m>e;if(!n&&s>0)for(var r=1;!n&&r<=3;r++){var i=O[r];i&&i.batches&&qe(i.batches,(function(e){e&&e.count()>=s&&(n=!0)}))}z(!0,n)},e.pause=function(){R(),v=!0,a.pause()},e.resume=function(){v=!1,a.resume(),F()},e.addResponseHandler=function(e){a._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){R(),K(),b="REAL_TIME",F(),Ae(e,(function(e,t){var n=t.length;if(n>=2){var r=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var i=t[0]/t[1];t[0]=Math.ceil(i)*t[1]}r>=0&&t[1]>=0&&r>t[1]&&(r=t[1]),t.push(r),T[e]=t}}))},e.flush=function(e,t,n){if(void 0===e&&(e=!0),!v)if(n=n||1,e)null==p?(R(),V(1,0,n),p=U((function(){p=null,function e(t,n){D(1,0,n),j(),function e(t){a.isCompletelyIdle()?t():p=U((function(){p=null,e(t)}),.25)}((function(){t&&t(),d.length>0?p=U((function(){p=null,e(d.shift(),n)}),0):(p=null,F())}))}(t,n)}),0)):d.push(t);else{var r=R();D(1,1,n),null!=t&&t(),r&&F()}},e.setMsaAuthTicket=function(e){a.addHeader("AuthMsaDeviceTicket",e)},e.hasEvents=A,e._setTransmitProfile=function(e){b!==e&&void 0!==T[e]&&(R(),b=e,F())},e._backOffTransmission=function(){E<4&&(E++,R(),F())},e._clearBackOff=function(){E&&(E=0,R(),F())},et(e,"_setTimeoutOverride",(function(){return l.set}),(function(e){l=Ci(e,l.clear)})),et(e,"_clearTimeoutOverride",(function(){return l.clear}),(function(e){l=Ci(l.set,e)}))})),r}return Object(ar.b)(t,e),t.__ieDyn=1,t}(Dr),wi=function(){function e(e,t,n){this.start=Date.now(),this.name=e,this.isAsync=!0===n,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),xi=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,n){return"HttpManager:_sendBatches"===e||"HttpManager:_sendBatchesNotification"===e?new wi(e,t,n):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case"HttpManager:_sendBatches":this.handleSendBatches(e);break;case"HttpManager:_sendBatchesNotification":this.handleSendBatchesNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){this._callbacks.requestProcessingStats&&this._callbacks.requestProcessingStats(e.time||0,0)},e.prototype.handleSendBatchesNotification=function(e){if(this._callbacks.requestProcessingStats&&e.payload){var t=e.payload();if(t.batches&&t.reason&&t.reason>=1e3&&t.reason<=1999){var n=0;for(var r in t.batches)n+=t.batches[r].evts.length;this._callbacks.requestProcessingStats(0,n)}}},e}();function ki(e,t,n,r){var i={instrumentationKey:t,endpointUrl:n,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:e.httpXHROverride,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0,disableOptimizeObj:!0},disableCookiesUsage:!0,extensionConfig:u({},e.extensionConfig)};e.stats&&e.stats.networkStats&&i.channelConfiguration&&(i.channelConfiguration.payloadListener=function(t,n){var r,i=n||t;i.data&&(null===(r=e.stats)||void 0===r||r.networkStats(i.data.length))});var a=new Ii;return a.initialize(i,r),a.setUploadFrequency(e.uploadFrequency),e.notificationListener&&a.addNotificationListener(e.notificationListener),e.stats&&a.setPerfMgr(new xi(e.stats)),a}var Pi=function(e,t){t&&t.addNotificationListener({eventsSent:function(t){d(2,2,(function(){return"Successfully sent ".concat(t.length," event(s)")})),d(3,2,(function(){return"Sent event(s) details : ".concat(JSON.stringify(t,null,2))})),e.eventsSent+=t.length},eventsDiscarded:function(t,n){d(0,2,(function(){return"Discarded ".concat(t.length," event(s) because ").concat(n)})),d(3,2,(function(){return"Discarded event(s) details : ".concat(JSON.stringify(t,null,2))})),e.eventsDiscarded+=t.length}})},Ii=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.initialize=function(t,n){this._postChannel=new Oi;var r=[];n&&(r=r.concat(n)),t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=u(u({},t.channelConfiguration),t.extensionConfig[this._postChannel.identifier]);try{e.prototype.initialize.call(this,t,r)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,r={};r.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(r),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(ti),Ni=function(e){function t(t,n){var r,i,a=e.call(this,t,n)||this;a.sendTelemetryEvent=function(e){return P((function(){var t=a.getOneDSTelemetryEvent(e);t&&r&&r.track(t)}),void 0)},a.sendCustomerContent=function(e){return P((function(){var t=a.getOneDSCustomerContent(e);t&&i&&i.track(t)}),void 0)},a.sendNonStandardEvent=function(e,t){var n=!1;s.forEach((function(r){if(r.canHandle(t))return r.processEvent(e),void(n=!0)})),n||d(0,1,(function(){return"Missing Handler for "+t+"to process"+e.eventName}))},a.flush=function(e){null==r||r.flush(e),null==i||i.flush(e),s.forEach((function(t){t.flush(e)}))},a.shutdown=function(){try{null==r||r.shutdown(),null==i||i.shutdown(),s.forEach((function(e){e.shutdown()}))}catch(e){d(0,2,(function(){return"An error occurred on shutdown"}))}};var o=n.plugins||[],s=n.nonStandardEventHandlers||[];if(s.forEach((function(e){e.initialize(a,n)})),!n.endpointUrl)throw new Error("Missing Endpoint Url");return r=ki(n,"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",n.endpointUrl,o),n.enableCustomerContent&&n.endpointUrl===M.PUBLIC&&(i=ki(n,"b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121",M.CUSTOMER_CONTENT,o)),n.disableStatsTracking||(Pi(a,r),Pi(a,i)),a}return c(t,e),t}(dr);function Mi(e){return{name:"App",contract:{name:"App",dataFields:[Bi("Name",e.name),Bi("Platform",e.platform),Bi("Version",e.version)]}}}function Di(e){return{name:"Session",contract:{name:"Session",dataFields:[Bi("Id",e.sessionId),Bi("EcsETag",e.flightsImpressionId)]}}}function Ai(e){return{name:"Release",contract:{name:"Release",dataFields:[Bi("AudienceGroup",e.audienceGroup)]}}}function Fi(e){return{name:"Browser",contract:{name:"Browser",dataFields:[Bi("Name",e.browserName),Bi("Version",e.browserVersion)]}}}function Li(e){return{name:"Culture",contract:{name:"Culture",dataFields:[Bi("UiLanguage",e.appLanguage)]}}}function Ui(e){return{name:"User",contract:{name:"User",dataFields:[Bi("PrimaryIdentityHash",e.loggableUserId),Bi("PrimaryIdentitySpace",e.loggableUserIdSpace),Bi("TenantId",e.omsTenantId),zi("IsAnonymous",e.isAnonymousUser)]}}}function Ri(e){return{name:"WAC",contract:{name:"WAC",dataFields:[Bi("Host",e.host),Bi("ServerDocId",e.serverDocId),Bi("Datacenter",e.datacenter),zi("IsSynthetic",e.isSynthetic),zi("IsBusinessUser",e.isBusinessUser),zi("IsEdu",e.isEduUser),Bi("ApplicationMode",e.applicationMode),Bi("ApplicationModeExtended",e.applicationModeExtended),Bi("BrowserLanguage",e.browserLanguage),Bi("ContentLanguage",e.contentLanguage),Bi("OsVersion",e.osVersion),Bi("Ring",e.ring),Bi("UiHost",e.uiHost),Bi("SessionOrigin",e.sessionOrigin),Bi("UiHostIntegrationType",e.uiHostIntegrationType)]}}}var Wi;function Bi(e,t){return null==t?{name:e,string:""}:{name:e,string:t}}function zi(e,t){return null==t?{name:e,bool:!1}:{name:e,bool:t}}!function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime"}(Wi||(Wi={}));var Hi=Wi.msoulscat_MSOSP_OTelJS;var ji={alwaysOnMetadata:void 0,useOneDsLogger:!0,logToUls:!1,oneDsTransportSettings:{enabled:!0,collectorEndpointEnum:"PUBLIC",collectorEndpointUrl:"",eventUploadFrequency:2e3,cacheMemorySizeLimitInNumberOfEvents:1e4,enableCustomerContent:!1,enableDNM:!1},throttlingSettings:{enabled:!0,totalEventsThrottlePerSec:100,singleEventThrottlePerSec:20,eventNamesToBeSuppressedCommaSeparated:""},statsSettings:{taskDurationLogFrequency:20,durationThreshold:100,reportTaskDetails:!1,sessionDurationCutoff:1e4},samplingSettings:{enabled:!1,sampleRate:.02}};function Vi(e,t){return null==e?t:e}function Ki(e,t){return null==e?t:e}function qi(e,t){return null==e?t:e}function Ji(e){var t=[];if(e)for(var n=0;n<e.length;n+=1)t.push.apply(t,Gi(e[n]));return t}function Gi(e,t){e.name||(e.name="DataFieldNameIsMissing");var n=function(e){if(null!=e.string)return 2;if(null!=e.bool)return 1;if(null!=e.int64&&!isNaN(e.int64))return 3;if(null!=e.double&&!isNaN(e.double))return 4;if(null!=e.contract)return 6;if(null!=e.date&&!isNaN(e.date))return 5;return 0}(e),r=t?t+"."+e.name:e.name;switch(n){case 0:return[];case 1:return[_(r,e.bool)];case 2:return[O(r,e.string)];case 3:return[E(r,Math.floor(e.int64))];case 4:return[C(r,e.double)];case 5:return[O(r,new Date(e.date).toISOString())];case 6:return function(e,t){var n=[];if(t.dataFields)for(var r=0;r<t.dataFields.length;r+=1)n.push.apply(n,Gi(t.dataFields[r],e));return n}(r,e.contract);default:throw new Error(n)}}var Qi=function(){function e(){this.name="Sampler",this.sampleRate=.02}return e.prototype.enableWithIdentifier=function(e,t){return!("string"!=typeof t||t.length<4)&&(this.samplingValue=function(e){return function(e){for(var t=5381,n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return t>>>0}(e)%1e3/1e3}(t),this.samplingKey=e,!0)},e.prototype.enableWithSamplingValue=function(e,t){return!(isNaN(t)||t<0||t>=1)&&(this.samplingValue=t,this.samplingKey=e,!0)},e.prototype.enableWithRandomValue=function(){var e=new Uint32Array(1);return!("object"!=typeof window||!window.crypto)&&(window.crypto.getRandomValues(e),this.samplingValue=e[0]%1e3/1e3,this.samplingKey="Random",!0)},e.prototype.setSampleRate=function(e){return e>=0&&e<=1&&(this.sampleRate=e,!0)},e.prototype.getSamplingValue=function(){return this.samplingValue},e.prototype.isMeasuresEnabled=function(){return void 0===this.samplingValue||this.samplingValue<this.sampleRate},e.prototype.processEvent=function(e){var t=e.eventFlags.samplingPolicy;return void 0===this.samplingValue||void 0===t||(1===t?!!this.isMeasuresEnabled()&&(this.addSampleRateField(e,this.sampleRate,this.samplingValue),!0):2!==t&&(this.addSampleRateField(e,1,this.samplingValue),!0))},e.prototype.addSampleRateField=function(e,t,n){e.eventContract||(e.eventContract={name:"",dataFields:[]});var r=e.eventContract.dataFields;r.push(C("Event.SampleRate",t)),r.push(C("Session.SamplingValue",n)),this.samplingKey&&r.push(O("Session.SamplingKey",this.samplingKey)),r.push(_("Session.MeasuresEnabled",this.isMeasuresEnabled()))},e}();function Xi(e){return"number"==typeof e}var $i,Zi,Yi=function(){function e(e,t){this._sinkName=e,this._telemetrySink=t,this.name="EventThrottler",this._totalEventsInLastInterval=0,this._singleEventInLastInterval={},this._eventThrottleReported={},this._lastIntervalStart=Date.now(),this._maxNamedEventsPerSecond={}}return e.prototype.setSingleEventThrottle=function(e){this._maxSingleEventPerSecond=e},e.prototype.setTotalEventThrottle=function(e){this._maxTotalEventsPerSecond=e},e.prototype.setNamedEventThrottle=function(e,t){this._maxNamedEventsPerSecond[e]=t},e.prototype.processEvent=function(e){var t=e.eventName;if("Office.Telemetry.OTelJS.EventThrottled"===t)return!0;var n=!0;return Date.now()-this._lastIntervalStart>1e3&&(this._lastIntervalStart=Date.now(),this._totalEventsInLastInterval=0,this._singleEventInLastInterval={}),this._singleEventInLastInterval[t]=this._singleEventInLastInterval[t]+1||1,t in this._maxNamedEventsPerSecond?n=this.applyThrottle(this._singleEventInLastInterval[t],this._maxNamedEventsPerSecond[t],"MaxNamedEventsPerSecond",t):Xi(this._maxSingleEventPerSecond)&&(n=this.applyThrottle(this._singleEventInLastInterval[t],this._maxSingleEventPerSecond,"MaxSingleEventsPerSecond",t)),Xi(this._maxTotalEventsPerSecond)&&(this._totalEventsInLastInterval++,n&&(n=this.applyThrottle(this._totalEventsInLastInterval,this._maxTotalEventsPerSecond,"MaxTotalEventsPerSecond",t))),n},e.prototype.applyThrottle=function(e,t,n,r){return!(e>t)||(e===t+1&&this._telemetrySink&&!this._eventThrottleReported[r]&&(this._eventThrottleReported[r]=!0,this._telemetrySink.sendTelemetryEvent({eventName:"Office.Telemetry.OTelJS.EventThrottled",telemetryProperties:{ariaTenantToken:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",nexusTenantToken:1723},eventFlags:{diagnosticLevel:110},dataFields:[O("SinkName",this._sinkName||""),O("ThrottledEvent.Name",r),E(n,t)]})),d(2,1,(function(){return"1DS Sink Event Throttle: Exceeded ".concat(t," ").concat(n,": ").concat(r)})),!1)},e}(),ea=function(){function e(e){this.stats=void 0,this.taskStats=void 0,this.config=e,this.logOtelEvent=void 0,this.resetStats()}return e.prototype.setLogOtelTelemetryEventFunc=function(e){this.logOtelEvent=e},e.prototype.resetStats=function(){this.stats={processed:0,sent:0,throttled:0,sampledNotSent:0,dropped:0,droppedDetails:{},eventsProcessingTime:0,taskExecutionTime:0,taskExecutionCount:0,bytesOverWire:0,eventSerializationTime:0,eventTransmissionTime:0,oteljsVersion:"4.11.0"},this.taskStats={taskExecutionTimes:[],taskExecutionTimesDetails:[]}},e.prototype.logSessionStatsViaUls=function(){this.computeSessionAverages(),o.sendTraceTag(this.config.tags.sessionStats,Hi,r.Info,JSON.stringify(this.stats))},e.prototype.logSessionStatsViaOTel=function(){if(this.computeSessionAverages(),this.logOtelEvent){var e={eventName:this.config.tags.sessionStatsEventName,dataFields:[{name:"Processed",value:this.stats.processed,dataType:3},{name:"Sent",value:this.stats.sent,dataType:3},{name:"Throttled",value:this.stats.throttled,dataType:3},{name:"SampledNotSent",value:this.stats.sampledNotSent,dataType:3},{name:"Dropped",value:this.stats.dropped,dataType:3},{name:"EventsProcessingTime",value:this.stats.eventsProcessingTime,dataType:3},{name:"TaskExecutionTime",value:this.stats.taskExecutionTime,dataType:3},{name:"TaskExecutionCount",value:this.stats.taskExecutionCount,dataType:3},{name:"BytesOverWire",value:this.stats.bytesOverWire,dataType:3},{name:"AverageProcessingTimeCostPerEvent",value:this.stats.averageProcessingTimeCostPerEvent||0,dataType:3}],eventFlags:{}};this.logOtelEvent(e)}},e.prototype.computeSessionAverages=function(){this.stats.processed>0&&(this.stats.averageTimeCostPerEvent=+((this.stats.eventsProcessingTime+this.stats.taskExecutionTime)/this.stats.processed).toFixed(3),this.stats.averageProcessingTimeCostPerEvent=+(this.stats.eventsProcessingTime/this.stats.processed).toFixed(4),this.stats.averageTaskTimeCostPerEvent=+(this.stats.taskExecutionTime/this.stats.processed).toFixed(4),this.stats.averageNetworkCostPerEvent=+(this.stats.bytesOverWire/this.stats.processed).toFixed(0))},e.prototype.logAndClearTaskStats=function(){this.taskStats.taskExecutionTimes.length<=0||(o.sendTraceTag(this.config.tags.taskStats,Hi,r.Info,this.taskStats.taskExecutionTimes.join(",")),this.config.settings.reportTaskDetails&&o.sendTraceTag(this.config.tags.taskDetailsStats,Hi,r.Info,JSON.stringify(this.taskStats.taskExecutionTimesDetails)),this.taskStats={taskExecutionTimes:[],taskExecutionTimesDetails:[]})},e.prototype.recordUploadTaskDuration=function(e,t,n,i){if(e>this.config.settings.durationThreshold&&o.sendTraceTag(this.config.tags.taskDurationThresholdExceeded,Hi,r.Info,"Task took ".concat(e," ms")),this.stats.taskExecutionTime+=e,t>0){var a=+e.toFixed(3);this.stats.taskExecutionCount+=1,this.taskStats.taskExecutionTimes.push(a),this.stats.eventSerializationTime+=n||0,this.stats.eventTransmissionTime+=i||0,this.taskStats.taskExecutionTimesDetails.push({x:Date.now(),e:t,c:a,s:n,t:i}),this.taskStats.taskExecutionTimes.length>=this.config.settings.taskDurationLogFrequency&&this.logAndClearTaskStats()}},e.prototype.checkAndLogPipelineHealth=function(){var e=Date.now()-this.config.sdkInitializationTime;this.stats.processed>0&&0===this.stats.sent&&(this.stats.dropped>0||e>this.config.settings.sessionDurationCutoff)&&o.sendTraceTag(this.config.tags.sdkHealth,Hi,r.Warning,"Telemetry pipeline might be malfunctioning: Processed=".concat(this.stats.processed,", Sent=").concat(this.stats.sent,", Dropped=").concat(this.stats.dropped,", SessionDuration=").concat(e," ms"))},e}(),ta=(($i={})[3]="App.Name",$i[4]="App.Platform",$i[5]="App.Version",$i[2]="WAC.Ring",$i[1]="Release.AudienceGroup",$i),na=function(e){var t,n,r,i=this;this.eventsProcessed=0;var a=function(e){var t,n=w(e),i=[];if(r.getPreprocessors().forEach((function(e){"EventThrottler"===e.name&&i.push(e)})),N(n,i)){var a=I(n);a.setMilliseconds(0),a.setSeconds(0),a.setMinutes(0),2===n.telemetryProperties.dnmInterval&&a.setHours(0);var o={"Event.Name":n.eventName,"Event.Source":"OTelJS","Event.Time":{value:a.toISOString(),propertyType:fr.DateTime}},s=function(e,t){var n={};return t&&t.forEach((function(t){var r=ta[t];n[r]=e[r]})),n}(r.getOneDSPersistentDataFields(),null===(t=null==e?void 0:e.telemetryProperties)||void 0===t?void 0:t.dnmAllowedPartA);for(var c in s)o[c]=s[c];if(!k(o,n.dataFields,!0,3))return void d(0,1,(function(){return"Dropping Event: "+n.eventName}));var u=function(e){if(e.telemetryProperties&&e.telemetryProperties.dnmToken)return e.telemetryProperties.dnmToken;d(0,1,(function(){return"Missing DNM Token"}))}(n);if(!u)return;return{iKey:u,name:n.eventName,data:o,time:a.toISOString(),baseType:"custom",ext:{sdk:{seq:0},utc:{eventFlags:2097152}}}}};this.initialize=function(i,a){t=a.plugins?a.plugins:[],n=ki(a,"67074e509c164bcaaf85b53c0ad0cde2-13c1c869-7901-4e72-b536-9e754e3b7413-6518",e.endpointUrl,t),a.disableStatsTracking||Pi(i,n),r=i},this.shutdown=function(){null==n||n.shutdown()},this.flush=function(e){null==n||n.flush(e)},this.canHandle=function(e){return 3===e},this.processEvent=function(e){return i.eventsProcessed++,P((function(){var t=a(e);t&&n&&(null==n||n.track(t))}),void 0)}};function ra(e){var t,n,r=(t=e.statsSettings,n={settings:t,tags:{sessionStatsEventName:"Office.Online.Telemetry.OTelJS.OneDS.Session.Stats",sessionStats:593597406,taskStats:593597407,taskDetailsStats:593597408,taskDurationThresholdExceeded:593597409,sdkHealth:593597410},sdkInitializationTime:Date.now()},new ea(n)),i=new ua({alwaysOnMetadata:e.alwaysOnMetadata,transportSettings:e.transportSettings,throttlingSettings:e.throttlingSettings,samplingSettings:e.samplingSetings,stats:r,createSinkFunc:ia,createSamplerFunc:aa,createThrottlerFunc:oa,collectorPingUrl:"https://browser.events.data.microsoft.com/ping"});return r.setLogOtelTelemetryEventFunc(i.sendOtelTelemetryEvent.bind(i)),i}function ia(e,t,n){var i=function(e,t){var n,i;i=e.collectorEndpointUrl?e.collectorEndpointUrl:function(e){var t=M[e];void 0===t&&(o.sendTraceTag(593597411,Hi,r.Error,"Unknown 1DS endpoint ".concat(e," - defaulting to Public one")),t=M.PUBLIC);return t}(e.collectorEndpointEnum);var a={endpointUrl:i,notificationListener:new sa(t),uploadFrequency:e.eventUploadFrequency,eventsLimitInMem:e.cacheMemorySizeLimitInNumberOfEvents,stats:{requestProcessingStats:function(e,n){t.recordUploadTaskDuration(e,n)},networkStats:function(e){t.stats.bytesOverWire+=e}},disableStatsTracking:!0,extensionConfig:{PostChannel:{enableCompoundKey:!0}},enableOptionalEvents:!0,nonStandardEventHandlers:[]};e.enableDNM&&(null===(n=a.nonStandardEventHandlers)||void 0===n||n.push(new na({endpointUrl:M.PUBLIC})));return a.enableCustomerContent=e.enableCustomerContent,a}(e,n);return new Ni(t||[],i)}function aa(e,t,n){var r=new Qi;return"number"==typeof n&&r.setSampleRate(n),e&&r.enableWithIdentifier("PrimaryIdentityHash",e)||t&&r.enableWithIdentifier("SessionId",t)?r:void 0}function oa(e){return new Yi("WACAriaSink",e)}!function(e){e[e.Unknown=0]="Unknown",e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.InvalidEvent=2]="InvalidEvent",e[e.SizeLimitExceeded=3]="SizeLimitExceeded",e[e.KillSwitch=4]="KillSwitch",e[e.QueueFull=5]="QueueFull"}(Zi||(Zi={}));var sa=function(){function e(e){this.reporter=e}return e.prototype.eventsSent=function(e){this.reporter.stats.sent+=e.length},e.prototype.eventsDiscarded=function(e,t){var n=Zi[t]||t.toString();this.reporter.stats.droppedDetails[n]=this.reporter.stats.droppedDetails[n]+e.length||e.length,this.reporter.stats.dropped+=e.length},e}();function ca(){return"undefined"==typeof performance||void 0===performance.now?0:performance.now()}var ua=function(){function e(e){this._processedEvent=new i,this._throttledEvent=new i,this._logger=new x(void 0,void 0,{disableValidation:!0}),this._enabled=e.transportSettings.enabled,this._throttlingEnabled=e.throttlingSettings.enabled,this._reporter=e.stats,this._collectorPingUrl=e.collectorPingUrl,this._enableCustomerContent=e.transportSettings.enableCustomerContent;var t,n=Ji((t=e.alwaysOnMetadata)?[Mi,Di,Ai,Fi,Li,Ri,Ui].map((function(e){return e(t)})):[]);this._sink=e.createSinkFunc(e.transportSettings,n,this._reporter),this._logger.addSink(this._sink),this._eventThrottler=e.createThrottlerFunc(this._sink),function(e,t){if(e.setSingleEventThrottle(t.singleEventThrottlePerSec),e.setTotalEventThrottle(t.totalEventsThrottlePerSec),t.eventNamesToBeSuppressedCommaSeparated){t.eventNamesToBeSuppressedCommaSeparated.split(",").forEach((function(t){e.setNamedEventThrottle(t,0)}))}}(this._eventThrottler,e.throttlingSettings),this._eventSampler=void 0,e.samplingSettings.enabled&&e.alwaysOnMetadata&&this.setupSampler(e.createSamplerFunc,e.alwaysOnMetadata,e.samplingSettings.sampleRate)}return e.prototype.setupSampler=function(e,t,n){this._eventSampler=e(t.loggableUserId,t.sessionId,n),this._eventSampler&&o.sendTraceTag(577275598,Hi,r.Info,"Sampler added. Measures enabled: "+this._eventSampler.isMeasuresEnabled())},e.prototype.pingCollectorPingUrl=function(){!function(e){try{var t=new XMLHttpRequest;t.open("GET",e,!0),t.onreadystatechange=function(){4===t.readyState&&(200===t.status?t.responseText.toLowerCase().indexOf("ok")>-1?o.sendTraceTag(593597389,Hi,r.Info,"Collector ping 200 OK."):o.sendTraceTag(593597390,Hi,r.Warning,"Collector ping 200 OK but with invalid response."):o.sendTraceTag(593597391,Hi,r.Warning,"Collector ping returned with HTTP "+t.status.toString()))},t.send()}catch(e){o.sendTraceTag(593597392,Hi,r.Warning,"Collector ping failed with error: "+e.toString())}}(this._collectorPingUrl)},e.prototype.pingCollectorEndpoint=function(){},e.prototype.setTenantToken=function(e,t){t&&this._logger.setTenantToken(e,t,-1)},e.prototype.setDNMToken=function(e,t){t&&this._logger.setDNMToken(e,t)},e.prototype.processEvent=function(e,t){var n=!1,r=!1,i=ca(),a=w(e);this._throttlingEnabled&&!this._eventThrottler.processEvent(a)?n=!0:this._enabled&&(this._eventSampler&&!this._eventSampler.processEvent(a)?r=!0:t(a)),this._reporter.stats.eventsProcessingTime+=ca()-i,n?(this._reporter.stats.throttled+=1,this._throttledEvent.fireEvent(e)):r?this._reporter.stats.sampledNotSent+=1:(this._reporter.stats.processed+=1,this._processedEvent.fireEvent(e))},e.prototype.sendOtelCustomerContent=function(e,t){var n=this;this._enableCustomerContent&&this._logger.sendCustomerContent&&this.processEvent(e,(function(e){e.timestamp=t,n._logger.sendCustomerContent(e)}))},e.prototype.sendOtelDirectNumeric=function(e,t){var n=this;this.processEvent(e,(function(e){e.timestamp=t,n._logger.sendNonStandardEvent&&n._logger.sendNonStandardEvent(e,3)}))},e.prototype.sendOtelTelemetryEvent=function(e,t){var n=this;this.processEvent(e,(function(e){e.timestamp=t,n._logger.sendTelemetryEvent(e)}))},e.prototype.flush=function(e){this._sink instanceof Ni&&this._sink.flush(e)},e.prototype.shutdown=function(){this._enabled&&(this._reporter.logSessionStatsViaOTel(),this._sink.shutdown()),this._reporter.logSessionStatsViaUls(),this._reporter.logAndClearTaskStats(),this._reporter.checkAndLogPipelineHealth()},e.prototype.getStats=function(){return this._reporter},e.prototype.onProcessedEvent=function(){return this._processedEvent},e.prototype.onThrottledEvent=function(){return this._throttledEvent},e}();var la,fa=[{id:1,namespace:"Office.Online",ariaTenant:"79b56d2f6f2444f1a3d7f7c7f12bcc0c-f47f5fe6-ed89-42f6-8a43-cea0f5930b17-7407"},{id:2,namespace:"Office.Word.Online.Data",ariaTenant:"7e7959aac92e41d6892c69a87259ed58-de5c63ef-10f5-45e1-bef2-d23e9cac2fab-6830"},{id:3,namespace:"Office.Excel.Online.Data",ariaTenant:"011776870b754a649aedc9456ac07a97-6bd8247c-11d3-4599-b599-ec9ef6d401f6-6722"},{id:4,namespace:"Office.PowerPoint.Online.Data",ariaTenant:"35612b11d234460da5c673d7b172fd93-f8762c6b-96cb-4e60-87fa-015aac0c2ff1-7212"},{id:4,namespace:"Office.OneNote.Online.Data",ariaTenant:"86258c80efed47d9b34bf77fc663b381-af82a060-b49f-448b-baf0-956ba7709592-7634"},{id:5,namespace:"Office.Visio.Online.Data",ariaTenant:"77fd25a525d24b7f9b924307de0cc70f-5f2b6ec0-f1d2-40dd-b875-e6bd2849e1eb-7539"},{id:26,namespace:"Office.Shared.Online.Data",ariaTenant:"4ad8b2b2029e481fb82edb7aac29de59-94494dd8-b684-4f92-ab7f-6b414eb77798-7917"},{id:6,namespace:"Office.Word.Online",ariaTenant:"ff7e2f12a4be407096fc01eeb760eda3-eeeb63cf-35d9-4734-ab45-66a873412359-7045"},{id:7,namespace:"Office.Excel.Online",ariaTenant:"fad3bd1d8e4b4c06894bd7bac80e4f02-67df67b4-f1fd-4ecd-9d55-4d41540b1757-7724"},{id:8,namespace:"Office.PowerPoint.Online",ariaTenant:"b664cab4b3f24a739be75b93b026749e-65c206a3-a985-48b4-8b50-36c56c3ce309-7201"},{id:9,namespace:"Office.OneNote.Online",ariaTenant:"1705ef36a51840648341da866d62baf8-ddbcd60b-4ce4-48da-96be-ad5f28b48954-8035"},{id:10,namespace:"Office.Visio.Online",ariaTenant:"a9b6cb604fe942a89c8671aab85364f6-af0f81b1-c5ce-419a-82d5-af38c33ebea3-7250"},{id:27,namespace:"Office.Shared.Online",ariaTenant:"d034371e26194a76a187c7108b3837ca-731725e8-1dc7-4eca-a754-b09c9d2b8dd5-6502"},{id:11,namespace:"Office.Word.Online.Health",ariaTenant:"e064ef4d9cdb454d9eddb2f7f7a94c83-89a6d9df-7218-4efd-bcd4-16ea059deea2-7672"},{id:12,namespace:"Office.Excel.Online.Health",ariaTenant:"e76e8055912d482eb56ea5dad2fd5a97-5552f2bb-d1eb-4843-95d7-3019215328a0-6899"},{id:13,namespace:"Office.PowerPoint.Online.Health",ariaTenant:"706f939c0d24440ba8dfb0838ed33611-d60b1956-db23-4410-a59d-e7fa08d4217f-7388"},{id:14,namespace:"Office.OneNote.Online.Health",ariaTenant:"c6393e4ed4b94e3baf9a46aa6585dce0-c1b3b0c6-b44c-4121-8eae-311d31e67bb6-7176"},{id:15,namespace:"Office.Visio.Online.Health",ariaTenant:"c4999163c49d49c99a1649b404873d24-a62a394b-ad47-45f0-92fa-fd4085dc8bb3-7324"},{id:28,namespace:"Office.Shared.Online.Health",ariaTenant:"2800319cefba4489867c1ff30d41e7e1-ea67d761-9485-4d25-bc39-f3144e34b773-6869"},{id:16,namespace:"Office.Telemetry",ariaTenant:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405"},{id:17,namespace:"Office.System",ariaTenant:"cd836626611c4caaa8fc5b2e728ee81d-3b6d6c45-6377-4bf5-9792-dbf8e1881088-7521"},{id:18,namespace:"Office.TellMe",ariaTenant:"31d9dd3e4c7046a696537586281d7ed1-06d11dd6-a946-4281-8ac3-a7c2ab4776f5-7063"},{id:19,namespace:"Office.Voice",ariaTenant:"9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162"},{id:20,namespace:"Office.Insights",ariaTenant:"250a372c4a854d8fb120ef0366f9410c-dd39bcd8-3b38-4c6c-9f8d-3821e5c28b47-7487"},{id:21,namespace:"Office.Graphics",ariaTenant:"cfcfdb91c68c4329bb8b7cb7babb3cf7-e082c2f2-ef1d-427a-ac4d-b0b700afe7a7-7655"},{id:22,namespace:"Office.AugLoop",ariaTenant:"3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770"},{id:23,namespace:"Office.FileIO",ariaTenant:"d2b065c5ae634beb9cec4813140e22da-eda42ada-ffd9-4e26-92a1-e3b440eaf8bf-7717"},{id:24,namespace:"Office.Sandbox",ariaTenant:"1cd66059dc1d41f1887e3770ea8ba967-f1d0108c-8535-4cf9-bf23-ec8227f6afa7-6999"},{id:25,namespace:"Office.UX",ariaTenant:"c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879"},{id:29,namespace:"Office.Extensibility",ariaTenant:"db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439"}],da=!1,pa="",va="",ga="unknown";function ha(e){if(da)throw new Error("Telemetry is already initialized!");if(!e.ulsLogger)throw new Error("Must provide a ULS logger!");var t;!function(e){if(!e)throw new Error("The 'logger' argument is missing");o.setLogger(e)}(e.ulsLogger),e.loggingCategory&&(t=e.loggingCategory,Hi=t),e.alwaysOnMetadata&&(ga="".concat(e.alwaysOnMetadata.name,", ")+"".concat(e.alwaysOnMetadata.applicationMode,", ")+"".concat(e.alwaysOnMetadata.applicationModeExtended)),o.sendTraceTag(595947925,Hi,r.Info,"Initializing Otel library [".concat(ga,"] with settings ").concat(function(e){return JSON.stringify(e,(function(e,t){if("alwaysOnMetadata"!==e)return t}))}(e))),function(e){e.alwaysOnMetadata&&(null==e.alwaysOnMetadata.name||""===e.alwaysOnMetadata.name?(pa="Office.Online.UserAction",va="Office.Online.Data.Activity",o.sendTraceTag(595900060,Hi,r.Info,"Cannot determine the App for UserActionEvent, using generic UserAction event name.")):(pa="Office.".concat(e.alwaysOnMetadata.name,".Online.UserAction."),va="Office.".concat(e.alwaysOnMetadata.name,".Online.Data.Activity.")))}(e);var n=function(e){return ra({alwaysOnMetadata:e.alwaysOnMetadata,transportSettings:e.oneDsTransportSettings,throttlingSettings:e.throttlingSettings,statsSettings:e.statsSettings,samplingSetings:e.samplingSettings})}(function(e){return{alwaysOnMetadata:e.alwaysOnMetadata||ji.alwaysOnMetadata,useOneDsLogger:Vi(e.otelUseOneDsSink,ji.useOneDsLogger),logToUls:Vi(e.sendToUls,ji.logToUls),oneDsTransportSettings:{enabled:Vi(e.sendToAria,ji.oneDsTransportSettings.enabled),collectorEndpointEnum:qi(e.ariaEndpointTarget,ji.oneDsTransportSettings.collectorEndpointEnum),collectorEndpointUrl:qi(e.ariaEndpointUrl,ji.oneDsTransportSettings.collectorEndpointUrl),eventUploadFrequency:Ki(e.eventUploadFrequency,ji.oneDsTransportSettings.eventUploadFrequency),cacheMemorySizeLimitInNumberOfEvents:Ki(e.cacheMemorySizeLimitInNumberOfEvents,ji.oneDsTransportSettings.cacheMemorySizeLimitInNumberOfEvents),enableCustomerContent:Vi(e.enableCustomerContent,ji.oneDsTransportSettings.enableCustomerContent),enableDNM:Vi(e.enableDNM,ji.oneDsTransportSettings.enableDNM)},throttlingSettings:{enabled:Vi(e.wacAriaThrottlingIsEnabled,ji.throttlingSettings.enabled),totalEventsThrottlePerSec:Ki(e.wacAriaTotalEventsThrottlePerSec,ji.throttlingSettings.totalEventsThrottlePerSec),singleEventThrottlePerSec:Ki(e.wacAriaSingleEventThrottlePerSec,ji.throttlingSettings.singleEventThrottlePerSec),eventNamesToBeSuppressedCommaSeparated:qi(e.otelEventNamesToBeSuppressedCommaSeparated,ji.throttlingSettings.eventNamesToBeSuppressedCommaSeparated)},statsSettings:{taskDurationLogFrequency:Ki(e.taskDurationLogFrequency,ji.statsSettings.taskDurationLogFrequency),durationThreshold:Ki(e.taskDurationLogThreshold,ji.statsSettings.durationThreshold),reportTaskDetails:Vi(e.reportTaskDetails,ji.statsSettings.reportTaskDetails),sessionDurationCutoff:ji.statsSettings.sessionDurationCutoff},samplingSettings:{enabled:Vi(e.samplingIsEnabled,ji.samplingSettings.enabled),sampleRate:Ki(e.sampleRate,ji.samplingSettings.sampleRate)}}}(e));e.sendToUls&&(n.onProcessedEvent().addListener(Sa),n.onThrottledEvent().addListener(_a)),f.addListener((function(t){!function(e,t){if(2===e.category&&!t)return;o.sendTraceTag(595947933,Hi,function(e){switch(e){case 3:return r.Verbose;case 2:return r.Info;case 1:return r.Warning;case 0:return r.Error;default:throw new Error(e)}}(e.level),e.message())}(t,e.enableAdditionalDiagnosticTracing||!1)})),fa.forEach((function(e){n.setTenantToken(e.namespace,e.ariaTenant)})),e.pingCollectorPingUrl&&n.pingCollectorPingUrl(),e.pingCollectorEndpoint&&n.pingCollectorEndpoint(),la=n,da=!0,o.sendTraceTag(595947926,Hi,r.Info,"Successfully initialized Otel library")}function ma(e,t){Ea();var n=function(e){if(!e.name)throw new Error("Event is missing a name");var t=Ji(e.dataFields),n={eventName:e.name,dataFields:t,eventFlags:{}};return 1===e.samplingPolicy&&(n.eventFlags={samplingPolicy:1}),n}(e);la.sendOtelTelemetryEvent(n,t)}function ya(e,t){Ea(),null!=e&&null!=e.name&&(e.name.indexOf("Office.")>=0||(e.name=va+e.name));var n=function(e){if(!e.name)throw new Error("Event is missing a name");null==e.succeeded&&(e.succeeded=void 0),(null==e.durationMs||isNaN(e.durationMs))&&(e.durationMs=0),(null==e.count||isNaN(e.count))&&(e.count=1),null==e.aggMode&&(e.aggMode=0);var t=Math.floor(1e3*e.durationMs),n=Ji(e.dataFields),r=W.getFields({cV:e.CV||void 0,duration:t,count:e.count,aggMode:e.aggMode,success:e.succeeded});return{eventName:e.name,eventContract:{name:W.contractName,dataFields:r},dataFields:n,eventFlags:{}}}(e);la.sendOtelTelemetryEvent(n,t)}function Ta(e,t){Ea(),null==e.name&&(e.name=pa,null!=e.actionName&&(e.name+=e.actionName));var n=function(e){if(!e.name)throw new Error("Event is missing a name");null==e.succeeded&&(e.succeeded=void 0),(null==e.durationMs||isNaN(e.durationMs))&&(e.durationMs=0);var t=Math.floor(1e3*e.durationMs);null==e.dataFields&&(e.dataFields=[]);var n=Ji(e.dataFields),r=z({id:null==e.actionId?void 0:e.actionId,name:null==e.actionName?void 0:e.actionName,commandSurface:null==e.commandSurface?void 0:e.commandSurface,parentName:null==e.parentName?void 0:e.parentName,triggerMethod:null==e.triggerMethod?void 0:e.triggerMethod,timeOffsetMs:null==e.timeOffsetMs?void 0:e.timeOffsetMs});n.push.apply(n,r);var i=W.getFields({duration:t,count:1,aggMode:0,success:e.succeeded});return{eventName:e.name,eventContract:{name:W.contractName,dataFields:i},dataFields:n,eventFlags:{}}}(e);la.sendOtelTelemetryEvent(n,t)}function ba(e){var t,n=e.otelEvent;if(!n||!n.dataFields)throw new Error("Invalid Otel event");if(e.additionalDataFields){var r=Ji(e.additionalDataFields);(t=n.dataFields).push.apply(t,r)}return n}function Sa(e){o.sendTraceTag(595947932,Hi,r.Info,"Processed TelemetryEvent "+e.eventName+" :"+JSON.stringify(e))}function _a(e){o.sendTraceTag(593597440,Hi,r.Warning,"Throttled TelemetryEvent "+e.eventName+" :"+JSON.stringify(e))}function Ea(){if(!da)throw new Error("Telemetry is not initialized!")}function Ca(e){switch(e.kind){case"event":try{ma(e.event)}catch(t){o.sendTraceTag(595947920,Hi,r.Error,"".concat("Error while processing"," TelemetryEvent ").concat(e.event.name," : ").concat(Oa(t)))}break;case"activity":try{ya(e.event)}catch(t){o.sendTraceTag(595947921,Hi,r.Error,"".concat("Error while processing"," ActivityEvent ").concat(e.event.name," : ").concat(Oa(t)))}break;case"action":try{Ta(e.event)}catch(t){o.sendTraceTag(595928211,Hi,r.Error,"".concat("Error while processing"," UserActionEvent ").concat(e.event.name," : ").concat(Oa(t)))}break;case"otel":try{!function(e){Ea(),la.sendOtelTelemetryEvent(ba(e))}(e.event)}catch(i){var t="";(n=e.event)&&(t=n.eventName),o.sendTraceTag(595947922,Hi,r.Error,"".concat("Error while processing"," OtelEvent ").concat(t," : ").concat(Oa(i)))}break;case"otelcc":try{!function(e){Ea(),la.sendOtelCustomerContent(ba(e))}(e.event)}catch(i){t="";(n=e.event)&&(t=n.eventName),o.sendTraceTag(572298211,Hi,r.Error,"".concat("Error while processing"," OTel CustomerContent ").concat(t," : ").concat(Oa(i)))}break;case"oteldnm":try{!function(e){Ea(),la.sendOtelDirectNumeric(ba(e))}(e.event)}catch(i){var n;t="";(n=e.event)&&(t=n.eventName),o.sendTraceTag(512566404,Hi,r.Error,"".concat("Error while processing"," OTel DNM ").concat(t," : ").concat(Oa(i)))}break;case"addNamespaceMapping":try{i=e.namespace,a=e.ariaTenantToken,Ea(),la.setTenantToken(i,a)}catch(t){o.sendTraceTag(595947923,Hi,r.Error,"".concat("Error while adding"," namespace mapping for ").concat(e.namespace," : ").concat(Oa(t)))}break;case"setDNMToken":try{!function(e,t){Ea(),la.setDNMToken(e,t)}(e.namespace,e.ariaTenantToken)}catch(t){o.sendTraceTag(512566403,Hi,r.Error,"".concat("Error while adding"," DNM namespace mapping for ").concat(e.namespace," : ").concat(Oa(t)))}break;case"shutdown":try{Ea(),o.sendTraceTag(595947931,Hi,r.Info,"Otel library shutdown triggered [".concat(ga,"]")),la.shutdown()}catch(e){o.sendTraceTag(595947924,Hi,r.Error,"".concat("Error while processing"," shutdown event : ").concat(Oa(e)))}break;case"flush":try{Ea(),la.flush(!0)}catch(e){o.sendTraceTag(559810652,Hi,r.Error,"".concat("Error while processing"," flush event : ").concat(Oa(e)))}break;default:throw new Error(e)}var i,a}function Oa(e){return e instanceof Error?e.message?e.message:"":null!=e.message?e.message:JSON.stringify(e)}var wa=new(function(){function e(){}return e.prototype.initialize=function(e){if(!e)throw new Error("Must supplied valid telemetry settings!");ha(e)},e.prototype.processTelemetryEvent=function(e){Ca(e)},e}());n.d(t,"TelemetryFullGlobal",(function(){return wa})),n.d(t,"initializeEventProcessor",(function(){return ha})),n.d(t,"processEvent",(function(){return Ca}))},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n(0),i=n(5),a=((Object(i.a)()||{}).Symbol,(Object(i.a)()||{}).Reflect,r.a||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])r.f[r.i].call(t,a)&&(e[a]=t[a]);return e}),o=function(e,t){return(o=r.b.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[r.i](n)&&(e[n]=t[n])})(e,t)};function s(e,t){function n(){this.constructor=e}typeof t!==r.h&&null!==t&&Object(i.c)("Class extends value "+String(t)+" is not a constructor or null"),o(e,t),e[r.k]=null===t?Object(i.b)(t):(n[r.k]=t[r.k],new n)}function c(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}}]);
//# sourceMappingURL=otelFull.min.js.map