'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1137:function(t,C,a){t=a(0);var c=a(83),b=a(550),d=a(15),f=a(133);class e{constructor(bb,mb,Ca){this.hRd=this.iRd=this.jRd=!1;this.yRd=!bb&&!mb;this.zRd=!bb&&!Ca;this.yRd||this.zRd||(this.jRd=!bb,this.iRd=!mb,this.hRd=!Ca)}}Object(t.a)(e,"RenameDisabledDialogInfo",null,[]);class k extends f.StandardDialog{constructor(bb,mb,Ca,$a,Kb){super();this.vUd=[];this.Z0=new e(bb,mb,Ca);this.Wqa=$a;this.Lpa=Kb;this.ze=
"RenameDisabledDialog";this.Rb=0;this.rc(1,CommonUIStrings.l_DialogClose);this.Xsj();this.Ucj()}Xsj(){this.Z0.yRd?this.uLb(this.Wqa?this.Lpa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.Z0.zRd?this.uLb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.$Ag();this.fra(this.vUd)}uLb(bb){Array.add(this.vUd,bb)}$Ag(){const bb=[];this.Z0.jRd||Array.add(bb,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.Z0.iRd||Array.add(bb,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.Z0.hRd||Array.add(bb,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<bb.length&&Array.add(this.vUd,bb)}}Object(t.a)(k,"ReactRenameDisabledDialogBase",f.StandardDialog,[]);class l extends k{constructor(bb,mb,Ca,$a,Kb){super(bb,mb,Ca,$a,Kb)}Ucj(){this.jCb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(t.a)(l,"ReactRenameDisabledDialog",k,[]);var m=a(144);class v{static get ag(){return m.a.ap(v.Bk,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}v.Bk="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(t.a)(v,"RenameDisabledDialogHtml",null,[]);class n extends m.a{constructor(bb,mb,Ca,$a,Kb){super();this.Z0=new e(bb,mb,Ca);this.Wqa=$a;this.Lpa=Kb;this.ze="RenameDisabledDialog";this.Rb=0;this.rc(1,CommonUIStrings.l_DialogClose);this.ag=v.ag;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.jW("RenameRow")}l9a(){if(this.Z0.yRd){let bb;bb=this.Wqa?this.Lpa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;n.uLb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),bb)}else this.Z0.zRd?n.uLb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.J5h()}J5h(){this.Z0.jRd&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.Z0.iRd&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.Z0.hRd&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static uLb(bb,mb,Ca){bb.style.display="none";mb.innerText=Ca}}Object(t.a)(n,"RenameDisabledDialog",m.a,[]);var w=a(4),r=a(30),u=a(106),y=a(25);class x{constructor(bb,mb){this.BDa=0;this.La=bb;this.P7=mb}initialize(bb){if(!this.La||!this.P7)return!1;this.BDa=bb;this.Gg();return!0}Gg(){this.La.Ob(y.a.kha,u.a.frame,Object(c.a)(this,this.kha,"commitNewDocumentTitle"))}kha(bb,mb,Ca,$a,Kb){if(1===Ca)return this.La.processAction(y.a.renameFile,
1);bb=r.a.uq(this.P7.Zm);Kb=(0,Kb.getNewDocumentTitle)();Kb.length>this.BDa&&(Kb=Kb.substr(0,this.BDa));if(32!==this.La.de(y.a.renameFile,2,Kb))return this.DW(bb),8;this.DW(Kb);return 32}DW(bb){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(bb))}static Ldd(){return new x(w.AFrameworkApplication.wb,w.AFrameworkApplication.hm)}}Object(t.a)(x,"ReactRenameUIHandler",null,[455]);var B=a(92),z=a(518),A=a(552),I=a(13),F=a(108),U=a(236),X=a(88),S=a(39),H=a(27),D=a(82);class J{constructor(bb,
mb,Ca,$a,Kb,rb,cc,nc,Wb,Ea,ua,ma){this._initialized=!1;this._element=null;this.BDa=0;this.mPc=this.MIc=!1;this.La=bb;this.$Dc=mb;this.Xd=Ca;this.tA=$a;this.P7=Kb;this.Fee=rb;this.aVb=cc;this.VEc=nc;this.c8=Wb;this.w8d=Ea;this.DVa=ua;this.GJc=ma}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(bb,mb,Ca){if(!(this.La&&this.P7&&this.Fee&&this.aVb&&this.VEc&&mb)||0>=bb)return!1;this._element=mb;this._element.title=Ca;this._element.setAttribute(X.a.Kd,X.a.Ms);this._element.setAttribute("Unselectable",
"on");this.BDa=bb;this.rv();return this._initialized=!0}rv(){this.$Dc&&(this.$Dc.ra(I.a.blur,this._element,Object(c.a)(this,this.onBlur,"onBlur")),this.$Dc.ra(I.a.paste,this._element,Object(c.a)(this,this.onPaste,"onPaste")));this.Xd.ra(I.a.Kb,this._element,Object(c.a)(this,this.onKeyDown,"onKeyDown"));this.tA.ra(I.a.pointerDown,this._element,Object(c.a)(this,this.onPointerDown,"onPointerDown"));this.tA.ra(I.a.Mf,this._element,Object(c.a)(this,this.Kf,"onPointerUp"))}onBlur(){this.isActive&&!this.MIc&&
(this.w8d||this.VEc(this._element),this.Fze(),this.x4c(!1));return this.MIc=!1}onPaste(){d.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(bb){return this.isActive?this.UMi(bb):this.VMi(bb)}UMi(bb){let mb=!1;switch(bb.Ca.keyCode){case Sys.UI.Key.enter:this.Fze();this.x4c(this.DVa||this.GJc);mb=!0;break;case Sys.UI.Key.tab:this.w8d&&this.VEc(this._element);break;case Sys.UI.Key.esc:this.FKd(),this.x4c(this.DVa||this.GJc),mb=!0}return mb}VMi(bb){let mb=
!1;switch(bb.Ca.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.z$f(this.GJc),this.isActive&&this.aVb(this._element),mb=!0}return mb}onPointerDown(){this.isActive||(this.z$f(!1),this.isActive&&(this._element.focus(),this.aVb(this._element),this.mPc=!0));return!1}Kf(){return this.mPc?(this.aVb(this._element),this.mPc=!1,!0):!1}w6a(){return 32===this.La.processAction(y.a.renameFile,1)}Fze(){const bb=r.a.uq(this.P7.Zm);let mb=this._element.innerText.trim();mb.length>this.BDa&&(mb=mb.substr(0,
this.BDa));mb!==bb&&""!==mb?32!==this.La.de(y.a.renameFile,2,mb)?this.FKd():this.DW(mb):this.FKd()}FKd(){this.DW(r.a.uq(this.P7.Zm))}DW(bb){this._initialized&&(this._element.innerText=bb,this.Fee())}z$f(bb){this.w6a()?this.isActive||(bb&&(this.MIc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(X.a.Kd,X.a.RVc),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,B.CuiHelper.QIe),
this.c8&&this.c8.execute(mb=>{mb.wKf(!0)}),bb&&this._element.focus(),d.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.La.processAction(y.a.edb,2)}x4c(bb){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(X.a.Kd,X.a.Ms);Sys.UI.DomElement.removeCssClass(this._element,B.CuiHelper.QIe);this.c8&&this.c8.execute(mb=>{mb.wKf(!1)});bb&&(this._element.blur(),this._element.focus())}static Rz(){z.a.Rz(w.AFrameworkApplication.isRtl)}static Ldd(){return new J(w.AFrameworkApplication.wb,
A.a.instance,F.KeyInputManager.instance,U.a.instance,w.AFrameworkApplication.hm,J.Rz,S.a.clj,S.a.NXg,D.a.instance.Wb("Common.App.Header.HeaderEventSource"),H.a.fka,H.a.Ug,H.a.Tf)}}Object(t.a)(J,"RenameUIHandler",null,[455]);class M{static get instance(){return w.AFrameworkApplication.ta.Oa.$r?M.Ma||(M.Ma=x.Ldd()):M.Ma||(M.Ma=J.Ldd())}}M.Ma=null;Object(t.a)(M,"RenameUIHandlerFactory",null,[]);var G=a(98),T=a(134);class K{constructor(){this.kCi=this.gCi=this.bah=null}}Object(t.a)(K,"RenameMruEntryProperties",
null,[]);var L=a(370),V=a(163),W=a(640),da;(function(bb){bb[bb.unknown=-1]="unknown";bb[bb.success=0]="success";bb[bb.renameInvalidFileName=1]="renameInvalidFileName";bb[bb.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";bb[bb.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";bb[bb.permissionDenied=4]="permissionDenied";bb[bb.serverCommunicationFailure=5]="serverCommunicationFailure";bb[bb.fileNameTooLong=6]="fileNameTooLong"})(da||(da={}));Object(t.b)("CommonOperationResult",
da);class qa{constructor(bb,mb,Ca,$a,Kb,rb,cc,nc,Wb,Ea,ua,ma){this.H8d=bb;this.La=mb;this.eFc=Ca;this.Gv=$a;this.uDa=Kb;this.Ixg=rb;this.Wqa=cc;this.Fhe=nc;this.kug=Wb;this.Lpa=Ea;this.nb=ua;this.jug=ma}Gg(){w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Oa.$r||this.ai.Ob(y.a.Axb,u.a.frame,Object(c.a)(this,this.Axb,"initializeRenameUIHandler"));this.ai.Ob(y.a.edb,u.a.frame,Object(c.a)(this,this.edb,"showRenameDisabledDialog"));this.ai.Ob(y.a.renameFile,u.a.frame,Object(c.a)(this,this.renameFile,
"renameFile"));this.ai.Ie(y.a.fileNameUpdate,u.a.frame,Object(c.a)(this,this.y6i,"refreshFilename"),64);this.ai.Ie(y.a.rkc,u.a.frame,Object(c.a)(this,this.rkc,"moveToFolderCompleteByHost"),64);this.ai.Ob(y.a.HNa,u.a.frame,Object(c.a)(this,this.HNa,"moveToFolder"));w.AFrameworkApplication.ta&&(w.AFrameworkApplication.fa.qa("PostMessageEmbedded")||w.AFrameworkApplication.fa.qa("IsJsApi"))&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0)&&w.AFrameworkApplication.GU().execute(bb=>
{bb.eo(V.a.fqf);bb.Tl(V.a.fqf,qa.n5i);bb.eo(V.a.d$c);bb.Tl(V.a.d$c,qa.l5i)})}w6a(){return 0===this.jug.y0e()?32:8}pUj(){return this.Wy?this.Wqa?this.Wy.QHe:this.Wy.bub:!0}Axb(){return M.instance.initialize(w.AFrameworkApplication.i8b,w.AFrameworkApplication.b1a,w.AFrameworkApplication.XId||CommonUIStrings.l_RenameFileTooltip)?32:8}edb(){const bb=this.pUj(),mb=this.Ixg();d.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.uDa,mb,bb,this.Wqa);w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Oa.mv&&w.AFrameworkApplication.fa.qa("ReactRenameDisabledDialogIsEnabled")?new l(this.uDa,!mb,!bb,this.Wqa,this.Lpa()):new n(this.uDa,!mb,!bb,this.Wqa,this.Lpa());return 32}renameFile(bb,mb,Ca,$a,Kb){if(1===Ca)return this.w6a();if(!w.AFrameworkApplication.I7b)return 8;if(8===this.w6a())return this.ai.processAction(y.a.edb,2),8;d.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");w.AFrameworkApplication.I7b(Kb,Object(c.a)(this,
this.sEb,"onRenameFileSuccess"),Object(c.a)(this,this.BPi,"onRenameFileFailure"));return 32}sEb(bb,mb){bb?0!==bb.OperationResult?this.q4e(bb.OperationResult):(this.umj(mb,bb.NewName),this.QPj(bb,Object(c.a)(w.AFrameworkApplication.ta.Oa,w.AFrameworkApplication.ta.Oa.Zcg,"updateOpenInClientDocumentUrl")),w.AFrameworkApplication.fa.qa("DocumentNameInJewelInfoMenuIsEnabled")&&w.AFrameworkApplication.ta.updateCommandUI(),this.kug.Fbg()):this.q4e(5)}umj(bb,mb){const Ca={};Ca[L.a.xyh]=mb;bb.Fj(V.a.d$c,
Ca)}QPj(bb,mb){this.dQj(bb);w.AFrameworkApplication.m5b=bb.DirectInvokeDavUrl;mb=mb(bb.EditDocInClientUrl);const Ca=new K;Ca.kCi=this.Gv.Zm;Ca.bah=mb;Ca.gCi=bb.EditDocInClientUrl;this.ai.de(y.a.renameMostRecentlyUsedFileEntry,2,Ca)}q4e(bb){switch(bb){case 1:bb=new f.StandardDialog,bb.Rb=0,bb.oW(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.fTf()}}dQj(bb){this.Gv.Zm=qa.zJg(this.Gv.Zm,bb.NewName);bb.BreadcrumbFolderName&&(this.Gv.breadcrumbFolderName=
bb.BreadcrumbFolderName);bb.BreadcrumbFolderUrl&&(this.Gv.breadcrumbFolderUrl=bb.BreadcrumbFolderUrl);this.Fhe(bb.NewName)}BPi(bb){const mb=new f.StandardDialog;mb.Rb=0;switch(bb){case 1:d.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");mb.jAa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:d.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");mb.jAa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:d.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:bb}),mb.jAa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}w.AFrameworkApplication.GU().execute(Ca=>{Ca.Fj(V.a.wyh,{["FailureMessage"]:da[bb]})});this.fTf()}y6i(bb,mb,Ca){if(1===Ca)return this.w6a();if(!w.AFrameworkApplication.DIa)return 8;w.AFrameworkApplication.DIa(Object(c.a)(this,this.anc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.$mc,"onRefreshFilenameFailure"),
!1);return 32}HNa(bb,mb,Ca,$a,Kb){if(1===Ca)return w.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?32:8;if(2===Ca){const rb={};bb=w.AFrameworkApplication.lba;mb=w.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");bb=(!bb||bb&&mb)&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);rb[L.a.jGj]=bb;Kb&&Kb.MoveButtonClickedTime&&(rb[L.a.BAi]=Kb.MoveButtonClickedTime.getTime());w.AFrameworkApplication.GU().execute(cc=>{cc.Fj(V.a.HNa,
rb)});if(Kb&&Kb.MoveButtonClickedTime){if(bb=T.a.Lr())Kb=(new Date).getTime()-Kb.MoveButtonClickedTime.getTime(),bb.set("MovePostDuration",Kb.toString());G.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",bb)}return 32}return 8}rkc(bb,mb,Ca,$a,Kb){if(1===Ca)return w.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?this.w6a():8;if(2===Ca){if(!w.AFrameworkApplication.SWf)return G.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,
null),8;if(!Kb)return G.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Kb[L.a.tfi])if(Kb[L.a.Udg])if(bb=Kb[L.a.Udg].toLowerCase(),mb=w.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"),Ca=w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),mb&&w.AFrameworkApplication.lba&&Ca){const rb={};rb[L.a.tPa]="1";rb[L.a.documentUrl]=bb;rb[L.a.reason]=W.a.saveAs;G.Health.instance.recordKpiSuccess("MoveToFolder",null);
w.AFrameworkApplication.GU().execute(cc=>{cc.Fj(V.a.tta,rb)})}else if(!w.AFrameworkApplication.lba&&Ca)G.Health.instance.recordKpiSuccess("MoveToFolder",null),S.a.Ve(bb,S.a.GW(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return G.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else G.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else w.AFrameworkApplication.DIa(Object(c.a)(this,this.anc,"onRefreshFilenameSuccess"),Object(c.a)(this,
this.$mc,"onRefreshFilenameFailure"),!1),w.AFrameworkApplication.SWf(),G.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}fyj(bb,mb){return bb&&mb?bb!==this.Gv.breadcrumbFolderName||mb!==this.Gv.breadcrumbFolderUrl:!1}anc(bb,mb){bb&&(bb.NewName!==r.a.uq(this.Gv.Zm)||this.fyj(bb.BreadcrumbFolderName,bb.BreadcrumbFolderUrl))&&this.sEb(bb,mb)}$mc(){}fTf(){this.Fhe(r.a.uq(this.Gv.Zm))}get ai(){return this.La.value}get Wy(){return this.eFc.value}static get instance(){return qa.Ma||(qa.Ma=
qa.cub())}static cub(){return new qa(w.AFrameworkApplication.x6a,new b.a(()=>w.AFrameworkApplication.wb),new b.a(()=>w.AFrameworkApplication.Wy),w.AFrameworkApplication.hm,w.AFrameworkApplication.limitedEdit,()=>w.AFrameworkApplication.userCanRename,w.AFrameworkApplication.Urc,Object(c.a)(M.instance,M.instance.DW,"updateTitle"),D.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>w.AFrameworkApplication.isReadOnlyRecommended,w.AFrameworkApplication.fa,D.a.instance.resolve("Common.IRenameProps"))}static zJg(bb,
mb){bb=r.a.t3(bb);return mb+bb}static n5i(bb){const mb=bb.Values[L.a.Qii];d.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",mb);mb?w.AFrameworkApplication.wb.de(y.a.rkc,2,bb.Values):G.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static l5i(bb){w.AFrameworkApplication.wb.de(y.a.renameFile,2,bb.Values.NewName)}}qa.Ma=null;Object(t.a)(qa,"RenameActor",null,[]);a(566);class O{}Object(t.a)(O,"ActivityEventName",null,[]);class ea{}
ea.compatMode="CompatMode";ea.noSelection="NoSelection";Object(t.a)(ea,"ActivityEventReason",null,[]);var R=a(639);class oa{constructor(bb,mb){this.La=bb;this.MUa=mb}Gg(){this.La.Ob(y.a.v3f,u.a.frame,Object(c.a)(this,this.OAj,"showRenameDialogAction"))}OAj(bb,mb,Ca){bb=32;if(1===Ca)return R.SessionStatusManager.instance.u4a||w.AFrameworkApplication.m4?8:32;2===Ca&&(32!==this.La.processAction(y.a.renameFile,1)?(this.La.processAction(y.a.edb,2),bb=8):32===this.La.processAction(y.a.tLb,1)?this.La.processAction(y.a.tLb,
2):this.MUa.value.create().uwc());return bb}}Object(t.a)(oa,"RenameDialogActor",null,[454]);class pa{constructor(bb,mb,Ca){this.dialog=null;this.La=bb;this.Gv=mb;this.vpa=Ca}HUh(){const bb={};bb.nameInputProps={["type"]:"AppInputProps",["id"]:pa.a1a,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:r.a.uq(this.Gv.Zm),["maxLength"]:this.vpa};return bb}uwc(){const bb={["id"]:"RenameDialog",["bodyControls"]:this.HUh()};this.dialog=new m.a(!1,!1,!0);this.dialog.Rb=1;this.dialog.ze="RenameDialog";
this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.VId,"renameDialogHandler"),bb)}VId(bb,mb){mb&&1===bb&&mb[pa.a1a]&&(bb=r.a.uq(this.Gv.Zm),mb=(mb[pa.a1a]||"").trim(),mb!==bb&&""!==mb&&this.La.de(y.a.renameFile,2,mb))}}pa.a1a="txtDocumentName";Object(t.a)(pa,"ReactRenameDialog",null,[456]);class Pa{static get ag(){return m.a.ap(Pa.Bk,CommonUIStrings.l_RenameDialogLabel)}}Pa.Bk="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(t.a)(Pa,"RenameDialogHtml",null,[]);class Z extends m.a{constructor(bb,mb,Ca){super();this.La=bb;this.Gv=mb;this.vpa=Ca;this.ze="RenameDialog";this.ag=Pa.ag}uwc(){var bb={["txtDocumentName"]:r.a.uq(this.Gv.Zm)};this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.VId,"renameDialogHandler"),bb);bb=document.getElementById(Z.a1a);0<this.vpa&&(bb.maxLength=this.vpa);bb.focus()}VId(bb,mb){1===bb&&(bb=r.a.uq(this.Gv.Zm),mb=(mb[Z.a1a]||"").trim(),mb!==bb&&""!==mb&&this.La.de(y.a.renameFile,
2,mb))}}Z.a1a="txtDocumentName";Object(t.a)(Z,"RenameDialog",m.a,[456]);class Ra{constructor(bb){this.P7=null;this.vpa=0;this.La=bb;this._initialized=!1}initialize(bb,mb){this.P7=bb;this.vpa=mb;this._initialized=!0}create(){return this._initialized?w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Oa.mv&&w.AFrameworkApplication.fa.qa("ReactRenameDialogIsEnabled")?new pa(this.La,this.P7,this.vpa):new Z(this.La,this.P7,this.vpa):null}}Object(t.a)(Ra,"RenameDialogFactory",null,[446]);var Ga=a(259),
Ba=a(171),fa=a(159),Y=a(107),ja=a(103);class ca{constructor(bb,mb){this.La=bb;this.Zb=mb}Gg(){this.La.Ob(y.a.tLb,u.a.frame,Object(c.a)(this,this.PAj,"showRenameFlyoutAction"))}TTg(){return fa.d("setDocumentTitleFlyoutOpened")&&w.AFrameworkApplication.ta.Oa.$r}PAj(bb,mb,Ca){if(1===Ca)return this.TTg()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}mCg(){ca.Lli&&w.AFrameworkApplication.j6a&&ja.a.instance.Ag(new Y.a(5,1,5E3,()=>{32===this.La.processAction(y.a.tLb,
1)&&this.Zb&&this.Zb.ei.name===Ga.AFrame.t$&&(Ba.a("RenameFloatieShownOnNewDocumentLoad",!0),this.La.processAction(y.a.tLb,2))}))}static get Lli(){ca.JSb&&null!=ca.JSb||(w.AFrameworkApplication.$ic("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),ca.JSb=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return ca.JSb}}ca.JSb=null;Object(t.a)(ca,"RenameFlyoutActor",null,
[444]);class aa{constructor(bb,mb,Ca,$a,Kb){this.eFc=Kb;this.I8d=Ca;this.H8d=$a;this.Mxg=bb;this.Lpa=mb}get Wy(){return this.eFc.value}y0e(){if(!this.H8d())return 5;if(this.Lpa())return 1;if(this.Wy){if(this.I8d&&!this.Wy.QHe)return 3;if(!this.I8d&&!this.Wy.bub)return 4}return this.Mxg()?0:2}}Object(t.a)(aa,"RenameProps",null,[443]);a(185);var ta=a(99);class xa{constructor(bb,mb,Ca,$a,Kb,rb){this.Vm=!1;this.dLc=new ta.a;this.RUa=mb;this.HL=Ca;this.Zlg=$a;this.nb=Kb;this.oge=rb}enable(){this.Vm||(this.Fbg(),
this.TSd(),this.Vm=!0)}generateKey(bb,mb,Ca){return String.format("{0}/{1}/{2}",Ca,bb,mb)}PPh(){const bb=r.a.uq(this.RUa().Zm);return this.generateKey(this.RUa().breadcrumbFolderName,this.RUa().breadcrumbFolderUrl,bb)}QPh(bb,mb,Ca){return bb&&mb?this.generateKey(bb,mb,Ca):Ca}zeh(bb,mb,Ca){return bb&&bb!==this.RUa().breadcrumbFolderName||mb&&mb!==this.RUa().breadcrumbFolderUrl?!0:Ca!==r.a.uq(this.RUa().Zm)}Fbg(){const bb=this.PPh();this.dLc.ia(bb,new Date)}xCd(bb){this.Lwj(bb)&&this.Nie(bb)}Lwj(bb){const mb=
this.Zlg();return mb?this.oge&&this.oge.Myb||!mb.lcf||!w.AFrameworkApplication.DIa?(this.Z5f(bb),this.Vm=!1):!0:!1}ACf(bb,mb,Ca,$a){const Kb=this.zeh(bb,mb,Ca);bb=this.QPh(bb,mb,Ca);mb=this.dLc.Dc(bb).returnValue;Kb&&!mb&&(this.r4e($a),d.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.ftd));Kb||this.dLc.ia(bb,this.HL())}}Object(t.a)(xa,"ARenamedFileChecker",null,[410]);class ia extends xa{constructor(bb,mb,Ca,$a,Kb,rb,cc,nc){super(bb,mb,Ca,$a,Kb,rb);this.zde=Kb;this.iug=cc;this.Hpg=
nc}get ftd(){return"RenamedFileCheckerUsingSettingsRefresh"}TSd(){this.zde.eUc(Object(c.a)(this,this.c5e,"handleSettingsRefresh"))}c5e(bb,mb){mb&&mb.MCb&&mb.KEi&&(mb.F6a("BreadcrumbDocName")||mb.F6a("BreadcrumbFolderName")||mb.F6a("BreadcrumbFolderUrl")||mb.F6a("DirectInvokeDAVUrl")||mb.F6a("EditDocInClientUrl"))&&(d.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.ftd),this.xCd(mb))}Z5f(){this.zde.Bbj(Object(c.a)(this,this.c5e,"handleSettingsRefresh"))}Nie(bb){if(bb&&bb.MCb){const mb=
bb.MCb;this.ACf(mb.Va("BreadcrumbFolderName"),mb.Va("BreadcrumbFolderUrl"),mb.Va("BreadcrumbDocName"),bb)}}r4e(bb){const mb={OperationResult:0,classId:1};bb=bb.MCb;mb.BreadcrumbFolderName=bb.Va("BreadcrumbFolderName");mb.BreadcrumbFolderUrl=bb.Va("BreadcrumbFolderUrl");mb.DirectInvokeDavUrl=bb.Va("DirectInvokeDAVUrl");mb.EditDocInClientUrl=bb.Va("EditDocInClientUrl");bb=bb.Va("BreadcrumbDocName");mb.NewName=w.AFrameworkApplication.sta?bb:r.a.uq(bb);this.Hpg.execute(Ca=>{this.Mci(mb,Ca)})}Mci(bb,mb){this.iug().sEb(bb,
mb)}}Object(t.a)(ia,"RenamedFileCheckerUsingSettingsRefresh",xa,[]);class ya extends xa{constructor(bb,mb,Ca,$a,Kb,rb,cc,nc,Wb,Ea){super(bb,Ca,$a,Kb,rb,Wb);this.skb=this.EWb=null;this.ptg=mb;this.La=cc;this.fe=nc;Ea&&Ea.execute(ua=>{this.P8i(ua)})}get ftd(){return"RenamedFileCheckerUsingTask"}P8i(bb){this.EWb=bb;this.EWb.SFg(Object(c.a)(this,this.phd,"handleVisibilityChange"))}phd(bb,mb){!this.Vm||0!==mb.newState&&1!==mb.newState||this.skb||(this.TSd(),this.xCd(this.skb))}TSd(){this.skb=new Y.a(3,
2,this.ptg(),Object(c.a)(this,this.xCd,"performRenameFileCheckTick"),89);this.fe.Ag(this.skb)}Z5f(bb){this.fe.Xo(bb)}Nie(bb){this.EWb&&2===this.EWb.bZj?this.Q9i(bb):w.AFrameworkApplication.DIa(Object(c.a)(this,this.anc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.$mc,"onRefreshFilenameFailure"),!0)}Q9i(bb){this.fe.Xo(bb);this.skb=null}anc(bb){bb&&this.ACf(bb.BreadcrumbFolderName,bb.BreadcrumbFolderUrl,bb.NewName,null)}r4e(){this.La.processAction(y.a.fileNameUpdate,2)}$mc(){}}Object(t.a)(ya,"RenamedFileCheckerUsingTask",
xa,[]);var ib=a(94);class wa{constructor(){this.nb=this.fb=null}get name(){return"Common.App.RenameFile"}Rh(bb){this.fb=bb;this.nb=w.AFrameworkApplication.fa;this.fb.register(oa,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Fc(()=>new oa(w.AFrameworkApplication.wb,this.fb.zKd("Common.App.Rename.IRenameDialogFactory"))).tc();this.fb.register(Ra,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Fc(()=>new Ra(w.AFrameworkApplication.wb)).tc();
this.fb.register(410,"Common.App.Rename.IRenamedFileChecker").Fc(()=>this.L8g()).tc();this.fb.register(ca,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Fc(()=>new ca(w.AFrameworkApplication.wb,ib.FocusManager.instance())).tc()}L8g(){if(this.nb.qa("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const bb=this.fb.vh("Common.IRefreshableAppSettings");if(bb&&bb.Pod)return new ia(()=>bb.nd("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>w.AFrameworkApplication.hm,()=>
new Date,()=>w.AFrameworkApplication.Wy,bb,this.fb.vh("Common.ISessionStatus"),()=>qa.instance,this.fb.Wb("Postmessage.IHostPostmessenger"))}return new ya(()=>this.nb.nd("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.nb.nd("RenamedFileCheckerPingIntervalInMs",12E4),()=>w.AFrameworkApplication.hm,()=>new Date,()=>w.AFrameworkApplication.Wy,w.AFrameworkApplication.fa,w.AFrameworkApplication.wb,w.AFrameworkApplication.zi,this.fb.vh("Common.ISessionStatus"),this.fb.Wb("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.nb.gv(Object(c.a)(this,
this.pB,"onFullAppSettingsReady"))}pB(){const bb=w.AFrameworkApplication.ta.Oa.$r;w.AFrameworkApplication.x6a()&&M.instance.initialize(w.AFrameworkApplication.i8b,bb?null:w.AFrameworkApplication.b1a,bb?null:w.AFrameworkApplication.XId||CommonUIStrings.l_RenameFileTooltip)&&(this.fb.register(aa,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Fc(()=>new aa(()=>w.AFrameworkApplication.userCanRename,()=>w.AFrameworkApplication.isReadOnlyRecommended,w.AFrameworkApplication.Urc,w.AFrameworkApplication.x6a,
new b.a(()=>w.AFrameworkApplication.Wy))).tc(),qa.instance.Gg(),this.nb.qa("RenameDialogIsEnabled")&&(this.fb.resolve("Common.App.Rename.RenameDialogFactory").initialize(w.AFrameworkApplication.hm,w.AFrameworkApplication.i8b),this.fb.resolve("Common.App.Rename.IRenameDialogActor").Gg()),this.fb.resolve("Common.App.Rename.IRenameFlyoutActor").Gg(),w.AFrameworkApplication.Urc&&this.fb.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.fb.resolve("Common.App.Rename.IRenameFlyoutActor").mCg())}dispose(){}}
Object(t.a)(wa,"PackageManager",null,[4,5]);var sa=a(246);a.d(C,"a",function(){return Ya});const Ya=()=>{Type.registerNamespace("Common.App.Rename");sa.a.instance.yi(new wa,7)}},1439:function(t,C,a){a.r(C);t=a(1137);var c=a(10);C=a(0);var b=a(691),d=a(50),f=a(37),e=a(4),k=a(59),l=a(182),m=a(25),v=a(55);class n{constructor(qa){this.renameFileManager=qa}executeCommand(qa,O,ea){switch(O.command){case m.a.kha:return k.a.tg.$r?2!==e.AFrameworkApplication.wb.de(m.a.kha,2,ea)?v.Task.Ta(!0):l.a(O.command):
l.a(O.command);case 1897077126:return this.renameFileManager.renameFile(ea,O),v.Task.Ta(!0);default:return l.a(O.command)}}Cc(qa,O,ea,R){switch(O.command){case m.a.kha:return k.a.tg.$r;case 1897077126:return!!R&&2===R.Sy}return!1}Rc(){return!1}Nc(){return!1}dispose(){this.renameFileManager=null}}Object(C.a)(n,"RenameFileCommandHandler",null,[195,2]);class w extends b.a{constructor(qa){super(qa)}yd(){const qa=d.GetServiceTaskFactory.create(this.$.da,119,this.la,this.hb);f.TaskExtensions.Aa(qa,()=>
{this.gd([new n(qa.result)])},this.la,3)}static ka(qa){b.a.Nd(118,new w(qa))}}Object(C.a)(w,"RenameFileCommandHandlerFactory",b.a,[]);var r=a(86),u=a(221),y=a(225),x=a(15),B=a(30),z=a(78),A=a(375),I=a(77),F=a(368),U=a(170),X=a(90),S=a(281),H=a(1),D=a(22),J=a(280);class M{constructor(qa){this.$=qa}get lcf(){return this.$.workbookContext.FileCoauthorable}get Myb(){return!1}get bub(){return this.$.ea.amIAlone}get QHe(){if(this.bub)return!0;for(const qa of this.$.ea.Jm)if(!qa.SupportsRename)return!1;
return!0}}Object(C.a)(M,"EwaCoauthManager",null,[750]);var G=a(61),T=a(68);class K extends z.a{constructor(qa,O){super();this.Fca=this.WId=this.wQf=this.E4c=null;this.wja=()=>{var ea=this.$.ea.to;if(ea&&ea.WorkbookFileName){var R=B.a.uq(ea.WorkbookFileName),oa=!!D.a.compare(this.$.workbookContext.WorkbookFileName,ea.WorkbookFileName,!1),pa=H.EwaSettings.ma(535)&&!!ea.BreadcrumbFolderUrl&&!!D.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,ea.BreadcrumbFolderUrl,!1);if(oa||pa)this.Fca=
{},this.Fca.NewFileName=R,this.Fca.EditDocInClientUrl=ea.EditDocInClientUrl,this.Fca.DirectInvokeDAVUrl=ea.DirectInvokeDAVUrl,this.Fca.DownloadACopyUrl=ea.DownloadACopyUrl,H.EwaSettings.ma(535)&&ea.BreadcrumbFolderUrl&&(this.Fca.BreadcrumbFolderName=ea.BreadcrumbFolderName,this.Fca.BreadcrumbFolderUrl=ea.BreadcrumbFolderUrl),ea=e.AFrameworkApplication.wb.de(m.a.fileNameUpdate,2,R),this.Fca=null,x.ULS.shipAssertTag(537154064,0,32===ea,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};
this.UIi=(ea,R,oa)=>{this.wQf=R;this.WId=oa;this.$.Ka.Mb(new X.a(1897077126,I.a.Eb,2,3,null),{["newFileName"]:ea})};this.TIi=ea=>{this.Fca&&ea(this.z0e(this.Fca),this.Wr)};this.sEb=ea=>{S.a(ea)||!ea.Result?(ea=K.wFh(ea),T.a(this.$).jd.XL([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),this.WId(ea)):this.wQf(this.z0e(ea.Result),this.Wr)};this.APi=()=>{this.WId(5)};this.$=qa;this.Wr=O;this.$.ea.Lu(this.wja)}initialize(){e.AFrameworkApplication.I7b=this.UIi;e.AFrameworkApplication.DIa=
this.TIi;this.E4c=e.AFrameworkApplication.Wy;e.AFrameworkApplication.Wy=new M(this.$)}dispose(){e.AFrameworkApplication.I7b=null;e.AFrameworkApplication.DIa=null;this.$.ea.Hw(this.wja);e.AFrameworkApplication.Wy=this.E4c;this.$=this.E4c=null;super.dispose()}renameFile(qa,O){const ea=qa.newFileName;if(ea){const R=this.$.oa.va.Sb();F.a(this.$.userOperationManager,(oa,pa,Pa)=>{var Z=this.$.oa.va;oa=J.b(oa,this.sEb);pa=J.a(pa,this.APi);const Ra=Z.Na(9,R);Ra.newFileName=ea;return G.g(Z,"RenameFile",Ra,
oa,pa,Pa,null,0)},oa=>new U.a(134,0,oa),O)}}dfi(){return 32===e.AFrameworkApplication.wb.processAction(m.a.kha,1)}z0e(qa){var O=this.$.workbookContext;e.AFrameworkApplication.sY=qa.DownloadACopyUrl;const ea=H.EwaSettings.ma(535)&&!!qa.BreadcrumbFolderUrl;ea&&(e.AFrameworkApplication.hm.breadcrumbFolderName=qa.BreadcrumbFolderName,e.AFrameworkApplication.hm.breadcrumbFolderUrl=qa.BreadcrumbFolderUrl,O.FullDocumentInfo.BreadcrumbFolderUrl=qa.BreadcrumbFolderUrl,O.FullDocumentInfo.BreadcrumbFolderName=
qa.BreadcrumbFolderName);O.FullDocumentInfo.BreadcrumbDocName=qa.NewFileName;A.d(O,qa.NewFileName);O={};O.NewName=qa.NewFileName;O.DirectInvokeDavUrl=qa.DirectInvokeDAVUrl;O.EditDocInClientUrl=qa.EditDocInClientUrl;ea&&(O.BreadcrumbFolderName=qa.BreadcrumbFolderName,O.BreadcrumbFolderUrl=qa.BreadcrumbFolderUrl);O.OperationResult=0;return O}static wFh(qa){switch(qa.Errors[0].MessageId){case -414480287:qa=2;break;case 650565124:qa=1;break;case 1636785843:qa=6;break;case -782844485:qa=4;break;default:qa=
5}return qa}}Object(C.a)(K,"RenameFileManager",z.a,[692,2]);var L=a(51);class V extends u.a{constructor(qa){super();this.iY=this.renameFileManager=null;this.$=qa;this.Fb()}create(){if(!this.iY){const qa=y.a.m0a(L.b(),this.la,"Task","IRenameFileManager");this.iY=qa.task;const O=d.GetServiceTaskFactory.create(this.$.da,137,this.la,this.hb),ea=d.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb);f.TaskExtensions.Aa(f.TaskExtensions.Wd([ea,O],this.la),()=>{const R=new K(this.$,O.result);this.$.da.Ga(120,
R);qa.setResult(R)},this.la,3)}this.iY.continueWith(qa=>{this.qb(qa.result)})}dispose(){r.a.Ia(this.renameFileManager);this.$=this.renameFileManager=null;super.dispose()}static ka(qa){qa.da.Ga(119,new V(qa))}}Object(C.a)(V,"RenameFileManagerServiceFactory",u.a,[]);class W{constructor(qa){this.ai=qa}Nc(){return!1}executeCommand(qa,O,ea){return 2!==this.ai.de(m.a.v3f,2,ea)?v.Task.Ta(!0):l.a(O.command)}Cc(qa,O){return 1204860550===O.command}Rc(){return!1}}Object(C.a)(W,"RenameFileDialogCommandHandler",
null,[195]);class da extends b.a{constructor(qa){super(qa)}yd(){f.TaskExtensions.Aa(d.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),()=>{this.gd([new W(e.AFrameworkApplication.wb)])},this.la,3)}static ka(qa){b.a.Nd(131,new da(qa))}}Object(C.a)(da,"RenameFileDialogCommandHandlerFactory",b.a,[]);Type.registerNamespace("_Ewa");Object(t.a)();(()=>{c.a.Fa(qa=>{V.ka(qa);w.ka(qa)})})();c.a.Fa(da.ka)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.rn.js.map/f40ea48746cdd503537ba6061d3a47b6/EwaDSEsNext.rn.js.map