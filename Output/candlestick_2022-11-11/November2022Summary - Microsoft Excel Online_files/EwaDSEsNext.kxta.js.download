'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[2],{1090:function(t,C,a){a.r(C);a.d(C,"InsightsMenuItemFactory",function(){return f});t=a(0);var c=a(698),b=a(308),d=a(30);class f{constructor(e=null){this.bqg=e||CommonUIStrings.l_InsightsButtonText}get gQa(){return 10}HP(e){var k=e.Kz;e=c.a.x4()?c.a.Ksa(k,1):c.a.j3c(k);k=String.format(this.bqg,k);return this.OEh(e,k)}OEh(e,k){return b.a(f.n$e,c.a.x4()?"1914896509":"3317204163",d.a.gf(k),c.a.pbi,null,d.a.gf(e),
d.a.gf(k),null,null)}}f.n$e="bInsights";Object(t.a)(f,"InsightsMenuItemFactory",null,[644])},1091:function(t,C,a){a.d(C,"a",function(){return d});t=a(0);var c=a(308),b=a(30);class d{constructor(f,e,k,l,m){this.ZUb=f;this.YUb=e;this.Vwg=k;this.spg=l;this.V6d=m}get gQa(){return 4}HP(f,e=null){e=e.sessionId+"|"+e.QU+"|"+f.Kz;if(this.V6d||this.spg){let k=this.V6d||b.a.Pda(CommonUIStrings.l_HelpTooltip)===b.a.Pda(f.Kz.trim());if(this.Vwg&&2<f.Kz.length){const l=f.Kz;";"===l.charAt(0)&&";"===l.charAt(l.length-
1)&&l.substring(1,l.length-1)===d.did&&(k=!0)}f=k?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,f.Kz);return this.JUe(e,b.a.gf(f),k)}return this.JUe(e,b.a.gf(String.format(CommonUIStrings.l_TextWithQuotation,f.Kz)),!1)}JUe(f,e,k){return c.a(d.did,k?this.YUb:this.ZUb,e,"OfficeAssistant_16x16x32","A0",b.a.gf(f),e,null,null)}}d.did="bSearchHelp";Object(t.a)(d,"AssistanceMenuItemFactory",null,[644])},1092:function(t,C,a){a.d(C,"a",function(){return e});
t=a(0);var c=a(4),b=a(308),d=a(151),f=a(30);class e{get gQa(){return 13}HP(){return e.YPg()}static YPg(){return b.b(e.sSe,"798637440",f.a.gf(CommonUIStrings.l_LookupFirstRunExperienceTitle),c.AFrameworkApplication.fB,d.getImageClass("Info_32x32x32"),null,null,f.a.gf(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,f.a.gf(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}e.sSe="bTellMeFirstRun";Object(t.a)(e,"FirstRunMenuItemFactory",null,[644])},1093:function(t,
C,a){a.d(C,"a",function(){return f});t=a(0);var c=a(4),b=a(308),d=a(30);class f{constructor(e=null,k=null){this.Nae=e;this.xsg=k||CommonUIStrings.l_LookupNoResultsDescription}get gQa(){return 14}HP(e){e=String.format(this.xsg,e.Kz);return this.AQg(e)}AQg(e){return b.b(f.qrf,"798637440",d.a.gf(CommonUIStrings.l_LookupNoResultsTitle),this.Nae?c.AFrameworkApplication.fB:null,this.Nae,null,null,d.a.gf(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,d.a.gf(e),null,null)}}f.qrf="lookupNoResults";
Object(t.a)(f,"NoCommandsFoundMenuItemFactory",null,[644])},1094:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b,d){this.FontWeight=0;this.Text=null;this.FontWeight=b;this.Text=d}}Object(t.a)(c,"LabelFormatted",null,[])},1095:function(t,C,a){a.d(C,"a",function(){return k});t=a(0);a(703);var c=a(706),b=a(708),d=a(707),f=a(698),e=a(30);class k{constructor(l){this.Ua=l}Px(){return"Assistance"}eF(){return 0===this.Ua.Ll?0:1===this.Ua.Ll?1:this.Ua.QEb?3:2}nv(l,m,v=!1,n,w=null){n=
new d.a(l);if((!w||Array.contains(w,8))&&!f.a.cD(l)){w=new b.a(8);if(v){v=e.a.Pda(CommonUIStrings.l_HelpTooltip)===e.a.Pda(l.Hd.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,l.Hd);const r=[];this.Ua.Mwa&&(this.Ua.EQd||r.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),v=this.f_e(l.Hd));const u="||"+l.Hd;r.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",v));r.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",
u));appChrome.api.dispatch(r);l=new c.a("GetHelpFromTellMe",4,l.Hd,null,1)}else l=new c.a("bSearchHelp",4,l.Hd,null,1);w.Fn(l);w.displayName=CommonUIStrings.l_HelpButtonTitle;n.Cm(w)}m.resultsUpdated(n)}nva(l,m=null){const v=new b.a(8),n=e.a.Pda(CommonUIStrings.l_HelpTooltip)===e.a.Pda(l.Hd.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,l.Hd);for(let r=0;r<m.length&&2>r;r++){var w=void 0;w=[];let u="GetHelpWithDescriptionFromTellMe"+(r+1).toString(),
y=4;if(this.Ua.UKb)w.push(appChrome.actions.setControlLabel(u,n)),w.push(appChrome.actions.setCompoundButtonCommandValueId(u,l.Hd)),w.push(appChrome.actions.updateCompoundButtonDescription(u,this.EYh(m.length)));else if(this.Ua.VKb){let x=this.v2e(m[r]);u="GetHelpFromTellMe"+(r+1).toString();this.Ua.Mwa&&(x=this.f_e(x));y=9;w.push(appChrome.actions.setControlLabel(u,x));w.push(appChrome.actions.setButtonCommandValueId(u,this.CYh(m[r])))}appChrome.api.dispatch(w);w=new c.a(u,y,null,null,0);w.label=
this.v2e(m[r]);w.description=this.BYh(m[r]);v.Fn(w);if(this.Ua.VKb)break}v.displayName=CommonUIStrings.l_HelpButtonTitle;return v}EYh(l){return 1===l?String.format(CommonUIStrings.l_SearchResultText,l):String.format(CommonUIStrings.l_SearchResultsText,l)}f_e(l){return this.Ua.Opd?f.a.ldd(l,CommonUIStrings.l_HelpScopedButtonText):l+CommonUIStrings.l_HelpScopedButtonText}v2e(l){return l.name?l.name:""}BYh(l){return l.description?l.description:""}CYh(l){return l.id?"AssetID="+l.id:""}}Object(t.a)(k,
"AssistanceResultsProvider",null,[645])},1096:function(t,C,a){a.d(C,"a",function(){return l});t=a(0);a(703);var c=a(706),b=a(708),d=a(707),f=a(699),e=a(698),k=a(910);class l{constructor(m){this.Ua=m}Px(){return"Image"}eF(){return 0===this.Ua.Ll?0:1===this.Ua.Ll?1:3===this.Ua.Ll?3:2}nv(m,v,n,w,r=null){n=new d.a(m);(!r||Array.contains(r,19))&&e.a.cD(m)&&this.Ua.yy&&this.nva(m,n,1);v.resultsUpdated(n)}nva(m,v,n,w=null){var r=[];let u;f.TellMeActor.instance.Ox()&&f.TellMeActor.instance.Ox().Mwa?(u=this.Ua.Opd?
e.a.ldd(m.Hd,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):m.Hd+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.Ua.EQd||r.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):u=this.Ua.yy?e.a.cD(m)?this.Ua.Cra?e.a.xua(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.Ua.Cra?e.a.xua(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,m.Hd)):
String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,m.Hd):this.Ua.Ocb?CommonUIStrings.l_TellMeImageSuggestionButtonText:m.Hd+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.Ua.I3?(f.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",u)),r=e.a.Ksa(m.Hd,9,Object.assign(new k.a,{landingTab:"Image"})),f.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",r))):(r.push(appChrome.actions.setControlLabel("ImageForSearch",
u)),m=e.a.Ksa(m.Hd,9,Object.assign(new k.a,{landingTab:"Image"})),r.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",m)),appChrome.api.dispatch(r));n=new c.a("ImageForSearch",12,null,null,n);w&&(n.score=w.ConfidenceScore);w=new b.a(19,this.Ua.Ocb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);w.Fn(n);v.Cm(w)}}Object(t.a)(l,"ImageResultsProvider",null,[645])},1097:function(t,C,a){a.d(C,"a",function(){return k});t=a(0);a(703);var c=a(706),b=a(708),d=a(707),f=
a(698),e=a(4);class k{constructor(l){this.Ua=l}Px(){return"Template"}eF(){return 0===this.Ua.Ll?0:1===this.Ua.Ll?1:3}nv(l,m){l=new d.a(l);m.resultsUpdated(l)}nva(l,m,v){var n=[];let w;w=this.Ua.yy?this.Ua.Cra?f.a.xua(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,l.Hd)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,l.Hd):String.format(CommonUIStrings.l_TellMeTemplateButtonText,l.Hd);n.push(appChrome.actions.setControlLabel("TemplateForSearch",w));n.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(e.AFrameworkApplication.fa.Va("TellMeTemplateProviderURL"),e.AFrameworkApplication.uiCulture,l.Hd)));appChrome.api.dispatch(n);l=new b.a(23);l.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;n=new c.a("TemplateForSearch",24,null,null,0);n.label=v[0].Title?v[0].Title:"";n.description=v[0].Description?v[0].Description:"";l.Fn(n);m.Cm(l)}}Object(t.a)(k,"TemplateResultsProvider",null,[645])},1098:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(){this.syc=
this.Daa=this.Eva=this.Gm=this.Y_b=this.Br=this.KTa=0}}Object(t.a)(c,"TRIESCAN",null,[])},1130:function(t,C,a){a.r(C);var c=a(0),b=a(703),d=a(771),f=a(726),e=a(940);class k{constructor(Qa,xb){this.jkg=Qa;this.pi=xb}resultsUpdated(Qa){this.jkg.Orj(this.pi,Qa)}}Object(c.a)(k,"AggregatorResultsProviderCallback",null,[653]);var l=a(708),m=a(707);class v{constructor(Qa){this.OW=null;this.Ua=Qa;this.Ua.KFa&&(this.OW=null)}Px(){return"AppsForOffice"}eF(){return 0===this.Ua.Ll?0:1===this.Ua.Ll?1:2}nv(Qa,
xb,ac,zc,Yc=null){ac=new m.a(Qa);if(!Yc||Array.contains(Yc,1))Yc=new l.a(1),this.OW.XYj(Yc,Qa.Hd),ac.Cm(Yc);xb.resultsUpdated(ac)}}Object(c.a)(v,"AppsForOfficeRecommendationResultsProvider",null,[645]);var n=a(1095),w=a(694),r=a(715),u=a(412);class y{constructor(Qa,xb){this.Da=Qa;this.qwi=xb}isMatch(Qa,xb){if(!Object(u.a)(706,Qa))throw Error.argument("objToTest","Expected feature bundle");let ac;return({value:ac}=Qa.Mi(this.Da.MX)).returnValue?this.Da.UYd.isMatch(ac,xb):this.qwi}}Object(c.a)(y,"AnnotatedWithAndValueMatchesAnnotationFilter",
null,[741]);class x{constructor(Qa,xb){this.Da=Qa;this.bud=xb}isMatch(Qa){if(!Object(u.a)(706,Qa))throw Error.argument("objToTest","Expected feature bundle");return!!(this.bud^Qa.Mi(this.Da.MX).returnValue)}}Object(c.a)(x,"AnnotatedWithAnnotationFilter",null,[741]);class B{constructor(Qa){this.Da=Qa}isMatch(Qa,xb){if(!Object(u.a)(710,Qa))throw Error.argument("objToTest","Expected struct value");return this.Da.UYd.isMatch(Qa.Jua(this.Da.fieldIndex),xb)}}Object(c.a)(B,"FieldValueMatchesStructFilter",
null,[741]);class z{constructor(Qa,xb){Qa&&(this.fieldIndex=Qa.na(0),this.UYd=xb.DU(Qa.na(1)))}}Object(c.a)(z,"FieldValueMatchesStructFilterInit",null,[]);class A{constructor(Qa){this.bud=Qa}isMatch(Qa){if(!Object(u.a)(706,Qa))throw Error.argument("objToTest","Expected feature bundle");return!!(this.bud^Qa.rhd)}}Object(c.a)(A,"HasAnnotationsAnnotationFilter",null,[741]);class I{constructor(Qa,xb){this.Da=Qa;this.wK=xb}isMatch(Qa,xb){if(!Object(u.a)(709,Qa))throw Error.argument("objToTest","Expected list value");
switch(this.wK){case 0:for(const ac of Qa.items)if(this.Da.filter.isMatch(ac,xb))return!0;return!1;case 1:for(const ac of Qa.items)if(!this.Da.filter.isMatch(ac,xb))return!1;return!0;default:throw Error.notImplemented();}}}Object(c.a)(I,"ItemTestListFilter",null,[741]);class F{constructor(Qa){this.Da=Qa}isMatch(Qa,xb){if(!Object(u.a)(709,Qa))throw Error.argument("objToTest","Expected list value");return this.Da.filter.isMatch(Qa.items.length,xb)}}Object(c.a)(F,"LengthMatchesListFilter",null,[741]);
class U{constructor(Qa,xb){this.Da=Qa;this.wK=xb}isMatch(Qa,xb,ac=null){let zc=0===this.wK;for(const Yc of this.Da.gxe)if((zc=Yc.isMatch(Qa,xb,ac))?1===this.wK:0===this.wK)return zc;2===this.wK&&(zc=!zc);return zc}}Object(c.a)(U,"NonterminalFilter",null,[741]);class X{constructor(Qa,xb){if(Qa){var ac=Qa.na(0);this.gxe=Array(ac);for(let zc=0;zc<ac;++zc)this.gxe[zc]=xb.DU(Qa.na(1+zc))}}}Object(c.a)(X,"NonterminalFilterInit",null,[]);class S{constructor(Qa,xb){this.Da=Qa;this.wK=xb}isMatch(Qa,xb){if("number"!==
typeof Qa)throw Error.argument("objToTest","Expected number value");let ac=this.Da.number;if(this.Da.query){xb=this.Da.query.sk(null,xb);if("number"!==typeof xb)throw Error.invalidOperation("Query did not return number");ac+=xb}switch(this.wK){case 0:return Qa===ac;case 1:return Qa<ac;case 2:return Qa<=ac;case 3:return Qa>ac;case 4:return Qa>=ac;default:throw Error.notImplemented();}}}Object(c.a)(S,"NumberFilter",null,[741]);class H{constructor(Qa,xb){Qa&&(this.number=Qa.na(0),this.query=Qa.na(1)?
xb.Zu(Qa.na(1)):null)}}Object(c.a)(H,"NumberFilterInit",null,[]);class D{constructor(Qa,xb,ac){this.G$b=this.YMh;this.Cwi=Qa;this.dnf=xb;this.cnf=ac}tZc(Qa){this.dnf=Qa}YMh(Qa){if(!Qa)throw Error.argument("name","Invalid named feature bundle reference");const xb=Qa.substr(1);return 1===Qa.charCodeAt(0)&&xb===this.Cwi?this.dnf:this.cnf?this.cnf.G$b(Qa):null}}Object(c.a)(D,"SimpleNamedFeatureBundleResolver",null,[747]);class J{constructor(Qa){this.Da=Qa}isMatch(Qa,xb){if(!Object(u.a)(706,Qa))throw Error.argument("objToTest",
"Expected feature bundle");Qa=this.Da.query.sk(null,new D(this.Da.ABc,Qa,xb));if("boolean"!==typeof Qa)throw Error.invalidOperation("Query did not return bool");return Qa}}Object(c.a)(J,"PredicateAnnotationFilter",null,[741]);class M{constructor(Qa,xb){Qa&&(this.ABc=xb.ga(Qa.na(0)),this.query=xb.Zu(Qa.na(1)))}}Object(c.a)(M,"PredicateAnnotationFilterInit",null,[]);class G{constructor(Qa){this.Da=Qa}isMatch(Qa,xb){if("boolean"!==typeof Qa)throw Error.argument("objToTest","Expected bool value");xb=
this.Da.query.sk(null,xb);if("boolean"!==typeof xb)throw Error.invalidOperation("Query did not return bool");return Qa===xb}}Object(c.a)(G,"QueryBooleanFilter",null,[741]);class T{constructor(Qa,xb){this.Da=Qa;this.wK=xb}isMatch(Qa,xb){if("number"!==typeof Qa)throw Error.argument("objToTest","Expected integer");xb=this.Da.query.sk(null,xb);if("number"!==typeof xb)throw Error.invalidOperation("Query did not return an enum value");switch(this.wK){case 0:return Qa===xb;case 1:return 0!==(Qa&xb);case 2:return Qa===
(Qa&xb);case 3:return xb===(Qa&xb);default:throw Error.notImplemented();}}}Object(c.a)(T,"QueryEnumFilter",null,[741]);class K{constructor(Qa,xb){Qa&&(this.Nfc=1===Qa.na(0),this.query=xb.Zu(Qa.na(1)))}}Object(c.a)(K,"QueryEnumFilterInit",null,[]);class L{constructor(Qa,xb){this.Da=Qa;this.wK=xb}isMatch(Qa,xb){if(!Object(u.a)(709,Qa))throw Error.argument("objToTest","Expected list value");xb=this.Da.query.sk(null,xb);if(!Object(u.a)(709,xb))throw Error.invalidOperation("Query did not return list value");
if(Qa.bI!==xb.bI)return!1;switch(this.wK){case 0:return w.Annotations.vBa(w.Annotations.yQh(Qa.bI),Qa,xb);case 1:for(const ac of Qa.items)for(const zc of xb.items)if(w.Annotations.vBa(Qa.bI,ac,zc))return!0;return!1;case 2:for(const ac of Qa.items)for(const zc of xb.items)if(!w.Annotations.vBa(Qa.bI,ac,zc))return!1;return!0;case 3:for(const ac of xb.items)for(const zc of Qa.items)if(!w.Annotations.vBa(Qa.bI,ac,zc))return!1;return!0;default:throw Error.notImplemented();}}}Object(c.a)(L,"QueryListFilter",
null,[741]);class V{constructor(Qa,xb){this.Da=Qa;this.wK=xb}isMatch(Qa,xb){if("string"!==typeof Qa)throw Error.argument("objToTest","Expected string");xb=this.Da.query.sk(null,xb);if("string"!==typeof xb)throw Error.invalidOperation("Query did not return string");this.Da.Kld&&(Qa=Qa.toUpperCase(),xb=xb.toUpperCase());switch(this.wK){case 0:return Qa===xb;case 1:return 0<=Qa.indexOf(xb);case 2:return Qa.startsWith(xb);case 3:return Qa.endsWith(xb);case 4:return 0<=xb.indexOf(Qa);case 5:return xb.startsWith(Qa);
case 6:return xb.endsWith(Qa);default:throw Error.notImplemented();}}}Object(c.a)(V,"QueryStringFilter",null,[741]);class W{constructor(Qa,xb){Qa&&(this.query=xb.Zu(Qa.na(0)),this.Kld=1===Qa.na(1))}}Object(c.a)(W,"QueryStringFilterInit",null,[]);class da{constructor(Qa){this.Da=Qa}isMatch(Qa,xb){if(!Object(u.a)(710,Qa))throw Error.argument("objToTest","Expected struct value");xb=this.Da.query.sk(null,xb);if(!Object(u.a)(710,xb))throw Error.invalidOperation("Query did not return struct value");return Qa.isEqual(Qa)}}
Object(c.a)(da,"QueryStructFilter",null,[741]);class qa{constructor(Qa){this.Da=Qa}isMatch(Qa,xb){Qa=this.Da.query.sk(null,xb);if("boolean"!==typeof Qa)throw Error.invalidOperation("Query did not return bool");return Qa}}Object(c.a)(qa,"QueryWhereConstraintFilter",null,[741]);class O{constructor(Qa){this.Da=Qa}isMatch(Qa){if("string"!==typeof Qa)throw Error.argument("objToTest","Expected string");return this.Da.MGd.test(Qa)}}Object(c.a)(O,"RegexStringFilter",null,[741]);class ea{constructor(Qa,xb){Qa&&
(this.MGd=xb.u0e(Qa.na(0)))}}Object(c.a)(ea,"RegexStringFilterInit",null,[]);class R{constructor(Qa,xb){Qa&&(this.filter=xb.DU(Qa.na(0)))}}Object(c.a)(R,"SingleFilterFilterInit",null,[]);class oa{constructor(Qa,xb){Qa&&(this.query=xb.Zu(Qa.na(0)))}}Object(c.a)(oa,"SingleQueryFilterInit",null,[]);class pa{constructor(Qa){this.Da=Qa}isMatch(Qa){if("boolean"!==typeof Qa)throw Error.argument("objToTest","Expected bool value");return Qa===this.Da.value}}Object(c.a)(pa,"StoredValueBooleanFilter",null,[741]);
class Pa{constructor(Qa){Qa&&(this.value=1===Qa.na(0))}}Object(c.a)(Pa,"StoredValueBooleanFilterInit",null,[]);class Z{constructor(Qa,xb){this.Da=Qa;this.wK=xb}isMatch(Qa){if("number"!==typeof Qa)throw Error.argument("objToTest","Expected integer");switch(this.wK){case 0:return this.Da.Nfc?this.Da.value?!!(Qa&this.Da.value):!Qa:Qa===this.Da.value;case 1:return this.Da.Nfc?(Qa&this.Da.value)===this.Da.value:32>Qa&&(1<<Qa&this.Da.value)===this.Da.value;case 2:return this.Da.Nfc?!!(Qa&this.Da.value):
32>Qa&&!!(1<<Qa&this.Da.value);default:throw Error.notImplemented();}}}Object(c.a)(Z,"StoredValueEnumFilter",null,[741]);class Ra{constructor(Qa){Qa&&(this.Nfc=1===Qa.na(0),this.value=Qa.na(1))}}Object(c.a)(Ra,"StoredValueEnumFilterInit",null,[]);class Ga{constructor(){this.BVi=null;this.XXc=this.OKa=0}}Object(c.a)(Ga,"WHEREConstraintData",null,[]);class Ba{constructor(Qa){this.Da=Qa}isMatch(Qa,xb){if(!Object(u.a)(Ga,Qa))throw Error.argument("objToTest","Expected WHERE constraint data");let ac=-1,
zc=-1;const Yc=Qa.BVi;switch(this.Da.VYc){case 4:ac=Yc.ptb;zc=Yc.qSd;break;case 5:ac=Qa.OKa;zc=Yc.ptb-Qa.OKa;break;case 6:ac=Yc.ptb+Yc.qSd;zc=Qa.OKa+Qa.XXc-ac;break;case 1:case 2:case 3:let md=!1;for(let sd=Yc.dZj;sd;sd=sd.next)if(this.Da.rUj===sd.name){md=!0;1===this.Da.VYc?(ac=sd.ptb,zc=sd.qSd):2===this.Da.VYc?(ac=Qa.OKa,zc=sd.ptb-Qa.OKa):(ac=sd.ptb+sd.qSd,zc=Qa.OKa+Qa.XXc-ac);break}if(!md)return!1;break;case 7:ac=Qa.OKa;zc=Qa.XXc;break;default:throw Error.notImplemented();}return null!==this.Da.yDj.pZj(Yc.QZj,
ac,zc,ac,!0,2,xb)}}Object(c.a)(Ba,"SubSreWhereConstraintFilter",null,[741]);class fa{constructor(Qa,xb){if(Qa){var ac=xb.ga(Qa.na(0));this.VYc=ac.charCodeAt(0);this.rUj=ac.substr(1);this.yDj=xb.xVh(Qa.na(1))}}}Object(c.a)(fa,"SubSreWhereConstraintFilterInit",null,[]);class Y{constructor(Qa){this.Da=Qa}isMatch(Qa,xb,ac=null){if(!Object(u.a)(706,Qa))throw Error.argument("objToTest","Expected feature bundle");if(null==ac)throw Error.argumentNull("parentTextForSpan");if(this.Da.Noe&&!this.Da.Noe.isMatch(Qa,
xb))return!1;if(this.Da.yUd){let zc;if(({value:zc}=Qa.Mi(this.Da.cDj)).returnValue){if(!this.Da.yUd.isMatch(zc,xb))return!1}else{let Yc,md;if(!({value:Yc}=Qa.Mi(this.Da.L4f)).returnValue||!({value:md}=Qa.Mi(this.Da.K4f)).returnValue||0>Yc||0>md||Yc+md>ac.length||!this.Da.yUd.isMatch(ac.substr(Yc,md),xb))return!1}}if(this.Da.h5f){let zc;if(!({value:zc}=Qa.Mi(this.Da.L4f)).returnValue||!this.Da.h5f.isMatch(zc,xb))return!1}if(this.Da.Ejf){let zc;if(!({value:zc}=Qa.Mi(this.Da.K4f)).returnValue||!this.Da.Ejf.isMatch(zc,
xb))return!1}return!0}}Object(c.a)(Y,"TextSpanFilter",null,[741]);class ja{constructor(Qa,xb){Qa&&(this.annotations=xb.annotations,this.L4f=Qa.na(0),this.K4f=Qa.na(1),this.cDj=Qa.na(2),this.yUd=Qa.na(3)?xb.DU(Qa.na(3)):null,this.Noe=Qa.na(4)?xb.DU(Qa.na(4)):null,this.h5f=Qa.na(5)?xb.DU(Qa.na(5)):null,this.Ejf=Qa.na(6)?xb.DU(Qa.na(6)):null)}}Object(c.a)(ja,"TextSpanFilterInit",null,[]);class ca{constructor(Qa,xb){Qa&&(this.annotations=xb.annotations,this.MX=Qa.na(0),this.UYd=Qa.na(1)?xb.DU(Qa.na(1)):
null)}}Object(c.a)(ca,"ValueFilterAnnotationFilterInit",null,[]);var aa=a(732);class ta{DU(Qa,xb){const ac=Qa.na(0),zc=new aa.a;zc.oua(Qa,1,Qa.count-1);switch(ac){case 1:return new U(new X(zc,xb),0);case 2:return new U(new X(zc,xb),1);case 3:return new U(new X(zc,xb),2);case 101:return new O(new ea(zc,xb));case 103:return new V(new W(zc,xb),0);case 104:return new V(new W(zc,xb),1);case 105:return new V(new W(zc,xb),2);case 106:return new V(new W(zc,xb),3);case 107:return new V(new W(zc,xb),4);case 108:return new V(new W(zc,
xb),5);case 109:return new V(new W(zc,xb),6);case 201:return new pa(new Pa(zc));case 202:return new G(new oa(zc,xb));case 301:return new S(new H(zc,xb),0);case 302:return new S(new H(zc,xb),1);case 303:return new S(new H(zc,xb),2);case 304:return new S(new H(zc,xb),3);case 305:return new S(new H(zc,xb),4);case 401:return new Z(new Ra(zc),0);case 402:return new Z(new Ra(zc),1);case 403:return new Z(new Ra(zc),2);case 404:return new T(new K(zc,xb),0);case 405:return new T(new K(zc,xb),1);case 406:return new T(new K(zc,
xb),2);case 407:return new T(new K(zc,xb),3);case 501:return new B(new z(zc,xb));case 502:return new da(new oa(zc,xb));case 601:return new I(new R(zc,xb),0);case 602:return new I(new R(zc,xb),1);case 603:return new F(new R(zc,xb));case 604:return new L(new oa(zc,xb),0);case 605:return new L(new oa(zc,xb),1);case 606:return new L(new oa(zc,xb),2);case 607:return new L(new oa(zc,xb),3);case 701:return new A(!1);case 702:return new A(!0);case 703:return new x(new ca(zc,xb),!1);case 704:return new x(new ca(zc,
xb),!0);case 705:return new y(new ca(zc,xb),!1);case 706:return new y(new ca(zc,xb),!0);case 707:return new J(new M(zc,xb));case 901:return new Y(new ja(zc,xb));case 1002:return new qa(new oa(zc,xb));case 1001:return new Ba(new fa(zc,xb));default:throw Error.argument("initData");}}}Object(c.a)(ta,"FilterFactory",null,[705]);var xa=a(701);class ia{constructor(Qa){this.Da=Qa}get yq(){return this.Da.yq}get pI(){return this.Da.pI}get fyc(){return this.Da.fyc}get Cec(){return this.Da.Cec}load(Qa,xb){return this.sk(Qa,
Qa?new D("root",Qa,xb):xb)}store(Qa,xb,ac){this.xdb(Qa,xb,Qa?new D("root",Qa,ac):ac,null)}sk(Qa,xb){if(!this.Cec&&!this.Da.annotations.Z5a(this.yq,Qa))throw Error.argument("input","Input value not of expected type");let ac=this.Da.wSe;for(;ac;)Qa=ac.load(Qa,xb),ac=ac.next;return Qa}xdb(Qa,xb,ac,zc){if(!this.fyc)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.Cec&&!this.Da.annotations.Z5a(this.yq,Qa))throw Error.argument("lvalue","Lvalue not of expected type");
if(!this.Da.annotations.Z5a(this.pI,xb))throw Error.argument("rvalue","Rvalue not of expected type");return this.Da.wSe.store(Qa,xb,ac,zc)}static Wye(Qa,xb,ac,zc){if(ac===zc)return xb;if(w.Annotations.zt(ac)&&w.Annotations.zt(zc)){ac=w.Annotations.aja(ac);zc=w.Annotations.aja(zc);const Yc=new xa.a(Qa,zc);for(const md of xb.items)Array.add(Yc.items,ia.Wye(Qa,md,ac,zc));return Yc}if(ac===w.Annotations.h7){if(zc===w.Annotations.AW)return xb;if(zc===w.Annotations.tL)return xb.toString()}else if(ac===
w.Annotations.AW){if(zc===w.Annotations.h7)return Math.floor(xb);if(zc===w.Annotations.tL)return xb.toString()}else if(ac===w.Annotations.tL){if(zc===w.Annotations.h7)return parseInt(xb);if(zc===w.Annotations.AW)return parseFloat(xb)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(c.a)(ia,"AnnotationQuery",null,[740]);class ya{constructor(){this.pI=this.yq=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}bja(Qa){if(this.next)return{returnValue:this.next,
W6:Qa};if(Qa){const xb=Qa.KAe;Qa=Qa.ZHf;return{returnValue:xb,W6:Qa}}return{returnValue:null,W6:Qa}}}Object(c.a)(ya,"AnnotationQueryStep",null,[751]);class ib extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){xb=this.Da.query.sk(Qa,xb);if(w.Annotations.zt(this.yq)){var ac=w.Annotations.aja(this.yq);let Yc=new xa.a(this.Da.annotations,ac);if(w.Annotations.zt(this.Da.query.pI)){if(Qa.items.length!==xb.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");
for(let md=0,sd=Qa.items.length;md<sd;++md)Array.add(Yc.items,this.j0b(Qa.items[md],xb.items[md],ac===w.Annotations.AW))}else for(var zc of Qa.items)Array.add(Yc.items,this.j0b(zc,xb,ac===w.Annotations.AW));return Yc}if(w.Annotations.zt(this.Da.query.pI)){zc=new xa.a(this.Da.annotations,this.yq);for(ac of xb.items)Array.add(zc.items,this.j0b(Qa,ac,this.yq===w.Annotations.AW));return zc}return this.j0b(Qa,xb,this.yq===w.Annotations.AW)}j0b(Qa,xb,ac){Qa=this.SZa(Qa,xb);return ac?Qa:Math.floor(Qa)}}
Object(c.a)(ib,"NumericAnnotationQueryStep",ya,[]);class wa extends ib{constructor(Qa){super(Qa)}SZa(Qa,xb){return Qa+xb}}Object(c.a)(wa,"AddAnnotationQueryStep",ib,[]);class sa extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){if(this.yq===w.Annotations.r0&&this.Da.query.pI===w.Annotations.r0){let Yc;if(({result:Yc}=this.ive(Qa)).returnValue)return Yc}if(w.Annotations.zt(this.yq)){var ac=new xa.a(this.Da.annotations,w.Annotations.r0);xb=this.Da.query.sk(Qa,xb);if(w.Annotations.zt(this.Da.query.pI)){if(Qa.items.length!==
xb.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Yc=0,md=Qa.items.length;Yc<md;++Yc)Array.add(ac.items,this.$pb(xb.items[Yc],Qa.items[Yc]))}else for(var zc of Qa.items)Array.add(ac.items,this.$pb(xb,zc));return ac}zc=this.Da.query.sk(Qa,xb);if(w.Annotations.zt(this.Da.query.pI)){xb=new xa.a(this.Da.annotations,w.Annotations.r0);for(ac of zc.items)Array.add(xb.items,this.$pb(ac,Qa));return xb}return this.$pb(zc,Qa)}}Object(c.a)(sa,"BinaryBooleanAnnotationQueryStep",
ya,[]);class Ya extends sa{constructor(Qa){super(Qa)}ive(Qa){return{returnValue:!Qa,result:!1}}$pb(Qa,xb){return Qa&&xb}}Object(c.a)(Ya,"AndAnnotationQueryStep",sa,[]);class bb{constructor(Qa){Qa&&(this.annotations=Qa)}}Object(c.a)(bb,"AnnotationsOnlyQueryStepInit",null,[]);class mb extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){xb=this.Da.query.sk(Qa,xb);Qa=Qa.clone();w.Annotations.zt(this.Da.query.pI)?Array.addRange(Qa.items,xb.items):Array.add(Qa.items,xb);return Qa}}Object(c.a)(mb,
"AppendAnnotationQueryStep",ya,[]);class Ca extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){if(this.yq===w.Annotations.JB)return this.executeScript(Qa,xb);const ac=new xa.a(this.Da.annotations,w.Annotations.JB);for(const zc of Qa.items)Array.add(ac.items,this.executeScript(zc,xb));return ac}executeScript(Qa,xb){const ac=new r.a(this.Da.annotations);ac.tha(Qa);Qa=new r.a(this.Da.annotations);this.Da.script.I$(null,new D("Input",ac,new D("Output",Qa,xb)));return Qa}}Object(c.a)(Ca,"ApplyAnnotationQueryStep",
ya,[]);class $a extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){if(this.yq===w.Annotations.JB)return xb=this.executeScript(Qa,xb),xb.Mi(this.Da.Loe).returnValue||new xa.a(this.Da.annotations,w.Annotations.JB),xb;const ac=new xa.a(this.Da.annotations,w.Annotations.JB);for(const zc of Qa.items)if(Qa=this.executeScript(zc,xb),({value:Qa}=Qa.Mi(this.Da.Loe)).returnValue)for(const Yc of Qa.items)Array.add(ac.items,Yc);return ac}executeScript(Qa,xb){const ac=new r.a(this.Da.annotations);ac.tha(Qa);
Qa=new r.a(this.Da.annotations);this.Da.script.I$(null,new D("Input",ac,new D("Output",Qa,xb)));return Qa}}Object(c.a)($a,"ApplyExpandAnnotationQueryStep",ya,[]);class Kb{constructor(Qa,xb){Qa&&(this.annotations=xb.annotations,this.script=xb.pJa(Qa.na(0)),this.Loe=Qa.na(1))}}Object(c.a)(Kb,"ApplyExpandQueryStepInit",null,[]);class rb{constructor(Qa,xb){Qa&&(this.annotations=xb.annotations,this.script=xb.pJa(Qa.na(0)))}}Object(c.a)(rb,"ApplyQueryStepInit",null,[]);class cc extends ya{constructor(Qa){super();
this.Da=Qa}load(Qa){if(this.yq===w.Annotations.JB)return this.Iic(Qa);const xb=new xa.a(this.Da.annotations,this.Da.annotations.getAttributeType(this.Da.MX));for(const ac of Qa.items)Array.add(xb.items,this.Iic(ac));return xb}store(Qa,xb,ac,zc){if(this.yq===w.Annotations.JB){var Yc=xb,md=({W6:zc}=this.bja(zc)).returnValue;md&&(Yc=md.store(w.Annotations.QA(this.Iic(Qa)),xb,ac,zc));Qa.yn(this.Da.MX,Yc)}else{var sd=xb;if(Yc=({W6:zc}=this.bja(zc)).returnValue){sd=new xa.a(this.Da.annotations,this.Da.annotations.getAttributeType(this.Da.MX));
for(md of Qa.items)Array.add(sd.items,this.Iic(md));sd=Yc.store(sd,xb,ac,zc)}xb=sd;if(xb.items.length!==Qa.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let h=0,Ib=Qa.items.length;h<Ib;++h)ac=Qa.items[h],ac.isReadOnly&&(ac=ac.clone(),Qa.items[h]=ac),ac.yn(this.Da.MX,xb.items[h])}return Qa}Iic(Qa){({value:Qa}=Qa.Mi(this.Da.MX)).returnValue||(Qa=this.Da.annotations.wHh(this.Da.MX));return Qa}}Object(c.a)(cc,"AttrAnnotationQueryStep",ya,[]);class nc{constructor(Qa,
xb){Qa&&(this.annotations=xb,this.MX=Qa.na(0))}}Object(c.a)(nc,"AttrQueryStepInit",null,[]);class Wb extends ya{constructor(Qa){super();this.Da=Qa}load(Qa){const xb=new r.a(this.Da.annotations);xb.tha(Qa);return this.Da.module.execute(xb)}}Object(c.a)(Wb,"CallModuleAnnotationQueryStep",ya,[]);class Ea{constructor(Qa,xb){Qa&&(this.annotations=xb.annotations,this.module=xb.ced(Qa.na(0)))}}Object(c.a)(Ea,"CallModuleQueryStepInit",null,[]);class ua extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,
xb){if(w.Annotations.zt(this.yq)){var ac=this.Da.query.sk(Qa,xb);xb=new xa.a(this.Da.annotations,w.Annotations.tL);let md="string"===typeof ac;for(var zc of Qa.items)if(md)Array.add(xb.items,zc+ac);else for(var Yc of ac.items)Array.add(xb.items,zc+Yc);return xb}zc=this.Da.query.sk(Qa,xb);if("string"===typeof zc)return Qa+zc;Yc=new xa.a(this.Da.annotations,w.Annotations.tL);for(ac of zc.items)Array.add(Yc.items,Qa+ac);return Yc}}Object(c.a)(ua,"ConcatAnnotationQueryStep",ya,[]);class ma extends ya{constructor(Qa){super();
this.Da=Qa}load(Qa){return ia.Wye(this.Da.annotations,Qa,this.yq,this.pI)}}Object(c.a)(ma,"ConvertAnnotationQueryStep",ya,[]);class fb extends ya{constructor(){super()}load(Qa){return Qa.items.length}}Object(c.a)(fb,"CountAnnotationQueryStep",ya,[]);class sb extends ib{constructor(Qa){super(Qa)}SZa(Qa,xb){return Qa/xb}}Object(c.a)(sb,"DivideAnnotationQueryStep",ib,[]);class Ua extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){xb=new D(this.Da.ABc,null,xb);for(const ac of Qa.items)if(xb.tZc(ac),
this.Da.query.sk(ac,xb))return!0;return!1}}Object(c.a)(Ua,"ExistsAnnotationQueryStep",ya,[]);class ab extends ib{constructor(Qa){super(Qa)}SZa(Qa,xb){return Math.pow(Qa,xb)}}Object(c.a)(ab,"ExpAnnotationQueryStep",ib,[]);class na{constructor(Qa,xb){Qa&&(this.O$=xb.ga(Qa.na(0)))}}Object(c.a)(na,"FeatureBundleNameQueryStepInit",null,[]);class Na extends ya{constructor(Qa){super();this.Da=Qa}load(Qa){if(w.Annotations.zt(this.yq)){const xb=new xa.a(this.Da.annotations,this.Da.annotations.aKa(w.Annotations.aja(this.yq),
this.Da.fieldIndex));for(const ac of Qa.items)Array.add(xb.items,ac.Jua(this.Da.fieldIndex));return xb}return Qa.Jua(this.Da.fieldIndex)}store(Qa,xb,ac,zc){if(w.Annotations.zt(this.yq)){var Yc=xb,md=({W6:zc}=this.bja(zc)).returnValue;if(md){Yc=new xa.a(this.Da.annotations,this.Da.annotations.aKa(w.Annotations.aja(this.yq),this.Da.fieldIndex));for(var sd of Qa.items)Array.add(Yc.items,sd.Jua(this.Da.fieldIndex));Yc=md.store(Yc,xb,ac,zc)}xb=Yc;if(xb.items.length!==Qa.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");
for(let h=0,Ib=Qa.items.length;h<Ib;++h)ac=Qa.items[h],ac.isReadOnly&&(ac=ac.clone(),Qa.items[h]=ac),ac.INd(this.Da.fieldIndex,xb.items[h])}else md=xb,(sd=({W6:zc}=this.bja(zc)).returnValue)&&(md=sd.store(w.Annotations.QA(Qa.Jua(this.Da.fieldIndex)),xb,ac,zc)),Qa.INd(this.Da.fieldIndex,md);return Qa}}Object(c.a)(Na,"FieldAnnotationQueryStep",ya,[]);class Va{constructor(Qa,xb){Qa&&(this.annotations=xb,this.fieldIndex=Qa.na(0))}}Object(c.a)(Va,"FieldQueryStepInit",null,[]);class Sa extends ya{constructor(Qa){super();
this.Da=Qa}load(Qa,xb){for(const ac of Qa.items)if(this.Da.filter.isMatch(ac,xb))return ac;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(Qa,xb,ac,zc){let Yc=xb,md=-1;for(let h=0,Ib=Qa.items.length;h<Ib;h++)if(this.Da.filter.isMatch(Qa.items[h],ac)){md=h;break}if(0>md)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const sd=({W6:zc}=this.bja(zc)).returnValue;sd&&(Yc=sd.store(w.Annotations.QA(Qa.items[md]),xb,ac,zc));
Qa.items[md]=Yc;return Qa}}Object(c.a)(Sa,"FirstItemMatchingAnnotationQueryStep",ya,[]);class vb extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){xb=new D(this.Da.ABc,null,xb);for(const ac of Qa.items)if(xb.tZc(ac),!this.Da.query.sk(ac,xb))return!1;return!0}}Object(c.a)(vb,"ForAllAnnotationQueryStep",ya,[]);class Oa extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){Qa=xb?xb.G$b(this.Da.O$):null;if(!Qa)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Da.O$+
'"');return Qa}store(Qa,xb,ac,zc){Qa=ac?ac.G$b(this.Da.O$):null;if(!Qa)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Da.O$+'"');let Yc=xb;const md=({W6:zc}=this.bja(zc)).returnValue;md&&(Yc=md.store(Qa,xb,ac,zc));Qa!==Yc&&Qa.tha(Yc);return Qa}}Object(c.a)(Oa,"GetAnnotationQueryStep",ya,[]);class yb{constructor(Qa,xb){this.Img=Qa;this.Htg=xb}get KAe(){return this.Img}get ZHf(){return this.Htg}}Object(c.a)(yb,"AnnotationQueryStoreContinuation",null,[761]);class Ob extends ya{constructor(Qa){super();
this.Da=Qa}load(Qa,xb){return this.Da.Lyc.sk(Qa,xb)?this.Da.y$f.sk(Qa,xb):this.Da.Z7b?this.Da.Z7b.sk(Qa,xb):Qa}store(Qa,xb,ac,zc){var Yc=this.Da.Lyc.sk(Qa,ac);this.next&&(zc=new yb(this.next,zc));if(Yc)return this.Da.y$f.xdb(Qa,xb,ac,zc);if(this.Da.Z7b)return this.Da.Z7b.xdb(Qa,xb,ac,zc);Yc=xb;let md=null;zc&&(md=zc.KAe,zc=zc.ZHf);md&&(Yc=md.store(w.Annotations.QA(Qa),xb,ac,zc));return Yc}}Object(c.a)(Ob,"IfAnnotationQueryStep",ya,[]);class Ja{constructor(Qa,xb){Qa&&(this.Lyc=xb.Zu(Qa.na(0)),this.y$f=
xb.Zu(Qa.na(1)),this.Z7b=Qa.na(2)?xb.Zu(Qa.na(2)):null)}}Object(c.a)(Ja,"IfQueryStepInit",null,[]);class lb{constructor(Qa,xb){Qa&&(this.V7h=xb.Zu(Qa.na(0)),this.Chf=xb.Zu(Qa.na(1)))}}Object(c.a)(lb,"IndexAndItemQueryStepInit",null,[]);class Pb extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){const ac=this.Da.V7h.sk(Qa,xb);xb=this.Da.Chf.sk(Qa,xb);Qa=Qa.clone();if(0>ac||ac>Qa.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(w.Annotations.zt(this.Da.Chf.pI))for(let zc=
0;zc<xb.items.length;++zc)Array.insert(Qa.items,ac+zc,xb.items[zc]);else Array.insert(Qa.items,ac,xb);return Qa}}Object(c.a)(Pb,"InsertAtAnnotationQueryStep",ya,[]);class Jb extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){return!(!xb||!xb.G$b(this.Da.O$))}}Object(c.a)(Jb,"IsDefinedAnnotationQueryStep",ya,[]);class Lb extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){xb=this.Vub(Qa,xb);return Qa.items[xb]}store(Qa,xb,ac,zc){const Yc=this.Vub(Qa,ac);let md=xb;const sd=({W6:zc}=this.bja(zc)).returnValue;
sd&&(md=sd.store(w.Annotations.QA(Qa.items[Yc]),xb,ac,zc));Qa.items[Yc]=md;return Qa}Vub(Qa,xb){xb=this.Da.query.sk(Qa,xb);if(0>xb||xb>=Qa.items.length)throw Error.invalidOperation("Index out of range in Item store step");return xb}}Object(c.a)(Lb,"ItemAnnotationQueryStep",ya,[]);class Ab extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){const ac=new xa.a(this.Da.annotations,w.Annotations.aja(this.yq));for(const zc of Qa.items)this.Da.filter.isMatch(zc,xb)&&Array.add(ac.items,zc);return ac}}
Object(c.a)(Ab,"ItemsMatchingAnnotationQueryStep",ya,[]);class nb extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){xb=this.Vub(Qa,xb);return Qa.items[Qa.items.length-xb-1]}store(Qa,xb,ac,zc){const Yc=this.Vub(Qa,ac);let md=xb;const sd=({W6:zc}=this.bja(zc)).returnValue;sd&&(md=sd.store(w.Annotations.QA(Qa.items[Qa.items.length-Yc-1]),xb,ac,zc));Qa.items[Qa.items.length-Yc-1]=md;return Qa}Vub(Qa,xb){xb=this.Da.query?this.Da.query.sk(Qa,xb):0;if(0>xb||xb>=Qa.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return xb}}Object(c.a)(nb,"LastItemAnnotationQueryStep",ya,[]);class va extends ya{constructor(Qa){super();this.Da=Qa}load(Qa){if(w.Annotations.zt(this.yq)){const xb=new xa.a(this.Da.annotations,w.Annotations.h7);for(const ac of Qa.items)Array.add(xb.items,ac.length);return xb}return Qa.length}}Object(c.a)(va,"LengthAnnotationQueryStep",ya,[]);class db extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){if(w.Annotations.zt(this.yq)){const ac=new xa.a(this.Da.annotations,w.Annotations.r0);for(const zc of Qa.items)Array.add(ac.items,
this.Da.filter.isMatch(zc,xb));return ac}return this.Da.filter.isMatch(Qa,xb)}}Object(c.a)(db,"MatchesAnnotationQueryStep",ya,[]);class Xa extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){return this.Da.filter.isMatch(Qa,xb)}}Object(c.a)(Xa,"MatchesAsListAnnotationQueryStep",ya,[]);class gb extends ib{constructor(Qa){super(Qa)}SZa(Qa,xb){return Qa%xb}}Object(c.a)(gb,"ModuloAnnotationQueryStep",ib,[]);class Ha extends ib{constructor(Qa){super(Qa)}SZa(Qa,xb){return Qa*xb}}Object(c.a)(Ha,"MultiplyAnnotationQueryStep",
ib,[]);class tb extends ya{constructor(Qa){super();this.Da=Qa}load(Qa){if(w.Annotations.zt(this.yq)){const xb=new xa.a(this.Da.annotations,w.Annotations.r0);for(const ac of Qa.items)Array.add(xb.items,!ac);return xb}return!Qa}}Object(c.a)(tb,"NotAnnotationQueryStep",ya,[]);class bc extends sa{constructor(Qa){super(Qa)}ive(Qa){return{returnValue:Qa,result:!0}}$pb(Qa,xb){return Qa||xb}}Object(c.a)(bc,"OrAnnotationQueryStep",sa,[]);class tc extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){const ac=
this.Da.QSd.sk(Qa,xb);Qa=this.Da.qqb.sk(Qa,xb);xb=new xa.a(this.Da.annotations,w.Annotations.h7);for(let zc=0;zc<Qa;++zc)Array.add(xb.items,ac+zc);return xb}}Object(c.a)(tc,"RangeAnnotationQueryStep",ya,[]);class Ma{constructor(Qa,xb){Qa&&(this.annotations=xb.annotations,this.filter=xb.DU(Qa.na(0)))}}Object(c.a)(Ma,"SingleFilterQueryStepInit",null,[]);class Tb{constructor(Qa,xb){Qa&&(this.annotations=xb.annotations,this.query=Qa.na(0)?xb.Zu(Qa.na(0)):null)}}Object(c.a)(Tb,"SingleOptionalQueryQueryStepInit",
null,[]);class zb{constructor(Qa,xb){Qa&&(this.annotations=xb.annotations,this.query=xb.Zu(Qa.na(0)))}}Object(c.a)(zb,"SingleQueryQueryStepInit",null,[]);class ic{constructor(Qa,xb){Qa&&(this.annotations=xb.annotations,this.QSd=xb.Zu(Qa.na(0)),this.qqb=Qa.na(1)?xb.Zu(Qa.na(1)):null)}}Object(c.a)(ic,"StartAndCountOrLengthQueryStepInit",null,[]);class Qb extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){let ac;({startIndex:xb,length:ac}=this.Oac(Qa,xb));const zc=new xa.a(this.Da.annotations,
Qa.bI);for(let Yc=0;Yc<ac;++Yc)Array.add(zc.items,Qa.items[xb+Yc]);return zc}store(Qa,xb,ac,zc){let Yc,md;({startIndex:Yc,length:md}=this.Oac(Qa,ac));var sd=xb;const h=({W6:zc}=this.bja(zc)).returnValue;if(h){sd=new xa.a(this.Da.annotations,Qa.bI);for(let Ib=0;Ib<md;++Ib)Array.add(sd.items,Qa.items[Yc+Ib]);sd=h.store(sd,xb,ac,zc)}xb=sd;for(ac=0;ac<md;++ac)Array.removeAt(Qa.items,Yc);for(let Ib=0,ec=xb.items.length;Ib<ec;++Ib)Array.insert(Qa.items,Yc+Ib,xb.items[Ib]);return Qa}Oac(Qa,xb){let ac;ac=
this.Da.QSd.sk(Qa,xb);if(0>ac)throw Error.invalidOperation("Invalid start index in Sublist() query step");xb=this.Da.qqb?this.Da.qqb.sk(Qa,xb):Qa.items.length-ac;if(0>xb||ac+xb>Qa.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:ac,length:xb}}}Object(c.a)(Qb,"SublistAnnotationQueryStep",ya,[]);class wb extends ya{constructor(Qa){super();this.Da=Qa}load(Qa,xb){if(w.Annotations.zt(this.yq)){const ac=new xa.a(this.Da.annotations,
w.Annotations.tL);for(let zc=0,Yc=Qa.items.length;zc<Yc;++zc)Array.add(ac.items,this.W1e(Qa.items[zc],xb));return ac}return this.W1e(Qa,xb)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}W1e(Qa,xb){let ac;({startIndex:xb,length:ac}=this.Oac(Qa,xb));return Qa.substr(xb,ac)}Oac(Qa,xb){let ac;ac=this.Da.QSd.sk(Qa,xb);if(0>ac)throw Error.invalidOperation("Invalid start index in Substring() query step");xb=this.Da.qqb?this.Da.qqb.sk(Qa,xb):Qa.length-ac;if(0>
xb||ac+xb>Qa.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:ac,length:xb}}}Object(c.a)(wb,"SubstringAnnotationQueryStep",ya,[]);class hc extends ib{constructor(Qa){super(Qa)}SZa(Qa,xb){return Qa-xb}}Object(c.a)(hc,"SubtractAnnotationQueryStep",ib,[]);class Za extends ya{constructor(Qa){super();this.Da=Qa}load(Qa){const xb=new xa.a(this.Da.annotations,w.Annotations.tL);for(let ac=0;ac<Qa.length;++ac)Array.add(xb.items,Qa.charAt(ac).toString());
return xb}}Object(c.a)(Za,"ToCharListAnnotationQueryStep",ya,[]);class ub extends ya{constructor(Qa){super();this.Da=Qa}load(Qa){const xb=new xa.a(this.Da.annotations,this.yq);Array.add(xb.items,Qa);return xb}}Object(c.a)(ub,"ToListAnnotationQueryStep",ya,[]);class uc extends ya{constructor(Qa){super();this.Da=Qa}load(){return this.Da.value}}Object(c.a)(uc,"ValueAnnotationQueryStep",ya,[]);class Oc{constructor(Qa,xb){if(Qa){var ac=Qa.na(0),zc=1;this.value=({pQ:zc}=xb.KHa(ac,Qa,zc,null,null,null)).returnValue;
w.Annotations.cNa(this.value)}}}Object(c.a)(Oc,"ValueQueryStepInit",null,[]);class Bb{constructor(Qa,xb){Qa&&(this.ABc=xb.ga(Qa.na(0)),this.query=xb.Zu(Qa.na(1)))}}Object(c.a)(Bb,"VarNameAndQueryQueryStepInit",null,[]);class Nb{constructor(Qa,xb){this.A5d=null;if(Qa){this.annotations=xb.annotations;var ac=0;this.yq=Qa.na(ac);++ac;this.pI=Qa.na(ac);++ac;this.fyc=1===Qa.na(ac);++ac;this.Cec=1===Qa.na(ac);++ac;var zc=Qa.na(ac);++ac;if(zc){var Yc=ac,md=ac+zc,sd=ac+2*zc;ac+=3*zc;var h=Qa.count-ac,Ib=null;
for(let Ec=0;Ec<zc;++Ec){var ec=ac+Qa.na(sd+Ec);const fd=(Ec===zc-1?h:Qa.na(sd+Ec+1))-Qa.na(sd+Ec),Cd=new aa.a;Cd.oua(Qa,ec,fd);ec=Nb.FRh(Qa.na(md+Ec),Cd,xb);ec.yq=Qa.na(Yc+Ec);ec.pI=Ec===zc-1?this.pI:Qa.na(Yc+Ec+1);Ib?Ib.next=ec:this.A5d=ec;Ib=ec}}}}get wSe(){return this.A5d}static FRh(Qa,xb,ac){switch(Qa){case 1:return new Oa(new na(xb,ac));case 2:return new Jb(new na(xb,ac));case 3:return new cc(new nc(xb,ac.annotations));case 4:return new Na(new Va(xb,ac.annotations));case 5:return new Ob(new Ja(xb,
ac));case 6:return new db(new Ma(xb,ac));case 43:return new Xa(new Ma(xb,ac));case 45:return new Ca(new rb(xb,ac));case 49:return new $a(new Kb(xb,ac));case 46:return new uc(new Oc(xb,ac.annotations));case 51:return new Wb(new Ea(xb,ac));case 52:return new tc(new ic(xb,ac));case 53:return new ma(new bb(ac.annotations));case 13:return new Lb(new zb(xb,ac));case 14:return new nb(new Tb(xb,ac));case 15:return new fb;case 18:return new Sa(new Ma(xb,ac));case 16:return new vb(new Bb(xb,ac));case 17:return new Ua(new Bb(xb,
ac));case 22:return new Pb(new lb(xb,ac));case 24:return new mb(new zb(xb,ac));case 26:return new Qb(new ic(xb,ac));case 27:return new Ab(new Ma(xb,ac));case 30:return new ub(new bb(ac.annotations));case 31:return new wb(new ic(xb,ac));case 32:return new ua(new zb(xb,ac));case 47:return new va(new bb(ac.annotations));case 48:return new Za(new bb(ac.annotations));case 34:return new wa(new zb(xb,ac));case 35:return new hc(new zb(xb,ac));case 36:return new Ha(new zb(xb,ac));case 37:return new sb(new zb(xb,
ac));case 38:return new gb(new zb(xb,ac));case 39:return new ab(new zb(xb,ac));case 40:return new Ya(new zb(xb,ac));case 41:return new bc(new zb(xb,ac));case 42:return new tb(new bb(ac.annotations));default:throw Error.argument("currStepInitData");}}}Object(c.a)(Nb,"AnnotationQueryInit",null,[]);class dc{constructor(Qa){this.Da=Qa}execute(Qa,xb){this.I$(Qa,Qa?new D("root",Qa,xb):xb)}I$(Qa,xb){for(const ac of this.Da.commands)xb=ac.execute(Qa,xb)}}Object(c.a)(dc,"AnnotationScript",null,[739]);class sc{constructor(Qa){this.Da=
Qa}execute(Qa,xb){const ac=this.Da.Rai.sk(Qa,xb),zc=this.Da.TUi.sk(Qa,xb);this.Da.script.I$(Qa,new D("Input",ac,new D("Output",zc,xb)));return xb}}Object(c.a)(sc,"ApplyAnnotationScriptCommand",null,[748]);class yc{constructor(Qa,xb){Qa&&(this.Rai=xb.Zu(Qa.na(0)),this.TUi=xb.Zu(Qa.na(1)),this.script=xb.pJa(Qa.na(2)))}}Object(c.a)(yc,"ApplyScriptCommandInit",null,[]);class cd{constructor(Qa){this.Da=Qa}execute(Qa,xb){const ac=this.Da.uLd.sk(Qa,xb);this.Da.gjc.xdb(Qa,ac,xb,null);return xb}}Object(c.a)(cd,
"AssignAnnotationScriptCommand",null,[748]);class pd{constructor(Qa){this.Da=Qa}execute(Qa,xb){const ac=this.Da.gjc.sk(Qa,xb);Qa=this.Da.uLd.sk(Qa,xb);ac!==Qa&&ac.tha(Qa);return xb}}Object(c.a)(pd,"CopyAnnotationScriptCommand",null,[748]);class Rb{constructor(Qa){this.Da=Qa}execute(Qa,xb){let ac=this.Da.qsd.sk(Qa,xb);if(this.Da.qsd.fyc){ac=w.Annotations.QA(ac);var zc=new D(this.Da.O$,null,xb);for(let md=0,sd=ac.items.length;md<sd;++md){var Yc=this.XPe(Qa,ac.items[md],zc);if(0>this.Da.Ksc)ac.items[md]=
Yc;else if(({value:Yc}=Yc.Mi(this.Da.Ksc)).returnValue)ac.items[md]=Yc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Da.qsd.xdb(Qa,ac,xb,null)}else{zc=new D(this.Da.O$,null,xb);for(let md=0,sd=ac.items.length;md<sd;++md)this.XPe(Qa,ac.items[md],zc)}return xb}XPe(Qa,xb,ac){let zc;0>this.Da.Ksc?zc=w.Annotations.QA(xb):(zc=new r.a(this.Da.annotations),zc.yn(this.Da.Ksc,xb));ac.tZc(zc);this.Da.kOg.I$(Qa,ac);return zc}}Object(c.a)(Rb,"EnumerateAnnotationScriptCommand",
null,[748]);class Dc{constructor(Qa,xb){Qa&&(this.annotations=xb.annotations,this.O$=xb.ga(Qa.na(0)),this.qsd=xb.Zu(Qa.na(1)),this.kOg=xb.pJa(Qa.na(2)),this.Ksc=Qa.na(3))}}Object(c.a)(Dc,"EnumerateScriptCommandInit",null,[]);class nd{constructor(Qa){this.Da=Qa}execute(Qa,xb){this.Da.Lyc.sk(Qa,xb)?this.Da.uMj.I$(Qa,xb):this.Da.LQe&&this.Da.LQe.I$(Qa,xb);return xb}}Object(c.a)(nd,"IfAnnotationScriptCommand",null,[748]);class od{constructor(Qa,xb){Qa&&(this.Lyc=xb.Zu(Qa.na(0)),this.uMj=xb.pJa(Qa.na(1)),
this.LQe=Qa.na(2)?xb.pJa(Qa.na(2)):null)}}Object(c.a)(od,"IfScriptCommandInit",null,[]);class wd{constructor(Qa,xb){Qa&&(this.annotations=xb.annotations,this.gjc=xb.Zu(Qa.na(0)),this.uLd=xb.Zu(Qa.na(1)))}}Object(c.a)(wd,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class Pc{constructor(Qa){this.Da=Qa}execute(Qa,xb){const ac=this.Da.uLd.sk(this.Da.gjc.sk(Qa,xb),xb);this.Da.gjc.xdb(Qa,ac,xb,null);return xb}}Object(c.a)(Pc,"ModifyAnnotationScriptCommand",null,[748]);class Hb{constructor(Qa){this.Da=
Qa}execute(Qa,xb){const ac=new r.a(this.Da.annotations);this.Da.query&&ac.tha(this.Da.query.sk(Qa,xb));return xb=new D(this.Da.O$,ac,xb)}}Object(c.a)(Hb,"NewAnnotationScriptCommand",null,[748]);class Nc{constructor(Qa,xb){Qa&&(this.annotations=xb.annotations,this.O$=xb.ga(Qa.na(0)),this.query=Qa.na(1)?xb.Zu(Qa.na(1)):null)}}Object(c.a)(Nc,"NewScriptCommandInit",null,[]);class Db{constructor(Qa){this.Da=Qa}execute(Qa,xb){Qa=this.Da.query.sk(Qa,xb);if(this.Da.query.pI===w.Annotations.JB)Qa.Rqc(this.Da.MX);
else for(const ac of Qa.items)ac.Rqc(this.Da.MX);return xb}}Object(c.a)(Db,"RemoveAnnotationScriptCommand",null,[748]);class Cc{constructor(Qa,xb){Qa&&(this.annotations=xb.annotations,this.query=xb.Zu(Qa.na(0)),this.MX=Qa.na(1))}}Object(c.a)(Cc,"RemoveScriptCommandInit",null,[]);class Xc{constructor(Qa,xb){if(Qa){var ac=0,zc=Qa.na(ac);++ac;if(zc){var Yc=ac,md=ac+zc;ac+=2*zc;var sd=Qa.count-ac;this.commands=Array(zc);for(let h=0;h<zc;++h){const Ib=ac+Qa.na(md+h),ec=(h===zc-1?sd:Qa.na(md+h+1))-Qa.na(md+
h),Ec=new aa.a;Ec.oua(Qa,Ib,ec);this.commands[h]=Xc.DRh(Qa.na(Yc+h),Ec,xb)}}}}static DRh(Qa,xb,ac){switch(Qa){case 1:return new cd(new wd(xb,ac));case 2:return new Pc(new wd(xb,ac));case 3:return new Db(new Cc(xb,ac));case 6:return new Hb(new Nc(xb,ac));case 7:return new Rb(new Dc(xb,ac));case 8:return new nd(new od(xb,ac));case 9:return new pd(new wd(xb,ac));case 10:return new sc(new yc(xb,ac));default:throw Error.argument("initData");}}}Object(c.a)(Xc,"AnnotationScriptInit",null,[]);var ld=a(934);
class Dd{constructor(Qa){this.Ij=Qa;this.QB=0}PK(){const Qa=this.Ij.vn(this.QB,4);this.QB+=4;return Qa}get array(){return this.Ij}get offset(){return this.QB}set offset(Qa){this.QB=Qa}}Object(c.a)(Dd,"ByteArrayReader",null,[]);class Od{constructor(){this.hu=null;this.mnf=this.hN=0}na(Qa){if(0>Qa||Qa>=this.hN)throw Error.argumentOutOfRange("index");return this.hu.vn(this.mnf+4*Qa,4)}get count(){return this.hN}static W5g(Qa,xb,ac){const zc=new Od;zc.hu=Qa;zc.mnf=xb;zc.hN=ac;return zc}}Object(c.a)(Od,
"ReadOnlyListOverByteArray",null,[731]);class Qd{constructor(Qa,xb){this.bnf=this.anf=!1;this.Pl=this.Hba=this.Rtd=this.enf=null;try{this.Pl=xb.annotations;const ac=xb.zua(Qa.na(0)),zc=new Dd(ac);if(-914743053!==zc.PK())throw Error.argument("Input does not represent a flat lexicon");this.anf=1===zc.PK();this.bnf=1===zc.PK();const Yc=zc.PK();zc.offset+=Yc;const md=zc.PK();this.Rtd=Qd.IVi(zc,md,this.Pl);const sd=zc.PK();this.enf=Qd.NVi(zc,sd);const h=zc.PK();this.Hba=new ld.a(zc.array,zc.offset);zc.offset+=
h}catch(ac){throw Error.argument("initData");}}get trie(){return this.Hba}YIh(Qa){return"i"===Qa&&this.bnf?"\u0130":Qa.toUpperCase()}Kld(){return this.anf}bHh(Qa){let xb;xb=new xa.a(this.Pl,w.Annotations.JB);if(1!==Qa)if(0===Qa)Qa=new r.a(this.Pl),Array.add(xb.items,Qa);else if(Qa&1073741824){Qa=this.enf[Qa&-1073741825];for(let zc=0;zc<Qa.length;++zc){var ac=Qa[zc];ac=0===ac?new r.a(this.Pl):this.Rtd[ac-2];Array.add(xb.items,ac)}}else Array.add(xb.items,this.Rtd[Qa-2]);return{returnValue:!0,gri:xb}}static IVi(Qa,
xb,ac){if(xb%4)throw Error.argument("reader");const zc=Od.W5g(Qa.array,Qa.offset,xb/4);Qa.offset+=xb;Qa=[];for(xb=0;xb<zc.count;){const Yc=({pQ:xb}=ac.KHa(w.Annotations.JB,zc,xb,null,null,null)).returnValue;Array.add(Qa,Yc)}return Qa}static NVi(Qa,xb){xb=Qa.offset+xb;const ac=[];for(;Qa.offset<xb;){const zc=Qa.PK(),Yc=Array(zc);for(let md=0;md<zc;++md){const sd=Qa.PK();Yc[md]=sd}Array.add(ac,Yc)}return ac}}Object(c.a)(Qd,"RawFlatLexicon",null,[738]);var Nd=a(913),he=a(914);class ve{constructor(Qa){if(null==
Qa)throw Error.argumentNull("base64String");const xb=Qa.length;if(xb%4)throw Error.argument("base64String's length must be a multiple of 4");this.hN=.75*xb;this.nNa=Array(Math.ceil(this.hN/4));Qa.endsWith("==")?this.hN-=2:Qa.endsWith("=")&&--this.hN;let ac=0;for(let zc=0;zc<xb;zc+=4){const Yc=ve.otc[Qa.charCodeAt(zc)-43]<<18|ve.otc[Qa.charCodeAt(zc+1)-43]<<12|ve.otc[Qa.charCodeAt(zc+2)-43]<<6|ve.otc[Qa.charCodeAt(zc+3)-43];let md=Yc>>16&255;this.nNa[Math.floor(ac/4)]|=md<<ac%4*8;++ac;md=Yc>>8&255;
this.nNa[Math.floor(ac/4)]|=md<<ac%4*8;++ac;md=Yc&255;this.nNa[Math.floor(ac/4)]|=md<<ac%4*8;++ac}}get length(){return this.hN}na(Qa){if(0>Qa||Qa>=this.hN)throw Error.argumentOutOfRange("i");return this.MVe(Qa)}vn(Qa,xb){if(0>Qa||0>xb||Qa+xb>this.hN)throw Error.argument("Bad range");let ac=0;for(let zc=0;zc<xb;++zc)ac|=this.MVe(Qa+zc)<<8*zc;return ac}e5i(Qa,xb){let ac=0,zc=0,Yc=Math.floor(Qa/8);for(Qa%=8;zc<xb;){const md=8-Qa>xb-zc?xb-zc:8-Qa,sd=this.na(Yc);ac|=(sd>>Qa&~(255<<md))<<zc;zc+=md;++Yc;
Qa=0}return ac}MVe(Qa){return this.nNa[Math.floor(Qa/4)]>>Qa%4*8&255}}ve.otc=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(c.a)(ve,"ByteArray",null,[]);class Td{constructor(Qa,xb,ac){this.Iq=Qa;this.swi=xb;this.Bwi=ac;this.unf=Array(Qa.b?Qa.b.length:0);this.vud=new Nd.a(new he.a(this.zua(this.Iq.s)));this.vK=Array(Qa.t.length);
this.vkg=new w.Annotations(this.vua(0),this)}get annotations(){return this.vkg}get bhh(){return this.Iq.d}fRh(){if(!(""in this.Iq.m))throw Error.argument("name","Unrecognized module");return this.ced(this.Iq.m[""])}zua(Qa){if(0>Qa||!this.Iq.b||Qa>=this.Iq.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.unf[Qa]||(this.unf[Qa]=new ve(this.Iq.b[Qa]))}ga(Qa){if(1>Qa||Qa>=this.Iq.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.Iq.t[Qa])throw Error.argument("blobID","Requested blob is not a string");
if(null==this.vK[Qa]){const xb=this.vua(Qa).na(0);this.vK[Qa]=this.vud.ga(xb)}return this.vK[Qa]}u0e(Qa){if(1>Qa||Qa>=this.Iq.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.Iq.t[Qa])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.vK[Qa]){var xb=this.vua(Qa);const ac=this.ga(xb.na(0));xb=1===xb.na(1);this.vK[Qa]=new RegExp(ac,xb?"i":"")}return this.vK[Qa]}xVh(Qa){if(1>Qa||Qa>=this.Iq.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.Iq.t[Qa])throw Error.argument("blobID",
"Requested blob is not an SRE");throw Error.notImplemented();}ced(Qa){if(1>Qa||Qa>=this.Iq.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.Iq.t[Qa])throw Error.argument("blobID","Requested blob is not an NL module");return this.vK[Qa]||(this.vK[Qa]=this.Bwi.vRh(this.vua(Qa),this))}Zu(Qa){if(1>Qa||Qa>=this.Iq.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.Iq.t[Qa])throw Error.argument("blobID","Requested blob is not an annotation query");return this.vK[Qa]||(this.vK[Qa]=
new ia(new Nb(this.vua(Qa),this)))}pJa(Qa){if(1>Qa||Qa>=this.Iq.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.Iq.t[Qa])throw Error.argument("blobID","Requested blob is not an annotation script");return this.vK[Qa]||(this.vK[Qa]=new dc(new Xc(this.vua(Qa),this)))}DU(Qa){if(1>Qa||Qa>=this.Iq.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.Iq.t[Qa])throw Error.argument("blobID","Requested blob is not a filter");return this.vK[Qa]||(this.vK[Qa]=this.swi.DU(this.vua(Qa),this))}mUh(Qa){if(1>
Qa||Qa>=this.Iq.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.Iq.t[Qa])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.vK[Qa]||(this.vK[Qa]=new Qd(this.vua(Qa),this))}vua(Qa){const xb=this.Iq.n[Qa];Qa=(Qa<this.Iq.t.length-1?this.Iq.n[Qa+1]:this.Iq.n.length)-xb;if(0>xb||0>Qa||xb+Qa>this.Iq.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+xb+","+Qa+")");const ac=new aa.a;ac.Pad(this.Iq.n,xb,Qa);return ac}}Object(c.a)(Td,
"ObjectFetcher",null,[708]);class ke{constructor(Qa,xb,ac){if(!Qa)throw Error.argumentNull("prediction");if(!xb)throw Error.argumentNull("fieldNames");if(!ac)throw Error.argumentNull("values");if(xb.length!==ac.length)throw Error.argument("values","fieldNames and values do not have same length");this.ztg=Qa;this.oNa=xb;this.VBb=ac}get prediction(){return this.ztg}get $Qe(){return this.oNa.length}AJa(Qa){return 0<=Qa&&Qa<this.oNa.length?this.oNa[Qa]:null}eva(Qa){return 0<=Qa&&Qa<this.VBb.length?this.VBb[Qa]:
null}}Object(c.a)(ke,"PredictionData",null,[]);class xe{constructor(Qa,xb){if(!Qa)throw Error.argumentNull("predictions");if(!xb)throw Error.argumentNull("tokenAttributes");this.Ewi=Qa;this.Pwi=xb}Ied(){return this.Ewi}hVe(){return this.Pwi}}Object(c.a)(xe,"PredictionDataWithTokenAttributes",null,[]);class le{constructor(Qa,xb){this.prediction=null;this.score=0;this.prediction=Qa;this.score=xb}}Object(c.a)(le,"PredictionWithScore",null,[]);class Je{constructor(Qa,xb){if(!Qa)throw Error.argumentNull("predictions");
if(!xb)throw Error.argumentNull("attributes");this.Atg=Qa;this.FPb=xb}Ied(){return this.Atg}hVe(){return this.FPb}}Object(c.a)(Je,"PredictionsWithTokenAttributes",null,[]);class Fe{constructor(Qa,xb,ac){if(!Qa)throw Error.argumentNull("attributeName");if(!xb)throw Error.argumentNull("fieldNames");if(!ac)throw Error.argumentNull("values");if(xb.length!==ac.length)throw Error.argument("values","fieldNames and values do not have same length");this.Rkg=Qa;this.oNa=xb;this.VBb=ac}get attributeName(){return this.Rkg}get $Qe(){return this.oNa.length}AJa(Qa){return 0<=
Qa&&Qa<this.oNa.length?this.oNa[Qa]:null}eva(Qa){return 0<=Qa&&Qa<this.VBb.length?this.VBb[Qa]:null}}Object(c.a)(Fe,"TokenAttributes",null,[]);var eb=a(83),Xb=a(680);class oc{constructor(Qa,xb,ac,zc,Yc){this.YOb=0;this.l_d=null;this.ZOb=this.vfb=0;this.xCc=this.STa=this.KW=this.wfb=null;this.n_d=0;this.iWa=this.Lo=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.Dt=Qa;this.Rgg=this.Vgg=xb;this.Qgg=this.Tgg=ac;this.WOb=this.Sgg=
zc;this.XOb=this.Ugg=Yc}wCc(){this.ZOb=0;return this.i_d}i_d(){if(!(this.ZOb<this.WOb))return this.j_d;this.wfb=this.Rgg.items[this.ZOb+this.Qgg];this.KW=new r.a(this.Dt.Da.annotations);1!==this.WOb&&this.Dt.Da.Wxb||this.KW.tha(this.wfb);if(0<=this.Dt.Da.wkc){({value:this.STa}=this.KW.Mi(this.Dt.Da.wkc)).returnValue?this.STa=this.STa.QA():this.STa=new xa.a(this.Dt.Da.annotations,w.Annotations.JB);this.xCc=this.XOb.items;this.n_d=this.xCc.length;for(this.YOb=0;this.YOb<this.n_d;++this.YOb)this.l_d=
this.xCc[this.YOb],Array.add(this.STa.items,this.l_d);this.KW.yn(this.Dt.Da.wkc,this.STa)}else 0<=this.Dt.Da.PRd?this.KW.yn(this.Dt.Da.PRd,this.XOb.items[0]):0<=this.Dt.Da.mXc?this.KW.yn(this.Dt.Da.mXc,!0):this.Dt.Da.Def?this.XOb.items[0].b9b((Qa,xb)=>this.KW.yn(Qa,xb)):(this.KW.tha(this.XOb.items[0]),1!==this.WOb&&this.Dt.Da.Wxb||(({value:this.vfb}=this.wfb.Mi(this.Dt.Da.SG)).returnValue&&this.KW.yn(this.Dt.Da.SG,this.vfb),({value:this.vfb}=this.wfb.Mi(this.Dt.Da.sJ)).returnValue&&this.KW.yn(this.Dt.Da.sJ,
this.vfb),this.wfb.Mi(this.Dt.Da.Jra).returnValue&&this.KW.yn(this.Dt.Da.Jra,this.vfb)));this.Lo=this.KW;this._state=2;return this.Ygg}j_d(){this._state=3}Xgg(){this.ZOb++;return this.i_d}Ygg(){return 1<this.WOb&&this.Dt.Da.Wxb?this.j_d:this.Xgg}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new oc(this.Dt,this.Vgg,this.Tgg,this.Sgg,this.Ugg)).getEnumerator()}[Symbol.iterator](){return Object(Xb.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=
1:(this._state=1,this.iWa=this.wCc());for(;1===this._state;)this.iWa=this.iWa();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.Lo}}Object(c.a)(oc,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[2,34,70]);class Gc{constructor(Qa,xb,ac){this.RBb=this.nnf=0;this.a8a=null;this.wud=this.Xtd=this.Z7a=this.njc=this.$td=0;this.pjc=!1;this.lud=Qa;this.xud=xb;this.Dwi=
ac}b_e(){null===this.a8a&&({v8f:this.a8a,i8e:this.$td,length:this.njc,yxh:Qa}=this.lud.r2e(this.xud.items[this.RBb],this.Dwi),this.pjc=Qa||this.pjc);if(this.Z7a<this.njc){var Qa=this.a8a.charAt(this.$td+this.Z7a);++this.Z7a;return{returnValue:!0,ch:Qa}}if(this.RBb===this.xud.items.length-1)return{returnValue:!1,ch:"\x00"};++this.RBb;this.Z7a=0;this.a8a=null;return{returnValue:!0,ch:" "}}hHd(Qa,xb){this.Z7a===this.njc&&this.a8a&&(this.wud=xb,this.Xtd=this.RBb-this.nnf+1)}Gfj(Qa){if(0>Qa||Qa>=this.xud.items.length)throw Error.argumentOutOfRange("iToken");
this.RBb=this.nnf=Qa;this.a8a=null;this.Xtd=this.Z7a=this.njc=this.$td=0;this.wud=-1;this.pjc=!1}KQh(){return{fSg:this.Xtd,cpi:this.wud,uxh:this.pjc}}}Object(c.a)(Gc,"TriePrefixVisitor",null,[744]);class Vc{constructor(Qa){this.Da=Qa}execute(Qa){if(!({value:ac}=Qa.Mi(this.Da.v9)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let xb;({value:xb}=Qa.Mi(this.Da.yga)).returnValue||(xb=null);var ac=this.JGh(ac,xb);Qa=w.Annotations.QA(Qa);Qa.yn(this.Da.v9,ac);return Qa}JGh(Qa,
xb){let ac=null;const zc=this.Da.flatLexicon.trie,Yc=new Gc(this,Qa,xb);let md=null;this.Da.flatLexicon.Kld()&&(md=Object(eb.a)(this.Da.flatLexicon,this.Da.flatLexicon.YIh,"getCaseInsensitiveForm"));let sd=0,h;var Ib;let ec;for(;sd<Qa.items.length;){const Ec=Qa.items[sd];Yc.Gfj(sd);zc.Lfg(Yc,md);({fSg:h,cpi:Ib,uxh:ec}=Yc.KQh());if(0<h){({gri:Ib}=this.Da.flatLexicon.bHh(Ib));for(let fd of this.v7g(Qa,sd,h,Ib)){1<h&&this.Da.Wxb&&this.Z7g(Qa,xb,sd,Ec,h,ec,fd);if(!ac)for(ac=new xa.a(this.Da.annotations,
w.Annotations.JB),Ib=0;Ib<sd;++Ib)Array.add(ac.items,Qa.items[Ib]);Array.add(ac.items,fd)}sd+=h}else ac&&Array.add(ac.items,Ec),++sd}return ac||Qa}Z7g(Qa,xb,ac,zc,Yc,md,sd){if(md)md=!0;else if(this.Da.oef){md=!1;var h=-1;for(var Ib=0;Ib<Yc;Ib++){var ec=Qa.items[ac+Ib];let Gd;var Ec=void 0;if(!({value:Gd}=ec.Mi(this.Da.SG)).returnValue||!({value:Ec}=ec.Mi(this.Da.sJ)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<Ib){if(Gd>h+1){md=!0;break}if(0>h||null===xb||h>=xb.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==xb.charAt(h)){md=!0;break}}h=Gd+Ec}}else md=!1;if(md){Ec=new Sys.StringBuilder;for(md=0;md<Yc;++md)({v8f:h,i8e:Ib,length:ec}=this.r2e(Qa.items[ac+md],xb)),0<md&&Ec.append(" "),Ec.append(h.substr(Ib,ec));sd.yn(this.Da.Jra,Ec.toString())}Qa=Qa.items[ac+Yc-1];let fd,Cd;({value:zc}=zc.Mi(this.Da.SG)).returnValue&&
({value:fd}=Qa.Mi(this.Da.SG)).returnValue&&({value:Cd}=Qa.Mi(this.Da.sJ)).returnValue?(sd.yn(this.Da.SG,zc),sd.yn(this.Da.sJ,fd+Cd-zc)):(sd.Rqc(this.Da.SG),sd.Rqc(this.Da.sJ))}v7g(Qa,xb,ac,zc){return new oc(this,Qa,xb,ac,zc)}r2e(Qa,xb){let ac,zc;if(({value:ac}=Qa.Mi(this.Da.Jra)).returnValue)zc=!0,xb=0,Qa=ac.length;else{zc=!1;if(null===xb)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");ac=xb;if(!({value:xb}=Qa.Mi(this.Da.SG)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:Qa}=Qa.Mi(this.Da.sJ)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>xb||0>Qa||xb+Qa>ac.length)throw Error.argument("Token start/length values out of range","token");}return{v8f:ac,i8e:xb,length:Qa,yxh:zc}}}Object(c.a)(Vc,"FlatLexiconNLModule",null,[736]);class P{constructor(Qa,xb){this.mXc=this.wkc=this.PRd=this.Jra=this.sJ=this.SG=this.yga=this.v9=0;this.Def=this.oef=this.Wxb=!1;this.flatLexicon=null;this.annotations=xb.annotations;
let ac=0;try{this.v9=Qa.na(ac),++ac,this.yga=Qa.na(ac),++ac,this.SG=Qa.na(ac),++ac,this.sJ=Qa.na(ac),++ac,this.Jra=Qa.na(ac),++ac,this.PRd=Qa.na(ac),++ac,this.wkc=Qa.na(ac),++ac,this.mXc=Qa.na(ac),++ac,this.Wxb=1===Qa.na(ac),++ac,this.oef=1===Qa.na(ac),++ac,this.Def=1===Qa.na(ac),++ac,this.flatLexicon=xb.mUh(Qa.na(ac))}catch(zc){throw Error.argument("initData");}}}Object(c.a)(P,"FlatLexiconNLModuleInit",null,[]);class Ta{constructor(){this.Ywb=0;this.h$c=null;this.iJb=0}}Object(c.a)(Ta,"FeatureGenStackRec",
null,[]);class pb{constructor(Qa){this.hVd=Array(Qa);this.ceb=Array(Qa);this.mTd=[];this.n6f=[]}}Object(c.a)(pb,"TokenStringLattice",null,[]);const Yb=(Qa,xb,ac)=>{for(let zc=0;zc<Qa.length;zc++)ac=xb(ac,Qa[zc]);return ac},Ac=(Qa,xb)=>{const ac=Array(Qa.length);for(let zc=0;zc<Qa.length;zc++)ac[zc]=xb(Qa[zc]);return ac},Zc=(Qa,xb)=>{xb=Array(Math.min(xb,Qa.length));for(let ac=0;ac<xb.length;ac++)xb[ac]=Qa[ac];return xb},id=(Qa,xb)=>{const ac=[];for(const zc of Qa)xb(zc)&&Array.add(ac,zc);return ac};
class gd{constructor(Qa,xb){this.key=Qa;this.value=xb}}Object(c.a)(gd,"KeyValuePair",null,[]);const Ub=(Qa,xb)=>({returnValue:xb in Qa,value:Qa[xb]}),Lc=Qa=>{const xb=[];for(let ac in Qa){const zc=new gd(ac,Qa[ac]);Array.add(xb,zc)}return xb};class hd{constructor(Qa){this.q2e=this.rYh;this.Da=Qa;this.sjc=this.jud=this.kud=0;for(const xb of this.Da.$7b)this.kud=Math.max(this.kud,xb.jDd),this.jud=Math.max(this.jud,xb.cDd),this.sjc=Math.max(this.sjc,xb.ndb.length)}get fzh(){return this.Da.gzc.trie}execute(Qa){if(!Qa)throw Error.argumentNull("input");
let xb,ac;({tokens:xb,Rpi:ac}=this.sYh(Qa));let zc=null,Yc=null,md={};if(this.Da.Byb){xb=w.Annotations.QA(xb);for(var sd=0;sd<xb.items.length;++sd)xb.items[sd]=w.Annotations.QA(xb.items[sd])}else({OQe:Yc,returnValue:zc}=this.z_e(Qa,md));sd=Array(this.sjc);const h=Array(this.sjc);for(var Ib=0;Ib<h.length;++Ib)h[Ib]=new Ta;for(Ib=-this.kud;Ib<xb.items.length+this.jud;++Ib){let ec=null;this.Da.Byb&&(ec=xb.items[Ib],md={},{OQe:Yc,returnValue:zc}=this.z_e(ec,md));for(const Ec of this.Da.$7b){if(0>Ib&&
-Ib>Ec.jDd||Ib>=xb.items.length&&Ib-xb.items.length+1>Ec.cDd)continue;let fd=!0;for(let Cd=0;Cd<Ec.ndb.length;++Cd){const Gd=Ib+Ec.ndb[Cd];sd[Cd]=Gd;if(0>Gd?0>this.Da.kDd:Gd>=xb.items.length?0>this.Da.dDd:!ac.ceb[Gd]){fd=!1;break}}fd&&({U$g:zc,V$g:Yc}=this.ybi(Ec,ac,zc,Yc,md,h,sd))}this.Da.Byb&&(ec.yn(this.Da.$ja?this.Da.dZa:this.Da.bZa,zc),this.Da.$ja&&ec.yn(this.Da.cZa,Yc))}Qa=w.Annotations.QA(Qa);this.Da.Byb?Qa.yn(this.Da.v9,xb):(Qa.yn(this.Da.$ja?this.Da.dZa:this.Da.bZa,zc),this.Da.$ja&&Qa.yn(this.Da.cZa,
Yc));return Qa}sYh(Qa){let xb,ac;if(!Qa||!({value:xb}=Qa.Mi(this.Da.v9)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let zc;({value:zc}=Qa.Mi(this.Da.yga)).returnValue||(zc="");ac=new pb(xb.items.length);const Yc=id(this.Da.jVd,md=>!md.Cxb||md.Cxb.isMatch(Qa,null));for(let md=0;md<xb.items.length;++md){const sd=xb.items[md];let h=null;ac.hVd[md]=ac.mTd.length;let Ib=ac.ceb[md]=0;for(const ec of Yc)0<ec.$Bb&&ac.ceb[md]+Ib>=ec.$Bb||ec.UMb&&!ec.UMb.isMatch(sd,
null)||({VMb:h,Dob:Ib}=ec.apply(this,sd,md,ac,zc,h,Ib))}return{tokens:xb,Rpi:ac}}ybi(Qa,xb,ac,zc,Yc,md,sd){let h=0;md[0].Ywb=-1;for(md[0].h$c=Qa.NTf;;){var Ib=sd[h],ec=0>Ib||Ib>=xb.ceb.length?1:xb.ceb[Ib];let Cd=!1;for(;md[h].Ywb<ec-1;){++md[h].Ywb;var Ec=void 0,fd=void 0;0>Ib?(Ec=this.Da.kDd,fd=1):Ib>=xb.hVd.length?(Ec=this.Da.dDd,fd=1):(fd=xb.hVd[Ib]+md[h].Ywb,Ec=xb.mTd[fd],fd=xb.n6f[fd]);md[h].iJb=fd*(h?md[h-1].iJb:Qa.score);if(({value:Ec}=Ub(md[h].h$c,Ec.toString())).returnValue){h===Qa.ndb.length-
1?(Ib=Ec,md[h].iJb&&(({value:ec}=Ub(Yc,Ib.toString())).returnValue||(ec=-1),0>ec&&(ac=w.Annotations.QA(ac),Array.add(ac.items,Ib)),this.Da.$ja&&(zc=w.Annotations.QA(zc),0>ec?Array.add(zc.items,md[h].iJb):zc.items[ec]+=md[h].iJb),0>ec&&(this.Da.Zgf||this.Da.$ja)&&(Yc[Ib.toString()]=ac.items.length-1))):(++h,md[h].Ywb=-1,md[h].h$c=Ec);Cd=!0;break}}if(!Cd&&(--h,0>h))break}return{U$g:ac,V$g:zc}}z_e(Qa,xb){let ac;if(({value:ac}=Qa.Mi(this.Da.$ja?this.Da.dZa:this.Da.bZa)).returnValue)for(let zc=0;zc<ac.items.length;++zc)xb[ac.items[zc].toString()]=
zc;else ac=new xa.a(this.Da.annotations,w.Annotations.h7);if(this.Da.$ja){if(({value:xb}=Qa.Mi(this.Da.cZa)).returnValue||(xb=new xa.a(this.Da.annotations,w.Annotations.AW)),xb.items.length!==ac.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Da.annotations.AO(w.Annotations.JB,Qa));}else xb=null;return{returnValue:ac,OQe:xb}}get oKj(){return this.Da.gzc}rYh(Qa,xb){var ac;if(({value:ac}=xb.Mi(this.Da.Jra)).returnValue)Qa=
ac;else{if(!({value:ac}=xb.Mi(this.Da.SG)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:xb}=xb.Mi(this.Da.sJ)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>ac||0>xb||ac+xb>Qa.length)throw Error.argument("Token indices are out of range");Qa=Qa.substr(ac,xb)}return Qa}}Object(c.a)(hd,"NGramNLModule",null,[736,737]);class Kd{constructor(Qa){this.ndb=null;this.score=this.cDd=this.jDd=0;this.NTf=null;if(Qa){var xb=0;try{if(Qa.na(xb)!==Kd.bGa)throw Error.argument("initData",
"Input does not represent a feature template");++xb;const ac=Qa.na(xb);++xb;this.ndb=Array(ac);for(let zc=0;zc<ac;++zc)this.ndb[zc]=Qa.na(xb),++xb;this.jDd=Qa.na(xb);++xb;this.cDd=Qa.na(xb);++xb;this.score=Qa.na(xb);++xb;this.NTf=({g8e:xb}=Kd.wLf(Qa,xb)).returnValue}catch(ac){throw Error.argument("initData");}}}static wLf(Qa,xb){const ac=Qa.na(xb);++xb;const zc={};for(let Yc=0;Yc<ac;++Yc){const md=Qa.na(xb);++xb;Qa.na(xb)?zc[md.toString()]=({g8e:xb}=Kd.wLf(Qa,xb)).returnValue:(++xb,zc[md.toString()]=
Qa.na(xb),++xb)}return{returnValue:zc,g8e:xb}}}Kd.bGa=240803228;Object(c.a)(Kd,"FeatureTemplate",null,[746]);var Wd=a(841);class oe{constructor(Qa,xb){this.$ja=this.Zgf=this.Byb=!1;this.Jra=this.sJ=this.SG=this.v9=this.yga=this.cZa=this.dZa=this.bZa=0;this.gzc=null;this.dDd=this.kDd=0;this.$7b=this.jVd=null;if(Qa){this.annotations=xb.annotations;var ac=0;try{this.Byb=1===Qa.na(ac);++ac;this.Zgf=1===Qa.na(ac);++ac;this.$ja=1===Qa.na(ac);++ac;this.bZa=Qa.na(ac);++ac;this.dZa=Qa.na(ac);++ac;this.cZa=
Qa.na(ac);++ac;this.yga=Qa.na(ac);++ac;this.v9=Qa.na(ac);++ac;this.SG=Qa.na(ac);++ac;this.sJ=Qa.na(ac);++ac;this.Jra=Qa.na(ac);++ac;this.gzc=this.dWi(xb.zua(Qa.na(ac)));++ac;this.kDd=Qa.na(ac);++ac;this.dDd=Qa.na(ac);++ac;const zc=Qa.na(ac);++ac;this.jVd=Array(zc);for(let md=0;md<zc;++md){const sd=Qa.na(ac);++ac;const h=this.gzc.trie,Ib=new aa.a;Ib.oua(Qa,ac,sd);this.jVd[md]=this.iWi(Ib,xb,h);ac+=sd}const Yc=Qa.na(ac);++ac;this.$7b=Array(Yc);for(xb=0;xb<Yc;++xb){const md=Qa.na(ac);++ac;const sd=new aa.a;
sd.oua(Qa,ac,md);this.$7b[xb]=this.OVi(sd);ac+=md}}catch(zc){throw Error.argument("initData");}}}dWi(Qa){return new Nd.a(new he.a(Qa))}iWi(Qa,xb,ac){return Wd.a.create(Qa,xb,ac)}OVi(Qa){return new Kd(Qa)}}Object(c.a)(oe,"NGramNLModuleInit",null,[]);class We{constructor(Qa){this.Da=Qa}execute(Qa){if(!Qa)throw Error.argumentNull("input");Qa=Qa.clone();this.Da.script.execute(Qa,null);return Qa}}Object(c.a)(We,"ScriptNLModule",null,[736]);class Ze{constructor(Qa,xb){Qa&&(this.script=xb.pJa(Qa.na(0)))}}
Object(c.a)(Ze,"ScriptNLModuleInit",null,[]);const Be=Qa=>{Qa=Ac(Qa,xb=>xb*xb);return Math.sqrt(Yb(Qa,(xb,ac)=>xb+ac,0))},af=Qa=>Yb(Qa,(xb,ac)=>xb>ac?xb:ac,Qa[0]);class ff{constructor(Qa){this.Da=Qa}execute(Qa){if(!Qa)throw Error.argumentNull("input");var xb=[],ac=[];this.fZg(Qa,xb,ac);this.AHg(xb,ac);const zc={};for(let md=0;md<xb.length;++md){var Yc=xb[md];const sd=this.Da.A$e.na(Yc);Yc=this.Da.B$e.na(Yc);for(let h=0;h<Yc;++h){const Ib=this.Da.TWg.na(this.Da.nxe.na(sd+h)),ec=this.Da.oxe.na(sd+h);
let Ec;({value:Ec}=Ub(zc,Ib)).returnValue||(Ec=0);zc[Ib]=Ec+ac[md]*ec}}ac=Lc(zc);ac.sort((md,sd)=>{var h=md.value,Ib=sd.value;(h=-(h>Ib?1:h<Ib?-1:0))||(h=md.key.localeCompare(sd.key));return h});xb=new xa.a(this.Da.annotations,w.Annotations.JB);for(const md of Zc(ac,this.Da.fyi))ac=new r.a(this.Da.annotations),ac.yn(this.Da.hMg,md.key),ac.yn(this.Da.jMg,md.value),Array.add(xb.items,ac);Qa.yn(this.Da.iMg,xb);return Qa}fZg(Qa,xb,ac){if(({value:Qa}=Qa.Mi(this.Da.gMg)).returnValue){let zc;if(({value:zc}=
Qa.Mi(this.Da.dZa)).returnValue){let Yc;if(!({value:Yc}=Qa.Mi(this.Da.cZa)).returnValue||zc.items.length!==Yc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.K1b(zc,Yc,xb,ac)}if(({value:zc}=Qa.Mi(this.Da.lMg)).returnValue){let Yc;if(!({value:Yc}=Qa.Mi(this.Da.mMg)).returnValue||zc.items.length!==Yc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");this.K1b(zc,
Yc,xb,ac)}({value:zc}=Qa.Mi(this.Da.bZa)).returnValue&&this.K1b(zc,null,xb,ac);({value:zc}=Qa.Mi(this.Da.kMg)).returnValue&&this.K1b(zc,null,xb,ac)}}K1b(Qa,xb,ac,zc){for(let md=0;md<Qa.items.length;++md){var Yc=void 0;Qa.bI===w.Annotations.tL?({value:Yc}=Ub(this.Da.DIe,Qa.items[md])).returnValue||(Yc=-1):(Yc=Qa.items[md],Yc=Yc>=this.Da.Cvd&&Yc<=this.Da.Hyi?this.Da.Ywd?this.Da.Ywd.na(Yc-this.Da.Cvd)-1:Yc-this.Da.Cvd:-1);if(0<=Yc){let sd;sd=xb?xb.items[md]:1;0<sd&&(Array.add(ac,Yc),Array.add(zc,sd))}}}AHg(Qa,
xb){if(Qa.length){switch(this.Da.A1i){case 0:break;case 1:for(var ac=0;ac<xb.length;++ac)xb[ac]=1+Math.log(xb[ac]);break;case 2:ac=af(xb);for(let zc=0;zc<xb.length;++zc)xb[zc]=.5+xb[zc]/ac*.5;break;case 3:for(ac=0;ac<xb.length;++ac)xb[ac]=1;break;default:throw Error.notImplemented();}if(this.Da.Qdc)for(ac=0;ac<xb.length;++ac)xb[ac]*=this.Da.Qdc.na(Qa[ac]);Qa=Be(xb);for(ac=0;ac<xb.length;++ac)xb[ac]/=Qa}}}Object(c.a)(ff,"TfIdfRankerNLModule",null,[736]);class Pe{constructor(Qa,xb=0){if(!Qa)throw Error.argumentNull("byteArray");
this.tjc=xb;if(604662927!==Qa.vn(this.tjc+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this._count=Qa.vn(this.tjc+4,4);this.Nmf=Qa.vn(this.tjc+8,4);this.lwi=Qa}na(Qa){if(0>Qa||Qa>=this.count)throw Error.argumentOutOfRange("index");return this.lwi.e5i(8*this.tjc+96+Qa*this.Nmf,this.Nmf)}get count(){return this._count}}Object(c.a)(Pe,"CompactIntArray",null,[731]);const Ne=(Qa,xb)=>{xb=Array(xb);for(let md=0;md<xb.length;md++){var ac=md,zc=Qa.PK(),Yc=1===(zc>>
31&1)?-1:1;const sd=zc&8388607;zc=zc>>23&255;256===zc+1?Yc=sd?Number.NaN:1===Yc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:zc?(zc-=127,Yc=Yc*se(sd,1)*Math.pow(2,zc)):Yc=Yc*se(sd,0)*Math.pow(2,-126);xb[ac]=Yc}return xb},se=(Qa,xb)=>{let ac=0;for(let zc=0;23>zc;zc++)ac+=(Qa>>22-zc&1)/Math.pow(2,zc+1);return xb+ac};class Wa{constructor(Qa,xb){this.Ywd=null;this.asf=0;this.B$e=this.A$e=this.Qdc=null;this.$rf=0;this.oxe=this.nxe=null;this.annotations=xb.annotations;let ac=0;this.kMg=Qa.na(ac);++ac;
this.bZa=Qa.na(ac);++ac;this.lMg=Qa.na(ac);++ac;this.mMg=Qa.na(ac);++ac;this.dZa=Qa.na(ac);++ac;this.cZa=Qa.na(ac);++ac;this.gMg=Qa.na(ac);++ac;this.iMg=Qa.na(ac);++ac;this.hMg=Qa.na(ac);++ac;this.jMg=Qa.na(ac);++ac;var zc=Qa.na(ac);++ac;var Yc=Array(zc);for(var md=0;md<zc;++md)Yc[md]=xb.ga(Qa.na(ac)),++ac;this.TWg=aa.a.b3c(Yc);this.fyi=Qa.na(ac);++ac;this.A1i=Qa.na(ac);++ac;zc=Qa.na(ac);++ac;this.DIe={};for(Yc=0;Yc<zc;++Yc){md=xb.ga(Qa.na(ac));++ac;const sd=Qa.na(ac);++ac;this.DIe[md]=sd}this.Cvd=
Qa.na(ac);++ac;this.Hyi=Qa.na(ac);++ac;zc=Qa.na(ac);++ac;0<zc&&(zc=xb.zua(Qa.na(ac)),++ac,this.Ywd=this.koc(new Dd(zc)));++ac;Qa=xb.zua(Qa.na(ac));this.WVi(Qa)}koc(Qa){return new Pe(Qa.array,Qa.offset)}WVi(Qa){try{const xb=new Dd(Qa);this.asf=xb.PK();1===xb.PK()?this.Qdc=aa.a.b3c(Ne(xb,this.asf)):this.Qdc=null;const ac=xb.PK();this.A$e=this.koc(xb);xb.offset+=ac;const zc=xb.PK();this.B$e=this.koc(xb);xb.offset+=zc;this.$rf=xb.PK();const Yc=xb.PK();this.nxe=this.koc(xb);xb.offset+=Yc;this.oxe=aa.a.b3c(Ne(xb,
this.$rf))}catch(xb){throw Error.argument("byteReader");}}}Object(c.a)(Wa,"TfIdfRankerNLModuleInit",null,[]);class Sb{constructor(Qa,xb,ac,zc){this.XBd=Qa;this.lSe=ac;this.tokens=zc;this.QT=xb;this.acb=-1;this.ouc=0}}Object(c.a)(Sb,"TokenizerData",null,[]);class wc{constructor(Qa){this.Da=Qa}execute(Qa){if(!Qa)throw Error.argumentNull("input");if(!({value:zc}=Qa.Mi(this.Da.yga)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let xb;({value:xb}=
Qa.Mi(this.Da.SG)).returnValue||(xb=0);let ac;({value:ac}=Qa.Mi(this.Da.sJ)).returnValue||(ac=zc.length-xb);if(0>xb||xb>zc.length)throw Error.argument("input","Start index out of range");if(0>ac||ac>zc.length)throw Error.argument("input","Length out of range");if(xb+ac>zc.length)throw Error.argument("input","Bad start-length range");var zc=new Sb(zc,xb,xb+ac,new xa.a(this.Da.annotations,w.Annotations.JB));this.pKj(zc);Qa=Qa.isReadOnly?Qa.clone():Qa;Qa.yn(this.Da.v9,zc.tokens);return Qa}pKj(Qa){for(;Qa.QT<
Qa.lSe;){if(this.Da.wgd){var xb=this.Da.wgd.umf(Qa.XBd,Qa.QT,Qa.lSe-Qa.QT,null);!xb.succeeded&&xb.mrf&&(xb=xb.mrf);if(xb.succeeded){this.wzf(Qa,xb.length,this.Da.C3e);Qa.QT+=xb.length;continue}}xb=Qa.XBd.substr(Qa.QT);let ac=-1,zc=-1,Yc=-1;for(let md=0;md<this.Da.jtc.length;++md){const sd=this.Da.jtc[md].exec(xb);sd&&0<sd[1].length&&(0>ac||sd[0].length>zc)&&(ac=md,zc=sd[0].length,Yc=sd[1].length)}0<=ac?(this.wzf(Qa,Yc,this.Da.pLd[ac]),Qa.QT+=Yc):Qa.QT+=1}}wzf(Qa,xb,ac){if(this.Da.Uff)ac!==wc.vSg&&
(0>Qa.acb&&(Qa.acb=Qa.QT),Qa.ouc=Qa.QT+xb-Qa.acb,ac===wc.uSg&&(0<=Qa.acb&&0<Qa.ouc&&(xb=new r.a(this.Da.annotations),xb.yn(this.Da.SG,Qa.acb),xb.yn(this.Da.sJ,Qa.ouc),xb.yn(this.Da.mWc,wc.wSg),xb.yn(this.Da.yga,Qa.XBd),Array.add(Qa.tokens.items,xb)),Qa.acb=-1,Qa.ouc=0));else{let zc=new r.a(this.Da.annotations);zc.yn(this.Da.SG,Qa.QT);zc.yn(this.Da.sJ,xb);zc.yn(this.Da.mWc,ac);Array.add(Qa.tokens.items,zc)}}}wc.vSg="GAP";wc.uSg="EOS_CHUNK";wc.wSg="SENTENCE";Object(c.a)(wc,"TokenizerNLModule",null,
[736]);class Uc{constructor(Qa,xb){this.sJ=this.SG=this.mWc=this.v9=this.yga=0;this.Uff=!1;this.pLd=this.jtc=this.C3e=this.wgd=null;if(Qa){this.annotations=xb.annotations;var ac=0;try{this.yga=Qa.na(ac);++ac;this.v9=Qa.na(ac);++ac;this.mWc=Qa.na(ac);++ac;this.SG=Qa.na(ac);++ac;this.sJ=Qa.na(ac);++ac;this.Uff=1===Qa.na(ac);++ac;var zc=Qa.na(ac);++ac;0<zc&&(this.wgd=xb.ced(zc).fzh);this.C3e=Qa.na(ac)?xb.ga(Qa.na(ac)):"";++ac;const Yc=Qa.na(ac);++ac;this.jtc=Array(Yc);this.pLd=Array(Yc);for(zc=0;zc<
Yc;++zc)this.jtc[zc]=new RegExp(xb.ga(Qa.na(ac))),++ac,this.pLd[zc]=xb.ga(Qa.na(ac)),++ac}catch(Yc){throw Error.argument("initData");}}}}Object(c.a)(Uc,"TokenizerNLModuleInit",null,[]);class ob{constructor(Qa){this.Da=Qa}execute(Qa){if(!Qa)throw Error.argumentNull("input");let xb;if(!({value:xb}=Qa.Mi(this.Da.Hre)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const ac of this.Da.ASd)xb=ac.apply(xb);Qa=w.Annotations.QA(Qa);Qa.yn(this.Da.Ire,
xb);return Qa}static yVc(Qa,xb){const ac=new Sys.StringBuilder;for(let zc=0;zc<Qa.length;++zc)ac.append(xb(Qa.substr(zc,1)));return ac.toString()}}Object(c.a)(ob,"TransliteratorNLModule",null,[736]);class Zb{constructor(Qa){Qa&&(this.style=Qa.na(0))}apply(Qa){return ob.yVc(Qa,xb=>Zb.vVg(xb,this.style))}static vVg(Qa,xb){switch(xb){case 0:return Qa.toLowerCase();case 1:return"I"===Qa?"\u0131":Qa.toLowerCase();case 2:return Qa.toUpperCase();case 3:return"i"===Qa?"\u0130":Qa.toUpperCase();default:throw Error.invalidOperation();
}}}Zb.cGa=0;Object(c.a)(Zb,"ChangeCaseTransliterationStage",null,[743]);class Bc{apply(Qa){return ob.yVc(Qa,Bc.hLj)}static hLj(Qa){const xb=Qa.charCodeAt(0);return 65281<=xb&&65374>=xb?String.fromCharCode(xb-65248):Qa}}Bc.cGa=4;Object(c.a)(Bc,"LatinFullWidthToHalfWidthTransliterationStage",null,[743]);class bd{constructor(Qa,xb){Qa&&(this.MGd=xb.u0e(Qa.na(0)),this.xdj=xb.ga(Qa.na(1)))}apply(Qa){return Qa.replace(this.MGd,this.xdj)}}bd.cGa=1;Object(c.a)(bd,"RegexReplaceTransliterationStage",null,[743]);
class Ed{constructor(Qa,xb){if(Qa){var ac=Qa.na(0),zc=xb.ga(Qa.na(1)),Yc=new Pe(xb.zua(Qa.na(2)));Qa=0>Qa.na(3)?null:new Pe(xb.zua(Qa.na(3)));this.wTd={};for(xb=0;xb<ac;++xb)this.wTd[zc.charAt(xb).toString()]=zc.substr(Yc.na(xb),Qa?Qa.na(xb):1)}}apply(Qa){return ob.yVc(Qa,xb=>xb in this.wTd?this.wTd[xb]:xb)}}Ed.cGa=2;Object(c.a)(Ed,"SingleCharSubstitutionsTransliterationStage",null,[743]);class ge{constructor(Qa,xb){this.Ire=this.Hre=0;this.ASd=null;if(Qa){this.annotations=xb.annotations;var ac=0;
try{this.Hre=Qa.na(ac);++ac;this.Ire=Qa.na(ac);++ac;const zc=Qa.na(ac);++ac;this.ASd=Array(zc);for(let Yc=0;Yc<zc;++Yc){const md=Qa.na(ac);++ac;const sd=Qa.na(ac);++ac;const h=new aa.a;h.oua(Qa,ac,sd);ac+=sd;this.ASd[Yc]=this.cWi(md,h,xb)}}catch(zc){throw Error.argument("initData");}}}cWi(Qa,xb,ac){switch(Qa){case Zb.cGa:return new Zb(xb);case bd.cGa:return new bd(xb,ac);case Ed.cGa:return new Ed(xb,ac);case Bc.cGa:return new Bc;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");
}}}Object(c.a)(ge,"TransliteratorNLModuleInit",null,[]);class be{vRh(Qa,xb){const ac=Qa.na(0),zc=new aa.a;zc.oua(Qa,1,Qa.count-1);switch(ac){case 0:return new We(new Ze(zc,xb));case 2:return new wc(new Uc(zc,xb));case 3:return new hd(new oe(zc,xb));case 5:return new Vc(new P(zc,xb));case 9:return new ob(new ge(zc,xb));case 10:return new ff(new Wa(zc,xb));default:throw Error.notImplemented();}}}Object(c.a)(be,"NLModuleFactory",null,[714]);class qe{constructor(Qa){this.sSg=";";if(!Qa)throw Error.argumentNull("resource");
this.RQ=new Td(Qa,new ta,new be);this.lud=this.RQ.fRh();this.Lmf=this.RQ.annotations.dub("Text.Text");this.Jmf=this.RQ.annotations.dub("Classification.Predictions");this.Vtd=this.RQ.annotations.dub("Classification.PredictionString");this.Kmf=this.RQ.annotations.dub("Classification.Probability");this.kwi=this.RQ.annotations.dub("NLMod.Tokens");if(0>this.Lmf||0>this.Jmf||0>this.Vtd||0>this.Kmf)throw Error.argument("resourceObj","Resource does not represent a ranker");}NHh(){const Qa=[];this.f9c(void 0,
this.GVe(Qa),null);return Qa}PHh(Qa,xb){const ac=[],zc=[];this.f9c(Qa,this.GVe(ac),(Yc,md)=>{const sd=this.RQ.annotations.xVe(Yc),h=[],Ib=[];xb&&xb.length&&-1===Array.indexOf(xb,sd)||(Yc=this.RQ.annotations.getAttributeType(Yc),this.OGf(Yc,md,h,Ib),md=new Fe(sd,h,Ib),Array.add(zc,md))});return new Je(ac,zc)}OHh(Qa){const xb=[];this.f9c(Qa,ac=>{let zc;if(({value:zc}=ac.Mi(this.Vtd)).returnValue){let Yc;({value:Yc}=ac.Mi(this.Kmf)).returnValue&&Array.add(xb,new le(zc,Yc))}},null);return xb}f9c(Qa,xb,
ac){var zc=new r.a(this.RQ.annotations);zc.yn(this.Lmf,Qa);Qa=this.lud.execute(zc);if(({value:zc}=Qa.Mi(this.Jmf)).returnValue)for(const Yc of zc.items)xb(Yc);if(ac&&({value:xb}=Qa.Mi(this.kwi)).returnValue)for(const Yc of xb.items)Yc.b9b(ac)}OGf(Qa,xb,ac,zc){if(w.Annotations.zt(Qa))for(var Yc of xb.items)this.OGf(xb.bI,Yc,ac,zc);else if(w.Annotations.sag(Qa)){Yc=this.RQ.annotations.l_e(Qa);for(let md=0;md<Yc;md++)Array.add(ac,this.RQ.annotations.R1e(Qa,md)),Array.add(zc,this.RQ.annotations.AO(this.RQ.annotations.aKa(Qa,
md),xb.Jua(md)))}else Array.add(ac,"VALUE"),Array.add(zc,this.RQ.annotations.AO(Qa,xb))}GVe(Qa){return xb=>{let ac;({value:ac}=xb.Mi(this.Vtd)).returnValue&&Array.add(Qa,this.rTh(ac))}}rTh(Qa){const xb=Qa.indexOf(this.sSg);return 0>xb?Qa:Qa.substring(0,xb)}}Object(c.a)(qe,"Ranker",null,[]);var ze=a(753),Ce=a(772),Ve=a(706),we=a(699),vc=a(698),ed=a(4);class Id{constructor(Qa,xb){this.K9d="";this.ZNc=null;this.$Nc=!1;this.OW=null;this.Skg=["TellMe.TellMeParamCollection"];this.Ua=Qa;this.nfa=xb;this.Ua.KFa&&
(this.OW=null)}get Lpc(){if(!this.ZNc&&!this.$Nc){let Qa=null;try{Qa=window.TellMeModel}catch(xb){if(we.TellMeActor.instance.sc)we.TellMeActor.instance.sc.onError("QueryRanker","TellMeModel not found. Exception: "+xb)}if(Qa){try{this.ZNc=new qe(Qa)}catch(xb){if(we.TellMeActor.instance.sc)we.TellMeActor.instance.sc.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+xb)}this.$Nc=!0}else if(we.TellMeActor.instance.sc)we.TellMeActor.instance.sc.onError("QueryRanker","Classifier model not found")}return this.ZNc}Px(){return"Command"}eF(){return 0===
this.Ua.Ll?0:1===this.Ua.Ll?1:2}nv(Qa,xb,ac=!1,zc=b.a.tellMe,Yc=null){const md=new m.a(Qa);if((!Yc||Array.contains(Yc,0))&&!vc.a.cD(Qa)){if(!this.Lpc&&this.$Nc){if(we.TellMeActor.instance.sc)we.TellMeActor.instance.sc.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.Ua.KFa&&this.OW&&this.OW.initialize();if(ze.CommandResultsUtility.Vld(Qa.Hd)&&(Yc=ze.CommandResultsUtility.xWe(Qa.Hd),0<Yc.results.length)){Yc.displayName=
"Classifier Debug";md.Cm(Yc);xb.resultsUpdated(md);return}Yc=Qa?this.K9d=Qa.Hd:this.K9d;if(ed.AFrameworkApplication.fa.qa("TellMeParameterizedQueriesEnabled")){Yc=this.tTh(Yc);var sd=this.g$b(Yc.Ied());Yc=Yc.hVe()}else Yc=this.sTh(Yc),sd=this.$Jh(Yc),Yc=[];ze.CommandResultsUtility.Sic(sd,!1,"Classifier","TFIDF");sd=ze.CommandResultsUtility.Cac(Qa,sd,this.Ua,this.OW,this.nfa,Yc,0,1);0<sd.results.length&&zc!==b.a.contextMenu&&(sd.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);ac||sd.results.length||
this.Ua.Mva||this.Ua.qna||(Qa=new Ve.a("lookupNoResults",14,Qa.Hd,null,1),sd.Fn(Qa));0<sd.results.length&&md.Cm(sd);md.attributes=Yc}xb.resultsUpdated(md)}Ied(){let Qa=[];try{Qa=this.Lpc.NHh()}catch(xb){if(we.TellMeActor.instance.sc)we.TellMeActor.instance.sc.onError("GetPredictions","Exception: "+xb)}return Qa}sTh(Qa){let xb=[];try{xb=this.Lpc.OHh(Qa)}catch(ac){if(we.TellMeActor.instance.sc)we.TellMeActor.instance.sc.onError("GetPredictionsWithScore","Exception: "+ac)}return xb}tTh(Qa){try{return this.Lpc.PHh(Qa,
this.Skg)}catch(xb){if(we.TellMeActor.instance.sc)we.TellMeActor.instance.sc.onError("GetPredictionsWithTokenAttributes","Exception: "+xb)}return new Je([],[])}g$b(Qa){const xb=[];if(Qa)for(const ac of Qa)xb.push(new Ce.a(ac,-99999));return xb}$Jh(Qa){const xb=[];if(Qa)for(const ac of Qa)xb.push(new Ce.a(ac.prediction,ac.score));return xb}}Object(c.a)(Id,"CommandResultsProvider",null,[645]);var Ld=a(912),ce=a(30);class la{constructor(Qa,xb,ac,zc){this.FG=Qa;this.Sqa=xb;this.rhe=zc;this.uog=ac;this.Ua=
we.TellMeActor.instance.Ox()}Px(){return"EmptyQuery"}eF(){return 1===this.Ua.Ll?1:0}nv(Qa,xb,ac=!1,zc,Yc=null){zc=new m.a(Qa);if((!Yc||Array.contains(Yc,5)||Array.contains(Yc,6)||Array.contains(Yc,4))&&vc.a.cD(Qa)){this.FG.xJa().length||!this.uog||this.rhe||(Qa=new l.a(6),Yc=new Ve.a(null,13,void 0,void 0,1),Qa.Fn(Yc),zc.Cm(Qa));Qa=new l.a(4);if(0<this.FG.xJa().length){Qa.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;Yc=this.FG.xJa();var md=[];for(var sd of Yc)md.push(sd.Id);ze.CommandResultsUtility.acg(md,
this.Ua);for(var h of Yc)ze.CommandResultsUtility.Zva(h.Id)&&Qa.Fn(new Ve.a(h.Id,5,null,null,2));zc.Cm(Qa)}if(this.rhe&&0<this.Sqa.length&&this.FG.xJa().length<la.Lof){sd=new l.a(5);sd.displayName=CommonUIStrings.l_TellMeTryQueryTitle;h=la.Lof-Qa.results.length;Qa=[];for(Yc=0;Yc<this.Sqa.length&&Yc<h;++Yc){if(ac){md=vc.a.xWd+(Yc+1);const Ib=this.Sqa[Yc].key,ec=ce.a.replaceAll(Ib,'"',"");Qa.push(appChrome.actions.setControlLabel(md,Ib));Qa.push(appChrome.actions.setButtonCommandValueId(md,ec));md=
new Ld.a(Ib,7,0,ec,md)}else md=new Ld.a(this.Sqa[Yc].key,7,0,this.Sqa[Yc].value);sd.Fn(md)}0<Qa.length&&appChrome.api.dispatch(Qa);zc.Cm(sd)}}xb.resultsUpdated(zc)}}la.Lof=5;Object(c.a)(la,"EmptyQueryResultsProvider",null,[645]);class jb{constructor(Qa){this.Ua=Qa}Px(){return"Feedback"}eF(){return 0===this.Ua.Ll?0:1===this.Ua.Ll?1:2}nv(Qa,xb,ac,zc,Yc=null){Qa=new m.a(Qa);if(!Yc||Array.contains(Yc,21))Yc=[],Yc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),
appChrome.api.dispatch(Yc),Yc=new l.a(22),Yc.displayName="",Yc.Fn(new Ve.a("TellMeFeedback",23,null,null,1)),Qa.Cm(Yc);xb.resultsUpdated(Qa)}}Object(c.a)(jb,"FeedbackResultsProvider",null,[645]);class ra{constructor(Qa,xb,ac,zc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=Qa;this.CommandId=xb;this.CommandValueId=ac;this.InputText=zc}}Object(c.a)(ra,"FindInDocumentProp",null,[]);var hb=a(910);class Eb{constructor(Qa){this.PLc=2;this.LDa=[];this.hqa=[];this.Ua=Qa;Eb.l3=
Qa.PRe;Eb.RRe="FindInDocumentSuggestion";Eb.YFf="FindInDocumentSuggestion3";this.vrg=Object.assign(new hb.a,{landingTab:"Indoc",data:null});this.qvg=this.Ua.Mcb||!!ed.AFrameworkApplication.ta&&ed.AFrameworkApplication.ta.Oa.Mcb}Px(){return"FindInDocument"}eF(){return 0===this.Ua.Ll?0:1===this.Ua.Ll?1:3===this.Ua.Ll?this.Ua.n4f?2:3:2}nv(Qa,xb,ac=!1,zc,Yc=null){const md=new m.a(Qa);if(Yc&&!Array.contains(Yc,2))xb.resultsUpdated(md);else if(Array.clear(this.LDa),vc.a.cD(Qa)){if(ac&&this.R1f()){ac=new l.a(2);
ac.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Yc=1;zc="";if(0<this.hqa.length&&!this.Ua.Ocb)for(var sd of this.hqa)if(""!==sd.Label.toLowerCase()){if(Yc>=this.PLc)break;this.ldg(ac,sd.Label,sd.CommandValueId,Eb.RRe+Yc,sd.InputText);Yc++}sd="";this.Ua.yy?(md.Cm(ac),ac=new l.a(3),sd=this.Ua.Cra?vc.a.xua(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):CommonUIStrings.l_TellMeOpenFindPaneTextV2):sd=CommonUIStrings.l_TellMeOpenFindPaneText;zc=this.wWe("");this.ldg(ac,sd,zc,Eb.YFf,"");
md.Cm(ac)}xb.resultsUpdated(md)}else sd="",ac&&(ac=this.wWe(Qa.Hd),zc=[],this.Ua.Mwa?(this.Ua.EQd&&zc.push(appChrome.actions.setControlIconSet(Eb.l3,{"default":"FindInDocument_20"})),sd=this.Ua.Opd?vc.a.ldd(Qa.Hd,CommonUIStrings.l_FindInDocumentScopedButtonText):Qa.Hd+CommonUIStrings.l_FindInDocumentScopedButtonText):this.Ua.yy?(sd=this.Ua.Cra?vc.a.xua(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,Qa.Hd)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,Qa.Hd),
zc.push(appChrome.actions.setControlIconSet(Eb.l3,{"default":"FindInDocument_20"}))):sd=this.Ua.Ocb?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,Qa.Hd),this.Ua.I3?(we.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Eb.l3,sd)),we.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Eb.l3,ac))):(zc.push(appChrome.actions.setControlLabel(Eb.l3,sd)),zc.push(appChrome.actions.setButtonCommandValueId(Eb.l3,ac)),appChrome.api.dispatch(zc)),
this.BZf(sd,Eb.l3,ac,Qa.Hd)),this.Ua.n4f?(sd=new Ve.a(Eb.l3,8,Qa.Hd),ac=new l.a(2),ac.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,ac.Fn(sd),md.Cm(ac),xb.resultsUpdated(md)):this.Ua.rNh().then(h=>{const Ib=new Ve.a(Eb.l3,8,Qa.Hd,null,1);Ib.count=h;h=new l.a(2);h.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;h.Fn(Ib);md.Cm(h);xb.resultsUpdated(md)},h=>{we.TellMeActor.instance.sc.onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+h);h=new Ve.a(Eb.l3,
8,Qa.Hd,null,1);const Ib=new l.a(2);Ib.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Ib.Fn(h);md.Cm(Ib);xb.resultsUpdated(md)})}R1f(){return!!this.Ua&&this.Ua.kwc}ldg(Qa,xb,ac,zc,Yc=null){const md=[];xb&&md.push(appChrome.actions.setControlLabel(zc,xb));this.Ua.yy&&md.push(appChrome.actions.setControlIconSet(zc,{"default":"FindInDocument_20"}));md.push(appChrome.actions.setButtonCommandValueId(zc,ac));appChrome.api.dispatch(md);this.BZf(xb,zc,ac,"");Qa.Fn(new Ve.a(zc,8,Yc,null,1,-99999))}wWe(Qa){return this.qvg?
vc.a.Ksa(Qa,15,this.vrg):ce.a.gf(Qa)}BZf(Qa,xb,ac,zc){this.R1f()&&this.LDa.length<this.PLc&&(Qa=new ra(Qa,xb,ac,zc),Array.add(this.LDa,Qa))}Pqj(Qa){for(let xb=0;xb<this.LDa.length;xb++)if(this.LDa[xb].CommandId===Qa){const ac=this.LDa[xb].Label;let zc=!1;if(0<this.hqa.length){let Yc=0;for(const md of this.hqa){if(md.Label===ac){Array.removeAt(this.hqa,Yc);zc=!0;break}Yc++}}!zc&&this.hqa.length>=this.PLc-1&&Array.removeAt(this.hqa,1);Array.insert(this.hqa,0,this.LDa[xb])}}}Eb.l3=null;Eb.RRe=null;Eb.YFf=
null;Object(c.a)(Eb,"FindInDocumentResultsProvider",null,[645]);var fc=a(1096);class Mc{constructor(Qa){this.Ua=Qa}Px(){return"Insights"}eF(){return 0===this.Ua.Ll?0:1===this.Ua.Ll?1:2}nv(Qa,xb,ac=!1,zc,Yc=null){zc=new m.a(Qa);if(!Yc||Array.contains(Yc,13))if(this.wxj()||!vc.a.cD(Qa)){Yc=new l.a(13);var md=""===Qa.Hd.trim(),sd=md?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",h=new Ve.a(sd,10,Qa.Hd,null,1);ac&&(ac=null,vc.a.x4()?md?md=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(md=this.Ua.Ocb?
CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,Qa.Hd),ac=vc.a.Ksa(Qa.Hd,1)):(md=String.format(CommonUIStrings.l_InsightsButtonText,Qa.Hd),ac=vc.a.j3c(Qa.Hd)),this.Ua.I3?(we.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(sd,md)),ac&&we.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",ac))):(Qa=[],Qa.push(appChrome.actions.setControlLabel(sd,md)),ac&&Qa.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
ac)),appChrome.api.dispatch(Qa)),h.label=md);Yc.Fn(h);zc.Cm(Yc)}xb.resultsUpdated(zc)}wxj(){return vc.a.x4()&&this.Ua.LHj}}Object(c.a)(Mc,"InsightsResultsProvider",null,[645]);var xd=a(1094);class Hd{constructor(Qa){this.Ua=Qa}Px(){return"Learning"}eF(){return 0===this.Ua.Ll?0:1===this.Ua.Ll?1:2}nv(Qa,xb,ac,zc,Yc=null){ac=new m.a(Qa);Yc&&!Array.contains(Yc,21)||!vc.a.cD(Qa)||(Yc=[],zc=this.Ua.Lqi,Yc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",zc)),zc=Hd.ZNh(zc),Yc.push(appChrome.actions.setControlLabel("LearningForSearch",
zc)),appChrome.api.dispatch(Yc),Qa=new Ve.a("LearningForSearch",22,Qa.Hd,null,1),Yc=new l.a(21),Yc.Fn(Qa),ac.Cm(Yc));xb.resultsUpdated(ac)}static ZNh(Qa){const xb=[];Array.add(xb,new xd.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(xb,new xd.a(400,CommonUIStrings.l_TellMeLearningButtonText));Array.add(xb,new xd.a(600,Qa));Array.add(xb,new xd.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));Qa={};Qa.parts=xb;return JSON.stringify(Qa)}}Object(c.a)(Hd,"LearningProvider",null,
[645]);var Md=a(452);class ae{constructor(Qa,xb){this.MVa=this.oXa=this.uqa=this.tTb=null;this.UB=!1;this.fWa=Qa;this.Wmg=xb;Qa&&this.BQe(Qa)}Ezc(){this.fWa.Ezc()&&this.BQe(this.fWa)}xXh(Qa){let xb=[];var ac=[];Qa=ae.LCi(Qa);var zc="";Array.clear(ac);for(let Yc=0;Yc<Qa.length;Yc++){const md=Qa.charAt(Yc);-1!==" ".indexOf(md)?(zc.length&&Array.add(ac,zc),zc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(md)?(zc.length&&Array.add(ac,zc),zc=md,Array.add(ac,zc),zc=""):zc+=md}zc.length&&Array.add(ac,
zc);for(Qa=0;Qa<ac.length;Qa++)zc=this.ZJh(ac[Qa]),zc=this.A2g(zc),xb=ae.pzi(xb,zc);return xb=this.NBg(xb)}e6a(){this.UB||this.Ezc();return this.UB}E4b(Qa){return this.tTb[Qa.toString()]}NBg(Qa){for(let xb=0;xb<Qa.length;xb++){const ac=this.uqa[xb];if(Qa[xb].commandId!==this.E4b(ac[0]))throw Error.create("Incorrect Tcid orders with Priors data");let zc;(zc=Qa[xb]).score=zc.score+ac[1]}return Qa}A2g(Qa){const xb=[];for(var ac=0;ac<this.uqa.length;ac++)xb.push(new Ce.a(this.E4b(this.uqa[ac][0]),-5));
ac=new Md.a;for(var zc=0;zc<Qa.length;zc++)ac.add(this.E4b(Qa[zc][0]));for(zc=0;zc<xb.length;zc++){const md=xb[zc];for(let sd=0;sd<Qa.length;sd++){var Yc=Qa[sd];const h=this.E4b(Yc[0]);Yc=Yc[1];if(h===md.commandId){md.score=Yc;ac.remove(h);break}}if(!ac.count)break}return xb}ZJh(Qa){const xb=1>Qa.length;for(let sd=0;2>=sd;sd++){const h=this.MVa;for(let Ib in h){var ac=h[Ib],zc=Qa,Yc=Ib;const ec=Yc.length+1,Ec=Array((zc.length+1)*ec);for(var md=0;md<=zc.length;md++)Ec[md*ec]=md;for(md=0;md<=Yc.length;md++)Ec[md]=
md;for(md=0;md<Yc.length;md++)for(let fd=0;fd<zc.length;fd++)Ec[(fd+1)*ec+(md+1)]=zc.charAt(fd)===Yc.charAt(md)?Ec[fd*ec+md]:Math.min(Math.min(Ec[fd*ec+(md+1)]+1,Ec[(fd+1)*ec+md]+1),Ec[fd*ec+md]+1);zc=Ec[zc.length*ec+Yc.length];if((!zc||!xb)&&zc<=sd)return ac}}return this.oXa}BQe(Qa){this.tTb=Qa.bed();this.uqa=Qa.NTh();this.oXa=Qa.WYh();this.MVa=Qa.TPh();if(this.UB=!!this.tTb&&!!this.uqa&&!!this.MVa&&!!this.oXa)this.UB=0<this.uqa.length&&ae.rld(this.uqa);this.UB&&(this.UB=0<this.oXa.length&&ae.rld(this.oXa));
this.UB&&(this.MVa=ae.xZh(this.MVa));this.UB||(this.MVa=this.oXa=this.uqa=this.tTb=null)}DYh(Qa){Qa=this.xXh(Qa);return this.Yyh(Qa,this.Wmg)}Yyh(Qa,xb){let ac=[];for(let zc=0;zc<Qa.length;zc++)Qa[zc].score>=xb&&ac.push(Qa[zc]);ac.sort((zc,Yc)=>zc.score<Yc.score?1:zc.score>Yc.score?-1:0);0<ac.length-10&&(ac=ac.slice(0,10));return ac}static pzi(Qa,xb){if(!Qa.length)return xb;if(Qa.length!==xb.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");
for(let ac=0;ac<Qa.length;ac++){if(Qa[ac].commandId!==xb[ac].commandId)throw Error.create("Incorrect CommandId");let zc;(zc=Qa[ac]).score=zc.score+xb[ac].score}return Qa}static LCi(Qa){return ce.a.ll(Qa)}static rld(Qa){for(let xb=0;xb<Qa.length;xb++)if(2!==Qa[xb].length)return!1;return!0}static xZh(Qa){const xb={};for(let Yc in Qa){var ac=Yc,zc=Qa[Yc];const md=zc;md.length&&ae.rld(md)&&(xb[ac]=zc)}return xb}}Object(c.a)(ae,"NaiveBayesClassifierModel",null,[]);class me{constructor(Qa,xb){this.OW=null;
this.Ua=Qa;this.ojb=new ae(xb,Qa.OZe);this.Ua.KFa&&(this.OW=null)}Px(){return"NBCommand"}eF(){return 0===this.Ua.Ll?0:1===this.Ua.Ll?1:2}nv(Qa,xb,ac=!1,zc=b.a.tellMe,Yc=null){const md=new m.a(Qa);if((!Yc||Array.contains(Yc,0))&&!vc.a.cD(Qa)){if(ze.CommandResultsUtility.Vld(Qa.Hd)&&(Yc=ze.CommandResultsUtility.xWe(Qa.Hd),0<Yc.results.length)){Yc.displayName="Classifier Debug";md.Cm(Yc);xb.resultsUpdated(md);return}if(!this.ojb.e6a()){if(we.TellMeActor.instance.sc)we.TellMeActor.instance.sc.onError("CRASH",
"NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.Ua.KFa&&this.OW&&this.OW.initialize();Yc=this.ojb.DYh(Qa.Hd);ze.CommandResultsUtility.Sic(Yc,!1,"Classifier","NaiveBayesian");Yc=ze.CommandResultsUtility.Cac(Qa,Yc,this.Ua,this.OW,null,null,0,1);0<Yc.results.length&&zc!==b.a.contextMenu&&(Yc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);ac||Yc.results.length||this.Ua.Mva||this.Ua.qna||(Qa=new Ve.a("lookupNoResults",
14,Qa.Hd,null,1),Yc.Fn(Qa));0<Yc.results.length&&md.Cm(Yc)}xb.resultsUpdated(md)}}Object(c.a)(me,"NaiveBayesCommandProvider",null,[645]);class Re{constructor(){this.JDa=null;this.UB=!1;this.Ezc()}Ezc(){this.UB||(this.JDa=window.NBCRM)&&4===this.JDa.length&&(this.UB=!0);return this.UB}NTh(){return this.UB?this.JDa[1]:null}WYh(){return this.UB?this.JDa[2]:null}TPh(){return this.UB?this.JDa[3][0]:null}bed(){return this.UB?this.JDa[0][0]:null}}Object(c.a)(Re,"NaiveBayesModelAdapter",null,[659]);var Xe=
a(199);class qf{constructor(Qa){this.Ua=Qa}Px(){return"OfficeScript"}eF(){return 0===this.Ua.Ll?0:1===this.Ua.Ll?1:2}nv(Qa,xb){const ac=new m.a(Qa);if(!vc.a.cD(Qa)){Qa=Xe.d(Qa.Hd);var zc=new l.a(25);zc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;zc=this.ale(Qa,qf.pOj,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,zc);zc=this.ale(Qa,qf.fDh,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,zc);ac.Cm(zc)}xb.resultsUpdated(ac)}ale(Qa,
xb,ac,zc,Yc,md){const sd=[];for(const h of xb)if(Xe.a(Qa,h)){this.Ua.I3?(we.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ac,Yc)),we.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ac,zc))):(sd.push(appChrome.actions.setControlLabel(ac,Yc)),sd.push(appChrome.actions.setButtonCommandValueId(ac,zc)),appChrome.api.dispatch(sd));md.Fn(new Ve.a(ac,26,null,null,1));break}return md}}qf.pOj="unhide row rows col cols column columns".split(" ");qf.fDh=["freeze",
"selection","pane","panes"];Object(c.a)(qf,"OfficeScriptsSamplesProvider",null,[645]);var uf=a(185),Cf=a(328),Jf=a(798),Uf=a(740),cg=a(797),wg=a(41),Vf=a(172),Da=a(692);class Fb{constructor(Qa){this.Hy=null;this.xG=-1;this.cvd=14;this.fvd=12;this.attributes=this.oRc=this.query=null;this.u6a=!1;this.EWa=[];this.wh=ed.AFrameworkApplication.vd;ed.AFrameworkApplication.fa&&(this.cvd=ed.AFrameworkApplication.fa.nd("TellMeMaxTermedResults",this.cvd),this.fvd=ed.AFrameworkApplication.fa.nd("TellMeMaxZeroTermResults",
this.fvd));this.kB=Qa}get rh(){return this.EWa}get Rzc(){return this.oRc}Cm(Qa){let xb=!1;for(let ac=0;ac<this.rh.length;ac++)if(27!==this.rh[ac].groupType&&this.rh[ac].groupType===Qa.groupType){this.uTc(this.rh[ac],Qa);xb=!0;break}xb||this.rh.push(Qa)}uTc(Qa,xb){for(let ac=0;ac<xb.results.length;ac++)Qa.Fn(xb.results[ac])}ROf(Qa){const xb=[];for(const ac of this.rh)ac.groupType!==Qa&&xb.push(ac);this.rh.length!==xb.length&&(this.EWa=xb)}$9i(Qa){let xb=null,ac=null,zc=null;for(let Yc=0;Yc<Qa.length;Yc++){const md=
Qa[Yc];if(md&&md.rh&&md.rh.length)for(const sd of md.rh)if(17===sd.groupType||18===sd.groupType)xb=sd;else if(0===sd.groupType||16===sd.groupType)ac=sd,zc=md}xb&&ac&&0<ac.results.length&&(17===xb.groupType&&({gTc:ac,zTc:xb}=ze.CommandResultsUtility.NAg(ac,xb,this.kB.Ox()?this.kB.Ox().zJh:-.6)),zc.ROf(ac.groupType))}SCj(){new uf.a;this.KLb(this.kB.Inf)}Izb(Qa,xb){return this.query.Hd.length>this.kB.Ox().XTh&&this.Mji(Qa,xb)||this.query.Hd.length>this.kB.Ox().YTh&&this.mmi(Qa,xb)?!0:!1}mmi(Qa,xb){return Qa&&
Qa.length&&xb&&xb.length?-1===xb.toLowerCase().indexOf(Qa.toLowerCase())?!1:!0:!1}Mji(Qa,xb){return Qa&&Qa.length&&xb&&xb.length?xb.toLowerCase().startsWith(Qa.toLowerCase()):!1}czh(Qa){const xb=[];for(const ac of this.kB.Ox().yy?this.Rzc:this.rh)Qa.contains(ac.groupType)||xb.push(ac);this.kB.Ox().yy?this.oRc=xb:this.EWa=xb}OSj(Qa,xb){const ac=[];for(const zc of this.rh){const Yc=zc;if(13!==Yc.groupType){const md=Qa[Uf.a[Yc.groupType].toLowerCase()];let sd="False";md<xb&&(sd="True");Yc.displayName=
Yc.displayName+" ("+sd+": "+md+")"}ac.push(Yc)}this.EWa=ac}KLb(Qa,xb=!1,ac=null){if(this.kB.Ox().yy){if(!xb)for(this.oRc=Array(this.rh.length),xb=0;xb<this.rh.length;xb++)this.Rzc[xb]=this.rh[xb];this.kB.Rnf.KLb(this.rh,this.Rzc,this.query,Qa,ac)}else{for(ac=new uf.a;this.rh.length;){xb=this.rh.pop();const zc=Uf.a[xb.groupType].toLowerCase(),Yc=Qa[zc];if(Da.c(Yc))throw Error.create("GroupId "+zc+" missed from group SortingOrder");ac.add(new Cf.a(Yc,xb))}ac.Sc((zc,Yc)=>zc.key<Yc.key?-1:1);for(Qa=0;Qa<
ac.count;Qa++)xb=ac.na(Qa).value,this.rh.push(xb)}}TCj(){var Qa=!1;let xb=!1,ac=!1;for(let Yc=0;Yc<this.rh.length;Yc++){var zc=this.rh[Yc];const md=zc.groupType;if(8===md||15===md||14===md){zc=zc.results;for(let sd=0;sd<zc.length;sd++){if(8===md&&this.Izb(this.query.Hd,zc[sd].label)){Qa=!0;break}if(15===md&&this.Izb(this.query.Hd,zc[sd].label)){xb=!0;break}if(14===md){if(this.Izb(this.query.Hd,zc[sd].label)||this.Izb(this.query.Hd,zc[sd].description)){ac=!0;break}const h=zc[sd].label.split(" ");for(const Ib of h)if(this.Izb(this.query.Hd,
Ib)){ac=!0;break}}}}}Qa=this.kB.tVh(Qa,xb,ac);this.KLb(Qa)}qOa(Qa,xb,ac,zc,Yc,md){if(Yc===this.Hy){var sd=Qa.data.Vd;Yc=null;try{Yc=wg.b(sd)}catch(fe){we.TellMeActor.instance.sc.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+fe);return}if("RankerResults"in Yc&&Yc.RankerResults){this.m2();var h=Yc.RankerResults,Ib=new uf.a,ec=new uf.a;sd=0;for(var Ec of h){h=Ec.ProviderId;var fd=Ec.Score;sd+=fd;Ib.add(new Cf.a(h,fd))}Ib.Sc((Le,te)=>Le.value>te.value?
-1:1);fd=md?md.eWh:1E-6;Ec={};h={};let fe=0;for(var Cd=0;Cd<Ib.count;Cd++){let Le=parseInt(Ib.na(Cd).key),te=Ib.na(Cd).value/sd;1===Le&&(h.answer=fe++,h.entity=fe++,h.definition=fe++,h.wolframanswer=fe++,te<fd&&(ec.add(9),ec.add(11),ec.add(10),ec.add(12)),Ec.answer=te,Ec.entity=te,Ec.definition=te,Ec.wolframanswer=te);2===Le&&(h.assistance=fe++,te<fd&&ec.add(8),Ec.assistance=te);3===Le&&(h.classifier=fe++,h.serviceclassifier=fe++,te<fd&&(ec.add(0),ec.add(17)),Ec.classifier=te,Ec.serviceclassifier=
te);4===Le&&(h.people=fe++,te<fd&&ec.add(14),Ec.people=te);5===Le&&(h.document=fe++,te<fd&&ec.add(15),Ec.document=te);6===Le&&(h.findindocument=fe++,te<fd&&ec.add(2),Ec.findindocument=te);7===Le&&(h.notes=fe++,te<fd&&ec.add(20),Ec.notes=te);8===Le&&(h.image=fe++,te<fd&&ec.add(19),Ec.image=te)}Ib=new uf.a;Ib.add("classifier");Ib.add("serviceclassifier");Ib.add("appsforoffice");Ib.add("addin");Ib.add("findindocument");Ib.add("assistance");Ib.add("document");Ib.add("people");Ib.add("answer");Ib.add("wolframanswer");
Ib.add("definition");Ib.add("entity");Ib.add("image");Ib.add("template");Ib.add("officescript");for(Cd=0;Cd<Ib.count;Cd++)Ib.na(Cd)in h||(h[Ib.na(Cd)]=fe++);h.learning=fe++;h.insights=fe++;h.feedback=fe++;md&&md.Hii&&this.OSj(Ec,fd);md&&md.Iii&&this.czh(ec);ec={};for(var Gd in Ec)ec[Gd]=Ec[Gd]*sd;this.KLb(h,!0,ec)}if(md.ppd&&"Intents"in Yc&&Yc.Intents){Gd=Yc.Intents;for(var Yd of Gd)if(this.lqd(Yd)&&"Serplet"===Yd.GroupType&&Yd.ConfidenceScore>Yd.ConfidenceThreshold){Gd=!1;Yc=0;if(md.qpd){sd=new Ve.a("",
28);for(ec=0;ec<this.rh.length;ec++)if((Ib=this.rh[ec].results)&&0<Ib.length){Yc=ec;sd=Ib[0];break}2===sd.groupType&&(Gd=!0)}sd=new l.a(13);Gd&&md.qpd&&(sd=new l.a(13,CommonUIStrings.l_TellMeWebTitle));ec=new Ve.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Hd,null,0);Ib=[];Ec=null;Ec=vc.a.x4()?vc.a.Ksa(this.query.Hd,1):vc.a.j3c(this.query.Hd);Ib.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",Ec));Ec=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,
this.query.Hd);Ib.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",Ec));appChrome.api.dispatch(Ib);sd.Fn(ec);ec=[];if(Gd&&md.qpd)for(ec.push(this.rh[Yc]),ec.push(sd),Gd=Yc+1;Gd<this.rh.length;Gd++)(Yc=this.rh[Gd].results)&&0<Yc.length&&ec.push(this.rh[Gd]);else for(ec.push(sd),Gd=0;Gd<this.rh.length;Gd++)(Yc=this.rh[Gd].results)&&0<Yc.length&&ec.push(this.rh[Gd]);this.EWa=ec}}if(md.Lzb&&!md.yy){Yd=Gd=-1;for(Yc=0;Yc<this.rh.length;Yc++)switch(this.rh[Yc].groupType){case 23:Gd=
Yc;break;case 0:case 17:case 2:-1===Yd&&(Yd=Yc)}if(-1!==Gd){Yd=-1===Yd?0:Gd>Yd?Yd+1:Yd;Gd=this.rh[Gd];Yc=Array(this.rh.length);sd=0;for(ec=0;ec<Yc.length;ec++)ec===Yd?Yc[ec]=Gd:(23===this.rh[sd].groupType&&sd++,Yc[ec]=this.rh[sd],sd++);this.EWa=Yc}}zc.resultsUpdated(this);zc=we.TellMeActor.instance.sc;zc.c_(xb.length,"RankerInference",Qa.data.httpStatus.toString(),Math.round(window.performance.now()-ac),cg.a.g8f,!0,Jf.a.Caa);this.u6a&&zc&&(Qa=this.query.Sya,xb=zc.DQb,md.Ygc&&Qa>xb&&!md.yy&&(zc.mtd(this.query.Hd),
zc.zNd(Qa)))}}lqd(Qa){if("GroupType"in Qa&&Qa.GroupType&&"ConfidenceScore"in Qa&&"ConfidenceThreshold"in Qa)return!0;we.TellMeActor.instance.sc.onError("IsValidIntentGroup","Invalid intents found");return!1}dOa(Qa,xb,ac,zc,Yc){zc===this.Hy&&(this.m2(),we.TellMeActor.instance.sc.c_(xb.length,"RankerInference",Qa.data.httpStatus.toString(),Math.round(window.performance.now()-ac),cg.a.g8f,!1,Jf.a.Caa));Yc.resultsUpdated(this)}m2(){-1!==this.xG&&(window.clearTimeout(this.xG),this.xG=-1)}UCj(Qa){let xb;
xb=this.kB.Ox().yy?we.TellMeActor.instance.sc.Afd(this.Rzc,this.query.Hd):we.TellMeActor.instance.sc.Afd(this.rh,this.query.Hd);var ac=this.kB.Ox().dWh;""!==ac&&(ac="_"+ac);let zc="";this.kB.Ox().Snd&&(zc="RankerInference"+ac+",");this.kB.Ox().ppd&&(zc+="SerpletClassifier");","===zc.charAt(zc.length-1)&&(zc=zc.substring(0,zc.length-1));ac=we.TellMeActor.instance.sc.h2e(zc);const Yc=this.Hy=Vf.a.create().toString();ac["Client-Request-Id"]=Yc;const md=window.performance.now(),sd=this.kB.Ox()?this.kB.Ox().fWh:
600;this.m2();this.xG=window.setTimeout(()=>{if(Yc===this.Hy){this.Hy="";this.xG=-1;Qa.resultsUpdated(this);const h={};h[d.a.provider]="Ranker";h[d.a.jPa]=this.query.Sya;we.TellMeActor.instance.sc.sN(f.a.timedOut,sd,h)}},sd);this.wh.Bm(we.TellMeActor.instance.sc.i2e(),2,xb,ac,!1,0,h=>{this.qOa(h,this.query.Hd,md,Qa,Yc,this.kB.Ox())},h=>{this.dOa(h,this.query.Hd,md,Yc,Qa)},null,null,!1,4E3,6E3)}jMj(){var Qa=0,xb=new uf.a,ac=this.kB.Gnf,zc=this.kB.Hnf;for(var Yc=0;Yc<this.rh.length;Yc++){var md=this.rh[Yc],
sd=Uf.a[md.groupType].toLowerCase(),h=ac[sd];Qa+=md.results.length;md.results.length>h&&(sd=zc[sd],Da.c(sd)||xb.add(new Cf.a(sd,md)))}zc=!this.query||""===this.query.Hd.trim();Yc=Qa-(zc?this.fvd:this.cvd);if(!(0>=Yc)){zc=window.performance.now();Qa=Qa.toString()+" total,"+Yc.toString()+" to remove.";if(0<xb.count)for(xb.Sc((Ib,ec)=>Ib.key>ec.key?-1:1),md=0;md<xb.count&&0<Yc;md++){sd=xb.na(md).value;h=Uf.a[sd.groupType].toLowerCase();let Ib=sd.results.length-ac[h];Ib>Yc&&(Ib=Yc);0<Ib&&(sd.XHd(Ib),
Qa+=h+": "+Ib.toString()+" results removed.",Yc-=Ib)}if(0<Yc){Qa+=Yc.toString()+" results left after trimming.";xb=new uf.a;ac=this.kB.Lnf;for(md=0;md<this.rh.length;md++)sd=this.rh[md],h=ac[Uf.a[sd.groupType].toLowerCase()],Da.c(h)||xb.add(new Cf.a(h,sd));xb.Sc((Ib,ec)=>Ib.key<ec.key?-1:1);for(ac=0;0<Yc;)md=xb.na(ac++).value,Yc>=md.results.length?(Array.remove(this.rh,md),Qa+=Uf.a[md.groupType]+": "+md.results.length.toString()+" results force removed.",Yc-=md.results.length):(md.XHd(Yc),Qa+=Uf.a[md.groupType]+
": "+Yc.toString()+" results force removed.",Yc=0)}we.TellMeActor.instance.sc&&(xb={},xb[d.a.message]=Qa,we.TellMeActor.instance.sc.sN("ShowOptimal",window.performance.now()-zc,xb))}}}Object(c.a)(Fb,"CombineResultsUpdatedEventArgs",null,[615]);var Fc=a(911);class jd{constructor(Qa,xb,ac,zc=!1,Yc=""){this.mNc=this.wOc=!1;this.QD=Qa;this.gEa=[];this.cde=xb.length;this.Ua=we.TellMeActor.instance.Ox();this.MSb=zc;this.BEa=Yc;this.bXa={};for(Qa=0;Qa<xb.length;++Qa)this.bXa[Qa.toString()]=ac?0:xb[Qa].eF()}Orj(Qa,
xb){xb&&xb.query&&xb.query.Sya<we.TellMeActor.instance.nX||(this.gEa[Qa]=xb,this.mNc?this.wOc=!0:(!this.Ua||3!==this.Ua.Ll||3!==this.bXa[Qa.toString()]||this.EGe())&&this.Udc())}DWi(){this.mNc=!0}EOj(){this.mNc=!1;this.wOc&&(this.wOc=!1,this.Udc())}EGe(){if(this.gEa.length<this.cde)return!1;for(let Qa=0;Qa<this.cde;++Qa)if(!this.gEa[Qa])return!1;return!0}Udc(){var Qa=this.EGe();const xb=window.performance.now(),ac=new Fb(we.TellMeActor.instance.c6d);ac.$9i(this.gEa);for(var zc=0;zc<this.gEa.length;++zc){var Yc=
this.gEa[zc];if(Yc&&Yc.rh&&Yc.rh.length&&(ac.query=Yc.query,Yc.attributes&&0<Yc.attributes.length&&(ac.attributes=Yc.attributes),Yc&&Yc.rh&&(Qa||this.uWg(zc,this.gEa))))for(const md of Yc.rh)ac.Cm(md)}ac.rh&&ac.rh.length&&(ac.u6a=Qa,this.Ua&&this.Ua.hWd&&ac.jMj(),Fc.a.pgf()&&(this.Ua&&this.Ua.cli&&ac.query.Hd&&0<ac.query.Hd.length?ac.TCj():ac.SCj()),Fc.a.pgf()&&this.Ua&&(this.Ua.Snd||this.Ua.ppd)&&this.MSb&&ac.query.Hd&&0<ac.query.Hd.length&&ac.u6a&&this.BEa!==b.a.contextMenu?(3===this.Ua.Ll&&Qa||
this.QD.resultsUpdated(ac),ac.UCj(this.QD)):this.QD.resultsUpdated(ac),Qa=we.TellMeActor.instance.sc,ac.u6a&&Qa&&(zc=ac.query.Sya,Yc=Qa.DQb,ac.query.Hd&&0<ac.query.Hd.length&&this.MSb&&this.Ua.Ygc&&this.BEa!==b.a.contextMenu&&zc>Yc&&!this.Ua.Snd&&!this.Ua.yy&&(Qa.mtd(ac.query.Hd),Qa.zNd(zc)),Qa.sN(f.a.Rgj,window.performance.now()-xb)))}uWg(Qa,xb){if(!(this.bXa&&Qa.toString()in this.bXa)||xb.length<=Qa||!xb[Qa])return!1;if(!xb[Qa].rh.length)return!0;const ac=this.bXa[Qa.toString()];if(0===ac)return!0;
const zc=this.bXa;for(let md in zc){var Yc=zc[md];const sd=Number.parseInvariant(md);if(sd!==Qa&&Yc===ac&&!(xb.length>sd&&xb[sd]))return!1}return!0}}Object(c.a)(jd,"ResultsAggregator",null,[]);var Ad=a(1196);class Ud{constructor(){this.Tdb=this.Udb=this.Sdb=this.logCount=this.logRank=this.invertedRank=0}AAg(Qa,xb){switch(Qa){case 1:this.invertedRank=xb;break;case 3:this.logRank=xb;break;case 2:this.logCount=xb;break;case 5:this.Sdb=xb;break;case 4:this.Udb=xb;break;case 6:this.Tdb=xb}}}Object(c.a)(Ud,
"CommandFeatures",null,[]);class ue{constructor(Qa){this.g5d=0;this.isg=Qa;this.amg={}}get modelId(){return this.isg}get featureIntercept(){return this.g5d}get Gpb(){return this.amg}aAg(Qa,xb,ac){0===xb?this.g5d=ac:(this.Gpb[Qa]||(this.Gpb[Qa]=new Ud),this.Gpb[Qa].AAg(xb,ac))}}Object(c.a)(ue,"CoefficientsModel",null,[]);const re=(Qa,xb)=>Math.pow(10,-xb/(60*Math.LN10/Math.LN2*Qa));class Ue{constructor(Qa,xb){this.Utg=Qa;this._count=1;this.Qea=new Ud;this.features.logCount=1+Math.log(this.count)/Math.LN2;
this.features.invertedRank=Qa?1/Qa:0;this.features.logRank=2/Math.pow(2,Qa);this.features.Sdb=re(10,xb);this.features.Udb=re(2,xb);this.features.Tdb=re(1,xb)}get mPa(){return this.Utg}get count(){return this._count}get features(){return this.Qea}J7h(){this._count=this.count+1;this.features.logCount=1+Math.log(this.count)/Math.LN2}MSj(Qa){const xb=2/Math.pow(2,Qa);this.features.invertedRank=Math.max(this.features.invertedRank,Qa?1/Qa:0);this.features.logRank=Math.max(this.features.logRank,xb)}DTj(Qa){const xb=
re(10,Qa),ac=re(2,Qa);Qa=re(1,Qa);this.features.Sdb=Math.max(this.features.Sdb,xb);this.features.Udb=Math.max(this.features.Udb,ac);this.features.Tdb=Math.max(this.features.Tdb,Qa)}}Object(c.a)(Ue,"CommandModel",null,[]);class Ie{constructor(Qa){this.tgb=null;if(!Qa&&we.TellMeActor.instance.sc)we.TellMeActor.instance.sc.onError("PredictionEngine","IModelAdapter can't be null");this.fWa=Qa;this.sTb=this.wsd()}wsd(){const Qa=this.fWa.cRh(),xb=this.fWa.bed();if(void 0===Qa||null===Qa||void 0===xb||null===
xb)return!1;try{window.performance.now();this.tgb={};for(let ac=0;ac<Qa.length;ac++){const zc=Qa[ac],Yc=xb[zc[0].toString()].trim(),md=zc[1],sd=0!==md?xb[zc[2].toString()].trim():"",h=zc[3];Yc in this.tgb||(this.tgb[Yc]=new ue(Yc));this.tgb[Yc].aAg(sd,md,h)}}catch(ac){if(we.TellMeActor.instance.sc)we.TellMeActor.instance.sc.onError("LoadModelData","Error Loading Suggestions Model: "+ac);return!1}return!0}EEh(){const Qa=this.fWa.tPh(),xb={};if(!Qa)return xb;let ac=1;for(let zc=0;zc<Qa.length;zc++){const Yc=
Qa[zc];Yc.Id in xb?(xb[Yc.Id].J7h(),xb[Yc.Id].MSj(ac),xb[Yc.Id].DTj(Yc.TimeElapsedSinceClick)):xb[Yc.Id]=new Ue(ac,Yc.TimeElapsedSinceClick);ac++}return xb}e6a(){this.sTb||(this.sTb=this.wsd());return this.sTb}qTh(){let Qa=[];if(!this.sTb){if(we.TellMeActor.instance.sc)we.TellMeActor.instance.sc.onError("GetPredictedCommands","IModelAdapter returned no data");return Qa}const xb=this.EEh(),ac=this.tgb;for(let Yc in ac){const md=ac[Yc],sd=md.modelId;let h=0;for(let Ib in xb){var zc=Ib;const ec=xb[Ib].features;
(zc=zc in md.Gpb?md.Gpb[zc]:null)&&(h+=ec.invertedRank*zc.invertedRank+ec.logRank*zc.logRank+ec.logCount*zc.logCount+ec.Sdb*zc.Sdb+ec.Udb*zc.Udb+ec.Tdb*zc.Tdb)}h+=md.featureIntercept;Qa.push(new Ce.a(sd,h))}Qa.sort((Yc,md)=>Yc.score<md.score?1:Yc.score>md.score?-1:0);0<Qa.length-10&&(Qa=Qa.slice(0,10));return Qa}}Object(c.a)(Ie,"PredictionEngine",null,[]);class bf{constructor(){this.$ee={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),
"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),
"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),
"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),
"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}g$b(Qa,xb){return xb&&"word"===xb.application.toLowerCase()&&
Qa in this.$ee?this.$ee[Qa]:[]}}Object(c.a)(bf,"SuggestionResultsUtility",null,[]);class Ee{constructor(Qa,xb,ac){this.Ua=xb;this.ojb=new Ie(Qa);this.FG=ac;this.Bge=new bf}Px(){return"Suggestion"}eF(){return 0===this.Ua.Ll?0:1===this.Ua.Ll?1:2}nv(Qa,xb,ac,zc=b.a.tellMe,Yc=null){ac=new m.a(Qa);we.TellMeActor.instance.dOb=!1;if((!Yc||Array.contains(Yc,16))&&vc.a.cD(Qa)){if(!this.ojb.e6a()){if(we.TellMeActor.instance.sc)we.TellMeActor.instance.sc.onError("CRASH","SuggestionResultsProvider: Found invalid Model data");
throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}if(this.mpd()&&0<this.Bge.g$b(we.TellMeActor.instance.c4b,this.Ua).length){const sd=this.Bge.g$b(we.TellMeActor.instance.c4b,this.Ua);Yc=[];for(var md of sd)this.Ua.kwc&&"Find"===md||Yc.push(new Ce.a(md,0));we.TellMeActor.instance.dOb=!0}else Yc=this.ojb.qTh();ze.CommandResultsUtility.Sic(Yc,!0,"Recommended","LRE");md=[];for(const sd of Yc)this.FG&&this.FG.j1c(sd.commandId)||md.push(sd);Qa=ze.CommandResultsUtility.Cac(Qa,
md,this.Ua,null,null,null,16,1);0<Qa.results.length&&zc!==b.a.contextMenu&&(Qa.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<Qa.results.length&&ac.Cm(Qa)}xb.resultsUpdated(ac)}mpd(){return!!this.Ua&&(this.Ua.mpd||this.Ua.boi)}}Object(c.a)(Ee,"SuggestionResultsProvider",null,[645]);class zf{tPh(){return we.TellMeActor.instance.kFc}cRh(){return window.TellMeSuggestionModel}bed(){return window.CoefficientModelIdMap}}Object(c.a)(zf,"SuggestionsModelAdapter",null,[658]);var Af=a(1272),Mf=a(1097);
a.d(C,"AggregatorResultsProvider",function(){return mg});class mg{constructor(Qa=!1){this.uWa={};this.uWa[b.a.tellMe]=[];this.uWa[b.a.contextMenu]=[];this.MSb=Qa}xhf(Qa,xb,ac,zc,Yc=null){let md;var sd=!1;switch(zc){case b.a.contextMenu:md=this.uWa[b.a.contextMenu];sd=!0;break;default:md=this.uWa[b.a.tellMe]}xb=new jd(xb,md,sd,this.MSb,zc);xb.DWi();for(let h=0;h<md.length;++h){const Ib=window.performance.now(),ec=new k(xb,h);(sd=we.TellMeActor.instance.Ox())&&sd.LOg?window.setTimeout(()=>{md[h].nv(Qa,
ec,ac,zc,Yc);if(we.TellMeActor.instance.sc){const Ec={};Ec[d.a.provider]=md[h].Px();Ec[d.a.jPa]=Qa.Sya;we.TellMeActor.instance.sc.sN(f.a.nv,window.performance.now()-Ib,Ec)}},0):(md[h].nv(Qa,ec,ac,zc,Yc),we.TellMeActor.instance.sc&&(sd={},sd[d.a.provider]=md[h].Px(),sd[d.a.jPa]=Qa.Sya,we.TellMeActor.instance.sc.sN(f.a.nv,window.performance.now()-Ib,sd)))}xb.EOj()}Px(){return"Aggregator"}eF(){return 0}nv(Qa,xb,ac=!1,zc=b.a.tellMe,Yc=null){if(we.TellMeActor.instance.eAi)this.xhf(Qa,xb,ac,zc,Yc);else{const md=
window.performance.now();we.TellMeActor.instance.DWj.then(()=>{we.TellMeActor.instance.sc&&we.TellMeActor.instance.sc.sN(f.a.fAi,window.performance.now()-md);this.xhf(Qa,xb,ac,zc,Yc);return!0})}}Ju(Qa,xb){this.uWa[xb].push(Qa)}dBg(Qa){switch(Qa){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const xb=this.uWa[b.a.tellMe];for(const ac of xb)if("FindInDocument"===ac.Px()){ac.Pqj(Qa);break}}}static createInstance(Qa,xb,ac,zc){const Yc=zc&&vc.a.ZPd(xb);var md=
Yc&&xb.fBd;const sd=xb.Ypd&&!vc.a.jMa(),h=xb.god,Ib=new mg(Yc);if(xb.xxj){var ec=new Hd(xb);Ib.Ju(ec,b.a.tellMe)}ec=xb.Ji?ed.AFrameworkApplication.fa.qa("TellMeIsSuggestionsForSimplifiedUxEnabled"):ed.AFrameworkApplication.fa.qa("TellMeSuggestionsIsEnabled");const Ec=!ec&&ed.AFrameworkApplication.fa.qa("TellMeFirstRunExperienceIsEnabled");Ib.Ju(new la(Qa,xb.qNj,Ec,!1),b.a.tellMe);ec&&Ib.Ju(new Ee(new zf,xb,Qa),b.a.tellMe);Qa=ed.AFrameworkApplication.ta.Oa.Jgf?new me(xb,new Re):new Id(xb,ac);Ib.Ju(Qa,
b.a.contextMenu);(Yc&&xb.gBd||md)&&Ib.Ju(Af.a.YDe(xb,!0),b.a.tellMe);Ib.Ju(Qa,b.a.tellMe);!xb.Ozh||"Word"===xb.application&&xb.QRe||Ib.Ju(new Eb(xb),b.a.tellMe);xb.KFa&&(md=new v(xb),Ib.Ju(md,b.a.tellMe),Ib.Ju(md,b.a.contextMenu));!xb.XYa||xb.VKb||xb.UKb||Ib.Ju(new n.a(xb),b.a.tellMe);zc&&(xb.Mva||vc.a.x4())&&(md=new Mc(xb),Ib.Ju(md,b.a.tellMe),Ib.Ju(md,b.a.contextMenu));Yc&&Ib.Ju(Af.a.YDe(xb,!1),b.a.tellMe);zc&&!xb.xTd&&vc.a.YPd(xb)&&(Ib.Ju(new Ad.a(xb),b.a.tellMe),xb.XFj&&Ib.Ju(new Ad.a(xb),b.a.contextMenu));
sd&&Ib.Ju(new jb(xb),b.a.tellMe);(xb.Vcb||xb.yy)&&Ib.Ju(new fc.a(xb),b.a.tellMe);xb.Lzb&&Ib.Ju(new Mf.a(xb),b.a.tellMe);zc&&xb.cec&&Ib.Ju(new e.AddinResultsProvider(xb),b.a.tellMe);h&&"Excel"===xb.application&&Ib.Ju(new qf(xb),b.a.tellMe);return Ib}}Object(c.a)(mg,"AggregatorResultsProvider",null,[645])},1196:function(t,C,a){t=a(0);var c=a(703),b=a(886),d=a(771),f=a(726),e=a(798);class k{constructor(D,J){this.DimensionValue=this.DimensionName=null;this.DimensionName=D;this.DimensionValue=J}}Object(t.a)(k,
"Dimension",null,[]);class l{constructor(D,J,M,G,T){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=D;this.Query=J;this.From=M;this.Size=G;T&&(this.Filter=T)}}Object(t.a)(l,"EntityRequest",null,[]);class m{constructor(D){this.QueryString=null;this.QueryString=D}}Object(t.a)(m,"Query",null,[]);var v=a(706);class n{constructor(D,J){this.Dimensions=this.Name=null;this.Name=D;this.Dimensions=J}}Object(t.a)(n,"Scenario",null,[]);var w=a(708),r=a(707);class u{constructor(D,
J,M,G){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=D;this.TimeZone=J;this.Cvid=M;this.Scenario=G}}Object(t.a)(u,"SubstrateBody",null,[]);var y=a(797),x=a(699),B=a(698),z=a(4),A=a(1001),I=a(1E3),F=a(910),U=a(41),X=a(30),S=a(172);a.d(C,"a",function(){return H});class H{constructor(D){this.Fjb=this.Cqa=this.yTb=this.Fhb=this.Vjb=0;this.Rae=this.tce=this.Hy=null;this.tDa=0;this.xG=-1;this.elb="";this.wh=z.AFrameworkApplication.vd;this.Ua=D;this.QVb=this.Cfd();this.fPc=
new b.a;this.O$d=this.Ua.hWd?3:2;this.bhe=this.Ua.hWd&&this.Ua.b3f?5:3;this.Bie=this.Ua.kwc?2:3;this.Cie=1;this.kTb=this.Ua.o_e;this.Zfe=this.Ua.Uli;this.vkb=D.E1e;z.AFrameworkApplication.fa&&(this.tce=z.AFrameworkApplication.fa.Va("AppCatalogUrl")+z.AFrameworkApplication.fa.Va("SearchPersonaPhotoBaseUrl"))}Px(){return"Substrate"}eF(){return 0===this.Ua.Ll?0:1===this.Ua.Ll?1:3}nv(D,J,M,G=c.a.tellMe,T=null){const K=new r.a(D);if(!T||Array.contains(T,14)||Array.contains(T,15)||Array.contains(T,20))if(!this.tDa||
window.performance.now()-this.tDa>=B.a.G9f)if(M=this.fPc.U1e())this.tDa=window.performance.now(),M.then(L=>{L&&""!==L?(this.elb=L,""!==this.Hy&&this.T1e(D,G,this.elb,J,T)):(x.TellMeActor.instance.sc.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),J.resultsUpdated(K))},L=>{x.TellMeActor.instance.sc.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+L);J.resultsUpdated(K)});else{if(x.TellMeActor.instance.sc)x.TellMeActor.instance.sc.onError("SubstrateResultsProvider:IssueQuery",
"undefined token promise");J.resultsUpdated(K)}else this.elb&&""!==this.elb?this.T1e(D,G,this.elb,J,T):(J.resultsUpdated(K),x.TellMeActor.instance.sc.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else J.resultsUpdated(K)}vza(){this.Cqa=this.Fjb=this.yTb=this.Fhb=this.Vjb=0}T1e(D,J,M,G,T){this.vza();const K=new r.a(D),L=this.Hy=S.a.create().toString();this.m2();this.xG=window.setTimeout(()=>{if(L===this.Hy){this.Hy="";this.xG=-1;G.resultsUpdated(K);const da={};da[d.a.provider]=
this.Px();da[d.a.jPa]=D.Sya;x.TellMeActor.instance.sc.sN(f.a.timedOut,this.vkb,da)}},this.vkb);const V={"Content-Type":"application/json",Accept:"application/json"};V.Authorization="Bearer "+M;V["X-Office-Version"]=z.AFrameworkApplication.buildVersion;V["X-Office-Application"]=z.AFrameworkApplication.fa.Va("Application");V["X-Office-Platform"]="WAC";V["X-TellMe-SessionId"]=x.TellMeActor.instance.Xac();V["X-TellMe-Culture"]=z.AFrameworkApplication.uiCulture;V["X-TellMe-ProcessSessionId"]=z.AFrameworkApplication.userSessionId;
V["Client-Request-Id"]=L;const W=window.performance.now();this.wh.Bm(this.qXh(),2,this.rXh(D.Hd,this.Ua.application,x.TellMeActor.instance.Xac(),B.a.cD(D)),V,!1,0,da=>{this.qOa(da,D,G,L,W,J,T)},da=>{this.dOa(da,D,G,L,W)},null,null,!1,4E3,6E3)}m2(){-1!==this.xG&&(window.clearTimeout(this.xG),this.xG=-1)}qOa(D,J,M,G,T,K,L){x.TellMeActor.instance.sc.c_(J.Hd.length,this.QVb.join(","),D.data.httpStatus.toString(),Math.round(window.performance.now()-T),y.a.substrate,!0,e.a.Caa);const V=B.a.cD(J),W=new r.a(J);
if(G===this.Hy){this.m2();D=U.b(D.data.Vd);if(D.Groups){D=D.Groups;for(const da of D)"People"===da.Type&&this.Ua.wMb&&(L?Array.contains(L,14):1)?(D=this.K_e(da.Suggestions,V,K),0<D.results.length&&W.Cm(D)):"File"===da.Type&&this.Ua.vMb&&(L?Array.contains(L,15):1)?(D=this.NXe(da.Suggestions,V,K),0<D.results.length&&W.Cm(D)):"Notes"===da.Type&&this.Ua.Nwa&&K!==c.a.contextMenu&&(L?Array.contains(L,20):1)&&(D=this.k_e(da.Suggestions,V,J),0<D.results.length&&W.Cm(D))}M.resultsUpdated(W);x.TellMeActor.instance.sc.c_(J.Hd.length,
this.QVb.join(","),"",Math.round(window.performance.now()-T),"",!0,e.a.provider)}else M.resultsUpdated(W)}k_e(D,J,M){const G=new w.a(20);G.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const T of D)this.yni(T)&&(D=T.NotesType,D=X.a.ll(D),D=this.WRh(D,T.LastModifiedTime,T.BodyPreview,T.Subject,J,M,T))&&(D.groupType=20,G.Fn(D));return G}K_e(D,J,M){const G=new w.a(14);G.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const K of D)if(this.zni(K)){var T=K.Id.split("@")[0];D=K.EmailAddresses[0];
let L=K.Type;if(void 0===L||null===L)L="User";if(T=this.QSh(L,K.DisplayName,K.JobTitle,D,T,M,J))T.description=D,D=K.JobTitle,"Department"in K&&"CompanyName"in K&&(D+="@"+K.Department+"@"+K.CompanyName),T.QYb=D,G.Fn(T)}return G}NXe(D,J,M){const G=new w.a(15);G.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const L of D)if(this.sni(L)){var T=L.FileName;D=L.FileExtension;const V=T.length>D.length?T.substr(0,T.length-D.length-1):L.Title;var K=void 0;D=0;"DateCreated"in L?(D=B.a.Lfd(L.DateCreated),
K=B.a.m2e(L.DateCreated),K=String.format(CommonUIStrings.l_CreatedTimeFormatString,L.Author,K)):K=L.Author;const W=L.AccessUrl+"?web=1",da=X.a.$Y(W);T=String.format('<a href="{0}">{1}</a>',da,X.a.Eg(T));if(M!==c.a.contextMenu||X.a.swa(W))if(T=this.eNh(V,M===c.a.contextMenu?T:W,K,L.FileExtension,L.Text,J))T.description=L.Author,T.ZYb=D,G.Fn(T)}return G}dOa(D,J,M,G,T){G===this.Hy&&(this.m2(),x.TellMeActor.instance.sc.c_(J.Hd.length,this.QVb.join(","),D.data.httpStatus.toString(),Math.round(window.performance.now()-
T),y.a.substrate,!1,e.a.Caa));D=new r.a(J);M.resultsUpdated(D)}QSh(D,J,M,G,T,K,L){L=L?this.Cie:this.O$d;if(!window.LPC&&!B.a.jmd()||this.Vjb===L)return null;this.Vjb+=1;L="PeopleSuggestion"+this.Vjb.toString();var V=this.tce+"?size=1&accountName="+G;D=Object.assign(new A.a,{PersonaType:D,Smtp:G,ProfilePictureUrl:V,AadObjectId:T});const W=Object.assign(new I.a,{identifiers:D,displayName:J});D=K===c.a.contextMenu;this.Ua.I3?(x.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(L,
W,J,M)),K===c.a.contextMenu&&(M=B.a.MDe(J,G,T),x.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(L,M))),x.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(L,D))):(V=[],V.push(appChrome.actions.setPersonaButtonCoauthor(L,W,J,M)),K===c.a.contextMenu&&(M=B.a.MDe(J,G,T),V.push(appChrome.actions.setButtonCommandValueId(L,M))),V.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(L,D)),appChrome.api.dispatch(V));return new v.a(L,
11,J,G,0)}WRh(D,J,M,G,T,K,L){if(T&&!this.Ua.Ngf||this.yTb===this.kTb||this.Fjb===this.kTb||this.Cqa===this.kTb)return null;var V=null;this.yTb+=1;T="";const W=[],da={};L.type="Notes";this.Rae=Object.assign(new F.a,{landingTab:"Notes",data:L});K=B.a.Ksa(K.Hd,33,this.Rae);if("onenotepagepreviews"===D){if(!("ClickthroughUrl"in L&&L.ClickthroughUrl)||""===L.ClickthroughUrl)return null;this.Fjb+=1;T="OnenoteNotesSuggestion"+this.Fjb.toString();da["default"]="SaveAsonetoc2_20";V=L.ClickthroughUrl;W.push(appChrome.actions.setControlIconSet(T,
da));W.push(appChrome.actions.setCompoundButtonCommandValueId(T,V));V=new v.a(T,19,null,null,0)}else if("stickynote"===D){if(!this.Zfe)return null;this.Cqa+=1;T="NotesSuggestion"+this.Cqa.toString();da["default"]="ShowAllNotes_20";W.push(appChrome.actions.setControlIconSet(T,da));W.push(appChrome.actions.setCompoundButtonCommandValueId(T,K));V=new v.a(T,21,null,null,0)}else if("samsung"===D){if(!this.Zfe)return null;this.Cqa+=1;T="NotesSuggestion"+this.Cqa.toString();da["default"]="CategoryCollapsed_20";
W.push(appChrome.actions.setControlIconSet(T,da));W.push(appChrome.actions.setCompoundButtonCommandValueId(T,K));V=new v.a(T,20,null,null,0)}""!==T&&(D=B.a.m2e(J),D=String.format(CommonUIStrings.l_LastModifiedString,D),V.label=G,V.ZYb=B.a.Lfd(J),W.push(appChrome.actions.setControlLabel(T,G)),W.push(appChrome.actions.updateCompoundButtonDescription(T,D)),W.push(appChrome.actions.setControlCustomTooltip(T,M)),appChrome.api.dispatch(W));return V}eNh(D,J,M,G,T,K){if(this.Fhb===(K?this.Bie:this.bhe))return null;
this.Fhb+=1;K="FileSuggestion"+this.Fhb.toString();const L=[],V={};V["default"]=B.a.ePh(G);this.Ua.I3?(x.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(K,D)),x.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(K,V)),x.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(K,M)),x.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(K,J)),x.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(K,
T))):(L.push(appChrome.actions.setControlLabel(K,D)),L.push(appChrome.actions.setControlIconSet(K,V)),L.push(appChrome.actions.updateCompoundButtonDescription(K,M)),L.push(appChrome.actions.setCompoundButtonCommandValueId(K,J)),L.push(appChrome.actions.setControlCustomTooltip(K,T)),appChrome.api.dispatch(L));return new v.a(K,6,D,M,0)}Cfd(){const D=[];this.Ua.wMb&&Array.add(D,"People");this.Ua.vMb&&Array.add(D,"File");this.Ua.Nwa&&Array.add(D,"Notes");return D}rXh(D,J,M,G){var T=new m(D);D=new l("File",
T,0,G?this.Bie:this.bhe,null);G=new l("People",T,0,G?this.Cie:this.O$d,B.a.MWi);T=new l("Notes",T,0,this.kTb,null);J=new k("app",J.toLowerCase());var K=[];Array.add(K,J);J=new n("tellmesearch",K);K=[];this.Ua.vMb&&Array.add(K,D);this.Ua.wMb&&Array.add(K,G);this.Ua.Nwa&&Array.add(K,T);M=new u(K,"UTC",M,J);return U.c(M)}qXh(){let D=this.Ua.YFj;this.Ua.Nwa&&(D+="?&setflight=NotesFrom3S");""!==this.Ua.V1e&&(D=D+"&"+this.Ua.V1e);return D}zni(D){return"DisplayName"in D&&"Id"in D&&"EmailAddresses"in D&&
!!D.Id&&!!D.EmailAddresses}sni(D){return"FileExtension"in D&&!!D.FileExtension&&"FileName"in D&&!!D.FileName&&""!==D.FileName&&"AccessUrl"in D&&!!D.AccessUrl&&""!==D.AccessUrl}yni(D){return"Id"in D&&!!D.Id&&"NotesType"in D&&!!D.NotesType&&"Subject"in D&&!!D.Subject&&""!==D.Subject}}Object(t.a)(H,"SubstrateResultsProvider",null,[645])},1272:function(t,C,a){t=a(0);var c=a(185),b=a(703),d=a(886),f=a(771),e=a(726),k=a(798),l=a(706),m=a(708),v=a(707),n=a(699),w=a(698);class r{constructor(H){this.Ua=H;
this.QVb=this.Cfd()}Px(){return"Add-ins"}eF(){return 0===this.Ua.Ll?0:1===this.Ua.Ll?1:3}nv(H,D){H=new v.a(H);D.resultsUpdated(H)}nva(H,D,J){let M;M=this.Ua.yy?new m.a(26):new m.a(24);M.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;J&&this.cBj(H.Hd,D,M)}cBj(H,D,J){const M=[];let G;G=this.Ua.odi?this.Ua.yy&&this.Ua.Cra?w.a.xua(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,H)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,H):this.Ua.pdi?this.Ua.yy&&
this.Ua.Cra?w.a.xua(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,H)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,H):this.Ua.yy&&this.Ua.Cra?w.a.xua(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,H)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,H);this.Ua.I3?(n.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",G)),n.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",
H))):(M.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",G)),M.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",H)),appChrome.api.dispatch(M));J.Fn(new l.a("LaunchAddinDialogFromTellMe",27));D.Cm(J)}Cfd(){const H=[];this.Ua.cec&&Array.add(H,"Addin");return H}}Object(t.a)(r,"AddinStoreResultsProvider",null,[645]);var u=a(1095),y=a(753),x=a(772),B=a(1096),z=a(1196),A=a(1097),I=a(797),F=a(4),U=a(41),X=a(172);a.d(C,"a",function(){return S});class S{constructor(H,
D,J){this.Skb=this.vVb=this.wVb=this.uVb=!1;this.Hy=null;this.xG=-1;this.BEa=this.dlb=null;this.klb="";this.tDa=0;this.Ua=H;const M=w.a.x4();this.npa=D||[];this.wh=F.AFrameworkApplication.vd;this.Jfe=H.gBd;this.xVb=H.fBd;this.LPc=M&&this.Scb();this.NPc=M&&this.Tcb();this.xvg=M&&this.Ucb();this.PPc=this.Xcb();this.Kfe=this.Vcb();H.xTd&&w.a.YPd(H)&&(this.dlb=new z.a(H),this.uVb=H.vMb,this.wVb=H.wMb,this.vVb=H.Nwa,this.Skb=this.uVb&&this.Cq("File")||this.wVb&&this.Cq("People")||this.vVb&&this.Cq("Notes"));
this.tVb=this.jxj();this.BVb=H.QEb;this.OPc=this.Dxj();this.Ife=this.ixj();this.k1d=this.WXh();this.Z0d=new u.a(H);this.Qpg=new B.a(H);this.Twg=new A.a(H);this.ekg=new r(H);this.vkb=J;this.fPc=new d.a;this.BVb&&(this.Z0d=new u.a(H))}Cq(H){return Array.contains(this.npa,H)?!0:!1}Px(){return"TellMeService"}eF(){return 0===this.Ua.Ll?0:1===this.Ua.Ll?1:this.Cq("Command")||this.Cq("Recommended")?2:3}SXh(H){let D="";if(!H&&this.Cq("Command")&&this.Ua.Xnd){D+="CommandSearch_DLIS,";var J=this.Ua.m8f;0<J.length&&
(D+=J+",")}H&&this.Cq("Recommended")&&this.xVb&&(J=this.Ua.n8f,0<J.length&&(D+=J+","));!H&&this.Cq("Help")&&(H=this.Ua.l8f,0<H.length&&(D+=H+","));0<D.length&&(D=D.substr(0,D.length-1));return D}nv(H,D,J,M=b.a.tellMe,G=null){const T=new v.a(H);J=w.a.cD(H);if(this.Skb&&(!this.tDa||window.performance.now()-this.tDa>=w.a.G9f)){var K=this.fPc.XXh();if(K)this.tDa=window.performance.now(),K.then(da=>{this.klb=da},da=>{n.TellMeActor.instance.sc.onError("TellMeServiceProvider:issueQuery","tellMeServiceToken promise rejected: "+
da)});else if(n.TellMeActor.instance.sc)n.TellMeActor.instance.sc.onError("TellMeServiceProvider:IssueQuery","undefined token promise")}var L=this.Skb&&!!this.klb;K=L||J&&this.Cq("Recommended")&&this.xVb;L=L||!J&&(this.Jfe&&this.Cq("Command")||this.LPc&&this.Cq("Answer")||this.NPc&&this.Cq("Definition")||this.Kfe&&this.Cq("Image")||this.BVb&&this.Cq("Help")||this.PPc&&this.Cq("WolframAnswer")||this.OPc&&this.Cq("Template")||this.Ife&&this.Cq("Addin"));if(K||L)if(this.BEa=M,M={"Content-Type":"application/json",
Accept:"application/json"},M["X-Office-Version"]=F.AFrameworkApplication.buildVersion,M["X-Office-Application"]=F.AFrameworkApplication.fa.Va("Application"),M["X-Office-Platform"]="WAC",M["X-TellMe-SqmUserId"]=F.AFrameworkApplication.fa.Va("LoggableUserId")||"",M["X-TellMe-SessionId"]=n.TellMeActor.instance.Xac(),this.klb&&(M.Authorization="Bearer "+this.klb),K=this.SXh(J),0<K.length&&(M["X-TellMe-Flights"]=K),K=[],!J&&this.Cq("Answer")&&this.LPc&&(G?Array.contains(G,9):1)&&Array.add(K,"Answer"),
!J&&this.Cq("Command")&&this.Jfe&&!y.CommandResultsUtility.Vld(H.Hd)&&(G?Array.contains(G,17):1)&&Array.add(K,"Command"),!J&&this.Cq("Definition")&&this.NPc&&(G?Array.contains(G,10):1)&&Array.add(K,"Definition"),!J&&this.Cq("Help")&&this.BVb&&(G?Array.contains(G,8):1)&&Array.add(K,"Help"),!J&&this.Cq("WolframAnswer")&&this.PPc&&(G?Array.contains(G,12):1)&&Array.add(K,"WolframAnswer"),J&&this.Cq("Recommended")&&this.xVb&&!n.TellMeActor.instance.dOb&&(G?Array.contains(G,18):1)&&Array.add(K,"Recommended"),
!J&&this.Cq("Image")&&this.Kfe&&(G?Array.contains(G,19):1)&&Array.add(K,"Image"),this.klb&&this.Skb&&(G?Array.contains(G,14)||Array.contains(G,15)||Array.contains(G,20):1)&&(this.dlb.vza(),this.uVb&&this.Cq("File")&&Array.add(K,"File"),this.wVb&&this.Cq("People")&&Array.add(K,"People"),this.vVb&&this.Cq("Notes")&&Array.add(K,"Notes")),!J&&this.Cq("Template")&&this.OPc&&(G?Array.contains(G,23):1)&&Array.add(K,"Template"),!J&&this.Cq("Addin")&&this.Ife&&(G?Array.contains(G,24):1)&&Array.add(K,"Addin"),
K.length){M["X-TellMe-SuggestionTypes"]=K.join(",");M["X-TellMe-Culture"]=F.AFrameworkApplication.uiCulture;M["X-TellMe-ProcessSessionId"]=F.AFrameworkApplication.userSessionId;var V=this.Hy=X.a.create().toString();M["Client-Request-Id"]=V;var W=window.performance.now();this.m2();this.xG=window.setTimeout(()=>{if(V===this.Hy){this.Hy="";this.xG=-1;D.resultsUpdated(T);const da={};da[f.a.provider]=this.Px();da[f.a.jPa]=H.Sya;n.TellMeActor.instance.sc.sN(e.a.timedOut,this.vkb,da)}},this.vkb);this.wh.Bm(this.k1d,
2,this.VXh(H.Hd),M,!1,0,da=>{this.qOa(da,H,D,V,W,G)},da=>{this.dOa(da,H,D,V,W)},null,null,!1,4E3,6E3)}else n.TellMeActor.instance.sc.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),D.resultsUpdated(T);else D.resultsUpdated(T)}m2(){-1!==this.xG&&(window.clearTimeout(this.xG),this.xG=-1)}qOa(H,D,J,M,G,T){const K=new v.a(D);if(M===this.Hy){this.m2();n.TellMeActor.instance.sc.c_(D.Hd.length,this.npa.join(","),H.data.httpStatus.toString(),Math.round(window.performance.now()-
G),I.a.tellMe,!0,k.a.Caa);M=H.data.Vd;H=null;try{H=U.b(M)}catch(O){n.TellMeActor.instance.sc.onError("OnSuccessCallBack","Exception occured while deserializing response:"+O);return}M=w.a.cD(D);if("Groups"in H&&H.Groups){var L=H.Groups;for(var V of L)if("GroupType"in V&&"Suggestions"in V&&V.Suggestions)if("Commands"===V.GroupType&&(T?Array.contains(T,17):1)||"Recommended"===V.GroupType&&(T?Array.contains(T,18):1)){var W=(L="Recommended"===V.GroupType)?"DLIS":"NaiveBayes";"Source"in V&&V.Source&&(W=
V.Source);var da=V.Suggestions;new c.a;var qa=[];for(const O of da)this.qni(O)&&(da=O.Type,("Command"===da||L&&"Recommended"===da)&&qa.push(new x.a(O.CommandId,O.Score)));y.CommandResultsUtility.Sic(qa,!D.Hd.trim().length,V.GroupType,W);W=n.TellMeActor.instance.FG;da=[];for(const O of qa)L&&W&&W.j1c(O.commandId)||da.push(O);qa=y.CommandResultsUtility.Cac(D,da,this.Ua,null,null,null,L?18:17,0);0<qa.results.length&&(this.BEa!==b.a.contextMenu&&(qa.displayName=L?CommonUIStrings.l_TellMeTryCommandTitle:
CommonUIStrings.l_TellMeCommandProviderTitle),K.Cm(qa))}else if("Answer"===V.GroupType){da=V.Suggestions;L=null;qa=2147483647;W="";for(const O of da)if(this.oni(O))if(W=O.Type,da=this.uvb(W),"Answer"===W&&this.LPc){L=this.FDe(W,O,D.Hd);break}else da&&da<qa&&(qa=da,L=this.FDe(W,O,D.Hd));qa=w.a.Pgj(D.Hd,W);L&&(T?Array.contains(T,L.type):1)&&(W=[],this.tVb?this.Ua.I3?(n.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(L.value,L.Kz)),n.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(L.value,
L.description)),n.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(L.value,qa))):(W.push(appChrome.actions.setControlLabel(L.value,L.Kz)),W.push(appChrome.actions.updateCompoundButtonDescription(L.value,L.description)),W.push(appChrome.actions.setCompoundButtonCommandValueId(L.value,qa)),appChrome.api.dispatch(W)):this.Ua.I3?(n.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(L.value,L.Kz+" - "+L.description)),n.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(L.value,
qa))):(W.push(appChrome.actions.setControlLabel(L.value,L.Kz+" - "+L.description)),W.push(appChrome.actions.setButtonCommandValueId(L.value,qa)),appChrome.api.dispatch(W)),qa=this.z9g(L.type),qa.Fn(L),K.Cm(qa))}else"Help"===V.GroupType&&V.Suggestions.length&&(T?Array.contains(T,8):1)?this.BVb&&(L=this.Z0d.nva(D,V.Suggestions))&&0<L.results.length&&K.Cm(L):"Template"===V.GroupType&&(T?Array.contains(T,23):1)?(L=V.Suggestions)&&0<L.length&&this.Twg.nva(D,K,L):"Addin"===V.GroupType&&(T?Array.contains(T,
24):1)?(L=V.Suggestions)&&0<L.length&&this.ekg.nva(D,K,L):"Substrate"===V.GroupType&&this.Skb&&"Type"in V&&("File"===V.Type&&this.uVb&&(T?Array.contains(T,15):1)?(L=this.dlb.NXe(V.Suggestions,M,this.BEa))&&0<L.results.length&&K.Cm(L):"People"===V.Type&&this.wVb&&(T?Array.contains(T,14):1)?(L=this.dlb.K_e(V.Suggestions,M,this.BEa))&&0<L.results.length&&K.Cm(L):"Notes"===V.Type&&this.vVb&&(T?Array.contains(T,14):1)&&(L=this.dlb.k_e(V.Suggestions,M,D))&&0<L.results.length&&K.Cm(L));else n.TellMeActor.instance.sc.onError("OnSuccessCallBack",
"GroupType"in V?"Invalid group suggestions found for "+V.GroupType:"Invalid group found")}if(H.Intents){V=H.Intents;for(const O of V)this.lqd(O)&&("Image"===O.GroupType&&O.ConfidenceScore>O.ConfidenceThreshold&&(T?Array.contains(T,19):1)?this.Qpg.nva(D,K,0,O):"Commands"===O.GroupType&&O.ConfidenceScore<O.ConfidenceThreshold&&(T?Array.contains(T,17):1)&&(V=new m.a(17),K.Cm(V)))}J.resultsUpdated(K);n.TellMeActor.instance.sc.c_(D.Hd.length,this.npa.join(","),"",Math.round(window.performance.now()-G),
"",!0,k.a.provider)}}dOa(H,D,J,M,G){const T=new v.a(D);M===this.Hy&&(this.m2(),n.TellMeActor.instance.sc.c_(D.Hd.length,this.npa.join(","),H.data.httpStatus.toString(),Math.round(window.performance.now()-G),I.a.tellMe,!1,k.a.Caa));J.resultsUpdated(T)}uvb(H){switch(H){case "Entity":return this.xvg?3:0;case "Definition":return this.NPc?5:0;case "WolframAnswer":return this.PPc?2:0;default:return 0}}FDe(H,D,J){switch(H){case "Answer":return new l.a(this.tVb?"AnswerForSearch":"AnswerForSearchSingleLine",
0,""===D.Title?J:D.Title,D.Description,0);case "Entity":return new l.a(this.tVb?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===D.Title?J:D.Title,D.Description,0);case "Definition":return new l.a(this.tVb?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===D.Title?J:D.Title,D.Description,0);case "WolframAnswer":return new l.a("WolframForSearch",3,""===D.Title?J:D.Title,D.Description,0);default:return null}}z9g(H){switch(H){case 0:return new m.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new m.a(11,
CommonUIStrings.l_TellMeEntityTitle);case 1:return new m.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new m.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new m.a(19,this.Ua.Ocb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}oni(H){return"Type"in H&&!!H.Type&&""!==H.Type&&"Description"in H&&!!H.Description&&""!==H.Description}qni(H){return"Type"in H&&!!H.Type&&""!==H.Type&&"CommandId"in H&&!!H.CommandId&&""!==H.CommandId&&"Score"in
H&&!!H.Score}lqd(H){if("GroupType"in H&&H.GroupType&&"ConfidenceScore"in H&&"ConfidenceThreshold"in H)return!0;n.TellMeActor.instance.sc.onError("IsValidIntentGroup","Invalid intents found");return!1}VXh(H){const D=w.a.tgf(H),J={};J.Query=H;D&&this.xVb&&(J.CommandClickedEvents=n.TellMeActor.instance.kFc,J.CommandActionEvents=n.TellMeActor.instance.J2d,J.TellMeCommandClickMruEvents=n.TellMeActor.instance.sae,J.ContentType=n.TellMeActor.instance.c4b);this.OPc&&(H={},H.Application=this.Ua.application,
J.TemplateInfo=H);return U.c(J)}Scb(){return!!this.Ua&&this.Ua.Scb||!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Oa.Scb}Tcb(){return!!this.Ua&&this.Ua.Tcb||!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Oa.Tcb}Ucb(){return!!this.Ua&&this.Ua.Ucb||!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Oa.Ucb}Xcb(){return!!this.Ua&&this.Ua.Xcb||!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Oa.Xcb}Vcb(){return!!this.Ua&&(this.Ua.Vcb||this.Ua.yy)}jxj(){return!!this.Ua&&
!this.Ua.Mwa}Dxj(){return!!this.Ua&&this.Ua.Lzb}ixj(){return!!this.Ua&&this.Ua.qdi&&this.Ua.ndi}Lgf(){return!!F.AFrameworkApplication.fa&&F.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}Mgf(){return!!F.AFrameworkApplication.fa&&F.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}WXh(){if(!F.AFrameworkApplication.fa)return"";if(this.Mgf())return F.AFrameworkApplication.fa.Va("TellMeServiceProdEndpointForSearch");
if(this.Lgf())return F.AFrameworkApplication.fa.Va("TellMeServiceEdogEndpointForSearch");if(w.a.jmd())return F.AFrameworkApplication.fa.Va("TellMeServiceIntEndpointForSearch");let H=F.AFrameworkApplication.fa.Va("TellMeServiceSearchEndpoint");H&&""!==H||(H=F.AFrameworkApplication.k8f);return H}static YDe(H,D){if(D)return new S(H,["Command","Recommended"],H.XMh);D=w.a.x4()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin".split(" "):"Help WolframAnswer File People Notes Template Addin".split(" ");
return new S(H,D,H.E1e)}}Object(t.a)(S,"TellMeServiceProvider",null,[645])},1281:function(t,C,a){t=a(0);var c=a(15),b=a(784),d=a(222),f=a(13),e=a(108),k=a(4),l=a(85),m=a(259),v=a(235),n=a(137),w=a(19),r=a(5),u=a(258),y=a(245),x=a(12),B=a(14),z=a(700);class A{}A.i0g="CondtionalFormattingPane";A.k0g="CondtionalFormattingPaneHeader";A.j0g="CondtionalFormattingPaneBody";A.l0g="CondtionalFormattingPaneTitle";A.h0g="CondtionalFormattingCloseButton";Object(t.a)(A,"CssClassNames",null,[]);a.d(C,"a",function(){return H});
const I=A.i0g,F=A.k0g,U=A.j0g,X=r.a.zyc+A.l0g,S=r.a.Idb+A.h0g;class H extends v.a{constructor(D,J,M){super(D);this.oye=this.he=null;this.su=0;this.Cp=!1;this.Ec=(G,T)=>{T.fg||this.ig(!1)};this.Pmc=()=>{this.uZc();return!1};this.$j=()=>{this.raiseEvent("CFTPCR");return!1};this.$=J;this.taskPaneManager=M;u.a(J).Xh(this);this.J4g();this.$.kk(this.Ec)}dP(D){this.get_events().addHandler("CFTPR",D)}qR(D){this.get_events().removeHandler("CFTPR",D)}aM(D){this.addHandler("CFTPC",D)}RN(D){this.removeHandler("CFTPC",
D)}fUc(D){this.addHandler("CFTPCO",D)}DId(D){this.removeHandler("CFTPCO",D)}gUc(D){this.addHandler("CFTPE",D)}EId(D){this.removeHandler("CFTPE",D)}VFg(D){this.addHandler("CFTPCR",D)}Kbj(D){this.removeHandler("CFTPCR",D)}get isVisible(){return super.isVisible}set isVisible(D){super.isVisible!==D&&((super.isVisible=D)?this.raiseEvent("CFTPE"):this.raiseEvent("CFTPCO"))}get kf(){return this.isVisible}get $d(){return y.a.f0g}get Yg(){return 9}get Tk(){return w.a.ZOe}get RM(){return B.a.instance.ga(1072)}get wo(){return 320}get isResizable(){return!1}get mc(){return this.domElement}get height(){return this.taskPaneManager.oO.offsetHeight}get titleText(){return B.a.instance.ga(1301)}BH(){}lp(){return this.Cp}Zr(){return this.Cp}dR(){}mQ(){return!1}lj(){}Nj(){}dispose(){this.$&&
this.$.zl(this.Ec);this.he&&(d.a.instance.Ba(f.a.click,this.he,this.$j),e.KeyInputManager.instance.Bv(this.he,this.oye));this.he=this.taskPaneManager=this.$=null;this.QOj();super.dispose()}hg(){this.XYf();this.uZc();return!0}kh(D){return x.DOMElementExtensions.vf(this.mc,D)}ig(D){this.Cp=D;const J=this.taskPaneManager;x.DOMElementExtensions.isVisible(J.mL);this.isVisible=D;this.taskPaneManager.Pw();D&&0<J.$z.length&&(!J.Bg||9!==J.Bg.taskPane.Yg||J.isCollapsed)&&J.VF(this,!0);this.$.qf()}pM(){var D=
this.$.Bb;const J=z.b("div","ConditionalFormattingPaneBodyId",U);D=document.getElementById(D+r.a.g2b);const M=this.ZG();D.appendChild(M);D.appendChild(J);return J}ZG(){const D=z.b("div","ConditionalFormattingPaneHeaderId",F),J=z.b("span","ConditionalFormattingPaneTitleId",X);J.innerText=this.titleText;J.setAttribute("aria-live","polite");J.setAttribute("role","heading");J.setAttribute("aria-level","2");J.setAttribute(n.a.ariaLabel,B.a.instance.ga(1302));this.he=b.a.pb("ConditionalFormattingPaneCloseButtonId",
S,B.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.he.classList.add(k.AFrameworkApplication.isRtl?r.a.V$:r.a.W$);d.a.instance.ra(f.a.click,this.he,this.$j);this.oye=e.KeyInputManager.instance.ms(this.he,this.$j,l.a.$h);D.appendChild(J);D.appendChild(this.he);return D}J4g(){this.$.frame.Ee.Sj("ConditionalFormattingPane");const D=this.$.frame.Ee.vi("ConditionalFormattingPane");D.parent=m.AFrame.hT;D.dN=!0;d.a.instance.fza(f.a.click,this.mc,this.Pmc,null,!0)}uZc(){this.$.frame.Ee.Rj("ConditionalFormattingPane")}Rpj(){this.$.frame.Ee.Rj(this.$.frame.Ee.RE||
m.AFrame.hT)}QOj(){d.a.instance.Uzc(f.a.click,this.mc,this.Pmc,!0)}OYg(){this.ig(!1);this.Rpj();this.raiseEvent("CFTPC")}XYf(){const D=document.getElementById(H.firstPaneElementId);D?D.focus():c.ULS.sendTraceTag(51663744,0,10,"ConditionalFormattingTaskPane.SetFocusOnPaneFirstElement: could not find element.")}setFocusOnToolbarFirstElement(){this.taskPaneManager.setFocusOnToolbarFirstElement()}static get firstPaneElementId(){return H.P6h}static get ruleManagerId(){return H.S6h}static get loadingRuleListId(){return H.Q6h}static get ruleListId(){return H.R6h}static ka(D,
J){var M=D.Bb;let G=document.getElementById(M+r.a.g2b);G||(G=document.createElement("div"),G.id=D.Bb+r.a.g2b,document.getElementById(M+r.a.WQ).appendChild(G));G.classList.add(I);M=D.da;return M.za(248)||M.Ga(248,new H(G,D,J))}}H.P6h=r.a.S0c;H.S6h=r.a.gAe;H.Q6h=r.a.g0g;H.R6h=r.a.fAe;Object(t.a)(H,"ConditionalFormattingTaskPane",v.a,[570,2,401,102])},1333:function(t,C,a){a.r(C);a.d(C,"SurfaceStringTokenStringGenerator",function(){return b});t=a(0);var c=a(841);class b extends c.a{constructor(d){super(d);
this.Da=d}apply(d,f,e,k,l,m,v){null==m&&(m=d.q2e(l,f));v=c.a.ule(d,m,this.Da.score,e,k,v);return{VMb:m,Dob:v}}}b.Eob=0;Object(t.a)(b,"SurfaceStringTokenStringGenerator",c.a,[])},1334:function(t,C,a){a.r(C);a.d(C,"QueryTokenStringGenerator",function(){return d});t=a(0);var c=a(841),b=a(694);class d extends c.a{constructor(f){super(f);this.Da=f}apply(f,e,k,l,m,v,n){e=this.Da.query.load(e,null);m=0;let w=null;this.Da.query.pI===b.Annotations.r0?e&&(w=this.Da.name):((w=this.Da.name)&&(w+="_"),w+=this.Da.annotations.AO(this.Da.query.pI,
e));null!=w&&(m=c.a.ule(f,w,this.Da.score,k,l,m));return{VMb:v,Dob:n+m}}}d.Eob=1;Object(t.a)(d,"QueryTokenStringGenerator",c.a,[])},1335:function(t,C,a){a.r(C);a.d(C,"FuzzyMatchTokenStringGenerator",function(){return b});t=a(0);var c=a(841);class b extends c.a{constructor(d){super(d);this.Da=d}apply(d,f,e,k,l,m,v){null==m&&(m=d.q2e(l,f));d=this.Da.XKe.ewi(m);if(this.Da.XDf)for(var n of d)if(!n.Fx&&n.J8b)return{VMb:m,Dob:v};n=0;for(const w of d)if(w.Fx&&!({VXc:n}=this.xqe(w,!0,e,k,n)).returnValue)return{VMb:m,
Dob:v};if(this.Da.Q8e)for(const w of d)if(!({VXc:n}=this.xqe(w,!1,e,k,n)).returnValue)break;return{VMb:m,Dob:v}}xqe(d,f,e,k,l){let m;f?(f=0,m=d.J8b?1:0):(f=d.J8b?1:0,m=d.count-f);for(let v=0;v<m;++v)if(c.a.vle(d.cua+f+v,this.Da.score,e,k),++l,0<this.Da.bvd&&l>=this.Da.bvd)return{returnValue:!1,VXc:l};return{returnValue:!0,VXc:l}}}b.Eob=2;Object(t.a)(b,"FuzzyMatchTokenStringGenerator",c.a,[])},1344:function(t,C,a){a.r(C);t=a(0);var c=a(740),b=a(185),d=a(328),f=a(84),e=a(708);class k{constructor(x,
B,z,A=0){this.O3e=x;this.groupType=B;this.Dgd=A;this.xIb=z}}Object(t.a)(k,"SortingGroup",null,[]);class l{constructor(x,B,z,A){this.order=x;this.oKa=B;this.A0h=z;this.groupType=A}}Object(t.a)(l,"SortingProp",null,[]);var m=a(699),v=a(703),n=a(698),w=a(692);class r{constructor(x,B){this.Knf={};this.Jnf={};this.Dnf=this.Unf=1;this.Jte(x,B)}VCj(x,B,z){var A=n.a.cD(z)?this.Knf:this.Jnf;z=new b.a;for(var I of B)B=Object(f.a)(l,A[c.a[I.groupType].toLowerCase()]),w.c(B)||z.add(new d.a(B,I));z.Sc((U,X)=>
U.key.order<X.key.order?-1:1);Array.clear(x);I=m.TellMeActor.instance.gE;for(B=0;B<z.count;){A=z.na(B).key.oKa;var F=z.na(B).value;const U=new e.a(z.na(B).key.groupType);w.c(I)||I.Location===v.a.contextMenu||(U.displayName=z.na(B).key.A0h);for(const X of F.results)U.Fn(X);for(F=++B;F<z.count&&z.na(F).key.oKa===A;)this.uTc(U,z.na(F).value),F=++B;x.push(U)}}iTj(x,B){this.Dnf=this.Unf=1;this.Jte(x,B)}Jte(x,B){this.E4f(x);for(var z=0;z<x.length;z++){let A=x[z];for(const I of A.xIb)this.HAg(I,z,A.O3e,
A.groupType)}this.E4f(B);for(x=0;x<B.length;x++){z=B[x];for(const A of z.xIb)this.GAg(A,x,z.O3e,z.groupType)}}E4f(x){x.sort((B,z)=>Object(f.a)(k,B).Dgd>Object(f.a)(k,z).Dgd?-1:1)}HAg(x,B,z,A){this.Knf[c.a[x].toLowerCase()]=new l(this.Unf++,B,z,A)}GAg(x,B,z,A){this.Jnf[c.a[x].toLowerCase()]=new l(this.Dnf++,B,z,A)}uTc(x,B){for(let z=0;z<B.results.length;z++)x.Fn(B.results[z])}}Object(t.a)(r,"BaseGroupingSorter",null,[]);class u{constructor(){this.Cjc=[new k(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,
4,[4,2]),new k(CommonUIStrings.l_TellMeCommandProviderTitle,7,[18,16,7]),new k(CommonUIStrings.l_TellMeSuggestionsProviderTitle,30,[15,14,19,3]),new k("",13,[13]),new k("",22,[22])];this.ujc=[new k(CommonUIStrings.l_TellMeCommandProviderTitle,28,[17,0,1,8,25]),new k(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,29,[2,19,23,26]),new k(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,30,[15,14,20,9,12,10,11,24]),new k("",13,[13]),new k("",22,[22])];this.gnf=new r(this.Cjc,this.ujc)}KLb(x,
B,z,A=null,I=null){let F=!1;if(A){for(const U of n.a.cD(z)?this.Cjc:this.ujc)this.U3i(U,A);F=!0}if(I){for(const U of n.a.cD(z)?this.Cjc:this.ujc)this.jTj(B,U,I);F=!0}F&&this.gnf.iTj(this.Cjc,this.ujc);this.gnf.VCj(x,B,z)}U3i(x,B){const z=new b.a;for(var A of x.xIb){const I=B[c.a[A].toLowerCase()];z.add(new d.a(w.c(I)?Number.MAX_VALUE:I,A))}if(z.count){z.Sc((I,F)=>I.key<F.key?-1:1);B=Array(z.count);for(A=0;A<z.count;A++)B[A]=z.na(A).value;x.xIb=B}}jTj(x,B,z){let A=0;for(const I of B.xIb)if(c.a[I].toLowerCase()in
z&&z[c.a[I].toLowerCase()])for(const F of x)if(F.groupType===I){A+=z[c.a[I].toLowerCase()];break}B.Dgd=A}}Object(t.a)(u,"SimplifiedGroupingSorter",null,[]);a.d(C,"GroupsPlacementInfo",function(){return y});class y{constructor(x){this.Inf={};this.Gnf={};this.Hnf={};this.Lnf={};this.rud={};this.Mnf=this.Rwi=this.Iwi=this.Kwi=1;this.Rnf=null;this.Hq=x;this.lRg();this.vYi();this.aRg();this.eQg();x.yy&&(this.Rnf=new u)}Lt(x){this.Inf[c.a[x].toLowerCase()]=this.Kwi++}Pv(x,B){this.Gnf[c.a[x].toLowerCase()]=
B}Q8(x){this.Hnf[c.a[x].toLowerCase()]=this.Iwi++}LG(x){this.Lnf[c.a[x].toLowerCase()]=this.Rwi++}ar(x){this.rud[c.a[x].toLowerCase()]=this.Mnf++}lRg(){const x=!!this.Hq&&this.Hq.Mwa,B=!!this.Hq&&this.Hq.QEb,z=!!this.Hq&&this.Hq.Nwa,A=!!this.Hq&&this.Hq.Ypd&&!n.a.jMa(),I=!!this.Hq&&this.Hq.Lzb,F=!!this.Hq&&this.Hq.cec,U=!!this.Hq&&this.Hq.god;this.Lt(4);this.Lt(18);this.Lt(16);this.Lt(7);this.Lt(17);this.Lt(0);this.Lt(1);U&&this.Lt(25);I&&this.Lt(23);x||this.Lt(2);x&&!B||this.Lt(8);this.Lt(15);z&&
this.Lt(20);this.Lt(14);this.Lt(9);this.Lt(12);this.Lt(10);this.Lt(11);x&&this.Lt(2);x&&!B&&this.Lt(8);this.Lt(19);F&&this.Lt(24);this.Lt(21);this.Lt(13);A&&this.Lt(22)}vYi(){this.Pv(21,1);this.Pv(4,3);this.Pv(18,3);this.Pv(16,3);this.Pv(7,3);this.Pv(17,5);this.Pv(0,5);this.Pv(1,1);this.Pv(25,2);this.Pv(2,1);this.Pv(8,2);this.Pv(15,3);this.Pv(14,2);this.Pv(24,3);this.Pv(9,1);this.Pv(12,1);this.Pv(10,1);this.Pv(11,1);this.Pv(19,1);this.Pv(23,1);this.Pv(13,1);this.Pv(20,2);this.Pv(22,1)}aRg(){this.Q8(4);
this.Q8(0);this.Q8(17);this.Q8(7);this.Q8(16);this.Q8(18);this.Q8(15);this.Q8(20);this.Q8(8);this.Q8(14)}eQg(){this.LG(14);this.LG(10);this.LG(12);this.LG(9);this.LG(11);this.LG(20);this.LG(15);this.LG(8);this.LG(2);this.LG(1);this.LG(24);this.LG(7);this.LG(18);this.LG(16);this.LG(17);this.LG(0);this.LG(4)}Dfj(){this.rud={};this.Mnf=1}tVh(x,B,z){this.Dfj();const A=!!this.Hq&&this.Hq.Mwa,I=!!this.Hq&&this.Hq.QEb,F=!!this.Hq&&this.Hq.Nwa,U=!!this.Hq&&this.Hq.Ypd&&!n.a.jMa(),X=!!this.Hq&&this.Hq.Lzb,
S=!!this.Hq&&this.Hq.cec,H=!!this.Hq&&this.Hq.god;x=x&&I;this.ar(4);this.ar(18);this.ar(16);this.ar(7);this.ar(17);this.ar(0);this.ar(1);H&&this.ar(25);X&&this.ar(23);A&&!I||!x||this.ar(8);B&&this.ar(15);A||this.ar(2);S&&this.ar(24);z&&this.ar(14);A&&!I||x||this.ar(8);B||this.ar(15);F&&this.ar(20);z||this.ar(14);this.ar(9);this.ar(12);this.ar(10);this.ar(11);A&&this.ar(2);A&&!I&&this.ar(8);this.ar(19);this.ar(21);this.ar(13);U&&this.ar(22);return this.rud}Ox(){return this.Hq}}Object(t.a)(y,"GroupsPlacementInfo",
null,[])},1346:function(t,C,a){a.r(C);t=a(0);var c=a(939),b=a(798),d=a(740),f=a(1272),e=a(797);class k{constructor(y="",x="",B="",z=-99999,A=-1,I=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=y?y:"";this.Description=x?x:"";this.Type=B?B:"";this.Score=z;this.Age=A;this.Count=I}}Object(t.a)(k,"Suggestion",null,[]);class l{constructor(y,x){this.GroupType=this.Suggestions=null;this.Suggestions=y;this.GroupType=x}}Object(t.a)(l,"SuggestionGroup",null,[]);class m{}
m.help="help";m.answer="answer";m.commands="commands";m.rnj="servicecommands";m.o8f="template";Object(t.a)(m,"SuggestionGroupType",null,[]);var v=a(699),n=a(698),w=a(4),r=a(41);a.d(C,"InteractionLogger",function(){return u});class u{constructor(y,x,B){this.xGc=0;this.IQc=this.Nib=null;this.hh=y;this.YPc=this.FFc=this.XIc=!1;this.Nmg=x;this.wh=w.AFrameworkApplication.vd;this.Ua=B;this.DQb=this.kNc=0}get uab(){return this.hh.uab}nvc(y){this.hh.nvc(y)}Klf(){if(this.Nib){var y=0;for(const x of this.Nib)this.hh.gvi(x,
y++);this.Nib=null}}beginQuery(y,x,B){this.hh.Wui(y,x,B)}dya(y,x){this.hh.qNg(y,x);this.XIc=!0;this.YPc=!1}xla(){this.XIc=!1;this.FFc||(this.Klf(),this.hh.SJe(this.xGc))}Xui(y,x){this.hh.Yui(y,x)}eHi(y,x,B,z,A){for(const I of this.Nmg)if(y.startsWith(I)){this.YPc=!0;break}this.hh.mti(y,x,B,z,A)}AHi(y){this.FFc=!1;this.xGc=y;this.XIc||this.YPc||(this.Klf(),this.hh.SJe(this.xGc,!1))}zHi(y,x){this.hh.pti(y,x);this.FFc=!0}ibd(y,x){if(!y.count)return"";let B="";const z=Date.now();for(let A of y)y=(z-A.timeStamp)/
1E3,y=n.a.jWd(y),0<B.length&&(B+=";"),B+=x?A.commandId:A.controlId,B+=":",B+=y.toString();return B}yla(){var y=this.ibd(c.a.instance.Hgb,!1);0<y.length&&this.hh.jti(y);y=this.ibd(c.a.instance.yUa,!0);0<y.length&&this.hh.Jsi(y);y=this.ibd(c.a.instance.ARb,!0);0<y.length&&this.hh.Qti(y);y=v.TellMeActor.instance.tae;0<y.length&&this.hh.Vui(r.c(y))}rvi(y){this.hh.Tsi(y)}c_(y,x,B,z,A,I,F){this.hh.oui(y,x,B,z,A,I,F)}itd(y,x,B,z){this.hh.itd(y,x,B,z)}sN(y,x,B=null){this.hh.Iti(y,x,B)}onError(y,x,B=null){this.hh.Tsd(y,
x,B)}Gqj(y){this.Nib=y}wXh(y){const x=[];if(!y)return x;for(let B=0;B<y.length;B++){const z=d.a[y[B].groupType].toLowerCase(),A=[],I=y[B].results;if(I){for(let F=0;F<I.length;F++)"findindocument"===z?Array.add(A,new k("","",z,I[F].score,I[F].ZYb,I[F].count)):Array.add(A,new k(I[F].label,I[F].description,z,I[F].score,I[F].ZYb,I[F].count));"answer"===z||"definition"===z||"wolframanswer"===z||"entity"===z?Array.add(x,new l(A,m.answer)):"classifier"===z||"appsforoffice"===z?Array.add(x,new l(A,m.commands)):
"serviceclassifier"===z?Array.add(x,new l(A,m.rnj)):"assistance"===z?Array.add(x,new l(A,m.help)):("document"===z||"people"===z||"findindocument"===z||"notes"===z||"image"===z||"template"===z)&&Array.add(x,new l(A,z))}}return x}Afd(y,x){const B={};B.Query=x;B.SuggestionGroups=r.c(this.wXh(y));return r.c(B)}h2e(y){const x={"Content-Type":"application/json",Accept:"application/json"};x["X-Office-Version"]=w.AFrameworkApplication.buildVersion;x["X-Office-Application"]=w.AFrameworkApplication.fa.Va("Application");
x["X-Office-Platform"]="WAC";x["X-TellMe-SqmUserId"]=w.AFrameworkApplication.fa.Va("LoggableUserId")||"";x["X-TellMe-SessionId"]=this.hh.uab.QU;x["X-TellMe-SuggestionTypes"]="Ranker";x["X-TellMe-Culture"]=w.AFrameworkApplication.uiCulture;x["X-TellMe-ProcessSessionId"]=w.AFrameworkApplication.userSessionId;x["X-TellMe-Flights"]=y;x["X-TellMe-PartialQueryIndex"]=this.kNc;return x}qOa(y,x,B){this.c_(x.length,"RankerLogging",y.data.httpStatus.toString(),Math.round(window.performance.now()-B),e.a.h8f,
!0,b.a.Caa)}dOa(y,x,B){this.c_(x.length,"RankerLogging",y.data.httpStatus.toString(),Math.round(window.performance.now()-B),e.a.h8f,!1,b.a.Caa)}i2e(){this.IQc||(this.IQc=new f.a(this.Ua,null,6E3));return this.IQc.k1d}mtd(y){const x=this.Afd(this.Nib,y),B=this.h2e("RankerLogging"),z=window.performance.now();this.wh.Bm(this.i2e(),2,x,B,!1,0,A=>{this.qOa(A,y,z)},A=>{this.dOa(A,y,z)},null,null,!1,4E3,6E3);this.kNc++}sfj(){this.kNc=0}zNd(y){this.DQb=y}}Object(t.a)(u,"InteractionLogger",null,[])},1427:function(t,
C,a){a.r(C);var c=a(4),b=a(246),d=a(0),f=a(691),e=a(5),k=a(77),l=a(90),m=a(1),v=a(182),n=a(132),w=a(25),r=a(55);class u{constructor(Qb,wb){this.ai=Qb;this.$=wb}Nc(){return!1}executeCommand(Qb,wb,hc,Za){m.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&n.b(this.$).vJd();Qb=hc[k.a.Pc];return m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&m.EwaSettings.ma(238)||!(Qb&&Qb===e.a.$Fd||7===wb.Re&&hc.SourceControlId===
this.$.Bb+e.a.qbc)?m.EwaSettings.ma(238)&&!c.AFrameworkApplication.disableWholeAppsForOfficeFeature&&(2===wb.Re||7===wb.Re||m.EwaSettings.isChangeGateEnabled("OfficeVSO:3009717_EnableTellMeHelpForAgaveHelpPane")&&-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),Qb))?(hc[e.a.Hda]=Za?Za.enabledInViewModeRibbon:!1,wb=new l.a(-859308420,wb.method,wb.mode,wb.Re,wb.tabName),this.$.Ka.Mb(wb,hc)):2===this.ai.de(w.a.searchHelp,2,hc)?v.a(wb.command):r.Task.Ta(!0):2===this.ai.de(w.a.giveFeedback,
2,hc)?v.a(wb.command):r.Task.Ta(!0)}Cc(Qb,wb){return-1376725189===wb.command||-1969051244===wb.command}Rc(){return!1}}Object(d.a)(u,"AssistanceCommandHandler",null,[195]);class y extends f.a{constructor(Qb){super(Qb)}yd(){this.gd([new u(c.AFrameworkApplication.wb,this.$)])}static ka(Qb){f.a.Nd(112,new y(Qb))}}Object(d.a)(y,"AssistanceCommandHandlerFactory",f.a,[]);var x=a(15),B=a(83);class z{constructor(){this.correlationId=this.sessionId=this.WNc=null;this.actionId=0;this.SWb=null}get Hd(){return this.WNc?
this.WNc:""}set Hd(Qb){this.WNc=Qb}}Object(d.a)(z,"AssistanceSearchVariableUrlParameterSet",null,[]);var A=a(315),I=a(639),F=a(82),U=a(106);class X{constructor(){this.Ww=!1;this.Gy=!0;this.Nee=this.Qfb=null}get isInitialized(){return this.Ww}initialize(Qb,wb){const hc=!!Qb&&!!wb;hc&&(this.Qfb=Qb,this.Nee=wb);this.Ww=hc;c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)||F.a.instance.Wb("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Za=>
{Za.EM("Enabled").then(ub=>{this.Gy=ub;return null},()=>null)})}Gg(Qb){Qb||(Qb=c.AFrameworkApplication.wb);c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&(this.Gy=c.AFrameworkApplication.GD,F.a.instance.Wb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(wb=>{wb.isFeatureEnabled("mso_sendASmile",!0).then(hc=>{this.Gy=c.AFrameworkApplication.GD&&hc;(hc=c.AFrameworkApplication.ta)&&
hc.updateCommandUI();return null},()=>null)}));Qb.Ob(w.a.searchHelp,U.a.frame,Object(B.a)(this,this.RAj,"showSearchResults"))}RAj(Qb,wb,hc,Za,ub){if(1===hc)return c.AFrameworkApplication.fa.qa("IsFeedbackExperiencesAvailable")||(this.Gy=!1),ub&&"SourceControlId"in ub&&(ub=ub.SourceControlId,("GiveFeedback"===ub||"btnFeedback"===ub||"btnFeedbackPane"===ub||"PptEditingStatusBar.GiveFeedbackPane"===ub||"GiveFeedbackPane"===ub)&&!this.Gy)?8:I.SessionStatusManager.instance.u4a?8:32;x.ULS.sendTraceTag(4761738,
1302,50,"");A.a.mark(4771);if(this.isInitialized){Qb=ub.CommandValueId;wb=ub.SourceControlId;ub=Object.assign(new z,{actionId:w.a.searchHelp,SWb:ub});if(void 0!==Qb&&null!==Qb)ub=X.cZh(Qb);else if(void 0!==wb&&null!==wb)switch(wb){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":ub.actionId=w.a.giveFeedback;break;case "btnContactSupport":case "ContactSupport":ub.actionId=w.a.a1g;break;case "btnShowTraining":case "Training":ub.actionId=
w.a.cLj;break;case "btnWhatsNew":case "WhatsNew":ub.actionId=w.a.SWj}this.Qfb.Vyj(this.Nee,ub);A.a.mark(4772);return 32}A.a.mark(4772);return 8}dispose(){this.Qfb&&(this.Qfb.dispose(),this.Qfb=null)}static get instance(){X.Ma||(X.Ma=new X);return X.Ma}static cZh(Qb){const wb=new z,hc=Qb.indexOf("|");wb.sessionId=Qb.substring(0,hc);const Za=Qb.indexOf("|",hc+1);wb.correlationId=Qb.substring(hc+1,Za);wb.Hd=Qb.substr(Za+1);return wb}}X.Ma=null;Object(d.a)(X,"AssistanceActor",null,[2]);var S=a(39),H=
a(30),D=a(692);class J{constructor(){this.Y0d=this.nb=this.kUa=null;this.eNc=!1}Vyj(Qb,wb){if(wb.actionId!==w.a.giveFeedback||c.AFrameworkApplication.GD)if(this.eNc&&!c.AFrameworkApplication.disableWholeAppsForOfficeFeature)this.kUa||(this.kUa=this.Y0d()),this.kUa.bdb();else if(wb.actionId===w.a.giveFeedback)this.Dyj();else{Qb=Qb.abc(wb);wb=null;try{H.a.swa(Qb)&&(wb=S.a.Ve(Qb,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no",
"AssistanceDisplayManager:HelpWindow"))}catch(hc){throw x.ULS.sendTraceTag(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+hc.message),hc;}wb?x.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",Qb):x.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",Qb,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else x.ULS.sendTraceTag(554295451,
356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.kUa&&(this.kUa.dispose(),this.kUa=null)}j0f(Qb,wb,hc){hc&&D.c(Qb)?this.eNc=!1:(this.Y0d=Qb,this.eNc=hc);this.nb=wb}Dyj(){c.AFrameworkApplication.wb.processAction(w.a.giveFeedback,2)}static createInstance(Qb,wb,hc=null){const Za=new J;null==hc?Za.j0f(Qb,wb,c.AFrameworkApplication.hre||wb.qa("HelpTabIsEnabled")):Za.j0f(Qb,wb,hc);return Za}}Object(d.a)(J,"AssistanceDisplayManager",
null,[610,2]);var M=a(555);class G{constructor(Qb,wb,hc,Za,ub){this.b1=Qb;this.qsg=wb;this.hTb=hc;this.Bkg=Za;this.p$d=ub}get lcid(){return this.b1}get namespace(){return this.qsg}get vNa(){return this.hTb}get qKg(){return this.Bkg}get locale(){return this.p$d}static NYh(Qb){const wb=Qb.indexOf(".");return 0<=wb&&wb<Qb.length&&(Qb=parseInt(Qb.substring(0,wb)),!isNaN(Qb))?Qb:G.mLg}static createInstance(Qb){return new G(c.AFrameworkApplication.lcid,Qb,G.NYh(c.AFrameworkApplication.buildVersion),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",
M.a.YJ(c.AFrameworkApplication.lcid).name)}}G.mLg=16;Object(d.a)(G,"AssistanceSearchUrlParameterSet",null,[]);var T=a(251);class K{constructor(Qb,wb){Qb=new T.QueryStringBuilder(Qb);Qb.Qi("clid",wb.lcid.toString());Qb.Qi("p1",wb.namespace);Qb.Qi("ver",wb.vNa.toString());Qb.Qi("apps",wb.qKg);Qb.Qi("lc",wb.locale);this._url=Qb.toString()}abc(Qb){const wb=new T.QueryStringBuilder(this._url);wb.Qi("src","TellMe");wb.Qi("query",Qb.Hd);wb.Qi("sessionid",Qb.sessionId);wb.Qi("correlationid",Qb.correlationId);
return wb.toString()}static createInstance(Qb){return new K(c.AFrameworkApplication.ire,Qb)}}Object(d.a)(K,"AssistanceSearchUrlProvider",null,[609]);class L{Rh(){}init(){c.AFrameworkApplication.XYa&&!c.AFrameworkApplication.suppressHelp&&X.instance.Gg(c.AFrameworkApplication.wb)}dispose(){X.instance.dispose()}u9h(){X.instance.initialize(J.createInstance("XLWAEndUser",c.AFrameworkApplication.fa),K.createInstance(G.createInstance(void 0)))}}Object(d.a)(L,"AssistancePackage",null,[4,5]);class V extends L{constructor(){super()}get name(){return"Excel.Assistance"}init(){super.init();
this.u9h()}}Object(d.a)(V,"ExcelAssistancePackage",L,[]);var W=a(10),da=a(508),qa=a(50),O=a(37),ea=a(38);class R extends ea.a{constructor(Qb,wb,hc,Za){super();this.Lie=0;this.xXa=null;this.ds=0;this.menuId=this.RX=null;this.Rsf=()=>{this.xXa=null;this.ds=3;this.Gkf("OnAccountingFormatMenuDataLoadFailure");this.Hca();this.raiseEvent("ek2")};this.Ssf=(ub,uc)=>{this.xXa=uc.xXa;this.ds=2;this.Gkf("OnAccountingFormatMenuDataLoadSuccess");this.Hca();this.raiseEvent("ek1")};this.frame=Qb;this.nrb=wb;this.nrb.ETc(this.Ssf);
this.nrb.DTc(this.Rsf);this.ug=Za;this.p8a=hc;this.Dej()}ETc(Qb){this.addHandler("ek1",Qb)}bPf(Qb){this.removeHandler("ek1",Qb)}DTc(Qb){this.addHandler("ek2",Qb)}aPf(Qb){this.removeHandler("ek2",Qb)}dispose(){this.nrb.bPf(this.Ssf);this.nrb.aPf(this.Rsf);super.dispose()}Rc(Qb,wb,hc){if("PopulateAccountingFormatsMenu"!==wb)return!1;this.menuId=hc.MenuId;if(2!==this.ds&&3!==this.ds)return!1;this.RX=this.RX||this.p8a.UEh(this.xXa,hc.MenuId);hc.MenuItems=this.RX;return!0}Nc(){return!1}Cc(Qb,wb){return 443187837===
wb.command}executeCommand(Qb,wb,hc){return 443187837===wb.command?(Qb={ValidMembers:32,NumberFormat:14},Qb.NumberFormatOptions=this.xXa.NumberFormatOptions[parseInt(hc[k.a.Pc].toString(),10)],this.ug.formatCells(443187837,Qb,wb),r.Task.Ta(!0)):v.a(wb.command)}Dej(){this.Lie=Date.now();this.ds=1;this.nrb.Jri()}Gkf(Qb){x.ULS.sendTraceTag(537155170,0,50,`AccountingFormatMenuCommandHandler.${Qb}: AccountingFormat Menu loading time was : ${Date.now()-this.Lie} ms`)}Hca(){this.menuId&&this.frame.Qw(this.menuId)}}
Object(d.a)(R,"AccountingFormatMenuCommandHandler",ea.a,[195,575]);var oa=a(170),pa=a(29),Pa=a(280);class Z extends Sys.EventArgs{constructor(Qb){super();this.xXa=Qb}}Object(d.a)(Z,"AccountingFormatMenuDataLoadedEventArgs",Sys.EventArgs,[]);var Ra=a(61);class Ga extends ea.a{constructor(Qb,wb){super();this.OEi=()=>{this.raiseEvent("AccountingFormatOptionsDataLoadFailed")};this.PEi=hc=>{!pa.a.er(hc.Errors)&&hc.Result?this.raiseEvent("AccountingFormatMenuDataLoaded",new Z(hc.Result)):this.raiseEvent("AccountingFormatOptionsDataLoadFailed")};
this.va=Qb;this.userOperationManager=wb}ETc(Qb){this.addHandler("AccountingFormatMenuDataLoaded",Qb)}bPf(Qb){this.removeHandler("AccountingFormatMenuDataLoaded",Qb)}DTc(Qb){this.addHandler("AccountingFormatOptionsDataLoadFailed",Qb)}aPf(Qb){this.removeHandler("AccountingFormatOptionsDataLoadFailed",Qb)}Jri(){this.userOperationManager.Ub(new oa.a(166,0,(Qb,wb,hc)=>{var Za=this.va;Qb=Pa.b(Qb,this.PEi);wb=Pa.a(wb,this.OEi);const ub=Za.Na(5);return Ra.g(Za,"GetAccountingFormatMenuData",ub,Qb,wb,hc,null,
4)},16),null)}}Object(d.a)(Ga,"AccountingFormatMenuDataLoader",ea.a,[574]);class Ba{constructor(Qb){this.Sa=Qb}UEh(Qb,wb){return this.zFh(Qb,wb).rE()}zFh(Qb,wb){wb=this.Sa.sq(wb);if(Qb){var hc=this.Sa.zc();for(let Za=0;Za<Qb.NumberOfMenuItems;++Za){const ub=this.r3g(Za.toString(),Qb.MenuItemLabels[Za]);hc.buttons.push(ub)}wb.nc.push(hc)}Qb=this.Sa.zc();hc=this.e7g();Qb.buttons.push(hc);wb.nc.push(Qb);return wb}r3g(Qb,wb){Qb=this.Sa.EP(137,"Number.AccountingFormatOptionMenuItem_"+Qb,443187837,null,
1,"None",0,0,Qb,!1,0);Qb.label=wb;Qb.FR(wb);return Qb}e7g(){return this.Sa.EP(137,"Number.MoreAccountingFormatOptionsMenuItem",2105621672,null,1,"None",501,0,"3",!1,1595)}}Object(d.a)(Ba,"AccountingFormatMenuRenderer",null,[573]);class fa extends f.a{constructor(Qb){super(Qb)}yd(){const Qb=qa.GetServiceTaskFactory.create(this.$.da,18,this.$.la,this.hb),wb=qa.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb);O.TaskExtensions.Aa(O.TaskExtensions.Wd([Qb,wb],this.la),()=>{var hc=new Ga(this.$.oa.va,
this.$.userOperationManager);const Za=new Ba(wb.result);hc=new R(this.$.frame,hc,Za,Qb.result);this.$.da.Ga(191,hc);this.gd([hc])},this.$.la,3)}static ka(Qb){f.a.Nd(190,new fa(Qb))}}Object(d.a)(fa,"AccountingFormatMenuCommandHandlerFactory",f.a,[]);var Y=a(58);class ja extends Sys.EventArgs{constructor(Qb){super();this.$Vj=Qb}}Object(d.a)(ja,"NumberFormatViewModelLoadedEventArgs",Sys.EventArgs,[]);var ca=a(51);class aa extends ea.a{constructor(Qb){super();this.dTi=wb=>{pa.a.er(wb.Errors)?this.raiseEvent("NumberFormatViewModelFailed"):
this.raiseEvent("NumberFormatViewModelLoaded",new ja(wb.Result))};this.cTi=()=>{this.raiseEvent("NumberFormatViewModelFailed")};this.$=Qb}Gmb(Qb){this.addHandler("NumberFormatViewModelLoaded",Qb)}OHb(Qb){this.removeHandler("NumberFormatViewModelLoaded",Qb)}uFg(Qb){this.addHandler("NumberFormatViewModelFailed",Qb)}tbj(Qb){this.removeHandler("NumberFormatViewModelFailed",Qb)}tsi(Qb,wb,hc){const Za={};Za.a=this.$.ya.UserSessionId;hc&&(Za.b=Y.a.Ac(hc));wb&&(Za.c=Y.a.Ac(wb));ca.b().Le(6,Za);this.$.userOperationManager.Ub(new oa.a(160,
0,(ub,uc,Oc)=>{var Bb=this.$.oa.va;ub=Pa.b(ub,this.dTi);uc=Pa.a(uc,this.cTi);const Nb=Bb.Na(1);Nb.activeCell=Qb;Nb.numberFormatOptions=wb;Nb.prevNumberFormatOptions=hc;return Ra.g(Bb,"GetNumberFormatViewModelData",Nb,ub,uc,Oc,null,0)},16),null)}}Object(d.a)(aa,"NumberFormatClientViewModelDataLoader",ea.a,[584]);var ta=a(43),xa=a(21),ia=a(7),ya=a(144),ib=a(769),wa=a(14),sa=a(260);class Ya{constructor(Qb,wb){this.JYg=(hc,Za)=>{1===hc?(hc=Za.resultLanguageIndex,x.ULS.sendTraceTag(537155167,0,50,`ChangeLocaleDialog.CloseReactChangeLocaleDialog pressing on OK. selected index:${hc}`),
this.numberFormatViewModel.ivc(hc,"ChangeLocaleDialog")):x.ULS.sendTraceTag(537155166,0,50,"ChangeLocaleDialog.CloseReactChangeLocaleDialog pressing on Cancel");this.dispose()};this.lEb=()=>{this.numberFormatViewModel.$df(2,"ChangeLocaleDialog.OnNumberFormatViewModelLoaded")&&(x.ULS.sendTraceTag(537155165,0,50,"ChangeLocaleDialog.OnNumberFormatViewModelLoaded success"),this.lUi())};this.kEb=()=>{x.ULS.sendTraceTag(537155164,0,15,"ChangeLocaleDialog.OnNumberFormatViewModelLoaded failure")};this.numberFormatViewModel=
wb;this.activeCell=Qb;this.numberFormatViewModel.Gmb(this.lEb);this.numberFormatViewModel.Dme(this.kEb)}initialize(){const Qb=Object(ia.a)(new ib.a,{Caller:2,NumberFormatCategory:-1});this.numberFormatViewModel.u7c(this.activeCell,Qb)}dispose(){this.numberFormatViewModel&&(this.numberFormatViewModel.OHb(this.lEb),this.numberFormatViewModel.$Pf(this.kEb))}lUi(){const Qb={[sa.a.Tu]:"ChangeLocaleDialog",["languageList"]:this.numberFormatViewModel.Wk.Locales,["helpLink"]:this.numberFormatViewModel.IEf},
wb=new ya.a(!1,!1,!0);wb.Rb=1;wb.ze="ChangeLocaleDialog";wb.initializeAndShow(wa.a.instance.ga(2215),this.JYg,Qb)}}Object(d.a)(Ya,"ChangeLocaleDialog",null,[2]);var bb=a(1165);class mb{constructor(Qb,wb){this.$=Qb;this.numberFormatViewModel=wb}Nc(){return!1}Cc(Qb,wb){Qb=!1;switch(wb.command){case 2105621672:case -168056295:case 151715844:Qb=!0}return Qb}executeCommand(Qb,wb,hc){Qb=!1;switch(wb.command){case 151715844:Qb=this.STi();break;case 2105621672:case -168056295:Qb=this.openNumberFormatDialog(wb,
hc)}return r.Task.Ta(Qb)}Rc(){return!1}YUe(){let Qb=null;const wb=xa.g(this.$).ha.sa.activeCell;wb&&(Qb=ta.o(wb,this.$));return Qb}openNumberFormatDialog(Qb,wb){var hc;let Za=null;k.a.Pc in wb&&wb[k.a.Pc]&&(Za=parseInt(wb[k.a.Pc].toString(),10));const ub=this.YUe();if(!ub)return!1;this.numberFormatViewModel.GSf();wb=null!==(hc=null===wb||void 0===wb?void 0:wb.onClose)&&void 0!==hc?hc:uc=>{uc&&this.numberFormatViewModel.formatCells(this.numberFormatViewModel.nac(),Qb)};(new bb.a(this.$,ub,this.numberFormatViewModel,
Qb,Za,wb)).initialize();return!0}STi(){const Qb=this.YUe();if(!Qb)return!1;this.numberFormatViewModel.GSf();(new Ya(Qb,this.numberFormatViewModel)).initialize();return!0}}Object(d.a)(mb,"NumberFormatCommandHandler",null,[195]);var Ca=a(109),$a=a(11),Kb=a(1081),rb=a(42),cc=a(249),nc=a(6),Wb=a(140),Ea=a(252),ua=a(68);class ma extends ea.a{constructor(Qb,wb,hc){super();this.feh=[wa.a.instance.ga(489),wa.a.instance.ga(490),wa.a.instance.ga(491),wa.a.instance.ga(492),wa.a.instance.ga(493),wa.a.instance.ga(494),
wa.a.instance.ga(495),wa.a.instance.ga(496),wa.a.instance.ga(497),wa.a.instance.ga(498),wa.a.instance.ga(499),wa.a.instance.ga(500)];this.Wk=null;this.Azf=(Za,ub)=>{(this.Wk=ub?ub.$Vj:null)?this.Y2i():this.mKf()};this.zzf=()=>{this.mKf()};this.$=Qb;this.VUg=wb;this.dDb=hc;this.dDb.Gmb(this.Azf);this.dDb.uFg(this.zzf);this.$.da.Ga(193,this)}Gmb(Qb){this.addHandler("NumberFormatViewModelLoaded",Qb)}OHb(Qb){this.removeHandler("NumberFormatViewModelLoaded",Qb)}Dme(Qb){this.addHandler("NumberFormatViewModelFailed",
Qb)}$Pf(Qb){this.removeHandler("NumberFormatViewModelFailed",Qb)}get IEf(){return"https://go.microsoft.com/fwlink/p/?linkid=2134522"}dispose(){this.dDb.OHb(this.Azf);this.dDb.tbj(this.zzf);super.dispose()}formatCells(Qb,wb){const hc={};hc.NumberFormatOptions=Qb;hc.ValidMembers=32;hc.NumberFormat=14;Qb=Object(ia.a)(new Kb.a,{color:this.Wk.Color,sample:this.Wk.Sample,clc:this.Wk.NumberFormatString});this.VUg.formatCells(2105621672,hc,wb,Qb)}get clc(){return this.Wk.NumberFormatString}UVe(Qb){return this.feh[Qb]}nac(){return this.nBe(this.Wk.NumberFormatOptions)}nBe(Qb){return Object(ia.a)(new ib.a,
{NumberFormatCategory:Qb.NumberFormatCategory,DecimalPlaces:Qb.DecimalPlaces,IsComma:Qb.IsComma,NegativeNumberType:Qb.NegativeNumberType,NegativeCurrencyType:Qb.NegativeCurrencyType,CurrencyType:Qb.CurrencyType,DateType:Qb.DateType,TimeType:Qb.TimeType,FractionType:Qb.FractionType,SpecialType:Qb.SpecialType,CustomType:Qb.CustomType,LocaleType:Qb.LocaleType,IsInputCalendar:Qb.IsInputCalendar,CalendarType:Qb.CalendarType,IsGannen:Qb.IsGannen,IsOverrideDataLocale:Qb.IsOverrideDataLocale,Caller:Qb.Caller})}GSf(){this.Wk=
null}u7c(Qb,wb){this.dDb.tsi(Qb,wb,this.Wk?this.Wk.NumberFormatOptions:null)}$df(Qb,wb){x.ULS.shipAssertTag(537155107,0,!!this.Wk,"NumberFormatViewModel.IsModelLoadedBy: numberFormatViewModelData is null");const hc=this.nac().Caller,Za=hc===Qb;Za||x.ULS.sendTraceTag(537155106,0,15,`NumberFormatViewModel.IsModelLoaddedBy: expected caller in '${wb}' should be ${Qb} but caller is ${hc}`);return Za}ivc(Qb,wb){const hc=this.Wk.LocaleTags;if(Ca.e(hc))x.ULS.shipAssertTag(537155105,0,!1,"NumberFormatViewModel.SetOverrideDataLocaleCookie: localeTags array is null or empty");
else if(hc.length!==this.Wk.Locales.length)x.ULS.shipAssertTag(537155104,0,!1,`NumberFormatViewModel.SetOverrideDataLocaleCookie: length mismatch: localeTags:${hc.length}. localeNames:${this.Wk.Locales.length}.`);else if(0>Qb||Qb>=hc.length)x.ULS.shipAssertTag(537155103,0,!1,`NumberFormatViewModel.SetOverrideDataLocaleCookie: selectedLocaleIndex ${Qb} is out of range:[0:${hc.length}]`);else{var Za=hc[Qb];if(Za){var ub={};$a.HelperMethods.JYf(ma.YUi,Za,this.$.ya.OverrrideDataLocaleCookieTTLDays,"OverrideDataLocale",
ub);this.$.sendBeaconTraceTag(590878544,50,!0,"NumberFormatViewModel.SetOverrideDataLocaleCookie: setting cookie. caller:{0}. currentDomain:{1}. cookieDomain:{2}. hostNameJsApi:{3}. hostName:{4}. uiHost:{5}. prevDataLocale:{6}. prevCookieVal:{7}. selectedLocaleIndex:{8}. selectedCultureTag:{9}. cookieSetOK:{10}. newCookieVal:{11}.",wb,ub.currentDomain,ub.parentDomain,this.$.ya.HostNameJsApi,this.$.ya.HostName,this.$.ya.UiHost,hc[0],ub.prevCookieVal,Qb,Za,ub.cookieSetOK,ub.newCookieVal);rb.a(this.$).ls(new cc.a(nc.a.Mx,
5,()=>{const uc=ua.a(this.$).jd.activityState;uc[Wb.a.CX]=!0;uc[Ea.a.oq]=nc.a.I_c;this.$.Xk.Ky("OverrideDataLocale_"+wb.substring(0,1))}))}else x.ULS.shipAssertTag(537155102,0,!1,"NumberFormatViewModel.SetOverrideDataLocaleCookie: selectedCultureTag is null or empty")}}Y2i(){this.raiseEvent("NumberFormatViewModelLoaded")}mKf(){this.raiseEvent("NumberFormatViewModelFailed")}}ma.YUi="rsOverride";Object(d.a)(ma,"NumberFormatViewModel",ea.a,[572,2]);class fb extends f.a{constructor(Qb){super(Qb)}yd(){const Qb=
qa.GetServiceTaskFactory.create(this.$.da,18,this.$.la,this.hb);O.TaskExtensions.Aa(Qb,()=>{var wb=new ma(this.$,Qb.result,new aa(this.$));wb=new mb(this.$,wb);this.gd([wb])},this.$.la,3)}static ka(Qb){f.a.Nd(189,new fb(Qb))}}Object(d.a)(fb,"NumberFormatCommandHandlerFactory",f.a,[]);var sb=window.TellMeAdditionalControls={name:"CommandUI",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Command:"0x2F9A3D80",Id:"SpellCheckUpSellButton",LabelText:"TellMeStringId.Ewr_SpellCheckUpSell"},children:[{name:"Menu",
attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"TellMeStringId.Ewr_DeskTopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x56BA1B75",Description:"TellMeStringId.Ewr_OpenInDesktopDescription",Id:"TellMe.OpenInClient",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_excel48",LabelText:"TellMeStringId.Ewr_OpenInDesktopExcel"}}]}]},{name:"MenuSection",attrs:{DisplayMode:"Menu48",Id:"UpSellInformationMenuSection",
ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x0CDCFF89",Description:"TellMeStringId.Ewr_DesktopUpSellDescription",Id:"TellMe.TryOfficeThroughTellMeForXLSSpellCheck",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_TryOffice",LabelText:"TellMeStringId.Ewr_DesktopUpSellTitle"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Command:"0x2F9A3D80",Id:"MacrosUpSellButton",LabelText:"TellMeStringId.Ewr_MacrosUpSell"},children:[{name:"Menu",
attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"TellMeStringId.Ewr_DeskTopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x56BA1B75",Description:"TellMeStringId.Ewr_OpenInDesktopDescription",Id:"TellMe.OpenInClient",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_excel48",LabelText:"TellMeStringId.Ewr_OpenInDesktopExcel"}}]}]},{name:"MenuSection",attrs:{DisplayMode:"Menu48",Id:"UpSellInformationMenuSection",
ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x0CDCFF89",Description:"TellMeStringId.Ewr_DesktopUpSellDescription",Id:"TellMe.TryOfficeThroughTellMeForXLSMacros",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_TryOffice",LabelText:"TellMeStringId.Ewr_DesktopUpSellTitle"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Command:"0x2F9A3D80",Id:"HeaderFooterUpSellButton",LabelText:"TellMeStringId.Ewr_HeaderFooterUpSell"},children:[{name:"Menu",
attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"TellMeStringId.Ewr_DeskTopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x56BA1B75",Description:"TellMeStringId.Ewr_OpenInDesktopDescription",Id:"TellMe.OpenInClient",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_excel48",LabelText:"TellMeStringId.Ewr_OpenInDesktopExcel"}}]}]},{name:"MenuSection",attrs:{DisplayMode:"Menu48",Id:"UpSellInformationMenuSection",
ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x0CDCFF89",Description:"TellMeStringId.Ewr_DesktopUpSellDescription",Id:"TellMe.TryOfficeThroughTellMeForXLSHeaderFooter",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_TryOffice",LabelText:"TellMeStringId.Ewr_DesktopUpSellTitle"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Command:"0x2F9A3D80",Id:"SpellCheckUpSellButtonEnterprise",LabelText:"TellMeStringId.Ewr_SpellCheckUpSell"},children:[{name:"Menu",
attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"TellMeStringId.Ewr_DeskTopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x56BA1B75",Description:"TellMeStringId.Ewr_OpenInDesktopDescription",Id:"TellMe.OpenInClient",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_excel48",LabelText:"TellMeStringId.Ewr_OpenInDesktopExcel"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Command:"0x2F9A3D80",Id:"MacrosUpSellButtonEnterprise",
LabelText:"TellMeStringId.Ewr_MacrosUpSell"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"TellMeStringId.Ewr_DeskTopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x56BA1B75",Description:"TellMeStringId.Ewr_OpenInDesktopDescription",Id:"TellMe.OpenInClient",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_excel48",LabelText:"TellMeStringId.Ewr_OpenInDesktopExcel"}}]}]}]}]},{name:"FlyoutAnchor",
attrs:{Command:"0x2F9A3D80",Id:"HeaderFooterUpSellButtonEnterprise",LabelText:"TellMeStringId.Ewr_HeaderFooterUpSell"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"TellMeStringId.Ewr_DeskTopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x56BA1B75",Description:"TellMeStringId.Ewr_OpenInDesktopDescription",Id:"TellMe.OpenInClient",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_excel48",
LabelText:"TellMeStringId.Ewr_OpenInDesktopExcel"}}]}]}]}]}]},Ua=a(928);class ab extends f.a{constructor(Qb){super(Qb)}yd(){this.$.Qx(()=>{this.gd([new Ua.ConditionalFormattingCommandHandler(this.$)])})}static ka(Qb){f.a.Nd(247,new ab(Qb))}}Object(d.a)(ab,"ConditionalFormattingCommandHandlerFactory",f.a,[]);var na=a(221),Na=a(1281),Va=a(413);class Sa extends na.a{constructor(Qb){super();this.eh=this.ri=null;this.$=Qb;this.Fb()}get pD(){this.ri||(this.ri=O.TaskExtensions.Aa(Va.a(this.$),Qb=>{this.eh=
Na.a.ka(this.$,Qb.result)},this.la,3));return this.ri}create(){const Qb=qa.GetServiceTaskFactory.create(this.$.da,203,this.la,this.hb),wb=qa.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb);O.TaskExtensions.Aa(O.TaskExtensions.ts(O.TaskExtensions.Wd([Qb,wb],this.la),()=>this.pD,this.la),()=>{this.qb(this.eh)},this.la,3)}dispose(){this.eh=this.ri=this.$=null;super.dispose()}static ka(Qb){Qb.da.Ga(249,new Sa(Qb))}}Object(d.a)(Sa,"ConditionalFormattingTaskPaneFactory",na.a,[]);var vb=a(54),
Oa=a(699),yb=a(148),Ob=a(416),Ja=a(328),lb=a(698),Pb=a(151),Jb=a(685);class Lb{constructor(Qb=null,wb=null,hc=null,Za,ub=null){this.Ifb=null;this.y0d=!1;this.s5d=this.jUa=null;this.Bvg=this.Ffe=this.Ckg=this.t5d=!1;this.uQb=null;this.Nkg=null==wb?c.AFrameworkApplication.XYa:wb;this.cqg=null==hc?c.AFrameworkApplication.Mva:hc;this.Zvg=null==ub?c.AFrameworkApplication.qna:ub;this.tpg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeHelpOnHelpIsEnabled");this.Wwg=!!c.AFrameworkApplication.fa&&
c.AFrameworkApplication.fa.qa("TellMeCommandHookIsEnabled");this.Wtj(!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeIgnoreQueryForHelp"));this.Owg=!!c.AFrameworkApplication.ta&&c.AFrameworkApplication.ta.Oa.Kzb;this.Pwg=!lb.a.aka()&&!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMePeopleSuggestionIsEnabled");this.Nwg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeFileSuggestionIsEnabled");this.eog=!!c.AFrameworkApplication.ta&&c.AFrameworkApplication.ta.Oa.zRa;
this.Qwg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.rvg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("HelpShowsTopSearchResult");this.Qsg=this.VKb||this.UKb;this.Osg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("OnlineCommandSuggestionsIsEnabled");this.Psg=this.Xnd;this.crg=!!c.AFrameworkApplication.fa&&this.tellMeInSharedHeaderIsEnabled&&c.AFrameworkApplication.fa.qa("StyledHeaderInLabelIsEnabled");this.Tog=
c.AFrameworkApplication.fa?c.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.Yog=c.AFrameworkApplication.fa?c.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.Pog=c.AFrameworkApplication.fa?parseFloat(c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.arg=!!c.AFrameworkApplication.fa&&
(c.AFrameworkApplication.fa.qa("SmartLookupNoteSearchIsEnabled")||c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.vwg=c.AFrameworkApplication.fa?c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.$og=c.AFrameworkApplication.fa?c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",
""):"";this.svg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.Svg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.yvg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("ShowFindInDocumentInZeroTermSearchBox")||this.yy;this.krg=!!c.AFrameworkApplication.fa&&(c.AFrameworkApplication.fa.qa("TellMeTemplateProviderIsEnabled")||
c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.Lqg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.Vqg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeIsRuleBasedSortingEnabled")&&"en-US"===c.AFrameworkApplication.uiCulture;this.hrg=!!c.AFrameworkApplication.fa&&(c.AFrameworkApplication.fa.qa("TellMeFeedbackProviderIsEnabled")||
c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.org=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeZeroTermContextualCommandSuggestionsEnabled");this.Dkg=this.tellMeInSharedHeaderIsEnabled&&!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.mpg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",
!1);this.Wvg=!!c.AFrameworkApplication.fa&&(c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==c.AFrameworkApplication.fa.Va("Application"));this.nlg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.Gxg=!!c.AFrameworkApplication.fa&&(c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UsePerformanceMarker",
!1)||c.AFrameworkApplication.fa.qa("TellMePerformanceMarkerEnabled"));this.lqg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.pqg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.Yqg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchDescriptionEnabled",
!1);this.Yug=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SearchAddinByKeywords",!1);this.bkg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinSearchKeywordsContainDescription",!1);this.Xog=c.AFrameworkApplication.fa?c.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.jrg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeNotesSuggestionIsEnabled")||
this.Kgf;this.nqg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.oqg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",!1);this.mqg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",
!1);this.Rwg=this.Hmi&&(this.fBd||this.gBd||this.QEb||this.tellMeInSharedHeaderIsEnabled&&lb.a.x4()&&!!c.AFrameworkApplication.fa&&(this.Vcb||this.Scb||this.Tcb||this.Ucb||this.Xcb||c.AFrameworkApplication.fa.qa("ShowAnswerSearchResults")||c.AFrameworkApplication.fa.qa("ShowDefinitionSearchResults")||c.AFrameworkApplication.fa.qa("ShowEntitySearchResults")||c.AFrameworkApplication.fa.qa("ShowWolframSearchResults")));this.ckg=!!c.AFrameworkApplication.fa&&!c.AFrameworkApplication.fa.qa("AppsForOfficeThirdPartyIsDisabled")&&
c.AFrameworkApplication.fa.qa("AppsForOfficeAllowExternalMarketplace")&&c.AFrameworkApplication.p9;this.dkg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("AppsForOfficePrivateCatalogIsEnabled");this.H9h(Qb||{});this.ZUb="2918242107";this.YUb="1454393937";this.SDa={};this.Sqa=[];this.W1g=[lb.a.Gzc]}get application(){return this.jUa}get XYa(){return this.Nkg}get Hkj(){return this.ZUb}get Gkj(){return this.YUb}get PRe(){return this.s5d}get Ozh(){return this.t5d}get Mva(){return this.cqg}get qna(){return this.Zvg}get KFa(){return this.Ckg}get b5h(){return this.tpg}get UHj(){return this.Wwg}get Hmi(){return!0}get NHj(){return this.Rwg}get vwj(){return this.Ffe}Wtj(Qb){this.Ffe=
Qb}get tellMeInSharedHeaderIsEnabled(){return this.Owg}get wMb(){return this.Pwg}get vMb(){return this.Nwg}get fetchTokensForSearch(){return this.eog}get LHj(){return this.Qwg}get hWd(){return!1}get QEb(){return this.Qsg}get fBd(){return this.Osg}get gBd(){return this.Psg}get Mwa(){return!1}get Ygc(){return!1}get Opd(){return this.crg}get EQd(){return this.Bvg}get Vcb(){return!1}get xxj(){return!1}get Lqi(){return""}get XTh(){return 4}get YTh(){return 5}get dWh(){return""}get XMh(){return this.Tog}get E1e(){return this.Yog}get fWh(){return 1E3}get eWh(){return 1E-6}get YFj(){return this.vwg}get xTd(){return!1}get XFj(){return!1}get cli(){return this.Vqg}get ppd(){return!1}get qpd(){return!1}get Iii(){return!1}get Hii(){return!1}get Kgf(){return!1}get Ngf(){return!1}get QRe(){return!1}get Mcb(){return!1}get Scb(){return!1}get Tcb(){return!1}get Ucb(){return!1}get Xcb(){return!1}get VKb(){return this.rvg}get Ocb(){return this.svg}get UKb(){return!1}get JWe(){return null}get mpd(){return!1}get kwc(){return this.yvg}get o_e(){return 0}get zJh(){return this.Pog}get V1e(){return this.$og}get Uli(){return this.arg}get OZe(){return-3.9}get yy(){return this.Svg}get Lzb(){return this.krg}get god(){return this.Lqg}get Ypd(){return this.hrg}get Cra(){return this.Dkg}get boi(){return this.org}get I3(){return this.mpg}get n4f(){return this.Wvg}get LOg(){return this.nlg}get kBc(){return this.Gxg}get cec(){return this.lqg}get qdi(){return this.pqg}get rli(){return this.Yqg}get dWf(){return this.Yug}get oHg(){return this.bkg}get Ll(){return this.Xog}get Nwa(){return this.jrg}get odi(){return this.nqg}get pdi(){return this.oqg}get ndi(){return this.mqg}get yne(){return this.ckg}get zne(){return this.dkg}get pK(){return!!c.AFrameworkApplication.ta&&
c.AFrameworkApplication.ta.Oa.Ji}get Ji(){return!!c.AFrameworkApplication.ta&&c.AFrameworkApplication.ta.Oa.Ji}get Tii(){return!!c.AFrameworkApplication.ta&&c.AFrameworkApplication.ta.Oa.Xwj}get rrf(){return Pb.getImageClass("OfficeAssistant_32x32x32")}rNh(){return Promise.reject("GetFindMatchCount method is not overridden")}jhc(Qb){return Array.contains(appChrome.selectors.getVisibleControlIds(),Qb)}Gec(){return!1}get Snd(){return!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeModelRankerEnabled")}get l8f(){return c.AFrameworkApplication.fa?
c.AFrameworkApplication.fa.Va("TellMeServiceHelpClassifierModelName"):""}get Xnd(){return!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeMultiLingualCommandModelEnabled")}get Vhd(){return"NoOpHeaderUi"}get PAe(){return this.uQb}get parameterData(){return this.SDa}get qNj(){return this.Sqa}elh(){if(this.Ifb&&!this.y0d&&(this.y0d=!0,this.G_f(this.Ifb),this.Ji)){var Qb=F.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");Qb=(new Jb.a(Qb)).S2a(this.Ifb.aj);appChrome.api.dispatch(Qb)}}get kWf(){return""}cVe(){throw Error.notImplemented();
}G_f(){}Vdh(Qb){const wb=[];for(let hc=0;hc<Qb.length;++hc)Qb[hc].hyj?wb.push(new Ja.a(Qb[hc].HIg,lb.a.fag+hc.toString())):wb.push(new Ja.a(Qb[hc].standard,lb.a.Gzc+hc.toString()));return wb}egj(Qb){var wb=window.TellMeAdditionalControls;if(wb&&Qb){Qb.QSf(wb);this.Ifb=this.cVe();Qb=wb.children;for(const hc of Qb)this.Ifb.cke(hc.attrs.Id,hc)}}igj(Qb){const wb=this.PAe;for(let hc in wb)Qb.kgj(wb[hc])}H9h(Qb){const wb={};for(let hc in Qb){const Za=hc,ub=Qb[hc];for(let uc in ub){const Oc=uc,Bb=ub[uc];
(wb[Oc]||(wb[Oc]={}))[Za]=Bb}}this.uQb=wb}get n8f(){return""}get m8f(){return""}get b3f(){return!1}}Object(d.a)(Lb,"TellMeApplicationData",null,[613]);class Ab{constructor(Qb,wb=null,hc=!1){this.standard=Qb;this.HIg=wb;this.hyj=hc}}Object(d.a)(Ab,"TryQuerySet",null,[]);var nb=a(1350),va=a(1007),db=a(245),Xa=a(35);class gb{}gb.T6h={["faShare_FriendlyLabel"]:0,["Jewel_Close_FriendlyLabel"]:1,["Alignment_AlignCenter_FriendlyLabel"]:2,["Cells_Insert_FriendlyLabel"]:3,["Cells_Delete_FriendlyLabel"]:4,
["Tables_Table_FriendlyLabel"]:5,["Apps_AppsForOffice_FriendlyLabel"]:6,["Charts_InsertColumn_FriendlyLabel"]:7,["Charts_InsertLine_FriendlyLabel"]:8,["Charts_InsertPie_FriendlyLabel"]:9,["Charts_InsertBar_FriendlyLabel"]:10,["Charts_InsertArea_FriendlyLabel"]:11,["Charts_InsertScatter_FriendlyLabel"]:12,["Charts_InsertOther_FriendlyLabel"]:13,["Picture_InsertPictures_Local_FriendlyLabel"]:14,["Links_Hyperlink_FriendlyLabel"]:15,["Comments_CommentInsert_FriendlyLabel"]:16,["Update_RefreshSelectedConnection_FriendlyLabel"]:17,
["Update_RefreshAllConnections_FriendlyLabel"]:18,["Update_PivotTableChangeDataSource_FriendlyLabel"]:19,["Actions_MovePivotTable_FriendlyLabel"]:20,["PivotTableStyleOptions_PivotTableRowHeaders_FriendlyLabel"]:21,["PivotTableStyleOptions_PivotTableColumnHeaders_FriendlyLabel"]:22,["PivotTableStyleOptions_PivotTableBandedRows_FriendlyLabel"]:23,["PivotTableStyleOptions_PivotTableBandedColumns_FriendlyLabel"]:24,["Show_PivotTableShowFieldList_FriendlyLabel"]:25,["Show_PivotTableShowSettings_FriendlyLabel"]:26,
["Show_PivotTableShowExpandButton_FriendlyLabel"]:27,["ChartData_SwitchRowCol_FriendlyLabel"]:28,["ChartData_EditData_FriendlyLabel"]:29,["Charts_Change_Column_FriendlyLabel"]:30,["Charts_Change_Line_FriendlyLabel"]:31,["Charts_Change_Pie_FriendlyLabel"]:32,["Charts_Change_Bar_FriendlyLabel"]:33,["Charts_Change_Area_FriendlyLabel"]:34,["Charts_Change_Scatter_FriendlyLabel"]:35,["Charts_Change_Other_FriendlyLabel"]:36,["Labels_Legend_FriendlyLabel"]:37,["Labels_DataLabels_FriendlyLabel"]:38,["Labels_DataTable_FriendlyLabel"]:39,
["Axes_Axes_FriendlyLabel"]:40,["Axes_Gridlines_FriendlyLabel"]:41,["ChartTaskpane_Format_FriendlyLabel"]:42,["ChartFormat_Fill_FriendlyLabel"]:43,["ChartFormat_Outline_FriendlyLabel"]:44,["Automatic_FriendlyLabel"]:45,["AutoSum_Max_FriendlyLabel"]:46,["AutoSum_Min_FriendlyLabel"]:47,["AxisTitle_Horizontal_None_FriendlyLabel"]:48,["AxisTitle_Vertical_None_FriendlyLabel"]:49,["ChartTitle_Centered_FriendlyLabel"]:50,["ChartTitle_None_FriendlyLabel"]:51,["DataTable_None_FriendlyLabel"]:52,["Insert_Tables_Form_FriendlyLabel"]:53,
["Jewel_DownloadCopy_FriendlyLabel"]:54,["Jewel_DownloadAsOds_FriendlyLabel"]:55,["Jewel_Embed_FriendlyLabel"]:56,["Jewel_NewBlank_FriendlyLabel"]:57,["Jewel_PreviousVersions_FriendlyLabel"]:58,["Jewel_Share_FriendlyLabel"]:59,["Legend_None_FriendlyLabel"]:60,["Number_NumberFormatAccounting_FriendlyLabel"]:61,["Number_NumberFormatCurrency_FriendlyLabel"]:62,["Number_NumberFormatFraction_FriendlyLabel"]:63,["Number_NumberFormatGeneral_FriendlyLabel"]:64,["Number_NumberFormatLongDate_FriendlyLabel"]:65,
["Number_NumberFormatNumber_FriendlyLabel"]:66,["Number_NumberFormatPercentage_FriendlyLabel"]:67,["Number_NumberFormatScientific_FriendlyLabel"]:68,["Number_NumberFormatShortDate_FriendlyLabel"]:69,["Number_NumberFormatText_FriendlyLabel"]:70,["ShapeStyles_ShapeMoreStyles_FriendlyLabel"]:71,["Number_NumberFormatTime_FriendlyLabel"]:72,["Ewr_FindInWorksheetDialogTitle"]:73,["Ewr_Ribbon_Insert_Function"]:74,["Jewel_RenameFileDialog_FriendlyLabel"]:75,["TableStyles_TableMoreStyles_FriendlyLabel"]:76,
["Ewr_SpellCheckUpSell"]:77,["Ewr_MacrosUpSell"]:78,["Ewr_PivotTableUpSell"]:79,["Ewr_HeaderFooterUpSell"]:80,["Ewr_DeskTopFeature"]:81,["Ewr_OpenInDesktopExcel"]:82,["Ewr_OpenInDesktopDescription"]:83,["Ewr_DesktopUpSellTitle"]:84,["Ewr_DesktopUpSellDescription"]:85,["Tables_PivotTable_FriendlyLabel"]:86,["Ewr_Cell_Styles"]:87};Object(d.a)(gb,"TellMeStringMapping",null,[]);class Ha{constructor(){this.y_a=vb.a.current.D8e||[]}kgj(Qb){for(let hc in Qb){var wb=hc;this.xZb(Qb,wb);Ha.oqe(Qb,wb)}}QSf(Qb){var wb=
Ha.PJa(Qb);for(let ub in wb){var hc=ub,Za=wb[ub];void 0!==Za&&null!==Za&&(Ha.oqe(wb,hc),this.xZb(wb,hc))}Qb=Ha.ro(Qb);for(wb=0;wb<Qb.length;wb++)this.QSf(Qb[wb])}xZb(Qb,wb){if(Qb[wb]){let hc=Qb[wb].toString();for(let Za=0,ub=this.y_a.length;Za<ub;Za++)if(this.y_a[Za].SubstitutionToken){let uc=Xa.a.Dc(Ha.Epb,this.y_a[Za].ImageName);uc||(uc=new RegExp(this.y_a[Za].SubstitutionToken,"g"),Ha.Epb[this.y_a[Za].ImageName]=uc);hc=hc.replace(uc,this.y_a[Za].ImagePath)}Qb[wb]=hc}}static PJa(Qb){return Qb.attrs}static ro(Qb){Qb=
Qb.children;return void 0===Qb||null===Qb?[]:Qb}static oqe(Qb,wb){if(Qb[wb]){var hc=Qb[wb].toString(),Za=hc.split(".");if(2===Za.length&&"TellMeStringId"===Za[0])if(hc=gb.T6h[Za[1]],Za=_EwaS.TellMeStringManagerData.BootstrapStringDictionary[wa.a.urb].UnencodedStrings){if(0>hc||hc>=Za.length)throw Error.argumentOutOfRange("Could not find resource with id "+hc);hc=Za[hc]}else throw Error.invalidOperation("String dictionary could not be loaded");Qb[wb]=hc}}}Ha.Epb={};Object(d.a)(Ha,"EwaResolver",null,
[612,611]);class tb{constructor(){this.oae=this.pae=null}get tAi(){return this.oae}HP(Qb){this.pae=Qb;return this.$6g(Qb)}dDi(){this.oae=this.pae}XPh(Qb){return 8===Qb.type?String.format(CommonUIStrings.l_FindInDocumentText,Qb.Kz):Qb.Kz}aKh(Qb){return Qb.Kz}}Object(d.a)(tb,"ParameterizedCommand",null,[]);var bc=a(308);class tc extends tb{constructor(Qb){super();this.isReactRibbonEnabled=Qb}get commandId(){return this.isReactRibbonEnabled?"FindParameterized":"Editing.Find"}get vVi(){return"Find"}$6g(Qb){const wb=
H.a.gf(String.format(wa.a.instance.Xa(423),Qb.Kz));return bc.a(lb.a.K$g(Qb.value),"1540292897",wb,"find16",null,H.a.gf(Qb.Kz),wb,null,null)}}Object(d.a)(tc,"FindParameterizedCommand",tb,[]);class Ma extends Lb{constructor(Qb){super(window.TellMeControlMetadataOverrides);this.jUa="Excel";this.ZUb="-1376725189";this.YUb="-1386334072";const wb=new Ha;this.igj(wb);var hc=new tc(this.Ji);this.parameterData[hc.commandId]=hc;c.AFrameworkApplication.fa.qa("TellMeTryQueriesIsEnabled")&&(hc=[new Ab(wa.a.instance.Xa(418),
"",!1),new Ab(wa.a.instance.Xa(419),"",!1),new Ab(wa.a.instance.Xa(420),"",!1),new Ab(wa.a.instance.Xa(421),"",!1),new Ab(wa.a.instance.Xa(422),"",!1)],this.Sqa=this.Vdh(hc));this.egj(wb);c.AFrameworkApplication.fa.qa("TellMeFindInDocumentIsEnabled")&&(this.t5d=!0,this.s5d=this.Ji?"FindParameterized":"EditingFind");this.$=Qb}get lQa(){return db.a.DIb}get rrf(){return Pb.getImageClass("OfficeAssistant_32x32x32")}cVe(){const Qb=new nb.a;return new va.a("TellMeRoot",Qb)}G_f(Qb){const wb=c.AFrameworkApplication.fa.qa("TellMeDesktopUpSellIsEnabled")&&
c.AFrameworkApplication.fa.qa("TellMeDesktopUpSellInExcel"),hc=c.AFrameworkApplication.Imi;Qb=Qb.aj;Qb.MacrosUpSellButton=!wb||hc;Qb.HeaderFooterUpSellButton=!wb||hc;Qb.MacrosUpSellButtonEnterprise=!wb||!hc;Qb.HeaderFooterUpSellButtonEnterprise=!wb||!hc}get Kgf(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.NotesSuggestionIsEnabled",!1)}get Ngf(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ZeroTermNotesSuggestionIsEnabled",
!1)}get o_e(){return c.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.Excel.TellMe.NumberOfNotesSuggestionsToShow",2)}get n8f(){return c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.Excel.TellMe.ZeroTermModelName","")}get m8f(){return c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.Excel.TellMe.MultiLanguageModelName","")}get xTd(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ServiceAADAuthIsEnabled",!1)}get l8f(){return c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.Excel.TellMe.HelpClassifierModelName",
"")}get Vcb(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ShowImageSearchResults",!1)}get Xnd(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.MLCModelIsEnabled",!1)}get b3f(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ShowMoreFileResults",!1)}get Ygc(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.EnableRankerLogging",!1)}get OZe(){var Qb=
c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.Excel.TellMe.NBClassifierScoreThreshold","-7.0");Qb=parseFloat(Qb);return isNaN(Qb)?-7:Qb}get yne(){let Qb=!1;this.$&&(Qb=!m.EwaSettings.ma(186)&&this.$.ea.Tg.get(27)&&this.$.p9);return Qb}get zne(){let Qb=!1;this.$&&(Qb=this.$.me.get(35));return Qb}}Object(d.a)(Ma,"ExcelTellMeApplicationData",Lb,[]);class Tb{constructor(Qb){this.commandUIManager=null;this.fHi=wb=>{this.commandUIManager=wb;yb.a(this.Jc).hFa(this.Uba)};this.Uba=()=>
{this.commandUIManager=this.Jc.da.za(53)};this.Jc=Qb;this.Jc.da.Za(53,this.fHi)}Nc(){return!1}executeCommand(Qb,wb,hc){Qb=0;switch(wb.command){case -1642491107:Qb=w.a.tellMe;break;case -240091811:Qb=w.a.tellMeAccessibilityMenuText;break;case -1543335331:Qb=w.a.tellMeCacheAsyncMenuRefresh;break;case 815990803:Qb=w.a.tellMeFocusInput;break;case 586156566:Qb=w.a.tellMeInteractionBegin;break;case -1051173363:Qb=w.a.tellMeRestoreFocus;break;case 878547493:Qb=w.a.tellMeLogCommandExecuted;break;case 1024534176:Qb=
w.a.tellMeLogInputBlur;break;case -1991747669:Qb=w.a.tellMeLogInputFocus;break;case -28797232:Qb=w.a.tellMeLogMenuClose;break;case -1814078912:Qb=w.a.tellMeLogMenuOpen;break;case 1404166600:Qb=w.a.tellMeTryQuery;break;case -2064212100:Qb=w.a.tellMeFeedback}let Za=0;Qb&&(Za=c.AFrameworkApplication.wb.de(Qb,2,hc),this.MTj());x.ULS.sendTraceTag(537151007,0,50,`TellMeCommandHandler.ExecuteCommand: ActionId (${Qb}) , response (${Za})`);return Qb&&2!==Za?r.Task.Ta(!0):v.a(wb.command)}Cc(Qb,wb){Qb=!1;switch(wb.command){case -1642491107:case -240091811:case -1543335331:case 815990803:case 586156566:case 878547493:case 1024534176:case -1991747669:case -28797232:case -1814078912:case 1404166600:case -2064212100:Qb=
!0}return Qb}Rc(Qb,wb,hc){"PopulateTellMe"===wb&&c.AFrameworkApplication.wb.de(w.a.tellMe,2,hc);return!1}dispose(){!!this.Jc&!!yb.a(this.Jc)&&yb.a(this.Jc).RPa(this.Uba);this.commandUIManager=null}MTj(){!m.EwaSettings.ma(23)&&this.commandUIManager&&this.commandUIManager.ecg("sbTellMe",!1)}static initData(Qb){Qb=new Ma(Qb);Oa.TellMeActor.instance.initialize(Qb,null,null,null,null,null,Ob.a.fC.fBa,c.AFrameworkApplication.fa,F.a.instance.Wb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
null,F.a.instance.Wb("Common.ISystemInitiatedFeedback"));Oa.TellMeActor.instance.Gg()}}Object(d.a)(Tb,"TellMeCommandHandler",null,[195,2]);class zb extends f.a{constructor(Qb){super(Qb)}yd(){const Qb=[];var wb=vb.a.loadScript(90,4,this.hb,void 0,void 0,108);const hc=vb.a.loadScript(c.AFrameworkApplication.ta.Oa.Jgf?94:93,4,this.hb,void 0,void 0,108);Qb.push(wb);Qb.push(hc);wb=!1;(wb=c.AFrameworkApplication.fa.qa("TellMeIsSuggestionsForSimplifiedUxEnabled"))&&Qb.push(vb.a.loadScript(95,4,this.hb,void 0,
void 0,108));wb=!1;(wb=c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterAgaveCommandManagerForTellMeAddinSearch",!1))&&Qb.push(qa.GetServiceTaskFactory.Ra(this.$.da,374,375,1));O.TaskExtensions.Aa(r.Task.zL(...Qb),()=>{m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.InitTellMeApplicationDataWithEwaControl",!1)?Tb.initData(this.$):Tb.initData();this.gd([new Tb(this.$)])},this.la,3)}static ka(Qb){f.a.Nd(108,new zb(Qb))}}Object(d.a)(zb,"TellMeCommandHandlerFactory",
f.a,[]);var ic=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]};Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ConditionalFormatting");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.NumberFormat");Type.registerNamespace("_Ewa");
Type.registerNamespace("Common.App.Assistance");c.AFrameworkApplication.XYa&&(b.a.instance.yi(new V),W.a.Fa(y.ka));Type.registerNamespace("NLRT");da.a.Hi('.NumberFormatStyleItem{color:#444;font:inherit}.NumberFormatStyleItem select,.NumberFormatStyleItem input{margin-bottom:1.5%}.NumberFormatCategoryList{width:22%;height:50%;margin-bottom:20%;height:65%}.NumberFormatRtlFloat{float:right}.NumberFormatLtrFloat{float:left}.NumberFormatDynamicList{width:70%;height:70%}.NumberFormatDynamicListRtlMargin{margin-right:3%}.NumberFormatDynamicListLtrMargin{margin-left:3%}.NumberFormatDlgFunctionBody{margin:0 13px 10px 13px;width:100%;height:346px}.NumberFormatDlgWidth{width:560px}.NumberFormatDlgBodyWidth{width:560px}.NumberFormatDescriptionItem{height:32%;width:95%;position:relative;top:4%;z-index:-1}.NumberFormatLinkItem{margin-bottom:6px;display:inline-block}.NumberFormatRtlLabelItem{margin-left:2%}.NumberFormatLtrLabelItem{margin-right:2%}.NumberFormatSampleItem{width:100%;background-color:#fff}.NumberFormatDynamicListItemWidth{width:100%;font:inherit}.NumberFormatCategoryListItemWidth{width:100%;font:inherit}.NumberFormatCategoryListItemHeight{max-height:325px}.NumberFormatSymbolItemWidth{width:100%}.NumberFormatItemColorStyle{color:#f00}.NumberFormatFocusCheckbox{outline:none}.NumberFormatBorderLabel{border:1px #808080 dashed}.NumberFormatFontLabel{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif}.NumberFormatSelectionBorder{border:1px solid #a9a9a9}');
W.a.Fa(fb.ka);W.a.Fa(fa.ka);sb;da.a.Hi('.ewa-condfmt-dlg-err-label{width:400px;min-height:21px;margin-bottom:-15px;font-size:8pt;color:#d90000}.ewa-condfmt-dlg-header-label{font-weight:bold}.ewa-condfmt-dlg-with-label{padding-left:3px;padding-right:3px}.ewa-condfmt-dlg-list{width:auto;width:initial}.ewa-condfmt-dlg-input{width:auto;width:initial;padding-left:3px}.CondtionalFormattingPane{background:#edebe9;height:100%;overflow:hidden;display:flex;flex-direction:column}.CondtionalFormattingPaneHeader{position:relative;overflow:hidden;padding:16px 16px 16px 16px}.CondtionalFormattingPaneBody{flex:auto;position:relative}.CondtionalFormattingPaneTitle{position:relative !important;max-width:230px;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:normal;background:#edebe9;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.CondtionalFormattingCloseButton{display:inline-block;padding:0 5px;font-size:16px}');
(()=>{W.a.Fa(Qb=>{Sa.ka(Qb);ab.ka(Qb)})})();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");W.a.Fa(zb.ka);Type.registerNamespace("Common.App.Assistance");ic},694:function(t,C,a){a.r(C);t=a(0);var c=a(412),b=a(715),d=a(701),f=a(913),e=a(914);class k{constructor(m,v){this.Kpa=!1;this.QQ=null;if(!m)throw Error.argumentNull("annotations");if(!m.Z6a(v))throw Error.argument("structTypeID",
"Invalid struct type ID");this.Pl=m;this.$7a=this.Pl.l_e(v);this.pwg=v}get HYa(){return this.Pl}get isReadOnly(){return this.Kpa}get Eda(){return this.pwg}Jua(m){if(0>m||m>=this.$7a)throw Error.argument("iField","Invalid field index");return this.QQ&&null!=this.QQ[m]?this.QQ[m]:this.Pl.Q1e(this.Eda,m)}INd(m,v){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>m||m>=this.$7a)throw Error.argument("iField","Invalid field index");if(!this.Pl.Z5a(this.Pl.aKa(this.Eda,
m),v))throw Error.argument("value","Value is not of the correct type for the specified field");(this.QQ||(this.QQ=Array(this.$7a)))[m]=v}AO(){const {Annotations:m}=a(694);let v="[";if(this.QQ){let n=!0;for(let w=0;w<this.$7a;++w){if(null==this.QQ[w])continue;const r=this.Pl.aKa(this.Eda,w);if(m.vBa(r,this.QQ[w],this.Pl.Q1e(this.Eda,w)))continue;n?n=!1:v+=", ";v+=this.Pl.R1e(this.Eda,w);v+="=";const u=this.Pl.AO(r,this.QQ[w]);r===m.tL?(v+='"',v+=b.a.O7c(u),v+='"'):v+=u}}return v+"]"}isEqual(m){const {Annotations:v}=
a(694);if(this===m)return!0;if(!m||this.Pl!==m.HYa||this.Eda!==m.Eda)return!1;for(let n=0;n<this.$7a;++n)if(!v.vBa(this.Pl.aKa(this.Eda,n),this.Jua(n),m.Jua(n)))return!1;return!0}clone(){const m=new k(this.Pl,this.Eda);this.QQ&&(m.QQ=Array.clone(this.QQ));return m}QA(){return this.isReadOnly?this.clone():this}Hsd(){const {Annotations:m}=a(694);if(!this.isReadOnly&&(this.Kpa=!0,this.QQ))for(let v=0;v<this.$7a;++v){const n=this.QQ[v];null!=n&&m.cNa(n)}}toString(){return this.AO()}}Object(t.a)(k,"StructValue",
null,[710,707]);a.d(C,"Annotations",function(){return l});class l{constructor(m,v){if(!m)throw Error.argumentNull("initData");if(!v)throw Error.argumentNull("objectFetcher");this.mwi=v.bhh;let n=0;var w=v.zua(m.na(n));++n;this.vud=new f.a(new e.a(w));this.Nng=m.na(n);++n;this.Wmf=Array(this.N6b);this.MBb=Array(this.N6b);this.nxa=Array(this.N6b);for(w=0;w<this.N6b;++w){this.Wmf[w]=v.ga(m.na(n));++n;this.MBb[w]=m.na(n);++n;var r=m.na(n);++n;this.nxa[w]=Array(r);for(var u=0;u<r;++u)this.nxa[w][u]=v.ga(m.na(n)),
++n}this.owg=m.na(n);++n;this.Snf=Array(this.VLb);this.yjc=Array(this.VLb);this.zjc=Array(this.VLb);this.xjc=Array(this.VLb);for(w=0;w<this.VLb;++w)for(this.Snf[w]=v.ga(m.na(n)),++n,r=m.na(n),++n,this.yjc[w]=Array(r),this.zjc[w]=Array(r),this.xjc[w]=Array(r),u=0;u<r;++u)this.yjc[w][u]=v.ga(m.na(n)),++n,this.zjc[w][u]=m.na(n),++n,this.xjc[w][u]=({pQ:n}=this.KHa(this.zjc[w][u],m,n,null,null,null)).returnValue,l.cNa(this.xjc[w][u]);this.Qkg=m.na(n);++n;this.Ttd=Array(this.eZa);this.Utd=Array(this.eZa);
this.Std=Array(this.eZa);for(w=0;w<this.eZa;++w)this.Ttd[w]=v.ga(m.na(n)),++n,this.Utd[w]=m.na(n),++n,this.Std[w]=({pQ:n}=this.KHa(this.Utd[w],m,n,null,null,null)).returnValue,l.cNa(this.Std[w])}dub(m){for(let v=0;v<this.eZa;++v)if(this.Ttd[v]===m)return v;return-1}xVe(m){if(!this.X6a(m))throw Error.argument("attrID","Invalid attribute ID");return this.Ttd[m]}getAttributeType(m){if(!this.X6a(m))throw Error.argument("attrID","Invalid attribute ID");return this.Utd[m]}aKa(m,v){if(!this.Z6a(m))throw Error.argument("structTypeID",
"Invalid struct type ID");m=this.zjc[l.WLb(m)];if(0>v||v>=m.length)throw Error.argument("iField","Invalid field index");return m[v]}AO(m,v){if(!this.rqd(m))throw Error.argument("typeID","Invalid type ID");if(!this.Z5a(m,v))throw Error.argument("value","Value is not of the correct type");switch(m){case l.tL:return v;case l.r0:return v?"True":"False";case l.h7:case l.AW:return v.toString();case l.JB:return v.AO();default:if(!l.zt(m)&&l.mNb(m)){m=l.C7c(m);const r=this.nxa[m].length;switch(this.MBb[m]){case 0:return this.nxa[m][v];
case 1:if(v){var n="";for(var w=1;w<r;++w)v&1<<w-1&&(0<n.length&&(n+=" & "),n+=this.nxa[m][w]);return n}return this.nxa[m][0];case 2:n="";for(w=0;w<r;++w)v&1<<w&&(0<n.length&&(n+=" & "),n+=this.nxa[m][w]);return n;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.MBb[m]);}}else return v.AO()}}rqd(m){switch(m){case l.tL:case l.r0:case l.h7:case l.AW:case l.JB:return!0;default:return l.zt(m)?this.rqd(l.aja(m)):l.mNb(m)?this.rni(m):this.Z6a(m)}}rni(m){m=l.C7c(m);return 0<=m&&
m<this.Wmf.length}Z6a(m){m=l.WLb(m);return 0<=m&&m<this.Snf.length}X6a(m){return 0<=m&&m<this.eZa}Z5a(m,v){if(null==v)return!1;switch(m){case l.tL:return"string"===typeof v;case l.r0:return"boolean"===typeof v;case l.h7:return"number"===typeof v;case l.AW:return"number"===typeof v;case l.JB:return Object(c.a)(706,v);default:if(l.zt(m))return Object(c.a)(709,v)&&v.bI===l.aja(m);if(l.mNb(m)){if("number"!==typeof v)return!1;m=l.C7c(m);const n=this.nxa[m].length;switch(this.MBb[m]){case 0:return 0<=v&&
v<n;case 1:return!(v&-1<<n-1);case 2:return!!v&&!(v&-1<<n);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.MBb[m]);}}else return Object(c.a)(710,v)&&v.Eda===m}}get eZa(){return this.Qkg}get N6b(){return this.Nng}get VLb(){return this.owg}wHh(m){if(!this.X6a(m))throw Error.argument("attrID","Invalid attribute ID");return this.Std[m]}l_e(m){if(!this.Z6a(m))throw Error.argument("structTypeID","Invalid struct type ID");return this.yjc[l.WLb(m)].length}R1e(m,v){if(!this.Z6a(m))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.yjc[l.WLb(m)][v]}Q1e(m,v){if(!this.Z6a(m))throw Error.argument("structTypeID","Invalid struct type ID");m=this.xjc[l.WLb(m)];if(0>v||v>=m.length)throw Error.argument("iField","Invalid field index");return m[v]}KHa(m,v,n,w,r,u){if(!v)throw Error.argumentNull("initData");if(l.zt(m)){var y=v.na(n);++n;m=l.aja(m);var x=new d.a(this,m);for(var B=0;B<y;++B)Array.add(x.items,({pQ:n}=this.KHa(m,v,n,w,r,u)).returnValue);return{returnValue:x,pQ:n}}switch(m){case l.tL:return{returnValue:(w||
this.vud).ga(v.na(n++)),pQ:n};case l.r0:return{returnValue:1===v.na(n++),pQ:n};case l.h7:return{returnValue:v.na(n++),pQ:n};case l.AW:return{returnValue:(r||this.mwi)[v.na(n++)],pQ:n};case l.JB:m=v.na(n++);y=new b.a(this);for(x=0;x<m;++x)B=v.na(n),++n,u&&(B=u[B]),y.yn(B,({pQ:n}=this.KHa(this.getAttributeType(B),v,n,w,r,u)).returnValue);return{returnValue:y,pQ:n};default:if(l.mNb(m))return{returnValue:v.na(n++),pQ:n};if(l.sag(m)){y=v.na(n++);x=new k(this,m);for(B=0;B<y;++B){const z=v.na(n);++n;x.INd(z,
({pQ:n}=this.KHa(this.aKa(m,z),v,n,w,r,u)).returnValue)}return{returnValue:x,pQ:n}}throw Error.argument("typeID","Invalid type ID");}}static mNb(m){return 16<=(m&16383)&&16384!==(m&16384)&&32768!==(m&32768)}static sag(m){return 16<=(m&16383)&&16384===(m&16384)&&32768!==(m&32768)}static zt(m){return 32768===(m&32768)}static yQh(m){if(l.zt(m))throw Error.argument("nonListTypeID","Non-list type ID required");return m|32768}static aja(m){if(!l.zt(m))throw Error.argument("listTypeID","List type ID required");
return m&-32769}static vBa(m,v,n){switch(m){case l.tL:case l.r0:case l.h7:case l.AW:return v===n;case l.JB:return v.isEqual(n);default:return l.zt(m)?v.isEqual(n):l.mNb(m)?v===n:v.isEqual(n)}}static cNa(m){Object(c.a)(707,m)&&m.Hsd()}static QA(m){return Object(c.a)(707,m)?m.QA():m}static C7c(m){return m-16}static WLb(m){return(m&-16385)-16}}l.tL=1;l.r0=2;l.h7=3;l.AW=5;l.JB=9;Object(t.a)(l,"Annotations",null,[711])},698:function(t,C,a){t=a(0);var c=a(328);class b{constructor(){this.userId=this.email=
this.displayName=null}}Object(t.a)(b,"InsertMentionParameters",null,[]);class d{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(t.a)(d,"InsightsParameters",null,[]);var f=a(1091),e=a(1092),k=a(1093),l=a(1094),m=a(4);class v{constructor(){this.currentDocumentPath=m.AFrameworkApplication.fa.Va("EditDocInClientUrl")}}Object(t.a)(v,"SmartLookupApplicationInterface",null,[]);class n{}Object(t.a)(n,"SmartLookupSelection",null,[]);var w=a(41),r=a(27),u=a(30),y=a(692);
a.d(C,"a",function(){return x});class x{static get pbi(){return"Insights_16x16x32"}static get Nzh(){return"Find_16x16x32"}static get kFf(){return"-Parameterized"}static get NRd(){return"Parameterized"}static get Gzc(){return"bTryQuery"}static get xWd(){return"TellMeSuggestion_"}static get fag(){return"bTryQueryAlternate"}static get rUd(){return"MenuTellMe"}static get MWi(){const B={},z=[];Array.add(z,{Term:{PeopleType:"Person"}});B.And=z;return B}static K$g(B){return B+x.kFf}static getParameter(B){let z=
"",A="";if(B)for(let I=0;I<B.$Qe;++I)"Type"===B.AJa(I)?z=B.eva(I):"Value"===B.AJa(I)&&(A=B.eva(I));return new c.a(z,A)}static j3c(B){B=Object.assign(new d,{neighborhood:B,mentionStart:0,mentionLength:B.length});return w.c(B)}static MDe(B,z,A){B=Object.assign(new b,{displayName:B,email:z,userId:A});return w.c(B)}static Ksa(B,z,A=null){B=Object.assign(new n,{neighborhood:B,mentionStart:0,mentionLength:B?B.length:0});z=Object.assign(new v,{selection:B,userIntent:null,entryPoint:z,launchData:A});return w.c(z)}static Pgj(B,
z){return x.Ksa(B,x.Qgj(z))}static Qgj(B){switch(B){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;default:return 0}}static Kcf(){return!!m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.qa("IsGoLocalEnvironment")}static jMa(){const B=m.AFrameworkApplication.fa?m.AFrameworkApplication.fa.Va("SovereignEnvironmentName"):null;return!!B&&0<B.length}static isEnterpriseUser(){const B=m.AFrameworkApplication.fa?
m.AFrameworkApplication.fa.Va("HostAuthType"):null;return!!B&&"aad"===B.toLowerCase()||"external"===B&&x.jmd()}static ZPd(B){return B.NHj&&!x.jMa()}static Nff(){const B=m.AFrameworkApplication.fa?m.AFrameworkApplication.fa.Va("UiHostIntegrationType"):"";return!!m.AFrameworkApplication.fa&&"UnifiedUiHostTeams"===B&&m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",!1)}static YPd(B){return B.tellMeInSharedHeaderIsEnabled&&B.fetchTokensForSearch&&
(B.wMb||B.vMb||B.Nwa)&&!x.Nff()&&x.isEnterpriseUser()&&!x.jMa()}static x4(){return m.AFrameworkApplication.fa?m.AFrameworkApplication.qna||m.AFrameworkApplication.fa.qa("SmartLookupEnableNativePane"):m.AFrameworkApplication.qna}static cD(B){return!B||x.tgf(B.Hd)}static tgf(B){return!B||!B.trim().length}static jWd(B){if(!B)return 0;const z=Math.pow(10,5);return Math.round(B*z)/z}static toUtc(B){return B?new Date(B.getUTCFullYear(),B.getUTCMonth(),B.getUTCDate(),B.getUTCHours(),B.getUTCMinutes(),B.getUTCSeconds(),
B.getUTCMilliseconds()):null}static Lfd(B){B=new Date(B);return(x.toUtc(new Date).getTime()-B.getTime())/1E3}static Igf(B){const {InsightsMenuItemFactory:z}=a(1090);switch(B){case f.a.did:case e.a.sSe:case z.n$e:case k.a.qrf:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "LaunchAddinDialogFromTellMe":return!0}return B.startsWith(x.Gzc)||
B.startsWith(x.xWd)||B.startsWith(x.fag)||B.startsWith("PeopleSuggestion")||B.startsWith("FileSuggestion")||B.startsWith("FindInDocumentSuggestion")||B.startsWith("NotesSuggestion")||B.startsWith("OnenoteNotesSuggestion")||B.startsWith("SmartLookupFromTellMe")||B.startsWith("GetHelpFromTellMe")||B.startsWith("GetHelpWithDescriptionFromTellMe")||B.startsWith("AddinSuggestion")||B.startsWith("OfficeScripts")?!0:!1}static ldd(B,z){const A=[];Array.add(A,new l.a(400,B));Array.add(A,new l.a(200,z));B=
{};B.parts=A;return JSON.stringify(B)}static xua(B){const z=B.indexOf("<b0>"),A=B.lastIndexOf("</b0>"),I=[];Array.add(I,new l.a(400,B.substring(0,z)));Array.add(I,new l.a(600,B.substring(z+4,A)));Array.add(I,new l.a(400,B.substring(A+5,B.length)));B={};B.parts=I;return JSON.stringify(B)}static m2e(B){const z=x.Lfd(B);return 60>z?CommonUIStrings.l_TimeSince_SecsAgo:3600>z?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(z/60).toString()):86400>z?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(z/3600).toString()):172800>z?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(B)).localeFormat("MMMM dd, yyyy"))}static VJh(B){const z=Array(B.length);for(let A=0;A<B.length;A++)z[A]=B[A].commandId;return z}static jmd(){if("Dev Box"===m.AFrameworkApplication.fa.Va("StatusBarEnvironmentNameToUse"))return!0;let B=m.AFrameworkApplication.fa.Va("UserPrincipalName");B=y.c(B)?"":u.a.ll(B);const z=m.AFrameworkApplication.fa.lo("TellMeIntEnabledForFeatureCrew")?
m.AFrameworkApplication.fa.fw("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(z,B)&&"inner"===m.AFrameworkApplication.fa.Va("Microsoft365Ring")}static ePh(B){switch(B.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"SaveAsPowerPointPotx_20";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"SaveAsWordDocx_20";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"SaveAsExcelXlsx_20";
case "pdf":return"PdfFile_32";case "one":case "onepkg":return"OneNote_32";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio_32"}return""}static aka(){return r.a.kv&&!r.a.jp}}x.G9f=9E5;Object(t.a)(x,"TellMeUtils",null,[])},699:function(t,C,a){a.r(C);t=a(0);var c=a(83),b=a(412),d=a(84),f=a(939),e=a(92);class k{constructor(ma,fb,sb,Ua,ab,na){this.groupType=ma;this.resultType=fb;
this.oTd=sb;this.oKa=Ua;this.D5c=ab;this.resultIndex=na}}Object(t.a)(k,"ClickLoggingInfo",null,[]);const l=ma=>{const fb=[];for(;ma;)Array.add(fb,"{ContextId:"+ma.contextId+", IsGraphNodeContext:"+ma.ofc+"}"),ma=ma.RCb;fb.reverse();return"{"+fb.join(", ")+"}"};class m{constructor(){this.QU=this.sessionId=null}}Object(t.a)(m,"CorrelationRecord",null,[656]);var v=a(726);class n{constructor(ma,fb){this.Id=null;this.TimeStamp=0;this.Id=ma;this.TimeStamp=fb}}Object(t.a)(n,"MRUControl",null,[]);var w;(function(ma){ma[ma.Answer=
0]="Answer";ma[ma.Definition=1]="Definition";ma[ma.Entity=2]="Entity";ma[ma.WolframAnswer=3]="WolframAnswer";ma[ma.Assistance=4]="Assistance";ma[ma.Command=5]="Command";ma[ma.Document=6]="Document";ma[ma.TryQuery=7]="TryQuery";ma[ma.FindInDocument=8]="FindInDocument";ma[ma.HelpAction=9]="HelpAction";ma[ma.Insights=10]="Insights";ma[ma.People=11]="People";ma[ma.Image=12]="Image";ma[ma.FirstRunResult=13]="FirstRunResult";ma[ma.NoCommandsFoundResult=14]="NoCommandsFoundResult";ma[ma.TestResult=15]="TestResult";
ma[ma.AppsForOffice_Installed=16]="AppsForOffice_Installed";ma[ma.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";ma[ma.AppsForOffice_Query=18]="AppsForOffice_Query";ma[ma.Notes_Onenote=19]="Notes_Onenote";ma[ma.Notes_Samsung=20]="Notes_Samsung";ma[ma.Notes_Sticky=21]="Notes_Sticky";ma[ma.Learning=22]="Learning";ma[ma.Feedback=23]="Feedback";ma[ma.Template=24]="Template";ma[ma.Addin=25]="Addin";ma[ma.OfficeScript=26]="OfficeScript";ma[ma.AddinStoreEntry=27]="AddinStoreEntry";ma[ma.Unknown=
28]="Unknown"})(w||(w={}));Object(t.b)("ResultType",w);var r=a(911),u=a(698),y=a(4),x=a(813);class B{constructor(ma,fb){this.bsg=10;this.fJ=[];this.e1=[];this.q8d=this.p8d=!1;this.sjb=this.rjb="";this.bWa=fb;this.Ua=ma;this.N8d=ma.Ji}xJa(){!this.p8d&&this.N8d&&this.Ua&&r.a.Qdf()&&(this.rjb="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.Ua.application,this.fJ=this.OVe(),this.p8d=!0);return this.fJ}TTh(){!this.q8d&&this.N8d&&this.Ua&&r.a.Qdf()&&(this.sjb="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.Ua.application,
this.e1=this.OVe(!0),this.q8d=!0);return this.e1}Jmi(ma){return ma.startsWith("TellMeUpsell")||"OpenInClientUpsell"===ma||"TryOfficeUpsell"===ma}$ld(ma){return this.Mdi(ma)||this.Jmi(ma)||u.a.Igf(ma)?!1:!0}D1(ma){ma=ma.ControlId;this.$ld(ma)&&(ma=this.bId(ma),this.f$i(ma),this.nxi(),Array.insert(this.fJ,0,new n(ma,Date.now())),this.rjb.length&&(ma=JSON.stringify(this.fJ),x.a.instance.setItem(this.rjb,ma)))}Ju(ma){this.mxi();Array.insert(this.e1,0,new n(w[ma],Date.now()));this.sjb.length&&(ma=JSON.stringify(this.e1),
x.a.instance.setItem(this.sjb,ma))}OVe(ma=!1){if(!this.fJ.length){var fb=ma?x.a.instance.getItem(this.sjb):x.a.instance.getItem(this.rjb);if(!fb||""===fb)return ma?this.e1:this.fJ;let sb=null;try{sb=JSON.parse(fb)}catch(Ua){this.kXg(ma),sb=null}if(!sb||!sb.length||10<sb.length)return ma?this.e1:this.fJ;fb=0;for(const Ua of sb)if(ma||this.Ua.jhc(Ua.Id)&&this.$ld(Ua.Id))if(ma?Array.insert(this.e1,fb++,Ua):Array.insert(this.fJ,fb++,Ua),fb===this.bWa)break}return ma?this.e1:this.fJ}j1c(ma){ma=this.bId(ma);
for(const fb of this.fJ)if(fb.Id===ma)return!0;return!1}kXg(ma=!1){x.a.instance.setItem(ma?this.sjb:this.rjb,"")}lfi(ma){ma=this.bId(ma.ControlId);return this.$ld(ma)?this.j1c(ma):!1}f$i(ma){if(0<this.fJ.length){let fb=0;for(const sb of this.fJ){if(sb.Id===ma){Array.removeAt(this.fJ,fb);break}fb++}}}bId(ma){return"Excel"===this.Ua.application&&ma.startsWith("m_excelWebRenderer_ewaCtl_")?ma.substr(26,ma.length):ma}nxi(){this.fJ.length===this.bWa&&Array.removeAt(this.fJ,this.fJ.length-1)}mxi(){this.e1.length===
this.bsg&&Array.removeAt(this.e1,this.e1.length-1)}Mdi(ma){ma=ma.split("|");let fb="";if(6<=ma.length)fb=ma[0];else if(3<=ma.length){if("3"===ma[0])return!0;fb=ma[1]}return fb.startsWith("WA")}static createInstance(ma){let fb=3;y.AFrameworkApplication.fa&&(fb=y.AFrameworkApplication.fa.nd("TellMeMaxRecommendedResultsToReturn",3));return new B(ma,fb)}}Object(t.a)(B,"MruControlsManager",null,[655]);class z{constructor(ma){this.SDa=ma}HP(ma,fb){let sb;return ma.Kz&&(sb=this.SDa[ma.value])?sb.HP(ma,fb):
(sb=this.uWe(ma.value))?sb.HP(sb.tAi,fb):null}KSh(ma,fb){if(ma=this.SDa[ma])for(const sb of fb)if(fb=u.a.getParameter(sb),fb.key===ma.vVi)return fb.value;return null}fDi(ma){(ma=this.uWe(ma))&&ma.dDi()}uWe(ma){const fb=ma.indexOf(u.a.kFf);return 0<fb?this.SDa[ma.substring(0,fb)]:null}}Object(t.a)(z,"ParameterizedCommandManager",null,[654]);var A=a(740);class I{constructor(ma,fb){this.Hd=ma;this.Sya=fb}}Object(t.a)(I,"TellMeQuery",null,[]);var F=a(912);class U{constructor(ma,fb){this.Id=null;this.TimeElapsedSinceClick=
0;this.Id=ma;this.TimeElapsedSinceClick=fb}}Object(t.a)(U,"CommandClickedEvent",null,[]);var X=a(692);class S{constructor(ma,fb){this.Lsg=ma;this.nX=fb}resultsUpdated(ma){this.Lsg(X.c(ma.query)?"":ma.query.Hd,ma.rh,ma.attributes,this.nX,ma.u6a)}}Object(t.a)(S,"ResultsUpdatedCallback",null,[653]);var H=a(185);class D{constructor(ma,fb){this.menuModel=ma;this.jTf=fb}}Object(t.a)(D,"GeneratedMenuModel",null,[]);class J{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;
this.ariaRoleDescription=null}}Object(t.a)(J,"MenuModel",null,[]);class M{constructor(ma,fb,sb){this.Ua=ma;this.SDa=fb;this.EEa=sb}NFh(ma,fb,sb){const {TellMeActor:Ua}=a(699);let ab=0;const na=new J,Na=[];let Va="";na.sections=[];let Sa=new H.a;const vb=!!this.Ua&&this.Ua.Mwa;var Oa=!!this.Ua&&this.Ua.Mcb||y.AFrameworkApplication.ta.Oa.Mcb;for(const Ob of ma){ma=0;vb||(Sa=new H.a);const Ja=new H.a;let lb=Ob.displayName;for(const Pb of Ob.results){if(0<=Pb.value.indexOf(u.a.NRd)){if(Pb.Kz){var yb=
this.SDa[Pb.value];if(yb&&Pb.value.endsWith(u.a.NRd)){if("FindParameterized"!==Pb.value&&!Oa){const Jb=[];Jb.push(appChrome.actions.setControlLabel(Pb.value,yb.XPh(Pb)));Jb.push(appChrome.actions.setButtonCommandValueId(Pb.value,yb.aKh(Pb)));appChrome.api.dispatch(Jb)}yb=Pb.value.replace(u.a.NRd,"");Sa.remove(yb)?ma--:Ja.add(yb);Sa.add(Pb.value);ma++}}}else switch(Pb.type){case 5:Ja.contains(Pb.value)||(Sa.add(Pb.value),ma++);break;case 7:Sa.add(Pb.Kz);ma++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 6:case 19:case 20:case 21:case 25:case 27:case 26:Sa.add(Pb.value),
ma++}13===Ob.groupType&&(lb=u.a.x4()?0<fb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,fb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,fb));21===Ob.groupType&&(lb=CommonUIStrings.l_LearningUILiveText)}ab+=ma;""!==lb&&0<ma&&(Va+=" , "+ma.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+lb+" , ");0<Sa.count&&!vb&&(ma=appChrome.api.menuSection(Sa.toArray(),Ob.displayName,null,A.a[Ob.groupType]),Na.push(ma))}Oa=
null;0<ab&&(Oa=0<fb.length?1!==ab?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,ab,fb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,fb):1!==ab?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,ab):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,vb?(fb=appChrome.api.menuSection(Sa.toArray(),"",null,null),Na.push(fb)):Oa+=Va);sb&&(this.Ua.I3?Ua.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Oa)):
appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Oa)));na.sections=Na;return new D(na,ab,[])}static get P6c(){return M.F4d||(M.F4d=new D(Object.assign(new J,{sections:[]}),0,[]))}}M.F4d=null;Object(t.a)(M,"TellMeMenuDefintionGenerator",null,[]);var G;(function(ma){ma[ma.TellMeControlActivated=0]="TellMeControlActivated";ma[ma.TellMeQueryExecuted=1]="TellMeQueryExecuted";ma[ma.TellMeResultsRendered=2]="TellMeResultsRendered";ma[ma.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(G||
(G={}));Object(t.b)("PerformanceMarker",G);var T;(function(ma){ma[ma.TellMeTimeToRender=0]="TellMeTimeToRender";ma[ma.TellMeSessionLength=1]="TellMeSessionLength";ma[ma.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(T||(T={}));Object(t.b)("PerformanceMeasure",T);class K{mark(ma){window.performance.mark(G[ma])}measure(ma,fb,sb){const {TellMeActor:Ua}=a(699);try{window.performance.measure(T[ma],G[fb],G[sb])}catch(ab){Ua.instance.sc.onError("TellMePerformance:Measure","error measuring "+T[ma])}}Zsd(ma,
fb,sb){const {TellMeActor:Ua}=a(699);Ua.instance.sc.itd(fb,sb,ma,this.SQh(ma))}yXg(){var ma=[0,1,2,3];for(const fb of ma)window.performance.clearMarks(G[fb])}clearMeasures(ma){for(const fb of ma)window.performance.clearMeasures(T[fb])}SQh(ma){let fb=0;(ma=this.RGh(ma))&&0<ma.length&&(fb=ma[ma.length-1].duration);return fb}RGh(ma){return window.performance.getEntriesByName(T[ma],"measure")}}Object(t.a)(K,"TellMePerformance",null,[]);var L=a(798),V=a(797),W=a(41);class da{constructor(ma){this.Swg=ma}DEb(ma,
fb,sb){const {TellMeActor:Ua}=a(699);Ua.instance.sc.c_(fb,V.a.Y$a,ma.data.httpStatus.toString(),Math.round(window.performance.now()-sb),V.a.Y$a,!0,L.a.Caa);ma=W.b(ma.data.Vd);fb=-1;ma.Index&&(fb=ma.Index);Ua.instance.sc.Xui(fb,this.Swg)}ODb(ma,fb,sb){const {TellMeActor:Ua}=a(699);Ua.instance.sc.c_(fb,V.a.Y$a,ma.data.httpStatus.toString(),Math.round(window.performance.now()-sb),V.a.Y$a,!1,L.a.Caa)}WTh(ma){if(ma&&""!==ma.trim()){const sb=window.performance.now(),Ua=y.AFrameworkApplication.f8f;var fb=
{};fb.Text=ma;fb.IsFileHash="false";fb=W.c(fb);y.AFrameworkApplication.vd.Bm(Ua,2,fb,{"Content-Type":"application/json",Accept:"application/json"},!1,0,ab=>{this.DEb(ab,ma.length,sb)},ab=>{this.ODb(ab,ma.length,sb)},null,null,!1,4E3,6E3)}}}Object(t.a)(da,"TellMeQueryIndexCallback",null,[]);var qa=a(703);class O{constructor(ma,fb,sb){this.xml=ma;this.jTf=fb;this.Jfh=sb}}Object(t.a)(O,"GeneratedMenuXml",null,[]);var ea=a(1091),R=a(30);class oa{constructor(ma,fb){this.uQb=ma||{};this.nfa=fb}get gQa(){return 5}HP(ma,
fb=null){return this.nfa.HP(ma,fb)||this.GPg(ma.value)}GPg(ma){return oa.zXc(ma,this.uQb[ma]||null)}static zXc(ma,fb=null){ma=String.format('<ClonedControl Id="{0}" ',ma);for(let ab in fb){var sb=ab,Ua=fb[ab];Ua=Ua?R.a.gf(Ua.toString()):"";ma+=String.format('{0}="{1}" ',sb,Ua)}return ma+"/>"}}Object(t.a)(oa,"CommandMenuItemFactory",null,[644]);var pa=a(308);class Pa{constructor(){this.qog=CommonUIStrings.l_FindInDocumentText}get gQa(){return 8}HP(ma){var fb=ma.Kz;ma=R.a.gf(ma.value);const sb=R.a.gf(fb);
fb=R.a.gf(String.format(this.qog,fb));return this.sEh(ma,sb,fb)}sEh(ma,fb,sb){return pa.a(ma,"1540292897",sb,u.a.Nzh,null,fb,sb,null,null)}}Object(t.a)(Pa,"FindInDocumentMenuItemFactory",null,[644]);var Z=a(1092),Ra=a(1090),Ga=a(1093);class Ba{get gQa(){return 7}HP(ma){const fb=Object(d.a)(F.a,ma);return this.VFh(R.a.gf(ma.value),fb.id)}VFh(ma,fb){return pa.a(fb,"1404166600",ma,null,null,ma,ma,null,null)}}Object(t.a)(Ba,"TryQueryMenuItemFactory",null,[644]);class fa{constructor(ma){this.b5d=[];this.Ua=
ma}WMh(ma){for(const fb of this.b5d)if(fb.gQa===ma)return fb;return null}eza(ma){this.b5d.push(ma)}f7i(ma){this.eza(new oa(this.Ua.PAe,ma));this.eza(new Ga.a(this.Ua.rrf));this.eza(new ea.a(this.Ua.Hkj,this.Ua.Gkj,this.Ua.UHj,this.Ua.b5h,this.Ua.vwj));this.eza(new Ra.InsightsMenuItemFactory);this.eza(new Pa);this.eza(new Z.a);this.eza(new Ba)}}Object(t.a)(fa,"MenuItemFactoryRegistry",null,[]);var Y=a(706);class ja{constructor(ma,fb){this.Ua=ma;this.V$d=new fa(this.Ua);this.V$d.f7i(fb)}OFh(ma,fb){let sb=
0;const Ua=[],ab=[];for(const Na of ma){ma=u.a.rUd;var na=[];for(const Va of Na.results){const Sa=this.V$d.WMh(Va.type).HP(Va,fb);ma=u.a.rUd;na.push(Sa);if(13===Va.type||14===Va.type)ma="Menu32";17===Va.type&&(ma="MenuTellMeExtended");Va.groupType=Na.groupType;ab.push(Object(d.a)(Y.a,Va))}sb=sb?sb:na.length;na=pa.e("TellMeDropdownControls",na);ma=pa.h("TellMeDropdownMenuSection",na,ma,Na.displayName);Ua.push(ma)}fb=pa.i(Ua,"LookupDropdownMenu");return new O(fb,sb,ab)}static get t6b(){return ja.G4d||
(ja.G4d=new O(pa.i([],"LookupDropdownMenu"),0,[]))}}ja.G4d=null;Object(t.a)(ja,"TellMeXmlGenerator",null,[]);class ca{}ca.SAi="MRU";ca.test="Test";Object(t.a)(ca,"ActionType",null,[]);var aa=a(771),ta;(function(ma){ma[ma.Service=0]="Service";ma[ma.Local=1]="Local";ma[ma.MRU=2]="MRU";ma[ma.TestResult=3]="TestResult";ma[ma.Unknown=4]="Unknown"})(ta||(ta={}));Object(t.b)("SubResultType",ta);var xa=a(110);class ia{constructor(ma,fb,sb,Ua,ab=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=
this.SubResultType=this.ResultType=null;this.CommandId=ma;this.IsEnabled=fb;this.ResultType=w[sb];this.SubResultType=ta[Ua];this.OptionalData=ab?xa.a.toJSON(ab):null}}Object(t.a)(ia,"ResultInfo",null,[]);var ya=a(124),ib=a(146),wa=a(318);class sa{constructor(ma,fb=null){this.r7d="TellMeWAC.";this.gtg=ma;this.txg=fb}A6(ma,fb,sb){fb=ya.a.Uj(fb);ma=ya.a.D3b(ma,this.gtg,this.txg,sb,fb);ib.a.A6(ma,this.r7d)}Lma(ma,fb,sb=0){fb=ya.a.Uj(fb);ib.a.Lma(Object.assign(new wa.a,{name:ma,dataFields:fb,durationMs:sb}),
this.r7d)}}Object(t.a)(sa,"TellMeOtelLogger",null,[665]);var Ya=a(172);class bb{constructor(ma,fb,sb,Ua,ab,na,Na){this.hJ=this.RL=this.N2d=null;this.DPb=ma;this.IFc=fb;this.v8=sb;this.Jpa=Ua;this.Mpa=ab;this.irg=na;this.hJ=Na?Na:new sa(this.Jpa?e.CuiHelper.MRd:e.CuiHelper.Gyc)}get Ji(){return this.Jpa}get uab(){return this.v8}nvc(ma){this.N2d=ma;switch(ma){case qa.a.contextMenu:this.RL=qa.a.contextMenu;break;default:this.RL=qa.a.tellMe}}qNg(ma,fb){this.v8.QU||(this.v8.QU=Ya.a.create().toString(),
this.Okf(ma,!0,fb))}SJe(ma,fb=!0){this.v8.QU&&this.Eti(ma,fb);this.Jpa&&appChrome.api.updateTellMeCorrelationId("");this.v8.QU=null}Okf(ma,fb,sb){const {TellMeActor:Ua}=a(699),ab=this.EJ(v.a.Ova);ab[aa.a.culture]=this.IFc;ab[aa.a.appName]=this.DPb;ab[aa.a.context]=ma;ab[aa.a.Ogc]=this.Mpa;ab[aa.a.Fmi]=this.irg;ab[aa.a.Kli]=sb;ab[aa.a.Rhi]=fb;ab[aa.a.contentType]=Ua.instance.c4b;this.hJ.A6(v.a.Ova,ab,this.N2d);this.Jpa&&appChrome.api.updateTellMeCorrelationId(this.v8.QU)}Eti(ma,fb){const sb=this.EJ(v.a.fLa);
sb[aa.a.Shh]=ma;sb[aa.a.Qhi]=fb;this.hJ.Lma(v.a.fLa,sb)}Wui(ma,fb,sb){let Ua=0;!sb&&0<ma.length&&(Ua=ma.trim().split(" ").length);const ab=this.EJ(v.a.query);ab[aa.a.query]="!";ab[aa.a.jPa]=fb;ab[aa.a.wJf]=ma.length;ab[aa.a.uhf]=sb;ab[aa.a.kXj]=Ua;this.hJ.A6(v.a.query,ab,this.RL)}oui(ma,fb,sb,Ua,ab,na,Na){const Va=this.EJ(v.a.latency);Va[aa.a.culture]=this.IFc;Va[aa.a.wJf]=ma;Va[aa.a.yag]=fb;Va[aa.a.statusCode]=sb;Va[aa.a.bO]=ab;Va[aa.a.isSuccess]=na;Va[aa.a.Ppi]=Na;this.hJ.Lma(v.a.latency,Va,Ua)}itd(ma,
fb,sb,Ua){const ab=this.EJ(v.a.performance);ab[aa.a.culture]=this.IFc;ab[aa.a.uNg]=G[ma];ab[aa.a.Zjh]=G[fb];ab[aa.a.VWi]=T[sb];this.hJ.Lma(v.a.performance,ab,Ua)}gvi(ma,fb){var {TellMeActor:sb}=a(699);const {CommandResultsUtility:Ua}=a(753);if(ma.results.length){var ab=this.EJ(v.a.YQf);ab[aa.a.oKa]=fb.toString();ab[aa.a.groupType]=A.a[ma.groupType];16===ma.groupType&&(ab[aa.a.vli]=sb.instance.dOb);fb=[];sb=[];var na=[];for(const Na of ma.results)ab[aa.a.resultType]||(ab[aa.a.resultType]=w[Na.type]),
ma={},25===Na.type&&(ma.AssetId=Na.QYb),sb.push(Ua.Zva(Na.value)),fb.push(Na.value),na.push(new ia(Na.value,Ua.Zva(Na.value),Na.type,Na.B6f,ma));0<fb.length&&(ab[aa.a.Sgj]="{"+fb.join(", ")+"}",ab[aa.a.Mjh]="{"+sb.join(", ")+"}",ab[aa.a.Lgj]=W.c(na));this.hJ.A6(v.a.YQf,ab,this.RL)}}oGh(ma,fb){if(4===ma)return ca.SAi;switch(fb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return w[fb]}mti(ma,fb,sb,Ua,ab){const na=
this.EJ(v.a.click);na[aa.a.yag]=ma;na[aa.a.DVi]=fb;na[aa.a.commandId]=sb;na[aa.a.vP]=Ua;na[aa.a.actionType]=this.oGh(ab.groupType,ab.resultType);na[aa.a.resultType]=w[ab.resultType];na[aa.a.oTd]=ta[ab.oTd];na[aa.a.groupType]=A.a[ab.groupType];na[aa.a.oKa]=ab.oKa.toString();na[aa.a.D5c]=ab.D5c.toString();na[aa.a.resultIndex]=ab.resultIndex.toString();this.hJ.A6(v.a.click,na,this.RL)}pti(ma,fb){this.v8.QU||(this.v8.QU=Ya.a.create().toString(),this.Okf("",!1,fb));fb=this.EJ(v.a.NAe);fb[aa.a.jPa]=ma;
this.hJ.Lma(v.a.NAe,fb)}elf(ma,fb,sb){if(ma){if(sb)for(let Ua in sb)ma[Ua]=sb[Ua];this.hJ.Lma(v.a.events,ma,fb)}}Iti(ma,fb,sb=null){const Ua=this.EJ(v.a.events);Ua[aa.a.event]=ma;this.elf(Ua,Math.round(fb),sb)}Tsd(ma,fb,sb=null){const Ua=this.EJ(v.a.events);Ua[aa.a.event]=v.a.error;Ua[aa.a.module]=ma;Ua[aa.a.errorMessage]=fb;Ua[aa.a.message]=fb;this.elf(Ua,Math.round(window.performance.now()),sb)}jti(ma){const fb=this.EJ(v.a.ize);fb[aa.a.value]=ma;fb[aa.a.eqc]=this.Jpa;this.hJ.A6(v.a.ize,fb,this.RL)}Jsi(ma){const fb=
this.EJ(v.a.Qie);fb[aa.a.value]=ma;fb[aa.a.eqc]=this.Jpa;this.hJ.A6(v.a.Qie,fb,this.RL)}Qti(ma){const fb=this.EJ(v.a.yRe);fb[aa.a.value]=ma;fb[aa.a.eqc]=this.Jpa;this.hJ.A6(v.a.yRe,fb,this.RL)}Vui(ma){const fb=this.EJ(v.a.mJf);fb[aa.a.value]=ma;fb[aa.a.eqc]=this.Jpa;this.hJ.A6(v.a.mJf,fb,this.RL)}Tsi(ma){const fb=this.EJ(v.a.wXf);fb[aa.a.value]=ma;this.hJ.A6(v.a.wXf,fb,this.RL)}Yui(ma,fb){const sb=this.EJ(v.a.vJf);sb[aa.a.Y$a]=ma;fb&&(sb[aa.a.QU]=fb);this.hJ.Lma(v.a.vJf,sb)}EJ(ma){return{["SessionID"]:this.v8.sessionId,
["CorrelationID"]:this.v8.QU,["Time"]:(new Date).getTime(),["Event"]:ma,["Scenario"]:this.RL}}}Object(t.a)(bb,"UsageLogger",null,[651]);var mb=a(94),Ca=a(1024),$a=a(683),Kb=a(107),rb=a(88);a(831);a(371);var cc=a(27),nc=a(555),Wb=a(106),Ea=a(25);a.d(C,"TellMeActor",function(){return ua});class ua{constructor(){this.nfa=this.FG=this.Zb=this.nb=this.gS=this.IO=this.fe=this.La=this.sc=this.Gu=this.WLc=this.Aie=this.oX=this.Ua=null;this.KVa=!1;this.kFc=[];this.J2d=[];this.sae=[];this.tae=[];this.K8d=!1;
this.zUa=this.EEa=null;this.Aib=this.Mpa=!1;this.jsg=!0;this.gE=this.aSb=this.c6d=this.mae=null;this.HO=[];this.Yoa=this.KUa=this.O0=null;this.zVa=!1;this.bMc=0;this.pUa=null;this.nX=-1;this.X$d=0;this.Eib=!1;this.npa=null;this.Lhe=!1;this.fE=null}get c4b(){return this.gS?this.gS.contentType:ua.unknown}get actions(){return this.HO}set actions(ma){this.HO=ma}Xac(){return this.sc?this.sc.uab.QU:null}Ox(){return this.Ua}get eAi(){return this.jsg}get DWj(){return this.mae}performance(){return this.Gu}get dOb(){return this.Lhe}set dOb(ma){this.Lhe=
ma}fBa(ma){const fb=window.performance.now();this.EEa&&!X.c(ma)&&(this.EEa(ma),this.sc.sN(v.a.fBa,window.performance.now()-fb))}initialize(ma,fb=null,sb=null,Ua=null,ab=null,na=null,Na=null,Va=null,Sa=null,vb=null,Oa=null){const {InteractionLogger:yb}=a(1346),{GroupsPlacementInfo:Ob}=a(1344),{AggregatorResultsProvider:Ja}=a(1130);this.Ua=ma;this.Mpa=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Oa.ypd;this.sc=Ua;if(!Ua){Ua=new m;Ua.sessionId=y.AFrameworkApplication.userSessionId;const lb=
nc.a.YJ(y.AFrameworkApplication.lcid)||nc.a.tci;this.sc=new yb(new bb(this.Ua.application,lb.name,Ua,this.Ua.Ji,this.Mpa,ma.tellMeInSharedHeaderIsEnabled,null),this.Ua.W1g,this.Ua)}this.nfa=new z(this.Ua.parameterData);this.Aie=sb||new ja(this.Ua,this.nfa);this.EEa=Na;this.WLc=this.WLc||new M(this.Ua,this.Ua.parameterData,Na);this.Zb=mb.FocusManager.instance();this.FG=B.createInstance(this.Ua);this.c6d=new Ob(ma);this.La=ab||y.AFrameworkApplication.wb;this.fe=na||y.AFrameworkApplication.zi;this.IO=
Sa;this.oX=fb;this.fE=Oa;this.Gu=new K;Sa?Sa.execute(lb=>{lb.isFeatureEnabled(ua.MHj,!0).then(Pb=>{const {AggregatorResultsProvider:Jb}=a(1130);this.Eib=Pb;this.oX=this.oX||Jb.createInstance(this.FG,this.Ua,this.nfa,this.Eib);return null})}):(this.Eib=!0,this.oX=this.oX||Ja.createInstance(this.FG,this.Ua,this.nfa,this.Eib));this.nb=Va;this.O0=ja.t6b;this.mae=new Promise(()=>{});vb&&vb.execute(lb=>{this.gS=lb});this.Ua.Ji&&u.a.Nff()&&(ma=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.Ua.application),
appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(ma,ma)))}Gg(){this.ECg()}ECg(){this.La.Ie(Ea.a.tellMe,Wb.a.frame,Object(c.a)(this,this.tellMe,"tellMe"),96);this.La.Ie(Ea.a.tellMeCacheAsyncMenuRefresh,Wb.a.frame,Object(c.a)(this,this.ySg,"cacheAsyncMenuRefreshFunction"),96);this.La.Ie(Ea.a.tellMeLogCommandExecuted,Wb.a.frame,Object(c.a)(this,this.lui,"logItemExecuted"),96);this.La.Ie(Ea.a.tellMeLogMenuClose,Wb.a.frame,Object(c.a)(this,this.qti,"logControlDeactivation"),96);this.La.Ie(Ea.a.tellMeLogInputFocus,
Wb.a.frame,Object(c.a)(this,this.hui,"logInputFocus"),96);this.La.Ie(Ea.a.tellMeInteractionBegin,Wb.a.frame,Object(c.a)(this,this.Ova,"interactionBegin"),96);this.La.Ie(Ea.a.tellMeRestoreFocus,Wb.a.frame,Object(c.a)(this,this.Ova,"interactionBegin"),96);this.La.Ie(Ea.a.tellMeLogInputBlur,Wb.a.frame,Object(c.a)(this,this.gui,"logInputBlur"),96);this.La.Ie(Ea.a.tellMeLogMenuOpen,Wb.a.frame,Object(c.a)(this,this.oti,"logControlActivated"),96);this.La.Ie(Ea.a.tellMeFocusInput,Wb.a.frame,Object(c.a)(this,
this.OBh,"focusSearchBox"),96);this.La.Ie(Ea.a.tellMeAccessibilityMenuText,Wb.a.frame,Object(c.a)(this,this.V0g,"constructLiveNotificationForMenu"),96);this.La.Ie(Ea.a.tellMeTryQuery,Wb.a.frame,Object(c.a)(this,this.m$e,"insertTryQuery"),96);this.La.Ie(Ea.a.Kqi,Wb.a.frame,Object(c.a)(this,this.m$e,"insertTryQuery"),96);this.La.Ie(Ea.a.Ayh,Wb.a.frame,Object(c.a)(this,this.Hla,"openOrInsertUrl"),96);this.La.Ie(Ea.a.Byh,Wb.a.frame,Object(c.a)(this,this.Hla,"openOrInsertUrl"),96);this.La.Ie(Ea.a.Cyh,
Wb.a.frame,Object(c.a)(this,this.Hla,"openOrInsertUrl"),96);this.La.Ie(Ea.a.Dyh,Wb.a.frame,Object(c.a)(this,this.Hla,"openOrInsertUrl"),96);this.La.Ie(Ea.a.Eyh,Wb.a.frame,Object(c.a)(this,this.Hla,"openOrInsertUrl"),96);this.La.Ie(Ea.a.MTi,Wb.a.frame,Object(c.a)(this,this.Hla,"openOrInsertUrl"),96);this.La.Ie(Ea.a.NTi,Wb.a.frame,Object(c.a)(this,this.Hla,"openOrInsertUrl"),96);this.La.Ie(Ea.a.OTi,Wb.a.frame,Object(c.a)(this,this.Hla,"openOrInsertUrl"),96);this.La.Ie(Ea.a.NWi,Wb.a.frame,Object(c.a)(this,
this.Kdc,"insertMention"),96);this.La.Ie(Ea.a.OWi,Wb.a.frame,Object(c.a)(this,this.Kdc,"insertMention"),96);this.La.Ie(Ea.a.PWi,Wb.a.frame,Object(c.a)(this,this.Kdc,"insertMention"),96);this.La.Ie(Ea.a.tellMeFeedback,Wb.a.frame,Object(c.a)(this,this.openFeedback,"openFeedback"),96);this.La.Ie(Ea.a.OHj,Wb.a.frame,Object(c.a)(this,this.Hla,"openOrInsertUrl"),96);this.La.Ie(Ea.a.pHg,Wb.a.frame,Object(c.a)(this,this.Mrd,"launchAddin"),96);this.La.Ie(Ea.a.qHg,Wb.a.frame,Object(c.a)(this,this.Mrd,"launchAddin"),
96);this.La.Ie(Ea.a.rHg,Wb.a.frame,Object(c.a)(this,this.Mrd,"launchAddin"),96);this.La.Ie(Ea.a.Qwc,Wb.a.frame,Object(c.a)(this,this.Qwc,"showTellMeCoachmark"),96);this.La.Ie(Ea.a.Tpi,Wb.a.frame,Object(c.a)(this,this.Upi,"launchAddinStore"),96)}OBh(ma,fb,sb){if(1===sb)return 32;this.y_f();ma=!1;(this.Ua.tellMeInSharedHeaderIsEnabled||this.Mpa)&&(fb=document.getElementById("SearchButton"))&&fb.click();if(!this.Ua.tellMeInSharedHeaderIsEnabled&&this.Mpa)for(fb=document.getElementsByClassName("ms-suiteux-search-box"),
sb=0;sb<fb.length;sb++){const Ua=fb[sb].querySelector("input[type=search]");Ua&&(ma=mb.FocusManager.Una(Ua))}else ma=mb.FocusManager.Una($get(this.Ua.Ji?e.CuiHelper.MRd:e.CuiHelper.Gyc));this.Aib=!0;return ma?32:8}m$e(ma,fb,sb,Ua,ab){if(1===sb)return 32;if(X.c(ab))return this.sc.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.y_f();ma=ab.CommandValueId;fb=this.Ua.Ji?e.CuiHelper.MRd:e.CuiHelper.Gyc;this.Ua.Ji&&!X.c(ab[$a.a.eAa])&&(ab[$a.a.eAa]=!1);if(ma){if(this.Ua.Ji)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(ma)),
this.npa=[19],32;if(ab=$get(fb))ab.value=ma}return mb.FocusManager.Una($get(fb))?32:8}y_f(){this.Zb.jR(this.Ua.tellMeInSharedHeaderIsEnabled||this.Mpa?this.Ua.Vhd:this.Ua.lQa,!1)}kGh(ma,fb){switch(ma){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,fb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,fb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,fb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
fb)}return fb}V0g(ma,fb,sb,Ua,ab){if(1===sb)return 32;if(X.c(ab))return this.sc.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;ma=this.O0?this.O0.jTf:0;ab.Value=1!==ma?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,ma):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.O0)for(const na of this.O0.Jfh)ab=Object(b.a)(F.a,na)?na.id:R.a.replaceAll(na.value,'"',""),(ab=$get(ab+"-"+u.a.rUd))&&rb.a.sh(ab,rb.a.Mt,R.a.gf(this.kGh(na.groupType,
ab.innerText)));return 32}ySg(ma,fb,sb,Ua,ab){if(1===sb)return 32;if(X.c(ab))return this.sc.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.pUa=new Kb.a(2,1,0,()=>{ab[Ca.a.Callback]()},97);this.O0&&this.fe.Ag(this.pUa);return 32}lui(ma,fb,sb,Ua,ab){if(1===sb)return 32;if(X.c(ab))return this.sc.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;ab.CloseAllMenus&&(ma=void 0===ab.ParentControlId||null===ab.ParentControlId?"<NA>":ab.ParentControlId,
fb=this.zUa?this.zUa[ab.ControlId]:null,!fb&&this.zUa&&"<NA>"!==ma&&(fb=this.zUa[ma]),fb||(fb=this.KVa&&this.FG.lfi(ab),fb=this.Qdh(fb,ab.ControlId),fb=new k(fb,28,4,-1,-1,-1),this.sc.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+ab.ControlId+" determined group:"+A.a[fb.groupType])),this.sc.eHi(ab.ControlId,ma,ab.CommandId,ab.CloseAllMenus,fb),this.nfa.fDi(ab.ControlId),ab.Location!==qa.a.contextMenu&&(this.FG.D1(ab),this.FG.Ju(fb.resultType),this.Ua.kwc&&this.oX.dBg(ab.CommandId)));
return 32}qti(ma,fb,sb,Ua,ab){if(1===sb)return 32;r.a.Gmi()&&(new da(this.Xac())).WTh(this.KUa);ma=this.KUa;fb=this.nX;sb=this.sc.DQb;if(X.c(ab))return this.sc.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;ab=ab.UILocation;ma&&0<ma.length&&this.Eib&&u.a.ZPd(this.Ua)&&this.Ua.Ygc&&19!==ab&&fb>sb&&!this.Ua.yy&&(this.sc.mtd(ma),this.sc.zNd(fb));this.sc.sfj();this.Ua.kBc&&19!==ab&&(this.Gu.mark(3),this.Gu.measure(1,0,3),this.Gu.measure(2,2,3),this.Gu.Zsd(0,1,2),this.Gu.Zsd(2,
2,3),this.Gu.Zsd(1,0,3),this.Gu.yXg(),this.Gu.clearMeasures([0,2,1]));this.sc.AHi(window.performance.now()-this.bMc);this.Ua.Ji&&(this.Yoa=null,this.sc.xla());this.Aib=this.zVa=!1;this.KUa="";return 32}hui(ma,fb,sb){if(1===sb)return 32;this.sc.dya(l(fb),this.Aib);return 32}gui(ma,fb,sb){if(1===sb)return 32;this.sc.xla();this.zVa=!1;return 32}oti(ma,fb,sb,Ua,ab){if(1===sb)return 32;this.gE=null;ab&&(this.gE=ab);this.Ua.kBc&&(X.c(this.gE)||this.gE.Location!==qa.a.contextMenu)&&this.Gu.mark(0);this.sc.nvc(X.c(this.gE)||
X.c(this.gE.Location)?qa.a.unknown:this.gE.Location);this.sc.zHi(this.X$d,this.Aib);this.zVa||this.yla();return 32}tCe(ma,fb){const sb=[],Ua=Date.now();for(let ab of ma)ma=(Ua-ab.timeStamp)/1E3,ma=u.a.jWd(ma),Array.add(sb,new U(fb?ab.commandId:ab.controlId,ma));return sb}YCe(ma=!1){var fb=ma?this.FG.TTh():this.FG.xJa();ma=[];const sb=Date.now();for(const Ua of fb)fb=(sb-Ua.TimeStamp)/1E3,fb=u.a.jWd(fb),Array.add(ma,new U(Ua.Id,fb));return ma}yla(){if(!this.zVa){this.KVa=this.zVa=!0;""!==this.Ua.kWf&&
y.AFrameworkApplication.jxa(this.Ua.kWf);if(!this.K8d){this.K8d=!0;const ma={};ma.IsMLREnabled=this.Ua.Tii;ma.IsReactRibbonEnabled=this.Ua.Ji;ma.IsSharedHeaderEnabled=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Oa.$r;ma.IsSearchUxEnabled=this.Mpa;ma.IsTellMeInHeaderEnabled=this.Ua.tellMeInSharedHeaderIsEnabled;ma.IsGoLocalEnv=u.a.Kcf();ma.IsSovereignEnvironment=u.a.jMa();ma.IsTellMeServiceResultsEnabled=u.a.ZPd(this.Ua);ma.IsSubstrateProviderEnabled=u.a.YPd(this.Ua);ma.ShouldFetchTokens=
!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Oa.zRa;ma.IsSerpletEnabled=u.a.x4();ma.FirstOnClickTimeInMS=Math.round(window.performance.now());ma.IsHeaderHidden=y.AFrameworkApplication.hideHeader||y.AFrameworkApplication.hideHeaderEmbedded;ma.IsSearchInHeaderHidden=y.AFrameworkApplication.hideSearchInHeaderByUiHost;void 0!==window.performance.timing&&null!==window.performance.timing&&(ma.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));ma.IsFindWithMatchesEnabled=
this.Ua.QRe;ma.HelpShowsTopSearchResult=this.Ua.VKb;ma.HelpShowsNumberOfMatches=this.Ua.UKb;y.AFrameworkApplication.fa&&(ma.UiHost=y.AFrameworkApplication.fa.Va("UiHostIntegrationType"));this.sc.rvi(JSON.stringify(ma))}this.kFc=this.tCe(f.a.instance.Hgb,!1);this.J2d=this.tCe(f.a.instance.yUa,!0);this.sae=this.YCe();this.tae=this.YCe(!0);this.sc.yla()}}Ova(ma,fb,sb,Ua,ab){if(1===sb)return 32;if(X.c(ab))return this.sc.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(cc.a.vdf)return 32;
this.bMc=window.performance.now();this.yla();ma=new S(Object(c.a)(this,this.d_,"onRequestCompleted"),0);this.nX++;this.sc.beginQuery("",this.nX,this.KVa);this.O0=ja.t6b;this.Yoa=M.P6c;if(this.oX)ua.instance.actions=[],this.oX.nv(new I("",this.nX),ma,this.Ua.Ji);else this.sc.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.pUa&&this.fe.Ag(this.pUa);return 32}tellMe(ma,fb,sb,Ua,ab){if(1===sb)return 32;if(X.c(ab))return this.sc.onError("TellMeActor:TellMe","actiondata comes null"),
16;this.gE=ab;this.sc.nvc(X.c(this.gE.Location)?qa.a.unknown:this.gE.Location);ma=this.gE.Value;this.Ua.Ji||ma&&""!==ma.trim()?(!this.Yoa&&this.Ua.Ji&&(this.sc.dya(l(fb),this.Aib),this.yla()),this.ywh(ma,this.gE.Location),this.gE.PopulationXML=this.O0.xml):this.KVa?this.gE.PopulationXML=this.O0.xml:(this.gE.PopulationXML=ja.t6b.xml,this.Yoa=M.P6c,this.KUa="");return 32}ywh(ma,fb){this.bMc=window.performance.now();this.Ua.kBc&&fb!==qa.a.contextMenu&&this.Gu.mark(1);this.Ua.Ji&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(ma));
ma&&0<ma.trim().length&&(this.KVa=!1);this.Ua.elh();fb=X.c(fb)?qa.a.tellMe:fb;if(ma!==this.KUa||this.Ua.Ji){this.nX++;this.sc.beginQuery(ma,this.nX,this.KVa);const sb=new I(ma,this.nX),Ua=new S(Object(c.a)(this,this.d_,"onRequestCompleted"),this.nX);this.O0=ja.t6b;this.Yoa=M.P6c;if(this.oX)ua.instance.actions=[],this.oX.nv(sb,Ua,this.Ua.Ji,fb,this.npa),this.npa=null;else this.sc.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.X$d=this.nX;this.KUa=ma}}MRj(ma){if(this.Ua.Ji){var fb=
appChrome.selectors.getActiveControlStates();if(fb=Object(d.a)(Object,fb[ma.value])){ma.label=fb.label;let sb=null;"description"in fb&&(sb=fb.description);sb&&Object.getType(sb)===String?ma.description=sb:"secondaryText"in fb?ma.description=fb.secondaryText:"fullDescriptionLabel"in fb&&(ma.description=fb.fullDescriptionLabel)}}}eYi(ma){this.zUa={};let fb=0,sb=0;for(const Ua of ma){ma=0;for(const ab of Ua.results)this.zUa[ab.value]=new k(ab.groupType,ab.type,ab.B6f,fb,ma,sb),ma++,sb++,ab.label||5!==
ab.type||this.MRj(ab);0<ma&&fb++}}openUrlInNewTab(ma,fb,sb,Ua,ab){if(1===sb)return 32;if(X.c(ab))return this.sc.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(ma=ab.CommandValueId)&&window.open(ma,"_blank");return 32}Kdc(ma,fb,sb,Ua,ab){if(1===sb)return 32;if(X.c(ab))return this.sc.onError("TellMeActor:InsertMention","actiondata comes null"),16;ma=ab.UILocation;let na;ab=ab.CommandValueId;try{na=W.a(ab)}catch(Na){return this.sc.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),
16}return X.c(na)?(this.sc.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):X.c(this.aSb)?(this.sc.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==ma?(this.sc.onError("TellMeActor:InsertMention","location "+ma+" is unexpected"),16):this.aSb.Kdc(na.displayName,na.email,na.userId)?32:(this.sc.onError("TellMeActor:InsertMention","mention is not inserted"),16)}Hla(ma,fb,sb,Ua,ab){return 1===sb?32:X.c(ab)?(this.sc.onError("TellMeActor:OpenOrInsertUrl",
"actiondata comes null"),16):19===ab.UILocation?this.obi(sb,ab):this.openUrlInNewTab(ma,fb,sb,Ua,ab)}openFeedback(ma,fb,sb,Ua,ab){if(1===sb)return 32;if(X.c(ab))return this.sc.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.fE&&this.fE.execute(na=>{na.xLb("TellMeSurvey",null)});return 32}obi(ma,fb){if(1===ma)return 32;if(X.c(fb))return this.sc.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(X.c(this.aSb))return this.sc.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),
16;ma=fb.CommandValueId;return X.c(ma)?(this.sc.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.aSb.insertHtmlText(ma)?32:(this.sc.onError("TellMeActor:InsertUrl","url is not inserted"),16)}d_(ma,fb,sb,Ua,ab){sb=window.performance.now();this.eYi(fb);this.sc.Gqj(fb);this.Ua.Ji?(this.Yoa=this.WLc.NFh(fb,ma,ab),this.Ua.I3?(this.HO.push(appChrome.actions.updateTellMeSearchResults(this.Yoa.menuModel,ma,ab)),appChrome.api.dispatch(this.HO)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.Yoa.menuModel,
ma,ab)),this.Ua.kBc&&this.zVa&&(X.c(this.gE)||this.gE.Location!==qa.a.contextMenu)&&(this.Gu.mark(2),this.Gu.measure(0,1,2))):this.O0=this.Aie.OFh(fb,this.sc.uab);this.pUa&&this.fe.Ag(this.pUa);ab={};ab.GroupsCount=fb.length;ab.QueryID=Ua;ab.QueryLength=ma.length;this.sc.sN(v.a.W8g,window.performance.now()-sb,ab)}Qdh(ma,fb){return fb.startsWith(this.Ua.Ji?u.a.xWd:u.a.Gzc)?5:ma?4:"bSearchHelp"===fb||fb.startsWith("GetHelpFromTellMe")?8:"bInsights"===fb||fb.startsWith("SmartLookupFromTellMe")?13:fb===
this.Ua.PRe?2:0}Ju(ma,fb){this.oX&&this.oX.Ju(ma,fb)}Upi(ma,fb,sb,Ua,ab){return this.La.de(Ea.a.Vpi,2,ab)}Mrd(ma,fb,sb,Ua,ab){({AddinResultsProvider:ma}=a(940));ab=ab.CommandValueId;if(X.b(ab))return this.sc.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!ma.rFa[ab])return this.sc.onError("TellMeActor:LaunchAddin","Add-in with assetId "+ab+" doesn't not exist in entitlements"),16;ma=a(940).AddinResultsProvider.rFa[ab];fb={};fb.solutionId=ma.id;fb.version=ma.appVersion;fb.storeType=
ma.storeType;fb.storeId=ma.storeId;fb.assetId=ma.assetId;fb.assetStoreId=ma.assetStoreId;fb.displayName=ma.displayName;fb.targetType=ma.targetType;fb.height=ma.height;fb.width=ma.width;ma=this.La.de(Ea.a.h$e,2,fb);if(32!==ma)this.sc.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+ma+". AssetId: "+ab);return ma}Qwc(){if(!X.c(this.fE))for(let ma of f.a.instance.yUa){if("ShowContextMenuWithFloatie"===ma.commandId)return this.fE.execute(fb=>{fb.logActivity("TellMe1TabSwitchCoachMarkActivity",
null)}),32;if(ma.commandId&&-1===ma.commandId.indexOf("Tab"))break}return 8}static get instance(){return ua.Ma||(ua.Ma=new ua)}}ua.Ma=null;ua.MHj="mso_tellMeService";ua.unknown="Unknown";Object(t.a)(ua,"TellMeActor",null,[])},701:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);var c=a(715);class b{constructor(d,f){this.Kpa=!1;const {Annotations:e}=a(694);if(!d)throw Error.argumentNull("annotations");if(!d.rqd(f))throw Error.argument("memberTypeID","Invalid type ID");if(e.zt(f))throw Error.argument("memberTypeID",
"Lists of lists are not permitted");this.Pl=d;this.csg=f;this.iq=[]}get HYa(){return this.Pl}get isReadOnly(){return this.Kpa}get bI(){return this.csg}get items(){return this.iq}AO(){const {Annotations:d}=a(694);let f="[";for(let e=0,k=this.items.length;e<k;++e){0<e&&(f+=", ");const l=this.Pl.AO(this.bI,this.items[e]);this.bI===d.tL?(f+='"',f+=c.a.O7c(l),f+='"'):f+=l}return f+"]"}isEqual(d){const {Annotations:f}=a(694);if(this===d)return!0;if(!d||d.HYa!==this.Pl||d.bI!==this.bI||d.items.length!==
this.items.length)return!1;for(let e=0;e<this.items.length;++e)if(!f.vBa(this.bI,this.items[e],d.items[e]))return!1;return!0}clone(){const d=new b(this.Pl,this.bI);Array.addRange(d.items,this.items);return d}QA(){return this.isReadOnly?this.clone():this}Hsd(){const {Annotations:d}=a(694);if(!this.isReadOnly){this.Kpa=!0;for(const f of this.items)d.cNa(f)}}toString(){return this.AO()}}Object(t.a)(b,"ListValue",null,[709,707])},703:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.tellMe=
"TellMe";c.contextMenu="ContextMenu";c.unknown="Unknown";Object(t.a)(c,"TellMeScenario",null,[])},706:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b,d,f=null,e=null,k=4,l=-99999,m=0){this.QYb="";this.ZYb=-1;this.value=b;this.type=d;this.B6f=k;this.label=this.Kz=f;this.groupType=27;this.description=e;this.score=l;this.count=m}}Object(t.a)(c,"ResultBinding",null,[])},707:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b){this.attributes=null;
this.query=b;this.rh=[]}Cm(b){this.rh.push(b)}ROf(b){const d=[];for(const f of this.rh)f.groupType!==b&&d.push(f);this.rh.length!==d.length&&(this.rh=d)}get u6a(){return!1}}Object(t.a)(c,"SimpleResultsUpdatedEventArgs",null,[615])},708:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b=27,d=""){this.Dug=[];this.groupType=b;this.displayName=d}get results(){return this.Dug}Fn(b){b.groupType=this.groupType;Array.add(this.results,b)}XHd(b=1){if(this.results.length>=b)for(let d=
0;d<b;d++)Array.removeAt(this.results,this.results.length-1)}}Object(t.a)(c,"SimpleResultGroup",null,[614])},715:function(t,C,a){t=a(0);class c{constructor(d,f){this.Ira=d;this.value=f}}Object(t.a)(c,"AttrValuePair",null,[]);a.d(C,"a",function(){return b});class b{constructor(d){this.Kpa=!1;if(!d)throw Error.argumentNull("annotations");this.Pl=d;this.fD=[]}get HYa(){return this.Pl}get isReadOnly(){return this.Kpa}get rhd(){return 0<this.fD.length}Mi(d){if(!this.Pl.X6a(d))throw Error.argument("attributeID",
"Invalid attribute ID");for(const f of this.fD)if(d===f.Ira)return d=f.value,{returnValue:!0,value:d};return{returnValue:!1,value:null}}yn(d,f){var {Annotations:e}=a(694);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Pl.X6a(d))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Pl.Z5a(this.Pl.getAttributeType(d),f))throw Error.argument("value","Value is not of the correct type for the specified attribute");e.cNa(f);
for(e=0;e<this.fD.length;++e){const k=this.fD[e];if(d===k.Ira){k.value=f;return}}Array.add(this.fD,new c(d,f))}Rqc(d){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Pl.X6a(d))throw Error.argument("attributeID","Invalid attribute ID");for(let f=0;f<this.fD.length;++f)if(d===this.fD[f].Ira){Array.removeAt(this.fD,f);break}}b9b(d){if(!d)throw Error.argumentNull("action");for(const f of this.fD)d(f.Ira,f.value)}clone(){const d=new b(this.Pl);
d.tha(this);return d}tha(d){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!d)throw Error.argumentNull("other");if(d.HYa!==this.Pl)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.fD);d.b9b((f,e)=>{this.yn(f,e)})}AO(){const {Annotations:d}=a(694);let f="[",e=!0;for(const k of this.fD){e?e=!1:f+=", ";f+=this.Pl.xVe(k.Ira);f+="=";const l=this.Pl.getAttributeType(k.Ira),m=this.Pl.AO(l,k.value);l===d.tL?(f+='"',
f+=b.O7c(m),f+='"'):f+=m}return f+"]"}isEqual(d){const {Annotations:f}=a(694);if(!d)throw Error.argumentNull("other");if(this===d)return!0;if(!d||this.Pl!==d.HYa||this.rhd!==d.rhd)return!1;let e=0,k=null,l=!1;d.b9b((m,v)=>{++e;if(!l){var n=-1;for(let w=0,r=this.fD.length;w<r;++w)if(this.fD[w].Ira===m){n=w;break}0>n?l=!0:(k||(k=Array(this.fD.length)),k[n]=v)}});if(this.fD.length!==e||l)return!1;for(let m=0,v=this.fD.length;m<v;++m)if(!f.vBa(this.Pl.getAttributeType(this.fD[m].Ira),this.fD[m].value,
k[m]))return!1;return!0}QA(){return this.isReadOnly?this.clone():this}Hsd(){const {Annotations:d}=a(694);if(!this.isReadOnly){this.Kpa=!0;for(const f of this.fD)d.cNa(f.value)}}toString(){return this.AO()}static O7c(d){return d.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(t.a)(b,"FeatureBundle",null,[706,707])},726:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.click="Click";c.Ova="InteractionBegin";c.fLa="InteractionEnd";c.NAe="ControlActivated";
c.query="Query";c.vJf="QueryIndexRecorded";c.ize="Clicks";c.Qie="ActionEvents";c.yRe="FilteredActionEvents";c.wXf="SessionContext";c.latency="Latency";c.performance="Performance";c.YQf="RenderedResults";c.events="Events";c.W8g="CreateResultsMenu";c.fBa="UpdateRibbonControls";c.Rgj="ResultsAggregation";c.nv="IssueQuery";c.EZg="CommandSuggestions";c.error="Error";c.wsd="LoadModelData";c.fAi="ModelDataWaitTime";c.timedOut="TimedOut";c.nHg="AddinQueryCommandReady";c.BGh="GetAddinEntitlements";c.mJf="ProviderMRUEvents";
Object(t.a)(c,"EventNames",null,[])},732:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(){this.pud=null;this.hN=this.uud=0}Pad(b,d,f){if(!b)throw Error.argumentNull("referenceList");if(0>d||d>b.length)throw Error.argumentOutOfRange("startIndex");if(0>f||f>b.length)throw Error.argumentOutOfRange("length");if(d+f>b.length)throw Error.argument("Invalid start-length range");this.pud=b;this.uud=d;this.hN=f}oua(b,d,f){this.Pad(b.pud,b.uud+d,f)}na(b){if(0>b||b>=this.hN)throw Error.argumentOutOfRange("index");
return this.pud[this.uud+b]}get count(){return this.hN}static b3c(b){const d=new c;d.Pad(b,0,b.length);return d}}Object(t.a)(c,"ReadOnlyList",null,[731])},740:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);var c;(function(b){b[b.Classifier=0]="Classifier";b[b.AppsForOffice=1]="AppsForOffice";b[b.FindInDocument=2]="FindInDocument";b[b.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";b[b.RecentlyUsed=4]="RecentlyUsed";b[b.TryQuery=5]="TryQuery";b[b.Empty=6]="Empty";b[b.TryCommand=
7]="TryCommand";b[b.Assistance=8]="Assistance";b[b.Answer=9]="Answer";b[b.Definition=10]="Definition";b[b.Entity=11]="Entity";b[b.WolframAnswer=12]="WolframAnswer";b[b.Insights=13]="Insights";b[b.People=14]="People";b[b.Document=15]="Document";b[b.Recommended=16]="Recommended";b[b.ServiceClassifier=17]="ServiceClassifier";b[b.ServiceRecommended=18]="ServiceRecommended";b[b.Image=19]="Image";b[b.Notes=20]="Notes";b[b.Learning=21]="Learning";b[b.Feedback=22]="Feedback";b[b.Template=23]="Template";b[b.Addin=
24]="Addin";b[b.OfficeScript=25]="OfficeScript";b[b.AddinStoreEntry=26]="AddinStoreEntry";b[b.None=27]="None";b[b.MergedActions=28]="MergedActions";b[b.MergedScopedSearches=29]="MergedScopedSearches";b[b.MergedSuggestedSearches=30]="MergedSuggestedSearches"})(c||(c={}));Object(t.b)("ResultGroupType",c)},753:function(t,C,a){a.r(C);a.d(C,"CommandResultsUtility",function(){return v});t=a(0);var c=a(771),b=a(726),d=a(772),f=a(706),e=a(708),k=a(699),l=a(698),m=a(4);class v{static acg(n,w){if(w&&w.Ji){const r=
{};for(const u of n)w.jhc(u)&&(r[u]=appChrome.selectors.getModelType(u));k.TellMeActor.instance.fBa(r)}}static VHj(n){return n.startsWith("btnTellMeOfficeAddIn")}static Zva(n){const w=k.TellMeActor.instance.Ox();return!!w&&w.Ji&&!appChrome.selectors.isControlDisabled(n)}static Sic(n,w,r,u){if(k.TellMeActor.instance.sc&&n){const y=[];for(const x of n)y.push(String.format('{{"Id":"{0}","Score":{1}}}',x.commandId,x.score));n={};n[c.a.suggestions]="[{"+y.join(",")+"}]";n[c.a.uhf]=w;n[c.a.groupType]=r;
n[c.a.provider]=u;k.TellMeActor.instance.sc.sN(b.a.EZg,window.performance.now(),n)}}static GKh(n,w){const r=[],u=[];for(const y of w){w=y.commandId;let x=y;y.commandId in n&&(w=n[y.commandId],x=new d.a(w,y.score));Array.contains(u,w)||(r.push(x),u.push(w))}return r}static Cac(n,w,r,u,y,x,B,z){r.JWe&&(w=v.GKh(r.JWe,w));var A=l.a.VJh(w);v.acg(A,r);var I=[],F=[];A=[];const U=new e.a(B);B=16===B||18===B||7===B||4===B?m.AFrameworkApplication.fa?m.AFrameworkApplication.fa.nd("TellMeMaxRecommendedResultsToReturn",
3):3:0===B||17===B?5:0;for(const X of w)if(!v.kfi(X.commandId)){w=v.VHj(X.commandId);if(r.jhc(X.commandId)&&!w){if(l.a.Igf(X.commandId))continue;w=null;y&&x&&(w=y.KSh(X.commandId,x));v.Zva(X.commandId)?Array.add(I,new f.a(X.commandId,5,w,null,z,X.score)):Array.add(F,new f.a(X.commandId,5,w,null,z,X.score))}else r.KFa&&w&&u&&Array.add(A,X.commandId.substr(21));if(I.length+A.length>=B)break}r=0;for(y=0;y<I.length&&r<B;y++,r++)U.Fn(I[y]);for(I=0;I<F.length&&r<B;I++,r++)U.Fn(F[I]);for(F=0;F<A.length&&
r<B;F++,r++)u.UZj(n,A[F],U);return U}static kfi(n){v.Kse||(m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.lo("TellMeControlPredictionBlockList")&&m.AFrameworkApplication.fa.fw("TellMeControlPredictionBlockList").forEach(w=>{Array.add(v.Jse,w.toLowerCase())}),v.Kse=!0);return Array.contains(v.Jse,n.toLowerCase())}static Vld(n){return 2<n.length&&";"===n.charAt(0)&&";"===n.charAt(n.length-1)&&!!m.AFrameworkApplication.fa&&(m.AFrameworkApplication.fa.qa("TellMeCommandHookIsEnabled")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",
!1))}static xWe(n){const w=new e.a(0);var r=n.split(";");n=k.TellMeActor.instance.Ox();for(const u of r)if(0<u.length){r=u.split(":");const y=2===r.length?r[0]:u;if(!n.jhc(y))break;if(1===r.length)r=new f.a(y,5,null,null,1),w.Fn(r);else if(2===r.length)r=new f.a(y,5,r[1],null,1),w.Fn(r);else break}return w}static NAg(n,w,r){if(!(w&&w.results&&n&&n.results&&n.results.length))return{returnValue:!1,gTc:n,zTc:w};const u=[];for(var y of w.results)Array.add(u,y.value);y=0;const x=0<w.results.length?w.results[0].score:
0;for(const B of n.results)if(B.score>r&&!Array.contains(u,B.value)&&v.Zva(B.value)&&(0<x&&(B.score=x),Array.insert(w.results,y,B),y++),2===y)break;return 0<y?(r=w.results.length-5,0<r&&w.XHd(r),{returnValue:!0,gTc:n,zTc:w}):{returnValue:!1,gTc:n,zTc:w}}}v.Kse=!1;v.Jse=[];Object(t.a)(v,"CommandResultsUtility",null,[])},771:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.appName="AppName";c.vP="CloseAllMenus";c.commandId="CommandId";c.context="Context";c.culture="Culture";c.message=
"Message";c.errorMessage="ErrorMessage";c.event="Event";c.QU="CorrelationID";c.DVi="ParentUiElement";c.query="Input";c.jPa="QueryID";c.wJf="QueryLength";c.Y$a="QueryIndex";c.Sgj="ResultsList";c.suggestions="Suggestions";c.scenario="Scenario";c.sessionId="SessionID";c.source="Source";c.timeStamp="Time";c.yag="UiElement";c.eqc="ReactUx";c.value="Val";c.statusCode="StatusCode";c.bO="Service";c.isSuccess="IsSuccess";c.Ppi="LatencyType";c.groupName="GroupName";c.oKa="GroupIndex";c.groupType="GroupType";
c.Lgj="ResultInfoList";c.resultType="ResultType";c.oTd="SubResultType";c.Qhi="IsInputBlur";c.Rhi="IsInputFocus";c.Kli="IsShortCutUsed";c.actionType="ActionType";c.count="Count";c.Shh="DwellTime";c.uhf="IsZeroTerm";c.kXj="WordsCount";c.Ogc="IsSearchUxEnabled";c.Fmi="IsTellMeInHeaderEnabled";c.module="Module";c.resultIndex="ResultIndex";c.D5c="DisplayIndex";c.Mjh="EnableList";c.provider="Provider";c.contentType="ContentType";c.vli="IsSelectionBased";c.uNg="BeginPerformanceMarker";c.Zjh="EndPerformanceMarker";
c.VWi="PerformanceMeasure";Object(t.a)(c,"Columns",null,[])},772:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b,d){this.commandId=b;this.score=d}}Object(t.a)(c,"CommandSuggestion",null,[])},797:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.tellMe="TellMe";c.loki="Loki";c.substrate="Substrate";c.Y$a="QueryIndex";c.g8f="TellMeRanker";c.h8f="TellMeRankerLogging";Object(t.a)(c,"Services",null,[])},798:function(t,C,a){a.d(C,"a",function(){return c});t=
a(0);class c{}c.Caa="HttpRequest";c.provider="Provider";Object(t.a)(c,"LatencyTypes",null,[])},841:function(t,C,a){t=a(0);class c{constructor(){this.UMb=this.Cxb=null;this.bvd=this.score=this.$Bb=0}ZBd(r,u,y){this.score=r.na(u);++u;this.Cxb=r.na(u)?y.DU(r.na(u)):null;++u;this.UMb=r.na(u)?y.DU(r.na(u)):null;++u;this.$Bb=r.na(u);++u;this.bvd=r.na(u);++u;return u}}Object(t.a)(c,"TokenStringGeneratorInit",null,[]);class b{constructor(r,u,y,x,B){this.cua=r;this.count=u;this.J8b=y;this.Fx=x;this.depth=
B}}Object(t.a)(b,"ErrorTolerantTrieMatch",null,[]);var d=a(934),f=a(1098);class e{constructor(r=null,u=0,y=0,x=0){this.sxg=r||new f.a;this.CY=u;this.Fx=y;this.depth=x}get KI(){return this.sxg}getKey(){return this.KI.Gm.toString()+":"+this.CY.toString()}}Object(t.a)(e,"TrieBookmark",null,[]);class k{constructor(r,u){this.Hba=r;this.iud=u}ewi(r){if(null==r)throw Error.argumentNull("prefix");let u={};var y=u[""]=new e;this.Wcc(y,u);for(y=0;y<r.length;++y){const x=r.charCodeAt(y),B={};for(let z in u)this.SHg(x,
u[z],B);u=B}return this.nLj(u)}Wcc(r,u){if(!(r.Fx>=this.iud)&&(r=new e(d.a.H_c(r.KI),r.CY,r.Fx+1,r.depth),r.KI.Br&d.a.uoa&&(r.CY+=1),this.Hba.XSa(r.KI))){r.depth+=1;let y=!0;for(;y;)k.SAc(r,u),this.Wcc(r,u),r.CY+=this.Hba.h3a(r.KI,!0)+(r.KI.Br&d.a.uoa?1:0),y=this.Hba.eNb(r.KI)}}SHg(r,u,y){u.Fx+1<=this.iud&&(u.Fx+=1,k.SAc(u,y),--u.Fx);u.KI.Br&d.a.uoa&&(u.CY+=1);if(this.Hba.XSa(u.KI)){u.depth+=1;let x=!0;for(;x;)u.KI.KTa===r?(k.SAc(u,y),this.Wcc(u,y)):u.Fx+1<=this.iud&&(u.Fx+=1,k.SAc(u,y),this.Wcc(u,
y),--u.Fx),u.CY+=this.Hba.h3a(u.KI,!0)+(u.KI.Br&d.a.uoa?1:0),x=this.Hba.eNb(u.KI)}}nLj(r){const u=[];for(var y in r){const x=r[y];if(!x.KI.Gm)continue;const B=!!(x.KI.Br&d.a.uoa),z=this.Hba.h3a(x.KI,!1)+(B?1:0);Array.add(u,new b(x.CY,z,B,x.Fx,x.depth))}u.sort((x,B)=>{let z=x.cua-B.cua;return z||(z=-(x.count-B.count))?z:z=x.depth-B.depth});if(2>u.length)return u;r=[];for(y=0;y<u.length;)y+=k.b$f(y,u,r);return r}static SAc(r,u){const y=r.getKey();y in u?(u=u[y],u.Fx=Math.min(u.Fx,r.Fx)):u[y]=new e(d.a.H_c(r.KI),
r.CY,r.Fx,r.depth)}static b$f(r,u,y){const x=u[r];let B=x.cua;const z=B+x.count;let A=1,I=x.J8b;for(;r+A<u.length&&u[r+A].cua<z;){const F=u[r+A];F.cua>B&&(Array.add(y,new b(B,F.cua-B,I,x.Fx,x.depth)),I=!1);A+=k.b$f(r+A,u,y);B=F.cua+F.count}B<z&&Array.add(y,new b(B,z-B,I,x.Fx,x.depth));return A}}Object(t.a)(k,"ErrorTolerantTrieLookupEngine",null,[777]);class l extends c{constructor(r,u,y){super();this.Q8e=this.XDf=!1;this.XKe=null;if(r){var x=0;try{x=this.ZBd(r,x,u);this.XDf=1===r.na(x);++x;this.Q8e=
1===r.na(x);++x;const B=r.na(x);this.XKe=this.MVi(y,B)}catch(B){throw Error.argument("initData");}}}MVi(r,u){return new k(r,u)}}Object(t.a)(l,"FuzzyMatchTokenStringGeneratorInit",c,[]);class m extends c{constructor(r,u){super();this.query=this.name=null;if(r){this.annotations=u.annotations;var y=0;try{y=this.ZBd(r,y,u),this.name=u.ga(r.na(y)),++y,this.query=u.Zu(r.na(y))}catch(x){throw Error.argument("initData");}}}}Object(t.a)(m,"QueryTokenStringGeneratorInit",c,[]);class v extends c{constructor(r,
u){super();if(r)try{this.ZBd(r,0,u)}catch(y){throw Error.argument("initData");}}}Object(t.a)(v,"SurfaceStringTokenStringGeneratorInit",c,[]);var n=a(732);a.d(C,"a",function(){return w});class w{constructor(r){this.Wtd=r}get Cxb(){return this.Wtd.Cxb}get UMb(){return this.Wtd.UMb}get $Bb(){return this.Wtd.$Bb}static create(r,u,y){const {SurfaceStringTokenStringGenerator:x}=a(1333),{QueryTokenStringGenerator:B}=a(1334),{FuzzyMatchTokenStringGenerator:z}=a(1335);let A=0;try{if(r.na(A)!==w.bGa)throw Error.argument("initData",
"Input does not represent a token string generator");++A;const I=r.na(A);++A;const F=new n.a;F.oua(r,A,r.count-A);switch(I){case x.Eob:return new x(new v(F,u));case B.Eob:return new B(new m(F,u));case z.Eob:return new z(new l(F,u,y));default:throw Error.argument("initData");}}catch(I){throw Error.argument("initData");}}static ule(r,u,y,x,B,z){r=r.oKj.getId(u,null);if(0>r)return++z,z;w.vle(r,y,x,B);return z}static vle(r,u,y,x){Array.add(x.mTd,r);Array.add(x.n6f,u);++x.ceb[y]}}w.bGa=1099767983;Object(t.a)(w,
"TokenStringGenerator",null,[745])},910:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(){this.data=this.landingTab=null}}Object(t.a)(c,"LaunchData",null,[])},911:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);var c=a(698);a=a(4);class b{static Gmi(){return!c.a.Kcf()&&!c.a.jMa()&&b.isFeatureEnabled(0)}static pgf(){return b.isFeatureEnabled(1)}static Qdf(){return b.isFeatureEnabled(2)}static isFeatureEnabled(d){return!!(b.cog&1<<d)}}b.cog=a.AFrameworkApplication.fa?
a.AFrameworkApplication.fa.nd("TellMeFeatureConfigValue",0):0;Object(t.a)(b,"TellMeFeatureAvailability",null,[])},912:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);a=a(706);class c extends a.a{constructor(b,d,f,e,k=null){super(b,d,k,null,f);this.id=e}}Object(t.a)(c,"TryQueryResultBinding",a.a,[])},913:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b){this.Da=b}get bla(){return this.Da.bla}get pGj(){return 4!==this.Da.style}get tGj(){return!0}get trie(){return this.Da.trie}getId(b,
d){if(!this.pGj)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Da.style){case 0:return this.gPh(b,d);default:throw Error.notImplemented();}}ga(b){if(!this.tGj)throw Error.invalidOperation("String lookup not supported on this string table");if(0>b||b>=this.bla)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Da.style){case 0:return this.iXh(b);case 4:return this.hXh(b);default:throw Error.notImplemented();}}gPh(b,d){b=this.Da.trie.umf(b,
0,b.length,d);if(!b.succeeded)return-1;if(0>b.leb||b.leb>=this.Da.bla)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Da.fNb?this.Da.BGb.vn(this.Da.fNb+4*b.leb,4):b.leb}iXh(b){if(this.Da.fNb){let d=0;for(;d<this.Da.bla&&this.Da.BGb.vn(this.Da.fNb+4*d,4)!==b;++d);if(d>=this.Da.bla)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Da.trie.M1e(d)}return this.Da.trie.M1e(b)}hXh(b){const d=this.Da.BGb.vn(this.Da.l6f+4*b,4);b=
this.Da.BGb.vn(this.Da.m6f+4*b,4);if(0>b||0>d)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const f=Array(d);for(let e=0;e<d;++e)f[e]=({H6h:b}=this.T4i(b)).returnValue;return String.fromCharCode.apply(null,f)}T4i(b){let d=0;for(let f=0;3>f;++f){const e=this.Da.BGb.na(this.Da.ywe+b)^182;++b;d|=(e&127)<<7*f;if(!(e&128))break}return{returnValue:d,H6h:b}}}Object(t.a)(c,"StringTable",null,[729])},914:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);var c=a(934);
class b{constructor(d){this.trie=null;this.ywe=this.l6f=this.m6f=this.fNb=0;if(d){this.BGb=d;var f=0;if(d.vn(f,4)!==b.bGa)throw Error.argument("bytes","Input does not represent a string table");f+=4;this.bla=d.vn(f,4);f+=4;this.style=d.vn(f,4);f+=4;switch(this.style){case 0:const e=1===d.vn(f,4);f+=4;e||(this.fNb=f,f+=4*this.bla);d.vn(f,4);this.trie=this.jWi(d,f+4);break;case 4:this.m6f=f;this.l6f=f+=4*this.bla;f+=4*this.bla;d.vn(f,4);this.ywe=f+4;break;default:throw Error.argument("bytes");}}}jWi(d,
f){return new c.a(d,f)}}b.bGa=1025118440;Object(t.a)(b,"StringTableInit",null,[])},928:function(t,C,a){a.r(C);t=a(0);var c=a(7),b=a(15),d=a(38);class f{constructor(){this.QuickFormatType=this.Command=0;this.Formula2=this.Formula1=null;this.Value=10;this.Unique=!1;this.TimePeriodType=0;this.StopIfTrue=!1;this.Priority=-1;this.CustomFormat=null}}Object(t.a)(f,"ConditionalFormattingOptions",null,[]);var e=a(8),k=a(5),l=a(174),m=a(61);const v=(Va,Sa,vb,Oa,yb,Ob,Ja,lb=null)=>{lb=Va.Na(1,lb);lb.entireSheet=
Sa;lb.selectedRanges=vb;return m.g(Va,"GetConditionalFormattingRules",lb,Oa,yb,Ob,Ja,4)},n=(Va,Sa,vb,Oa,yb,Ob,Ja,lb,Pb=null)=>{Pb=Va.Na(9,Pb);Pb.deleteCommandType=Sa;Pb.selectedRanges=vb;Pb.id=Oa;return m.g(Va,"DeleteConditionalFormattingRules",Pb,yb,Ob,Ja,lb,0)},w=(Va,Sa,vb,Oa,yb,Ob,Ja,lb=null)=>{lb=Va.Na(9,lb);lb.sheetName=Sa;lb.id=vb;return m.g(Va,"DuplicateConditionalFormattingRule",lb,Oa,yb,Ob,Ja,0)},r=(Va,Sa,vb,Oa,yb,Ob,Ja,lb,Pb=null)=>{Pb=Va.Na(9,Pb);Pb.conditionalFormattingOptions=Sa;Pb.selectedRanges=
vb;Pb.activeCell=Oa;return m.g(Va,"AddConditionalFormattingRule",Pb,yb,Ob,Ja,lb,0)},u=(Va,Sa,vb,Oa,yb,Ob,Ja,lb,Pb,Jb=null)=>{Jb=Va.Na(9,Jb);Jb.id=Sa;Jb.conditionalFormattingOptions=vb;Jb.range=Oa;Jb.activeCell=yb;return m.g(Va,"QuickEditConditionalFormattingRule",Jb,Ob,Ja,lb,Pb,0)};var y=a(43),x=a(209),B=a(197),z=a(29),A=a(281);class I{constructor(){this.minimumCFObjectValues=this.midpointCFObjectValues=this.maximumCFObjectValues=this.minimumColor=this.midpointColor=this.maximumColor=null}}Object(t.a)(I,
"ColorScaleFormat",null,[]);class F{constructor(){this.timePeriod=this.unique=this.value=this.formula2=this.formula1=this.quickFormat=this.command=null}}Object(t.a)(F,"ConditionalFormattingEditOptions",null,[]);class U{constructor(){this.index=this.iconSet=0}}Object(t.a)(U,"ConditionalFormattingIconFormat",null,[]);class X{constructor(){this.ruleName=this.isPlaceholder=null;this.ruleType=0;this.ruleId=this.ruleRangeSheetName=this.ruleRange=null;this.priority=0;this.stopIfTrue=!1;this.editOptions=
this.iconSetFormat=this.customFormat=this.dataBarFormat=this.colorScaleFormat=null}}Object(t.a)(X,"ConditionalFormattingRule",null,[]);class S{constructor(){this.thickness=this.themeColor=this.color=this.lineStyle=this.position=null}}Object(t.a)(S,"CustomBorderFormat",null,[]);class H{constructor(){this.textColorThemeInfo=this.textColor=this.backgroundColorThemeInfo=this.backgroundColor=null;this.isTextDoubleUnderlined=this.isTextUnderlined=this.isTextStrikethrough=this.isTextItalic=this.isTextBold=
!1;this.preserveTextColor=this.preserveBackgroundColor=this.gradientFill=this.borderFormat=null}}Object(t.a)(H,"CustomFormat",null,[]);class D{constructor(){this.isLinearGradient=!1;this.degree=0;this.gradientStops=this.radialGradientPosition=null}}Object(t.a)(D,"CustomFormatGradientFill",null,[]);class J{constructor(){this.isBottom=this.isRight=this.isCenter=!1}}Object(t.a)(J,"CustomFormatRadialGradientPosition",null,[]);class M{constructor(){this.isGradientFill=!1;this.fillColor=this.borderColor=
null;this.isNegativeValuesFillColorCustom=this.isLTRDirection=!1;this.negativeValuesFillColor=null;this.isNegativeValuesBorderColorCustom=!1;this.negativeValuesBorderColor=null;this.isShowValueEnabled=!1;this.axisColor=null;this.axisPositionType=0;this.maxBoundCFObjectValues=this.minBoundCFObjectValues=null}}Object(t.a)(M,"DataBarFormat",null,[]);class G{constructor(){this.icons=null;this.isIconOnly=this.isReverseIconsOrder=!1;this.conditionalFormattingIconsCustomOptions=null}}Object(t.a)(G,"IconSetFormat",
null,[]);const T=(Va,Sa,vb,Oa,yb)=>{b.ULS.sendTraceTag(537167185,0,50,"GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback");if(Va&&A.a(Va)){a:switch(Va.Errors[0].MessageId){case -139005925:Sa=1;break a;case 1557873584:Sa=2;break a;default:Sa=0}0!==Sa?(b.ULS.sendTraceTag(593589700,0,15,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback: request ended with expected error: ${Va.Errors[0].MessageIdName}.`),yb(Oa,null,Sa)):(Oa=z.a.yc(Va.Errors),b.ULS.sendTraceTag(593589699,
0,15,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback: request ended with errors: ${Oa}.`))}else if(Va&&Va.Result){var Ob=Va.Result,Ja=Ob.Rules.length,lb=0;Va=0;for(var Pb of Ob.Rules)Pb&&lb++;b.ULS.sendTraceTag(537167184,0,50,`GetConditionalFormattingRulesHelper.ProcessConditionalFormattingResult got ${Ja} rules from server, ${Ja-lb} rules with errors.`);if(1>lb)Sa=[];else{Pb=Array(lb);for(const nb of Ob.Rules)if(nb){lb=new X;lb.ruleId=nb.RuleId;lb.ruleName=nb.Name;lb.priority=
nb.Priority;lb.stopIfTrue=nb.StopIfTrue;lb.ruleRange=y.i(y.g(nb.Range.Ranges),Sa.listSeparator,Sa,!1,!1,!1);lb.ruleRangeSheetName=vb;var Jb;Ob=lb;Ja=nb;switch(Ja.Type){case 0:Ob.ruleType=0;Ob.colorScaleFormat=new I;Ja.ColorScaleFormat?(Ob.colorScaleFormat.maximumColor=Ja.ColorScaleFormat.MaxPointColor,Ob.colorScaleFormat.maximumCFObjectValues={type:Ja.ColorScaleFormat.MaxPointCFValueObject.Type,formula:Ja.ColorScaleFormat.MaxPointCFValueObject.Formula,number:Ja.ColorScaleFormat.MaxPointCFValueObject.Number},
Ob.colorScaleFormat.minimumColor=Ja.ColorScaleFormat.MinPointColor,Ob.colorScaleFormat.minimumCFObjectValues={type:Ja.ColorScaleFormat.MinPointCFValueObject.Type,formula:Ja.ColorScaleFormat.MinPointCFValueObject.Formula,number:Ja.ColorScaleFormat.MinPointCFValueObject.Number},Ob.colorScaleFormat.midpointColor=Ja.ColorScaleFormat.MidPointColor,Ja.ColorScaleFormat.MidPointCFValueObject&&(Ob.colorScaleFormat.midpointCFObjectValues={type:Ja.ColorScaleFormat.MidPointCFValueObject.Type,formula:Ja.ColorScaleFormat.MidPointCFValueObject.Formula,
number:Ja.ColorScaleFormat.MidPointCFValueObject.Number})):b.ULS.shipAssertTag(537167183,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.ColorScaleFormat for color scale rule type");break;case 1:Ob.ruleType=1;Ob.dataBarFormat=new M;Ja.DataBarFormat?(Ob.dataBarFormat.isGradientFill=Ja.DataBarFormat.IsGradientFill,Ob.dataBarFormat.isLTRDirection=Ja.DataBarFormat.IsLTRDirection,Ob.dataBarFormat.fillColor=Ja.DataBarFormat.FillColor,Ob.dataBarFormat.borderColor=Ja.DataBarFormat.BorderColor,
Ob.dataBarFormat.isNegativeValuesFillColorCustom=Ja.DataBarFormat.IsNegativeValuesFillColorCustom,Ob.dataBarFormat.negativeValuesFillColor=Ja.DataBarFormat.NegativeValuesFillColor,Ob.dataBarFormat.isNegativeValuesBorderColorCustom=Ja.DataBarFormat.IsNegativeValuesBorderColorCustom,Ob.dataBarFormat.negativeValuesBorderColor=Ja.DataBarFormat.NegativeValuesBorderColor,Ob.dataBarFormat.isShowValueEnabled=Ja.DataBarFormat.IsShowValueEnabled,Ob.dataBarFormat.axisColor=Ja.DataBarFormat.AxisColor,Ob.dataBarFormat.axisPositionType=
Ja.DataBarFormat.AxisPositionType,Ob.dataBarFormat.minBoundCFObjectValues={type:Ja.DataBarFormat.MinBoundCFValueObject.Type,formula:Ja.DataBarFormat.MinBoundCFValueObject.Formula,number:Ja.DataBarFormat.MinBoundCFValueObject.Number},Ob.dataBarFormat.maxBoundCFObjectValues={type:Ja.DataBarFormat.MaxBoundCFValueObject.Type,formula:Ja.DataBarFormat.MaxBoundCFValueObject.Formula,number:Ja.DataBarFormat.MaxBoundCFValueObject.Number}):b.ULS.shipAssertTag(537167182,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.DataBar for color data bar rule type");
break;case 2:Ob.ruleType=2;Ob.iconSetFormat=new G;if(Ja.IconSetFormat){Ob.iconSetFormat.isReverseIconsOrder=Ja.IconSetFormat.ReverseOrder;Ob.iconSetFormat.isIconOnly=Ja.IconSetFormat.IsIconOnly;b.ULS.shipAssertTag(537167181,0,!!Ja.IconSetFormat.Icons,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.IconSetFormat.Icons for icon set rule type");Ob.iconSetFormat.icons=Array(Ja.IconSetFormat.Icons.length);Ob.iconSetFormat.conditionalFormattingIconsCustomOptions=[];for(var Lb=0;Lb<
Ja.IconSetFormat.Icons.length;Lb++)Ob.iconSetFormat.icons[Lb]=new U,Ob.iconSetFormat.icons[Lb].index=Ja.IconSetFormat.Icons[Lb].Icon,Ob.iconSetFormat.icons[Lb].iconSet=Ja.IconSetFormat.Icons[Lb].IconSet,Ob.iconSetFormat.conditionalFormattingIconsCustomOptions.push({isGreaterEqual:Ja.IconSetFormat.ConditionalFormattingIconsCustomOptions[Lb].IsGreaterEqual,cfValueObject:{type:Ja.IconSetFormat.ConditionalFormattingIconsCustomOptions[Lb].CFValueObject.Type,formula:Ja.IconSetFormat.ConditionalFormattingIconsCustomOptions[Lb].CFValueObject.Formula,
number:Ja.IconSetFormat.ConditionalFormattingIconsCustomOptions[Lb].CFValueObject.Number}})}else b.ULS.shipAssertTag(537167180,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.IconSetFormat for icon set rule type");break;case 3:Ob.ruleType=3;Ob.customFormat=new H;if(Ja.CustomFormat){Ob.customFormat.backgroundColor=Ja.CustomFormat.BackgroundColor;Ob.customFormat.textColor=Ja.CustomFormat.TextColor;Ob.customFormat.isTextBold=Ja.CustomFormat.IsTextBold;Ob.customFormat.isTextItalic=
Ja.CustomFormat.IsTextItalic;Ob.customFormat.isTextStrikethrough=Ja.CustomFormat.IsTextStrikethrough;Ob.customFormat.isTextUnderlined=Ja.CustomFormat.IsTextUnderlined;Ob.customFormat.isTextDoubleUnderlined=Ja.CustomFormat.IsTextDoubleUnderlined;if(Ja.CustomFormat.BorderFormat)for(Ob.customFormat.borderFormat=new S,Ob.customFormat.borderFormat.lineStyle=Array(4),Ob.customFormat.borderFormat.color=Array(4),Ob.customFormat.borderFormat.thickness=Array(4),Lb=0;4>Lb;Lb++)Ob.customFormat.borderFormat.lineStyle[Lb]=
Ja.CustomFormat.BorderFormat.LineStyle[Lb],Ob.customFormat.borderFormat.color[Lb]=B.a.hG(x.a.lH(Ja.CustomFormat.BorderFormat.Color[Lb])),Ob.customFormat.borderFormat.thickness[Lb]=Ja.CustomFormat.BorderFormat.Thickness[Lb];Lb=Ob.customFormat;if(Jb=Ja.CustomFormat.GradientFill)if(!Jb.GradientStops||1>=Jb.GradientStops.length||1===Jb.Type&&2!==Jb.GradientStops.length)b.ULS.shipAssertTag(591663646,0,!1,`GetConditionalFormattingRulesHelper.GetFillGradientProperties: missing gradient stops, length=${Jb.GradientStops?
Jb.GradientStops.length:-1}.`),Jb=null;else{var Ab=new D;Ab.gradientStops=Array(Jb.GradientStops.length);for(let va=0;va<Jb.GradientStops.length;va++)Ab.gradientStops[va]=B.a.hG(x.a.lH(Jb.GradientStops[va].Color));Ab.isLinearGradient=0===Jb.Type;Ab.degree=Jb.Degree;Ab.isLinearGradient||(Ab.radialGradientPosition=new J,Jb.FillToRight&&1!==Jb.FillToRight?Ab.radialGradientPosition.isCenter=!0:(Ab.radialGradientPosition.isCenter=!1,Ab.radialGradientPosition.isRight=1===Jb.FillToRight,Ab.radialGradientPosition.isBottom=
1===Jb.FillToBottom));Jb=Ab}else Jb=null;Lb.gradientFill=Jb;Ja.EditOptions&&(Ob.editOptions=new F,Ob.editOptions.command=Ja.EditOptions.Command,Ob.editOptions.formula1=Ja.EditOptions.Formula1,Ob.editOptions.formula2=Ja.EditOptions.Formula2,Ob.editOptions.value=Ja.EditOptions.Value,Ob.editOptions.unique=Ja.EditOptions.Unique,Ob.editOptions.timePeriod=Ja.EditOptions.TimePeriodType)}else b.ULS.shipAssertTag(537167179,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.CustomFormat for custom rule type");
break;default:b.ULS.sendTraceTag(537167178,0,10,"GetConditionalFormattingRulesHelper.GetReactRuleType unexpected rule type")}Pb[Va]=lb;Va++}Sa=Pb}yb(Oa,Sa,0)}else b.ULS.sendTraceTag(593589698,0,10,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback: failed to get rules from server. Result is null: ${!Va}.`)},K=Va=>{b.ULS.sendTraceTag(593589697,0,50,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesFailed: status = ${Va.data.status}, HTTP status = ${Va.data.httpStatus}.`)},
L=(Va,Sa)=>Va.priority-Sa.priority;var V=a(1),W=a(21),da=a(145);class qa extends Sys.EventArgs{constructor(Va,Sa){super();this.Gld=Sa}}Object(t.a)(qa,"ConditionalFormattingSheetProtectionOptionsChangedEventArgs",Sys.EventArgs,[]);class O{constructor(Va){this.dPi="OnProtectionOptionsChanged";this.Zsf="OnActiveSheetChanging";this.sMa=!1;this.Qa=new d.a;this.Q3b=this.aic=this.kic=this.SIb=0;this.f2b=null;this.Txa=(Sa,vb)=>{W.g(this.$).inRangePicker||W.g(this.$).xi||!vb.pa||(this.Dxe(),V.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")?
this.hdi(vb.pa)?this.Qa.raiseEvent("sheetProtectionOptionsChangedEventKey",new qa(!0,!1)):this.Vba(this.Zsf,vb.pa.sheetName,!1):this.Vba(this.Zsf,vb.pa.sheetName))};this.ctf=(Sa,vb)=>{vb.newName!==vb.oldName&&vb.newName===this.$.xa.pa.name&&this.GPj(vb.newName)};this.Uf=()=>{if(V.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")){const {sgc:Sa,kJf:vb}=this.sgc();Sa&&this.$.pa&&this.$.pa.sheetName===vb||this.Q3b===this.$.ea.to.ConditionalFormattingRulesStateId||
this.Vba("LatestCFStateIdChanged")}else this.Q3b!==this.$.ea.to.ConditionalFormattingRulesStateId&&this.Vba("LatestCFStateIdChanged")};this.Xc=(Sa,vb)=>{b.ULS.sendTraceTag(537167202,0,50,"ActiveSheetConditionalFormattingRules.OnSessionIdChanged Begin of OnSessionIdChanged");vb.EH&&this.Vba("OnSessionIdChanged");b.ULS.sendTraceTag(537167201,0,50,"ActiveSheetConditionalFormattingRules.OnSessionIdChanged End of OnSessionIdChanged")};this.Ao=()=>{b.ULS.sendTraceTag(537167200,0,50,"ActiveSheetConditionalFormattingRules.OnLoadOnDemand");
this.Vba("OnLoadOnDemand")};this.xQj=(Sa,vb,Oa=0)=>{Sa>this.aic&&(this.aic=Sa,this.f2b=vb,this.MHc=Oa,this.sMa=!0,this.Qa.raiseEvent("ConditionalFormattingRulesChangedEventKey"))};this.$Ji=(Sa,vb,Oa)=>{this.sMa=!1;K(Sa,vb,Oa)};this.$=Va;this.MHc=0;this.$.ea.to&&(this.Q3b=this.$.ea.to.ConditionalFormattingRulesStateId)}get NVe(){return this.MHc}SDg(Va){this.Qa.addHandler("ConditionalFormattingRulesChangedEventKey",Va);this.SIb++;1===this.SIb&&this.J6i();this.Vba("OnConditionalFormattingRulesChangedEventRegistered")}eaj(Va){this.Qa.removeHandler("ConditionalFormattingRulesChangedEventKey",
Va);1>this.SIb||(this.SIb--,this.SIb||this.abg())}DGg(Va){this.Qa.addHandler("sheetProtectionOptionsChangedEventKey",Va)}pcj(Va){this.Qa.removeHandler("sheetProtectionOptionsChangedEventKey",Va)}getConditionalFormattingRules(Va=null){let Sa;Sa=null;if(!this.sMa)return this.Vba("OnInvalidCache"),{returnValue:!1,e2b:Sa};Sa=this.e0g(this.f2b,Va);return{returnValue:!0,e2b:Sa}}Dxe(){this.aic=this.kic;this.f2b=null;this.sMa=!0;this.MHc=0;this.Qa.raiseEvent("ConditionalFormattingRulesChangedEventKey")}dispose(){this.abg()}Gld(){return this.$.xa?
(new da.a(this.$.xa)).Ud(4):!1}Vba(Va,Sa=null,vb=!0){if(this.$.ea.fc)if(Sa||this.$.xa.pa&&this.$.xa.pa.sheetName)if(V.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")&&vb&&!this.Gld())this.Qa.raiseEvent("sheetProtectionOptionsChangedEventKey",new qa(!0,!1));else{++this.kic;var Oa=this.kic;this.Q3b=this.$.ea.to?this.$.ea.to.ConditionalFormattingRulesStateId:0;var yb=Sa||this.$.xa.pa.sheetName;v(this.$.oa.va,!0,this.HMh(yb),Ob=>{this.aKi(Ob,yb,Oa)},this.$Ji,null,
this.$.oa.va.Sb())}else b.ULS.sendTraceTag(592487841,0,10,"ActiveSheetConditionalFormattingRules.OnConditionaFormattingRulesChanged: Sheets Active Item is null. ActiveItem is null: {0}. ActiveItem.SheetName is null: {1}. Is during application shut down: {2}. Get rules trigger method: {3}.",!this.$.pa,this.$.pa?!this.$.pa.sheetName:!1,!Sys.Application||Sys.Application.get_isDisposing(),Va),this.sMa=!1;else b.ULS.sendTraceTag(592843921,0,10,"ActiveSheetConditionalFormattingRules.OnConditionaFormattingRulesChanged: Session is not active."),
this.sMa=!1}aKi(Va,Sa,vb){Va&&Va.Result&&!A.a(Va)||(this.sMa=!1);T(Va,this.$,Sa,vb,this.xQj)}GPj(Va){for(const Sa of this.f2b)Sa.ruleRangeSheetName=Va}e0g(Va,Sa){if(!Va)return null;const vb=[];Sa=Sa?y.g(Sa):null;for(const Oa of Va)Sa&&!y.a(y.X(Oa.ruleRange,this.$.listSeparator),Sa)||vb.push(Oa);return vb}J6i(){this.$.xa.qJ(this.Txa);this.$.ea.jk(this.Xc);V.EwaSettings.isChangeGateEnabled("OfficeVSO:5080484_ConditionalFormattingManagerUpdateOnSheetRename")&&this.$.xa.gFa(this.ctf);this.$.ea.Lu(this.Uf);
this.$.ea.$L(this.Ao)}abg(){this.$.xa.SK(this.Txa);this.$.ea.Ik(this.Xc);V.EwaSettings.isChangeGateEnabled("OfficeVSO:5080484_ConditionalFormattingManagerUpdateOnSheetRename")&&this.$.xa.PPa(this.ctf);this.$.ea.Hw(this.Uf);this.$.ea.pR(this.Ao)}D7a(){this.$.ea.Ke!==e.a.Ce&&this.$.ea.fc&&this.Vba("LatestStateIdChanged")}sgc(){let Va=!1,Sa;const vb=this.$.ea.to;if(vb&&vb.SheetChanges&&this.$.xa){var Oa=vb.SheetChanges;const yb=this.$.xa.pa;if(!yb)return{sgc:!1,kJf:void 0};for(let Ob of Oa)Oa=128===
Ob.Options||131072===Ob.Options,6!==Ob.Type&&7!==Ob.Type||!Oa||(this.cPi(vb,yb,Ob),Sa=Ob.Name,Va=!0)}return{sgc:Va,kJf:Sa}}cPi(Va,Sa,vb){vb=this.$.En.getItemByName(vb.Name).index;Va=Va.Sheets[vb];vb=1024===(Va.Flags&1024);const Oa=!!Va.AllowSheetProtectionFeatures&&!!(Va.AllowSheetProtectionFeatures&4);vb=!(16===(Va.Flags&16)&&!vb)||Oa;if(Sa=Va.Name===Sa.sheetName)vb?(this.Dxe(),this.Vba(this.dPi,void 0,!1)):this.aic=this.kic;this.Qa.raiseEvent("sheetProtectionOptionsChangedEventKey",new qa(Sa,vb))}hdi(Va){const Sa=
Va.CFa&4;return!!Va&&Va.li&&!Sa}HMh(Va){return y.p(Va,"",0,0,0,0)}}Object(t.a)(O,"ActiveSheetConditionalFormattingRules",null,[]);var ea=a(1311),R=a(737),oa=a(153),pa=a(340),Pa=a(171);class Z{static dtf(Va,Sa){if(Sa&&A.a(Sa)){const vb=z.a.yc(Sa.Errors);b.ULS.sendTraceTag(578336280,0,50,`OnAddConditionalFormattingRuleSuccess: request ended with errors: ${vb}.`);Pa.b("ConditionalFormatting_OnAddConditionalFormattingRuleSuccess");Z.j2f(Va,Sa)}}static TEi(Va){b.ULS.sendTraceTag(578336279,0,50,`GetConditionalFormattingRulesHelper.OnAddConditionalFormattingRuleFailed: status = ${Va.data.status}, HTTP status = ${Va.data.httpStatus}.`)}static DIi(Va,
Sa,vb){if(vb&&A.a(vb)){const Oa=z.a.yc(vb.Errors);b.ULS.sendTraceTag(573686987,0,50,`OnEditConditionalFormattingRuleSuccess: request ended with errors: ${Oa}.`);Z.j2f(Va,vb);Z.Oyj(Va,vb);Sa.fYd()}}static CIi(Va){b.ULS.sendTraceTag(573686986,0,50,`GetConditionalFormattingRulesHelper.OnEditConditionalFormattingRuleFailed: status = ${Va.data.status}, HTTP status = ${Va.data.httpStatus}.`)}static j2f(Va,Sa){Sa&&z.a.jh(Sa.Errors,Z.conditionalFormattingAddRuleInvalidFormula)&&(Sa=z.a.Yc(1,1,2218,2219,0,
104275673,"ConditionalFormattingAddRuleInvalidFormula"),V.EwaSettings.wz()?new pa.a(Va,Sa):(new oa.ErrorDialog(Va,Sa)).Ff())}static Oyj(Va,Sa){if(Sa){let vb=null;z.a.jh(Sa.Errors,Z.conditionalFormattingCantApplyRangeOutsidePivotTable)?vb=z.a.Yc(1,1,2218,2220,0,666127521,"ConditionalFormattingCantApplyRangeOutsidePivotTable"):z.a.jh(Sa.Errors,Z.conditionalFormattingCantApplyRangeInsidePivotTable)&&(vb=z.a.Yc(1,1,2218,2221,0,1259721746,"ConditionalFormattingCantApplyRangeInsidePivotTable"));vb&&(V.EwaSettings.wz()?
new pa.a(Va,vb):(new oa.ErrorDialog(Va,vb)).Ff())}}static rHf(Va,Sa){if(Sa.startsWith("="))return Sa;if(Va=Va.da.za(266))if(Va=Va.toXLNumber(Sa),null!=Va)return Va.toString();return`="${Sa}"`}static fhi(Va,Sa,vb){let Oa;return Va.startsWith("=")&&({d6:Oa}=y.ab(Va.substring(1,Va.length),Sa,vb)).returnValue?0<Oa.length&&!(1===Oa.length&&Oa[0].isSingle):!1}static getFormulaErrorType(Va,Sa,vb){return Va?Z.fhi(Va,Sa,vb)?3:0:1}static getRangeErrorType(Va,Sa,vb){if(!Va)return 1;let Oa;return({d6:Oa}=y.ab(Va,
Sa,vb)).returnValue&&y.V(Oa)?0:2}static getRangeError(Va,Sa,vb,Oa){if(!Va)return 1;let yb;return({d6:yb}=y.ab(Va,Sa,vb)).returnValue&&y.V(yb)?this.Jli(vb,Oa)?6:0:2}static Jli(Va,Sa){Va=Va.getItemByName(Sa);if(!Va)return!1;Sa=Va.CFa&4;return!(!Va||!Va.li||Sa)}}Z.conditionalFormattingAddRuleInvalidFormula=[104275673];Z.conditionalFormattingCantApplyRangeOutsidePivotTable=[666127521];Z.conditionalFormattingCantApplyRangeInsidePivotTable=[1259721746];Object(t.a)(Z,"ConditionalFormattingRuleEditorHelper",
null,[]);var Ra=a(1281),Ga=a(33),Ba=a(14);class fa{constructor(){this.getRangeError=this.getRangeErrorType=this.getFormulaErrorType=this.addNewRuleFromTaskPane=this.onRuleEdited=this.onRuleAdded=this.setFocusOnToolbarFirstElement=this.onDeleteRulesByFilter=this.onRuleDuplicate=this.onRuleDelete=this.onRuleHoverStateChange=this.onRuleFilteringOptionsChange=this.changeTaskPaneView=null}}Object(t.a)(fa,"ConditionalFormattingTaskPaneCallbacks",null,[]);class Y{constructor(){this.type=null;this.ruleFilterOption=
this.taskPaneViewType=0;this.notification=this.uiElementsIds=this.error=this.borderMenuController=this.colorPickerButtonController=this.rangePickerController=this.updateTaskPaneTriggerMethodName=this.callbacks=this.rule=this.rules=this.firstPaneElementId=null}}Object(t.a)(Y,"ConditionalFormattingTaskPaneProps",null,[]);class ja{constructor(){this.ruleListId=this.loadingRuleListId=this.ruleManagerId=this.firstPaneElementId=null}}Object(t.a)(ja,"ConditionalFormattingUIElementIds",null,[]);class ca{constructor(Va,
Sa){this.pye=null;this.OA=Va;this.$=Sa}AI(Va,Sa,vb,Oa=null){l.UISurfaces.Lj().then(yb=>{yb.showTaskPane("ConditionalFormattingTaskPane",this.Xv(Va,Sa,vb,void 0,Oa));this.OA.jMi();return null})}vu(Va,Sa,vb,Oa=null,yb=null,Ob=0,Ja=null){l.UISurfaces.Lj().then(lb=>{const Pb=this.$.Ib.Bc("UserAction","ConditionalFormattingTPRenderStopwatch");lb.updateTaskPane("ConditionalFormattingTaskPane",this.Xv(Va,Sa,vb,Oa,yb,Ob,Ja));Pb.stop();this.OA.TRi();return null})}PM(){l.UISurfaces.Lj().then(Va=>{Va.hideTaskPane("ConditionalFormattingTaskPane",
2);return null})}U9(){this.pye()}eda(){l.UISurfaces.Lj().then(Va=>{Va.setSelectedTaskPane("ConditionalFormattingTaskPane");return null})}Xv(Va,Sa,vb,Oa=null,yb=null,Ob=0,Ja=null){const lb=Object(c.a)(new fa,{onRuleFilteringOptionsChange:this.OA.onRuleFilteringOptionsChange,onRuleHoverStateChange:this.OA.onRuleHoverStateChange,setFocusOnToolbarFirstElement:this.OA.setFocusOnToolbarFirstElement,onRuleDelete:this.OA.onRuleDelete,onRuleDuplicate:this.OA.onRuleDuplicate,changeTaskPaneView:this.OA.URi,
onDeleteRulesByFilter:this.OA.onDeleteRulesByFilter,onRuleAdded:this.OA.onRuleAdded,onRuleEdited:this.OA.onRuleEdited,addNewRuleFromTaskPane:this.OA.addNewRuleFromTaskPane,getFormulaErrorType:Jb=>Z.getFormulaErrorType(Jb,this.$.listSeparator,this.$.xa),getRangeErrorType:Jb=>Z.getRangeErrorType(Jb,this.$.listSeparator,this.$.xa),getRangeError:(Jb,Lb)=>Z.getRangeError(Jb,this.$.listSeparator,this.$.xa,Lb)}),Pb=Object(c.a)(new ja,{firstPaneElementId:Ra.a.firstPaneElementId,ruleManagerId:Ra.a.ruleManagerId,
loadingRuleListId:Ra.a.loadingRuleListId,ruleListId:Ra.a.ruleListId});Sa=Object(c.a)(new Y,{type:"ConditionalFormattingTaskPaneProps",taskPaneViewType:Sa,ruleFilterOption:vb,rules:Oa,rule:yb,firstPaneElementId:Ra.a.firstPaneElementId,callbacks:lb,rangePickerController:W.g(this.$).Df.Aac(),error:Ob,uiElementsIds:Pb,notification:Ja,colorPickerButtonController:this.OA.colorPickerButtonController,borderMenuController:this.OA.borderMenuController});if(Ga.a.Ad(this.$))return Object(c.a)(new ea.a,{contentProps:Sa,
onOpen:()=>{this.OA.fy()},onClose:()=>{this.OA.qB()},onShow:()=>{this.OA.Qzf()},onHide:()=>{this.OA.Pzf()},width:320,title:Ba.a.instance.ga(1301),preventCloseCallback:Jb=>{this.OA.hAd();this.pye=Jb}});Va=Object(c.a)(new R.a,{container:Va,paneProps:Sa});return Object(c.a)(new ea.a,{contentProps:Va,onOpen:()=>{this.OA.fy()}})}}Object(t.a)(ca,"ConditionalFormattingReactTaskPane",null,[657]);class aa{constructor(Va,Sa,vb,Oa,yb){this.iconSetFormat=this.colorScaleFormat=this.dataBarFormat=this.conditionalFormatting=
this.range=null;this.range=Sa;this.conditionalFormatting=Va;this.dataBarFormat=vb;this.colorScaleFormat=Oa;this.iconSetFormat=yb}getRange(){return this.range}}Object(t.a)(aa,"MacroRecorderRangeConditionalFormattingCreatedPayload",null,[101]);class ta{constructor(Va,Sa){this.range=null;this.priority=0;this.range=Va;this.priority=Sa}getRange(){return this.range}uvb(){return this.priority}}Object(t.a)(ta,"MacroRecorderRangeConditionalFormattingRuleDeletedPayload",null,[101]);var xa=a(65),ia=a(513),ya=
a(368),ib=a(170),wa=a(50),sa=a(413),Ya=a(37),bb=a(109),mb=a(22),Ca=a(280),$a=a(338);class Kb{constructor(){this.newJSApiPriority=this.iconSetFormat=this.colorScaleFormat=this.dataBarFormat=this.customFormat=this.stopIfTrue=this.options=this.activeCell=this.ruleRangeSheetName=this.range=this.priority=this.addRuleType=this.guid=null}}Object(t.a)(Kb,"ConditionalFormattingEditableRule",null,[]);class rb{constructor(){this.taskPaneExpandEvent=this.sheetProtectionOptionsChangedEvent=this.sheetDeletedEvent=
this.sheetRenameEvent=null}}Object(t.a)(rb,"ConditionalFormattingNotification",null,[]);class cc{constructor(){this.column=this.row=0}}Object(t.a)(cc,"ConditionalFormattingRuleActiveCell",null,[]);class nc{constructor(){this.sheetName=null}}Object(t.a)(nc,"SheetDeletedEventArgs",null,[]);class Wb{constructor(){this.newSheetName=this.oldSheetName=null}}Object(t.a)(Wb,"SheetRenameEventArgs",null,[]);class Ea{}Object(t.a)(Ea,"SheetProtectionOptionsChangedEventArgs",null,[]);class ua{}Object(t.a)(ua,
"TaskPaneExpandEventArgs",null,[]);var ma=a(55),fb=a(239);class sb{constructor(Va){this.dsa=this.hEc=this.D2d=this.Ry=null;this.Hld=this.Xva=this.sec=!1;this.oZc=[28];this.Bbb=null;this.isInitialized=!1;this.ljf=this.XNb=this.oL=0;this.EFd=this.qUf=null;this.l4e=()=>{this.qB()};this.hAd=()=>{this.N9.vu(this.dsa,0,this.PT)};this.hBf=()=>{this.ENb(!1)};this.MAd=Sa=>{V.EwaSettings.isChangeGateEnabled("OfficeVSO:6008894_CFAddNewRuleRangePickerProtectedError")&&2===this.oL?this.sendNotification({sheetProtectionOptionsChangedEvent:new Ea}):
1===this.oL&&Sa&&(++this.XNb,this.pXd(this.XNb,[],3))};this.m4e=()=>{this.Qzf()};this.Ogd=()=>{this.Pzf()};this.URi=Sa=>{1===Sa&&1!==this.oL&&(this.oL=1,this.ENb());1!==Sa&&1===this.oL&&this.tHb();0===Sa&&(Ga.a.Ad(this.$)?this.N9.U9():this.Ry.OYg());this.oL=Sa};this.iCf=(Sa,vb)=>{this.sendNotification(Object(c.a)(new rb,{sheetRenameEvent:Object(c.a)(new Wb,{oldSheetName:vb.oldName,newSheetName:vb.newName})}))};this.nD=(Sa,vb)=>{this.sendNotification(Object(c.a)(new rb,{sheetDeletedEvent:Object(c.a)(new nc,
{sheetName:vb.item.name})}))};this.yg=()=>{1!==this.oL||this.Gmd||W.g(this.$).inRangePicker||W.g(this.$).xi||this.ENb()};this.onRuleFilteringOptionsChange=Sa=>{this.PT!==Sa&&(b.ULS.sendTraceTag(42824727,0,50,`ConditionalFormattingPaneManager.OnRuleFilteringOptionsChange: filtering option has changed to: ${Sa}`),this.PT=Sa,this.ENb())};this.onRuleHoverStateChange=(Sa,vb,Oa)=>{if(Sa){let yb;({d6:yb}=y.ab(Oa,this.$.listSeparator,this.$.xa)).returnValue?W.g(this.$).lb.vv($a.a.d7(xa.d(this.$.pa),yb),this.oZc,
!0):b.ULS.shipAssertTag(537948622,0,!1,"ConditionalFormattingPaneManager.OnRuleHoverStateChange: Failed to parse range when highlighting rule range")}else W.g(this.$).lb.Mg(this.oZc)};this.onRuleDelete=Sa=>{this.deleteConditionalFormattingRules(61,this.selectedRanges,Sa)};this.onRuleDuplicate=Sa=>{this.Khh(Sa)};this.onRuleAdded=Sa=>{const {appliedRange:vb,d6:Oa}=this.R0e(Sa.range,Sa.ruleRangeSheetName,"onRuleAdded");if(vb){var yb={};Sa.activeCell?(yb.FirstRow=Sa.activeCell.row,yb.FirstColumn=Sa.activeCell.column):
(yb.FirstRow=vb.Ranges[0].FirstRow,yb.FirstColumn=vb.Ranges[0].FirstColumn);var Ob=this.WFb(Sa,!0),Ja=()=>new aa(Ob,vb,null,null,null);this.Azc();var lb=this.$.oa.va.Sb(),{ConditionalFormattingCommandHandler:Pb}=a(928);"HighlightWhen"===Pb.NCb&&Pa.b("ConditionalFormatting_HighlightWhen_RuleCreated");Pb.NCb=null;Pb=this.pUf(vb,Oa);b.ULS.sendTraceTag(526930257,0,50,`ConditionalFormattingPaneManager.OnRuleAdded: Adding a new rule with: ${Pb}`);ya.a(this.$.userOperationManager,(Jb,Lb,Ab)=>r(this.$.oa.va,
this.WFb(Sa,!1),vb,yb,Ca.b(Jb,nb=>{Z.dtf(this.$,nb)}),Ca.a(Lb,Z.TEi),Ab,lb),Jb=>new ib.a(105,0,Jb,void 0,Ja),null)}};this.onRuleEdited=Sa=>{let vb;var Oa=null;if(Sa.range)if(({d6:Pb,sheetName:Oa}=y.ab(Sa.range,this.$.listSeparator,this.$.xa)).returnValue)if(y.V(Pb))b.ULS.shipAssertTag(574410754,0,!Oa||mb.a.equals(Oa,Sa.ruleRangeSheetName,!1),"ConditionalFormattingPaneManager.OnRuleEdited: Sheet name was modified in rule range, which is not allowed when editing range"),vb=y.u(Sa.ruleRangeSheetName,
null,Pb);else{b.ULS.shipAssertTag(557601051,0,!1,"ConditionalFormattingPaneManager.OnRuleEdited: Range is invalid.");return}else{b.ULS.shipAssertTag(574410753,0,!1,"ConditionalFormattingPaneManager.OnRuleEdited: Failed to parse range when editing an existing rule");return}else vb={},vb.SheetName=Sa.ruleRangeSheetName;if(this.$.xa.contains(vb.SheetName)){var yb={FirstRow:0,FirstColumn:0};this.Azc();var Ob=this.$.oa.va.Sb(),Ja=null;this.$.aba&&(Ja=this.WFb(Sa,!0));var lb=()=>new aa(Ja,this.EFd,null,
null,null);Oa=V.EwaSettings.dc()?Jb=>new ib.a(105,0,Jb,64,lb):Jb=>new ia.a(105,0,Jb,void 0,lb);if(Sa.range){var Pb=this.pUf(vb,Pb);b.ULS.sendTraceTag(526930256,0,50,`ConditionalFormattingPaneManager.OnRuleEdited: Editing a rule with: ${Pb}`)}ya.a(this.$.userOperationManager,(Jb,Lb,Ab)=>u(this.$.oa.va,Sa.guid,this.WFb(Sa,!1),vb,yb,Ca.b(Jb,nb=>{Z.DIi(this.$,this,nb)}),Ca.a(Lb,Z.CIi),Ab,Ob),Oa,null)}else b.ULS.shipAssertTag(557682696,1,!1,"ConditionalFormattingPaneManager.OnRuleEdited: sheet wasn't found, might be renamed or deleted.")};
this.onDeleteRulesByFilter=()=>{let Sa,vb;switch(this.PT){case 0:Sa=60;vb=this.selectedRanges;break;case 1:Sa=59;vb=y.p(this.$.xa.pa.name,"",0,0,0,0);break;default:b.ULS.sendTraceTag(590448070,0,10,`ConditionalFormattingPaneManager.OnClearRules with an unknown Rule Filtering: ${this.PT}`);return}this.deleteConditionalFormattingRules(Sa,vb,null)};this.bIi=Sa=>{Sa&&A.a(Sa)&&(Sa=z.a.yc(Sa.Errors),b.ULS.sendTraceTag(595092188,0,15,`ConditionalFormattingPaneManager.OnRuleDelete: request ended with errors: ${Sa}.`),
this.fYd())};this.zIi=Sa=>{Sa&&A.a(Sa)&&(Sa=z.a.yc(Sa.Errors),b.ULS.sendTraceTag(536966945,0,15,`ConditionalFormattingPaneManager.onDuplicateRuleSuccess: request ended with errors: ${Sa}.`),this.fYd())};this.aIi=Sa=>{b.ULS.sendTraceTag(595116629,0,50,`ConditionalFormattingPaneManager.OnDeleteRuleFailure: status = ${Sa.data.status}, HTTP status = ${Sa.data.httpStatus}.`)};this.yIi=Sa=>{b.ULS.sendTraceTag(536966944,0,50,`ConditionalFormattingPaneManager.onDuplicateRuleFailure: status = ${Sa.data.status}, HTTP status = ${Sa.data.httpStatus}.`)};
this.setFocusOnToolbarFirstElement=()=>{Ga.a.Ad(this.$)?l.UISurfaces.Lj().then(Sa=>{Sa.focusTabbedTaskPaneArea();return null}):this.Ry.setFocusOnToolbarFirstElement()};this.addNewRuleFromTaskPane=()=>{const {ConditionalFormattingCommandHandler:Sa}=a(928);b.ULS.sendTraceTag(573686988,0,50,"ConditionalFormattingPaneManager.AddNewRuleFromTaskPane");this.sdc(Sa.M4c)};this.Ec=(Sa,vb)=>{!vb.fg&&this.sec&&this.qB()};this.$=Va;this.N9=new ca(this,this.$);this.ikd=this.$.Ib.Bc("UserAction","ConditionalFormattingTPInitialLoadStopwatch");
this.BX=new O(Va);this.PT=this.DFe=0;Ga.a.Ad(this.$)&&this.$.kk(this.Ec)}get colorPickerButtonController(){return this.D2d}get borderMenuController(){return this.hEc}get selectedRanges(){return y.r(W.g(this.$).ha.sa.selectedRanges,this.$)}get Gmd(){return 1===this.PT}pDe(Va=null){if(Ga.a.Ad(this.$)){const Sa=wa.GetServiceTaskFactory.create(this.$.da,111,this.$.la,0),vb=wa.GetServiceTaskFactory.Ra(this.$.da,296,468,0);Ya.TaskExtensions.Aa(Ya.TaskExtensions.Wd([Sa,vb],this.$.la),()=>{this.g9e(Sa.result,
vb.result);this.sdc(Va)},this.$.la,3)}else if(this.Ry||this.isInitialized)this.Ry&&(this.Ry.ig(!0),this.sdc(Va)),ma.Task.Ta(!0);else{this.isInitialized=!0;const Sa=wa.GetServiceTaskFactory.Ra(this.$.da,248,249,0),vb=sa.a(this.$),Oa=[Sa,vb];let yb=null,Ob=null;yb=wa.GetServiceTaskFactory.create(this.$.da,111,this.$.la,0);Oa.push(yb);Ob=wa.GetServiceTaskFactory.Ra(this.$.da,296,468,0);Oa.push(Ob);Ya.TaskExtensions.Aa(Ya.TaskExtensions.Wd(Oa,this.$.la),()=>{this.Ry=Sa.result;vb.result.uQ(this.Ry);this.VFi();
this.Ry.ig(!0);this.g9e(yb.result,Ob.result);this.sdc(Va)},this.$.la,3)}}VFi(){this.dsa=this.Ry.pM();this.Ry.aM(this.l4e);this.Ry.VFg(this.hAd);this.Ry.fUc(this.Ogd);this.Ry.gUc(this.m4e)}fy(){b.ULS.sendTraceTag(42824723,0,50,"ConditionalFormattingPaneManager.OnPaneOpen Begin of OnPaneOpen");this.Xva||(this.PN(),this.Xva=!0);this.Hld=!0}qB(){this.hideTaskPane();this.Xva&&this.Ogd(null,null);this.oL=0;this.PT=this.DFe;this.Azc()}tHb(){W.g(this.$).lb.oi(null,this.oZc)}PN(){V.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")&&
this.BX.DGg(this.MAd);this.BX.SDg(this.hBf);W.g(this.$).ha.cT(this.yg);this.$.xa.gFa(this.iCf);this.$.xa.HX(this.nD)}ENb(Va=!0){1===this.oL&&(V.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")&&Va&&!this.BX.Gld()?this.MAd(!0):(++this.XNb,this.Gmd||1!==this.BX.NVe)?({e2b:Va}=this.BX.getConditionalFormattingRules(this.Gmd?null:this.selectedRanges.Ranges)).returnValue&&(this.kdg(),this.pXd(this.XNb,Va,this.BX.NVe)):(this.kdg(),this.yQj()))}kdg(){const Va={};Va.SheetName=
this.selectedRanges.SheetName;Va.NamedObjectName=this.selectedRanges.NamedObjectName;Va.Ranges=Array(this.selectedRanges.Ranges.length);for(let Sa=0;Sa<this.selectedRanges.Ranges.length;Sa++)Va.Ranges[Sa]=this.selectedRanges.Ranges[Sa];this.EFd=Va}yQj(){if(this.$.ea.fc){var Va=this.selectedRanges;v(this.$.oa.va,!1,Va,Sa=>{T(Sa,this.$,Va.SheetName,this.XNb,(vb,Oa,yb)=>{this.pXd(vb,Oa,yb)})},K,null,this.$.oa.va.Sb())}else b.ULS.sendTraceTag(592843217,0,10,"ConditionalFormattingPaneManager.UpdateConditionalFormattingRulesFromSelection: Session is not active.")}pXd(Va,
Sa,vb){1===this.oL&&Va>=this.ljf&&(this.N9.vu(this.dsa,this.oL,this.PT,Sa,void 0,vb),this.qUf=Sa,this.ljf=Va)}Qzf(){this.Xva||(this.PN(),this.Xva=!0);Ga.a.Ad(this.$)||(this.Hld&&this.Ry.XYf(),this.Ry.uZc());V.EwaSettings.isChangeGateEnabled("OfficeVSO:6008894_CFAddNewRuleRangePickerProtectedError")&&this.sendNotification({taskPaneExpandEvent:new ua})}Pzf(){this.Xva&&(this.NOj(),this.tHb(),this.Xva=!1,this.Bbb=null)}SPi(){this.Xva&&(this.Bbb=this.$.Ib.Bc("UserAction","ConditionalFormattingRibbonCommandRenderStopwatch"))}TPi(){this.Bbb=
null}NOj(){V.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")&&this.BX.pcj(this.MAd);this.BX.eaj(this.hBf);W.g(this.$)&&W.g(this.$).ha&&W.g(this.$).ha.rR(this.yg);this.$.xa.PPa(this.iCf);this.$.xa.l6(this.nD)}sendNotification(Va){2===this.oL&&this.N9.vu(this.dsa,2,this.PT,void 0,void 0,void 0,Va)}deleteConditionalFormattingRules(Va,Sa,vb){b.ULS.sendTraceTag(591925914,0,50,`ConditionalFormattingPaneManager.OnRuleDelete with type: ${Va}, id: ${vb||"empty"}`);this.Azc();
const Oa=this.$.oa.va.Sb(),yb=this.tIh(Va,vb);let Ob;Ob=V.EwaSettings.dc()?Ja=>new ib.a(221,0,Ja,64,yb):Ja=>new ia.a(221,0,Ja,void 0,yb);ya.a(this.$.userOperationManager,(Ja,lb,Pb)=>n(this.$.oa.va,Va,Sa,vb,Ca.b(Ja,this.bIi),Ca.a(lb,this.aIi),Pb,Oa),Ob,null)}Khh(Va){let Sa=Va.guid;Sa||b.ULS.sendTraceTag(536966946,0,10,"ConditionalFormattingPaneManager.duplicateConditionalFormattingRule with missing id!");const {appliedRange:vb}=this.R0e(Va.range,Va.ruleRangeSheetName,"duplicateConditionalFormattingRule");
if(vb){var Oa=this.$.oa.va.Sb(),yb=this.WFb(Va,!0),Ob=()=>new aa(yb,vb,Va.dataBarFormat,Va.colorScaleFormat,Va.iconSetFormat);var Ja=V.EwaSettings.dc()?lb=>new ib.a(105,0,lb,64,Ob):lb=>new ia.a(105,0,lb,void 0,Ob);ya.a(this.$.userOperationManager,(lb,Pb,Jb)=>w(this.$.oa.va,Va.ruleRangeSheetName,Sa,Ca.b(lb,this.zIi),Ca.a(Pb,this.yIi),Jb,Oa),Ja,null)}}tIh(Va,Sa){let vb=-1,Oa=null;this.$.aba&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:4296101_MakerConditionalFormatDeleteByPriority")&&(Sa?1===this.PT?
{priority:vb,range:Oa}=this.iKh(Sa):(vb=this.EWe(this.qUf,Sa),Oa=this.EFd):Oa=59===Va?y.r([],this.$):this.selectedRanges);return()=>new ta(Oa,vb)}R0e(Va,Sa,vb){let Oa=null;if(({d6:Va,sheetName:Oa}=y.ab(Va,this.$.listSeparator,this.$.xa)).returnValue)if(y.V(Va)){Sa=y.u(Oa||Sa,null,Va);if(this.$.xa.contains(Sa.SheetName))return{appliedRange:Sa,d6:Va};b.ULS.shipAssertTag(557682697,1,!1,`ConditionalFormattingPaneManager.${vb}: sheet wasn't found, might be renamed or deleted.`)}else b.ULS.shipAssertTag(557601052,
0,!1,`ConditionalFormattingPaneManager.${vb}: Range is invalid.`);else b.ULS.shipAssertTag(574410755,0,!1,`ConditionalFormattingPaneManager.${vb}: Failed to parse range when adding a new rule`)}EWe(Va,Sa){for(let vb=0;vb<Va.length;++vb)if(Va[vb].ruleId===Sa)return Va=vb;return 0}iKh(Va){({e2b:Oa}=this.BX.getConditionalFormattingRules());var Sa=null;for(var vb of Oa)vb.ruleId===Va&&(Sa=vb);Sa=y.X(Sa.ruleRange,this.$.listSeparator);var Oa=Array(Sa.length);for(vb=0;vb<Sa.length;++vb)Oa[vb]=y.j(Sa[vb]);
({e2b:Oa}=this.BX.getConditionalFormattingRules(Oa));Oa.sort(L);Va=this.EWe(Oa,Va);Sa=y.r(Sa,this.$);return{priority:Va,range:Sa}}dispose(){Ga.a.Ad(this.$)&&this.$.zl(this.Ec);this.$=null;this.hideTaskPane();this.Ry&&(this.Ry.RN(this.l4e),this.Ry.Kbj(this.hAd),this.Ry.DId(this.Ogd),this.Ry.EId(this.m4e),this.Ry=this.dsa=null);this.N9=null;this.BX.dispose();this.BX=null}fYd(){1===this.oL&&this.ENb()}uWh(Va){return 1==Va.Ranges.length?(Va=Va.Ranges[0],Va.FirstRow===Va.LastRow?Va.FirstColumn===Va.LastColumn?
"Single Cell":"Row":Va.FirstColumn===Va.LastColumn?"Column":"Rectangle"):"Multi"}tWh(Va){let Sa=null;for(const vb of Va.Ranges){Va=y.B(vb);const Oa=Object(fb.a)(this.$,Va);Va=null===Oa?"None":Oa.usedRange.contains(Va)?"Containing":"Intersecting";Sa=null===Sa||Sa===Va?Va:"Intersecting"}return null===Sa?"None":Sa}D1e(Va){return 100*Math.ceil(Va/100)}pUf(Va,Sa){const vb=this.uWh(Va);Va=this.tWh(Va);Sa=this.D1e(y.b(Sa));const Oa=this.D1e(W.g(this.$).usedRange.bottom);return`rangeType ${vb} ; tableRelation: ${Va} ; numOfCellsInRangeBucket: ${Sa} ; usedRangeRowsBucket: ${Oa}`}WFb(Va,
Sa){const vb=Va.options;let Oa=null,yb=vb.quickFormat?vb.quickFormat:0;6===yb&&(Va.customFormat?(Oa=this.Myh(Va),yb=6):(b.ULS.sendTraceTag(540615491,0,15,"ConditionalFormattingPaneManager.PrepareConditionalFormattingOptions: invalid custom format."),yb=0));return Object(c.a)(new f,{Command:vb.command,QuickFormatType:yb,CustomFormat:Oa,Formula1:vb.formula1&&Sa?Z.rHf(this.$,vb.formula1):vb.formula1,Formula2:vb.formula2&&Sa?Z.rHf(this.$,vb.formula2):vb.formula2,Value:vb.value||0,Unique:vb.unique||!1,
TimePeriodType:vb.timePeriod?vb.timePeriod:0,StopIfTrue:Va.stopIfTrue||!1,Priority:Va.priority||-1})}Myh(Va){const Sa={};Sa.BackgroundColor=Va.customFormat.backgroundColor;Sa.PreserveBackgroundColor=Va.customFormat.preserveBackgroundColor||!1;Va.customFormat.backgroundColorThemeInfo&&(Sa.BackgroundColorTheme={},Sa.BackgroundColorTheme.ThemeColorIndex=Va.customFormat.backgroundColorThemeInfo.index,Sa.BackgroundColorTheme.ThemeColorRow=Va.customFormat.backgroundColorThemeInfo.row);Sa.TextColor=Va.customFormat.textColor;
Sa.PreserveTextColor=Va.customFormat.preserveTextColor||!1;Va.customFormat.textColorThemeInfo&&(Sa.TextColorTheme={},Sa.TextColorTheme.ThemeColorIndex=Va.customFormat.textColorThemeInfo.index,Sa.TextColorTheme.ThemeColorRow=Va.customFormat.textColorThemeInfo.row);Sa.IsTextBold=Va.customFormat.isTextBold;Sa.IsTextItalic=Va.customFormat.isTextItalic;Sa.IsTextStrikethrough=Va.customFormat.isTextStrikethrough;Sa.IsTextUnderlined=Va.customFormat.isTextUnderlined;Sa.IsTextDoubleUnderlined=Va.customFormat.isTextDoubleUnderlined;
this.Lyh(Va,Sa);return Sa}Lyh(Va,Sa){Sa.BorderFormat={};if(Va.customFormat.borderFormat){if(Sa.BorderFormat.Position=Va.customFormat.borderFormat.position||15,Sa.BorderFormat.LineStyle=[Va.customFormat.borderFormat.lineStyle[0],Va.customFormat.borderFormat.lineStyle[1],Va.customFormat.borderFormat.lineStyle[2],Va.customFormat.borderFormat.lineStyle[3]],Sa.BorderFormat.Color=[B.a.cp(Va.customFormat.borderFormat.color[0]).VR(),B.a.cp(Va.customFormat.borderFormat.color[1]).VR(),B.a.cp(Va.customFormat.borderFormat.color[2]).VR(),
B.a.cp(Va.customFormat.borderFormat.color[3]).VR()],Sa.BorderFormat.Thickness=[0,0,0,0],Sa.BorderFormat.ThemeBorderColor=[null,null,null,null],Va.customFormat.borderFormat.themeColor)for(let vb=0;vb<Va.customFormat.borderFormat.themeColor.length;vb++)Va.customFormat.borderFormat.themeColor[vb]&&(Sa.BorderFormat.ThemeBorderColor[vb]={},Sa.BorderFormat.ThemeBorderColor[vb].ThemeColorIndex=Va.customFormat.borderFormat.themeColor[vb].index,Sa.BorderFormat.ThemeBorderColor[vb].ThemeColorRow=Va.customFormat.borderFormat.themeColor[vb].row)}else Sa.BorderFormat.Position=
15,Sa.BorderFormat.LineStyle=[0,0,0,0],Sa.BorderFormat.Color=[0,0,0,0],Sa.BorderFormat.ThemeBorderColor=[null,null,null,null],Sa.BorderFormat.Thickness=[0,0,0,0]}jMi(){this.ikd&&(this.ikd.stop(),this.ikd=null)}TRi(){this.Bbb&&(this.Bbb.stop(),this.Bbb=null)}sdc(Va){const Sa=Va?2:1;Va=this.nPh(Va);this.sec?(this.N9.eda(),2===Sa?this.N9.vu(this.dsa,2,this.PT,void 0,Va):1!==this.oL&&this.N9.vu(this.dsa,1,this.PT)):(this.sec=!0,this.oL=Sa,this.N9.AI(this.dsa,this.oL,this.PT,Va))}hideTaskPane(){this.Hld=
this.sec=!1;this.N9.PM()}nPh(Va){if(!Va)return null;const Sa=y.o(W.g(this.$).ha.sa.activeCell,this.$);return Object(c.a)(new Kb,{guid:null,addRuleType:Va,activeCell:Object(c.a)(new cc,{row:Sa.FirstRow,column:Sa.FirstColumn}),range:y.i(W.g(this.$).ha.sa.selectedRanges,this.$.listSeparator,this.$,!1,!1,!1),ruleRangeSheetName:Sa.SheetName})}g9e(Va,Sa){this.D2d=Va.B4g();Va.I1e(!1,!1,!1,!1);this.hEc=Sa.fIh();this.xVj(this.hEc.getBorderLineStyleProps())}xVj(Va){bb.b(Va,Sa=>"BorderStyleSolidLine"===Sa.key)&&
bb.b(Va,Sa=>"BorderStyleDashedLine"===Sa.key)&&bb.b(Va,Sa=>"BorderStyleDottedLine"===Sa.key)||b.ULS.sendTraceTag(540038171,0,10,"ConditionalFormattingPaneManager.VerifyCFBorderLineStyles: CF line styles are missing.")}Azc(){V.EwaSettings.isChangeGateEnabled("OfficeVSO:6122888_ConditionalFormattingSurvey")&&this.$.ud(2034864146,-1,0,null)}}Object(t.a)(sb,"ConditionalFormattingPaneManager",null,[]);var Ua=a(24),ab=a(77),na=a(90);a.d(C,"ConditionalFormattingCommandHandler",function(){return Na});class Na{constructor(Va){this.RDa=
null;this.Qa=new d.a;this.NCb=null;this.ZHi=Sa=>{b.ULS.sendTraceTag(537167193,0,50,"ConditionalFormattingCommandHandler.OnDeleteConditionalFormattingSuccessCallback Clear CF rules from ribbon command");Sa&&A.a(Sa)&&(Sa=z.a.yc(Sa.Errors),b.ULS.sendTraceTag(589947023,0,15,`ConditionalFormattingCommandHandler.OnDeleteConditionalFormattingSuccessCallback: Clear CF rules request ended with errors: ${Sa}.`))};this.Tuf=()=>{this.RDa&&this.RDa.SPi()};this.Uuf=()=>{this.RDa&&this.RDa.TPi()};this.$=Va;Na.CVb=
!0}get MZg(){Na.qFc||this.LPg();return Na.qFc}get aFf(){this.RDa||(this.RDa=new sb(this.$));return this.RDa}Nc(){return!1}executeCommand(Va,Sa,vb){Va=Ya.TaskExtensions.fk();if(-20558303===Sa.command)return Na.CVb=!1,this.aFf.pDe(),Va;let Oa=vb[ab.a.Pc];2063445891===Sa.command&&(Oa=Na.M4c,b.ULS.sendTraceTag(542782275,0,50,"ConditionalFormattingPaneManager.QuickAccessNewRuleFromRibbon"),"HighlightWhen.2063445891"===vb[ab.a.YCj]&&(this.NCb="HighlightWhen",Pa.b("ConditionalFormatting_HighlightWhenButtonSelected")));
vb=this.hKh(Oa);switch(vb){case 12:case 13:case 8:case 9:case 10:case 11:case 1:case 2:case 4:case 5:case 3:case 7:case 6:Na.CVb=!1;2063445891!==Sa.command&&b.ULS.sendTraceTag(573686991,0,50,"ConditionalFormattingPaneManager.QuickAccessNewRuleFromTaskPane");this.aFf.pDe(Oa);break;case 59:case 62:this.Dch(vb);break;case 60:case 61:b.ULS.shipAssertTag(589947025,0,!1,"ConditionalFormattingCommandHandler.ExecuteCommand: Not expecting to execute command of type ConditionalFormattingCommand.DeleteCells or ConditionalFormattingCommand.DeleteRule from the Ribbon");
break;default:this.K4g(vb)}return Va}dispose(){this.Qa.dispose()}Cc(Va,Sa){Va=!1;switch(Sa.command){case -20558303:Va=this.$.isEditMode&&(V.EwaSettings.ma(375)||V.EwaSettings.ma(475));break;case 2063445891:case -300973317:case 97385776:Va=this.$.isEditMode}return Va}Rc(){return!1}VWe(){return y.r(W.g(this.$).ha.sa.selectedRanges,this.$)}y3f(){if(Na.$zj){const Va=new na.a(-847286761,ab.a.Eb,this.$.Mc,0,k.a.KV);this.$.Ka.Mb(Va,{["InputMethod"]:ab.a.Eb,CalloutName:1})}}K4g(Va){b.ULS.sendTraceTag(573686989,
0,50,"ConditionalFormattingPaneManager.QuickAccessNewRuleNonCustom");this.Tuf();const Sa=this.$.oa.va.Sb(),vb=y.o(W.g(this.$).ha.sa.activeCell,this.$),Oa=this.VWe(),yb=Object(c.a)(new f,{Command:Va,StopIfTrue:!1}),Ob=()=>new aa(yb,Oa,null,null,null);"HighlightWhen"===this.NCb&&Pa.b("ConditionalFormatting_HighlightWhen_RuleCreated");this.NCb=null;ya.a(this.$.userOperationManager,(Ja,lb,Pb)=>r(this.$.oa.va,yb,Oa,vb,Ca.b(Ja,Jb=>{Z.dtf(this.$,Jb)}),Ca.a(lb,()=>{this.Uuf()}),Pb,Sa),Ja=>new ib.a(105,0,
Ja,void 0,Ob),null);this.y3f()}Dch(Va){this.Tuf();const Sa=this.$.oa.va.Sb();let vb,Oa;59===Va?(Oa=y.r([],this.$),vb=y.q(new Ua.Range(1,1,e.a.dh,e.a.mh,!1,!0),this.$)):Oa=vb=this.VWe();Object(c.a)(new f,{Command:62===Va?60:Va});const yb=()=>new ta(Oa,-1);ya.a(this.$.userOperationManager,(Ob,Ja,lb)=>n(this.$.oa.va,Va,vb,null,Ca.b(Ob,this.ZHi),Ca.a(Ja,()=>{this.Uuf()}),lb,Sa),Ob=>new ib.a(221,0,Ob,void 0,yb),null);this.y3f()}hKh(Va){return this.MZg[Va]}LPg(){Na.qFc={[Na.M4c]:1,["HighlightCellsLT"]:2,
["HighlightCellsBetween"]:3,["HighlightCellsEQ"]:4,["HighlightCellsContains"]:5,["HighlightCellsDate"]:6,["HighlightCellsDupe"]:7,["TopBottomTop10"]:8,["TopBottomTop10P"]:9,["TopBottomBot10"]:10,["TopBottomBot10P"]:11,["TopBottomAA"]:12,["TopBottomBA"]:13,["DataBarsGradientFillBlue"]:15,["DataBarsGradientFillGreen"]:16,["DataBarsGradientFillRed"]:17,["DataBarsGradientFillOrange"]:18,["DataBarsGradientFillLightBlue"]:19,["DataBarsGradientFillPurple"]:20,["DataBarsSolidFillBlue"]:21,["DataBarsSolidFillGreen"]:22,
["DataBarsSolidFillRed"]:23,["DataBarsSolidFillOrange"]:24,["DataBarsSolidFillLightBlue"]:25,["DataBarsSolidFillPurple"]:26,["ColorScalesGYR"]:28,["ColorScalesRYG"]:27,["ColorScalesGWR"]:29,["ColorScalesRWG"]:30,["ColorScalesBWR"]:31,["ColorScalesRWB"]:32,["ColorScalesWR"]:35,["ColorScalesRW"]:36,["ColorScalesGW"]:38,["ColorScalesWG"]:37,["ColorScalesGY"]:33,["ColorScalesYG"]:34,["IconSetDirectional3Arrows"]:39,["IconSetDirectional3ArrowsGray"]:40,["IconSetDirectional3Triangles"]:57,["IconSetDirectional4ArrowsGray"]:48,
["IconSetDirectional4Arrows"]:47,["IconSetDirectional5ArrowsGray"]:53,["IconSetDirectional5Arrows"]:52,["IconSetShapes3TrafficLights1"]:42,["IconSetShapes3TrafficLights2"]:43,["IconSetShapes3Signs"]:44,["IconSetShapes4TrafficLights"]:51,["IconSetShapes4RedToBlack"]:49,["IconSetIndicators3Symbols"]:45,["IconSetIndicators3Symbols2"]:46,["IconSetIndicators3Flags"]:41,["IconSetRatings3Stars"]:56,["IconSetRatings4Rating"]:50,["IconSetRatings5Quarters"]:55,["IconSetRatings5Rating"]:54,["IconSetRatings5Boxes"]:58,
["ClearRulesClearCells"]:62,["ClearRulesClearSheet"]:59}}static get $zj(){return Na.CVb}}Na.qFc=null;Na.CVb=!1;Na.M4c="HighlightCellsGT";Object(t.a)(Na,"ConditionalFormattingCommandHandler",null,[195,2])},934:function(t,C,a){t=a(0);class c{constructor(l){this.mrf=l;this.succeeded=!1;this.leb=l?l.leb:0;this.zmi=!1;this.length=this.vHj=0}}Object(t.a)(c,"TrieResult",null,[]);class b{constructor(l,m,v){this.sxa=new c(null);this.Awi=l;this.QBb=m;this.Vmf=m+v-1}get result(){return this.sxa}b_e(){let l;
return this.QBb<=this.Vmf?(l=this.Awi.charAt(this.QBb),++this.QBb,{returnValue:!0,ch:l}):{returnValue:!1,ch:"\x00"}}hHd(l,m,v){l&&(this.sxa.zmi=!0,this.sxa.vHj=m);this.sxa.length=this.QBb;this.sxa.succeeded=!0;this.sxa.leb=v;this.QBb!==this.Vmf+1&&(this.sxa=new c(this.sxa))}}Object(t.a)(b,"LookUpStringVisitor",null,[744]);var d=a(1098);class f{constructor(){this.$ve=this.hue=this.jue=this.gue=this.iue=this.UXc=this.TXc=this.WXc=this.SXc=0}}Object(t.a)(f,"TRIESTATS",null,[]);class e{constructor(){this.symbol=
this.bDb=0}}Object(t.a)(e,"TrieSymbol",null,[]);a.d(C,"a",function(){return k});class k{constructor(l,m){this.ZH=null;this.qjc=this.qnf=this.onf=this.snf=this.knf=this.rnf=this.pnf=this.tnf=this.lnf=0;this.hu=l;if(l.vn(m,4)!==k.bGa)throw Error.argument("Input does not represent a trie");m+=4;this.Zmf=1===l.vn(m,4);m+=4;this.rwi=1===l.vn(m,4);m+=4;this.owi=l.vn(m,4);m+=4;if(l.vn(m,4)){l=m+4;this.ZH=this.c5i(l);this.lnf=m=l+k.iSg;this.tnf=m+=k.Z_b*(this.ZH.SXc+(this.ZH.SXc%2?1:0));this.pnf=m+=k.Z_b*
(this.ZH.WXc+(this.ZH.WXc%2?1:0));this.rnf=m+=k.Z_b*(this.ZH.TXc+(this.ZH.TXc%2?1:0));this.knf=m+=k.Z_b*(this.ZH.UXc+(this.ZH.UXc%2?1:0));this.snf=m+=k.YXc*this.ZH.gue;this.onf=m+=k.ZXc*this.ZH.jue;this.qnf=m+=k.ZXc*this.ZH.hue;m+=k.ZXc*this.ZH.iue;if(m!==l+this.ZH.$ve)throw Error.argument("Corrupted trie binary");this.qjc=m}else this.ZH=null}umf(l,m,v,n){l=new b(l,m,v);this.Lfg(l,n);return l.result}M1e(l){if(this.Zmf)if(l)--l;else return"";if(!this.ZH)throw Error.argument("Invalid trieID");const m=
new d.a;m.Br=0;this.XSa(m);const v=[];for(;;){if(m.Br&k.uoa)if(l)--l;else return Array.add(v,m.KTa),String.fromCharCode.apply(null,v);const n=!!(m.Br&k.HCc),w=this.h3a(m,!0);if(n||l<w){if(Array.add(v,m.KTa),!this.XSa(m))throw Error.argument("Invalid trieID");}else if(l-=w,!this.eNb(m))throw Error.argument("Invalid trieID");}}Lfg(l,m){let v=0;this.Zmf&&(l.hHd(this.rwi,this.owi,0),++v);if(this.ZH){var n=new d.a;n.Br=0;if(this.XSa(n))for(;;){var w=void 0;if(!({ch:w}=l.b_e()).returnValue)break;m&&(w=
m(w));w=w.toString().charCodeAt(0);let r=!1;for(;!r;){const u=!!(n.Br&k.uoa);if(n.KTa===w){if(r=!0,u&&l.hHd(!!(n.Br&k.S_d),n.syc,v),!this.XSa(n))return}else if(v+=this.h3a(n,!0),!this.eNb(n))return;u&&++v}}}}XSa(l){if(!l.Br)return this.UVd(l),!0;if(!(l.Br&k.GCc))return!1;l.Daa=0;l.Gm=l.Eva;this.UVd(l);return!0}eNb(l){if(l.Br&k.HCc)return!1;this.UVd(l);return!0}h3a(l,m){return l.Br&k.R_d?l.Y_b:l.Br&k.GCc?!m&&l.Br&k.HCc?this.HKh(l):1:0}HKh(l){l=k.H_c(l);if(!this.XSa(l))return 0;let m=0;do l.Br&k.uoa&&
++m,m+=this.h3a(l,!1);while(this.eNb(l));return m}UVd(l){l.Br||(l.Daa=0,l.Gm=this.qjc);var m=this.F4b(this.lnf,l.Gm),v=m.symbol;l.Gm+=m.bDb;m=this.hu.vn(this.knf+k.YXc*v,k.YXc);l.KTa=m&65535;l.Br=m>>16;l.Br&k.R_d&&(l.Y_b=this.ubh(l));l.Br&k.S_d&&(m=this.F4b(this.tnf,l.Gm),v=m.symbol,l.Gm+=m.bDb,l.syc=this.hu.vn(this.snf+4*v,4));l.Br&k.tjg?(l.Eva=this.qjc+((this.hu.na(l.Gm)<<8|this.hu.na(l.Gm+1))<<8|this.hu.na(l.Gm+2)),l.Gm+=3):l.Br&k.ujg?(l.Eva=l.Gm,l.Daa=l.Eva):l.Br&k.vjg?(m=this.F4b(this.pnf,l.Gm),
v=m.symbol,l.Gm+=m.bDb,l.Eva=this.qjc+this.hu.vn(this.onf+4*v,4)):l.Br&k.GCc&&(m=this.F4b(this.rnf,l.Gm),v=m.symbol,l.Gm+=m.bDb,l.Daa||(l.Daa=l.Gm),l.Daa+=this.hu.vn(this.qnf+4*v,4),l.Eva=l.Daa)}F4b(l,m){const v=new e;let n=0;for(;;){n+=this.hu.na(m);++m;++v.bDb;const w=this.hu.vn(l,2);if(n<w)break;v.symbol+=w;n-=w;l+=2;n<<=8}v.symbol+=n;return v}ubh(l){let m=this.hu.na(l.Gm);192<=m?(m=(m&63)<<15|(this.hu.na(l.Gm+1)&127)<<8,m|=this.hu.na(l.Gm+2),l.Gm+=3):128<=m?(m=(m&127)<<8|this.hu.na(l.Gm+1),l.Gm+=
2):l.Gm+=1;return m}c5i(l){const m=new f;m.SXc=this.hu.vn(l+12,2);m.WXc=this.hu.vn(l+14,2);m.TXc=this.hu.vn(l+16,2);m.UXc=this.hu.vn(l+18,2);m.iue=this.hu.vn(l+24,4);m.gue=this.hu.vn(l+28,4);m.jue=this.hu.vn(l+32,4);m.hue=this.hu.vn(l+36,4);m.$ve=this.hu.vn(l+40,4);return m}static H_c(l){const m=new d.a;m.KTa=l.KTa;m.Br=l.Br;m.Y_b=l.Y_b;m.Gm=l.Gm;m.Eva=l.Eva;m.Daa=l.Daa;m.syc=l.syc;return m}}k.bGa=1654263084;k.iSg=48;k.Z_b=2;k.ZXc=4;k.YXc=4;k.uoa=1;k.HCc=2;k.R_d=4;k.S_d=8;k.GCc=16;k.ujg=64;k.vjg=
128;k.tjg=256;Object(t.a)(k,"Trie",null,[742])},940:function(t,C,a){a.r(C);t=a(0);a(703);var c=a(726),b=a(699),d=a(4),f=a(107),e=a(25);class k{constructor(){this.gQc=0}z1i(u,y){this.gQc=window.performance.now();this.GOb(()=>{const x=window.performance.now(),B={};y.yne&&(B.callback=z=>{u(z,OSF.StoreTypeEnum.MarketPlace,x)},d.AFrameworkApplication.wb.de(e.a.X$a,2,B));y.zne&&(B.callback=z=>{u(z,OSF.StoreTypeEnum.PrivateCatalog,x)},d.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",
!0)?B.storeType=10:B.storeType=OSF.StoreTypeEnum.PrivateCatalog,d.AFrameworkApplication.wb.de(e.a.X$a,2,B))},0,()=>{if(b.TellMeActor.instance.sc)b.TellMeActor.instance.sc.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+(window.performance.now()-this.gQc)+" ms")})}GOb(u,y=0,x=null){2!==d.AFrameworkApplication.wb.processAction(e.a.X$a,1)?(b.TellMeActor.instance.sc&&b.TellMeActor.instance.sc.sN(c.a.nHg,window.performance.now()-this.gQc),u()):20>y?d.AFrameworkApplication.zi.Ag(new f.a(2,
1,500,()=>{this.GOb(u,y+1,x)})):x&&x()}static get instance(){k.Ma||(k.Ma=new k);return k.Ma}}k.Ma=null;Object(t.a)(k,"AddinEntitlementsQuery",null,[]);class l{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.crd=this.storeType=this.storeId=this.d1i=this.iconUrl=null}}Object(t.a)(l,"AddinInfo",null,[]);var m=a(706),v=a(708),n=a(707),w=a(698);a.d(C,"AddinResultsProvider",function(){return r});
class r{constructor(u){this.Ua=u;this.hKi=(y,x,B)=>{if(y){const z=y.errorCode;if(b.TellMeActor.instance.sc){const A={};A.StoreType=x;A.ErrorCode=z;A.AddinCount=y.value?y.value.length:0;b.TellMeActor.instance.sc.sN(c.a.BGh,window.performance.now()-B,A)}if(0===z&&y.value){r.rFa=r.rFa||{};y=y.value;for(const A of y)y=new l,y.displayName=A[0],y.id=A[1],y.description=A[2],y.targetType=A[3],y.appVersion=4<A.length?A[4]:"",y.assetId=5<A.length?A[5]:"",y.assetStoreId=6<A.length?A[6]:"",y.width=7<A.length?
A[7]:0,y.height=8<A.length?A[8]:0,y.iconUrl=9<A.length?A[9]:"",y.d1i=10<A.length?A[10]:"",y.storeId=11<A.length?A[11]:"",y.storeType=12<A.length?A[12]:"",this.Ua.dWf&&(y.crd=this.SPh(y)),r.rFa[y.id]=y,0<y.iconUrl.length&&appChrome.addInApi.registerAddinIcon("AddinIcon_"+y.id,y.iconUrl)}}};k.instance.z1i(this.hKi,this.Ua)}Px(){return"Add-ins"}eF(){return 0===this.Ua.Ll?0:1===this.Ua.Ll?1:2}nv(u,y,x,B,z=null){x=new n.a(u);z&&!Array.contains(z,24)||w.a.cD(u)||(z=new v.a(24),z.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,
this.vPh(u.Hd,z),x.Cm(z));y.resultsUpdated(x)}vPh(u,y){if((u=this.Fkj(u))&&0<u.length){let x=0;u.forEach(B=>{if(!(3<++x)){var z="AddinSuggestion"+x,A={};A["default"]=0<B.iconUrl.length?"AddinIcon_"+B.id:"AppForOfficeLogo_20";var I=[];I.push(appChrome.actions.setControlLabel(z,B.displayName));I.push(appChrome.actions.setControlIconSet(z,A));I.push(appChrome.actions.setCompoundButtonCommandValueId(z,B.id));I.push(appChrome.actions.updateCompoundButtonDescription(z,B.description));appChrome.api.dispatch(I);
z=new m.a(z,25,void 0,void 0,1);z.QYb=Telemetry.PrivacyRules.GetPrivacyCompliantId(B.id,B.storeType,B.assetId,null,null,B.storeId);y.Fn(z)}})}}Fkj(u){if(!r.rFa)return null;const y=[],x=r.rFa;for(let z in x){var B=x[z];B&&(this.Ua.dWf?r.ayi(u,B)&&Array.add(y,B):0<=B.displayName.toLowerCase().indexOf(u.toLowerCase())?Array.add(y,B):this.Ua.rli&&0<=B.description.toLowerCase().indexOf(u.toLowerCase())&&Array.add(y,B))}return y}SPh(u){const y=r.U4f(u.displayName);this.Ua.oHg&&Array.addRange(y,r.U4f(u.description));
return y}static ayi(u,y){if(!y.crd)return!1;for(const x of u.split(" ")){u=!1;for(const B of y.crd)if(B.toLowerCase().startsWith(x.toLowerCase())){u=!0;break}if(!u)return!1}return!0}static U4f(u){const y=[];for(const x of u.split(" ")){u=0;for(let B=0;B<x.length;B++){const z=x.charAt(B);z.toString().toUpperCase()===z.toString()&&B>u&&(Array.add(y,x.substring(u,B)),u=B)}Array.add(y,x.substring(u,x.length));u&&Array.add(y,x.substring(0,x.length))}return y}}r.rFa=null;Object(t.a)(r,"AddinResultsProvider",
null,[645])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kxta.js.map/eaa24e291744948cfd413c0104803e0e/EwaDSEsNext.kxta.js.map