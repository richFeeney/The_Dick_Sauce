'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[20],{1099:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);a=a(917);class c extends a.a{constructor(b,d,f){super(b,d);this.activeCell=null;this.activeCell=f}getActiveCell(){return this.activeCell}}Object(t.a)(c,"MacroRecorderFindCellPayload",a.a,[])},1100:function(t,C,a){a.r(C);a.d(C,"FindAndReplaceDialogDeprecated",function(){return S});t=a(0);var c=a(15),b=a(552),d=a(13),f=a(14),e=a(1101),k=a(1102),l=a(19),
m=a(915),v=a(131),n=a(43),w=a(368),r=a(170),u=a(145),y=a(210),x=a(918),B=a(916),z=a(12),A=a(281),I=a(1),F=a(22),U=a(280),X=a(96);class S extends e.a{constructor(H,D,J,M){super(H,D,J,f.a.instance.ga(53),M,I.EwaSettings.ma(396));this.kJd=X.a.Ah(f.a.instance.ob(96));this.jJd=X.a.Ah(f.a.instance.ob(100));this.iJd=X.a.Ah(f.a.instance.ga(63));this.OYc=X.a.Ah(f.a.instance.Xa(22));this.cIb=X.a.Ah(f.a.instance.Xa(23));this.mJd=X.a.Ah(f.a.instance.ga(64));this.aRf=this.Xca=this.SV=this.FMa=null;this.Zxa=G=>
{this.UQa(!0);const T=this.wAd();this.TV(5,y.a.Yia(G),"Replace");this.jsc(v.a.sdj);return T};this.M9a=G=>{const T=this.CPi();this.TV(2,y.a.Yia(G),"Replace All");this.jsc(v.a.replaceAll);return T};this.vAd=(G,T)=>{this.BKb("");let K=!1;e.a.I4a(this);this.zJ();if(!A.a(G)){let V="";var L=G.Result;G=L.ReplacedCount;L=L.SkippedReplacementsCount;0<L&&(c.ULS.sendTraceTag(524305820,0,50,`Invoke Replace, SkippedReplacementCount = ${L}`),V=String.format(this.jJd,G.toString(),L.toString()));L||(V=String.format(this.kJd,
G.toString()));T&&0<G?(K=!0,this.findNext()):G||L?this.BKb(this.vFa(V,G,T)):this.$eb=this.vFa(this.iJd,G,T)}K||this.UQa(!1)};this.Jd=J}get oc(){return"FindAndReplaceDialog"}BKb(H){this.Xca&&(this.zJ(),this.Xca.innerText=H)&&(H=z.DOMElementExtensions.getElementById(this.Lb,"resultDivId"),z.DOMElementExtensions.setVisible(H,!0))}dispose(){this.bPj();this.Xca=this.SV=null;super.dispose()}h2b(){this.T0c(!1);this.r0g(this.B9a,this.Llc,this.Zxa,this.M9a)}lCe(){this.rmb(41);this.addButton(6,27);this.aRf=
this.addButton(5,60).get_element();this.addButton(2,61)}GBe(){return e.a.ZDe(x.a.cRf,f.a.instance.ga(55))}mkd(){try{super.mkd(),this.Xca=z.DOMElementExtensions.getElementById(this.Lb,"resultLabelId"),this.SV=z.DOMElementExtensions.getElementById(this.Lb,x.a.cRf),this.SV.value=this.Ei.$hc}catch(H){}}PKb(){return!1}t3c(){const H=k.a.udj;return super.t3c()+this.d3c("resultDivId","resultLabelId",H,l.a.qth,this.$.isChromeRtl)}zJ(){const H=z.DOMElementExtensions.getElementById(this.Lb,"resultDivId");z.DOMElementExtensions.setVisible(H,
!1);this.Xca&&(this.Xca.innerText="");super.zJ()}PGd(){const H=b.a.instance;H.ra(d.a.focus,this.Xca,this.zo);H.ra(d.a.change,this.Xca,this.zo);H.ra(d.a.focus,this.SV,this.zo);H.ra(d.a.change,this.SV,this.zo);H.ra(d.a.input,this.SV,this.zo);super.PGd()}bPj(){const H=b.a.instance;H.Ba(d.a.focus,this.Xca,this.zo);H.Ba(d.a.change,this.Xca,this.zo);H.Ba(d.a.focus,this.SV,this.zo);H.Ba(d.a.change,this.SV,this.zo);H.Ba(d.a.input,this.SV,this.zo)}qT(){super.qT();this.Ei.$hc=this.SV.value}wAd(){this.qT();
const H=this.aK();this.FMa=H;e.a.I4a(this);this.zJ();c.ULS.sendTraceTag(21086273,0,50,`FindAndReplaceDialogDeprecated 'Replace' was clicked, MatchCase: ${H.MatchCase}, MatchEntireCell: ${H.MatchEntireCell}, , SearchAllSheets: ${H.SearchAllSheets}.`);this.BKb("");var D=this.YE.value;const J=this.SV.value,M=this.gridView.Vb(this.gridView.ha.sa.activeCell);if(!M)return c.ULS.sendTraceTag(524305819,0,50,"FindAndReplaceDialogDeprecated - failed getting current active cell."),this.UQa(!1),!1;let G=!1;D=
({wI:G}=this.T6b(M,D,J,!this.NZ.checked,this.OZ.checked)).returnValue;if(!D&&!G)return c.ULS.sendTraceTag(524305818,0,50,`FindAndReplaceDialogDeprecated - current cell does not contain the requested value to replace, finding next cell, MatchCase: ${H.MatchCase}, MatchEntireCell: ${H.MatchEntireCell}, , SearchAllSheets: ${H.SearchAllSheets}.`),this.BKb(""),this.$eb=this.vFa(this.mJd,D,!0),this.UQa(!1),!0;this.KOb(!0);return!0}findNext(){var H=this.aK();c.ULS.sendTraceTag(524305817,0,50,"FindNext, MatchCase: {1}, MatchEntireCell: {2}, , SearchAllSheets: {3}.",
H.MatchCase,H.MatchEntireCell,H.SearchAllSheets);let D=null;H=({jj:D}=e.a.CJa(this.$,H,this.Taa(),!1,this,J=>{J.Result&&e.a.PDb(J,this.$,this);this.UQa(!1);z.DOMElementExtensions.setFocus(this.aRf)},()=>{e.a.I4a(this);this.zJ();this.UQa(!1)})).returnValue;w.a(this.$.userOperationManager,H,J=>new r.a(147,0,J,16,D),this.Jd)}CPi(){this.qT();var H=this.aK();this.FMa=H;c.ULS.sendTraceTag(20821063,0,50,`FindAndReplaceDialogDeprecated 'Replace All' was clicked, MatchCase: ${H.MatchCase}, MatchEntireCell: ${H.MatchEntireCell}, , SearchAllSheets: ${H.SearchAllSheets}.`);
this.KOb(!1);H=this.tlh();c.ULS.sendTraceTag(524305816,0,50,`FindAndReplaceDialogDeprecated EstimateReplaceAll count = ${H}`);return!0}tlh(){if((new u.a(this.$.xa)).li)return 0;const H=this.YE.value,D=this.SV.value,J=!this.NZ.checked;var M=this.Taa();let G=0,T=0,K=0;M=this.gridView.mk("FindAndReplaceDialog.EstimateReplaceAll",M?this.gridView.ha.sa.Wc:n.f());try{for(;M.$$mn();){const L=this.gridView.Vb(M.Hn.getRange());let V=!1;K++;G+=({estimated:V}=this.T6b(L,H,D,J,this.OZ.checked)).returnValue;V&&
(T+=T)}}finally{M&&M.dispose()}c.ULS.sendTraceTag(524305815,0,50,`EstimateReplaceAll, We could have replaced - ${G}, but we only replaced ${T} out of ${K} cells. ${T/G*100}% estimation success. ${100*(G-T)/K}% noticable estimation failure`);return T}T6b(H,D,J,M,G){let T,K;var L=0;K=T=!1;if((new u.a(this.$.xa)).li)return{returnValue:0,estimated:T,wI:K};if(!H)return c.ULS.sendTraceTag(524305814,0,50,"EstimateReplaceSingleCell - currentCell == null"),{returnValue:0,estimated:T,wI:K};if(H.text){if(H.gF)return c.ULS.sendTraceTag(524305813,
0,50,"EstimateReplaceSingleCell - cell has a formula so we can not estimate"),I.EwaSettings.isChangeGateEnabled("OfficeVSO:4230178_ServerRoundTripIfFormula")&&(K=!0),{returnValue:0,estimated:T,wI:K};if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4230178_NoReplaceInCellWithRichValue")&&0!==H.cell.Ama)return c.ULS.sendTraceTag(524305812,0,50,"EstimateReplaceSingleCell - Replace in cells containing RichValues is not supported"),{returnValue:0,estimated:T,wI:!0};L=H.aTa;if(G){if(F.a.equals(L,D,M))return H.text=
J,c.ULS.sendTraceTag(524305811,0,50,"EstimateReplaceSingleCell - matchEntireCell, the replace string is equal to the source string, we estimated the result without formatting (could flicker)"),{returnValue:1,estimated:!0,wI:K};c.ULS.sendTraceTag(524305810,0,50,"EstimateReplaceSingleCell - matchEntireCell, the replace string is not equal to the source string, we should not replace (this could be counted as a good guess or no replacement)");return{returnValue:0,estimated:T,wI:K}}L=F.a.r2b(L,D,M);G=
F.a.r2b(H.text,D,M);if(e.a.lTd(D))return{returnValue:0,estimated:T,wI:!0};L===G?(D=F.a.UPa(H.text,D,J,M),H.text=D,c.ULS.sendTraceTag(524305809,0,50,"EstimateReplaceSingleCell - estimation with formatting"),T=!0):0<L&&(c.ULS.sendTraceTag(524305808,0,50,"EstimateReplaceSingleCell - replacement will happen, but we did not estimate because we do not handle with the formatting (bad guess/no guess)"),T=!1)}return{returnValue:L,estimated:T,wI:K}}KOb(H){if(this.gridView){var D=this.Taa()?this.gridView.ha.sa.Wc:
this.gridView.ha.sa.activeCell,J=n.o(this.gridView.ha.sa.activeCell,this.$),M=n.q(D,this.$);this.BKb("");var G=this.$.oa.va,T=this.aK(),K=this.SV.value;c.ULS.sendTraceTag(524305806,0,50,`WebServiceReplaceAll, isSingle: ${H}, MatchCase: ${T.MatchCase}, MatchEntireCell: ${T.MatchEntireCell}, , SearchAllSheets: ${T.SearchAllSheets}.`);var L=()=>new m.a(T,K,J,M,H);w.a(this.$.userOperationManager,(V,W,da)=>B.c(G,T,J,M,K,H,U.b(V,this.vAd),W,da,H),V=>new r.a(148,0,V,void 0,L),this.Jd)}else this.UQa(!1)}vFa(H,
D,J){const M=new u.a(this.$.xa);if(!J&&this.FMa.SearchAllSheets){if(M.taf)return H+this.cIb}else if(M.li)return D?H+this.cIb:this.OYc;return H}}Object(t.a)(S,"FindAndReplaceDialogDeprecated",e.a,[])},1101:function(t,C,a){a.d(C,"a",function(){return Pa});t=a(0);var c=a(7),b=a(15),d=a(222),f=a(13),e=a(108),k=a(85),l=a(552),m=a(185),v=a(14);C=a(731);var n=a(8),w=a(117),r=a(1102),u=a(19),y=a(5),x=a(24),B=a(65),z=a(917),A=a(1099),I=a(131),F=a(43),U=a(454),X=a(210),S=a(464),H=a(918),D=a(916),J=a(54),M=
a(12),G=a(29),T=a(281),K=a(1),L=a(465),V=a(22),W=a(280),da=a(97),qa=a(21),O=a(166),ea=a(338),R=a(132),oa=a(42),pa=a(96);class Pa extends C.a{constructor(Z,Ra,Ga,Ba="",fa=3,Y=null){super(Z,Ba||v.a.instance.ga(33),!1,fa,null!=Y?Y:K.EwaSettings.ma(394));this.findWithinSelection=v.a.instance.ga(44);this.findWithinSheet=v.a.instance.ga(45);this.findWithinWorkbook=v.a.instance.ga(46);this.Qzh=v.a.instance.ga(50);this.Qkc=pa.a.Ah(v.a.instance.ga(51));this.Cjh=pa.a.Ah(v.a.instance.ga(34));this.Rzh=v.a.instance.ga(52);
this.o$c=pa.a.Ah(v.a.instance.ob(97));this.n$c=pa.a.Ah(v.a.instance.ob(98));this.pzh=v.a.instance.ga(28);this.ozh=v.a.instance.ga(29);this.qzh=v.a.instance.ga(32);this.lAh=v.a.instance.ga(43);this.cMd=v.a.instance.ga(30);this.LKd=pa.a.Ah(v.a.instance.ga(31));this.L4=this.Phc=this.pBa=this.nBa=this.R$=this.SJ=this.NZ=this.OZ=this.fHc=this.iif=null;this.D7a=()=>{this.$.ea.Ke!==n.a.Ce&&this.$.ea.fc&&this.Tmd()&&(this.seg=this.LKd)};this.GAd=()=>{this.q9c(!1);if(this.Pe){const ja=M.DOMElementExtensions.getElementById(this.Lb,
"searchOptionsDivId");X.a.Izc(ja)}return!0};this.mTa=()=>{const ja=Pa.jwa(this.$);if(!ja||this.SJ&&this.SJ.options&&this.SJ.options.length)this.SJ.options[0].disabled=!ja,this.Ei.EZ||(this.Ei.EZ=this.findWithinSelection),ja||this.Ei.EZ!==this.findWithinSelection||(this.Ei.EZ=this.findWithinSheet),this.SJ.value=this.Ei.EZ};this.zo=()=>{this.zJ();this.qT();return!0};this.Zxa=ja=>{var {FindAndReplaceDialogDeprecated:ca}=a(1100);b.ULS.sendTraceTag(524305803,0,50,"Open Find and Replace Dialog");this.operation=
1059985902;this.qT();this.Pe?(this.close(5),ca=new ca(this.$,this.Ei,this.Jd,7)):(ca=new ca(this.$,this.Ei,this.Jd,7),this.close(5));ca.Ff();this.TV(5,X.a.Yia(ja),"Replace");return!0};this.jzd=ja=>{ja=ja.Tv;const ca=Number.parseInvariant(ja.id);this.Ttc(ca,ja);return!0};this.fJi=ja=>{const ca=ja.Cb;let aa=Number.parseInvariant(ca.id);if(40===ja.Ca.keyCode)ja=ca.nextSibling,aa++;else if(38===ja.Ca.keyCode)ja=ca.previousSibling,aa--;else return!1;ja&&V.a.equals(ja.id,aa.toString(),!0)&&this.Ttc(aa,
ja);return!0};this.RGi=()=>{this.Pu();return!0};this.Ei=Ra;this.fq=qa.g(this.$);this.Jd=Ga;this.operation=1461300262;this.w7a=Number.NaN;this.JEa=205;this.Zfb=null}get oc(){return"FindDialog"}get gridView(){return this.fq}get LGa(){return 18}get YE(){return this.fHc}get $eb(){return this.nBa?this.nBa.innerText:null}set $eb(Z){this.nBa&&(this.zJ(),this.nBa.innerText=Z)&&(Z=M.DOMElementExtensions.getElementById(this.Lb,"alertDivId"),M.DOMElementExtensions.setVisible(Z,!0))}get seg(){return this.pBa?
this.pBa.innerText:null}set seg(Z){this.pBa&&(this.zJ(),this.pBa.innerText=Z)&&(Z=M.DOMElementExtensions.getElementById(this.Lb,"infoDivId"),M.DOMElementExtensions.setVisible(Z,!0))}dispose(){this.IOj();this.CNf(!1);this.gridView.lb.oi(null,Pa.k3);this.$.ea&&this.$.ea.BD(this.D7a);this.OZ=this.NZ=this.R$=this.SJ=this.fHc=null;super.dispose()}n_f(Z){this.YE&&(this.YE.value=Z)}initialize(){this.Lb.innerHTML=Pa.r$g()+(Pa.igf?Pa.C$g():"<br/>")+this.GBe()+this.y3g()+'<div id ="findAllResults"></div>'+
this.t3c()+this.z6g();this.q9c(!0);this.$.ea&&this.$.ea.kE(this.D7a);this.Lb.classList.add(r.a.GRe);this.Pe?this.h2b():this.hn();super.initialize();R.b(this.$).MSd("FindDialogCorellation")}h2b(){this.T0c(!1);this.$.isEditMode?this.u0g(this.B9a,this.Llc,this.Zxa):this.kAe(41,this.B9a,27,this.Llc)}z6g(){return this.d3c("infoDivId","InfoLabelId",r.a.iAh,u.a.dPe,this.$.isChromeRtl)}CNf(Z){const Ra=M.DOMElementExtensions.getElementById(this.Lb,"searchOptionsDivId");Z?(d.a.instance.ra(f.a.click,Ra,this.GAd),
this.iif=e.KeyInputManager.instance.ms(Ra,this.GAd,k.a.$h,k.a.A0)):(d.a.instance.Ba(f.a.click,Ra,this.GAd),e.KeyInputManager.instance.Bv(Ra,this.iif))}Tmd(){const Z=M.DOMElementExtensions.getElementById(this.Lb,"findAllResults");return!!Z&&!!Z.childNodes&&0<Z.childNodes.length}q9c(Z){var Ra=M.DOMElementExtensions.getElementById(this.Lb,"chevronDivId");const Ga=M.DOMElementExtensions.getElementById(this.Lb,"advancedOptionsId");if(Ga){var Ba=V.a.contains(Ga.className,r.a.collapsed,!0);Z=Z||!Ba;M.DOMElementExtensions.toggleCssClass(Ga,
r.a.collapsed,Z);M.DOMElementExtensions.toggleCssClass(Ra,r.a.KWg,Z);M.DOMElementExtensions.toggleCssClass(Ra,r.a.fxe,!Z);(Ra=M.DOMElementExtensions.getElementById(this.Lb,"searchOptionsDivId"))&&Ra.setAttribute(y.a.LX,Z?y.a.fr:y.a.lk)}}PGd(){const Z=l.a.instance;this.gridView&&this.gridView.ha&&this.gridView.ha.cT(this.mTa);Z.ra(f.a.focus,this.YE,this.zo);Z.ra(f.a.change,this.YE,this.zo);Z.ra(f.a.input,this.YE,this.zo);Z.ra(f.a.focus,this.R$,this.zo);Z.ra(f.a.change,this.R$,this.zo);Z.ra(f.a.focus,
this.SJ,this.zo);Z.ra(f.a.change,this.SJ,this.zo);Z.ra(f.a.focus,this.NZ,this.zo);Z.ra(f.a.change,this.NZ,this.zo);Z.ra(f.a.focus,this.OZ,this.zo);Z.ra(f.a.change,this.OZ,this.zo)}IOj(){const Z=l.a.instance;this.gridView&&this.gridView.ha&&this.gridView.ha.rR(this.mTa);Z.Ba(f.a.focus,this.YE,this.zo);Z.Ba(f.a.change,this.YE,this.zo);Z.Ba(f.a.input,this.YE,this.zo);Z.Ba(f.a.focus,this.R$,this.zo);Z.Ba(f.a.change,this.R$,this.zo);Z.Ba(f.a.focus,this.SJ,this.zo);Z.Ba(f.a.change,this.SJ,this.zo);Z.Ba(f.a.focus,
this.NZ,this.zo);Z.Ba(f.a.change,this.NZ,this.zo);Z.Ba(f.a.focus,this.OZ,this.zo);Z.Ba(f.a.change,this.OZ,this.zo)}mkd(){try{this.NZ=M.DOMElementExtensions.getElementById(this.Lb,"matchCaseCheckBoxId"),this.OZ=M.DOMElementExtensions.getElementById(this.Lb,"matchEntireCellCheckBoxId"),this.SJ=M.DOMElementExtensions.getElementById(this.Lb,"findWithinSelection"),this.SJ.value=Pa.jwa(this.$)?this.findWithinSelection:this.findWithinSheet,this.NZ.checked=this.Ei.EAb,this.OZ.checked=this.Ei.FAb,this.nBa=
M.DOMElementExtensions.getElementById(this.Lb,"userAlertLabelId"),this.pBa=M.DOMElementExtensions.getElementById(this.Lb,"InfoLabelId"),this.zJ()}catch(Z){}}t3c(){return this.d3c("alertDivId","userAlertLabelId",r.a.hAh,u.a.ith,this.$.isChromeRtl)}qT(){this.Ei.GMa=this.YE.value;this.Ei.Wwa=this.R$.value===Pa.w8b;this.Ei.EAb=this.NZ.checked;this.Ei.FAb=this.OZ.checked;this.Ei.EZ=this.SJ.value}lCe(){this.rmb(41);this.addButton(6,27);this.$.isEditMode&&this.addButton(5,59)}GBe(){return""}lvf(Z){b.ULS.sendTraceTag(524305802,
0,50,"Find All button was clicked");this.operation=788780084;this.JEa=205;this.qT();this.zJ();this.onButtonClick(6,X.a.Yia(Z),X.a.l3a(Z),"Find All");this.jsc(I.a.findAll);return!0}jsc(Z){let Ra={["FindWithinValue"]:this.SJ.value,["MatchCase"]:this.NZ.checked,["MatchEntireCell"]:this.OZ.checked,["FindDirection"]:this.R$.value,["NumberOfSelectedRanges"]:this.gridView.ha.sa.EK,["Location"]:"dialog"};R.b(this.$).Cd(Z,Ra)}Pu(){R.b(this.$).cTd("FindDialogCorellation");super.Pu()}close(Z){this.qT();this.gridView.lb.oi(null,
Pa.k3);super.close(Z)}PPd(Z){return 6===Z||super.PPd(Z)}y3g(){var Z=r.a.Jkj;this.Pe&&(Z+=" "+w.a.Vmh+" "+w.a.Pmh);Z=`<div id=${"searchOptionsDivId"} class="${Z}" aria-live="polite" role="button" aria-expanded="false" tabindex="0">`+`<div id=${"chevronDivId"} class="${u.a.PA} ${r.a.fxe}"> <input class=${u.a.osh} type ="image" src=${J.a.hf(1)} tabindex="-1" /></div>`+`<p class=${r.a.cMd}>${this.cMd}</p>`+"</div><div id=advancedOptionsId>";const Ra=new m.a;Ra.insert(0,this.findWithinSelection);Ra.insert(1,
this.findWithinSheet);Ra.insert(2,this.findWithinWorkbook);Z+=`<div class=${r.a.UHg}>`+`<div class=${r.a.vIe}>`+Pa.JDe(this.lAh,"findWithinSelection",Ra)+"</div>"+`<div class=${r.a.vIe}>`+Pa.m9g()+"\r\n</div></div>";return Z+=Pa.dCe(this.Qzh,"matchCaseCheckBoxId",this.Pe)+"\r\n"+Pa.dCe(this.Rzh,"matchEntireCellCheckBoxId",this.Pe)+"\r\n<br></div>"}setFocus(){this.YE&&(M.DOMElementExtensions.setFocus(this.YE),L.a(this.YE,0,this.YE.value.length))}rOb(){let Z=!0;this.YE.value||(Z=!1,this.$eb=this.Cjh,
b.ULS.sendTraceTag(524305801,0,50,"FindDialogDeprecated - EmptyInvalidFindContentErrorMessage was shown to user (Ewr_FindInvalidFindContent)"));return Object(c.a)(new S.a,{isValid:Z,error:null})}KA(){this.qT();const Z=this.aK();if(!Z)return b.ULS.sendTraceTag(524305800,0,10,"cannot get find data, cannot call find cell operation"),null;if(this.L4){const Ra=V.a.equals(Z.SearchString,this.L4.SearchString,!1)&&Z.MatchCase===this.L4.MatchCase&&Z.MatchEntireCell===this.L4.MatchEntireCell;b.ULS.sendTraceTag(524305799,
0,50,`FindNext - is find data changed between clicks? sameData=${Ra}, stateId=${this.$.ea.Ke}`)}this.L4=Z;return({jj:this.Zfb}=Pa.CJa(this.$,Z,this.Taa(),788780084===this.operation,this,()=>{this.setFocus();this.operation=1891435765;this.JEa=147})).returnValue}get Rw(){return this.JEa}jj(){return this.Zfb}Taa(){const Z=this.SJ.value;return Pa.jwa(this.$)&&V.a.equals(Z,this.findWithinSelection,!1)}Ttc(Z,Ra){if(!isNaN(this.w7a)&&this.w7a!==Z){var Ga=M.DOMElementExtensions.getElementById(Ra.parentNode,
this.w7a.toString());Ga&&(Ga.style.background="")}this.w7a=Z;Ra.style.background="rgba(200,225,180,0.3)";Ga=this.Phc.Results[Z].SheetCell;Z=F.C(Ga);if(Ga=this.$.xa.getItemByName(Ga.SheetName))Ga=F.m(Z,Ga),this.gridView.Dg(Ga,Z,null,null,60,da.a.JRe,void 0,void 0,void 0,void 0,!0);Ra.focus()}hn(){this.qkd();this.MXc.classList.add(r.a.GRe);this.CNf(!0);this.Pe||this.lCe();this.R$.value=this.Ei.Wwa?Pa.w8b:Pa.KRe;this.YE.value=this.Ei.GMa||"";this.mTa(this);this.PGd();super.hn()}qkd(){this.mkd();this.fHc=
M.DOMElementExtensions.getElementById(this.Lb,H.a.A$c);this.R$=M.DOMElementExtensions.getElementById(this.Lb,H.a.LRe);if(!this.Pe){const Z=document.getElementById("ewaDialogCloseButtonLink");Z.tabIndex=0;e.KeyInputManager.instance.ms(Z,this.RGi,k.a.$h,k.a.A0)}}PKb(){return!1}A9a(Z){this.operation=1891435765;this.JEa=149;this.qT();this.zJ();b.ULS.sendTraceTag(21086280,0,50,`FindDialogDeprecated 'Find Next' was clicked. FindDirection: ${this.Ei.Wwa?"Up":"Down"}`);const Ra=X.a.Yia(Z);Z=X.a.l3a(Z);O.a.current.AR=
"Find Next";this.onButtonClick(0,Ra,Z,"Find Next");this.jsc(I.a.findNext);return!0}zJ(){var Z=M.DOMElementExtensions.getElementById(this.Lb,"alertDivId");M.DOMElementExtensions.setVisible(Z,!1);Z=M.DOMElementExtensions.getElementById(this.Lb,"infoDivId");M.DOMElementExtensions.setVisible(Z,!1);this.nBa&&(this.nBa.innerText="");this.pBa&&(this.pBa.innerText="")}aK(){const Z={};if(!this.$)return b.ULS.sendTraceTag(524305798,0,15,"FindDialogDeprecated:EwaControl is null when tryng to get find data"),
null;var Ra=qa.g(this.$);(Ra=(Ra=Ra?Ra.ha.sa.activeCell:x.Range.Uc(1,1))?F.o(Ra,this.$):null)&&Ra.SheetName?Z.SheetName=Ra.SheetName:b.ULS.sendTraceTag(524305797,0,15,`could not find sheet name, Sheets/ActiveItem is null EwaControl.Sheets = ${this.$.xa}`);Z.SearchString=this.YE.value;Z.MatchCase=this.NZ.checked;Z.MatchEntireCell=this.OZ.checked;Z.SearchAllSheets=!this.Taa()&&this.SJ.value===this.findWithinWorkbook;Z.SearchUp=this.R$.value===Pa.w8b;Z.ExcludeFormulaResult=!1;return Z}d3c(Z,Ra,Ga,Ba,
fa){fa=fa?"right":"left";return K.EwaSettings.isChangeGateEnabled("OfficeVSO:4295667_FindAndReplaceDialogNarrtorFix")?`
        <div id=${Z} class=${Ga} aria-labelledby="${Ra}">
        <div class=${r.a.bSe}>
        <div class=${u.a.PA}>
        <img class=${Ba} src=${J.a.hf(3)} tabindex="-1" aria-hidden="true">
        </img>
        </div>
        <b id = "${Ra}" aria-live="polite" role="alert" style="margin-${fa}: 7px; width: 327px;"></b>
        </div>
        </div>`:`
        <div id=${Z} class=${Ga} aria-live="polite" role="alert" aria-labelledby="${Ra}">
        <div class=${r.a.bSe}>
        <div class=${u.a.PA}>
        <img class=${Ba} src=${J.a.hf(3)} tabindex="-1" aria-hidden="true">
        </img>
        </div>
        <b id = "${Ra}" style="margin-${fa}: 7px; width: 327px;"></b>
        </div>
        </div>`}static CJa(Z,Ra,Ga,Ba,fa,Y=null,ja=null,ca=!1){const aa=qa.g(Z),ta=aa?aa.ha.sa.activeCell:x.Range.Uc(1,1),xa=F.o(ta,Z);fa&&fa.zJ();const ia=(Ga=Ga&&!!aa&&Pa.jwa(Z))?F.q(aa.ha.sa.Wc,Z):F.q(ta,Z);Ga=Ba?ya=>{Pa.kzd(ya,Z,fa)}:ya=>{Pa.PDb(ya,Z,fa)};Y=Y?ca?W.b(Ga,Y):W.b(Y,Ga):Ga;Ra.SheetName||(Ra.SheetName=xa.SheetName);return{returnValue:(ya,ib,wa)=>Ba?D.a(Z.oa.va,Ra,ia,W.b(ya,Y),ja?W.a(ib,ja):ib,wa,Z):D.b(Z.oa.va,Ra,xa,ia,W.b(ya,Y),ja?W.a(ib,ja):ib,wa,Z),jj:Ba?()=>new z.a(Ra,ia):()=>new A.a(Ra,
ia,xa)}}static jwa(Z){Z=qa.g(Z).ha.sa;return Z.wg&&!Z.jba()}static ZDe(Z,Ra){return`<div class='${w.a.Mn}'>\r\n\t<label for='${Z}'>${Ra}</label>\r\n</div>`+(Pa.igf?`<div class='${w.a.Mn}'>`:"<div>")+`<input type='text' id='${Z}' maxlength='255' class='${w.a.VE}' /></div>`}static kzd(Z,Ra,Ga){if(Ga.domElement)if(Pa.I4a(Ga),Ga.zJ(),T.a(Z))b.ULS.shipAssertTag(524305794,0,!1,"FindDialog.OnFindAllWebMethodSuccess: EwaResult contains NonStatusMessages.");else if(Z=Z.Result)if(Z.Results){if(Z.Results.length){Ga.Phc=
Z;Ga.w7a=Number.NaN;const Ba=1E3<Z.Results.length,fa=Math.min(Z.Results.length,1E3);Ga.q9c(!0);Pa.H5g(M.DOMElementExtensions.getElementById(Ga.Lb,"findAllResults"),Z,fa,Ga,Ba);Pa.zid(Z,fa,Ra)}else Ga.$eb=Ga.Qkc;Ga.Czd()}else b.ULS.shipAssertTag(524305792,0,!1,"FindDialog.OnFindAllWebMethodSuccess: findAllResult.Results is null");else b.ULS.shipAssertTag(524305793,0,!1,"FindDialog.OnFindAllWebMethodSuccess: findAllResult is null")}static PDb(Z,Ra,Ga){Ga&&(Pa.I4a(Ga),Ga.zJ());if(T.a(Z))O.a.current.q_a("FindEndedWithErrors");
else if((Z=Z.Result)&&Z.SheetRange){const Ba=F.D(Z.SheetRange);Ga=Z.FoundInRichValue;const fa=qa.g(Ra);fa&&(fa.ha.sa.wg&&fa.ha.sa.Wc.contains(Ba)?fa.Dg(F.v(fa.ha.sa.Wc,Ra),Ba,null,null,60,da.a.IRe,void 0,void 0,void 0,Ba,!0):fa.Dg(Z.SheetRange,Ba,null,null,60,da.a.HRe,void 0,void 0,void 0,void 0,!0),fa.Ea.oK(1,Ra.pa)&&O.a.current.b7c("FindEnded",Ra),V.a.equals(Ra.pa.sheetName,Z.SheetRange.SheetName,!0)&&Pa.Aid(Ba,Ra),Ga&&Ba&&K.EwaSettings.ma(104)&&(b.ULS.sendTraceTag(524305762,0,50,"FindDialogDeprecated.OnFindCellWebMethodSuccess: FoundInRichValue"),
U.a(Ra,243,242,0,Y=>{Y.Zcb(Ba.top,Ba.left,1,!1,!1)})))}else Pa.Qgd(Ga,Ra)}static I4a(Z){Z&&(Z=M.DOMElementExtensions.getElementById(Z.Lb,"findAllResults"))&&M.DOMElementExtensions.Pqc(Z)}static zid(Z,Ra,Ga){if(Ra){var Ba=Array(Ra);for(let fa=0;fa<Ra;fa++){const Y=Z.Results[fa].SheetCell;b.ULS.shipAssertTag(524305761,0,!!Y,"FindDialog.OnFindAllWebMethodSuccess: cell is null");const ja=Ga.xa.getItemByName(Y.SheetName);ja&&(Ba[fa]=new ea.a(F.C(Y),B.d(ja)))}qa.g(Ga).lb.vv(Ba,Pa.k3,!0)}}static Aid(Z,Ra){qa.g(Ra).lb.oi(Z,
Pa.k3);qa.g(Ra).lb.zn(Pa.k3)}static Qgd(Z,Ra){Z?1891435765===Z.operation&&(Z.zJ(),Pa.I4a(Z),Z.$eb=Z.Qkc,b.ULS.sendTraceTag(524305759,0,50,"FindDialogDeprecated - Find Next ExcelServerMessageId.NoOccurrencesFound from find dialog")):(Z=G.a.Yc(1,2,0,51,0,-1736450117,"NoOccurrencesFound"),oa.a(Ra).vr([Z]),b.ULS.sendTraceTag(524305760,0,50,"FindDialogDeprecated - Find Next ExcelServerMessageId.NoOccurrencesFound from shortcut keys"))}static H5g(Z,Ra,Ga,Ba,fa){fa=fa?String.format(Ba.n$c,1E3):String.format(Ba.o$c,
Ga);Z.setAttribute("aria-live","polite");Z.innerHTML=`<p id="tableHeader" style="font-size:14px; margin-top:5px; margin-bottom:3px; width:358px" aria-hidden="true">${fa}</p>
          <table table-layout="fixed" style="display:block" aria-colcount="3" aria-rowcount="${Ga}" aria-labelledby="tableHeader">
          <thead class=${r.a.xzh}>
            <tr style="display:flex">
              <th width="75px">${Ba.pzh}</th>
              <th width="70px">${Ba.ozh}</th>
              <th width="213px">${Ba.qzh}</th>
            </tr>
          </thead>
          <tbody class=${r.a.szh}>`+"</tbody></table>";for(fa=0;fa<Ga;fa++)Z.getElementsByTagName("tbody")[0].appendChild(Pa.I5g(Ra.Results[fa].SheetCell,Ra.Results[fa].Value,fa,Ba,!fa))}static I5g(Z,Ra,Ga,Ba,fa){const Y=document.createElement("tr");Y.id=Ga.toString();Y.tabIndex=fa?0:-1;Y.style.display="flex";Y.classList.add(r.a.rzh);M.DOMElementExtensions.nu(Y,"row");Y.appendChild(Pa.r3c(Z.SheetName,"75px",r.a.vzh));Y.appendChild(Pa.r3c(F.C(Z).hz(!1),"70px",r.a.uzh));Y.appendChild(Pa.r3c(Ra,"213px",
r.a.wzh));d.a.instance.ra(f.a.click,Y,Ba.jzd);e.KeyInputManager.instance.ra(f.a.Kb,Y,Ba.fJi);return Y}static r3c(Z,Ra,Ga){let Ba;Ba=document.createElement("div");Ba.innerText=Z;Ba.className=Ga;Z=document.createElement("td");Z.appendChild(Ba);Z.style.width=Ra;Z.className=r.a.tzh;return Z}static m9g(){const Z=new m.a;Z.insert(0,Pa.w8b);Z.insert(1,Pa.KRe);return Pa.JDe(Pa.Ezh,H.a.LRe,Z)}static r$g(){return Pa.ZDe(H.a.A$c,v.a.instance.ga(35))}static C$g(){return`<div class="${w.a.Mn}">`+`<label>${v.a.instance.ga(36)}</label></div>`+
`<div class="${w.a.Mn}">`+`<a href="${Pa.XWj}" target="_blank">`+`${v.a.instance.ga(37)}</a></div><br/>`}static lTd(Z){return Z.includes("*")||Z.includes("?")||Z.includes("~")}static dCe(Z,Ra,Ga){return(Ga?"<div class='"+w.a.Y7c+"'>":"")+'<input type="checkbox" id="'+Ra+'" role="checkbox" class = \''+w.a.JLe+"' ><label for='"+Ra+"' id = \""+Ra+"\" class='"+w.a.Tmh+'\' label" for= "separator">'+Z+"</label>"+(Ga?"</div>":"<br/>")}static JDe(Z,Ra,Ga){const Ba="<label class='"+w.a.Mn+"' for='{1}'>{0}</label>\r\n<select class='"+
w.a.xnh+"' id='{1}'>{2}<br></select><br/><br/>";let fa="";for(let Y of Ga)fa+=String.format('<option value="{0}" {1}> {0} </option>',Y,""===Y?"":'selected = "selected"')+"\r\n";return String.format(Ba,Z,Ra,fa)}}Pa.Ezh=v.a.instance.ga(42);Pa.w8b=v.a.instance.ga(38);Pa.KRe=v.a.instance.ga(39);Pa.k3=[25];Pa.igf=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFindWildcardTip",!1);Pa.XWj="https://go.microsoft.com/fwlink/?linkid=2190801";Object(t.a)(Pa,"FindDialogDeprecated",C.a,[228])},
1102:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.GRe="FindDialog";c.Mn="ewa-dlg-body-sectionlabel";c.VE="ewa-dlg-body-fullLine";c.udj="ReplaceResultLabelForFindAll";c.hAh="FindUserAlertLabelForFindAll";c.iAh="FindUserInfoLabelForFindAll";c.bSe="FindUserAlertLabelForFindAllWrapper";c.Z7c="ewa-dlg-elements-container-ltr";c.$6b="ewa-dlg-elements-container-rtl";c.collapsed="Collapsed";c.KWg="ChevronDivIdRotated";c.fxe="ChevronStart";c.Jkj="SearchOptionsContainer";c.cMd="SearchOptionsLabel";
c.UHg="AdvancedOptionsDropdowns";c.vIe="DropdownWithLabel";c.xzh="FindAllTableHeader";c.szh="FindAllTableBody";c.rzh="FindAllRow";c.tzh="FindAllTableData";c.vzh="FindAllTableDataSheetName";c.uzh="FindAllTableDataCell";c.wzh="FindAllTableDataValue";c.ILe="ewa-dlg-buttonarea";Object(t.a)(c,"CssClassNames",null,[])},1425:function(t,C,a){a.r(C);var c=a(10),b=a(0),d=a(691),f=a(15),e=a(582);class k{constructor(eb,Xb,oc,Gc,Vc){this.originCell=this.originRange=null;this.direction=0;this.edgeCell=null;this.shouldExtend=
!1;this.originCell=eb;this.originRange=Xb;this.direction=oc;this.edgeCell=Gc;this.shouldExtend=Vc}getEdgeCell(){return this.edgeCell}}Object(b.a)(k,"MacroRecorderMoveToEdgePayload",null,[101]);var l=a(43),m=a(368),v=a(170),n=a(8),w=a(24),r=a(97),u=a(21);const y=(eb,Xb,oc,Gc)=>{u.g(Gc);var Vc=z(eb.direction);if(eb.extend&&!Xb.isSingle){const P=Xb.iaa(Vc)===oc.iaa(Vc);let Ta=Vc;2===Vc?Ta=1:4===Vc&&(Ta=3);P?oc.ZQa(Ta,Xb.mvb(Vc)):oc.ZQa(Ta,Xb.iaa(Vc));oc=oc.topLeft}Xb=u.g(Gc).Vb(oc);if(null===Xb||void 0===
Xb?0:Xb.KH)switch(Vc=Xb.range.iaa(Vc),eb.direction){case 1:case 3:oc.top=Vc;break;case 4:case 2:oc.left=Vc}return l.o(oc,Gc)},x=(eb,Xb,oc)=>{var Gc=l.C(eb);switch(Xb){case 1:Gc.top=1;break;case 3:Gc.bottom=n.a.dh;break;case 4:Gc.left=1;break;case 2:Gc.right=n.a.mh}eb=null;Gc=oc.mk("CtrlArrowCommandHandler.TryGetEdgeCellLocally",Gc,3===Xb||1===Xb?2:1,2===Xb||3===Xb);try{if(!Gc.$$mn())return null;let Vc=Gc.$$cu();if(Vc.text){if(!Gc.$$mn())return null;Vc=Gc.$$cu();if(Vc.text)for(;Gc.$$mn();){if(!Gc.$$cu().text){eb=
Vc.range;break}Vc=Gc.$$cu()}else for(;Gc.$$mn();)if(Vc=Gc.$$cu(),Vc.text){eb=Vc.range;break}}else for(;Gc.$$mn();)if(Vc=Gc.$$cu(),Vc.text){eb=Vc.range;break}const P=Vc.cell.Sx.Oy;if(eb)return l.v(eb,oc.$);if(!Gc.$$cu()&&Vc&&(1===Xb&&!P.Y||4===Xb&&!P.X))return l.v(Vc.range,oc.$)}finally{Gc&&Gc.dispose()}return null},B=eb=>{switch(eb){case 1:return 16;case 3:return 32;case 4:return 4;case 2:return 8;default:return f.ULS.shipAssertTag(537163588,0,!1,"CtrlArrowCommandHandler.GotoRangePositioningFromDirection: unknown direction"),
60}},z=eb=>{let Xb=0;switch(eb){case 1:Xb=1;break;case 3:Xb=2;break;case 4:Xb=3;break;case 2:Xb=4}return Xb};var A=a(61);const I=(eb,Xb,oc,Gc,Vc,P,Ta,pb=null)=>{pb=eb.Na(1,pb);pb.activeCell=Xb;pb.direction=oc;return A.g(eb,"GetEdgeCell",pb,Gc,Vc,P,Ta,4)};var F=a(29),U=a(182),X=a(280),S=a(55),H=a(373);class D{constructor(eb,Xb){this.sng=eb;this.Zng=Xb}get direction(){return this.sng}get extend(){return this.Zng}flipHorizontalDirection(){return 2===this.direction?new D(4,this.extend):4===this.direction?
new D(2,this.extend):this}}Object(b.a)(D,"CtrlArrowCommandParams",null,[]);let J;class M{constructor(eb){this.$=eb}Nc(){return!1}executeCommand(eb,Xb){eb=Xb.command;if(!M.z3c.mb(eb))return U.a(eb);let oc=M.z3c.na(eb);const Gc=u.g(this.$);eb=Gc.ha;Gc.rtl&&(oc=oc.flipHorizontalDirection());const Vc=Gc.eb||Gc.xi,P=Vc?eb.rangePicker.Abd(!0):eb.sa.activeRange,Ta=Vc?eb.rangePicker.activeCell:eb.sa.activeCell,pb=y(oc,P,Ta.clone(),this.$);let Yb=x(pb,oc.direction,Gc);const Ac=l.v(P,this.$),Zc=()=>new k(pb,
Ac,oc.direction,Yb,oc.extend);if(Yb)return f.ULS.sendTraceTag(537163593,0,50,"CtrlArrowCommandHandler.ExecuteCommand: GetEdgeCell succeeded in client side"),this.d4e(Yb,oc,P.clone(),Ta.clone(),Gc),this.$.iKf(new e.a(119,Zc())),S.Task.Ta(!0);const id=gd=>{Yb=gd.Result};return m.a(this.$.userOperationManager,(gd,Ub,Lc)=>I(this.$.oa.va,pb,oc.direction,X.b(id,gd,hd=>{this.C1h(hd,oc,P.clone(),Ta.clone(),Gc)}),Ub,Lc,null),gd=>new v.a(119,0,gd,16,Zc),Xb)}Cc(eb,Xb){return M.z3c.mb(Xb.command)}Rc(){return!1}C1h(eb,
Xb,oc,Gc,Vc){!F.a.er(eb.Errors)&&eb.Result&&(eb=eb.Result,f.ULS.sendTraceTag(537163592,0,50,"CtrlArrowCommandHandler.HandleGetEdgeCellSuccess"),this.d4e(eb,Xb,oc,Gc,Vc))}d4e(eb,Xb,oc,Gc,Vc){var P=l.D(eb);if(Xb.extend){Xb=Xb.direction;eb=u.g(this.$);Vc=null;if(!oc.isSingle){var Ta=z(Xb);if(Gc.iaa(Ta)===oc.iaa(Ta))switch(Vc=Gc.clone(),Xb){case 1:case 3:Vc.Swh(oc);break;case 4:case 2:Vc.Uwh(oc)}}Vc||(Vc=oc);Vc.union(P);eb.ha.kl=0;eb.ha.updateSelection(Vc,null,0,3);Ta=!Vc.isRow&&(2===Xb||4===Xb);const pb=
!Vc.Ze&&(1===Xb||3===Xb);if((oc.isSingle||!(1!==Xb&&3!==Xb||Gc.top!==oc.top&&Gc.bottom!==oc.bottom)||!(4!==Xb&&2!==Xb||Gc.left!==oc.left&&Gc.right!==oc.right))&&(Ta||pb)){oc=Vc;f.ULS.shipAssertTag(537163590,0,oc.contains(Gc),"CtrlArrowCommandHandler.GetOppositeEdgeCellOfActiveRange: the active range doesn't contain the active cell");oc.isSingle?Gc=oc:(Xb=0,Gc.top===oc.top?Xb=1:Gc.bottom===oc.bottom&&(Xb=2),Ta=0,Gc.left===oc.left?Ta=3:Gc.right===oc.right&&(Ta=4),Gc=w.Range.Uc(0===Xb?Gc.top:oc.mvb(Xb),
0===Ta?Gc.left:oc.mvb(Ta)));if(Vc.Ze||Vc.isRow)Gc=P;eb.dt(Gc,60,r.a.R$g,!0)}}else P=B(Xb.direction),M.MAi(eb,Vc,P)}static MAi(eb,Xb,oc){let Gc;switch(Xb.ha.kl){case 1:Gc=3;break;case 2:Gc=1;break;default:Gc=0}Xb.Dg(eb,null,null,null,oc,r.a.S$g,Gc)}}M.z3c=(J=new H.a,J.add(-1297307319,new D(3,!0)),J.add(105288353,new D(1,!0)),J.add(-403586027,new D(4,!0)),J.add(784916030,new D(2,!0)),J.add(1713663844,new D(3,!1)),J.add(542791952,new D(1,!1)),J.add(-2012742350,new D(4,!1)),J.add(1324884057,new D(2,!1)),
J);Object(b.a)(M,"CtrlArrowCommandHandler",null,[195]);class G extends d.a{constructor(eb){super(eb)}yd(){this.gd([new M(this.$)])}static ka(eb){d.a.Nd(11,new G(eb))}}Object(b.a)(G,"CtrlArrowCommandHandlerFactory",d.a,[]);var T=a(508),K=a(37),L=a(1100),V=a(1101);class W{constructor(){this.Wwa=!1;this.$hc=this.GMa=null;this.FAb=this.EAb=!1;this.EZ=null}}Object(b.a)(W,"FindDialogState",null,[757]);var da=a(14),qa=a(65),O=a(917),ea=a(1099),R=a(454),oa=a(916),pa=a(12),Pa=a(281),Z=a(1),Ra=a(22),Ga=a(166),
Ba=a(338),fa=a(42),Y=a(794),ja=a(915),ca=a(145),aa=a(96),ta;(function(eb){eb.Info="Info";eb.Error="Error";eb.Success="Success";eb.Warning="Warning"})(ta||(ta={}));Object(b.b)("UserMessageType",ta);class xa{}Object(b.a)(xa,"FindResultData",null,[]);class ia extends Y.a{constructor(eb,Xb,oc,Gc){super(eb);this.findWithinSelection=aa.a.Ah(da.a.instance.ga(44));this.findWithinSheet=aa.a.Ah(da.a.instance.ga(45));this.findWithinWorkbook=aa.a.Ah(da.a.instance.ga(46));this.Qkc=aa.a.Ah(da.a.instance.ga(51));
this.LKd=aa.a.Ah(da.a.instance.ga(31));this.o$c=aa.a.Ah(da.a.instance.ob(97));this.n$c=aa.a.Ah(da.a.instance.ob(98));this.jJd=aa.a.Ah(da.a.instance.ob(100));this.kJd=aa.a.Ah(da.a.instance.ob(96));this.cIb=aa.a.Ah(da.a.instance.Xa(23));this.OYc=aa.a.Ah(da.a.instance.Xa(22));this.iJd=aa.a.Ah(da.a.instance.ga(63));this.mJd=aa.a.Ah(da.a.instance.ga(64));this.p$c=aa.a.Ah(da.a.instance.ga(53));this.L4=this.Phc=this.pBa=this.nBa=this.FMa=null;this.q$c=Vc=>{0==Vc&&(this.$.rb.f6a=!1,this.$.rb.Zx=!1)};this.Czh=
(Vc,P,Ta,pb)=>{this.findText=P.findText;this.eIb=P.replaceText;this.NTa=P.withinOption;this.Afb=P.matchCase;this.Bfb=P.matchEntireCell;this.SearchUp=P.searchUp;this.Dpj=Ta;this.qT();1==Vc?(this.operation=1891435765,this.V$e(Ta,pb)):2==Vc?(this.operation=788780084,this.V$e(Ta,pb)):(3==Vc?(this.lta(!0),this.operation=1059985902,this.wAd(Ta,pb)):(this.lta(!0),this.KOb(!1,Ta,pb)),this.gridView.lb.oi(null,ia.k3))};this.jzd=Vc=>{this.Ttc(Vc.Cell)};this.OTj=Vc=>{this.O_f=Vc;this.mTa(this)};this.c$h=Vc=>
{this.setFocusCallback=Vc};this.D7a=()=>{this.$.ea.Ke!==n.a.Ce&&this.$.ea.fc&&this.Tmd()&&this.Dpj(this.LKd,ta.Info)};this.mTa=()=>{const Vc=ia.jwa(this.$);Vc&&(this.NTa=this.findWithinSelection);null!=this.O_f&&this.O_f(Vc);this.Ei.EZ||(this.Ei.EZ=this.findWithinSelection);Vc||this.Ei.EZ!==this.findWithinSelection||(this.Ei.EZ=this.findWithinSheet);this.NTa||(this.NTa=this.Ei.EZ)};this.Ei=oc;this.fq=u.g(this.$);this.Jd=Gc;this.operation=1461300262;this.JEa=205;this.Zfb=null;this.Rb=13;this.rc(1,
da.a.instance.ga(41));this.rc(2,da.a.instance.ga(27));this.rc(3,da.a.instance.ga(60));this.rc(4,da.a.instance.ga(61));this.Bj();this.Afb=this.Ei.EAb;this.Bfb=this.Ei.FAb;this.SearchUp=this.Ei.Wwa;this.findText=void 0!=Xb?Xb:this.Ei.GMa;this.eIb=this.Ei.$hc;this.tZa={["withinOption"]:this.NTa,["findText"]:this.findText,["matchCase"]:this.Afb,["matchEntireCell"]:this.Bfb,["replaceText"]:this.eIb,["searchUp"]:this.SearchUp,["isFindTab"]:1540292897===Gc.command||1891435765===Gc.command||788780084===Gc.command?
!0:!1,["isEditMode"]:this.$.isEditMode,["disableAllButtons"]:!1};this.Cx={["id"]:this.oc,["updateWithinOptions"]:this.OTj,["initializeFocusCallback"]:this.c$h,["onFindAllRowResultClick"]:this.jzd,["findDialogResultHandler"]:this.Czh,["isModal"]:!1,["bodyProps"]:this.tZa};this.$.rb.f6a=!0;this.initializeAndShow(this.p$c,this.q$c,this.Cx);this.$.ea&&this.$.ea.kE(this.D7a)}static getInstance(eb,Xb,oc,Gc){return this.Ma||(this.Ma=new this(eb,Xb,oc,Gc))}Psj(eb){this.cRa();const Xb=Object.assign({},this.tZa);
Xb.isFindTab=1540292897==eb||1891435765==eb||788780084==eb;this.Cx.bodyProps=Xb;this.kTa(this.p$c,this.R3a(this.q$c),this.Cx)}Pu(){this.$.rb.f6a=!1;this.$.rb.Zx=!1;this.rb.YHb(this);this.dispose()}get oc(){return"FindAndReplaceDialog"}get gridView(){return this.fq}dispose(){this.ek();this.gridView.lb.oi(null,ia.k3);this.$.ea&&this.$.ea.BD(this.D7a);this.$.rb.f6a=!1;ia.Ma=null;super.dispose()}setFocus(){this.setFocusCallback?this.setFocusCallback():f.ULS.sendTraceTag(523245012,0,50,"FindAndReplaceDialog.setFocus: setFocusCallback not initialized")}lta(eb){const Xb=
Object.assign({},this.tZa);Xb.disableAllButtons=eb;this.Cx.bodyProps=Xb;this.kTa(this.p$c,this.R3a(this.q$c),this.Cx)}wAd(eb,Xb){this.qT();const oc=this.aK();this.FMa=oc;f.ULS.sendTraceTag(523882654,0,50,`FindAndReplace Dialog 'Replace' was clicked, MatchCase: ${oc.MatchCase}, MatchEntireCell: ${oc.MatchEntireCell}, , SearchAllSheets: ${oc.SearchAllSheets}.`);var Gc=this.findText;const Vc=this.eIb,P=this.gridView.Vb(this.gridView.ha.sa.activeCell);if(!P)return f.ULS.sendTraceTag(523882653,0,50,"FindAndReplace - failed getting current active cell."),
this.lta(!1),!1;let Ta=!1;Gc=({wI:Ta}=this.T6b(P,Gc,Vc,this.Afb,this.Bfb)).returnValue;if(!Gc&&!Ta)return f.ULS.sendTraceTag(523882652,0,50,`FindAndReplace Dialog - current cell does not contain the requested value to replace, finding next cell, MatchCase: ${oc.MatchCase}, MatchEntireCell: ${oc.MatchEntireCell}, , SearchAllSheets: ${oc.SearchAllSheets}.`),eb(this.vFa(this.mJd,Gc,!0),ta.Error),this.lta(!1),!0;this.KOb(!0,eb,Xb);return!0}KOb(eb,Xb,oc){if(this.gridView){var Gc=this.Taa()?this.gridView.ha.sa.Wc:
this.gridView.ha.sa.activeCell,Vc=l.o(this.gridView.ha.sa.activeCell,this.$),P=l.q(Gc,this.$),Ta=this.$.oa.va,pb=this.aK();this.FMa=pb;var Yb=this.eIb;f.ULS.sendTraceTag(523882650,0,50,`WebServiceReplaceAll, isSingle: ${eb}, MatchCase: ${pb.MatchCase}, MatchEntireCell: ${pb.MatchEntireCell}, , SearchAllSheets: ${pb.SearchAllSheets}.`);var Ac=()=>new ja.a(pb,Yb,Vc,P,eb);m.a(this.$.userOperationManager,(Zc,id,gd)=>this.Nci(Ta,pb,Vc,P,Yb,eb,Zc,id,gd,Xb,oc),Zc=>new v.a(148,0,Zc,void 0,Ac),this.Jd)}else this.lta(!1)}T6b(eb,
Xb,oc,Gc,Vc){let P,Ta;var pb=0;Ta=P=!1;if((new ca.a(this.$.xa)).li)return{returnValue:0,estimated:P,wI:Ta};if(!eb)return f.ULS.sendTraceTag(523882649,0,50,"EstimateReplaceSingleCell - currentCell == null"),{returnValue:0,estimated:P,wI:Ta};if(!Ra.a.Dh(eb.text)){if(eb.gF)return f.ULS.sendTraceTag(523882648,0,50,"EstimateReplaceSingleCell - cell has a formula so we can not estimate"),Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4230178_ServerRoundTripIfFormula")&&(Ta=!0),{returnValue:0,estimated:P,
wI:Ta};if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4230178_NoReplaceInCellWithRichValue")&&0!==eb.cell.Ama)return f.ULS.sendTraceTag(523882647,0,50,"EstimateReplaceSingleCell - Replace in cells containing RichValues is not supported"),{returnValue:0,estimated:P,wI:!0};pb=eb.aTa;if(Vc){if(Ra.a.equals(pb,Xb,Gc))return eb.text=oc,f.ULS.sendTraceTag(523882646,0,50,"EstimateReplaceSingleCell - matchEntireCell, the replace string is equal to the source string, we estimated the result without formatting (could flicker)"),
{returnValue:1,estimated:!0,wI:Ta};f.ULS.sendTraceTag(523882645,0,50,"EstimateReplaceSingleCell - matchEntireCell, the replace string is not equal to the source string, we should not replace (this could be counted as a good guess or no replacement)");return{returnValue:0,estimated:P,wI:Ta}}pb=Ra.a.r2b(pb,Xb,Gc);Vc=Ra.a.r2b(eb.text,Xb,Gc);if(ia.lTd(Xb))return{returnValue:0,estimated:P,wI:!0};pb===Vc?(Xb=Ra.a.UPa(eb.text,Xb,oc,Gc),eb.text=Xb,f.ULS.sendTraceTag(523882644,0,50,"EstimateReplaceSingleCell - estimation with formatting"),
P=!0):0<pb&&(f.ULS.sendTraceTag(523882643,0,50,"EstimateReplaceSingleCell - replacement will happen, but we did not estimate because we do not handle with the formatting (bad guess/no guess)"),P=!1)}return{returnValue:pb,estimated:P,wI:Ta}}Nci(eb,Xb,oc,Gc,Vc,P,Ta,pb,Yb,Ac,Zc){return oa.c(eb,Xb,oc,Gc,Vc,P,X.b(Ta,(id,gd,Ub)=>{this.vAd(id,gd,Ub,Ac,Zc)}),pb,Yb,P)}vAd(eb,Xb,oc,Gc,Vc){Vc([],"");oc=!1;if(!Pa.a(eb)){let Ta="";var P=eb.Result;eb=P.ReplacedCount;P=P.SkippedReplacementsCount;0<P&&(f.ULS.sendTraceTag(523882642,
0,50,`Invoke Replace, SkippedReplacementCount = ${P}`),Ta=String.format(this.jJd,eb.toString(),P.toString()));P||(Ta=String.format(this.kJd,eb.toString()));Xb&&0<eb?(oc=!0,this.findNext(Gc,Vc)):eb||P?(Xb=this.vFa(Ta,eb,Xb),Gc(Xb,Xb===Ta?ta.Success:ta.Error)):Gc(this.vFa(this.iJd,eb,Xb),ta.Error)}oc||this.lta(!1)}findNext(eb,Xb){var oc=this.aK();f.ULS.sendTraceTag(523882641,0,50,"FindNext, MatchCase: {1}, MatchEntireCell: {2}, , SearchAllSheets: {3}.",oc.MatchCase,oc.MatchEntireCell,oc.SearchAllSheets);
let Gc=null;oc=({jj:Gc}=ia.CJa(this.$,oc,this.Taa(),!1,this,eb,Xb,Vc=>{Vc.Result&&ia.PDb(Vc,this.$,this,eb,Xb);this.lta(!1)},()=>{Xb([],"");this.lta(!1)})).returnValue;m.a(this.$.userOperationManager,oc,Vc=>new v.a(147,0,Vc,16,Gc),this.Jd)}Bj(){this.gridView&&this.gridView.ha&&this.gridView.ha.cT(this.mTa)}ek(){this.gridView&&this.gridView.ha&&this.gridView.ha.rR(this.mTa)}Tmd(){return!!pa.DOMElementExtensions.getElementById(this.Lb,"findAndReplaceScrollablePane")}V$e(eb,Xb){const oc=this.aK();if(oc){if(this.L4){const Gc=
Ra.a.equals(oc.SearchString,this.L4.SearchString,!1)&&oc.MatchCase===this.L4.MatchCase&&oc.MatchEntireCell===this.L4.MatchEntireCell;f.ULS.sendTraceTag(523882639,0,50,`FindNext - is find data changed between clicks? sameData=${Gc}, stateId=${this.$.ea.Ke}`)}this.L4=oc;this.gLa(this.Rw,({jj:this.Zfb}=ia.CJa(this.$,oc,this.Taa(),788780084===this.operation,this,eb,Xb,()=>{this.operation=1891435765;this.JEa=147})).returnValue,18,this.n4,!1)}else f.ULS.sendTraceTag(523882640,0,10,"cannot get find data, cannot call find cell operation")}get Rw(){return this.JEa}jj(){return this.Zfb}Taa(){return ia.jwa(this.$)&&
Ra.a.equals(this.NTa,this.findWithinSelection,!1)}qT(){this.Ei.GMa=this.findText;this.Ei.Wwa=this.SearchUp;this.Ei.EAb=this.Afb;this.Ei.FAb=this.Bfb;this.Ei.EZ=this.NTa;this.Ei.$hc=this.eIb}Ttc(eb){const Xb=l.C(eb);if(eb=this.$.xa.getItemByName(eb.SheetName))eb=l.m(Xb,eb),this.gridView.Dg(eb,Xb,null,null,60,r.a.JRe,void 0,void 0,void 0,void 0,!0)}aK(){const eb={};if(!this.$)return f.ULS.sendTraceTag(523882638,0,15,"FindAndReplaceDialog:EwaControl is null when tryng to get find data"),null;var Xb=
u.g(this.$);Xb=(Xb=Xb?Xb.ha.sa.activeCell:w.Range.Uc(1,1))?l.o(Xb,this.$):null;!Xb||Ra.a.Dh(Xb.SheetName)?f.ULS.sendTraceTag(523882637,0,15,"could not find sheet name, Sheets/ActiveItem is null."):eb.SheetName=Xb.SheetName;eb.SearchString=this.findText;eb.MatchCase=this.Afb;eb.MatchEntireCell=this.Bfb;eb.SearchAllSheets=!this.Taa()&&this.NTa===this.findWithinWorkbook;eb.SearchUp=this.SearchUp;eb.ExcludeFormulaResult=!1;return eb}static CJa(eb,Xb,oc,Gc,Vc,P=null,Ta=null,pb=null,Yb=null,Ac=!1){const Zc=
u.g(eb),id=Zc?Zc.ha.sa.activeCell:w.Range.Uc(1,1),gd=l.o(id,eb),Ub=(oc=oc&&!!Zc&&ia.jwa(eb))?l.q(Zc.ha.sa.Wc,eb):l.q(id,eb);oc=Gc?Lc=>{ia.kzd(Lc,eb,Vc,Ta)}:Lc=>{ia.PDb(Lc,eb,Vc,P,Ta)};pb=pb?Ac?X.b(oc,pb):X.b(pb,oc):oc;Ra.a.Dh(Xb.SheetName)&&(Xb.SheetName=gd.SheetName);return{returnValue:(Lc,hd,Kd)=>Gc?oa.a(eb.oa.va,Xb,Ub,X.b(Lc,pb),Yb?X.a(hd,Yb):hd,Kd,eb):oa.b(eb.oa.va,Xb,gd,Ub,X.b(Lc,pb),Yb?X.a(hd,Yb):hd,Kd,eb),jj:Gc?()=>new O.a(Xb,Ub):()=>new ea.a(Xb,Ub,gd)}}static jwa(eb){eb=u.g(eb).ha.sa;return eb.wg&&
!eb.jba()}static kzd(eb,Xb,oc,Gc){if(Pa.a(eb))f.ULS.shipAssertTag(523882634,0,!1,"FindAndReplaceDialog.OnFindAllWebMethodSuccess: EwaResult contains NonStatusMessages.");else if(eb=eb.Result)if(eb.Results)if(eb.Results.length){oc.Phc=eb;oc.w7a=Number.NaN;const Vc=Math.min(eb.Results.length,1E3);ia.G5g(eb,Vc,oc,1E3<eb.Results.length,Gc);ia.zid(eb,Vc,Xb)}else Gc(null,null);else f.ULS.shipAssertTag(523882632,0,!1,"FindAndReplaceDialog.OnFindAllWebMethodSuccess: findAllResult.Results is null");else f.ULS.shipAssertTag(523882633,
0,!1,"FindAndReplaceDialog.OnFindAllWebMethodSuccess: findAllResult is null")}static PDb(eb,Xb,oc,Gc,Vc){if(Pa.a(eb))Ga.a.current.q_a("FindEndedWithErrors");else if((eb=eb.Result)&&eb.SheetRange){const P=l.D(eb.SheetRange);oc=eb.FoundInRichValue;if(Gc=u.g(Xb))Gc.ha.sa.wg&&Gc.ha.sa.Wc.contains(P)?Gc.Dg(l.v(Gc.ha.sa.Wc,Xb),P,null,null,60,r.a.IRe,void 0,void 0,void 0,P,!0):Gc.Dg(eb.SheetRange,P,null,null,60,r.a.HRe,void 0,void 0,void 0,void 0,!0),Gc.Ea.oK(1,Xb.pa)&&Ga.a.current.b7c("FindEnded",Xb),Ra.a.equals(Xb.pa.sheetName,
eb.SheetRange.SheetName,!0)&&ia.Aid(P,Xb),oc&&P&&Z.EwaSettings.ma(104)&&(f.ULS.sendTraceTag(523882630,0,50,"FindAndReplaceDialog.OnFindCellWebMethodSuccess: FoundInRichValue"),R.a(Xb,243,242,0,Ta=>{Ta.Zcb(P.top,P.left,1,!1,!1)}))}else ia.Qgd(oc,Xb,Gc,Vc)}static zid(eb,Xb,oc){if(Xb){var Gc=Array(Xb);for(let Vc=0;Vc<Xb;Vc++){const P=eb.Results[Vc].SheetCell;f.ULS.shipAssertTag(523882629,0,!!P,"FindAndReplaceDialog.OnFindAllWebMethodSuccess: cell is null");const Ta=oc.xa.getItemByName(P.SheetName);Ta&&
(Gc[Vc]=new Ba.a(l.C(P),qa.d(Ta)))}u.g(oc).lb.vv(Gc,ia.k3,!0)}}static Aid(eb,Xb){u.g(Xb).lb.oi(eb,ia.k3);u.g(Xb).lb.zn(ia.k3)}static Qgd(eb,Xb,oc,Gc){eb?1891435765===eb.operation&&(Gc([],""),oc(eb.Qkc,ta.Error),f.ULS.sendTraceTag(523882627,0,50,"FindAndReplaceDialog - Find Next ExcelServerMessageId.NoOccurrencesFound from find dialog")):(eb=F.a.Yc(1,2,0,51,0,-1736450117,"NoOccurrencesFound"),fa.a(Xb).vr([eb]),f.ULS.sendTraceTag(523882628,0,50,"FindAndReplaceDialog - Find Next ExcelServerMessageId.NoOccurrencesFound from shortcut keys"))}static G5g(eb,
Xb,oc,Gc,Vc){oc=Gc?String.format(oc.n$c,1E3):String.format(oc.o$c,Xb);Gc=[];for(let P=0;P<Xb;P++){let Ta=eb.Results[P].SheetCell,pb=eb.Results[P].Value,Yb=Ta.SheetName,Ac=l.C(Ta).hz(!1);Gc.push({Cell:Ta,Value:pb,SheetName:Yb,CellRange:Ac})}Vc(Gc,oc)}vFa(eb,Xb,oc){const Gc=new ca.a(this.$.xa);if(!oc&&this.FMa.SearchAllSheets){if(Gc.taf)return eb+this.cIb}else if(Gc.li)return Xb?eb+this.cIb:this.OYc;return eb}static lTd(eb){return eb.includes("*")||eb.includes("?")||eb.includes("~")}}ia.k3=[25];Object(b.a)(ia,
"FindAndReplaceDialog",Y.a,[228]);class ya{constructor(eb){this.Mzh=[25];this.eHb=!1;this.iid=()=>{this.eHb&&(this.gridView.lb.Mg(this.Mzh),this.gridView.ha.RF(this.iid),this.eHb=!1)};this.$=eb;this.gridView=u.g(eb);this.tog=new W}get Ei(){return this.tog}dispose(){this.gridView&&this.eHb&&(this.gridView.ha.RF(this.iid),this.eHb=!1)}Nc(eb,Xb){return(1059985902===Xb||658167298===Xb)&&!this.$.isEditMode}Cc(eb,Xb){if(eb=1===eb)switch(Xb.command){case 1059985902:case 658167298:case 1891435765:case 788780084:case 1540292897:case -1389126153:case 892787342:break;
default:eb=!1}return eb}Rc(){return!1}executeCommand(eb,Xb,oc){eb=Xb.command;return this.w1h(1891435765===eb||788780084===eb||658167298===eb,-1389126153===eb,Xb,oc)}w1h(eb,Xb,oc,Gc){var Vc=K.TaskExtensions.fk();this.Ei.Wwa=Xb;if(eb||1540292897===oc.command)if(this.gridView.QRa(!0),Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindAndReplaceReactDialog",!1)){let P;1540292897===oc.command&&(P=Gc.CommandValueId);this.yzh=ia.getInstance(this.$,P,this.Ei,oc);this.yzh.Psj(oc.command)}else 658167298===
oc.command?(f.ULS.sendTraceTag(537162508,0,50,"Open Find and Replace Dialog"),Xb=new L.FindAndReplaceDialogDeprecated(this.$,this.Ei,oc,7)):(f.ULS.sendTraceTag(537162507,0,50,"Open Find Dialog"),Xb=new V.a(this.$,this.Ei,oc,void 0,7),Xb.n_f(this.Ei.GMa)),Xb.initialize(),Xb.Ff(),1540292897===oc.command&&Xb.n_f(Gc.CommandValueId);else if(this.Ei.GMa){Gc={};Gc.SheetName=this.$.xa.pa.sheetName;Gc.SearchString=this.Ei.GMa;Gc.SearchUp=Xb;Gc.MatchCase=this.Ei.EAb;Gc.MatchEntireCell=this.Ei.FAb;Gc.SearchAllSheets=
!1;Gc.ExcludeFormulaResult=!1;const P=788780084===oc.command;let Ta=null;Xb=()=>{this.gridView.ha.NG(this.iid);this.eHb=!0};Vc=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindAndReplaceReactDialog",!1)?({jj:Ta}=ia.CJa(this.$,Gc,this.Ei.Wwa,P,null,null,null,Xb,void 0,!0)).returnValue:({jj:Ta}=V.a.CJa(this.$,Gc,this.Ei.Wwa,P,null,Xb,void 0,!0)).returnValue;Vc=m.a(this.$.userOperationManager,Vc,pb=>new v.a(P?205:149,0,pb,16,Ta),oc)}return Vc}}Object(b.a)(ya,"FindCommandHandler",null,
[195]);class ib extends d.a{constructor(eb){super(eb)}yd(){this.gd([new ya(this.$)])}static ka(eb){d.a.Nd(95,new ib(eb))}}Object(b.a)(ib,"FindCommandHandlerFactory",d.a,[]);var wa=a(262),sa=a(412),Ya=a(51),bb=a(68);class mb extends Y.a{constructor(eb){super(eb);this.gKa=this.sheetNames=null;this.yVj=(Xb,oc,Gc)=>{""===Xb&&(Xb="A1");mb.Gif=this.gKa=Xb;Xb=this.$.listSeparator;const Vc=this.gKa.split(Xb);this.B$i(Vc);this.lCg(Vc,oc);this.gKa=Vc.join(Xb.toString());if(this.JNj(Vc))return f.ULS.sendTraceTag(537159573,
0,50,"GotoDialog.VerifyInputIsValid: parsed range(s) locally. Does contain list separator: "+this.e1c(this.gKa)),this.IJd(!0),!0;f.ULS.sendTraceTag(537159572,0,50,"GotoDialog.VerifyInputIsValid: could not parse range(s) locally, calling webservice instead. Does contain list separator: "+this.e1c(this.gKa));this.gLa(562,this.wOh(this.$,this.gKa,Gc),18,this.n4,!1);return!1};this.N_h=Xb=>{f.ULS.sendTraceTag(537159571,0,50,`GotoDialog.GoToDialogHandler pressing on: ${1===Xb?"Ok":"Cancel"}`)};this.iI=
()=>{this.IJd(!1)};this.Rb=1;eb={[mb.Tu]:this.oc,["initialRange"]:mb.Gif||"",["verifyInputIsValid"]:this.yVj};if(this.cgf=!this.$.ea.isNamedObjectViewMode)eb.isSheetDropdownEnabled=!0,eb.activeSheetName=this.$.xa.pa.name,this.sheetNames=this.U3a(),eb.sheets=this.sheetNames;this.initializeAndShow(da.a.instance.ga(76),this.N_h,eb)}get oc(){return"GotoDialog"}wOh(eb,Xb,oc){return(Gc,Vc,P)=>{const Ta=u.g(eb),pb=eb.oa.va.Sb();return eb.xa.pa?A.w(eb.oa.va,Xb,eb.xa.pa.name,this.f_a(Gc,this.QUe(oc)),X.a(Vc,
this.iI),P,Ta,pb):A.v(eb.oa.va,Xb,-1,this.f_a(Gc,this.QUe(oc)),X.a(Vc,this.iI),P,Ta,pb)}}QUe(eb){return(Xb,oc)=>{let Gc=!1;const Vc=!Pa.a(Xb);this.IJd(Vc);f.ULS.sendTraceTag(537159570,0,50,`GotoDialog.OnWebMethodSuccess: ${Vc?"Succeeded":"Failed"} to parse range(s) on server. Does contain list separator: ${this.e1c(this.gKa)}`);if(Vc)f.ULS.shipAssertTag(537159569,0,Object(sa.a)(230,oc),"GotoDialog.OnWebMethodSuccess: the userContext is null or not an IGridView."),Xb=Xb.Result,Xb=l.l(Xb.Ranges[0],
Xb.SheetName),oc.Dg(Xb,null,null,null,3,r.a.T_h);else if(Pa.b(Xb,-1876101953)||Pa.b(Xb,1145860328))bb.a(this.$).jd.XL([-1876101953,1145860328]),Gc=!0;else{f.ULS.sendTraceTag(537159568,0,10,"GotoDialog.OnWebMethodSuccess: result contains non-status messages");this.hide();return}eb(Gc)}}e1c(eb){return Ra.a.contains(eb,this.$.listSeparator.toString(),!0)}IJd(eb){const Xb=this.$,oc={};oc.c=Xb.ea.isNamedObjectViewMode;oc.b=eb;oc.a=Xb.ya.UserSessionId;Ya.b().Le(35,oc)}JNj(eb){if(wa.a.Dh(eb))return!0;if(1===
eb.length&&this.$.ea.isNamedObjectViewMode&&this.$.zb.Ek(eb[0]))return this.$.zb.pa=this.$.zb.getItemByName(eb[0]),!0;var Xb=this.$.xa.pa.sheetName;let oc=Ra.a.contains(eb[0],"!",!0)?eb[0].split("!")[0]:Xb;const Gc=[];for(const Vc of eb){let P;if(({sheetName:eb,range:P}=l.Z(Vc,this.$.xa)).returnValue){oc=l.bb(oc);if(eb?!Ra.a.equals(oc,eb,!0):!Ra.a.equals(oc,Xb,!0))return!1;Gc.push(P)}else if(eb=this.$.zb.getItemByName(Vc))(P=eb.usedRange)&&Gc.push(P);else return!1}f.ULS.sendTraceTag(537159567,0,50,
`GotoDialog.TryToParseAndGoto: Succeeded parsing ${Gc.length} ranges.`);Xb=Gc.length-1;u.g(this.$).WY(Gc,Xb,oc,null,null,null,null,3,r.a.S_h);return!0}B$i(eb){for(let Xb=0;Xb<eb.length;Xb++)eb[Xb]=eb[Xb].trim()}lCg(eb,Xb){if(this.cgf&&Xb!==this.$.xa.pa.name&&!wa.a.any(eb,oc=>Ra.a.contains(oc,"!",!0)))for(let oc=0;oc<eb.length;oc++)eb[oc]=`'${Xb}'!${eb[oc]}`}U3a(){const eb=this.$.xa.items,Xb=[];for(const oc of eb)oc.visible&&!qa.e(oc)&&Xb.push(oc.sheetName);return Xb}}mb.Gif=null;Object(b.a)(mb,"GotoDialog",
Y.a,[]);class Ca{constructor(eb){this.$=eb}Nc(){return!1}Rc(){return!1}Cc(eb,Xb){return-1361691601===Xb.command}executeCommand(){u.g(this.$).QRa(!0);new mb(this.$);return S.Task.Ta(!0)}}Object(b.a)(Ca,"GotoCommandHandler",null,[195]);class $a extends d.a{constructor(eb){super(eb)}yd(){this.gd([new Ca(this.$)])}static ka(eb){d.a.Nd(99,new $a(eb))}}Object(b.a)($a,"GotoCommandHandlerFactory",d.a,[]);var Kb=a(50),rb=a(86),cc=a(416),nc=a(35),Wb=a(104),Ea=a(198);class ua{constructor(eb,Xb,oc,Gc,Vc){this.g8d=
this.Wmd=!1;this.nzd=P=>{this.Sg&&this.Sg.kg&&P.ej===this.Sg.ej&&(this.Sg.kg.paneType!==this.pVd&&this.Tq&&(this.qid(),this.xRd()),this.Tq.qTa(this.floatingObjectId))};this.$=eb;this.gridView=u.g(eb);this.Pa=this.gridView.ha.Pa;this.Tq=Xb;this.floatingObjectId=oc;this.floatingObjectType=Vc;this.sharedSheetRange=Gc;this.floatingObjectManager=Wb.a(eb);this.Sg=null}get lnd(){return this.g8d}get contentType(){return 0}dispose(){this.Sg&&this.Sg.XHb(this.nzd);this.gridView.ha.qda.xHb(this);this.PRa(!1);
this.Tq.Kab(this.floatingObjectId);this.Dg();this.Sg=this.floatingObjectManager=null}e4a(){this.Pa.tGa(this.sharedSheetRange,this.floatingObjectId,this.floatingObjectType).continueWith(eb=>{eb.result||f.ULS.sendTraceTag(537153821,0,15,`FloatingObjectSharingHighlight.GotoFoAndShowHighlights: Selection of shared FO Failed with FOId = ${this.floatingObjectId}`);this.gridView.ha.qda.ile(this);this.Hzh()})}qid(){this.Sg&&(this.Sg.XHb(this.nzd),this.Wmd=!1);this.PRa(!1);this.Tq.Kab(this.floatingObjectId);
this.Sg=null}xRd(){this.DGf();this.Sg&&(this.PRa(!0),this.Hqb(!1))}k7e(){}C3f(){}Dg(){return this.Sg?this.Pa.fsa(this.Sg):!1}nVd(){const eb=this.Tq.cKa(this.floatingObjectId);return eb?eb.isFocused:!1}LKb(){if(!this.Sg||this.Pa.bic!=this.Sg)return!1;const eb=this.Tq.cKa(this.floatingObjectId);return!eb||eb.isFocused?!1:eb.focus()}kh(eb){if(!this.Sg||this.Pa.bic!=this.Sg)return!1;const Xb=this.Tq.cKa(this.floatingObjectId);return Xb&&Xb.isFocused?Xb.kh(eb):!1}Hzh(){this.DGf();this.Sg?(this.Dg(),this.PRa(!0),
this.Hqb(!0),f.ULS.sendTraceTag(537153819,0,50,`FloatingObjectSharingHighlight.GotoFoAndShowHighlights: Successfully highlighted shared FO with FOId = ${this.floatingObjectId}`)):f.ULS.sendTraceTag(537153820,0,10,`FloatingObjectSharingHighlight.GotoFoAndShowHighlights: Unable to find floating object control of FO with FOId = ${this.floatingObjectId}`)}DGf(){this.floatingObjectManager&&(this.Sg=this.floatingObjectManager.vq(Ea.a.cz(this.floatingObjectType,this.floatingObjectId)))}PRa(eb){this.Sg&&
this.Sg.tAc&&(this.Sg.tAc(eb),this.g8d=eb)}Hqb(eb){if(this.Sg){this.pVd=this.Sg.kg.paneType;var Xb=this.Sg.get_element();this.pVd&&Xb?(this.Tq.Hqb(this.pVd,Xb,this.floatingObjectId,this.contentType,eb),this.Wmd||(this.Sg.KYb(this.nzd),this.Wmd=!0)):f.ULS.sendTraceTag(523765015,0,10,"FloatingObjectSharingHighlight.createOrUpdateToolTip: Unable to find FO container pane or FO control outer element.")}else f.ULS.sendTraceTag(523765016,0,10,"FloatingObjectSharingHighlight.createOrUpdateToolTip: Missing floating object control.")}}
Object(b.a)(ua,"FloatingObjectSharingHighlight",null,[622,2]);var ma=a(38),fb=a(173),sb=a(45),Ua=a(127),ab=a(343);class na extends Sys.EventArgs{constructor(eb){super();this.cna=eb}}Object(b.a)(na,"ShareSectionEventArgs",Sys.EventArgs,[]);var Na=a(709),Va=a(5);class Sa extends ma.a{constructor(eb,Xb,oc,Gc,Vc,P,Ta,pb){super();this.ue=Ua.a.instance;this.bhc=this.Hpa=this.wSb=!1;this.jG=this.Qda=this.Io=this.e7=null;this.nLb=0;this.SSa=this.Pna=null;this.mCb=100;this.xN=()=>{this.vs.disabled||this.vda()};
this.wN=()=>{this.vs.disabled||this.lW()};this.onFocus=()=>{this.Io.disabled||(this.vda(),this.wSb=!0)};this.onBlur=()=>{this.Io.disabled||this.Hpa||this.lW()};this.XGi=()=>{this.jG.disabled||this.hide(!0)};this.YGi=()=>{this.jG.disabled||(this.vda(),this.Hpa=this.wSb=!0)};this.WGi=()=>{this.jG.disabled||(this.Hpa=!1)};this.Th=Yb=>{switch(Yb.keyCode){case 13:this.Hpa?this.hide(!0):this.lW();this.gridView.focus();Yb.stopPropagation();Yb.preventDefault();break;case 27:this.lW();this.gridView.focus();
break;case 9:this.Hpa?(this.Hpa=!1,this.Io.focus()):(this.Hpa=!0,this.jG.focus()),Yb.stopPropagation(),Yb.preventDefault()}};this.lW=()=>{this.mCb=Math.max(this.mCb,this.Io.offsetWidth);window.clearInterval(this.nLb);pa.DOMElementExtensions.toggleCssClass(this.e7,"ewr-shareSection-tooltip-hidden",!1);pa.DOMElementExtensions.toggleCssClass(this.jG,"ewr-shareSection-tooltip-hidden",!0);pa.DOMElementExtensions.toggleCssClass(this.Qda,"ewr-shareSection-tooltip-toggle-maxWidth0",!0);this.raiseEvent("collapseTooltipEvent",
new na(this.vVd));this.Hpa=this.wSb=this.bhc=!1};this.gridView=eb;this.svgIconProvider=oc;this.paneType=Xb;this.ana=Gc;this.vs=P;this.vVd=Vc;this.uf=Ta;this.d$g(pb)}NDg(eb){this.addHandler("collapseTooltipEvent",eb)}aaj(eb){this.removeHandler("collapseTooltipEvent",eb)}pEg(eb){this.addHandler("expandTooltipEvent",eb)}yaj(eb){this.removeHandler("expandTooltipEvent",eb)}GEg(eb){this.addHandler("hideToolTipEvent",eb)}Maj(eb){this.removeHandler("hideToolTipEvent",eb)}get isFocused(){return this.wSb&&
this.bhc}dispose(){window.clearInterval(this.nLb);this.R0a();super.dispose()}hide(eb){window.clearInterval(this.nLb);pa.DOMElementExtensions.toggleCssClass(this.vs,"ewr-shareSection-tooltip-hidden",!0);f.ULS.sendTraceTag(525144271,0,50,"ShareTooltipControl.Hide: Hiding tooltip and highlight");eb&&(this.raiseEvent("hideToolTipEvent",new na(this.vVd)),this.gridView.$.ud(876400478,0,8,null),f.ULS.sendTraceTag(524931738,0,50,"ShareTooltipControl.hide: FPS survey got triggered."))}show(eb){pa.DOMElementExtensions.toggleCssClass(this.vs,
"ewr-shareSection-tooltip-hidden",!1);eb?this.lW():this.vda()}qTa(){if(this.uf&&0!==this.paneType){var eb=this.tYh(this.uf,this.paneType);eb&&pa.DOMElementExtensions.updatePosition(this.vs,eb.x,eb.y,!0,this.gridView.rtl)}else f.ULS.sendTraceTag(524079517,0,10,`ShareTooltipControl.updateTooltipPosition: Either highlight div is null or pane type is none for sharing type ${this.ana}.`)}HVg(){0!=this.ana&&(pa.DOMElementExtensions.Pqc(this.Io),this.gridView.rtl?(this.Io.appendChild(this.e7),this.Io.appendChild(this.jG),
this.Io.appendChild(this.Qda),this.vs.dir="rtl"):(this.Io.appendChild(this.Qda),this.Io.appendChild(this.jG),this.Io.appendChild(this.e7),this.vs.dir="ltr"))}focus(){this.Io.focus();return!0}kh(eb){return this.isFocused&&pa.DOMElementExtensions.vf(this.Io,eb)}s2e(){switch(this.ana){case 0:return da.a.instance.ga(2262);case 1:return da.a.instance.ga(2263);case 2:return da.a.instance.ga(2264);default:return""}}d$g(eb){const Xb=Date.now();window.requestAnimationFrame(()=>{this.vs.className=0===this.ana?
"ewr-shareSection-floatingoject-tooltip-container":"ewr-shareSection-tooltip-container";this.Io=document.createElement("div");this.Io.className="ewr-shareSection-tooltip-flyout";this.Io.tabIndex=0;this.Io.setAttribute(Va.a.Mt,this.s2e());this.vs.appendChild(this.Io);this.Qda=document.createElement("div");this.Qda.className="ewr-shareSection-tooltip-textContainer";const oc=document.createElement("span");oc.innerText=this.s2e();oc.className="ewr-shareSection-tooltip-text";this.Qda.appendChild(oc);this.jG=
document.createElement("div");this.jG.className="ewr-shareSection-tooltip-close-icon";this.jG.tabIndex=0;this.jG.setAttribute(Va.a.Mt,da.a.instance.ga(985));this.svgIconProvider.Jaa(Na.a.Duj,16,16,this.jG,20,20);this.e7=document.createElement("div");this.e7.className="ewr-shareSection-tooltip-icon";this.svgIconProvider.Jaa(Na.a.Euj,20,20,this.e7,20,20);pa.DOMElementExtensions.toggleCssClass(this.e7,"ewr-shareSection-tooltip-hidden",!0);this.gridView.rtl?(this.Io.appendChild(this.e7),this.Io.appendChild(this.jG),
this.Io.appendChild(this.Qda),this.vs.dir="rtl"):(this.Io.appendChild(this.Qda),this.Io.appendChild(this.jG),this.Io.appendChild(this.e7),this.vs.dir="ltr");this.lW();this.qTa();this.ho();this.bhc=!0;eb&&(this.vda(),this.nLb=window.setInterval(this.lW,1E4));f.ULS.sendTraceTag(524931737,0,50,`ShareTooltipControl.createTooltip: successfully highlighted and created tooltip for shareSectionContentType = ${this.ana}, duration= ${Date.now()-Xb}`)})}ho(){this.Io&&(this.Pna=this.ue.Zd(this.Io),this.Pna.ka("mouseover",
this.xN),this.Pna.ka("mouseout",this.wN),this.Pna.ka("focus",this.onFocus),this.Pna.ka("blur",this.onBlur),this.Pna.ka("keydown",this.Th));this.jG&&(this.SSa=this.ue.Zd(this.jG),this.SSa.ka("click",this.XGi),this.SSa.ka("focus",this.YGi),this.SSa.ka("blur",this.WGi))}R0a(){this.Pna&&this.Pna.JC();this.SSa&&this.SSa.JC();pa.DOMElementExtensions.Pqc(this.vs);pa.DOMElementExtensions.pf(this.vs);this.e7=this.jG=this.Qda=this.Io=this.vs=this.uf=this.SSa=this.Pna=null}vda(){window.clearInterval(this.nLb);
pa.DOMElementExtensions.toggleCssClass(this.e7,"ewr-shareSection-tooltip-hidden",!0);pa.DOMElementExtensions.toggleCssClass(this.jG,"ewr-shareSection-tooltip-hidden",!1);pa.DOMElementExtensions.toggleCssClass(this.Qda,"ewr-shareSection-tooltip-toggle-maxWidth0",!1);this.hRj();this.raiseEvent("expandTooltipEvent",new na(this.vVd));this.bhc=!0}tYh(eb,Xb){const oc=parseInt(eb.style.left,10);var Gc=parseInt(eb.style.right,10);const Vc=eb.offsetTop;if(!Gc&&this.gridView.rtl&&0===this.ana){Gc=eb.offsetWidth;
const P=this.gridView.Lf(Xb).domElement.offsetWidth;let Ta=oc;eb.parentNode&&(Ta+=eb.parentNode.offsetLeft);Gc=P-Gc-Ta}return this.Edd(new Sys.UI.Point(this.gridView.rtl?Gc:oc,Vc),Xb,eb)}Edd(eb,Xb,oc){var Gc=this.gridView.Lf(Xb).Mm;Xb=ab.a.JM(Xb,Gc.topLeft);Gc=oc.offsetWidth;oc=oc.offsetHeight;let Vc=0;this.Io&&pa.DOMElementExtensions.Jbb(this.Io,"ewr-shareSection-tooltip-toggle-leftAndRight")&&(Vc=20);return new Sys.UI.Point(Math.min(Math.max(Xb.x,eb.x-10),eb.x+Gc)+Vc,Math.min(Math.max(Xb.y,eb.y-
10),eb.y+oc))}hRj(){const eb=this.gridView.Lf(this.paneType).Mm,Xb=ab.a.JM(this.paneType,eb.topLeft);this.mCb=Math.max(this.mCb,this.Io.offsetWidth);let oc=parseInt(this.vs.style.left,10);this.gridView.rtl&&(oc=parseInt(this.vs.style.right,10));oc+this.mCb>Xb.x+eb.width?pa.DOMElementExtensions.toggleCssClass(this.Io,"ewr-shareSection-tooltip-toggle-leftAndRight",!0):pa.DOMElementExtensions.toggleCssClass(this.Io,"ewr-shareSection-tooltip-toggle-leftAndRight",!1);this.qTa()}}Object(b.a)(Sa,"ShareToolTipControl",
ma.a,[647,2]);class vb extends ma.a{constructor(eb,Xb){super();this.Fvc=null;this.I6={};this.hoa=null;this.deb=[];this.FF=()=>{if(this.$.pa&&qa.d(this.$.pa)===this.Fvc){const oc=this.I6;for(let Gc in oc)this.qTa(Gc)}};this.re=(oc,Gc)=>{if(Gc&&Gc.pa&&Gc.tD){oc=this.I6;for(let Vc in oc){oc=this.cKa(Vc);if(!oc)break;if(qa.d(Gc.pa)!==this.Fvc){oc.hide(!1);break}if(qa.d(Gc.pa)!==qa.d(Gc.tD)){oc.show(!0);break}oc.HVg()}}};this.fDf=(oc,Gc)=>{Gc&&this.raiseEvent("collapseSharingTooltip",Gc)};this.gDf=(oc,
Gc)=>{Gc&&this.raiseEvent("expandSharingTooltip",Gc)};this.hDf=(oc,Gc)=>{Gc&&this.raiseEvent("closeSharingTooltip",Gc)};this.$=eb;this.svgIconProvider=Xb;this.gridView=u.g(eb);eb.pa&&(this.Fvc=qa.d(eb.pa));this.pLg()}KDg(eb){this.addHandler("closeSharingTooltip",eb)}Y$i(eb){this.removeHandler("closeSharingTooltip",eb)}MDg(eb){this.addHandler("collapseSharingTooltip",eb)}$$i(eb){this.removeHandler("collapseSharingTooltip",eb)}oEg(eb){this.addHandler("expandSharingTooltip",eb)}xaj(eb){this.removeHandler("expandSharingTooltip",
eb)}dispose(){this.qdh();this.PYg();rb.a.Ia(this.hoa);this.hoa=null;super.dispose()}Hqb(eb,Xb,oc,Gc,Vc){if(0!==eb&&Xb){var P=nc.a.Dc(this.I6,oc);if(!P){const Ta=document.createElement("div");P=new Sa(this.gridView,eb,this.svgIconProvider,Gc,oc,Ta,Xb,Vc);this.I6[oc]=P;P.NDg(this.fDf);P.pEg(this.gDf);P.GEg(this.hDf);window.requestAnimationFrame(()=>{const pb=this.gridView.Lf(eb).domElement;pb.insertBefore(Ta,pb.firstChild)})}qa.d(this.$.pa)!==this.Fvc?P.hide(!1):this.qTa(oc)}}Kab(eb){const Xb=nc.a.Dc(this.I6,
eb);Xb&&(delete this.I6[eb],Xb.dispose())}qTa(eb){nc.a.Dc(this.I6,eb)&&(0>this.deb.indexOf(eb)&&this.deb.push(eb),this.hoa=fb.AsyncMethodContext.lr(this.updatePosition.bind(this),100,sb.a.Cuj,this.hoa))}cKa(eb){return nc.a.Dc(this.I6,eb)}updatePosition(){this.deb&&0<this.deb.length&&(this.deb.forEach(eb=>{(eb=nc.a.Dc(this.I6,eb))&&eb.qTa()}),this.deb.length=0)}pLg(){this.$&&this.$.xa.Pf(this.re);this.gridView&&(this.gridView.Ea.MG(this.FF),this.gridView.Ea.Ks(this.FF),this.gridView.view.Ls(this.FF))}qdh(){this.$&&
this.$.xa.zg(this.re);this.gridView&&(this.gridView.Ea.mI(this.FF),this.gridView.Ea.Nq(this.FF),this.gridView.view.Pq(this.FF))}PYg(){const eb=this.I6;for(let oc in eb){var Xb=eb[oc];Xb.aaj(this.fDf);Xb.yaj(this.gDf);Xb.Maj(this.hDf);Xb.dispose()}this.raiseEvent("closeSharingTooltip");this.I6=null}}Object(b.a)(vb,"ShareToolTipControlsManager",ma.a,[623,2]);const Oa=[46];class yb{constructor(eb,Xb,oc,Gc,Vc){this.i9=[1,3,2,4];this.npd=this.Qgc=!1;this.qQe=!0;this.kz={};this.Azd=()=>{this.dEe()};this.$=
eb;this.gridView=u.g(eb);this.Tq=Xb;this.cna=oc;this.sharedSheetRange=Gc;this.ana=Vc;this.sheetRange=new Ba.a(l.D(Gc),qa.d(eb.xa.pa));this.Zui()}get lnd(){return this.npd}get contentType(){return this.ana}dispose(){this.gridView&&this.gridView.ha&&this.gridView.ha.qda.xHb(this);this.PRa(!1);this.Kab();this.Dg();this.kz=null}e4a(){this.gridView.nid();this.Dg()&&(this.gridView.ha.qda.ile(this),this.PRa(!0))}qid(){this.Nwb();this.Kab()}xRd(){this.S2f(!1)}k7e(){this.k3f(!1)}C3f(){this.k3f(!0)}Dg(){this.gridView.Dg(this.sharedSheetRange,
null,null,null,60,r.a.Auj);return!0}nVd(){const eb=this.Tq.cKa(this.cna);return eb?eb.isFocused:!1}LKb(){if(!this.Rff())return!1;const eb=this.Tq.cKa(this.cna);return!eb||eb.isFocused?!1:eb.focus()}kh(eb){if(!this.Rff())return!1;const Xb=this.Tq.cKa(this.cna);return Xb&&Xb.isFocused?Xb.kh(eb):!1}k3f(eb){for(let Xb in this.kz)pa.DOMElementExtensions.toggleCssClass(this.kz[Xb],"ewr-shareSection-tooltip-toggle-opacity",eb)}Zui(){if(this.sharedSheetRange&&1==this.contentType){const eb=this.sharedSheetRange.LastRow-
this.sharedSheetRange.FirstRow,Xb=this.sharedSheetRange.LastColumn-this.sharedSheetRange.FirstColumn;Xb&&eb&&f.ULS.sendTraceTag(525144270,0,50,`SharingHighlight.logRangeSize: Shared Range contains cells = ${eb*Xb}.`)}}PRa(eb){this.sheetRange?eb?(this.gridView.lb.fRa(this.sheetRange,Oa),this.S2f(!0)):this.Nwb():f.ULS.sendTraceTag(537153814,0,10,"SharingHighlight.ShowOrHideSharingHighlight: Shared Range is null.")}S2f(eb){this.Qgc||(this.gridView.lb.bne(this.Azd),this.Qgc=!0);this.gridView.lb.zn(Oa,
null,null,!0,!0);this.npd=!0;this.qQe=eb;this.dEe();eb&&this.Dg()}Nwb(){this.gridView.lb.Mg(Oa);this.gridView.lb.LId(this.Azd);this.npd=this.Qgc=!1}dEe(){if(this.sheetRange){var eb=u.g(this.$).ib.Vi(this.sheetRange.range.topLeft),Xb=this.gridView.lb.dv(46,eb).uf;eb&&Xb&&pa.DOMElementExtensions.isVisible(Xb)&&(this.Tq.Hqb(eb,Xb,this.cna,this.ana,this.qQe),this.wYi(),this.gridView.lb.LId(this.Azd),this.Qgc=!1)}}wYi(){if(this.kz){var eb=Date.now();for(let oc=0;oc<this.i9.length;oc++){this.kz[this.i9[oc].toString()]&&
(pa.DOMElementExtensions.pf(this.kz[this.i9[oc].toString()]),this.kz[this.i9[oc].toString()]=null);var Xb=this.gridView.ib.Lod(this.sheetRange.range,this.i9[oc]);const Gc=this.gridView.lb.dv(46,this.i9[oc]).uf;if(!Xb||!Gc)break;Xb=document.createElement("div");Xb.className="ewr-shareSection-highlightDiv-overlay";Gc.appendChild(Xb);this.kz[this.i9[oc].toString()]=Xb}f.ULS.sendTraceTag(523765014,0,50,`SharingHighlight.populateOverlayDivElements: Successfully added overlay for shared Range/Table in durationInMS = ${Date.now()-
eb}.`)}}Kab(){if(this.Tq){this.Tq.Kab(this.cna);const eb=this.kz;for(let Xb in eb)pa.DOMElementExtensions.pf(eb[Xb]);this.kz={}}}Rff(){if(!this.gridView.ha.sa.wg)return!1;let eb=this.gridView.ha.sa.activeRange;this.gridView.ha.sa.jba()&&(eb=this.gridView.ha.sa.activeCell);return eb.equals(l.D(this.sharedSheetRange))?!0:!1}}Object(b.a)(yb,"SharingHighlight",null,[622,2]);var Ob=a(1103);class Ja extends Ob.a{constructor(){super();this.LastColumn=this.LastRow=0}}Object(b.a)(Ja,"SharedSheetRange",Ob.a,
[]);class lb{constructor(eb,Xb){this.p1g=da.a.instance.ga(2265);this.floatingObjectManager=null;this.zI={};this.BGa=[];this.$sb=this.m1a=!1;this.w6c=0;this.ZU=!1;this.twc=null;this.Czb=this.$xb=!1;this.F9c=0;this.SDb=(oc,Gc)=>{Gc.control&&Gc.control.floatingObject&&0===Gc.control.floatingObject.type&&this.Ccc(Gc.control.floatingObject.id,!1)};this.xwf=(oc,Gc)=>{Gc.control&&Gc.control.floatingObject&&!Gc.control.floatingObject.type&&this.Ccc(Gc.control.floatingObject.id,!0)};this.aR=(oc,Gc)=>{Gc.item&&
this.gL&&Gc.item.name===this.gL.name&&(f.ULS.sendTraceTag(524038161,0,50,"ShareSectionGotoAndHighlightManager.onNamedSheetViewModeChanged: Closing all highlight due to named sheet view mode."),this.h9i())};this.Jf=()=>{this.zI&&0<Object.keys(this.zI).length&&(this.w6c++,2==this.w6c&&(this.j$f(),this.m1a=!1))};this.j$f=()=>{this.gridView.Xb.yl(this.Jf);this.$sb&&window.clearInterval(this.F9c);this.gridView.$.ud(876400478,0,8,null);f.ULS.sendTraceTag(524931740,0,50,"ShareSectionGotoAndHighlightManager.triggerFPS: FPS survey got triggered.")};
this.EF=(oc,Gc)=>{if(Gc&&(oc=Gc.VQ,!(this.Czb&&oc||!this.Czb&&!oc)&&this.bgf())){this.ZU=!0;this.Czb=!!oc;for(let Vc in this.zI)this.Ccc(Vc,!1)}};this.Jq=()=>{this.twc=fb.AsyncMethodContext.lr(this.V3i.bind(this),100,sb.a.Buj,this.twc)};this.EDb=()=>{for(let oc in this.zI){const Gc=nc.a.Dc(this.zI,oc);Gc&&this.v3e(Gc)}this.$xb&&this.ea&&(this.ea.Wn(this.EDb),this.$xb=!1)};this.Guf=(oc,Gc)=>{Gc&&this.xHb(Gc.cna)};this.Huf=(oc,Gc)=>{Gc&&(oc=nc.a.Dc(this.zI,Gc.cna))&&oc.k7e()};this.hwf=(oc,Gc)=>{Gc&&
(oc=nc.a.Dc(this.zI,Gc.cna))&&oc.C3f()};this.$=eb;this.gridView=u.g(eb);this.w6c=0;this.$sb=this.m1a=!1;this.Tq=new vb(eb,Xb);this.floatingObjectManager=Wb.a(eb);this.ea=eb.ea;if(this.gL=eb.pa)this.Czb=!!this.gL.ku;this.ho()}dispose(){this.$sb&&window.clearInterval(this.F9c);this.R0a();const eb=this.zI;for(let Xb in eb)eb[Xb].dispose();this.Tq&&this.Tq.dispose();this.Tq=this.zI=null;rb.a.Ia(this.twc);this.twc=null;this.BGa.length=0}P_h(){this.e4a(0)||0!=this.BGa.length||f.ULS.sendTraceTag(537153818,
0,10,"ShareSectionGotoAndHighlightManager.GotoAndHighlightChart: Shared chart not found.")}Q_h(){this.e4a(1)||0!=this.BGa.length||f.ULS.sendTraceTag(537153817,0,10,"ShareSectionGotoAndHighlightManager.GotoAndHighlightRange: Shared sheet range not found.")}R_h(){this.e4a(2)||0!=this.BGa.length||f.ULS.sendTraceTag(537153816,0,10,"ShareSectionGotoAndHighlightManager.GotoAndHighlightRange: Shared table not found.")}W_h(){this.mbf(this.$.workbookContext)||f.ULS.sendTraceTag(512356422,0,10,"ShareSectionGotoAndHighlightManager.gotoSheet: Shared sheet not found.")}ho(){this.Tq&&
(this.Tq.KDg(this.Guf),this.Tq.MDg(this.Huf),this.Tq.oEg(this.hwf));this.floatingObjectManager&&(this.floatingObjectManager.Emb(this.SDb),this.floatingObjectManager.iYb(this.xwf));this.gL&&this.gL.Ed&&this.gL.Ed.mra(this.aR);this.$&&this.$.xa&&this.$.xa.lra(this.EF);this.gridView&&this.gridView.aT(this.Jq)}R0a(){this.Tq&&(this.Tq.Y$i(this.Guf),this.Tq.$$i(this.Huf),this.Tq.xaj(this.hwf));this.floatingObjectManager&&(this.floatingObjectManager.JHb(this.SDb),this.floatingObjectManager.urc(this.xwf));
this.gL&&this.gL.Ed&&this.gL.Ed.QPa(this.aR);this.$&&this.$.xa&&this.$.xa.kza(this.EF);this.gridView&&this.gridView.QN(this.Jq);this.gridView&&this.gridView.Xb&&this.m1a&&(this.gridView.Xb.yl(this.Jf),this.m1a=!1);this.$xb&&this.ea&&this.ea.Wn(this.EDb)}bgf(){return this.$.pa&&this.gL&&qa.d(this.$.pa)===qa.d(this.gL)}V3i(){if(this.bgf()){if(this.ZU)for(let eb in this.zI)this.Ccc(eb,!0);this.ZU=!1}}Ccc(eb,Xb){(eb=nc.a.Dc(this.zI,eb))&&(Xb?eb.xRd():eb.qid())}mbf(eb){if(eb.NavigationContentFound)return!0;
this.hzj(this.p1g);return!1}hzj(eb){eb=cc.a.fC.notificationBar.A2(eb,!1);eb.image=0;cc.a.fC.notificationBar.gC(eb)}e4a(eb){var Xb;const oc=this.$.workbookContext;if(!this.mbf(oc))return!1;eb=this.sSh(oc,eb);if(!eb)return!1;(null===(Xb=this.ea)||void 0===Xb?0:Xb.Fg)&&this.v3e(eb);!this.$xb&&this.ea&&(this.ea.El(this.EDb),this.$xb=!0);return!0}sSh(eb,Xb){const oc=this.S3a(eb);eb=this.rWh(eb,Xb,oc);if(!eb)return f.ULS.sendTraceTag(537153815,0,10,`ShareSectionGotoAndHighlightManager.GetOrCreateSharingHighlight: Invalid shareSectionContentType = ${Xb}.`),
null;if(0<=this.BGa.indexOf(eb))return f.ULS.sendTraceTag(522314690,0,50,"ShareSectionGotoAndHighlightManager.GetOrCreateSharingHighlight: Highlight already closed by user."),null;let Gc=nc.a.Dc(this.zI,eb);Gc||(Gc=0===Xb?new ua(this.$,this.Tq,eb,oc,0):new yb(this.$,this.Tq,eb,oc,Xb),this.zI[eb]=Gc);return Gc}S3a(eb){const Xb=new Ja;Xb.SheetName=this.$.pa.name;Xb.FirstRow=eb.NavigationSharedSectionSharedRange.FirstRow;Xb.FirstColumn=eb.NavigationSharedSectionSharedRange.FirstColumn;Xb.LastRow=eb.NavigationSharedSectionSharedRange.LastRow;
Xb.LastColumn=eb.NavigationSharedSectionSharedRange.LastColumn;return Xb}rWh(eb,Xb,oc){switch(Xb){case 0:return this.aYe(eb);case 2:return eb.NavigationSharedSectionXluid;case 1:return oc.toString();default:return null}}aYe(eb){eb=eb.NavigationSharedSectionXluid;return`${eb.length}.${eb.toUpperCase()}`}v3e(eb){this.$&&!this.gL&&(this.gL=this.$.pa);this.gL&&(this.Czb=this.gL.ku?!0:!1);this.m1a||(this.gridView.Xb.em(this.Jf),this.m1a=!0);this.$sb||(this.F9c=window.setInterval(this.j$f,6E4),this.$sb=
!0);f.ULS.sendTraceTag(524931739,0,50,`ShareSectionGotoAndHighlightManager.gotoAndHighlightSharedSection: started highlighting and creating tooltip for shareSectionContentType = ${eb.contentType}.`);eb.e4a()}xHb(eb){const Xb=nc.a.Dc(this.zI,eb);Xb&&(delete this.zI[eb],0>this.BGa.indexOf(eb)&&this.BGa.push(eb),Xb.dispose());0===Object.keys(this.zI).length&&this.R0a()}h9i(){const eb=this.zI;for(let Xb in eb)this.xHb(Xb)}}Object(b.a)(lb,"ShareSectionGotoAndHighlightManager",null,[601,2]);class Pb{constructor(eb,
Xb){this.np=!1;this.Bvc=new lb(eb,Xb);this.np=eb.isMobileMode}Cc(eb,Xb){if(this.np)return!1;switch(Xb.command){case 1321134125:case 1804990828:case 1045473631:return Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1);case -521202831:return Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1);default:return!1}}executeCommand(eb,Xb){K.TaskExtensions.fk();eb=Xb.command;switch(eb){case 1321134125:this.Bvc.P_h();eb=S.Task.Ta(!0);break;case 1804990828:this.Bvc.Q_h();
eb=S.Task.Ta(!0);break;case 1045473631:this.Bvc.R_h();eb=S.Task.Ta(!0);break;case -521202831:this.Bvc.W_h();eb=S.Task.Ta(!0);break;default:eb=U.a(eb)}return eb}Rc(){return!1}Nc(){return!1}}Object(b.a)(Pb,"ShareSectionCommandHandler",null,[195]);class Jb extends d.a{constructor(eb){super(eb)}yd(){K.TaskExtensions.Aa(Kb.GetServiceTaskFactory.Ra(this.$.da,388,387,this.hb),eb=>{this.gd([new Pb(this.$,eb.result)])},this.$.la,3)}static ka(eb){d.a.Nd(461,new Jb(eb))}}Object(b.a)(Jb,"ShareSectionCommandHandlerFactory",
d.a,[]);var Lb=a(185),Ab=a(162);const nb=(eb,Xb,oc,Gc,Vc,P,Ta,pb=null)=>{pb=eb.Na(1,pb);pb.activeCell=Xb;pb.selectedRange=oc;return A.g(eb,"GetSelectAllRange",pb,Gc,Vc,P,Ta,4)};class va{constructor(eb){this.$=eb;this.gridView=u.g(eb);this.ha=this.gridView.ha}get activeRange(){return this.gridView.inRangePicker||this.gridView.xi?this.ha.rangePicker.Abd(!0).clone():this.ha.sa.activeRange.clone()}Nc(){return!1}executeCommand(eb,Xb){let oc=!1,Gc=!1;eb=Xb.command;switch(eb){case -2117762619:return this.A3h();
case 1941920197:oc=Gc=!0;break;case 2110202177:oc=!0;break;case 104573693:Gc=!0;break;default:return U.a(eb)}const Vc=this.activeRange;if(Vc.yii)return S.Task.Ta(!0);const P=this.gridView.Db.Yj(Vc,!0),Ta=!!P||1941920197!==Xb.command,pb=!Ta&&this.NKg();if(Ta||pb)return pb?(Xb=this.YAc(!0,!0),f.ULS.sendTraceTag(537151697,0,50,"SmartSelectionCommandHandler.ExecuteCommand selecting entire grid")):Xb=P?this.VSj(oc,Gc,P):this.YAc(oc,Gc),eb=Ya.b()?Ya.b().nj(eb):r.a.ECj,this.gridView.Dg(l.v(Xb,this.$),null,
null,null,0,eb,3),f.ULS.sendTraceTag(19798168,0,50,"SmartSelectionCommandHandler.ExecuteCommand: command handled on client."),S.Task.Ta(!0);const Yb=this.$.oa.va,Ac=l.o(this.ha.sa.activeCell,this.$),Zc=l.v(Vc,this.$);f.ULS.sendTraceTag(19798169,0,50,"SmartSelectionCommandHandler.ExecuteCommand: command sent to server.");return m.a(this.$.userOperationManager,(id,gd,Ub)=>nb(Yb,Ac,Zc,X.b(id,Lc=>{va.D1h(Lc,this.gridView)}),gd,Ub,null),id=>new v.a(165,0,id,16),Xb)}Cc(eb,Xb){switch(Xb.command){case 1941920197:case 2110202177:case 104573693:case -2117762619:return!0}return!1}Rc(){return!1}A3h(){const eb=
this.gridView.ggd(),Xb=this.YAc(!0,!0);this.gridView.Dg(l.v(Xb,this.$),eb,null,null,60,r.a.FCj,3);f.ULS.sendTraceTag(19965127,0,50,"SmartSelectionCommandHandler.HandleWidgetSelectAllCommand");return S.Task.Ta(!0)}VSj(eb,Xb,oc){f.ULS.shipAssertTag(537151696,0,!!oc);var Gc=this.activeRange;if(!oc)return Gc;const Vc=Gc.top===oc.usedRange.top&&Gc.bottom===oc.usedRange.bottom;Gc=Gc.right===oc.usedRange.right&&Gc.left===oc.usedRange.left;if(eb&&!Vc||Xb&&!Gc)return eb=this.YSj(eb,Xb,oc),2===oc.type&&eb.equals(Ab.a(oc))&&
this.ha.sa.wg&&oc.activate(),eb;f.ULS.sendTraceTag(537151695,0,50,`SmartSelectionCommandHandler.UpdateSelectionByNamedTable selecting all grid, allRows = ${eb}, allColumns = ${Xb}`);return this.YAc(eb,Xb)}YSj(eb,Xb,oc){const Gc=this.activeRange,Vc=this.exj(Gc,oc,eb,Xb);f.ULS.sendTraceTag(537151694,0,50,`Selecting table, allRows = ${eb}, allColumns = ${Xb}, shouldSelectInnerTable = ${Vc}, isPivotTable = ${1===oc.type}`);oc=Vc?Ab.a(oc):oc.usedRange;Xb&&(Gc.right=oc.right,Gc.left=oc.left);eb&&(Gc.top=
oc.top,Gc.bottom=oc.bottom);return Gc}YAc(eb,Xb){f.ULS.sendTraceTag(537151693,0,50,`Selecting grid, allRows = ${eb}, allColumns = ${Xb}`);const oc=this.activeRange;Xb&&(oc.left=1,oc.right=n.a.mh);eb&&(oc.top=1,oc.bottom=n.a.dh);return oc}exj(eb,Xb,oc,Gc){if(2!==Xb.type)return!1;Xb=Ab.a(Xb);return oc&&Gc?Xb.contains(eb)&&!Xb.equals(eb):oc?Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6701846_fixCtrltSelection")?Xb.contains(eb)&&!(Xb.top===eb.top&&Xb.bottom===eb.bottom):Xb.top<eb.top&&Xb.bottom>eb.bottom:
!1}NKg(){const eb=this.activeRange;--eb.top;eb.bottom+=1;--eb.left;eb.right+=1;var Xb=va.vMh(eb);eb.$X();if(!this.gridView.gi.contains(eb))return!1;for(let oc of Xb){Xb=va.BMh(eb,oc);Xb=this.gridView.mk("SmartSelectionCommandHandler.AreSelectionEdgesEmpty",Xb,1);try{for(;Xb.$$mn();)if(Xb.$$cu().text)return!1}finally{Xb&&Xb.dispose()}}return!0}static BMh(eb,Xb){eb=eb.clone();eb.kOd(Xb,eb.iaa(Xb));return eb}static vMh(eb){const Xb=new Lb.a;1<=eb.top&&Xb.add(1);eb.bottom<=n.a.Az&&Xb.add(2);1<=eb.left&&
Xb.add(3);eb.right<=n.a.rw&&Xb.add(4);return Xb}static D1h(eb,Xb){if(!F.a.er(eb.Errors)&&eb.Result){eb=eb.Result;var oc=l.D(eb);const Gc=Xb.gi.contains(oc);oc=oc.equals(new w.Range(1,1,n.a.dh,n.a.mh,!0,!0));f.ULS.sendTraceTag(537151692,0,50,`SmartSelectionCommandHandler.HandleGetSelectAllRangeSuccess: newSelectionInLoadedRange = ${Gc}, allGridSelection = ${oc}`);Xb.Dg(eb,null,null,null,0,r.a.DCj,3)}}}Object(b.a)(va,"SmartSelectionCommandHandler",null,[195]);class db extends d.a{constructor(eb){super(eb)}yd(){this.gd([new va(this.$)])}static ka(eb){d.a.Nd(235,
new db(eb))}}Object(b.a)(db,"SmartSelectionCommandHandlerFactory",d.a,[]);var Xa=a(413),gb=a(33),Ha=a(109),tb=a(7),bc=a(4);class tc{}Object(b.a)(tc,"SpellCheckFeedbackLoopParameters",null,[]);var Ma=a(121);const Tb=(eb,Xb,oc,Gc,Vc,P,Ta,pb,Yb,Ac,Zc,id=null)=>{id=eb.Na(1,id);id.spellCheckRanges=Xb;id.batchStartCell=oc;id.localeName=Gc;id.ignoredWords=Vc;id.isCompliant=P;id.subscriptionType=Ta;return A.g(eb,"GetSpellCheckInfo",id,pb,Yb,Ac,Zc,0)},zb=(eb,Xb,oc,Gc,Vc,P,Ta=null)=>{Ta=eb.Na(1,Ta);Ta.spellCheckFeedbackLoopParametersArray=
Xb;return A.g(eb,"SpellCheckFeedbackLoop",Ta,oc,Gc,Vc,P,0)},ic=(eb,Xb,oc,Gc,Vc,P,Ta=null)=>{Ta=eb.Na(1,Ta);Ta.localeName=Xb;return A.g(eb,"GetSpellCheckSupportedLocaleList",Ta,oc,Gc,Vc,P,0)},Qb=(eb,Xb,oc,Gc,Vc,P,Ta,pb,Yb,Ac,Zc,id,gd=null)=>{gd=eb.Na(1,gd);gd.findData=Xb;gd.activeCell=oc;gd.selectedRanges=Gc;gd.replaceWith=Vc;gd.isSingle=P;gd.startIndex=Ta;gd.endIndex=pb;return A.g(eb,"SpellCheckChangeAll",gd,Yb,Ac,Zc,id,0)};var wb=a(64);class hc{constructor(eb,Xb,oc){this.zda=this.mP=null;this.P6a=
!1;this.cG=this.I$a=this.j$a=this.POa=this.aDc=null;this.tLi=Gc=>{!Pa.a(Gc)&&Gc.Result?(f.ULS.sendTraceTag(41956352,0,50,"SpellCheckModel.OnGetSpellCheckSupportedLocaleListWebMethodSuccess GetSpellCheckSupportedLocaleList response success"),Gc=Gc.Result,this.ubf=Gc.IsCurrentLocaleIdSupported,this.yr.uSd(Gc)):(this.yr.uSd(null),f.ULS.sendTraceTag(41956353,0,10,"SpellCheckModel.OnGetSpellCheckSupportedLocaleListWebMethodSuccess GetSpellCheckSupportedLocaleList response error"))};this.sLi=Gc=>{Gc=Ma.a.lf(Gc.data);
f.ULS.sendTraceTag(537151387,0,10,`SpellCheckModel.OnGetSpellCheckSupportedLocaleListWebMethodFailed Errors: [${F.a.yc(Gc)}].`);this.yr.uSd(null)};this.rLi=Gc=>{this.j$a=this.POa=null;!Pa.a(Gc)&&Gc.Result?(Gc=Gc.Result,this.cG=Gc.SpellCheckItems,this.mP.FirstRow=Gc.ActiveBatchEndRow,this.mP.FirstColumn=Gc.ActiveBatchEndColumn,f.ULS.sendTraceTag(537151386,0,50,`SpellCheckModel.OnGetSpellCheckInfoWebMethodSuccess OnGetSpellCheckInfoWebMethod response success, SpellCheck cache: ${this.cG.length}`),this.Bf=
this.cG[0]):(f.ULS.sendTraceTag(537151385,0,10,"SpellCheckModel.OnGetSpellCheckInfoWebMethodSuccess OnGetSpellCheckInfoWebMethod response error"),this.Bf=null)};this.qLi=Gc=>{Gc=Ma.a.lf(Gc.data);f.ULS.sendTraceTag(537151384,0,10,`SpellCheckModel.OnGetSpellCheckInfoWebMethodFailed Errors: [${F.a.yc(Gc)}].`);this.Bf=this.j$a=this.POa=null};this.ARi=(Gc,Vc)=>{if(!Pa.a(Gc)&&Gc.Result)if(f.ULS.sendTraceTag(537151383,0,50,"SpellCheckModel.OnSpellCheckChangeAllWebMethodSuccess OnSpellCheckChangeAllWebMethod response success"),
Gc=Gc.Result,!Gc.ReplacedCount)f.ULS.sendTraceTag(537151382,0,10,"SpellCheckModel.OnSpellCheckChangeAllWebMethodSuccess Replace Count equal to 0"),this.Bf=null;else{if(!Vc){this.yr.Frj(Gc.ReplacedCount,this.I$a);Vc=0;Gc=[];for(const P of this.cG)this.Bf.Row===P.Row&&this.Bf.Column===P.Column&&(Gc[Vc++]=P);this.cG=Gc;this.RXf();this.Mxb()}}else f.ULS.sendTraceTag(537151381,0,10,"SpellCheckModel.OnSpellCheckChangeAllWebMethodSuccess OnSpellCheckChangeAllWebMethodSuccess response error"),this.Bf=null};
this.zRi=Gc=>{Gc=Ma.a.lf(Gc.data);f.ULS.sendTraceTag(537151380,0,10,`SpellCheckModel.OnSpellCheckChangeAllWebMethodFailed Errors: [${F.a.yc(Gc)}].`);this.Bf=null};this.$=eb;this.gridView=u.g(eb);this.tna=oc;this.Zcc=new Lb.a;this.ubf=!0;this.yr=Xb;this.OLb=[];this.S9e()}get Bf(){return this.aDc}set Bf(eb){this.aDc=eb;this.ubf?!this.Bf||0!==this.Bf.Type&&1!==this.Bf.Type?this.yr.P4f(!!this.Bf,this.P6a):K.TaskExtensions.Qyc(this.yr.oAc(this.P6a,this.zda,w.Range.Uc(this.Bf.Row+1,this.Bf.Column+1)),()=>
{this.yr.P4f(!!this.Bf,this.P6a);return K.TaskExtensions.raa()},this.$.la,11,wb.a.current):f.ULS.sendTraceTag(537151443,0,50,`SpellCheckModel.ActiveSpellCheckItem Current Locale not supported: ${this.tna}`)}get X$g(){return this.gridView?this.gridView.ha.sa.activeCell:w.Range.Uc(1,1)}get eah(){return this.gridView?this.gridView.ha.sa.Wc:w.Range.Uc(1,1)}nhi(){return!!this.POa}S9e(){if(this.P6a=this.$li()){var eb=this.eah;this.zda=l.q(eb,this.$);this.mP=l.o(eb,this.$)}else eb=this.X$g,this.zda=l.q(eb,
this.$),this.mP=l.o(eb,this.$)}Fci(eb){ic(this.$.oa.va,eb,this.tLi,this.sLi,null,null)}Mxb(){if(Ha.e(this.cG)){var eb=this.$.oa.va.Sb();this.POa=eb.ClientRequestId;this.j$a=Tb(this.$.oa.va,this.zda,this.mP,this.tna,this.Zcc.toArray(),bc.AFrameworkApplication.fa.qa("ProofingWithEditorServiceInboundaryCloudSuggestionsIsEnabled"),bc.AFrameworkApplication.fa.qa("IsSubscriptionForProofingUser"),this.rLi,this.qLi,null,eb);f.ULS.sendTraceTag(537151436,0,50,"SpellCheckModel.InvokeGetSpellCheckInfoWebMethod GetSpellCheckInfo RequestSent")}else f.ULS.sendTraceTag(537151437,
0,50,"SpellCheckModel.InvokeGetSpellCheckInfoWebMethod SpellCheck Cache Hit"),this.Bf=this.cG[0]}Uci(eb,Xb){const oc={};this.$.Xj(oc);oc.FirstRow=this.Bf.Row;oc.FirstColumn=this.Bf.Column;let Gc;({fIb:Gc}=this.ulh(Xb,eb));eb&&(this.I$a=Gc);const Vc=this.aK(eb),P=this.zda,Ta=this.$.oa.va,pb=()=>new ja.a(Vc,Gc,oc,P,!eb),Yb=this.Bf.StartIndex,Ac=this.Bf.StartIndex+this.Bf.Length-1;m.a(this.$.userOperationManager,(Zc,id,gd)=>Qb(Ta,Vc,oc,P,Gc,!eb,Yb,Ac,X.b(Zc,this.ARi),X.a(id,this.zRi),gd,!eb),Zc=>new v.a(213,
0,Zc,void 0,pb),null);f.ULS.sendTraceTag(537151433,0,50,"SpellCheckModel.InvokeSpellCheckChangeAllWebMethod InvokeSpellCheckChangeAll RequestSent")}Tci(){this.POa&&(f.ULS.sendTraceTag(537151430,0,15,"SpellCheckModel.InvokeSpellCheckCancelWebMethod Cancelling pending SpellCheck request"),A.h(this.$.oa.va,this.POa,null,null,null),this.POa=null);this.j$a&&(bc.AFrameworkApplication.vd.tu(this.j$a.Nt),this.j$a=null)}eld(eb,Xb=!1){this.Bf&&!Xb&&(f.ULS.sendTraceTag(537151427,0,50,"SpellCheckModel.InvokeFeedbackLoopWebMethod SpellCheck FeedbackLoop Item added"),
eb=Object(tb.a)(new tc,{AppId:"Excel_Online",CritiquePriority:0,LanguageId:this.tna,OriginalText:this.Bf.InputWord,Suggestions:this.Bf.Suggestions,SuggestionText:this.Bfd(eb),EventId:eb,TraceId:this.Bf.TraceId,CritiqueTypeId:this.Bf.CritiqueTypeId}),this.OLb.push(eb));if(5<this.OLb.length||Xb)f.ULS.sendTraceTag(537151426,0,50,`SpellCheckModel.InvokeFeedbackLoopWebMethod SpellCheck FeedbackLoop webmethod invoked with item count ${this.OLb.length}`),zb(this.$.oa.va,this.OLb,null,null,null,null),this.OLb.length=
0}qIb(eb){if(!eb)this.cG=this.aDc=this.zda=this.mP=null;else if(this.cG){for(;1<this.cG.length;)this.cG.pop();this.P6a?(this.mP.FirstRow=this.zda.Ranges[0].FirstRow,this.mP.FirstColumn=this.zda.Ranges[0].FirstColumn):(this.RXf(),this.zda=l.t(l.C(this.mP),this.$.pa))}this.Tci();f.ULS.sendTraceTag(537151395,0,50,`SpellCheckModel.ResetSpellCheckModel SpellCheck Model Reset, keepCurrentSpellCheckItem: ${eb}`)}TOf(eb,Xb){f.ULS.sendTraceTag(537151392,0,50,`SpellCheckModel.RemoveSpellCheckItems changeAll: ${eb}, ignoreAll: ${Xb}`);
Ha.e(this.cG)||(Xb&&(this.Zcc.contains(this.Bf.InputWord)?f.ULS.sendTraceTag(537151391,0,15,"SpellCheckModel.RemoveSpellCheckItems IgnoreAll words encountered again."):this.Zcc.add(this.Bf.InputWord)),eb||Xb?this.lMj(eb,Xb):this.cG.splice(0,1))}vlh(eb,Xb,oc){let Gc=oc.substring(0,this.Bf.StartIndex);var Vc=oc.substr(this.Bf.StartIndex);eb=this.Bfd(eb);Vc=Xb?Ra.a.UPa(oc,this.Bf.InputWord,eb,!1,Xb,!0):Gc+Ra.a.UPa(Vc,this.Bf.InputWord,eb,!1,Xb);if(!Ha.e(this.cG))for(const Ta of this.cG)if(this.Bf.Row===
Ta.Row&&this.Bf.Column===Ta.Column&&this.Bf.StartIndex<Ta.StartIndex){let pb=0;if(Xb){var P=String.format("(^|"+Va.a.O0a+"+)({0})(?:(?="+Va.a.O0a+")|$)",this.Bf.InputWord);Gc=oc.substring(0,Ta.StartIndex);for(P=new RegExp(P,"g");P.exec(Gc);)++pb}else pb=1;Ta.StartIndex+=(eb.length-this.Bf.InputWord.length)*pb}return Vc}Bfd(eb){switch(eb){case 4:case 8:return this.Bf.Suggestions[0];case 5:case 9:return this.Bf.Suggestions[1];case 6:case 10:return this.Bf.Suggestions[2];default:return""}}aK(eb){const Xb=
{};Xb.SearchString=this.Bf.InputWord;Xb.MatchCase=!0;Xb.MatchEntireCell=!0;Xb.SearchAllSheets=!1;Xb.SearchUp=!1;Xb.ExcludeFormulaResult=!0;Xb.SheetName=this.zda.SheetName;eb&&(Xb.ReplaceWholeWordOnly=!0,Xb.MatchEntireCell=!1);return Xb}$li(){return this.gridView.ha.sa.wg&&!this.gridView.ha.sa.jba()}ulh(eb,Xb){let oc,Gc;Gc=oc=null;if(!this.Bf)return f.ULS.shipAssertTag(537151378,0,!!this.Bf,"SpellCheckModel.EstimateSpellCheckReplaceSingleCell: ActiveSpellCheckItem is null"),{returnValue:!1,jWf:oc,
fIb:Gc};const Vc=u.g(this.$).Vb(w.Range.Uc(this.Bf.Row+1,this.Bf.Column+1));if(!Vc)return f.ULS.sendTraceTag(537151377,0,50,"EstimateReplaceSingleCell - currentCell is null"),{returnValue:!1,jWf:oc,fIb:Gc};oc=Vc.text;oc=Ra.a.K8a(oc);Gc=this.vlh(eb,Xb,oc);Vc.text=Gc;Xb&&(Gc=this.Bfd(eb));return{returnValue:!0,jWf:oc,fIb:Gc}}lMj(eb,Xb){if(!Ha.e(this.cG)){var oc=0,Gc=0,Vc=[];for(const P of this.cG)eb&&!Ra.a.equals(this.Bf.InputWord,P.InputWord,!1)||Xb&&!this.Zcc.contains(P.InputWord)?Vc[Gc++]=P:oc++;
this.cG=Vc;0<oc&&f.ULS.sendTraceTag(537151374,0,50,`SpellCheckModel.TrimChangeAndIgnoreAllWordsFromCache SpellCheckItems trimmed count ${oc} for ChangeAll: ${eb}, IgnoreAll: ${Xb}`)}}RXf(){this.mP.FirstColumn=this.Bf.Column+1;this.mP.FirstRow=this.Bf.Row;this.mP.FirstColumn===n.a.rw-1&&(this.mP.FirstColumn=0,this.mP.FirstRow=this.Bf.Row+1)}}Object(b.a)(hc,"SpellCheckModel",null,[620]);var Za=a(174),ub=a(1311),uc=a(555),Oc=a(737);class Bb{constructor(){this.localeId=this.localeName=null}}Object(b.a)(Bb,
"LocaleInfo",null,[]);class Nb{constructor(){this.onLanguageChangeExecute=this.supportedLocaleInfoList=this.currentLocale=null}}Object(b.a)(Nb,"LocaleInfoContent",null,[]);class dc{constructor(){this.misspelledWordEndIndex=this.misspelledWordBeginIndex=this.misspelledWordType=0;this.misspelledWordCellContent=null}}Object(b.a)(dc,"MisspelledWordBoxContent",null,[]);class sc{constructor(){this.changeCount=0;this.suggestionApplied=null}}Object(b.a)(sc,"PreviousChangeAllActionInfo",null,[]);class yc{constructor(){this.type=
null;this.activeTab=0;this.showLoadingIcon=!1;this.previousChangeAllActionInfo=this.onRecheckExecute=this.showOutOfSyncNotification=this.worksheetName=this.onMessageButtonExecute=this.localeInfoContent=this.userActionButtons=this.suggestionBoxContent=this.misspelledWordBoxContent=null}}Object(b.a)(yc,"SpellCheckTaskPaneProps",null,[]);class cd{constructor(){this.suggestionText=null;this.changeAllId=this.changeId=0}}Object(b.a)(cd,"Suggestion",null,[]);class pd{constructor(){this.onChangeAllButtonExecute=
this.onChangeButtonExecute=this.suggestions=null}}Object(b.a)(pd,"SuggestionBoxContent",null,[]);class Rb{constructor(){this.onIgnoreAllOrDeleteButtonExecute=this.onIgnoreButtonExecute=null}}Object(b.a)(Rb,"UserActionButtons",null,[]);class Dc{constructor(eb,Xb){this.$=eb;this.yr=Xb}AI(eb){Za.UISurfaces.Lj().then(Xb=>{Xb.showTaskPane("SpellCheckTaskPane",this.Xv(!0,1,null,null,null,null,0,null,!1,null,!0,eb));return null})}vu(eb,Xb,oc,Gc,Vc,P,Ta,pb,Yb,Ac,Zc){Za.UISurfaces.Lj().then(id=>{id.updateTaskPane("SpellCheckTaskPane",
this.Xv(!1,eb,Xb,oc,Gc,Vc,P,Ta,pb,Yb,Ac,Zc));return null})}PM(){Za.UISurfaces.Lj().then(eb=>{eb.hideTaskPane("SpellCheckTaskPane",2);return null})}eda(){Za.UISurfaces.Lj().then(eb=>{eb.setSelectedTaskPane("SpellCheckTaskPane");return null})}Xv(eb,Xb,oc,Gc,Vc,P,Ta,pb,Yb,Ac,Zc,id){eb=eb?Dc.w5g():this.F9g(Xb,oc,Gc,Vc,P,Ta,pb,Yb,Ac,Zc);if(gb.a.Ad(this.$))return Object(tb.a)(new ub.a,{contentProps:eb,onOpen:()=>{this.yr.fy()},onClose:()=>{this.yr.qB()},width:300,title:da.a.instance.ga(1300)});id=Object(tb.a)(new Oc.a,
{container:id,paneProps:eb});return Object(tb.a)(new ub.a,{contentProps:id,onOpen:()=>{this.yr.fy()}})}F9g(eb,Xb,oc,Gc,Vc,P,Ta,pb,Yb,Ac){let Zc=null,id=null,gd=null,Ub=null,Lc=null,hd=null,Kd=!0;switch(eb){case 1:({misspelledWordBoxContent:Zc,suggestionBoxContent:id,userActionButtons:gd,returnValue:Kd}=this.c7g(Xb,oc));Kd=({localeInfoContent:Ub}=this.XCe(Vc,Yb)).returnValue&&Kd;break;case 4:({localeInfoContent:Ub,returnValue:Kd}=this.XCe(Vc,Yb));break;case 5:hd=()=>{this.yr.iDj()};break;case 2:case 7:case 3:hd=
()=>{this.yr.Q4f()};break;case 8:hd=()=>{this.yr.jDj()}}0<P&&!({previousChangeAllActionInfo:Lc}=Dc.i8g(P,Ta)).returnValue&&f.ULS.sendTraceTag(537151372,0,10,"SpellCheckReactTaskPane.CreateSpellCheckTaskPaneProps Failed to create previous change all information.");Kd||(eb=7);return Object(tb.a)(new yc,{type:"SpellCheckTaskPaneProps",showLoadingIcon:Ac,activeTab:eb,misspelledWordBoxContent:Zc,suggestionBoxContent:id,userActionButtons:gd,localeInfoContent:Ub,onMessageButtonExecute:hd,worksheetName:Gc,
previousChangeAllActionInfo:Lc,showOutOfSyncNotification:pb,onRecheckExecute:()=>{this.yr.Q4f()}})}c7g(eb,Xb){let oc;var Gc;var Vc=Gc=oc=null;if(!eb||!Xb)return f.ULS.sendTraceTag(537151371,0,10,"SpellCheckReactTaskPane.CreateMisspelledWordTabData spellCheckItem/spellCheckCellText is null"),{returnValue:!1,misspelledWordBoxContent:oc,suggestionBoxContent:Gc,userActionButtons:Vc};oc=Object(tb.a)(new dc,{misspelledWordType:0===eb.Type?0:1,misspelledWordBeginIndex:eb.StartIndex,misspelledWordEndIndex:eb.StartIndex+
eb.Length,misspelledWordCellContent:Xb});Xb=null;Gc=0;if(!Ha.e(eb.Suggestions))for(Xb=Array(3),Vc=0;Vc<eb.Suggestions.length&&3>Vc;Vc++){const P=eb.Suggestions[Vc];let Ta,pb;Vc?1===Vc?(Ta=5,pb=9):(Ta=6,pb=10):(Ta=4,pb=8);Ra.a.Aq(P)||(Xb[Gc++]=Object(tb.a)(new cd,{suggestionText:P,changeId:Ta,changeAllId:pb}))}Gc=Object(tb.a)(new pd,{suggestions:Xb,onChangeButtonExecute:P=>{this.yr.qZc(!1,P)},onChangeAllButtonExecute:P=>{this.yr.qZc(!0,P)}});Vc=Object(tb.a)(new Rb,{onIgnoreButtonExecute:()=>{this.yr.x8e(!1,
0)},onIgnoreAllOrDeleteButtonExecute:()=>{1===eb.Type?this.yr.qZc(!1,3):this.yr.x8e(!0,1)}});return{returnValue:!0,misspelledWordBoxContent:oc,suggestionBoxContent:Gc,userActionButtons:Vc}}XCe(eb,Xb){var oc=null;if(Ha.e(Xb))return f.ULS.sendTraceTag(537151370,0,10,"SpellCheckReactTaskPane.CreateLocaleInfoContent supportedLocaleList is null"),{returnValue:!1,localeInfoContent:oc};oc=uc.a.YJ(eb);eb=Object(tb.a)(new Bb,{localeId:eb,localeName:oc?oc.displayName:eb});const Gc=Array(Xb.length);let Vc=0;
for(let P=0;P<Xb.length;P++)(oc=uc.a.YJ(Xb[P]))&&(Gc[Vc++]=Object(tb.a)(new Bb,{localeId:Xb[P],localeName:oc.displayName}));oc=Object(tb.a)(new Nb,{currentLocale:eb,supportedLocaleInfoList:Gc,onLanguageChangeExecute:P=>{this.yr.gDj(P)}});return{returnValue:!0,localeInfoContent:oc}}static w5g(){return Object(tb.a)(new yc,{type:"SpellCheckTaskPaneProps",activeTab:1,showLoadingIcon:!0,misspelledWordBoxContent:null,suggestionBoxContent:null,userActionButtons:null,localeInfoContent:null,onMessageButtonExecute:null,
previousChangeAllActionInfo:null})}static i8g(eb,Xb){let oc;oc=null;if(!Xb)return{returnValue:!1,previousChangeAllActionInfo:oc};oc=new sc;oc.changeCount=eb;oc.suggestionApplied=Xb;return{returnValue:!0,previousChangeAllActionInfo:oc}}}Object(b.a)(Dc,"SpellCheckReactTaskPane",null,[619]);class nd{constructor(eb){this.qAa=this.tna=null;this.PD=0;this.eSa=null;this.TLb=0;this.spellCheckTaskPane=null;this.ood=this.Ef=this.wKa=this.oxc=!1;this.nxc=this.pdb=null;this.showOutOfSyncNotification=!1;this.UDd=
0;this.Zz=this.I$a=null;this.Ozf=()=>{this.qB()};this.nh=()=>{if(3!==this.Iu){var Xb=u.g(this.$).Vb(null);Xb&&this.lXb&&Xb.range.equals(this.lXb)&&(f.ULS.sendTraceTag(537151489,0,50,"SpellCheckManager.OnEditStarted SpellCheckPaneTab set to ResumeSpellCheckTab"),this.Iu=2)}};this.gy=()=>{this.$.ea.Ke!==n.a.Ce&&this.$.ea.fc&&(this.wKa=!0)};this.mD=()=>{if(this.$.ea.Ke!==n.a.Ce&&this.wKa&&(this.wKa=!1,!this.showOutOfSyncNotification&&2!==this.Iu&&3!==this.Iu))if(this.oU<this.hE)if(f.ULS.sendTraceTag(537151457,
0,50,`SpellCheckManager.OnGridConsistent Unexpected SpellCheck Stateid Changed Expected ${this.oU} Active ${this.hE} StateId`),this.oU=this.hE,this.TLb=this.kXb,this.Hpd)f.ULS.sendTraceTag(537151456,0,15,"SpellCheckManager.OnGridConsistent SpellCheck Stateid Changed while ongoing SpellCheck request"),this.Zz.qIb(!1),this.ucb();else if(this.Bf&&1===this.Iu){var Xb=u.g(this.$).Vb(this.lXb);Xb&&this.qAa?(Xb=Xb.aTa,Xb=Ra.a.K8a(Xb),Ra.a.equals(Xb,this.qAa,!0)?(f.ULS.sendTraceTag(537151454,0,50,"SpellCheckManager.OnGridConsistent SpellCheck Cache cleared except for current active SpellCheckItem"),
this.Zz.qIb(!0)):(f.ULS.sendTraceTag(537151453,0,50,"SpellCheckManager.OnGridConsistent SpellCheck cell content mismatch"),this.Iu=2)):(f.ULS.sendTraceTag(537151455,0,50,"SpellCheckManager.OnGridConsistent SpellCheckFormatCell is null"),this.Iu=2)}else{if(5===this.PD||6===this.PD||8===this.PD)this.showOutOfSyncNotification=!0,this.updateTaskPane()}else this.oU>this.hE&&(f.ULS.sendTraceTag(537151452,0,50,`SpellCheckManager.OnGridConsistent SpellCheck Unexpected StateId's Encountered, Expected ${this.oU} Active ${this.hE} StateId`),
this.oU=this.hE)};this.Gh=(Xb,oc)=>{oc.pa?(this.oxc||(this.TLb=oc.pa.index,6!==this.Iu&&3!==this.Iu&&(this.Iu=3,f.ULS.sendTraceTag(537151448,0,50,"SpellCheckManager.OnActiveSheetChanged ActiveSpellCheckPaneTab set to ReCheckSpellCheckTab"))),this.oxc=!1):(f.ULS.sendTraceTag(537151449,0,10,"SpellCheckManager.OnActiveSheetChanged Active Sheet is null"),this.Iu=7)};this.Ec=(Xb,oc)=>{!oc.fg&&this.Ef&&this.qB()};this.$=eb;this.oU=this.hE;this.lai(eb);this.kai();gb.a.Ad(this.$)&&this.$.kk(this.Ec)}get Bf(){return this.Zz.Bf}get Iu(){return this.PD}set Iu(eb){this.showOutOfSyncNotification=
!1;if(4!==this.PD&&7!==this.PD||2!==eb&&3!==eb)this.PD=eb,7!==this.PD&&4!==this.PD&&2!==this.PD&&3!==this.PD&&5!==this.PD&&6!==this.PD&&8!==this.PD||this.Zz.qIb(!1),7===this.PD&&f.ULS.shipAssertTag(537151567,0,!1,"SpellCheckManager.ActiveSpellCheckPaneTab: Unexpected State encountered"),this.Ef?(this.updateTaskPane(),this.vfj()):this.ood=!0}get Hpd(){return this.Zz.nhi()}get hE(){return this.$.ea.Ke}get lXb(){return this.Bf?w.Range.Uc(this.Bf.Row+1,this.Bf.Column+1):null}get kXb(){return this.$.pa?
this.$.pa.index:0}dispose(){gb.a.Ad(this.$)&&this.$.zl(this.Ec);this.$=null;this.hideTaskPane();this.spellCheckTaskPane&&(this.spellCheckTaskPane.RN(this.Ozf),this.spellCheckTaskPane=this.nxc=null);this.pdb=null}Frj(eb,Xb){this.UDd=eb;this.I$a=Xb}vfj(){this.UDd=0;this.I$a=null}fy(){this.aZa();this.ood?(this.updateTaskPane(),this.ood=!1):(this.TLb=this.$.xa.pa.index,this.eSa&&!this.eSa.IsCurrentLocaleIdSupported&&4!==this.Iu?this.Iu=4:this.ucb())}qB(){this.hideTaskPane();this.Z4b();this.Zz.eld(12,
!0);this.Zz.qIb(!1);this.PD=0}bBj(){if(gb.a.Ad(this.$))this.showTaskPane();else if(this.spellCheckTaskPane)this.spellCheckTaskPane.isVisible?this.ugj():(this.spellCheckTaskPane.ig(!0),this.Ef||this.showTaskPane());else{const eb=Kb.GetServiceTaskFactory.Ra(this.$.da,302,303,0),Xb=Xa.a(this.$);K.TaskExtensions.Aa(K.TaskExtensions.Wd([eb,Xb],this.$.la),()=>{this.spellCheckTaskPane=eb.result;Xb.result.uQ(this.spellCheckTaskPane);this.BRi();this.spellCheckTaskPane.ig(!0);this.showTaskPane()},this.$.la,
3)}}qZc(eb,Xb){f.ULS.sendTraceTag(537151561,0,50,`SpellCheckManager.ChangeButtonClick ${eb}`);this.Hpd?f.ULS.sendTraceTag(537151560,0,10,"SpellCheckManager.ChangeButtonClick SpellCheck in progress"):(u.g(this.$).eb&&u.g(this.$).Go(!0),this.Zz.Uci(eb,Xb),this.oU=this.hE+1,this.Zz.eld(Xb),this.Zz.TOf(eb,!1),eb||this.Zz.Mxb())}x8e(eb,Xb){f.ULS.sendTraceTag(537151557,0,50,`SpellCheckManager.IgnoreButtonClick ${eb}`);this.Hpd?f.ULS.sendTraceTag(537151556,0,10,"SpellCheckManager.IgnoreButtonClick SpellCheck in progress"):
(u.g(this.$).eb&&u.g(this.$).Go(!0),this.Zz.eld(Xb),this.Zz.TOf(!1,eb),this.oU=this.hE,this.Zz.Mxb())}gDj(eb){u.g(this.$).eb&&u.g(this.$).Go(!0);f.ULS.sendTraceTag(537151553,0,50,"SpellCheckManager.SpellCheckLocaleChanged SpellCheck Locale changed");this.Zz=new hc(this.$,this,eb);this.tna=eb;this.eSa.IsCurrentLocaleIdSupported=!0;this.Zz.Mxb()}jDj(){f.ULS.sendTraceTag(537151523,0,50,"SpellCheckManager.SpellCheckReCheckCurrentSheetButtonClick SpellCheck Check Current Sheet button Clicked on SpellCheck complete on selected range.");
const eb=w.Range.Uc(1,1);u.g(this.$).ha.updateSelection(eb,eb,0);this.ucb()}Q4f(){u.g(this.$).eb&&u.g(this.$).Go(!0);f.ULS.sendTraceTag(537151521,0,50,"SpellCheckManager.SpellCheckResumeButtonClick SpellCheck Resume Button Clicked");this.ucb()}iDj(){u.g(this.$).eb&&u.g(this.$).Go(!0);f.ULS.sendTraceTag(537151518,0,50,"SpellCheckManager.SpellCheckNextWorkSheetButtonClick SpellCheck NextWorkSheet Button Clicked");const eb=this.d_e(this.kXb);eb?(f.ULS.sendTraceTag(537151517,0,50,`SpellCheckManager.SpellCheckNextWorkSheetButtonClick Worksheet Change from ${this.kXb} to ${eb.index}`),
u.g(this.$).U_(),this.oxc=!0,eb.activate(),u.g(this.$).Dg(l.v(w.Range.Uc(1,1),this.$),null,null,null,60,r.a.hDj),this.ucb()):(this.oxc=!1,this.Iu=7,f.ULS.sendTraceTag(537151516,0,10,"SpellCheckManager.SpellCheckNextWorkSheetButtonClick SpellCheckSwitchWorksheetTab shown when no next worksheet available."))}uSd(eb){f.ULS.sendTraceTag(537151513,0,50,"SpellCheckManager.SpellCheckSupportedLocaleListReceived SpellCheck SupportedLocaleList Received from Server");eb&&!Ha.e(eb.SupportedLocaleList)?(this.eSa=
eb,this.eSa.IsCurrentLocaleIdSupported||(f.ULS.sendTraceTag(537151512,0,15,"SpellCheckManager.SpellCheckSupportedLocaleListRecieved ActiveSpellCheckPaneTab set to LanguageErrorTab"),this.Iu=4)):(f.ULS.sendTraceTag(537151511,0,10,"SpellCheckManager.SpellCheckSupportedLocaleListRecieved ActiveSpellCheckPaneTab set to SpellCheckErrorTab"),this.Iu=7)}P4f(eb,Xb){if(eb&&this.Bf){eb=this.d_e(this.kXb);if(0===this.Bf.Type||1===this.Bf.Type){Xb=u.g(this.$).Vb(this.lXb);if(!Xb){f.ULS.sendTraceTag(537151507,
0,10,"SpellCheckManager.SpellCheckModelUpdated SpellFormatCell is null");this.qAa=null;this.Iu=7;return}this.qAa=Xb.aTa;this.qAa=Ra.a.K8a(this.qAa);if(!Ra.a.equals(this.qAa.substring(this.Bf.StartIndex,this.Bf.StartIndex+this.Bf.Length),this.Bf.InputWord,!1)){f.ULS.sendTraceTag(537151506,0,15,"SpellCheckManager.SpellCheckModelUpdated Mismatch in Client and Server Misspelled word");this.Iu=2;return}this.Iu=1}else this.Iu=Xb?8:eb&&this.TLb!==eb.index?5:6;f.ULS.sendTraceTag(537151505,0,50,`SpellCheckManager.SpellCheckModelUpdated, ActiveSpellCheckPaneTab set to ${this.Iu}`)}else f.ULS.sendTraceTag(537151508,
0,10,"SpellCheckManager.SpellCheckModelUpdated ActiveSpellCheckPaneTab set to SpellCheckErrorTab"),this.Iu=7}oAc(eb,Xb,oc){Xb=eb?l.B(Xb.Ranges[0]):oc;f.ULS.sendTraceTag(537151502,0,50,`SpellCheckManager.UpdateCellSelection SpellCheck cell selection updated: isSpellCheckWithInSelection ${eb}`);u.g(this.$).ha.updateSelection(Xb,oc,0,void 0,void 0,"SpellCheck.UpdateCellSelection");return u.a(u.g(this.$),"SpellCheck.UpdateCellSelection",void 0,60)}lai(eb){this.pdb=new Dc(eb,this)}kai(){this.tna=this.$.ya.DataCultureTag.toUpperCase();
this.Zz=new hc(this.$,this,this.tna);this.Zz.Fci(this.tna)}ucb(){f.ULS.shipAssertTag(537151495,0,!this.Bf,"SpellCheckManager.SetSpellCheckModel ActiveSpellCheckItem should be null");this.Zz.S9e();this.Zz.Mxb()}aZa(){this.$.ea.kE(this.gy);this.$.ea.bYa(this.mD);u.g(this.$).Xb.Nk(this.nh);this.$.xa.Pf(this.Gh)}Z4b(){this.$.xa&&this.$.xa.zg(this.Gh);var eb=this.$.ea;eb&&(eb.BD(this.gy),eb.Sab(this.mD));(eb=u.g(this.$).Xb)&&eb.tk(this.nh)}BRi(){this.nxc=this.spellCheckTaskPane.pM();this.spellCheckTaskPane.aM(this.Ozf)}d_e(eb){let Xb=
(eb+1)%this.$.xa.count,oc;for(;Xb!==eb;){oc=this.$.xa.getItem(Xb);if(null===oc||void 0===oc?0:oc.visible)return oc;Xb=(Xb+1)%this.$.xa.count}return null}ugj(){4!==this.Iu&&(this.updateTaskPane(!0),this.TLb=this.$.xa.pa.index,f.ULS.sendTraceTag(537151444,0,50,"SpellCheckManager.RestartSpellCheck SpellCheck is restarted"),this.Zz.qIb(!1),this.ucb())}showTaskPane(){gb.a.Ad(this.$)&&this.Ef?this.pdb.eda():(this.Ef=!0,this.pdb.AI(this.nxc))}updateTaskPane(eb=!1){this.pdb.vu(this.PD,this.Bf,this.qAa,this.$.pa.sheetName,
this.tna,this.UDd,this.I$a,this.showOutOfSyncNotification,this.eSa?this.eSa.SupportedLocaleList:null,eb,this.nxc);6!==this.PD||this.showOutOfSyncNotification||K.TaskExtensions.Aa(Kb.GetServiceTaskFactory.Ra(this.$.da,211,212,0),Xb=>{Xb=Xb.result;Xb.setEnabled(!0);Xb.readText(da.a.instance.ga(869))},this.$.la,3)}hideTaskPane(){this.Ef=!1;this.pdb.PM()}}Object(b.a)(nd,"SpellCheckManager",null,[600,2]);class od{constructor(eb){this.yr=null;this.$=eb}Nc(){return!1}Cc(eb,Xb){return Z.EwaSettings.ma(296)&&
1===eb&&1570327544===Xb.command}executeCommand(eb,Xb){this.yr||(this.yr=new nd(this.$));eb=K.TaskExtensions.fk();Xb=Xb.command;switch(Xb){case 1570327544:this.yr.bBj();break;default:eb=U.a(Xb)}return eb}Rc(){return!1}dispose(){this.yr&&(this.yr.dispose(),this.yr=null);this.$=null}}Object(b.a)(od,"SpellCheckCommandHandler",null,[195,2]);class wd extends d.a{constructor(eb){super(eb)}yd(){this.gd([new od(this.$)])}static ka(eb){d.a.Nd(301,new wd(eb))}}Object(b.a)(wd,"SpellCheckCommandHandlerFactory",
d.a,[]);var Pc=a(221),Hb=a(784),Nc=a(222),Db=a(13),Cc=a(108),Xc=a(85),ld=a(235),Dd=a(19),Od=a(258),Qd=a(245),Nd=a(700);class he{}he.urh="ewa-stp-pane";he.trh="ewa-stp-header";he.rrh="ewa-stp-body";he.vrh="ewa-stp-title";he.srh="ewa-stp-close-button";Object(b.a)(he,"CssClassNames",null,[]);const ve=he.urh,Td=he.trh,ke=he.rrh,xe=Va.a.zyc+he.vrh,le=Va.a.Idb+he.srh;class Je extends ld.a{constructor(eb,Xb,oc){super(eb);this.Eye=this.he=null;this.su=0;this.Cp=!1;this.Ec=(Gc,Vc)=>{Vc.fg||this.ig(!1)};this.$j=
()=>{this.ig(!1);this.raiseEvent("SpellCheckTaskPaneClose");return!0};this.$=Xb;this.taskPaneManager=oc;this.$.kk(this.Ec);Od.a(this.$).Xh(this)}dP(eb){this.get_events().addHandler("SpellCheckTaskPaneRemove",eb)}qR(eb){this.get_events().removeHandler("SpellCheckTaskPaneRemove",eb)}aM(eb){this.get_events().addHandler("SpellCheckTaskPaneClose",eb)}RN(eb){this.get_events().removeHandler("SpellCheckTaskPaneClose",eb)}get isVisible(){return super.isVisible}set isVisible(eb){super.isVisible!==eb&&(super.isVisible=
eb)}get titleText(){return da.a.instance.ga(1300)}get kf(){return this.isVisible}get Yg(){return 12}get $d(){return Qd.a.kDj}get Tk(){return Dd.a.gth}get RM(){return da.a.instance.ga(1074)}get wo(){return 300}get isResizable(){return!1}get mc(){return this.domElement}get height(){return this.taskPaneManager.oO.offsetHeight}BH(){}lp(){return this.Cp}Zr(){return this.Cp}dR(){}mQ(){return!1}lj(){}Nj(){}dispose(){this.$&&(this.$.zl(this.Ec),Od.a(this.$).Nz(this));this.he&&(Nc.a.instance.Ba(Db.a.click,
this.he,this.$j),Cc.KeyInputManager.instance.Bv(this.he,this.Eye));this.he=this.taskPaneManager=this.$=null;super.dispose()}hg(eb,Xb){if(!Xb){(eb=pa.DOMElementExtensions.getElementById(this.domElement,"SpellCheckTaskPaneCellContentId"))||(eb=pa.DOMElementExtensions.getElementById(this.domElement,"SpellCheckTaskPaneMessageButtonId"));if(!eb&&(eb=pa.DOMElementExtensions.Kl(this.domElement.querySelectorAll(pa.DOMElementExtensions.qr)),!eb))return!1;pa.DOMElementExtensions.setFocus(eb)}return!Xb}kh(eb){return pa.DOMElementExtensions.vf(this.mc,
eb)}ig(eb){this.Cp=eb;const Xb=this.taskPaneManager;pa.DOMElementExtensions.isVisible(Xb.mL);this.isVisible=eb;this.taskPaneManager.Pw();const oc=!!this.taskPaneManager.Bg&&12===this.taskPaneManager.Bg.taskPane.Yg;eb&&0<Xb.$z.length&&(!oc||Xb.isCollapsed)&&Xb.VF(this,!0);eb||(u.g(this.$).hg(!0,!1),this.$.qf())}pM(){const eb=document.getElementById(this.$.Bb+Va.a.vSd);var Xb=this.ZG();eb.appendChild(Xb);Xb=Nd.b("div","SpellCheckPaneBodyId",ke);eb.appendChild(Xb);return Xb}ZG(){const eb=Nd.b("div",
"SpellCheckPaneHeaderId",Td),Xb=Nd.b("span","SpellCheckPaneTitleId",xe);Xb.innerText=this.titleText;this.he=Hb.a.pb("SpellCheckPaneCloseButtonId",le,da.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.he.classList.add(bc.AFrameworkApplication.isRtl?Va.a.V$:Va.a.W$);Nc.a.instance.ra(Db.a.click,this.he,this.$j);this.Eye=Cc.KeyInputManager.instance.ms(this.he,this.$j,Xc.a.$h);eb.appendChild(Xb);eb.appendChild(this.he);return eb}static ka(eb,Xb){const oc=eb.Bb;let Gc=document.getElementById(oc+Va.a.vSd);
Gc||(Gc=document.createElement("div"),Gc.id=eb.Bb+Va.a.vSd,Gc.classList.add(ve),document.getElementById(oc+Va.a.WQ).appendChild(Gc));return eb.da.za(302)||eb.da.Ga(302,new Je(Gc,eb,Xb))}}Object(b.a)(Je,"SpellCheckTaskPane",ld.a,[578,2,401,102]);class Fe extends Pc.a{constructor(eb){super();this.eh=this.ri=null;this.$=eb;this.Fb()}get pD(){this.ri||(this.ri=K.TaskExtensions.Aa(Xa.a(this.$),eb=>{this.eh=Je.ka(this.$,eb.result)},this.la,3));return this.ri}create(){const eb=Kb.GetServiceTaskFactory.create(this.$.da,
203,this.la,this.hb),Xb=Kb.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb);K.TaskExtensions.Aa(K.TaskExtensions.ts(K.TaskExtensions.Wd([eb,Xb],this.la),()=>this.pD,this.la),()=>{this.qb(this.eh)},this.la,3)}dispose(){this.eh=this.ri=this.$=null;super.dispose()}static ka(eb){eb.da.Ga(303,new Fe(eb))}}Object(b.a)(Fe,"SpellCheckTaskPaneFactory",Pc.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Find");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ShareSection");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SpellCheck");Type.registerNamespace("_Ewa");c.a.Fa(G.ka);T.a.Hi('.FindDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.FindDialog .ewa-dlg-body-fullLine{width:350px}.FindDialog input[type="text"]{width:350px}.FindDialog .ReplaceResultLabel{color:#2db932}.FindDialog .ReplaceResultLabelForFindAll{width:358px;height:auto;background:#dff6dd;border-radius:0}.FindDialog .FindUserAlertLabel{color:#d90000;margin-top:16px}.FindDialog .FindUserAlertLabelForFindAll{background:#fde7e9;border-radius:0;height:auto;width:358px}.FindDialog .FindUserInfoLabelForFindAll{border-radius:0;height:auto;width:358px}.FindDialog .FindUserAlertLabelForFindAllWrapper{padding-top:10px;padding-bottom:10px;display:inline-flex}.ewa-dlg-elements-container-ltr .FindDialog .FindUserAlertLabelForFindAllWrapper{padding-left:7px}.ewa-dlg-elements-container-rtl .FindDialog .FindUserAlertLabelForFindAllWrapper{padding-right:7px}.FindDialog .Collapsed{visibility:hidden;height:0}.ewa-dlg-elements-container-ltr .FindDialog .ChevronDivIdRotated{transform:rotate(90deg) scale(1.2)}.ewa-dlg-elements-container-rtl .FindDialog .ChevronDivIdRotated{transform:rotate(270deg) scale(1.2)}.FindDialog .ChevronStart{transform:rotate(180deg) scale(1.2)}.FindDialog .AdvancedOptionsContainer{display:flex;justify-content:space-between}.FindDialog .CollapsedAdvancedOptionsContainer{height:1px}.FindDialog .SearchOptionsContainer{display:flex;align-items:center;margin-bottom:8px;margin-top:8px}.FindDialog .SearchOptionsLabel{margin-top:0;margin-bottom:0;font-size:14px;cursor:pointer;padding-top:1px;padding-bottom:1px}.ewa-dlg-elements-container-ltr .FindDialog .SearchOptionsLabel{margin-left:7px}.ewa-dlg-elements-container-rtl .FindDialog .SearchOptionsLabel{margin-right:7px}.FindDialog .AdvancedOptionsDropdowns{display:flex;justify-content:space-between}.FindDialog .DropdownWithLabel{flex:0 0 50%}.ewa-dlg-elements-container-ltr .FindDialog .DropdownWithLabel{margin-right:2px}.ewa-dlg-elements-container-rtl .FindDialog .DropdownWithLabel{margin-left:2px}.FindDialog .FindAllTableHeader{width:358px;height:28px;background:#e9f5ee;display:block;font-size:12px;color:#252423}.FindDialog .FindAllTableHeader tr{width:inherit;height:inherit;margin:0;padding:0}.FindDialog .FindAllTableHeader th{border-bottom:1px solid #fff;padding-top:5px;padding-bottom:0;margin:0;height:auto}.ewa-dlg-elements-container-ltr .FindDialog .FindAllTableHeader th{text-align:left;padding-left:8px;border-right:1px solid #fff}.ewa-dlg-elements-container-rtl .FindDialog .FindAllTableHeader th{text-align:right;padding-right:8px;border-left:1px solid #fff}.FindDialog .FindAllTableBody{display:block;overflow-y:auto;overflow-x:hidden;height:auto;max-height:168px;width:358px}.FindDialog .FindAllRow:hover{background-color:#f3f3f3}.FindDialog .FindAllRow{width:358px;height:28px;background:#faf9f8;border-bottom:1px solid #fff}.FindDialog .FindAllTableData{font-size:12px;color:#252423;padding-top:5px}.ewa-dlg-elements-container-ltr .FindDialog .FindAllTableData{padding-left:8px;border-right:1px solid #fff}.ewa-dlg-elements-container-rtl .FindDialog .FindAllTableData{padding-right:8px;border-left:1px solid #fff}.FindDialog .FindAllTableDataSheetName{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:67px}.FindDialog .FindAllTableDataCell{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:54px}.FindDialog .FindAllTableDataValue{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:182px}.FindDialog ::-webkit-scrollbar{width:8px;height:auto}.FindDialog ::-webkit-scrollbar-track{background:#faf9f9;border-radius:10px}.FindDialog ::-webkit-scrollbar-thumb{background:#c6c6c6;height:30px;width:8px;border-radius:4px}.ewa-dlg-buttonarea.FindDialog{display:flex;flex-wrap:wrap;justify-content:flex-end;max-width:358px}.FindDialog .ewa-dlg-button{max-width:79px}');
c.a.Fa(ib.ka);c.a.Fa($a.ka);T.a.Hi(".ewr-shareSection-tooltip-container,.ewr-shareSection-floatingoject-tooltip-container{position:absolute;height:20px;display:flex;cursor:pointer;width:auto;border-radius:10px}.ewr-shareSection-tooltip-container{z-index:48}.ewr-shareSection-floatingoject-tooltip-container{z-index:51}.ewr-shareSection-tooltip-hidden{display:none}.ewr-shareSection-tooltip-flyout{position:absolute;height:20px;display:flex;background-color:#217346;overflow:hidden;border-radius:10px;min-width:20px}.ewr-grdcontarea-ltr .ewr-shareSection-tooltip-toggle-leftAndRight{right:0}.ewr-grdcontarea-rtl .ewr-shareSection-tooltip-toggle-leftAndRight{left:0}.ewr-shareSection-tooltip-textContainer{height:20px;display:flex;width:auto;max-width:300px;overflow:hidden;transition:all .1s ease-in}.ewr-shareSection-tooltip-toggle-maxWidth0{max-width:0;transition:all .1s ease-out}.ewr-shareSection-tooltip-icon,.ewr-shareSection-tooltip-close-icon{width:20px;height:20px;overflow:hidden}.ewr-shareSection-tooltip-close-icon{margin-left:-4px;margin-right:2px}.ewr-shareSection-tooltip-text{font-size:10px;color:#fff;margin:4px 2px;padding-left:6px;padding-right:4px;line-height:12px;border-right:1px solid #58a37a;white-space:nowrap}.ewr-shareSection-tooltip-toggle-maxWidth0 .ewr-shareSection-tooltip-text{border-right:none}.ewr-shareSection-highlightDiv-overlay{background-color:#217346;opacity:0;display:block;width:100%;height:100%;transition:all .1s ease-in}.ewr-shareSection-tooltip-toggle-opacity{opacity:.2;transition:all .1s ease-out}");
c.a.Fa(Jb.ka);c.a.Fa(db.ka);T.a.Hi('.ewa-stp-pane{height:100%;display:flex;flex-direction:column;overflow:hidden;background:#edebe9}.ewa-stp-header{position:relative;overflow:hidden;padding:16px;background:#edebe9}.ewa-stp-body{height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-y:auto;overflow-x:hidden;background:#edebe9}.ewa-stp-title{height:22px;font-weight:normal;position:relative !important;max-width:230px;display:inline-block;text-overflow:ellipsis;overflow:hidden;font-size:16px;font-family:"Segoe UI Semibold","Segoe UI Web Semibold","Arial Semibold","Verdana Semibold","sans-serif Semibold";background:#edebe9;color:#252423}.ewa-stp-close-button{margin:auto;margin-right:0;margin-top:3px}');
(()=>{c.a.Fa(eb=>{Fe.ka(eb);wd.ka(eb)})})()},915:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b,d,f,e,k){this.selectedRanges=this.activeCell=this.replaceWith=this.findData=null;this.isSingle=!1;this.findData=b;this.replaceWith=d;this.activeCell=f;this.selectedRanges=e;this.isSingle=k}aK(){return this.findData}getActiveCell(){return this.activeCell}}Object(t.a)(c,"MacroRecorderReplaceAllPayload",null,[101])},916:function(t,C,a){a.d(C,"b",function(){return b});a.d(C,"a",
function(){return d});a.d(C,"c",function(){return f});var c=a(61);const b=(e,k,l,m,v,n,w,r)=>{const u=e.Na(1);u.findData=k;u.activeCell=l;u.selectedRanges=m;return c.g(e,"FindCell",u,v,n,w,r,4)},d=(e,k,l,m,v,n,w)=>{const r=e.Na(1);r.findData=k;r.selectedRanges=l;return c.g(e,"FindAll",r,m,v,n,w,4)},f=(e,k,l,m,v,n,w,r,u,y)=>{const x=e.Na(1);x.findData=k;x.replaceWith=v;x.activeCell=l;x.selectedRanges=m;x.isSingle=n;return c.g(e,"ReplaceAll",x,w,r,u,y,0)}},917:function(t,C,a){a.d(C,"a",function(){return c});
t=a(0);class c{constructor(b,d){this.selectedRanges=this.findData=null;this.findData=b;this.selectedRanges=d}aK(){return this.findData}}Object(t.a)(c,"MacroRecorderFindAllPayload",null,[101])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.nav.js.map/b7cc8d2bae96f8589c9ad831518b8ebf/EwaDSEsNext.nav.js.map