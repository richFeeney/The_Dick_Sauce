'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[31],{1192:function(t,C,a){t=a(0);var c=a(83),b=a(15),d=a(159),f=a(39);class e{constructor(z){this.zfa=this.tfa=this.Dfa=this.Cfa=null;this.l6d=this.A9d=this.Ww=this.ML=!1;this.nOc=this.Q9d=null;this.I9d=0;this.nb=this.O9d=null;this.S0=z;this.iA=3;this.pib=!0}initialize(z,A,I){this.Cfa=this.afd(z,A);this.Dfa=CommonUIStrings.l_SavingStatus;this.tfa=CommonUIStrings.l_ReadOnlyStatus;this.zfa=CommonUIStrings.l_ReviewModeStatus;
this.S0&&this.S0.execute(F=>{F.aUc(Object(c.a)(this,this.YNb,"updateToSavingStatus"))});this.Ww=!0;this.nb=I;return!0}$da(z,A){this.ML=z;this.iA=A;this.YR(this.pib)}YR(z){!this.pib&&z&&(this.O9d=new Date);this.pib=z;z=null;3===this.iA&&(z=this.pib?this.Cfa:this.Dfa);this.qfh(z)}afd(z,A){return z?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):A&&A.length?String.format(CommonUIStrings.l_SavedToStatus,A):CommonUIStrings.l_SavedStatus}YNb(){this.YR(!1)}bRh(){switch(this.iA){case 1:return this.tfa;
case 2:return this.zfa;default:return null}}Nfi(z){return this.A9d===this.ML&&this.I9d===this.iA&&this.Q9d===z}A5c(z){appChrome.getHeaderApi().then(A=>{A.updateDocumentTitleStatus(this.ML,z,this.bRh(),this.O9d,this.pib);this.l6d=!0;return null});this.nOc=null}qfh(z){this.Ww&&d.c()&&!this.Nfi(z)&&(!this.l6d&&this.nb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.A5c(z):f.a.bSf()?(this.nOc&&b.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),
this.nOc=window.requestIdleCallback(()=>{this.A5c(z)})):window.requestAnimationFrame(()=>{this.A5c(z)}),this.A9d=this.ML,this.Q9d=z,this.I9d=this.iA)}}Object(t.a)(e,"ReactSaveStatusUIHandler",null,[442]);var k=a(163);class l{constructor(z,A){this.Wr=null;this.Cfa=CommonUIStrings.l_SavedStatus;this.Dfa=CommonUIStrings.l_SavingStatus;this.tfa=CommonUIStrings.l_ReadOnlyStatus;this.zfa=CommonUIStrings.l_ReviewModeStatus;this.YRb=A;this.S0=z;this.iA=3;this.Dqa=!0}rv(){this.S0&&this.S0.execute(z=>{z.aUc(Object(c.a)(this,
this.YNb,"updateToSavingStatus"))});this.YRb.execute(z=>{this.Wr=z})}$da(z,A){this.iA=A;3===A?this.YR(this.Dqa):2===A?this.DWd(this.zfa):this.DWd(this.tfa)}YNb(){this.YR(!1)}YR(z){this.Dqa=z;this.DWd(this.Dqa?this.Cfa:this.Dfa)}DWd(z){this.Wr&&this.Wr.Fj(k.a.PNj,this.W0g(z))}W0g(z){const A={};A.StatusText=z;return A}}Object(t.a)(l,"SaveStatusPostMessageHandler",null,[442]);var m=a(92),v=a(123),n=a(56);class w{constructor(z,A,I,F){this.zfa=this.tfa=this.Dfa=this.Cfa=null;this.ADa=0;this.dE=this.aPc=
this.QBa=this.GDc=this.yEa=null;this.Md=z;this.c8=A;this.S0=I;this.gj=F;this.$7d=!0;this.ML=!1;this.iA=3;this.Dqa=!0}initialize(z,A){if(!this.Md)return!1;this.Cfa=this.afd(z,A);this.Dfa=CommonUIStrings.l_SavingStatus;this.tfa=CommonUIStrings.l_ReadOnlyStatus;this.zfa=CommonUIStrings.l_ReviewModeStatus;this.rv();return!0}afd(z,A){return z?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):A&&A.length?String.format(CommonUIStrings.l_SavedToStatus,A):CommonUIStrings.l_SavedStatus}rv(){this.c8&&
this.c8.execute(z=>{z.QFg(Object(c.a)(this,this.TDe,"createStatusAndModeElements"));z.HFg(Object(c.a)(this,this.Jzj,"showHideSaveStatusElement"));z.BKj&&this.TDe(null,null)});this.S0&&this.S0.execute(z=>{z.aUc(Object(c.a)(this,this.YNb,"updateToSavingStatus"))})}Cv(){this.dE&&this.Md&&this.Md.nG(this.dE)}Jzj(z,A){this.$da("true"===A,this.iA)}$da(z,A){this.ML=z;this.iA=A;this.GDc&&(this.GDc.style.display=this.ML||3===this.iA||!this.yEa?"none":"");this.QBa&&(this.QBa.style.display=this.ML||3===this.iA?
"none":"",this.QBa.innerText=1===this.iA?this.tfa:this.zfa,this.QBa.title=1===this.iA?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.aPc&&(this.aPc.style.display=this.ML||1===this.iA||!this.yEa&&!this.QBa?"none":"");this.dE&&(this.dE.style.display=this.ML||1===this.iA?"none":"",this.YR(this.Dqa),this.dE.title=CommonUIStrings.l_SaveStatusTooltip)}TDe(z,A){z=document.getElementById(m.CuiHelper.z6e);A&&A.ZWj||!z||""===this.Cfa||""===this.Dfa||""===this.tfa||""===
this.zfa||(this.yEa=document.getElementById(m.CuiHelper.I_b),this.GDc=m.CuiHelper.Fsa(z,"BreadcrumbAppModeDash","-",null,!1),this.QBa=m.CuiHelper.Fsa(z,"BreadcrumbAppModeStatus",1===this.iA?this.tfa:this.zfa,null,!1),this.scg(this.QBa),this.aPc=m.CuiHelper.Fsa(z,"BreadcrumbSaveStatusDash","-",null,!1),this.dE=m.CuiHelper.Fsa(z,"BreadcrumbSaveStatus",this.Cfa,null,!1),this.scg(this.dE),this.$da(this.ML,this.iA))}YNb(){this.YR(!1)}YR(z){this.Dqa=z;this.RSj(this.Dqa?this.Cfa:this.Dfa)}RSj(z){!this.dE||
3!==this.iA&&2!==this.iA||(this.$7d&&!this.Dqa?(this.ADa=this.dE.offsetWidth<this.ADa?this.ADa:this.dE.offsetWidth,this.PPj(this.Dfa),this.$7d=!1):this.dE.innerText=z)}scg(z){z.style.direction=this.gj?"rtl":"ltr";z.style.width="auto";z.style.textAlign=this.gj?"right":"left";z.style.display=this.ML?"none":"";z.setAttribute("Unselectable","on")}PPj(z){this.dE&&(this.dE.style.width="",this.dE.innerText=z,this.ADa=this.dE.offsetWidth<this.ADa?this.ADa:this.dE.offsetWidth,z=v.a.aB(this.dE),this.dE.style.width=
this.ADa-n.a.qD(z.paddingLeft)-n.a.qD(z.paddingRight)+1+"px")}}Object(t.a)(w,"SaveStatusUIHandler",null,[442]);var r=a(4),u=a(91);class y{constructor(){this.bPc=this.bOc=this.Fkb=this.fb=null}get name(){return"Common.App.SaveStatus"}Rh(z){this.fb=z;r.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&r.AFrameworkApplication.hideHeaderEmbedded?this.fb.register(l,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").tc().Fc(()=>new l(this.fb.Wb("Common.App.HostNotification.EditNotificationEventSource"),
this.fb.Wb("Postmessage.IHostPostmessenger"))):r.AFrameworkApplication.ta.Oa.zgf||(r.AFrameworkApplication.ta.Oa.$r?this.fb.register(e,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").tc().Fc(()=>new e(this.fb.Wb("Common.App.HostNotification.EditNotificationEventSource"))):this.fb.register(w,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").tc().Fc(()=>new w(u.EventHandlerManager.instance,this.fb.Wb("Common.App.Header.HeaderEventSource"),
this.fb.Wb("Common.App.HostNotification.EditNotificationEventSource"),r.AFrameworkApplication.isRtl)))}init(){r.AFrameworkApplication.fa.gv(Object(c.a)(this,this.pB,"onFullAppSettingsReady"))}pB(){const z=r.AFrameworkApplication.fa,A=!!r.AFrameworkApplication.ta.Oa&&4===r.AFrameworkApplication.ta.Oa.xj;if(z.qa("WordEditorAutoSaveImprovementIsEnabled")||z.qa("PptEditorSaveStatusInHeaderEnabled")||A&&z.qa("SimplifiedReactRibbonUxIsEnabled")||z.qa("ExcelSaveStatusInHeaderEnabled")||z.qa("VisioSaveStatusInHeaderEnabled"))r.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&
r.AFrameworkApplication.hideHeaderEmbedded?(this.bPc=this.fb.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.bPc.rv():r.AFrameworkApplication.ta.Oa.zgf||(r.AFrameworkApplication.ta.Oa.$r?(this.bOc=this.fb.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.bOc.initialize(z.qa("IsSkyDrive"),z.Va("HostNameToIncludeInSavedStatus"),r.AFrameworkApplication.fa):(this.Fkb=this.fb.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.Fkb.initialize(z.qa("IsSkyDrive"),
z.Va("HostNameToIncludeInSavedStatus")))}dispose(){this.Fkb&&this.Fkb.Cv()}}Object(t.a)(y,"PackageManager",null,[4,5]);var x=a(246);a.d(C,"a",function(){return B});const B=()=>{Type.registerNamespace("Common.App.SaveStatus");x.a.instance.yi(new y)}},1247:function(t,C,a){var c=a(10);t=a(0);var b=a(82),d=a(221),f=a(224),e=a(29),k=a(21);class l{constructor(w,r){this.Cee=this.pJc=!1;this.oya=(u,y)=>{(null===y||void 0===y?0:y.gH)&&e.a.MKg([y.gH])&&(this.bJb=!0)};this.Ao=()=>{this.bJb=!1};this.Xc=(u,y)=>
{f.b(y)&&this.$da(!0);this.bJb=!1};this.$c=()=>{this.TM=this.$.TM;this.$da()};this.jBf=()=>{this.YR()};this.mAf=()=>{this.TM=this.$.TM};this.wyd=()=>{k.g(this.$).Ea.sv(this.wyd);this.TM=this.$.TM};this.gVf=r;this.$=w;this.$.userOperationManager.Hr(this.mAf);this.$.el(this.$c);this.$.ea.qGg(this.jBf);this.$.ea.jk(this.Xc);this.$.vYb(this.oya);this.$.ea.$L(this.Ao);this.$da()}get Ipi(){return this.$.ea?this.$.ea.cjf:!1}get TM(){return this.pJc}set TM(w){w?this.pJc=!0:k.g(this.$)&&k.g(this.$).Ea&&(k.g(this.$).Ea.kZ()?
this.pJc=!1:k.g(this.$).Ea.kx(this.wyd));this.YR()}get bJb(){return this.Cee}set bJb(w){this.Cee=w;this.YR()}dispose(){this.$&&(this.$.Al(this.$c),this.$.Hrc(this.oya),this.$.userOperationManager&&this.$.userOperationManager.Co(this.mAf),this.$.ea&&(this.$.ea.dcj(this.jBf),this.$.ea.Ik(this.Xc),this.$.ea.pR(this.Ao)),k.g(this.$)&&k.g(this.$).Ea&&k.g(this.$).Ea.sv(this.wyd))}$da(w=!1){w=!this.$.isEditMode||w;this.gVf.$da(w,this.$.isEditMode?3:1);this.YR()}YR(){this.$.isEditMode&&this.gVf.YR(!this.TM&&
!this.Ipi&&!this.bJb)}}Object(t.a)(l,"SaveStatusManager",null,[2]);var m=a(696);class v extends d.a{constructor(w){super();this.Jc=w;this.Fb()}create(){const w=b.a.instance;w.Wb("Common.App.SaveStatus.ISaveStatusUIHandler").execute(r=>{const u=new l(this.Jc,r);w.register(l,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").tc().Fc(()=>u);r=Object(m.b)(this.Jc.da,300,()=>w.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.qb(r)})}static ka(w){w.da.Ga(299,
new v(w))}}Object(t.a)(v,"SaveStatusFactory",d.a,[]);a.d(C,"a",function(){return n});const n=()=>{c.a.Fa(v.ka)}},1391:function(t,C,a){a.r(C);t=a(1192);a=a(1247);Type.registerNamespace("_Ewa");Object(t.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.savestatus.js.map/417a0b92481bcb50f7246c5ceb1efebc/EwaDSEsNext.savestatus.js.map