'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[58],{1417:function(t,C,a){a.r(C);var c=a(508),b=a(0),d=a(15),f=a(86),e=a(84),k=a(412),l=a(78),m=a(48),v=a(258),n=a(236),w=a(13),r=a(731),u=a(72);class y{}y.hmh="ewa-bix-ltr";y.imh="ewa-bix-rtl";y.lmh="ewa-bix-titlebar";y.jmh="ewa-bix-subtitle";y.kmh="ewa-bix-title";y.vLe="ewa-bix-close";y.PA="clip16x16";y.amh="ewa-bix-body";y.fmh="ewa-bix-drilldetails";y.cmh="ewa-bix-DrillButton";y.gmh="ewa-bix-hover";y.dmh="ewa-bix-DrillLabel1";
y.emh="ewa-bix-DrillLabel2";y.mmh="ewa-bixfl";y.wLe="ewa-bixfl-NoFocus";y.pmh="ewa-bixfl-ItemSelected";y.nmh="ewa-bixfl-Icon";y.omh="ewa-bixfl-Item";y.bmh="ewa-bix-calloutBackground";y.c7b="ewa-ipad";Object(b.a)(y,"CssClassNames",null,[]);var x=a(19),B=a(5),z=a(61),A=a(30),I=a(235),F=a(12),U=a(71),X=a(14),S=a(21);class H extends I.a{constructor(Fa,Mb,gc,Qc,Sc,ud){super(Mb);this.e6c=["bix-drill-action-down","bix-drill-action-up","bix-drill-action-to"];this.U3b=-1;this.hua=this.$rb=this.Zrb=this.asb=
null;this.ed=Zd=>{const ne=this.domElement;let Rd=Zd.target;for(;Rd!==ne;){if(Rd.id.startsWith("bix-drill-action")){this.drillTo(this.U3b,Rd.id);U.g(Zd);break}Rd=Rd.parentNode}};this.NBf=(Zd,ne)=>{Zd=-1===this.U3b;const Rd=ne.M5h;this.U3b=Rd;let ie=null;Rd===this.Bse.HierarchyId?(this.FYf(!1),this.drillUp||this.drillDown?(this.GYf(!0),F.DOMElementExtensions.setVisible(this.domElement,!0),ie=this.Zrb||this.asb):F.DOMElementExtensions.setVisible(this.domElement,!1)):(this.GYf(!1),ie=this.$rb,H.epj(ie,
ne.caption,X.a.instance.ga(1193)),this.FYf(!0),F.DOMElementExtensions.setVisible(this.domElement,!0));Zd||this.RYf(ie)};this.$=Fa;this.uy=gc;this.Bse=Qc.Context;Fa=Qc.DrillContext;this.drillUp=Fa.DrillUp;this.drillDown=Fa.DrillDown;this.xid=Sc;this.lJ=ud;Sc.KFg(this.NBf);this.$G()}dispose(){this.xid&&this.xid.Abj(this.NBf);this.e6c=this.asb=this.Zrb=this.$rb=this.hua=this.lJ=this.drillUp=this.drillDown=this.Bse=this.uy=this.lJ=this.xid=this.$=null;super.dispose()}focus(){this.setFocus(!0)}hasFocus(){var Fa=
F.DOMElementExtensions.Qp(this.domElement);if(!Fa)return!1;Fa=Fa.id;return!!Fa&&Fa.startsWith("bix-drill-action")}onKeyDown(Fa){const Mb=Fa.keyCode;Fa=Fa.shiftKey;if(this.hasFocus()){let gc=!1;13===Mb?(this.drillTo(this.U3b,this.hua.id),gc=!0):9===Mb&&((gc=this.SZ(!Fa))||this.OFe());return gc}return 9===Mb?this.setInitialFocus(!Fa):!1}setFocus(Fa){return this.hasFocus()?this.SZ(Fa):this.setInitialFocus(Fa)}$G(){F.DOMElementExtensions.nu(this.domElement,B.a.JZb,null,null);var Fa='<button id="{0}" class="'+
y.cmh+'" tabIndex="-1" title="{1}" style="display:none" onkeyup="return false;" onkeypress="return false;" role="menuitem" aria-describedby="{2} {4}"><div id="{2}"class="'+y.dmh+'">{3}</div><div id="{4}" class="'+y.emh+'">{5}</div></button>';let Mb="",gc;let Qc;if(this.drillDown){gc=X.a.instance.ga(1195);var Sc=this.drillDown.Caption;Qc=String.format("{0} ({1})",gc,Sc?A.a.$Y(Sc):"");Sc=Sc?A.a.Eg(Sc):"";Mb+=String.format(Fa,"bix-drill-action-down",Qc,"bixdddl_1",gc,"bixdddl_2",Sc)}this.drillUp&&(gc=
X.a.instance.ga(1194),Sc=this.drillUp.Caption,Qc=String.format("{0} ({1})",gc,Sc?A.a.$Y(Sc):""),Sc=Sc?A.a.Eg(Sc):"",Mb+=String.format(Fa,"bix-drill-action-up",Qc,"bixddul_1",gc,"bixddul_2",Sc));Mb+=String.format(Fa,"bix-drill-action-to","","bixddtl_1",X.a.instance.ga(1193),"bixddtl_2","");Fa=this.domElement;F.DOMElementExtensions.wv(Fa,Mb);this.asb=this.getElementById("bix-drill-action-up");this.Zrb=this.getElementById("bix-drill-action-down");this.$rb=this.getElementById("bix-drill-action-to");this.Gc.ka("click",
this.ed);Fa.setAttribute(B.a.T1,"");F.DOMElementExtensions.setVisible(Fa,!1)}drillTo(Fa,Mb){let gc;switch(Mb){case "bix-drill-action-up":gc=this.drillUp.Id;break;case "bix-drill-action-down":gc=this.drillDown.Id;break;case "bix-drill-action-to":gc=1;break;default:return}S.g(this.$).Go(!0);this.lJ.d_g((Qc,Sc,ud)=>{var Zd=this.uy,ne=this.$.oa.va,Rd=Zd.confirmationRequiredForDataOps,ie=gc;Zd=z.L(ne,Zd.Jw,Zd.externalSourceIndex,this.uy.gR);Zd.requiresConfirmation=Rd;Zd.hierarchyId=Fa;Zd.levelId=ie;return z.g(ne,
"BixDrill",Zd,Qc,Sc,ud,null,0)})}SZ(Fa){let Mb=0;if(this.hua)switch(this.hua.id){case "bix-drill-action-down":Mb=0;break;case "bix-drill-action-up":Mb=1;break;case "bix-drill-action-to":Mb=2}return this.JZf(Fa?Mb+1:Mb-1,Fa)}OFe(){const Fa=this.hua;Fa&&(Fa.blur(),this.domElement.setAttribute(B.a.T1,""));this.hua=null}FYf(Fa){this.$rb&&F.DOMElementExtensions.setVisible(this.$rb,Fa)}GYf(Fa){this.asb&&F.DOMElementExtensions.setVisible(this.asb,Fa);this.Zrb&&F.DOMElementExtensions.setVisible(this.Zrb,
Fa)}RYf(Fa){Fa!==this.hua&&this.OFe();if(!Fa)return!1;Fa.tabIndex=0;F.DOMElementExtensions.setFocus(Fa);this.domElement.setAttribute(B.a.T1,Fa.id);this.hua=Fa;return!0}setInitialFocus(Fa){return this.JZf(Fa?0:this.e6c.length-1,Fa)}JZf(Fa,Mb){const gc=this.e6c;for(;0<=Fa&&Fa<gc.length;){const Qc=F.DOMElementExtensions.getElementById(this.domElement,gc[Fa]);if(Qc&&F.DOMElementExtensions.isVisible(Qc))return this.RYf(Qc);Fa=Mb?Fa+1:Fa-1}return!1}static epj(Fa,Mb,gc){gc=String.format("{0} ({1})",gc,Mb);
Fa.setAttribute("title",gc);Fa.lastChild.innerText=Mb}}Object(b.a)(H,"BixDrillDetails",I.a,[]);var D=a(222),J=a(27),M=a(35),G=a(211),T=a(54);const K=y.omh,L=y.pmh,V=`<div id="{0}" class="${y.nmh}" style="{1}"><div class="${x.a.PA}"><img id="{2}" class="{3}" role="{4}" src="{5}"/></div></div>`;class W{constructor(Fa,Mb,gc,Qc,Sc){this._element=null;this.cJ=this.visible=!0;this.fieldListSelector=Fa;this.HEc=Mb.Name||"";this.clientId=Mb.ClientId;this.hDa=Mb.IsCollapsible;this.parentId=Mb.ClientParentId;
this.qtg=Mb.PivotCacheIndex;this.type=Mb.TypeTag;this.ueg=Mb.UserRank;this.x6h=gc;this.sEe=Qc;this.P$g=Sc;this.fieldListSelector.LCg(this.clientId,this);this.children=[];Mb.Children.forEach(ud=>{this.children.push(new W(Fa,ud,gc,Qc,Sc))})}get caption(){return this.HEc}get element(){return this._element||(this._element=this.fieldListSelector.getElementById(W.B$a+this.clientId))}get j4h(){return-1!==this.parentId}get isCollapsed(){return this.cJ}get isCollapsible(){return this.hDa}get isVisible(){return this.visible}get cGf(){return this.qtg}dispose(){this.children&&
(f.a.qc(this.children),this.children=null);this._element=null}Yye(){for(const Fa of this.children)Fa.visible=!1,Fa.hDa&&(Fa.cJ=!0,Fa.N_f(),0<Fa.children.length&&Fa.Yye())}vpe(Fa,Mb){this.visible=!Fa;var gc=11*Fa;let Qc=`aria-labelledby="${this.Gua(W.nHf)}" aria-selected="false" aria-level="${Fa+1}"`;this.hDa&&(Qc+=`aria-expanded="false" aria-owns="${this.Gua(W.mHf)}"`);this.hDa?(this.cJ=!0,gc=String.format(V,this.Gua(W.lHf),this.RYe(gc+4),this.Gua(W.mDd),this.sEe,B.a.Ns,T.a.hf(9))):gc=String.format('<div style="{0}"></div>',
this.RYe(gc+23));const Sc=String.format('<span id="{0}">{1}</span>',this.Gua(W.nHf),A.a.Eg(this.HEc));Mb+=String.format('<div id="{0}" class="{1}" tabIndex="-1" title="{2}" role="treeitem" {3}><table cellspacing="0" cellPadding="0" role="presentation"><tr><td style="width: 8px">{4}</td><td>{5}</td></tr></table></div>',this.Gua(W.B$a),K,A.a.$Y(this.HEc),Qc,gc,Sc);this.hDa&&(++Fa,Mb+=String.format('<div id="{0}" role="group" style="display:none;">',this.Gua(W.mHf)),this.children.forEach(ud=>{Mb=ud.vpe(Fa,
Mb)}),Mb+="</div>");return Mb}Q4b(){this.element.blur();this.element.tabIndex=-1}Hwh(){this.children.forEach(Fa=>{Fa.visible=!0})}gXe(Fa,Mb){const gc=this.children;for(const Qc of gc)if(!Qc.hDa&&5===Qc.type&&Qc.ueg>Mb&&(Fa=Qc,Mb=Qc.ueg,3===Mb))return{returnValue:Fa,evd:Mb};for(const Qc of gc)if(Qc.hDa&&({evd:Mb,returnValue:Fa}=Qc.gXe(Fa,Mb),3===Mb))break;return{returnValue:Fa,evd:Mb}}pVh(){let Fa=this;for(;-1!==Fa.parentId;)Fa=this.fieldListSelector.Ndd(Fa.parentId);return Fa}Mec(Fa){let Mb=this;
for(;-1!==Mb.parentId;){if(Fa.clientId===Mb.parentId)return!0;Mb=this.fieldListSelector.Ndd(Mb.parentId)}return!1}setFocus(){this.element.tabIndex=0;F.DOMElementExtensions.setFocus(this.element)}N_f(){const Fa=F.DOMElementExtensions.getElementById(this.element,this.Gua(W.mDd));if(Fa){var Mb=this.element.nextSibling;F.DOMElementExtensions.Mna(Fa,this.cJ,this.sEe,this.P$g);this.element.setAttribute(B.a.LX,this.cJ?B.a.fr:B.a.lk);F.DOMElementExtensions.setVisible(Mb,!this.cJ)}}ktj(){const Fa=this.fieldListSelector.domElement.querySelectorAll(`.${L}`);
for(let Mb=0;Mb<Fa.length;Mb++){const gc=Fa[Mb];gc.classList.remove(L);gc.setAttribute(B.a.wga,"false")}this.element.classList.add(L);this._element.setAttribute(B.a.wga,"true")}QMb(){(this.cJ=!this.cJ)?this.Yye():this.Hwh();this.N_f()}Gua(Fa){return Fa+this.clientId}RYe(Fa){return String.format(this.x6h,Fa.toString())}}W.lHf="bixflec_";W.mDd="bixfleci_";W.B$a="bixfli_";W.nHf="bixflil_";W.mHf="bixflg_";Object(b.a)(W,"BixFieldListItem",null,[2]);class da extends Sys.EventArgs{constructor(Fa,Mb){super();
this.M5h=Fa;this.caption=Mb}}Object(b.a)(da,"BixHierarchySelectionChangedEventArgs",Sys.EventArgs,[]);var qa=a(11);class O extends I.a{constructor(Fa,Mb,gc,Qc,Sc){super(Mb);this.c0c=0;this.xxa=new M.a(!1);this.Xtc=-1;this.JI=this.BM=this.xWf=null;this.ed=Zd=>{Zd.Cb&&this.Bpc(Zd.Cb);return!0};this.vN=Zd=>{Zd.button===Sys.UI.MouseButton.leftButton&&Zd.target&&(this.Bpc(Zd.target),U.g(Zd))};this.onDoubleClick=Zd=>{if(Zd.button===Sys.UI.MouseButton.leftButton&&Zd.target){var ne;0!==({TWb:ne}=this.aSe(Zd.target)).returnValue&&
(U.g(Zd),(Zd=this.aZe(ne))&&Zd.isCollapsible&&this.QMb(Zd))}};(this.touchMode=Sc)?D.a.instance.ra(w.a.click,this.domElement,this.ed):(this.Gc.ka("mousedown",this.vN),this.Gc.ka("dblclick",this.onDoubleClick));this.d4f=!J.a.fli&&!Sc;let ud;Fa.isChromeRtl?(ud="padding-right:{0}px;",this.c0c=39):(ud="padding-left:{0}px;",this.c0c=37);Sc=new G.a(Qc.ExcludeHierarchies);Sc.s9.sort((Zd,ne)=>Zd-ne);Fa=-1;Mb=null;if(gc=({MAb:Fa,ee:Mb}=this.p9e(gc.FieldListItems,Sc,Fa,Mb,Qc.Context)).returnValue)1===gc.length&&
(gc=[...gc[0].Children],gc.forEach(Zd=>{Zd.ClientParentId=-1})),gc.length&&(this.fieldListItems=[],gc.forEach(Zd=>{this.fieldListItems.push(new W(this,Zd,ud,x.a.Xrh,x.a.Yrh))}),Mb||(Mb=O.Dzh(gc,Qc.Context.DimensionCaption)||gc[0]),this.ee=this.Ndd(Mb.ClientId),this.$G())}KFg(Fa){this.get_events().addHandler("SelectionChanged",Fa)}Abj(Fa){this.get_events().removeHandler("SelectionChanged",Fa)}get tli(){return!!this.fieldListItems}dispose(){this.touchMode&&(D.a.instance.Ba(w.a.click,this.domElement,
this.ed),this.touchMode=!1);this.JI=null;this.fieldListItems&&(f.a.qc(this.fieldListItems),this.fieldListItems=null);this.xxa=null;super.dispose()}focus(){this.setFocus(!0)}LCg(Fa,Mb){this.xxa.add(Fa.toString(),Mb)}Ndd(Fa){Fa=Fa.toString();return this.xxa.mb(Fa)?this.xxa.getItem(Fa):null}hasFocus(){var Fa=F.DOMElementExtensions.Qp(this.JI);return Fa?(Fa=Fa.id)&&Fa.startsWith(W.B$a)&&this.BM?!0:!1:!1}onKeyDown(Fa){Fa=Fa.keyCode;if(this.hasFocus()){var Mb=!1;38===Fa||40===Fa?(this.SZ(40===Fa),Mb=!0):
37===Fa||39===Fa?(Fa=Fa===this.c0c,Mb=this.BM,Mb.isCollapsible&&Mb.isCollapsed!==Fa?this.QMb(Mb):Fa&&Mb.j4h&&this.SZ(!1),Mb=!0):13===Fa||32===Fa?((Fa=this.BM)&&this.select(Fa),Mb=!0):9===Fa&&this.PFe(!0);return Mb}return 9===Fa?this.BM?this.nKb(this.BM):this.setInitialFocus(!0):!1}$nj(){this.JI.setAttribute(B.a.Mqe,"bix-drilldetails")}setFocus(Fa){return this.JI.firstChild?this.hasFocus()?this.SZ(Fa):this.BM?this.nKb(this.BM):this.setInitialFocus(Fa):!1}start(){this.ee&&(this.select(this.ee.pVh()),
this.BM&&this.scroll(this.BM,!0))}$G(){let Fa="";this.fieldListItems.forEach(Mb=>{Fa=Mb.vpe(0,Fa)});this.JI=this.domElement;F.DOMElementExtensions.wv(this.JI,Fa.toString());F.DOMElementExtensions.nu(this.JI,B.a.LZb,null,null,null);this.JI.setAttribute(B.a.Mt,X.a.instance.ga(1196));this.JI.classList.add(x.a.Zo);this.JI.style.position="relative"}IPh(Fa){for(;Fa&&Fa!==this.JI;){const Mb=Fa.id;if(Mb&&Mb.startsWith(W.B$a))return Fa;Fa=Fa.parentNode}return null}p9e(Fa,Mb,gc,Qc,Sc){const ud=gc;if(!Fa||!Fa.length)return{returnValue:null,
MAb:gc,ee:Qc};let Zd=0;for(let ne=0,Rd=Fa.length;ne<Rd;ne++){const ie=Fa[ne];if(O.Yhi(Mb,ie))Fa[ne]=null,++Zd;else{ie.ClientParentId=ud;ie.ClientId=++gc;if(ie.IsCollapsible&&(ie.Children=({MAb:gc,ee:Qc}=this.p9e(ie.Children,Mb,gc,Qc,Sc)).returnValue,!ie.Children)){Fa[ne]=null;++Zd;continue}5!==ie.TypeTag&&3!==ie.TypeTag||ie.PivotCacheIndex!==Sc.HierarchyId||(ie.UserRank=3,Qc=ie)}}return Zd?Zd===Fa.length?{returnValue:null,MAb:gc,ee:Qc}:{returnValue:O.d$i(Fa),MAb:gc,ee:Qc}:{returnValue:Fa,MAb:gc,ee:Qc}}PFe(Fa){const Mb=
this.BM;Mb&&(Mb.Q4b(),this.JI.setAttribute(B.a.T1,""));this.Q4b();Fa||(this.BM=null)}Q4b(){this.d4f&&this.JI.classList.add(y.wLe)}SZ(Fa){let Mb=this.BM;if(!Mb)return this.setInitialFocus(Fa);const gc=this.xxa.values,Qc=gc.length;let Sc=Array.indexOf(gc,Mb);for(Sc=Fa?++Sc:--Sc;0<=Sc&&Sc<Qc;){Mb=gc[Sc];if(Mb.isVisible)return this.nKb(Mb),this.scroll(Mb,Fa),!0;Sc=Fa?++Sc:--Sc}return!1}scroll(Fa,Mb){var gc=Fa.element;Fa=gc.offsetHeight;gc=gc.offsetTop;const Qc=this.JI,Sc=Qc.scrollTop,ud=(Math.floor(Qc.clientHeight/
Fa)-3)*Fa;let Zd=Qc.scrollTop;Mb?gc>Sc+Fa+ud&&(Zd=gc-(Fa+ud)):gc<Sc+Fa&&(Zd=gc-Fa);Qc.scrollTop=Zd}setInitialFocus(Fa){const Mb=this.xxa.count;let gc=Fa?0:Mb-1;for(;0<=gc&&gc<Mb;){const Qc=this.xxa.dg(gc);if(Qc.isVisible)return this.nKb(Qc),this.scroll(Qc,!0),!0;gc=Fa?++gc:--gc}return!1}nKb(Fa){this.BM&&Fa!==this.BM&&this.PFe(!1);if(!Fa)return!1;this.JI.setAttribute(B.a.T1,Fa.element.id);this.BM=Fa;-1!==this.Xtc&&(Fa.setFocus(),this.d4f&&this.JI.classList.remove(y.wLe));return!0}aSe(Fa){for(;Fa&&
Fa!==this.JI;){const Mb=Fa.id;if(Mb.startsWith(W.B$a))return{returnValue:1,TWb:Fa};if(Mb.startsWith(W.lHf)||Mb.startsWith(W.mDd))return{returnValue:2,TWb:Fa};Fa=Fa.parentNode}return{returnValue:0,TWb:null}}aZe(Fa){if(!Fa.id||!Fa.id.startsWith(W.B$a)&&(Fa=this.IPh(Fa),!Fa))return null;Fa=Fa.id.split("_")[1];return M.a.Dc(this.xxa.gu,Fa)}Bpc(Fa){var Mb;Fa=({TWb:Mb}=this.aSe(Fa)).returnValue;if(0!==Fa&&(Mb=this.aZe(Mb)))switch(Fa){case 2:this.QMb(Mb);break;case 1:this.select(Mb)}}select(Fa){if(Fa){Fa.ktj();
this.nKb(Fa);if(Fa.isCollapsible){let Mb=-1;({evd:Mb,returnValue:Fa}=Fa.gXe(null,Mb));if(!Fa)return}this.ee=Fa;this.Xtc!==Fa.cGf&&(this.Xtc=Fa.cGf,this.xWf=Fa.caption,this.raiseEvent("SelectionChanged",new da(this.Xtc,this.xWf)),this.hasFocus()||this.Q4b())}}QMb(Fa){Fa.QMb();Fa.isCollapsed&&this.ee&&this.ee.Mec(Fa)&&this.select(Fa);this.scroll(Fa,!Fa.isCollapsed)}static Dzh(Fa,Mb){for(const gc of Fa)if(11===gc.TypeTag&&gc.Name===Mb)return gc;return null}static Yhi(Fa,Mb){switch(Mb.TypeTag){case 5:case 3:break;
default:return!1}return 0<=qa.HelperMethods.mx(Fa,0,Fa.$ia(),Mb.PivotCacheIndex,(gc,Qc)=>gc-Qc)}static d$i(Fa){let Mb=null;for(let gc=0;gc<Fa.length;gc++)Fa[gc]&&(Mb||(Mb=[]),Mb.push(Fa[gc]));return Mb}}Object(b.a)(O,"BixFieldListSelector",I.a,[851]);var ea=a(50),R=a(37),oa=a(210),pa=a(47),Pa=a(45),Z=a(281),Ra=a(280),Ga=a(64);class Ba extends r.a{constructor(Fa,Mb,gc,Qc){super(Fa,X.a.instance.ga(1190),!0,4);this.fieldListSelector=this.kT=this.aNa=this.pC=this.sFc=this.x$=null;this.I7d=!1;this.nKi=
(Sc,ud)=>{if(this.domElement&&(this.aNa.nSa(),!Z.a(Sc))){const Zd=Sc.Result;Zd&&this.AEj(Zd,ud);super.dy(Sc,null,"")}};this.fAj=()=>{F.DOMElementExtensions.wv(this.t_b,X.a.instance.ga(1192));const Sc=this.Nda.querySelector("."+y.vLe);Sc.tabIndex=-1;F.DOMElementExtensions.setFocus(Sc)};this.X8a=()=>{this.close(1);return!0};this.domElement.id=Fa.domElement.id+"_BIExploreCallout";this.uy=Mb;this.targetElement=gc;this.XSf=!1;this.domElement.classList.remove(this.rtl?u.a.a8c:u.a.$7c);this.domElement.classList.remove(x.a.Np);
this.domElement.classList.add(this.rtl?y.imh:y.hmh);(this.touchMode=Qc)||this.domElement.classList.add(y.gmh);this.Nda.className=y.lmh;this.Nda.style.backgroundImage="";this.Jna.className=y.kmh;this.Uy.parentNode.className=y.vLe;Fa=this.Lb;Fa.className="";Mb=String.format('<div id="{0}"class="{1}">{2}</div><div class="{3}"><div id="{4}" class="{5}"></div><div id="{6}" class="{7}"></div></div>',"bix-subtitle",y.jmh,this.uy.w6h,y.amh,"bix-fieldlistselector",y.mmh,"bix-drilldetails",y.fmh);F.DOMElementExtensions.wv(Fa,
Mb);this.t_b=Fa.lastChild;this.tcc()}get oc(){return"BIExploreCallout"}get Wdi(){return this.I7d}get LGa(){return 6}get Rw(){return 561}Kii(Fa){Fa=document.getElementById(Fa);return F.DOMElementExtensions.isVisible(Fa)?(this.x$.setFocus(!0),!0):!1}d_g(Fa){this.sFc=Fa;S.g(this.$).Go(!0);this.I7d=!0;this.close(2)}dispose(){f.a.qc([this.pC,this.aNa,this.x$,this.fieldListSelector]);this.uy=this.x$=this.fieldListSelector=this.aNa=this.pC=null;this.Sqc();this.sFc=this.targetElement=this.t_b=null;super.dispose()}takeFocus(){this.setFocus()}close(Fa){this.Sqc();
super.close(Fa)}Ff(Fa=!1){R.TaskExtensions.Aa(ea.GetServiceTaskFactory.Ra(this.$.da,12,477,0),Mb=>{this.XSf||(this.aNa=Mb.result.Rqb(this.Lb,500,null,null,741),this.aNa.hSa())},this.$.la);return R.TaskExtensions.ts(R.TaskExtensions.Aa(ea.GetServiceTaskFactory.create(this.$.da,84,this.la,0),Mb=>{this.pC=Mb.result;this.pC.init(this.domElement,this.targetElement,document.body,this.$.pa.displayRtl);this.pC.f1c=8;this.pC.bVc=!0;this.pC.y$a=Ba.u_h();this.USc();this.pC.Fo()},this.la,3),()=>oa.a.prototype.Ff.call(this,
Fa),this.la,3,Ga.a.current)}KA(){return this.sFc}Kga(){return(Fa,Mb,gc)=>{var Qc=this.$.oa.va;Fa=this.Pia(Fa);Mb=this.baa(Mb);const Sc=z.L(Qc,this.uy.Jw,this.uy.externalSourceIndex,this.uy.gR);return z.g(Qc,"GetBixAnalysis",Sc,Fa,Mb,gc,null,4)}}onShow(){this.pC.tLd();super.onShow()}dy(Fa){const Mb=Fa.Result;if(Fa.Errors&&!Fa.Errors.length&&Mb&&-1===Mb.Context.HierarchyId)this.XSf=!0,this.aNa&&this.aNa.nSa(),pa.a.instance.create(this.fAj,1,Pa.a.BNg,!0,!0),super.dy(Fa,null,"");else{var gc=Qc=>{Qc.Tz=
0;this.hLa(169,(Sc,ud,Zd)=>{var ne=this.$.oa.va,Rd=Qc.iH,ie=Qc.iHb,Ae=Qc.Tz;Sc=Ra.b(Sc,this.nKi);const Se=z.L(ne,Qc.Jw,Qc.externalSourceIndex,Qc.G7g());Se.type=4;Se.version=Rd;Se.relatedGroup=ie;Se.selectedTab=Ae;return z.g(ne,"GetPivotFieldListData",Se,Sc,ud,Zd,Mb,4)},16)};R.TaskExtensions.Aa(ea.GetServiceTaskFactory.create(this.$.da,110,this.la,0),Qc=>{gc(Qc.result)},this.la,3)}}onKeyDown(Fa){let Mb=this.vVe();if(Fa.altKey&&85===Fa.keyCode)this.close(1),U.g(Fa);else if(117===Fa.keyCode&&Fa.ctrlKey)this.close(1),
U.g(Fa);else if(0===Mb)if(13===Fa.keyCode)this.close(1);else super.onKeyDown(Fa);else{let gc=!1;for(let Qc=0;3>Qc&&!gc;Qc++)2===Mb?(gc=this.fieldListSelector.onKeyDown(Fa))||(Mb=1):1===Mb&&((gc=this.x$.onKeyDown(Fa))||(Mb=2));if(gc)U.g(Fa);else super.onKeyDown(Fa)}}setFocus(){(this.x$||this.fieldListSelector)&&this.jLg(this.vVe())}jLg(Fa){let Mb=!1;for(let gc=0;2>gc&&!Mb;gc++)1===Fa&&this.x$?(Mb=this.x$.setFocus(!0))||(Fa=2):2===Fa&&this.fieldListSelector&&((Mb=this.fieldListSelector.setFocus(!0))||
(Fa=1))}vVe(){if(!this.fieldListSelector||!this.x$)return 0;const Fa=this.fieldListSelector.hasFocus(),Mb=this.x$.hasFocus();return!Fa&&!Mb||Mb?1:2}AEj(Fa,Mb){let gc=this.getElementById("bix-fieldlistselector");this.fieldListSelector=new O(this.$,gc,Fa,Mb,this.touchMode);this.fieldListSelector.tli?(this.t_b.setAttribute(B.a.EZb,"true"),gc=this.getElementById("bix-drilldetails"),this.x$=new H(this.$,gc,this.uy,Mb,this.fieldListSelector,this),this.fieldListSelector.$nj(),this.fieldListSelector.start(),
this.setFocus(),this.t_b.setAttribute(B.a.EZb,"false")):(this.fieldListSelector.dispose(),this.fieldListSelector=null,F.DOMElementExtensions.wv(this.Lb,X.a.instance.ga(1192)))}USc(){const Fa=this.kT=document.createElement("div");Fa.classList.add(y.bmh);n.a.instance.ra(w.a.pointerDown,Fa,this.X8a);this.domElement.ownerDocument.body.appendChild(Fa)}Sqc(){this.kT&&(n.a.instance.Ba(w.a.pointerDown,this.kT,this.X8a),F.DOMElementExtensions.pf(this.kT),this.kT=null)}static u_h(){return Ba.y$a||(Ba.y$a=[0,
1,4,5])}}Ba.y$a=null;Object(b.a)(Ba,"BIExploreCallout",r.a,[836,231]);class fa extends l.a{constructor(Fa,Mb,gc){super();this.$=Fa;this.Ega=gc.u3b(Fa,null,Mb,x.a.j7b,T.a.hf(9),X.a.instance.ga(1191),"BIXPointerDown")}get jz(){return this.Ega.jz}get T0b(){return this.Ega.T0b}dispose(){this.Ega.dispose();this.$=null;super.dispose()}getButton(Fa){return this.Ega.getButton(Fa)}iAj(Fa,Mb,gc,Qc){this.Ega.Bp(Fa+this.T0b,Mb+this.T0b,gc,Qc)}jAj(){var Fa=S.g(this.$).ha.sa.activeCell;const Mb=S.g(this.$).ib.Vi(Fa);
(Fa=S.g(this.$).mg(Fa,Mb))&&0<=Fa.x&&0<=Fa.y?this.Bp(Fa.bottomRight.x+this.jz,Fa.bottomRight.y+this.jz,S.g(this.$).rtl,Mb):this.hide()}Bp(Fa,Mb,gc,Qc){this.Ega.Bp(Fa,Mb,gc,Qc)}hide(){this.Ega.hide()}domElement(Fa){return this.Ega.domElement(Fa)}C1a(Fa){this.Ega.C1a(Fa)}}Object(b.a)(fa,"BIExploreLaunchButton",l.a,[]);var Y=a(43);class ja{constructor(Fa){this.Bgb=!1;this.NCa=0;this.Hqa=this.zNc=this.yNc=this.gib=null;this.$=Fa;this.reset()}get confirmationRequiredForDataOps(){return this.Bgb}get externalSourceIndex(){return this.NCa}get w6h(){return this.gib}get lZ(){return!!this.gR}get Hbf(){return!!this.Jw}get gR(){return this.yNc}get pivotTableName(){return this.zNc}get Jw(){return this.Hqa}reset(){this.gib=
"";this.Hqa=this.zNc=this.yNc=null}vrj(Fa,Mb){this.reset();this.Bgb=Mb.confirmationRequiredForDataOps;this.NCa=Mb.externalSourceIndex;this.zNc=Mb.pivotTableName;this.Hqa=Y.o(Fa,this.$);Fa.Dd(Mb.ZK)||Fa.Dd(Mb.AE)?(Mb=S.g(this.$).Vb(Fa),this.gib=A.a.Eg(Mb.text)):(Fa=Fa.top-Mb.top,Mb.hLd&&Mb.hLd.length>Fa&&(this.gib=Mb.hLd[Fa]))}voj(Fa,Mb,gc){this.reset();this.NCa=Mb.ExternalSourceIndex;this.Bgb=!!(Mb.Attributes&64);this.gib=A.a.Eg(gc.ValueString);this.yNc={};this.gR.ChartId=Fa;this.gR.AnchorValue2=
-1;switch(gc.Type){case 1:case 2:0<=gc.CategoryIndex?(this.gR.AnchorType=2,this.gR.AnchorValue1=gc.CategoryIndex):(this.gR.AnchorType=1,this.gR.AnchorValue1=gc.SeriesIndex);break;default:0>gc.CategoryIndex&&0<=gc.SeriesIndex?(this.gR.AnchorType=1,this.gR.AnchorValue1=gc.SeriesIndex):(this.gR.AnchorType=3,this.gR.AnchorValue1=gc.SeriesIndex,this.gR.AnchorValue2=gc.CategoryIndex)}this.Hqa={};this.$.Xj(this.Jw);this.Jw.FirstRow=-1;this.Jw.FirstColumn=-1}}Object(b.a)(ja,"BixSelectionContext",null,[]);
var ca=a(783),aa=a(223),ta=a(65),xa=a(312),ia=a(245),ya=a(704),ib=a(453),wa=a(3),sa=a(97),Ya=a(514),bb=a(55);class mb extends l.a{constructor(Fa,Mb){super();this.callout=this.gridView=null;this.MHi=gc=>{if(gc.isLoaded){this.state=1;gc=this.$;const Qc=S.g(gc);this.ZLg(Qc);gc.kk(this.Ec);gc.EA(this.Yi);Qc.Ku(this.ZQ);Ya.a(gc).Ku(this.xDb);gc.userOperationManager.Hr(this.yDf);xa.a.O8(1529658657,wa.a.Uv,0,1);gc.Ka.P8(this)}else this.dispose()};this.jya=(gc,Qc)=>{this.allow&&0===Qc.S3&&(gc=this.gridView.ha.Je,
1===gc?(this.L_c(),this.mW()):2!==gc||this.uy.lZ||(this.uy.reset(),this.Tx()))};this.nh=()=>{this.Tx()};this.Ec=()=>{this.Tx()};this.ed=(gc,Qc)=>{this.callout||this.showCallout(3===gc.tb,Qc)};this.xyd=()=>{this.callout.lza(this.xyd);this.callout=null;this.Eh.hide()};this.Yi=()=>{this.callout?this.Tx():this.h6a()&&this.Eh.hide()};this.xDb=()=>{3===this.state&&(this.state=1)};this.ZQ=()=>{3===this.state&&this.HJe()};this.yDf=(gc,Qc)=>{(gc=Qc.xf?Qc.xf.operation:null)&&gc.flags&4&&(this.allow&&0===Qc.Lq?
(this.state=3,this.Tx()):3===this.state&&1===Qc.Lq&&(Qc=gc.dd?gc.dd.Errors:null)&&0<Qc.length&&this.HJe())};this.HJe=()=>{this.state=1;this.mW()};this.$=Fa;this.state=2;this.uy=new ja(Fa);this.Eh=new fa(Fa,this.ed,Mb);v.a(this.$).Xh(this);c.a.Cjd(Fa.domElement.ownerDocument,T.a.current.Rn(96),this.MHi)}get mc(){return this.callout?this.callout.domElement:null}get kf(){return!!this.callout}get $d(){return ia.a.TWc}get nZe(){d.ULS.shipAssertTag(537170304,8,!S.g(this.$).ib.mj,"GetLaunchMonocleButton is not supported in freeze pane");
return Object(e.a)(Sys.UI.Control,this.Eh.getButton(1))}get JZe(){return this.callout}get allow(){return this.$.me.get(6)&&1===this.state&&this.$.jc.R1(135200)}aye(){this.showCallout(!1)}dispose(){this.gridView&&(this.gridView.lb.SHb(this.jya),this.gridView.Xb&&this.gridView.Xb.tk(this.nh));if(this.$){const Fa=this.$;Fa.userOperationManager.Co(this.yDf);Fa.zl(this.Ec);Fa.zD(this.Yi);S.g(Fa).py(this.ZQ);Ya.a(Fa).py(this.xDb)}f.a.Ia(this.Eh);this.uy=this.$=this.gridView=this.callout=this.Eh=null;super.dispose()}Nc(Fa,
Mb){if(1529658657===Mb&&(8===Fa||!this.uy.Hbf))return!0;1247109494!==Mb&&-498523270!==Mb||this.Tx();return!1}executeCommand(Fa,Mb){this.callout?this.Tx():(this.scrollIntoView(),this.showCallout(3===Mb.method));return bb.Task.Ta(!0)}Cc(Fa,Mb){return 1529658657===Mb.command}Rc(){return!1}Tx(){this.L_c();this.Eh.hide()}hg(Fa,Mb){this.callout&&!Mb&&this.callout.takeFocus();return!Mb}kh(Fa){return F.DOMElementExtensions.vf(this.mc,Fa)}lj(){}Nj(){}JIf(Fa,Mb,gc,Qc,Sc){this.uy.reset();if(this.allow&&!ta.e(this.$.pa))if(gc&&
gc.Attributes&512&&Qc&&Mb){const ud=this.$.mJ;this.L_c();this.uy.voj(Mb,gc,Qc);this.h6a()?(Mb=Ya.a(this.$).domElement,gc=F.DOMElementExtensions.getLocation(Mb),Qc=Math.abs(Mb.scrollLeft),this.$.isChromeRtl&&(Sys.Browser.agent===Sys.Browser.Safari&&(Qc=Mb.scrollWidth-Mb.offsetWidth-Qc),Qc*=-1),Fa=new m.a(Fa.x-gc.x+Qc,Fa.y-gc.y+Mb.scrollTop),ud&&(Fa.x=Mb.offsetWidth-Fa.x)):(Mb=this.gridView.Lf(Sc).view.Ph,Fa=ya.a.xs(Mb,this.gridView.Lf(Sc).domElement,new Sys.UI.Point(Math.round(Fa.x),Math.round(Fa.y)),
ud));this.Eh.iAj(Fa.x,Fa.y,ud,Sc)}else this.Tx()}ZLg(Fa){Fa&&(this.gridView=Fa,this.gridView.lb.Lmb(this.jya),this.gridView.Xb.Nk(this.nh))}mW(){this.lxj()?this.Eh.jAj():this.Eh.hide()}lxj(){this.uy.reset();if(!this.allow||this.gridView.ha.Pa.$b)return!1;const Fa=ib.a(this.$).SJa();if(Object(k.a)(aa.PivotTableRange,Fa)&&Fa.supportsBIExplore){const Qc=this.gridView.ha.sa.activeCell,Sc=this.gridView.Vb(Qc);if(Qc&&Sc&&this.gridView.ha.sa.C4){var Mb=Qc.left-Fa.left,gc=Qc.top-Fa.top;if(!(Fa.uZg&1<<Mb||
Fa.$hj&1<<gc||Fa.oZg&1<<Mb||Fa.Vhj&1<<gc||Sc.hasAutoFilter)&&(Mb=Qc.Dd(Fa.ZK)||Qc.Dd(Fa.AE),gc=!1,Fa.ZK&&Fa.AE?gc=Qc.top<Fa.ZK.top&&Qc.left<Fa.AE.left||Qc.top<Fa.AE.top:Fa.AE&&(gc=Qc.top<Fa.AE.top),!Mb&&!gc&&0<Sc.text.length||Mb&&(0<Sc.text.length||Sc.ywa||Sc.r6a)))return this.uy.vrj(Qc,Fa),!0}}return!1}showCallout(Fa,Mb=1){ib.a(this.$).wx(this.uy.confirmationRequiredForDataOps,gc=>{gc&&this.uy.Hbf&&(this.callout=new Ba(this.$,this.uy,this.Eh.domElement(Mb),Fa),this.callout.initialize(),this.Eh.C1a(Mb),
this.callout.cP(this.xyd),this.callout.Ff());this.Eh.getButton(1).obb()})}L_c(){this.Eh.getButton(1).obb();this.callout&&!this.callout.Wdi&&(this.callout.lza(this.xyd),this.callout.Pu(),this.callout=null)}scrollIntoView(){var Fa=this.gridView.ha;if(1===Fa.Je){Fa=Fa.sa.activeCell;const Mb=this.gridView.view.visibleArea,gc=this.gridView.mg(Fa);Mb&&gc&&!Mb.contains(gc)&&this.gridView.dt(Fa,3,sa.a.CNg)}}h6a(){return this.$.ea.isNamedObjectViewMode&&ta.f(this.$.pa)}static ka(Fa,Mb){ca.a(Fa)||Fa.da.Ga(2,
new mb(Fa,Mb))}}Object(b.a)(mb,"BIExploreManager",l.a,[195,806,102,2,807]);var Ca=a(10),$a=a(691),Kb=a(102),rb=a(466),cc=a(145),nc=a(28),Wb=a(182);class Ea{constructor(Fa,Mb,gc){Mb||d.ULS.sendTraceTag(537162718,0,15,"FieldManagerPane is null on FieldListCommandHandler creation");this.$=Fa;this.fieldManagerPane=Mb;this.ezg=gc}Nc(Fa,Mb){return(2140436015===Mb||-1006032470===Mb)&&!(new cc.a(this.ezg)).Ud(8192)}executeCommand(Fa,Mb,gc,Qc){Fa=Mb.command;Qc=Qc.ija();switch(Fa){case 2140436015:case -1006032470:this.fieldManagerPane&&
(this.fieldManagerPane.Ewc(!Kb.f(this.$.pg),Mb,!1),d.ULS.sendTraceTag(537162717,0,50,`${2140436015===Fa?"Show":"Hide"} Field List`));break;case 589118293:case -1687560254:return this.K5b(!0,!1,Qc);case 1176256599:return this.K5b(!1,!1,Qc);case -1751201991:return this.K5b(!0,!0,Qc);case -232434744:return this.K5b(!1,!0,Qc);default:return Wb.a(Fa)}return bb.Task.Ta(!0)}Cc(Fa,Mb){Fa=!1;switch(Mb.command){case 2140436015:case -1006032470:Fa=!0;break;case 589118293:case -1687560254:case 1176256599:case -1751201991:case -232434744:Fa=
!0}return Fa}Rc(){return!1}K5b(Fa,Mb,gc){const Qc=nc.a.Wa.Nb,Sc=S.g(this.$).ha.sa.activeCell;return R.TaskExtensions.Aa(ea.GetServiceTaskFactory.Ra(this.$.da,12,477,gc),()=>{ib.a(this.$).wx(!1,ud=>{if(ud){S.g(this.$).Go(!0);const Zd=Y.o(Sc,this.$);this.$.Ub(-867563466,(ne,Rd,ie)=>z.J(this.$.oa.va,Zd,0,!1,!1,!1,Fa,Mb,ne,Rd,ie,null,null),Qc,0,6,161,()=>new rb.a(Zd,Mb))}})},this.$.la,3)}static j0a(Fa,Mb,gc){const Qc={};Fa.Xj(Qc);Qc.FirstRow=Mb;Qc.FirstColumn=gc;return Qc}}Object(b.a)(Ea,"FieldListCommandHandler",
null,[195]);class ua extends $a.a{constructor(Fa){super(Fa)}yd(){R.TaskExtensions.Aa(ea.GetServiceTaskFactory.Ra(this.$.da,16,74,this.hb),Fa=>{this.gd([new Ea(this.$,Fa.result,this.$.xa)])},this.la,3)}static ka(Fa){$a.a.Nd(75,new ua(Fa))}}Object(b.a)(ua,"FieldListCommandHandlerFactory",$a.a,[]);var ma=a(221);class fb{constructor(Fa,Mb){this.ika=this.sod=this.hka=this.igc=!1;this.anchorType=-1;this.confirmationRequiredForDataOps=!1;this.chartId=this.pivotTableName=null;this.Bde=-1;this.Xee=1;this.NCa=
this.j5d=this.i5d=-1;this.Hqa=null;if(Fa&&(this.Tz=Mb,this.hka=this.igc=!1,Fa.pa)){var gc=S.g(Fa),Qc=Mb=null;if(ta.f(Fa.pa)){var Sc=Ya.a(Fa);Sc.Tc&&Sc.Tc.Attributes&4&&(this.chartId=Sc.chartId,Mb=Sc.Tc)}else ta.i(Fa.pa)&&((Sc=gc.ha.Pa.$b)?(gc=Sc.floatingObject)&&0===gc.type&&gc.Tc&&gc.Tc.Attributes&4&&(this.chartId=Sc.floatingObject.id,Mb=gc.Tc):gc.ha.sa.activeCell&&(Sc=ib.a(Fa).SJa(),Object(k.a)(aa.PivotTableRange,Sc)&&(Qc=Sc)));Mb?(this.hka=!0,this.sod=!!(Mb.Attributes&256),this.anchorType=7,this.ika=
!!(Mb.Attributes&128),this.confirmationRequiredForDataOps=!!(Mb.Attributes&64),this.NCa=Mb.ExternalSourceIndex,this.iH=Mb.FieldListVersion,this.xM=Mb.FieldWellVersion,Mb=this.Hqa={},Fa.Xj(Mb),Mb.FirstColumn=Mb.FirstRow=-1):Qc&&(this.igc=!0,this.sod=Qc.isActionable,this.anchorType=0,this.ika=Qc.isOlap,this.confirmationRequiredForDataOps=Qc.confirmationRequiredForDataOps,this.NCa=Qc.externalSourceIndex,this.iH=Qc.Yxh,this.xM=Qc.gyh,this.pivotTableName=Qc.pivotTableName,this.Hqa=Y.o(Qc,Fa))}}get iHb(){return this.Bde}set iHb(Fa){this.Bde=
Fa}get Tz(){return this.Xee}set Tz(Fa){this.Xee=Fa}get iH(){return this.i5d}set iH(Fa){this.i5d=Fa}get xM(){return this.j5d}set xM(Fa){this.j5d=Fa}get ULa(){return this.hka||this.igc}get Gji(){return this.ULa&&!this.sod}get externalSourceIndex(){return this.NCa}get Jw(){return this.Hqa}get sheetName(){return this.Jw?this.Jw.SheetName:null}get orb(){return this.chartId+"_"+this.pivotTableName+"_"+this.iH+"_"+this.xM}G7g(){const Fa={};Fa.AnchorType=this.anchorType;7===this.anchorType&&(Fa.ChartId=this.chartId);
Fa.AnchorValue1=Fa.AnchorValue2=-1;return Fa}static h3b(){return new fb(null,-1)}static create(Fa,Mb){return new fb(Fa,Mb)}static Egf(Fa,Mb){return Fa.ULa!==Mb.ULa||Fa.anchorType!==Mb.anchorType||Fa.chartId!==Mb.chartId||Fa.pivotTableName!==Mb.pivotTableName||!!Fa.Jw&&!!Mb.Jw&&Fa.Jw.SheetName!==Mb.Jw.SheetName}static gni(Fa,Mb){return fb.Egf(Fa,Mb)||Fa.iHb!==Mb.iHb||Fa.Tz!==Mb.Tz}}Object(b.a)(fb,"FieldListRequestState",null,[824]);class sb extends ma.a{constructor(Fa){super();this.$=Fa;this.Fb()}create(){const Fa=
fb.create(this.$,-1);this.qb(Fa)}dispose(){this.$=null;super.dispose()}static ka(Fa){Fa.da.Ga(110,new sb(Fa))}}Object(b.a)(sb,"FieldListRequestStateFactory",ma.a,[]);var Ua=a(413),ab=a(33),na=a(784),Na=a(108),Va=a(4),Sa=a(85);class vb{constructor(){this.UD=0;this.request=null;this.gl=!0}get correlationId(){return this.UD}Yqf(){return this.UD=this.correlationId+1}}Object(b.a)(vb,"DataRequestInfo",null,[]);class Oa{}Oa.toh="ewa-flp-react-pane";Oa.soh="ewa-flp-react-header";Oa.uoh="ewa-flp-react-title";
Oa.qoh="ewa-flp-react-body";Oa.roh="ewa-flp-react-close-button";Oa.ooh="ewa-flp-border-ltr";Oa.poh="ewa-flp-border-rtl";Oa.eMe="ewa-flp-nov2";Object(b.a)(Oa,"CssClassNames",null,[]);var yb=a(24),Ob=a(578),Ja=a(170),lb=a(247),Pb=a(121),Jb=a(554),Lb=a(22);const Ab=(Fa,Mb,gc)=>{if(Fa)for(let Qc=0,Sc=Fa.length;Qc<Sc;Qc++){const ud=Fa[Qc];ud.ClientId=gc++;ud.ClientParentId=Mb;gc=Ab(ud.Children,ud.ClientId,gc)}return gc},nb=(Fa,Mb,gc,Qc)=>{for(const Sc of Fa){if(Sc.PivotCacheIndex===Mb&&(Sc.TypeTag===gc||
0===gc))return Sc;if(Qc&&(Fa=nb(Sc.Children,Mb,gc,Qc)))return Fa}return null},va=(Fa,Mb,gc)=>{if(Fa)for(let Sc=0,ud=Fa.length;Sc<ud;Sc++){var Qc=Fa[Sc];if(Qc.ClientId===Mb||gc&&(Qc=va(Qc.Children,Mb,gc)))return Qc}return null};var db=a(7),Xa=a(174),gb=a(1311),Ha=a(737);class tb{constructor(){this.type=null;this.dataUpdateType=0;this.fieldWellsItems=this.fieldListItems=null;this.isSortAscending=this.isPivotChart=this.isOlap=this.isDataModel=!1;this.focusResetId=this.focusResetType=this.fieldListSizePercentage=
this.selectedTab=0;this.onFieldListItemMenuClickV2=this.onFieldWellItemMenuClickV2=this.onFieldCheckedChanged=this.onFieldExpandCollapse=this.onFieldMove=this.onExpandCollapseAll=this.onSortOrderChanged=this.onSelectedTabChanged=this.onSaveFieldListSizePercentage=null;this.isRichPivotFieldList=!1;this.onSearchInputChanged=this.fieldListSearchInfo=null}}Object(b.a)(tb,"FieldListTaskPaneProps",null,[]);class bc{constructor(Fa,Mb){this.$=Fa;this.fieldManagerPane=Mb}AI(Fa){Xa.UISurfaces.Lj().then(Mb=>
{Mb.showTaskPane("FieldListTaskPane",this.Xv(Fa,-1,null,null,!1,-1,!1,0,-1,!1,null));return null})}vu(Fa,Mb,gc,Qc,Sc,ud,Zd,ne,Rd,ie,Ae){Xa.UISurfaces.Lj().then(Se=>{Se.updateTaskPane("FieldListTaskPane",this.Xv(Fa,Mb,gc,Qc,Sc,ud,Zd,ne,Rd,ie,Ae));return null})}eda(){Xa.UISurfaces.Lj().then(Fa=>{Fa.setSelectedTaskPane("FieldListTaskPane");return null})}PM(){Xa.UISurfaces.Lj().then(Fa=>{Fa.hideTaskPane("FieldListTaskPane",2);return null})}Xv(Fa,Mb,gc,Qc,Sc,ud,Zd,ne,Rd,ie,Ae){Mb=Object(db.a)(new tb,{type:"FieldListTaskPaneProps",
fieldListItems:gc,fieldWellsItems:Qc,dataUpdateType:Mb,isDataModel:Sc,selectedTab:ud,isSortAscending:Zd,focusResetType:ne,focusResetId:Rd,isRichPivotFieldList:ie,fieldListSearchInfo:Ae,isOlap:this.fieldManagerPane.ika,isPivotChart:this.fieldManagerPane.hka,fieldListSizePercentage:this.fieldManagerPane.i4i,onFieldExpandCollapse:this.fieldManagerPane.e4i,onExpandCollapseAll:this.fieldManagerPane.d4i,onFieldCheckedChanged:this.fieldManagerPane.n4i,onFieldListItemMenuClickV2:this.fieldManagerPane.g4i,
onSortOrderChanged:this.fieldManagerPane.Z3i,onSaveFieldListSizePercentage:this.fieldManagerPane.G4i,onSearchInputChanged:this.fieldManagerPane.h4i,onSelectedTabChanged:Se=>{this.fieldManagerPane.$3i(Se)},onFieldMove:(Se,Ff,$f,za)=>{this.fieldManagerPane.q4i(Se,Ff,$f,za)},onFieldWellItemMenuClickV2:(Se,Ff,$f,za)=>{this.fieldManagerPane.j4i(Se,Ff,$f,za)}});if(ab.a.Ad(this.$))return Object(db.a)(new gb.a,{contentProps:Mb,onOpen:()=>{this.fieldManagerPane.rAf()},onClose:()=>{this.fieldManagerPane.lPi()},
onManualClose:()=>{this.fieldManagerPane.mPi()},title:this.fieldManagerPane.hka?X.a.instance.ga(1181):X.a.instance.ga(1180),width:400,enableResize:!0,minResizeWidth:400,maxResizeWidth:950});Fa=Object(db.a)(new Ha.a,{type:"ExcelLegacyTaskPaneProps",container:Fa,paneProps:Mb});return Object(db.a)(new gb.a,{contentProps:Fa,onOpen:()=>{this.fieldManagerPane.rAf()}})}}Object(b.a)(bc,"FieldListReactTaskPane",null,[848]);class tc{constructor(Fa,Mb,gc){this.cachedItemIndex=this.cachedSourceAxis=0;this.cachedItemName=
null;this.cachedSourceAxis=Fa;this.cachedItemIndex=Mb;this.cachedItemName=gc}}Object(b.a)(tc,"MacroRecorderPivotTablePivotedAdditionalInformation",null,[]);class Ma{constructor(Fa,Mb,gc,Qc){this.activeCell=this.additionalInformation=this.pivotData=this.pivotName=null;this.pivotName=Fa;this.pivotData=Mb;this.additionalInformation=gc;this.activeCell=Qc}getActiveCell(){return this.activeCell}}Object(b.a)(Ma,"MacroRecorderPivotTablePivotedPayload",null,[101]);var Tb=a(152),zb=a(90),ic=a(29),Qb=a(1),wb=
a(104),hc=a(68),Za=a(700);class ub{constructor(){this.id=0;this.name=null;this.type=0;this.showSeparator=this.showMenu=this.showCheckBox=this.canDrag=this.isMoreFields=this.isChecked=this.isCollapsed=this.isCollapsible=!1;this.children=null;this.isBolded=!1}}Object(b.a)(ub,"FieldListItem",null,[]);class uc{constructor(){this.searchRestoreValue=null;this.searchWithNoMatch=this.needSearchReset=this.needSearchRestore=!1}}Object(b.a)(uc,"FieldListSearchInfo",null,[]);class Oc{constructor(){this.id=0;
this.name=null}}Object(b.a)(Oc,"FieldWellItem",null,[]);class Bb{constructor(){this.valuesWellItems=this.rowsWellItems=this.columnsWellItems=this.filtersWellItems=null}}Object(b.a)(Bb,"FieldWellsItems",null,[]);var Nb=a(553);class dc extends I.a{constructor(Fa,Mb,gc){var Qc;super(Fa);this.$9c=300;this.Z9c=250;this.YP=new vb;this.ZP=new vb;this.o5c={};this.Zta=this.Wj=this.Vj=null;this.Aob=this.U_b=this.X8b=!1;this.currentState=fb.h3b();this.Pra=this.JFa=null;this.oba=0;this.KNd=this.znd=!1;this.Yta=
null;this.l6a=this.Ef=!1;this.uye=this.FGb=this.g6=null;this.IGb=-1;this.JV=[];this.EGb=!1;this.oPa=null;this.DGb=this.hLf=this.LFd=!1;this.CGb="";this.nPa=null;this.f6=0;this.e6="";this.JFd=!1;this.fLf=null;this.gj=!1;this.su=0;this.n4i=(Sc,ud)=>{this.Wj&&this.jka&&(Sc=va(this.Wj.FieldListItems,Sc,!0))&&(d.ULS.sendTraceTag(554317778,0,50,"React Field List: check/uncheck a field."),this.eoi(Sc,ud))};this.e4i=Sc=>{this.Wj&&(Sc=va(this.Wj.FieldListItems,Sc,!0))&&Sc.IsCollapsible&&(5===Sc.TypeTag&&Sc.IsCollapsed&&
!Sc.Children.length?(this.JV.length=0,this.JV.push(Sc),this.o9c()):(Sc.IsCollapsed=!Sc.IsCollapsed,this.Ef&&this.s9b(0,-1,!1,!1,!1,!1)))};this.d4i=Sc=>{this.Wj&&(d.ULS.sendTraceTag(554317777,0,50,"React Field List: expand/collapse all fields."),0<this.JV.length&&(this.JV.length=0),this.dLf(this.Wj.FieldListItems,Sc)?this.o9c():this.Ef&&this.s9b(0,-1,!1,!1,!1,!1))};this.g4i=(Sc,ud,Zd)=>{if(this.Wj){var ne=document.getElementById(ud);if(ne){var Rd=va(this.Wj.FieldListItems,Sc,!0);if(Rd){Sc={};Sc.domElement=
ne;Sc.fieldItem=Rd;Sc.versionkey=this.orb;Sc.isChart=!!this.chartId;Sc.isPpm=this.Wj.IsPpm;Sc.isOlap=this.currentState.ika;Sc.supportsImplicitMeasures=this.Wj.SupportsImplicitMeasures;Sc.isKeyboardInput=Zd;this.oPa=ud;ud=new zb.a(330754562,0,this.$.Mc,30,null);var ie;this.EGb=!Tb.a(ie=this.$.Ka.Mb(ud,Sc))&&(6!==ie.status||ie.result)}}}};this.Z3i=Sc=>{d.ULS.sendTraceTag(554317775,0,50,"React Field List: change field list sort order.");const ud=dc.Kqb(this.currentState);this.$.userOperationManager.Ub(new Ja.a(251,
0,(Zd,ne,Rd)=>{var ie=this.$.oa.va;const Ae=z.L(ie,this.currentState.Jw,this.currentState.externalSourceIndex,ud);Ae.isAscending=Sc;return z.g(ie,"ChangePivotFieldListSortOrder",Ae,Zd,ne,Rd,null,0)}),null)};this.G4i=Sc=>{this.ode=Sc};this.h4i=Sc=>{Sc!==this.e6&&(d.ULS.sendTraceTag(537162715,0,50,"React Field List: change search input."),this.e6=Sc,this.s9b(0,-1,!1,!0,!1,!1))};this.qAf=()=>{if(this.EGb&&this.oPa){const Sc=document.getElementById(this.oPa);Sc&&Sc.classList.add("fieldItemMenuOpen")}};
this.pAf=()=>{if(this.EGb&&this.oPa){const Sc=document.getElementById(this.oPa);Sc&&(Sc.classList.remove("fieldItemMenuOpen"),Sc.classList.contains("fieldItemOnHover")||Sc.classList.contains("fieldItemOnFocus")||(Sc.style.visibility="hidden"))}this.EGb=!1;this.oPa=null};this.$j=()=>{this.GNd(!0,null);this.hideTaskPane();return!0};this.Dga=()=>{if(this.$)if(hc.a(this.$).rLa&&this.isVisible&&this.currentState.ULa&&this.$.ea.fc){if(this.YP.gl&&!this.YP.request){var Sc=this.YP;var ud=this.$.oa.va;var Zd=
this.currentState.iH,ne=this.currentState.iHb,Rd=this.currentState.Tz,ie=this.lKi,Ae=this.mKi,Se=this.YP.Yqf();const Ff=z.L(ud,this.currentState.Jw,this.currentState.externalSourceIndex,dc.Kqb(this.currentState));Ff.type=1;Ff.version=Zd;Ff.relatedGroup=ne;Ff.selectedTab=Rd;ud=z.g(ud,"GetPivotFieldListData",Ff,ie,Ae,null,Se,4);Sc.request=ud}this.ZP.gl&&!this.ZP.request&&(Sc=this.ZP,ud=this.$.oa.va,Zd=this.currentState.xM,ne=this.oKi,Rd=this.pKi,ie=this.ZP.Yqf(),Ae=z.L(ud,this.currentState.Jw,this.currentState.externalSourceIndex,
dc.Kqb(this.currentState)),Ae.type=1,Ae.version=Zd,ud=z.g(ud,"GetPivotFieldManagerData",Ae,ne,Rd,null,ie,4),Sc.request=ud)}else dc.WX(this.YP),dc.WX(this.ZP)};this.lKi=(Sc,ud)=>{this.zHf(Sc,ud,this.YP)&&(Sc=Sc.Result)&&(this.currentState.iH=Sc.FieldListVersion,this.YP.gl=!1,this.ycg(Sc));ib.a(this.$).QNb();this.refresh()};this.mKi=Sc=>{this.pvf(Sc,this.YP)};this.oKi=(Sc,ud)=>{this.zHf(Sc,ud,this.ZP)&&(Sc=Sc.Result)&&(this.currentState.xM=Sc.FieldWellVersion,this.ZP.gl=!1,this.pcg(Sc));this.refresh()};
this.pKi=Sc=>{this.pvf(Sc,this.ZP)};this.sFi=Sc=>{if(ic.a.rg(Sc.Errors)){this.Aob=!1;this.JFa=null;for(let Zd=0,ne=Sc.Errors.length;Zd<ne;++Zd)if(1244452614===Sc.Errors[Zd].MessageId){if(Qb.EwaSettings.isChangeGateEnabled("OfficeVSO:4354463_UpdateSelectionAfterApplyPivot")){Sc=S.g(this.$);var ud=Sc.Db.fp(Sc.ha.sa.activeCell);ud&&(ud=yb.Range.Uc(ud.XTf+1,ud.left),ud=Y.v(ud,this.$),Sc.Dg(ud,null,null,null,3,sa.a.cyh))}this.currentState.iH=-1;this.currentState.xM=-1;this.refresh();break}}this.X8b=!0};
this.WIi=Sc=>{this.U_b=!1;if(!ic.a.rg(Sc.Errors)){if(0<this.JV.length)for(Sc=0;Sc<this.JV.length;++Sc)this.JV[Sc].IsCollapsed=!1;this.currentState.iH=-1;this.refresh()}};this.ila=()=>{const Sc=S.g(this.$).ha;Sc.Pa.Und&&Sc.Je&470||S.g(this.$).inRangePicker||S.g(this.$).xi||this.UGb(!0,!0)};this.Uf=()=>{this.refresh();this.$.ea.to.FieldListForceOnTop&&this.Ewc(!1,null,!0)};this.cmc=()=>{this.UGb(!0,!0)};this.$c=()=>{this.UGb(!0,!1)};this.Gh=(Sc,ud)=>{Sc=ta.e(ud.tD)||ta.e(ud.pa);this.UGb(!0,Sc)};this.Jq=
(Sc,ud)=>{for(let Zd of ud.STj)this.zcg(Zd);this.znd&&(this.znd=!1,this.rka||this.taskPaneManager.Bg&&1===this.taskPaneManager.Bg.taskPane.Yg||this.taskPaneManager.VF(this,!0));this.UGb(!1,!0)};this.lxf=(Sc,ud)=>{S.g(this.$).$p||this.zcg(ud.fd.hash)};this.wDb=()=>{this.refresh()};this.Xc=()=>{this.WK()};this.Ao=()=>{this.WK()};this.RCf=()=>{this.refresh()};this.QDf=()=>{this.Dga()};this.$=Mb;this.pg=Mb.pg;this.taskPaneManager=gc;this.taskPaneManager.mE(this.RCf);this.Rki=Qb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",
!1)&&Qb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotFieldList",!1);this.rka=ab.a.Ad(this.$);this.ode=.5;this.Yta=new bc(this.$,this);this.$.Ka.zme(this.qAf);this.$.Ka.fYa(this.pAf);this.Z9c=this.$9c=400;this.rka||(Fa.style.width=qa.HelperMethods.pc(this.$9c));Lb.a.equals("rtl",Fa.dir,!0)&&(this.gj=!0);this.fyh=[4,2,1,8];this.$.el(this.$c);Fa=S.g(this.$);Fa.Ea.Ks(this.lxf);Fa.aT(this.Jq);Ya.a(this.$).Ea.Ks(this.wDb);Fa.ha.pJ(this.ila);Fa.hC(this.ila);Fa.ha.Pa.sEg(this.cmc);null===
(Qc=wb.a(this.$))||void 0===Qc?void 0:Qc.DYb(this.cmc);this.$.xa.Pf(this.Gh);this.$.ea.Lu(this.Uf);this.$.ea.jk(this.Xc);this.$.ea.$L(this.Ao);hc.a(this.$).OTc(this.QDf);v.a(this.$).Xh(this);this.refresh()}dP(Fa){this.get_events().addHandler(dc.dRe,Fa)}qR(Fa){this.get_events().removeHandler(dc.dRe,Fa)}mE(Fa){this.addHandler(dc.etb,Fa)}SF(Fa){this.removeHandler(dc.etb,Fa)}eme(Fa){this.addHandler(dc.bRe,Fa)}DPf(Fa){this.removeHandler(dc.bRe,Fa)}dme(Fa){this.addHandler(dc.aRe,Fa)}CPf(Fa){this.removeHandler(dc.aRe,
Fa)}get pivotName(){return this.currentState.pivotTableName}get chartId(){return this.currentState.chartId}get Jw(){return this.currentState.Jw}get ika(){return this.currentState.ika}get hka(){return this.currentState.hka}get confirmationRequiredForDataOps(){return this.currentState.confirmationRequiredForDataOps}get externalSourceIndex(){return this.currentState.externalSourceIndex}get iH(){return this.currentState.iH}get xM(){return this.currentState.xM}get orb(){return this.currentState.orb}get isRtl(){return this.gj}get XPd(){return this.DYa&&
!this.$.Ml}get jka(){return!(!this.isVisible||this.YP.gl||this.ZP.gl||this.U_b||this.Aob)}get parentElement(){return this.$.Ml?null:this.$.domElement}get mc(){return this.domElement}get isVisible(){return super.isVisible}set isVisible(Fa){Fa=this.EYa&&Fa;!Fa||this.Pra||this.l6a||this.x9h();Fa!==super.isVisible&&(super.isVisible=Fa,this.raiseEvent(dc.etb));this.cNf(null,Fa)}get kf(){return this.isVisible}get $d(){return ia.a.byh}get Yg(){return 1}get Tk(){return x.a.bth}get RM(){return X.a.instance.ga(1067)}get wo(){return this.$.Ml?
this.Z9c:this.$9c}get isResizable(){return!0}get titleText(){return X.a.instance.ga(1180)}get i4i(){return this.ode}get GB(){return this.taskPaneManager.rua(this.mc,this.titleText,this.wo,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.wo)}get DYa(){return this.$.jc.R1(36896)&&this.EYa}get EYa(){const Fa=new cc.a(this.$.xa);return this.$.isEditMode&&Fa.Ud(8192)||!Fa.li}get Fah(){return(this.pivotName||"")+(this.chartId||"")}Ezj(){this.Pra&&
this.g6&&F.DOMElementExtensions.setVisible(this.g6,!1)}BH(){this.Ezj();this.domElement.classList.remove(this.$.isChromeRtl?dc.ayh:dc.$xh);this.domElement.style.width=qa.HelperMethods.pc(this.Z9c);this.domElement.classList.add(dc.mBh)}ig(){}lp(){return this.DYa&&(!Kb.f(this.pg)||this.$.Ml)}Zr(){const Fa=fb.create(this.$,this.IGb);return Fa.ULa&&!Fa.Gji&&(this.$.Ml||!Kb.f(this.pg))}dR(){}rle(Fa,Mb){(Fa=nb(this.Wj.FieldListItems,Fa,this.currentState.ika?5:17,!0))&&Fa.CanDrag&&this.MJ(Fa,Mb,0,null,null)}MJ(Fa,
Mb,gc,Qc,Sc){let ud,Zd,ne;if(Qc&&!Lb.a.equals(Qc,this.orb,!1))alert(X.a.instance.Xa(18));else{({axis:Qc,pos:Zd,iGf:ne}=this.zVe(Fa.PivotCacheIndex,Fa.PivotTableIndex));-1!==Fa.PivotTableIndex?ud=Qc:(Zd=ud=0,ne=Fa.PivotCacheIndex);if(0===ud){if(7===Fa.TypeTag&&(Fa=0<=Fa.ClientParentId?va(this.Wj.FieldListItems,Fa.ClientParentId,!0):null,!Fa))return;Zd=0;ne=Fa.PivotCacheIndex}if(ud!==Mb||0===Mb||Zd!==gc&&Zd!==gc-1){var Rd=new tc(Qc,Fa.PivotCacheIndex,Fa.Name);ib.a(this.$).wx(this.currentState.confirmationRequiredForDataOps,
ie=>{ie&&this.applyPivot(this.currentState,ud,Zd,Fa.TypeTag,ne,Mb,gc,Sc,S.g(this.$),Rd,Fa)})}}}q4i(Fa,Mb,gc,Qc){if(this.Wj&&this.Vj){var Sc=null;switch(Mb){case 0:Sc=va(this.Wj.FieldListItems,Fa,!0);break;case 1:Sc=va(this.Vj.RowAxis,Fa,!1);break;case 2:Sc=va(this.Vj.ColumnAxis,Fa,!1);break;case 4:Sc=va(this.Vj.FilterAxis,Fa,!1);break;case 8:Sc=va(this.Vj.DataAxis,Fa,!1)}Sc&&(d.ULS.sendTraceTag(554317779,0,50,"React Field List: drag and drop a field."),this.MJ(Sc,gc,Qc,null,null))}}dLf(Fa,Mb){let gc;
gc=!1;for(let Qc=0;Qc<Fa.length;Qc++){const Sc=Fa[Qc];Mb&&Sc.IsCollapsible&&5===Sc.TypeTag&&Sc.IsCollapsed&&!Sc.Children.length?(this.JV.push(Sc),gc=!0):Mb&&Sc.IsCollapsible&&Sc.IsCollapsed?Sc.IsCollapsed=!1:Mb||!Sc.IsCollapsible||Sc.IsCollapsed||(Sc.IsCollapsed=!0);Sc.IsCollapsible&&Sc.Children&&0<Sc.Children.length&&this.dLf(Sc.Children,Mb)&&(gc=!0)}return gc}s9b(Fa,Mb,gc,Qc,Sc,ud){if(this.Wj){var Zd=!1,ne=!1,Rd=!1,ie=null;Rd=null;var Ae=Fa;Qc&&0<this.JV.length&&(this.JV.length=0);({rwb:ne,dta:Rd,
isRichPivotFieldList:Zd,returnValue:ie}=this.nbd(this.Wj.FieldListItems,Qc,!1));Rd?this.U_b||this.o9c():(Rd=new uc,Rd.needSearchReset=ud,Rd.needSearchRestore=!ud&&Sc,Rd.searchRestoreValue=Rd.needSearchRestore?this.e6:"",Rd.searchWithNoMatch=""!==this.e6&&!ne,Rd.searchWithNoMatch&&Qc&&R.TaskExtensions.Aa(ea.GetServiceTaskFactory.Ra(this.$.da,211,212,0),Se=>{Se.result.readText(X.a.instance.ga(783))},this.$.la,3),""!==this.e6&&2===Fa&&(Rd.searchWithNoMatch?Ae=1:gc&&ie&&0<ie.length&&(Mb=ie[0].id)),this.Yta.vu(this.Pra,
0,ie,null,this.Wj.IsPpm,this.Wj.SelectedTab,this.Wj.IsSortAscending,Ae,Mb,Zd,Rd))}}$3i(Fa){d.ULS.sendTraceTag(554317776,0,50,"React Field List: change All/Active tab.");this.IGb=Fa;this.UGj()}j4i(Fa,Mb,gc,Qc){if(this.Vj){var Sc=document.getElementById(gc);if(Sc){var ud=null,Zd=-1;switch(Mb){case 4:ud=va(this.Vj.FilterAxis,Fa,!1);Zd=this.Vj.FilterAxis.length;break;case 2:ud=va(this.Vj.ColumnAxis,Fa,!1);Zd=this.Vj.ColumnAxis.length;break;case 1:ud=va(this.Vj.RowAxis,Fa,!1);Zd=this.Vj.RowAxis.length;
break;case 8:ud=va(this.Vj.DataAxis,Fa,!1),Zd=this.Vj.DataAxis.length}if(ud){var ne={};this.currentState.hka?(ne.AnchorType=8,ne.ChartId=this.currentState.chartId):ne.AnchorType=9;ne.AnchorValue1=ud.PivotTableIndex;ne.AnchorValue2=ud.PivotCacheIndex;var Rd,ie;({axis:Rd,pos:ie}=this.zVe(ud.PivotCacheIndex,ud.PivotTableIndex));Fa=new zb.a(-1453503574,0,this.$.Mc,30,null);Mb={};Mb.domElement=Sc;Mb.fieldItem=ud;Mb.zoneCount=Zd;Mb.sourceAxis=Rd;Mb.sourceAxisPos=ie;Mb.optionalPivotMenuAnchorParameter=ne;
Mb.isOlap=this.currentState.ika;Mb.isPpm=this.Wj.IsPpm;Mb.versionkey=this.orb;Mb.isKeyboardInput=Qc;Mb.cell=this.currentState.Jw;Mb.externalSourceIndex=this.externalSourceIndex;Qc=!1;Qb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&this.currentState.ika&&!this.Wj.IsPpm&&this.Wj.SupportsImplicitMeasures&&(ud=nb(this.Wj.FieldListItems,ud.PivotCacheIndex,5,!0),Qc=!!ud&&!ud.IsCollapsible);Mb.fieldItemsupportsImplicitMeasures=Qc;this.oPa=gc;var Ae;this.EGb=!Tb.a(Ae=
this.$.Ka.Mb(Fa,Mb))&&(6!==Ae.status||Ae.result)}}}}f4i(Fa){Fa&&R.TaskExtensions.Aa(ea.GetServiceTaskFactory.Ra(this.$.da,103,104,0),Mb=>{var gc=Mb.result;const Qc=S.g(this.$),Sc=Y.v(yb.Range.Uc(1,1),this.$).SheetName;Mb=gc.kfb(Qc);let ud,Zd,ne,Rd;Mb?(gc=Mb.Fe,ud=gc.rf.top,Zd=gc.rf.left,ne=Mb.OI.x,Rd=Mb.OI.y):(ud=Zd=1,Mb=gc.eKa(Qc),ne=Mb.x,Rd=Mb.y);this.$.userOperationManager.Ub(new Ja.a(203,0,(ie,Ae,Se)=>lb.s(this.$.oa.va,Sc,this.pivotName,Fa.PivotCacheIndex,0,ud,Zd,ne,Rd,ie,Ae,Se,null),void 0,()=>
new Ob.a(Sc,this.pivotName,Fa.PivotCacheIndex,0)),null)},this.$.la,8)}dispose(){var Fa;if(this.$){this.$.Al(this.$c);this.$.Ka.WPf(this.qAf);this.$.Ka.NHb(this.pAf);this.JV.length=0;const Mb=S.g(this.$);Mb&&(Mb.QN(this.Jq),Mb.AD(this.ila),Mb.ha&&(Mb.ha.RK(this.ila),Mb.ha.Pa.Baj(this.cmc)),Mb.Ea&&Mb.Ea.Nq(this.lxf));null===(Fa=wb.a(this.$))||void 0===Fa?void 0:Fa.Mrc(this.cmc);Fa=Ya.a(this.$);(null===Fa||void 0===Fa?0:Fa.Ea)&&Fa.Ea.Nq(this.wDb);this.$.xa&&this.$.xa.zg(this.Gh);if(Fa=this.$.ea)Fa.Hw(this.Uf),
Fa.Ik(this.Xc),Fa.pR(this.Ao);hc.a(this.$)&&hc.a(this.$).prc(this.QDf)}this.taskPaneManager&&this.taskPaneManager.SF(this.RCf);this.g6&&(D.a.instance.Ba(w.a.click,this.g6,this.$j),Na.KeyInputManager.instance.Bv(this.g6,this.uye));this.hideTaskPane();this.taskPaneManager=this.$=this.Yta=null;super.dispose()}hg(Fa,Mb){if(!Mb){Fa=F.DOMElementExtensions.Kl(this.domElement.querySelectorAll(F.DOMElementExtensions.qr));if(!Fa)return!1;F.DOMElementExtensions.setFocus(Fa)}return!Mb}kh(Fa){return F.DOMElementExtensions.vf(this.mc,
Fa)}lj(){}Nj(){}UGj(){this.refresh()}eoi(Fa,Mb){Fa&&Fa.CanDrag&&this.MJ(Fa,Mb?-1:0,-1,null,null)}z5(){this.rka&&this.lp()&&this.Zr()&&(this.isVisible=!0)}rAf(){this.LFd=!0;this.refresh()}lPi(){this.hideTaskPane()}mPi(){this.GNd(!0,null);this.hideTaskPane()}x9h(){this.l6a=this.Ef=!0;this.rka||this.W$h();this.Yta.AI(this.Pra)}showTaskPane(){this.isVisible=!0;""!==this.e6&&(this.JFd=!0);this.Ef?this.rka?this.Yta.eda():this.taskPaneManager.VF(this,!0):(this.Ef=!0,this.Yta.AI(this.Pra),this.rka||this.taskPaneManager.VF(this,
!0))}hideTaskPane(){this.isVisible=this.LFd=this.Ef=!1;this.Yta.PM()}Ewc(Fa,Mb,gc){this.GNd(Fa,Mb);this.znd=gc;this.KNd=!Fa&&!!Mb||gc;Fa?this.hideTaskPane():this.showTaskPane()}o9c(){ib.a(this.$).wx(this.currentState.confirmationRequiredForDataOps,Fa=>{Fa&&this.expandPivotFieldListLevels(this.currentState)})}mQ(){return!1}PJg(){const Fa=document.getElementsByTagName("head")[0];if(Fa){const Mb=document.createElement("link");Mb.setAttribute("rel","stylesheet");Mb.setAttribute("type","text/css");Mb.setAttribute("href",
F.DOMElementExtensions.HY(this.domElement,"data-cssfile",null));Fa.appendChild(Mb)}}W$h(){const Fa=document.getElementById(this.$.Bb+B.a.cRe);if(Fa){this.PJg();Fa.classList.add(dc.x4i);var Mb=this.H8g();Fa.appendChild(Mb);Mb=Za.b("div",dc.u4i,dc.t4i);Fa.appendChild(Mb);this.Pra=Mb}}H8g(){const Fa=Za.b("div",dc.z4i,dc.y4i);this.FGb=Za.b("span",dc.B4i,dc.A4i);this.FGb.innerText=this.titleText;this.g6=na.a.pb(dc.v4i,dc.w4i,X.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.g6.classList.add(Va.AFrameworkApplication.isRtl?
B.a.V$:B.a.W$);D.a.instance.ra(w.a.click,this.g6,this.$j);this.uye=Na.KeyInputManager.instance.ms(this.g6,this.$j,Sa.a.$h);this.$.Ml&&F.DOMElementExtensions.setVisible(this.g6,!1);Fa.appendChild(this.FGb);Fa.appendChild(this.g6);return Fa}ycg(Fa){if(this.Wj=Fa)this.currentState.iH=this.Wj.FieldListVersion,this.oba=Ab(this.Wj.FieldListItems,-1,this.oba);if(this.Wj)if(this.Ef){this.IGb=this.currentState.Tz=this.Wj.SelectedTab;this.fsi();Fa=-1;var Mb=0,gc=!1;this.KNd?(this.Wj.FieldListItems&&0<this.Wj.FieldListItems.length&&
(Fa=this.Wj.FieldListItems[0].ClientId,Mb=2,gc=!0),this.KNd=!1):this.X8b&&0===this.f6&&(this.nPa||this.DGb?this.Wj.FieldListItems&&0<this.Wj.FieldListItems.length&&(Fa=this.DGb?this.Wj.FieldListItems[0].ClientId:this.nPa.ClientId,Mb=2,gc=this.DGb):this.hLf&&(Fa=this.Wj.FieldListItems[0].ClientId,Mb=1),this.i1b());var Qc=!1;this.fLf!==this.Wj.PivotXluid&&(this.fLf=this.Wj.PivotXluid,Qc=!0,this.e6="");this.s9b(Mb,Fa,gc,!1,!Qc&&this.JFd&&""!==this.e6,Qc);this.JFd=!1}else this.i1b()}i1b(){this.f6=0;this.nPa=
null;this.CGb="";this.X8b=this.DGb=this.hLf=!1}yxj(Fa){return 7===Fa.TypeTag?!1:Fa.ShowFilterArrow||Fa.ShowCheckBox}goi(Fa){return Fa.IsCollapsible&&(!Fa.IsCollapsed||2===Fa.Image)&&!!Fa.Children&&0<Fa.Children.length}rwb(Fa,Mb){const gc=Mb.length;return 2<gc&&'"'===Mb.charAt(0)&&'"'===Mb.charAt(gc-1)?Lb.a.contains(Fa,Mb.substring(1,gc-1),!0):Lb.a.V_a(Mb,"*")||Lb.a.V_a(Mb,"?")?(Mb=Mb.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&"),Mb="^"+Lb.a.UPa(Lb.a.UPa(Mb,"\\\\?",".",!0),"\\\\*",".*",!0)+
"$",0<=Fa.search(new RegExp(Mb,"i"))):Lb.a.contains(Fa,Mb,!0)}nbd(Fa,Mb,gc){let Qc,Sc,ud,Zd;Qc=Zd=ud=Sc=!1;const ne=[];for(let Ae=0;Ae<Fa.length;Ae++){const Se=Fa[Ae];var Rd=!1;let Ff=!1,$f=!1,za,Aa=[];if(""===this.e6){if(this.goi(Se)){var ie=void 0;({rwb:Ff,dta:za,k6e:ie,isRichPivotFieldList:Rd,returnValue:Aa}=this.nbd(Se.Children,Mb,!1));Se.ShowCheckBox||(Se.IsChecked=ie)}}else 2!==Se.Image&&this.rwb(Se.Name,this.e6)&&(Qc=$f=!0,Mb&&Se.IsCollapsible&&Se.IsCollapsed&&(5!==Se.TypeTag||Se.Children.length?
Se.IsCollapsed=!1:(this.JV.push(Se),Sc=!0))),Mb&&gc&&Se.IsCollapsible&&Se.IsCollapsed&&(5!==Se.TypeTag||Se.Children.length?Se.IsCollapsed=!1:(this.JV.push(Se),Sc=!0)),Se.IsCollapsible&&Se.Children&&0<Se.Children.length&&({rwb:Ff,dta:za,k6e:ie,isRichPivotFieldList:Rd,returnValue:Aa}=this.nbd(Se.Children,Mb,$f||gc),Se.ShowCheckBox||(Se.IsChecked=ie),Ff&&(Qc=!0,Mb&&(Se.IsCollapsed=!1)),za&&(Sc=!0));this.Rki&&(Rd||66===Se.TypeTag)&&(Zd=!0);Se.IsChecked&&(ud=!0);if(""===this.e6||$f||Ff||gc)Rd=new ub,Rd.id=
Se.ClientId,Rd.name=Se.Name,Rd.type=Se.TypeTag,Rd.isCollapsible=Se.IsCollapsible,Rd.showCheckBox=Se.ShowCheckBox,Rd.isMoreFields=2===Se.Image,Rd.canDrag=Se.CanDrag&&7!==Se.TypeTag,Rd.showSeparator=Se.ShowSeparator,Rd.showMenu=this.yxj(Se),Rd.isCollapsed=Se.IsCollapsed,Rd.isChecked=Se.IsChecked,Rd.isBolded=Se.IsBolded,Rd.children=Aa,ne.push(Rd)}return{returnValue:ne,rwb:Qc,dta:Sc,k6e:ud,isRichPivotFieldList:Zd}}y9b(Fa){const Mb=Array(Fa.length);for(let gc=0;gc<Fa.length;gc++){const Qc=Fa[gc],Sc=new Oc;
Sc.id=Qc.ClientId;Sc.name=Qc.Name;Mb[gc]=Sc}return Mb}gjj(){this.bVf(this.Wj.FieldListItems,"")}fsi(){this.lkf(this.Wj.FieldListItems,"")}f8b(Fa,Mb){return Fa.Name+"_"+Fa.UniqueName+"_"+Fa.TypeTag+"_"+(Mb||this.Fah)}bVf(Fa,Mb){if(Fa)for(let gc=0,Qc=Fa.length;gc<Qc;gc++){const Sc=Fa[gc];let ud="";if(Sc.IsCollapsible||Sc.Children)ud=this.f8b(Sc,Mb),Sc.IsCollapsible&&(this.o5c[ud]=!!Sc.IsCollapsed),Sc.Children&&this.bVf(Sc.Children,ud);this.nPa&&Sc.ClientId===this.nPa.ClientId&&(this.CGb=ud||this.f8b(Sc,
Mb))}}lkf(Fa,Mb){if(Fa)for(let gc=0,Qc=Fa.length;gc<Qc;gc++){const Sc=Fa[gc];let ud="";if(Sc.IsCollapsible||Sc.Children)ud=this.f8b(Sc,Mb),Sc.IsCollapsible&&ud in this.o5c&&(Sc.IsCollapsed=M.a.og(this.o5c,ud)),Sc.Children&&this.lkf(Sc.Children,ud);this.CGb&&Lb.a.equals(this.CGb,ud||this.f8b(Sc,Mb),!1)&&(this.nPa=Sc,this.CGb="")}}pcg(Fa){if(this.Vj=Fa)this.currentState.xM=this.Vj.FieldWellVersion,this.oba=Ab(this.Vj.FilterAxis,-1,this.oba),this.oba=Ab(this.Vj.ColumnAxis,-1,this.oba),this.oba=Ab(this.Vj.RowAxis,
-1,this.oba),this.oba=Ab(this.Vj.DataAxis,-1,this.oba);this.Zta?this.Zta.length=0:this.Zta=[];if(this.Vj)if(this.Zta.push(this.Vj.FilterAxis),this.Zta.push(this.Vj.ColumnAxis),this.Zta.push(this.Vj.RowAxis),this.Zta.push(this.Vj.DataAxis),this.Ef){Fa=-1;var Mb=0;if(this.X8b&&0!==this.f6){switch(this.f6){case 1:0<this.Vj.RowAxis.length&&(Fa=this.Vj.RowAxis[0].ClientId,Mb=3);break;case 2:0<this.Vj.ColumnAxis.length&&(Fa=this.Vj.ColumnAxis[0].ClientId,Mb=3);break;case 4:0<this.Vj.FilterAxis.length&&
(Fa=this.Vj.FilterAxis[0].ClientId,Mb=3);break;case 8:0<this.Vj.DataAxis.length&&(Fa=this.Vj.DataAxis[0].ClientId,Mb=3)}this.i1b()}var gc=new Bb;gc.filtersWellItems=this.y9b(this.Vj.FilterAxis);gc.columnsWellItems=this.y9b(this.Vj.ColumnAxis);gc.rowsWellItems=this.y9b(this.Vj.RowAxis);gc.valuesWellItems=this.y9b(this.Vj.DataAxis);this.Yta.vu(this.Pra,1,null,gc,!1,-1,!1,Mb,Fa,!1,null)}else this.i1b()}TQj(){this.FGb&&(this.FGb.innerText=this.currentState.hka?X.a.instance.ga(1181):this.titleText)}refresh(){if(this.LFd){var Fa=
fb.create(this.$,this.IGb);this.cNf(Fa)}}cNf(Fa,Mb=!1){if(this.isVisible&&(this.rka||this.Pra)){Fa=Fa||fb.create(this.$,this.IGb);const gc=this.currentState;this.Wj&&this.gjj();this.currentState=Fa;if(fb.gni(gc,Fa)||Mb){if(this.Aob=!1,this.YP.gl=Fa.ULa,dc.WX(this.YP),fb.Egf(gc,Fa)||Mb)this.ZP.gl=Fa.ULa,dc.WX(this.ZP),this.ycg(null),this.pcg(null),this.TQj()}else gc.iH<Fa.iH?(this.YP.gl=!0,dc.WX(this.YP)):this.currentState.iH=gc.iH,gc.xM<Fa.xM?(this.Aob=!1,this.ZP.gl=!0,dc.WX(this.ZP)):this.currentState.xM=
gc.xM}pa.a.instance.create(this.Dga,0,Pa.a.Zxh,!0,!0)}GNd(Fa,Mb){this.applyPivotFieldManagerHiddenState(Fa,Mb);this.pg=qa.HelperMethods.dO(Fa,this.pg,4);this.refresh();this.raiseEvent(dc.etb);this.rka&&this.$.qf()}applyPivotFieldManagerHiddenState(Fa,Mb){this.$.userOperationManager.Ub(new Ja.a(144,0,(gc,Qc,Sc)=>{const ud=Y.o(S.g(this.$).ha.sa.activeCell,this.$);var Zd=this.$.oa.va;const ne=Zd.Na(9);ne.hidden=Fa;ne.activeCell=ud;return z.g(Zd,"ApplyPivotFieldManagerHiddenStateV2",ne,gc,Qc,Sc,null,
0)},16),Mb)}zHf(Fa,Mb,gc){gc.gl=!1;if(!gc.request||Mb!==gc.correlationId)return!1;gc.request=null;return ic.a.rg(Fa.Errors)?(this.$.ea.zp(Fa.Errors),!1):!0}pvf(Fa,Mb){const gc=Pb.a.lf(Fa.data);this.$.ea.zp(gc);Mb.request=null;10!==Fa.data.status&&(Mb.gl=!1);this.Dga()}applyPivot(Fa,Mb,gc,Qc,Sc,ud,Zd,ne,Rd,ie,Ae){0<Rd.getRangeInformation(Rd.ha.sa.activeCell).length?this.Aob=!0:(this.YP.gl=!0,this.ZP.gl=!0);Fa.igc&&(this.JFa=Fa.pivotTableName);const Se=dc.Kqb(Fa),Ff={FieldListType:1};Ff.FieldListVersion=
Fa.iH;Ff.FieldWellVersion=Fa.xM;Ff.SourceAxis=Mb;Ff.SourceAxisPosition=gc;Ff.ItemType=Qc;Ff.ItemIndex=Sc;Ff.DestinationAxis=ud;Ff.DestinationAxisPosition=Zd;this.NSj(Ae,Mb,ud);Mb=new Ja.a(145,0,($f,za,Aa)=>{var xc=this.$.oa.va;$f=Ra.b($f,this.sFi);const zd=z.L(xc,Fa.Jw,Fa.externalSourceIndex,Se);zd.pivotFieldApplyData=Ff;return z.g(xc,"ApplyPivot",zd,$f,za,Aa,null,0)},4,()=>new Ma(this.pivotName,Ff,ie,Fa.Jw));this.$.userOperationManager.Ub(Mb,ne)}NSj(Fa,Mb,gc){if(this.Wj&&this.Vj)if(0===Mb)this.f6=
0,this.nPa=Fa;else if(0!==gc)this.f6=gc;else switch(this.f6=0,this.DGb=!0,Mb){case 1:1<this.Vj.RowAxis.length&&(this.f6=1);break;case 2:1<this.Vj.ColumnAxis.length&&(this.f6=2);break;case 4:1<this.Vj.FilterAxis.length&&(this.f6=4);break;case 8:1<this.Vj.DataAxis.length&&(this.f6=8)}}expandPivotFieldListLevels(Fa){const Mb=dc.Kqb(Fa);this.U_b=!0;this.$.userOperationManager.Ub(new Ja.a(146,0,(gc,Qc,Sc)=>{var ud=this.$.oa.va;gc=Ra.b(gc,this.WIi);const Zd=z.L(ud,Fa.Jw,Fa.externalSourceIndex,Mb);Zd.type=
1;return z.g(ud,"ExpandPivotFieldListLevels",Zd,gc,Qc,Sc,null,0)}),null)}zVe(Fa,Mb){var gc;for(let Sc=dc.Ggg;Sc<=dc.Hgg;Sc++){const ud=this.Zta[Sc];for(gc=ud.length-1;0<=gc;gc--){var Qc=ud[gc];if(Qc.PivotCacheIndex===Fa&&(-1===Mb||Qc.PivotTableIndex===Mb))return Fa=this.VSh(Sc),Qc=Qc.PivotTableIndex,{returnValue:!0,axis:Fa,pos:gc,iGf:Qc}}}return{returnValue:!1,axis:0,pos:-1,iGf:-1}}Rni(Fa){return Fa>=dc.Ggg&&Fa<=dc.Hgg}clear(){this.currentState=fb.h3b();this.refresh()}VSh(Fa){return this.Rni(Fa)?
this.fyh[Fa]:0}UGb(Fa,Mb){Fa&&(this.JFa=null);this.refresh();Mb&&(this.rka?!this.Ef&&this.Zr()&&this.lp()?this.showTaskPane():!this.Ef||this.lp()&&this.Zr()||this.hideTaskPane():this.raiseEvent(dc.etb))}rGh(){var Fa=S.g(this.$);let Mb=null;Fa=Fa.getRangeInformation(Fa.ha.sa.activeCell);for(let gc=0,Qc=Fa.length;gc<Qc;++gc){const Sc=Fa[gc];if(Object(k.a)(aa.PivotTableRange,Sc)){Mb=Sc.pivotTableName;break}}return Mb}zcg(Fa){const Mb=S.g(this.$);var gc=Mb.Ea.Jl(Fa);if(gc){if(this.JFa){Fa=gc.ranges;if(!Fa)return;
for(gc=Fa.length-1;0<=gc;--gc){var Qc=Fa[gc];if(Object(k.a)(aa.PivotTableRange,Qc)&&Lb.a.equals(Qc.pivotTableName,this.JFa,!1)){Fa=this.rGh();Fa&&Lb.a.equals(Fa,this.JFa,!1)||(Fa=Y.v(Qc.topLeft,this.$),Mb.Dg(Fa,null,null,null,0,sa.a.dyh));this.JFa=null;break}}}S.g(this.$).$p||this.refresh()}else d.ULS.sendTraceTag(537162690,0,15,`Block ${Fa} was removd from BlockManager`)}WK(){this.clear()}static zLg(Fa,Mb,gc){let Qc=Jb.a(Fa);if(!Qc){const Sc=document.getElementById(Fa.Bb+B.a.cRe);Sc?Qc=Fa.da.Ga(16,
new dc(Sc,Fa,Mb,gc)):d.ULS.sendTraceTag(537162688,0,15,"FieldManagerPane creation fails: FieldManagerPaneDiv is null.")}return Qc}static Kqb(Fa){const Mb={};Mb.AnchorType=Fa.anchorType;7===Fa.anchorType&&(Mb.ChartId=Fa.chartId,Mb.AnchorValue1=Mb.AnchorValue2=-1);return Mb}static WX(Fa){Fa.request&&(Va.AFrameworkApplication.vd.tu(Fa.request.Nt),Fa.request=null)}}dc.etb="fieldListPaneVisibilityChanged";dc.bRe="FieldListPaneChanging";dc.aRe="FieldListPaneChanged";dc.dRe="FieldManagerRemovePaneEventKey";
dc.mBh=Nb.a.eMe;dc.ayh=Oa.poh;dc.$xh=Oa.ooh;dc.Ggg=0;dc.Hgg=3;dc.z4i="FieldListReactPaneHeaderId";dc.u4i="FieldListReactPaneBodyId";dc.B4i="FieldListReactPaneTitleId";dc.v4i="FieldListReactPaneCloseButtonId";dc.x4i=Oa.toh;dc.y4i=Oa.soh;dc.A4i="cui-taskPaneTitle "+Oa.uoh;dc.t4i=Oa.qoh;dc.w4i=Oa.roh;Object(b.a)(dc,"FieldManagerPane",I.a,[823,457,2,401,102]);class sc extends ma.a{constructor(Fa){super();this.$=Fa;this.Fb()}create(){const Fa=ea.GetServiceTaskFactory.Ra(this.$.da,12,477,this.hb),Mb=Ua.a(this.$),
gc=[Fa,Mb];if(!ab.a.Ad(this.$)){const Qc=ea.GetServiceTaskFactory.create(this.$.da,203,this.la,this.hb),Sc=ea.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb);gc.push(Qc);gc.push(Sc)}R.TaskExtensions.Aa(R.TaskExtensions.Wd(gc,this.la),()=>{const Qc=dc.zLg(this.$,Mb.result,Fa.result);Qc&&(ab.a.Ad(this.$)||Mb.result.uQ(Qc),Qc.z5());this.qb(Qc)},this.la,3)}dispose(){this.$=null;super.dispose()}static ka(Fa){Fa.da.Ga(74,new sc(Fa))}}Object(b.a)(sc,"FieldManagerTaskPaneFactory",ma.a,[]);var yc=
a(155),cd=a(82),pd=a(513);class Rb{constructor(){this.Y4b=this.sourceRange=this.xda=null}}Object(b.a)(Rb,"SelectedRangeForPivot",null,[]);var Dc=a(552),nd=a(185),od=a(260),wd=a(144),Pc=a(183);class Hb{static get ag(){return wd.a.ap(Hb.ibi,Pc.a.ga(66),Pc.a.ga(67),Pc.a.ga(68),Pc.a.ga(69),Pc.a.ga(70),Pc.a.ga(71),Pc.a.ga(72))}}Hb.ibi="<div class='DataSourceDiv' id='DataSourceDiv'> <div class='WACDialogRow' id='dataAnalyzeTitle'> <label id='dataChoice' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='sourceRadio'> <label id='sourceSelectLabel' class='WACDialogLabel' >{1}</label> </div> <div class='ewa-insertpt-dlg-sourceRange WACDialogRowNoBreak' id='sourceRangeText'> <label id='tableOrRange' class='ewa-insertpt-dlg-label' for='SourceRange' >{2}</label> <input type='text' id='sourceRange' class='WACDialogInput ewa-insertpt-dlg-input' aria-describedby=\"dataChoice . sourceSelectLabel\" maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div> <div class='PivotDestinationDiv' id='PivotDestinationDiv'> <div class='WACDialogRow' id='destinationTitle'> <label id='destinationLabel' class='WACDialogLabel' >{3}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickNewWorksheet'> <input type='radio' id='newWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{4}' aria-describedby=destinationLabel title='{4}'></input> <label id='newWorksheetLabel' class='WACDialogLabel' for='newWorksheet' >{4}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickExistingWorksheet'> <input type='radio' id='existingWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{5}' aria-describedby=destinationLabel title='{5}'></input> <label id='existingWorksheetLabel' class='WACDialogLabel' for='existingWorksheet' >{5}</label> <div class='WACDialogRowNoBreak' id='destinationRangeText'> <label id='Location' class='ewa-insertpt-dlg-label' for='DestinationRange' >{6}</label> <input type='text' id='destinationRange' class='WACDialogInput ewa-insertpt-dlg-input' maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div>";
Object(b.a)(Hb,"InsertPivotTableDialogHtml",null,[]);var Nc=a(160),Db=a(368);class Cc{constructor(Fa,Mb){this.eWb=Fa;this.Ttg=Mb;this.Ppc=null}get textBox(){return this.eWb}get bab(){return this.Ttg}bindAction(Fa){this.bab&&Fa&&(this.Ppc=Fa,this.bab.JDg(this.Ppc))}eOj(){this.bab&&this.Ppc&&this.bab.X$i(this.Ppc)}isValid(){return!!this.bab&&!!this.textBox}}Object(b.a)(Cc,"TextBoxRadioButtonPair",null,[901]);var Xc=a(866),ld=a(283);class Dd{constructor(Fa,Mb){this.title=Fa;this.ag=Mb}}Object(b.a)(Dd,
"DialogData",null,[]);const Od=(Fa,Mb,gc,Qc,Sc,ud,Zd,ne=null)=>{ne=Fa.Na(41,ne);ne.sheetRange=Mb;ne.destinationRange=gc;return z.g(Fa,"InsertPivotTable",ne,Qc,Sc,ud,Zd,0)},Qd=(Fa,Mb,gc,Qc,Sc,ud,Zd,ne,Rd=null)=>{Rd=Fa.Na(41,Rd);Rd.activeCell=Mb;Rd.newRange=gc;Rd.isDataSource=Qc;return z.g(Fa,"ChangePivotLocation",Rd,Sc,ud,Zd,ne,0)},Nd=(Fa,Mb,gc,Qc,Sc,ud,Zd=null)=>{Zd=Fa.Na(1,Zd);Zd.activeCell=Mb;return z.g(Fa,"GetDataSourceRangeForPivotTable",Zd,gc,Qc,Sc,ud,0)};class he{constructor(Fa,Mb){this.destinationRange=
this.sourceRange=null;this.sourceRange=Fa;this.destinationRange=Mb}}Object(b.a)(he,"MacroRecorderPivotTableCreatedPayload",null,[101]);var ve=a(378),Td=a(162),ke=a(214);class xe extends ve.a{constructor(Fa){super(Fa)}P3a(Fa){let Mb,gc=({Xgc:Mb}=super.P3a(Fa)).returnValue;if(!gc){const Qc=Object(e.a)(ke.a,this.$.zb);Qc&&Qc.Ek(Fa)&&(gc=(Fa=Qc.getItemByName(Fa))&&1!==Fa.type?2===Fa.type?Td.a(Fa):Fa.usedRange:null,Mb=2===Fa.type)}return{returnValue:gc,Xgc:Mb}}}Object(b.a)(xe,"PivotTableRangeHighlightPolicy",
ve.a,[]);class le extends od.a{constructor(Fa,Mb){super(Fa,new xe(Fa));this.wUd=this.destinationRange=this.J$=this.Mxa=this.dSa=null;this.yAa=!1;this.Uu=0;this.hGe="";this.i$e=(gc,Qc)=>{this.hide();if(1===gc){let Sc=gc="";2!==this.Uu&&(gc=le.YBd(Qc[le.mxc],this.$.xa),this.ZCj(gc,this.$)&&d.ULS.sendTraceTag(537155781,0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - Source does not have enough entries"));1!==this.Uu&&Qc[le.k9c]&&(Sc=le.YBd(Qc[le.X4b],this.$.xa));2===this.Uu&&Sc===this.hGe||
this.Bai(gc,Sc)}else this.oLb(!0,!0),d.ULS.sendTraceTag(537155780,0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - cancel was clicked.")};this.iu=()=>{this.yNb()};this.Olc=()=>{this.destinationRange.disabled=!this.J$.checked;this.yNb();return!1};this.vvf=()=>{this.yNb();return!1};this.CCf=()=>{this.yNb();return!1};this.Hzd=gc=>{if(Z.a(gc))this.oLb(!0,!0),d.ULS.sendTraceTag(537155742,0,50,"InsertPivotTableDialog.OnInsertPivotTableDone - failed.");else{d.ULS.sendTraceTag(537155743,0,50,
"InsertPivotTableDialog.OnInsertPivotTableDone - success.");const Qc=gc.Result;if(Qc){if(gc=this.$.xa.getItemByName(Qc.SheetName))gc.activate(),this.gridView.Dg(Qc,null,null,null,3,sa.a.jbi),this.oLb(!0,!1),0===this.Uu&&this.Bpj(),gc=B.a.bqc,gc!==Nc.a(this.$).Vl.Tz&&(Nc.a(this.$).uGb(2),Nc.a(this.$).Vl.activateRibbonTab(gc))}else this.oLb(!0,!1)}};this.gridView=S.g(this.$);this.tQ=Dc.a.instance;this.Hv=!1;-1128516639===Mb?(this.Uu=1,d.ULS.sendTraceTag(537155785,0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Change data Source")):
-63037693===Mb?(this.Uu=2,d.ULS.sendTraceTag(537155784,0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Move PivotTable")):d.ULS.sendTraceTag(537155783,0,50,"InsertPivotTableDialog.InsertPivotTableDialog")}dispose(){d.ULS.sendTraceTag(537155782,0,50,"InsertPivotTableDialog.Dispose");this.Zzc();super.dispose()}get oc(){return"InsertPivotTableDialog"}get bpb(){return!0}get kwe(){return!0}get jwe(){return!0}Oia(){let Fa;return Fa=new nd.a,Fa.add(le.mxc),Fa.add(le.X4b),Fa}Fdh(){let Fa=
!1;2!==this.Uu&&(Fa=le.Hdh(this.dSa.value));Fa||1===this.Uu||(Fa=le.Gdh(this.J$.checked,this.destinationRange.value));return Fa}get cy(){return()=>{let Fa=this.destinationRange.value;1!==this.Uu&&this.destinationRange.disabled&&(Fa="");this.i$e(1,le.TYe(this.dSa.value,Fa))}}pdc(Fa){d.ULS.sendTraceTag(537155779,0,50,"InsertPivotTableDialog.InitAndShow");const Mb=this.JLh();this.ag=Mb.ag;var gc="";2!==this.Uu&&(gc=le.YBd(Fa.xda,this.$.xa));gc=le.TYe(gc,Fa.Y4b);1!==this.Uu&&2===this.Uu&&(this.hGe=Fa.Y4b);
this.oLb(!1,!1);this.initializeAndShow(Mb.title,this.i$e,gc);this.rTd();this.Mpj();this.yNb();d.ULS.sendTraceTag(537155778,0,50,"InsertPivotTableDialog.InitAndShow completed.")}ZCj(Fa,Mb){let gc=!1;Fa=({Xgc:gc}=(new xe(Mb)).P3a(Fa)).returnValue;return!!Fa&&Fa.D4&&!gc}yNb(){this.zZa.disabled=this.Fdh()}rTd(){this.tQ.ra(w.a.change,this.Mxa,this.Olc);this.tQ.ra(w.a.change,this.J$,this.Olc);this.tQ.ra(w.a.Fd,this.dSa,this.CCf);this.tQ.ra(w.a.Fd,this.destinationRange,this.vvf);this.FDg(this.iu);this.yAa=
!0}Zzc(){this.yAa&&(this.tQ.Ba(w.a.change,this.Mxa,this.Olc),this.tQ.Ba(w.a.change,this.J$,this.Olc),this.tQ.Ba(w.a.Fd,this.dSa,this.CCf),this.tQ.Ba(w.a.Fd,this.destinationRange,this.vvf),this.U$i(this.iu),this.yAa=!1)}Mpj(){2===this.Uu?this.destinationRange.focus():this.dSa.focus()}I6f(){const Fa=new ld.a(this.destinationRange),Mb=new Xc.a(this.J$,!1);this.wUd=new Cc(Fa,Mb);this.tTd(this.wUd)}tbg(){this.dXd(this.wUd)}hn(){super.hn();d.ULS.sendTraceTag(537155777,0,50,"InsertPivotTableDialog.InitializeDialogElements");
this.dSa=document.getElementById(le.mxc);this.Mxa=document.getElementById(le.hrf);this.J$=document.getElementById(le.k9c);this.destinationRange=document.getElementById(le.X4b);switch(this.Uu){case 0:case 2:this.destinationRange.value?le.z_f(this.J$,this.Mxa):(this.destinationRange.disabled=!0,le.z_f(this.Mxa,this.J$));Kb.k(this.$.pg)&&(this.Mxa.checked=!1,this.Mxa.disabled=!0,this.destinationRange.value="",this.J$.checked=!0);if(2===this.Uu){this.dSa.disabled=!0;var Fa=document.getElementById(le.Oah);
Fa.style.visibility="hidden";Fa.style.display="none"}break;case 1:this.destinationRange.disabled=!0,this.Mxa.disabled=!0,this.J$.disabled=!0,Fa=document.getElementById(le.oXi),Fa.style.visibility="hidden",Fa.style.display="none"}}Bai(Fa,Mb){d.ULS.sendTraceTag(537155744,0,50,"InsertPivotTableDialog.InitiateInsertPivotTableOperation");const gc=this.$.oa.va;let Qc=1;const Sc=gc.Sb(),ud=Y.o(S.g(this.$).ha.sa.activeCell,this.$);let Zd=null,ne=null;switch(this.Uu){case 0:Qc=132;Zd=(Rd,ie,Ae)=>Od(gc,Fa,
Mb,Ra.b(Rd,this.Hzd),ie,Ae,null,Sc);ne=()=>new he(Fa,Mb);break;case 2:Qc=219;Zd=(Rd,ie,Ae)=>Qd(gc,ud,Mb,!1,Ra.b(Rd,this.Hzd),ie,Ae,null,Sc);break;case 1:Qc=219,Zd=(Rd,ie,Ae)=>Qd(gc,ud,Fa,!0,Ra.b(Rd,this.Hzd),ie,Ae,null,Sc)}Db.a(this.$.userOperationManager,Zd,Rd=>new Ja.a(Qc,0,Rd,void 0,ne),null)}JLh(){let Fa=0;switch(this.Uu){case 0:Fa=65;break;case 1:Fa=2156;break;case 2:Fa=2152}return new Dd(X.a.instance.ga(Fa),Hb.ag)}Bpj(){const Fa=this.$.da.za(16);Fa&&Fa.Ewc(!1,null,!0)}oLb(Fa,Mb){const gc=!Fa,
Qc=this.$.da.za(183);Qc&&Qc.R2f(gc,Mb);Fa&&this.gridView.Df&&this.gridView.Df.Wl(B.a.jQ)}set bpb(Fa){super.bpb=Fa}set cy(Fa){super.cy=Fa}static TYe(Fa,Mb){const gc=!Mb;return{[le.mxc]:Fa,[le.X4b]:Mb,[le.hrf]:gc,[le.k9c]:!gc}}static z_f(Fa,Mb){Fa.tabIndex=le.UBh;Mb.tabIndex=le.ICi}static YBd(Fa,Mb){let gc,Qc;Fa=Fa.startsWith("=")?Fa.substring(1,Fa.length):Fa;({sheetName:gc,range:Qc}=Y.Z(Fa,Mb)).returnValue&&Qc&&(gc||(gc=Mb.pa.name),Fa=Y.x(Qc,gc,!1,!0));return Fa}static Hdh(Fa){return Lb.a.Aq(Fa)}static Gdh(Fa,
Mb){return Fa&&Lb.a.Aq(Mb)}}le.FJe="";le.UBh=0;le.ICi=-1;le.mxc="sourceRange";le.X4b="destinationRange";le.hrf="newWorksheet";le.k9c="existingWorksheet";le.Oah="DataSourceDiv";le.oXi="PivotDestinationDiv";Object(b.a)(le,"InsertPivotTableDialog",od.a,[]);class Je{constructor(Fa){this.kjd=!1;this.m9=null;this.$=Fa;this.gridView=S.g(Fa);cd.a.instance.Wb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Mb=>{this.m9=Mb;Mb.isFeatureEnabled(Je.q8e,!1).then(gc=>this.kjd=gc);Mb.gma(Je.q8e,
gc=>{this.kjd=gc.isEnabled})})}Nc(){return!1}executeCommand(Fa,Mb,gc){var Qc;Fa=R.TaskExtensions.fk();const Sc=Mb.command;let ud;const Zd=new yc.a;Mb=this.gridView.ha.sa;switch(Sc){case 2137617149:Fa=Qb.EwaSettings.isChangeGateEnabled("OfficeVSO:6557360_PTPSFixMinifyBug")?null!==(Qc=gc.jjg)&&void 0!==Qc?Qc:Mb.selectedRanges:"StartingRanges"in gc?Array.isArray(gc.StartingRanges)?gc.StartingRanges:null:Mb.selectedRanges;this.iUh(Fa,Zd);if(ab.a.fdf(this.$)&&this.kjd){const ie=new yc.a;Zd.task.Uo(Ae=>
{gc.SourceSelection=Tb.b(Ae)&&Ae.result&&Ae.result.xda?Ae.result.xda:"";return this.$.ud(-1444574190,0,0,gc).continueWith(Se=>{Tb.b(Se)&&Se.result||(ud=new le(this.$,Sc),ud.pdc(Ae.result));ie.setResult(!0)})});Fa=ie.task}else ud=new le(this.$,Sc),Fa=Zd.task.continueWith(()=>{ud.pdc(Zd.task.result)});break;case -1128516639:const ne=this.$.oa.va.Sb(),Rd=Y.o(Mb.activeCell,this.$);Qc=(ie,Ae,Se)=>Nd(this.$.oa.va,Rd,Ra.b(ie,Ff=>{this.Wwf(Ff,Zd,!1)}),Ra.a(Ae,()=>{Je.Vwf(Zd,this.$)}),Se,null,ne);Qc=Qb.EwaSettings.dc()?
new Ja.a(554,0,Qc,88):new pd.a(554,0,Qc,24);Qc.Xma(()=>!0);this.$.userOperationManager.Ub(Qc,null);ud=new le(this.$,Sc);Fa=Zd.task.continueWith(()=>{ud.pdc(Zd.task.result)});break;case -63037693:Qc=new Rb;if(Mb=this.gridView.Db.fp(Mb.activeCell))Mb=yb.Range.Uc(Mb.XTf+1,Mb.left),Qc.Y4b=Y.h(Mb,this.$,!0,void 0,!0);Zd.setResult(Qc);ud=new le(this.$,Sc);Fa=Zd.task.continueWith(()=>{ud.pdc(Zd.task.result)})}return Fa}Wwf(Fa,Mb,gc){const Qc=Fa.Result,Sc=new Rb;if(gc||Qc){const ud=this.gridView.ha.sa.wg;
Z.a(Fa)?ud&&(Sc.xda=this.gridView.ha.e1e(!0)):(Sc.xda=Qc,ud&&gc&&this.Ejh()&&!this.gridView.Db.Yj(this.gridView.ha.sa.Wc)&&(Sc.Y4b=this.gridView.ha.zbd(!0,!0)))}else if(Fa=this.gridView.Db.fp(this.gridView.ha.sa.activeCell))Sc.xda=Fa.dataSource;Mb.setResult(Sc)}Ejh(){var Fa=this.gridView.ha.sa.activeCell;Fa=new yb.Range(Fa.top,Fa.left,Fa.top+1,Fa.left+1,!1,!1);Fa=this.gridView.mk("InsertPivotTableCommandHandler.EmptySquareAdjToActiveCell",Fa);try{for(Fa.$$rst();Fa.$$mn();)if(Fa.$$cu().text)return!1}finally{Fa&&
Fa.dispose()}return!0}iUh(Fa,Mb){if(1!==Fa.length)Mb.setResult(Object(db.a)(new Rb,{xda:""}));else{Fa=Fa[0];const gc=this.gridView.Db.Yj(Fa);if(gc)Mb.setResult(Object(db.a)(new Rb,{xda:gc.name,sourceRange:gc.usedRange}));else{const Qc=this.$.oa.va.Sb(),Sc=Y.o(Fa,this.$),ud=Y.v(Fa,this.$);Fa=(Zd,ne,Rd)=>{const ie=Ae=>Ae(this.$.oa.va,ud,Sc,Ra.b(Zd,Se=>{this.Wwf(Se,Mb,!0)}),Ra.a(ne,()=>{Je.Vwf(Mb,this.$)}),Rd,null,Qc);return ea.GetServiceTaskFactory.Ra(this.$.da,482,483,1).Uo(Ae=>{Tb.b(Ae)&&ie(Ae.result.getExpandedRangeForPivotTable)})};
Fa=Qb.EwaSettings.dc()?new Ja.a(511,0,Fa,88):new pd.a(511,0,Fa,24);Fa.Xma(()=>!0);this.$.userOperationManager.Ub(Fa,null)}}}Cc(Fa,Mb){Fa=!1;switch(Mb.command){case -1128516639:case -63037693:case 2137617149:Fa=!0}return Fa}Rc(){return!1}static Vwf(Fa,Mb){d.ULS.sendTraceTag(537155786,0,50,"OnGetExpandedRangeForPivotTableFailedCallback: Failure. failing over to the selected range.");S.g(Mb).ha.sa.wg?Fa.setResult(Object(db.a)(new Rb,{xda:S.g(Mb).ha.Dha})):Fa.setResult(Object(db.a)(new Rb,{xda:""}))}}
Je.q8e="ExcelIdeas";Object(b.a)(Je,"InsertPivotTableCommandHandler",null,[195]);class Fe extends $a.a{constructor(Fa){super(Fa)}yd(){const Fa=ea.GetServiceTaskFactory.create(this.$.da,128,this.la,this.hb);R.TaskExtensions.Aa(R.TaskExtensions.Wd([Fa],this.la),()=>{this.gd([new Je(this.$)])},this.la,3)}static ka(Fa){$a.a.Nd(91,new Fe(Fa))}}Object(b.a)(Fe,"InsertPivotTableCommandHandlerFactory",$a.a,[]);var eb=a(282);class Xb extends eb.a{constructor(Fa,Mb,gc){super(Fa);this.s4f=null;this.kbi=(Qc,Sc)=>
{1===Qc?(Qc=Sc.indices,d.ULS.sendTraceTag(537155741,0,50,`InsertSlicerDialog.ClickedOK: User clicked OK, inserting ${Qc.length} Slicers`),0<Qc.length&&this.Udh(Qc)):d.ULS.sendTraceTag(537155740,0,50,"InsertSlicerDialog.Dismissed: User dismissed the dialog")};this.BKi=Qc=>{this.s4f=Qc.Result;Qc={["id"]:this.oc,["singleDimFields"]:this.s4f};this.initializeAndShow(X.a.instance.ga(2153),this.kbi,Qc)};this.gridView=S.g(Fa);this.sa=this.gridView.ha.sa;this.ha=S.g(Fa).ha;this.pivotTableName=Mb;this.HCd=
gc;S.g(Fa).Db.fp(this.ha.sa.activeCell);d.ULS.sendTraceTag(543511326,0,50,"InsertSlicerDialog.Constructor: User Opened Insert Slicer Dialog");this.Cai()}get oc(){return"InsertSlicerDialog"}Udh(Fa){R.TaskExtensions.Aa(ea.GetServiceTaskFactory.Ra(this.$.da,103,104,0),Mb=>{var gc=Mb.result,Qc=S.g(this.$),Sc=gc.kfb(Qc);if(Sc){var ud=Sc.Fe;Mb=ud.rf.top;ud=ud.rf.left;gc=Sc.OI.x;Sc=Sc.OI.y}else Mb=ud=1,Sc=gc.eKa(Qc),gc=Sc.x,Sc=Sc.y;Qc=0;for(const Zd of Fa)this.lbi(parseInt(Zd,10),Mb,ud,gc+Qc,Sc+Qc),Qc+=
22},this.$.la,8)}lbi(Fa,Mb,gc,Qc,Sc){const ud=new Ja.a(203,0,(Zd,ne,Rd)=>{const ie=this.$.oa.va.Sb();return lb.s(this.$.oa.va,this.HCd,this.pivotTableName,Fa,0,Mb,gc,Qc,Sc,Zd,ne,Rd,ie)},void 0,()=>new Ob.a(this.HCd,this.pivotTableName,Fa,0));this.$.userOperationManager.Ub(ud,null)}Cai(){const Fa=new Ja.a(596,0,(Mb,gc,Qc)=>{const Sc=this.$.oa.va.Sb();return lb.i(this.$.oa.va,this.pivotTableName,this.HCd,Ra.b(Mb,this.BKi),gc,Qc,Sc)},16);this.$.userOperationManager.Ub(Fa,null)}}Object(b.a)(Xb,"InsertSlicerDialog",
eb.a,[]);class oc{constructor(Fa){this.activeCell=this.kc=null;this.$=Fa;this.ha=S.g(this.$).ha}Nc(){return!1}executeCommand(Fa,Mb){Fa=R.TaskExtensions.fk();Mb=Mb.command;this.activeCell=this.ha.sa.activeCell;switch(Mb){case -1924368815:(this.kc=S.g(this.$).Db.fp(this.activeCell))&&!this.kc.isOlap&&new Xb(this.$,this.kc.pivotTableName,this.$.xa.pa.sheetName)}return Fa}Cc(Fa,Mb){Fa=!1;switch(Mb.command){case -1924368815:Fa=!0}return Fa}Rc(){return!1}}Object(b.a)(oc,"InsertSlicerCommandHandler",null,
[195]);class Gc extends $a.a{constructor(Fa){super(Fa)}yd(){this.gd([new oc(this.$)])}static ka(Fa){$a.a.Nd(353,new Gc(Fa))}}Object(b.a)(Gc,"InsertSlicerCommandHandlerFactory",$a.a,[]);var Vc=a(80),P=a(371),Ta=a(550),pb=a(324),Yb=a(31),Ac=a(591),Zc=a(59),id=a(190),gd=a(118);class Ub{constructor(Fa){this.interactiveReportView=Fa}executeCommand(Fa,Mb){return bb.Task.Ta(this.interactiveReportView.refreshSelectedConnection(Mb))}Cc(Fa,Mb){return 32===Fa&&2054778433===Mb.command}Rc(){return!1}Nc(Fa,Mb){return 32===
Fa&&(1588554917===Mb||1891435765===Mb||2054778433===Mb&&!this.interactiveReportView.xgc)}static ka(Fa,Mb){Fa.Ka.P8(new Ub(Mb))}}Object(b.a)(Ub,"InteractiveReportCommandHandler",null,[195]);var Lc=a(127);class hd{constructor(Fa,Mb){this.iframe=document.createElement("iframe");this.iframe.src=Mb;this.iframe.frameBorder="0";this.iframe.scrolling="no";this.iframe.id=Fa;this.cia=Lc.a.instance.Zd(this.iframe);this.cia.ka("load",()=>{InteractiveReportAPI.SetHost(this.contentWindow,Mb)})}get b$(){return this.iframe}get y9e(){return 1}get contentWindow(){return this.iframe.contentWindow}aRa(){}setVisible(Fa){this.iframe&&
this.iframe.style&&(this.iframe.style.visibility=Fa?"visible":"hidden")}dispose(){f.a.Ia(this.cia);this.cia=null}}Object(b.a)(hd,"IFrameContentElement",null,[850,2]);class Kd{constructor(Fa){this.Z4a=document.createElement("img");F.DOMElementExtensions.setVisible(this.Z4a,!0);this.Z4a.setAttribute("style","height: 80%; width: auto");this.H5b=document.createElement("div");this.H5b.id=Fa;this.H5b.appendChild(this.Z4a)}get b$(){return this.H5b}get y9e(){return 7}get contentWindow(){return null}aRa(Fa){this.Z4a&&
(this.Z4a.src="data:image/png;charset=utf-8;base64,"+Fa,F.DOMElementExtensions.setVisible(this.Z4a,!0))}setVisible(Fa){F.DOMElementExtensions.setVisible(this.H5b,Fa)}dispose(){}}Object(b.a)(Kd,"ImageContentElement",null,[850,2]);class Wd{constructor(Fa,Mb,gc,Qc,Sc){this.interactiveReportContent=this.Noc=this.wG=null;this.w$e=!1;this.RXi=()=>{this.interactiveReportView.P9b(this)};this.q7d=Fa;this.hqg=gc;this.$=Sc;this.wG=Qc?new Kd(Mb):new hd(Mb,gc);this.eZ=this.wG.y9e;this.oTa()}get interactiveReportView(){return this.q7d}get Pva(){return this.hqg}get AXj(){return this.$.workbookContext.WorkbookUri}get b$(){return this.wG.b$}get contentWindow(){return this.wG.contentWindow}aRa(Fa){this.wG.aRa(Fa)}oTa(){this.interactiveReportView.isVisible&&
this.b$&&this.b$.style&&(F.DOMElementExtensions.MI(this.b$,this.interactiveReportView.domElement.clientHeight),F.DOMElementExtensions.Dv(this.b$,this.interactiveReportView.domElement.clientWidth))}setVisible(Fa){this.wG.setVisible(Fa)}ikh(){f.a.Ia(this.Noc);this.Noc=pa.a.instance.create(this.RXi,2E3,Pa.a.Mbi)}dispose(){F.DOMElementExtensions.pf(this.wG.b$);f.a.qc([this.Noc,this.wG]);this.q7d=this.wG=this.Noc=null}}Object(b.a)(Wd,"InteractiveReportFrameInfo",null,[2]);class oe{constructor(Fa,Mb){this.fxc=
Fa;this.Y7b=Mb}}Object(b.a)(oe,"InteractiveReportSheetData",null,[]);class We{constructor(){this.$zb=this.cba=this.uzb=!1}}Object(b.a)(We,"SheetVisibilityStateData",null,[]);const Ze=(Fa,Mb,gc,Qc,Sc,ud=null)=>{ud=Fa.Na(1,ud);return z.g(Fa,"GetSessionInformation",ud,Mb,gc,Qc,Sc,4)};var Be=a(42),af=a(57),ff=a(6),Pe=a(41);class Ne extends pb.a{constructor(Fa,Mb,gc,Qc){super(Mb,Fa,!1);this.Xi=this.I0d=null;this.Gvc=new M.a(!0);this.J2=new M.a(!0);this.hIb=this.E0a=this.Usa=null;this.yOb=!1;this.hashCode=
this.wAb=null;this.xzc=!1;this.lSa=null;this.CAb=nc.a.Wa.Nb;this.businessBar=null;this.lOa=(Sc,ud)=>{ud&&ud.Result&&(Sc=ud.Result,Sc.DataConnections&&Sc.DataConnections.DataConnections&&this.QMf(Sc.DataConnections))};this.nf=(Sc,ud)=>{switch(ud.fd.block.state){case 1:case 3:case 5:this.Wma(ud)}};this.Lm=()=>{};this.yo=(Sc,ud)=>{this.k7c();ud.pa&&this.isVisible&&this.Mqi(!ta.j(ud.pa));this.clearCache();this.wQ=!1};this.tN=Sc=>{switch(Sc.Zt){case 1:this.xzc&&this.P9b(this.Xi)}};this.$c=(Sc,ud)=>{ud.$U||
(this.k7c(),Sc=this.$,this.Xsb=Kb.d(Sc.pg),Sc.ea.GBa.getTime()>this.GBa.getTime()&&(this.p1b(),this.GBa=Sc.ea.GBa),this.Cwa&&this.P9b(this.Xi))};this.re=()=>{this.kSa(!1)};this.vN=()=>{this.$.ea.Gla()};this.onKeyDown=Sc=>{Sc=this.$.shortcutKeyManager.Xs(Sc);this.executeRibbonCommand(Sc)};this.Yi=()=>{this.Xi&&this.Xi.oTa()};this.L5=()=>{this.ycc();this.GJ.cba=!0};this.K5=()=>{this.GJ.uzb||this.GJ.$zb||this.rNb();this.GJ.cba=!1};this.Pyf=()=>{this.ycc();this.GJ.cba=!0};this.ey=()=>{this.GJ.uzb||this.GJ.$zb||
this.rNb();this.GJ.cba=!1};this.aBf=()=>{this.GJ.uzb=this.FIb.zK&&this.FIb.ZXi;this.GJ.uzb?this.ycc():this.GJ.cba||this.GJ.$zb||this.rNb()};this.lAf=()=>{switch(Be.a(this.$).state){case 0:case 1:case 2:case 4:this.GJ.uzb||this.GJ.cba||this.rNb();this.GJ.$zb=!1;break;case 5:case 3:case 7:case 8:case 6:this.ycc(),this.GJ.$zb=!0}};this.UJi=(Sc,ud)=>{if(this.aMa(3)||this.Cwa){var Zd=Sc.Result;Sc=this.Cwa;if(null===Zd||void 0===Zd?0:Zd.ReportData)this.hIb=Zd.ReportData;if(Zd&&Zd.DataConnectionsInfo)if(Zd=
Zd.DataConnectionsInfo,1===Zd.DataConnections.length&&Zd.DataConnections[0].StreamingFailed)this.p1b(),this.kSa(!0);else{var ne=!0;this.E0a=Zd.DataSources;for(const Rd of Zd.DataConnections)if(Rd.IsReady||0>Rd.SourceIndex){const ie=Rd.ConnectionName.toLowerCase();this.J2.getItem(ie)||this.J2.add(ie,Rd)}else{ud.ikh();ne=!1;break}ne&&(Sc?this.QMf(Zd):(this.Xi.eZ=4,this.Jeb(ud,null)))}else this.Xi.eZ=1}};this.hLi=Sc=>{Sc&&this.$.ea.zp(Sc.Errors)};this.k5a=new Ac.a(Fa,Fa.ea,Fa.oa.Pk,4,0);this.GBa=Fa.ea.GBa;
this.Xsb=!Fa.jc.refreshConfirmationRequired||Kb.d(Fa.pg);this.oLe=!1;this.domElement.classList.add(Yb.a.t7b);this.domElement.style.overflow="hidden";this.domElement.tabIndex=0;this.kSa(!1);this.Gc.ka("mousedown",this.vN);this.Gc.ka("keydown",this.onKeyDown);Fa.xa.qJ(this.yo);Fa.zb.qJ(this.yo);Fa.zb.Pf(this.re);Fa.xa.Pf(this.re);Fa.EA(this.Yi);Fa.rb.MYb(this.L5);Fa.rb.LYb(this.K5);Fa.Ka.zme(this.Pyf);Fa.Ka.fYa(this.ey);Be.a(Fa).qq(this.lAf);this.Ea.Ks(this.nf);this.Ea.MG(this.Lm);ib.a(Fa).Tme(this.lOa);
Fa.el(this.$c);Qb.EwaSettings.dc()&&this.Ku(this.Yxa);hc.a(Fa).cQ(ff.a.idle).qq(this.tN);this.FIb=gc;this.FIb.mE(this.aBf);this.GJ=new We;this.T_b=Qc;Ub.ka(Fa,this)}get Ea(){return this.k5a}get Je(){return 32}get xgc(){if(this.Cwa){const Fa=this.$0e();return!!Fa&&-1!==Fa.SourceIndex}return!1}get BEj(){this.lSa=this.lSa||new id.a;return this.lSa.token}$6a(){return!0}get Woe(){return this.I0d||(this.I0d=Ne.Y3g(this.$))}get jXb(){return this.$.pa.index.toString()}get iXb(){return this.Gvc.getItem(this.jXb)}get Qbi(){if(Qb.EwaSettings.ma(23)){let Fa=
Vc.a.ZS(this.$.workbookContext.FullDocumentInfo.InteractiveReportsServiceUrl,Ne.Wbi,this.$.workbookContext.FullDocumentInfo.WorkbookPath);Fa=Vc.a.ZS(Fa,Ne.Rbi,Ne.Sbi);Fa=Vc.a.ZS(Fa,Ne.Ibi,this.$.ya.DataCultureTag);return Fa=Vc.a.ZS(Fa,Ne.Tbi,this.$.ya.UICultureTag)}return T.a.current.HN.InteractiveReportServiceUrl}get Cwa(){return this.aMa(5)}dispose(){if(this.$){const Fa=this.$;Fa.xa.SK(this.yo);Fa.zb.SK(this.yo);Fa.zb.zg(this.re);Fa.xa.zg(this.re);Be.a(Fa).Oq(this.lAf);Fa.zD(this.Yi);Fa.rb.Trc(this.L5);
Fa.rb.Rrc(this.K5);Fa.Ka.WPf(this.Pyf);Fa.Ka.NHb(this.ey);this.FIb.SF(this.aBf);this.FIb=null}this.k5a&&(this.k5a.Nq(this.nf),this.k5a.mI(this.Lm));Qb.EwaSettings.dc()&&this.py(this.Yxa);Ne.Oja.includes(this)&&Array.remove(Ne.Oja,this);this.clearCache();f.a.qc([this.lSa,this.k5a,this.Xi]);this.Xi=this.k5a=this.lSa=null;F.DOMElementExtensions.pf(this.domElement);this.Gvc.clear();this.J2.clear();this.T_b=this.businessBar=this.wAb=this.Usa=this.E0a=this.hIb=null;super.dispose()}refreshSelectedConnection(Fa){const Mb=
this.$0e();if(Mb){const gc=Mb.IsEmbedded?-1:Mb.SourceIndex;ib.a(this.$).VGb(Mb.ConnectionName,gc,Fa);return!0}return!1}P9b(Fa){d.ULS.sendTraceTag(537155663,0,15,"InteractiveReportView.GetBootstrapData()");const Mb=this.$,gc=this.hIb;if(af.c(Mb))d.ULS.sendTraceTag(537155662,0,50,"InteractiveReportView.GetBootstrapData: During RenderCachedContent");else if(hc.a(Mb).di.activityName!==ff.a.idle)this.xzc=!0;else{this.xzc=!1;var Qc=(Sc,ud,Zd)=>{var ne=Mb.oa.va.Sb(),Rd=Mb.oa.va;Sc=Ra.b(Sc,this.UJi);var ie=
!!gc;ne=Rd.Na(1,ne);ne.connectionsOnly=ie;return z.g(Rd,"GetInteractiveReportBootstrapData",ne,Sc,ud,Zd,Fa,0)};Qb.EwaSettings.dc()?Mb.userOperationManager.Ub(new Ja.a(512,0,Qc,64),null):Mb.userOperationManager.Ub(new pd.a(512,0,Qc),null)}}$0e(){for(let Fa=0;Fa<this.J2.count;++Fa){const Mb=this.J2.dg(Fa);for(const gc of Mb.SlidesIds)if(gc===this.Usa)return Mb}return null}Tzg(Fa,Mb){this.hashCode=this.Ea.hra(Fa,Mb,this.hashCode)}clearCache(){this.Ea.KPa(this.hashCode);this.hashCode=null}kaf(){this.k7c();
const Fa=this.$.pa;return this.isVisible=!!Fa&&ta.j(Fa)}VAg(){Ne.Oja.includes(this)||Ne.Oja.push(this)}rUg(){f.a.Ia(this.lSa);this.lSa=null}kSa(Fa){this.kaf()&&(this.VAg(),this.rUg(),R.TaskExtensions.Aa(this.Woe,()=>{const Mb=6===this.Woe.status;Mb&&!this.oLe&&(this.Gbi(),this.oLe=!0);this.kaf()&&(this.Xri(Fa||!Mb),Mb||this.r2i(),this.$.Eaa||this.focus())},this.BEj,0))}k7c(){const Fa=this.$.workbookContext.WorkbookFileVersionId;Fa&&(this.wAb||(this.wAb=Fa),this.wAb!==Fa&&this.p1b())}QMf(Fa){this.E0a=
Fa.DataSources;for(const Mb of Fa.DataConnections){Fa=Mb.ConnectionName.toLowerCase();const gc=this.J2.getItem(Fa);gc&&(gc.ConnectionString!==Mb.ConnectionString||new Date(gc.RefreshTimestampUTC)<new Date(Mb.RefreshTimestampUTC))&&(Mb.IsEmbedded&&this.i5i(Mb.SecurityToken),this.B6i(Mb.DataSourceName),this.J2.remove(Fa));this.J2.add(Fa,Mb)}this.aMa(8)&&this.isVisible&&this.Jeb(this.Xi,null)}i5i(Fa){if(this.Cwa){const Mb=Va.AFrameworkApplication.vd.q7a,gc=this.$.ea.sessionId;try{InteractiveReportAPI.Rebind(this.Xi.contentWindow,
this.Xi.Pva,this.E0a,Fa,Mb,gc)}catch(Qc){d.ULS.sendTraceTag(537155657,0,10,`RebindInteractiveReport: Failed to call Rebind: ${Qc.message}`)}}}B6i(Fa){if(this.Cwa){const Mb=Va.AFrameworkApplication.vd.q7a,gc=this.$.ea.sessionId;try{InteractiveReportAPI.Refresh(this.Xi.contentWindow,this.Xi.Pva,0,Fa,Mb,gc)}catch(Qc){d.ULS.sendTraceTag(537155655,0,10,`RefreshInteractiveReport: Failed to call Refresh: ${Qc.message}`)}}}Wma(Fa){if(Fa.fd.block.pa.active){Fa=Fa.fd.block.pe;const Mb=new oe(Fa.SlideId,Fa.FallbackImage);
this.Gvc.add(this.jXb,Mb);this.Xi.interactiveReportContent||(this.Xi.interactiveReportContent=Fa);this.Jeb(this.Xi,Mb)}}Mqi(Fa){if(this.Cwa)try{InteractiveReportAPI.LeaveSlide(this.Xi.contentWindow,this.Xi.Pva)}catch(Mb){d.ULS.sendTraceTag(537155651,0,10,`LeaveInteractiveReport(): Failed to call LeaveSlide: ${Mb.message}`)}this.Usa=null;Fa&&(this.Xi.setVisible(!1),this.$.isEditMode&&this.oFd(!0))}p1b(){f.a.Ia(this.Xi);this.Xi=null;this.J2.clear();this.Gvc.clear();this.hIb=this.E0a=this.Usa=null;this.xzc=
this.yOb=!1;this.wAb=this.$.workbookContext.WorkbookFileVersionId;this.clearCache()}rNb(){if(this.Xi&&this.yOb&&ta.j(this.$.pa))try{InteractiveReportAPI.UnHideWindowedElements(this.Xi.contentWindow,this.Xi.Pva),this.yOb=!1}catch(Fa){d.ULS.sendTraceTag(537155618,0,10,`UnHideInteractiveReport: UnHideWindowedElements failed - ${Fa.message}`)}}ycc(){if(this.Xi&&!this.yOb&&ta.j(this.$.pa))try{InteractiveReportAPI.HideWindowedElements(this.Xi.contentWindow,this.Xi.Pva),this.yOb=!0}catch(Fa){d.ULS.sendTraceTag(537155617,
0,10,`HideInteractiveReport: HideWindowedElements failed - ${Fa.message}`)}}Xri(Fa){const Mb=this.$;if(this.Xi)this.rNb(),this.Xi.oTa(),this.Xi.setVisible(!0);else{try{InteractiveReportAPI.ClearState()}catch(ud){}const Qc=this.domElement.id+"_irframe";var gc=document.getElementById(Qc);gc&&this.domElement.removeChild(gc);gc=Mb.jc;Fa=Fa||!(gc.allowFiltering&&gc.allowSorting&&gc.allowInteractivity);let Sc=this.Qbi;Sc&&(gc.allowHyperlinks||(Sc+=Ne.Kbi),gc.inEmbedView&&(Sc+=Ne.Lbi),gc.isBiPreviewOverride&&
(Sc+=Ne.Hbi));this.Xi=new Wd(this,Qc,Sc,Fa||!this.Xsb,Mb);this.domElement.appendChild(this.Xi.b$);Fa||this.Xsb||(this.Xi.eZ=8)}(this.Cwa||this.aMa(1)||this.aMa(7))&&this.Jeb(this.Xi,this.iXb);this.Tzg(Mb.pa,Zc.a.G4b)}nAe(Fa){Fa.eZ=2;ib.a(this.$).wx(!0,Mb=>{Fa.eZ=8;Mb&&(this.Xsb=!0,this.p1b(),this.kSa(!1))})}nUi(Fa){var Mb=this.J2.count;const gc=Array(Mb);for(var Qc=0;Qc<Mb;++Qc){var Sc=this.J2.dg(Qc);const ud={};ud.Name=Sc.ConnectionName;ud.qYj=Sc.ConnectionString;ud.SecurityToken=Sc.SecurityToken;
ud.DataSourceName=Sc.DataSourceName;ud.xYj=0>Sc.SourceIndex&&Sc.IsEmbedded;gc[Qc]=ud}Mb=Va.AFrameworkApplication.vd.q7a;Qc=this.$.ea.sessionId;Sc=this.iXb.fxc;try{InteractiveReportAPI.OpenReport(Fa.contentWindow,Fa.Pva,this.hIb,null,Sc,this.E0a,gc,Fa.AXj,Mb,Qc),this.$.isEditMode&&this.oFd()}catch(ud){d.ULS.sendTraceTag(537155605,0,10,`OnGetBootstrapDataSuccess: Failed to call OpenReport: ${ud.message}`);return}Fa.eZ=5;this.Usa=Sc;this.Jeb(Fa,null)}Jeb(Fa,Mb){switch(Fa.eZ){case 6:this.aRa(this.Xi,
Mb);break;case 1:this.Xsb?(this.P9b(Fa),Fa.eZ=3):this.nAe(Fa);break;case 4:Fa.w$e&&Fa.interactiveReportContent&&this.nUi(Fa);break;case 5:this.FBi(Fa,Mb);break;case 8:this.oYf(Mb);this.nAe(Fa);break;case 7:this.oYf(Mb)}}Gbi(){try{InteractiveReportAPI.RegisterEvent("Initialized",Ne.Pbi),InteractiveReportAPI.RegisterEvent("UserInteractivity",Ne.Ubi),InteractiveReportAPI.RegisterEvent("GetFallbackImage",Ne.Nbi),InteractiveReportAPI.RegisterEvent("HostKeyPressed",Ne.Obi),Qb.EwaSettings.ma(33)&&InteractiveReportAPI.RegisterEvent("UserModifiedPV",
Ne.Jbi)}catch(Fa){}}xOb(Fa){return!!this.Xi&&!!this.Xi.b$&&this.Xi.contentWindow===Fa}yMi(Fa){this.xOb(Fa)&&(this.Xi.w$e=!0,this.aMa(5)?this.Xi.eZ=4:this.aMa(6)&&(this.Xi.eZ=1),this.isVisible&&this.Jeb(this.Xi,this.iXb))}zMi(Fa){this.isVisible&&this.xOb(Fa)&&gd.a(nc.a.Wa,this.CAb)>=Ne.Woi&&this.$.ea.fc&&(this.CAb=nc.a.Wa.Nb,Ze(this.$.oa.va,this.hLi,null,null,null))}wMi(Fa,Mb){if(this.xOb(Fa)){const gc=this.$,Qc=Mb.SessionId;Mb.rYj&&(Fa=(Sc,ud,Zd)=>{var ne=gc.oa.va.Sb(),Rd=gc.oa.va;Sc=Ra.b(Sc);ne=
Rd.Na(9,ne);ne.sessionId=Qc;return z.g(Rd,"InteractiveReportDataWasModified",ne,Sc,ud,Zd,null,0)},Qb.EwaSettings.dc()?gc.userOperationManager.Ub(new Ja.a(513,0,Fa,64),null):gc.userOperationManager.Ub(new pd.a(513,0,Fa),null))}}ULi(Fa,Mb){if(this.xOb(Fa)&&Mb){Fa=[];Mb.CYj&&Fa.push("Control");Mb.DYj&&Fa.push("Meta");Mb.BYj&&Fa.push("Alt");Mb.EYj&&Fa.push("Shift");const gc=document.createEvent("KeyboardEvent");gc.initKeyboardEvent("keypress",!0,!0,null,String.fromCharCode(Mb.zYj),0,Fa.join(" "),!1);
Mb=new Sys.UI.DomEvent(gc);Mb=this.$.shortcutKeyManager.Xs(Mb);this.executeRibbonCommand(Mb)}}executeRibbonCommand(Fa){1461300262!==Fa&&(Fa=new zb.a(Fa,1,1,6,null),this.$.Ka.Mb(Fa))}xMi(Fa){this.xOb(Fa)&&(this.Xi.eZ=6,this.aRa(this.Xi,this.iXb))}oYf(Fa){this.isVisible&&Fa&&Fa.Y7b&&this.Xi.aRa(Fa.Y7b)}aRa(Fa,Mb){if(this.isVisible&&Mb&&Mb.Y7b)try{InteractiveReportAPI.SetFallbackImage(Fa.contentWindow,Fa.Pva,Mb.Y7b)}catch(gc){}}FBi(Fa,Mb){if(this.isVisible){if(Mb&&(!this.Usa||Mb.fxc!==this.Usa)){const gc=
Va.AFrameworkApplication.vd.q7a,Qc=this.$.ea.sessionId;try{this.$.isEditMode&&this.oFd(),InteractiveReportAPI.Navigate(Fa.contentWindow,Fa.Pva,Mb.fxc,gc,Qc)}catch(Sc){d.ULS.sendTraceTag(537155593,0,10,`NavigateToActiveSheetSlide: Failed to call InteractiveReportApi.Navigate: ${Sc.message}`);return}this.Usa=Mb.fxc}this.xGb(!0)}}aMa(Fa){return!!this.Xi&&this.Xi.eZ===Fa}oFd(Fa=!1){this.businessBar?Fa?this.businessBar.removeEntry(19):this.businessBar.Yf(19,null):this.T_b&&R.TaskExtensions.Aa(this.T_b.value,
Mb=>{this.businessBar=Mb=Mb.result;this.T_b=null;Fa?Mb.removeEntry(19):Mb.Yf(19,null)},this.$.la)}static NFa(Fa){if(!Fa.da.za(36)){const Mb=new Ta.a(()=>ea.GetServiceTaskFactory.Ra(Fa.da,5,4,1)),gc=ea.GetServiceTaskFactory.create(Fa.da,168,Fa.la,1);R.TaskExtensions.Aa(gc,()=>{var Qc=Fa.Cf;Qc=new Ne(Fa,Qc.appendChild(Qc.ownerDocument.createElement("div")),gc.result,Mb);Fa.da.Ga(36,Qc)},Fa.la)}}static Jbi(Fa,Mb){Ne.Oja.forEach(gc=>{gc.wMi(Fa,Mb)})}static Pbi(Fa){Ne.Oja.forEach(Mb=>{Mb.yMi(Fa)})}static Ubi(Fa){Ne.Oja.forEach(Mb=>
{Mb.zMi(Fa)})}static Nbi(Fa){Ne.Oja.forEach(Mb=>{Mb.xMi(Fa)})}static Obi(Fa,Mb){Ne.Oja.forEach(gc=>{gc.ULi(Fa,Mb)})}static Y3g(Fa){Fa=Qb.EwaSettings.ma(23)?Ne.h9g(Fa.workbookContext.FullDocumentInfo.InteractiveReportsApiUrl).task:T.a.loadScript(80,4,1,!0);return R.TaskExtensions.Aa(Fa,()=>{try{InteractiveReportAPI.InitScript(Pe.c,Pe.b)}catch(Mb){throw Mb;}},T.a.la)}static h9g(Fa){const Mb=new yc.a;if(!Fa)return d.ULS.sendTraceTag(537155588,0,10,"InteractiveReportView.CreateApiLoadAndInitializeTask: interactive report api url is null"),
Mb.setException(Error.create("apiUrl is null")),Mb;P.a.kKe(Fa,(gc,Qc)=>{Qc.succeeded?Mb.setResult(!0):(Mb.setException(Error.create("Network")),d.ULS.sendTraceTag(537155585,0,10,`InteractiveReportView.CreateApiLoadAndInitializeTask: script ${Fa} failed to load successfully`))},4,!0);return Mb}}Ne.Kbi="&EnableHyperlinks=false";Ne.Lbi="&EmbeddedView=true";Ne.Hbi="&BIPreview=true";Ne.Wbi="WORKBOOKURL";Ne.Rbi="ServiceName";Ne.Sbi="ExcelServices";Ne.Ibi="culture";Ne.Tbi="uiculture";Ne.Woi=3E4;Ne.Oja=[];
Object(b.a)(Ne,"InteractiveReportView",pb.a,[]);var se=a(114),Wa=a(975),Sb=a(208),wc=a(81);class Uc extends se.a{constructor(Fa,Mb){super(Fa,Mb)}execute(Fa){const Mb=Object(e.a)(7,Fa.Ae),gc=T.a.current.HN;Fa.activityState[wc.a.WL]=wc.a.D8a;Fa.activityState[wc.a.z1]=Uc.u5g(Mb,gc.OfferPowerBiTrialUrl,gc.OfferPowerBiTrialCompleteSignUpParameter);Fa.activityState[wc.a.GSc]=!0;Mb.Xk.Ky("PowerBiTrial");return 3}static u5g(Fa,Mb,gc){Fa=new Sys.StringBuilder(Fa.isEditMode?Fa.workbookContext.FullDocumentInfo.HostEditUrl:
Fa.workbookContext.FullDocumentInfo.HostViewUrl);Sb.a.Zg(Fa,Wa.a.J1i,"1");Fa=encodeURIComponent(Fa.toString());return`${Mb}&${"ru"}=${gc}${encodeURIComponent(`?${"returnUrl"}=${Fa}`)}`}}Object(b.a)(Uc,"OfferPowerBiTrialActivity",se.a,[]);class ob extends ma.a{constructor(){super();this.Fb()}create(){this.qb(new Uc(ff.a.JSd,ff.a.UZ))}static ka(Fa){Fa.da.Ga(79,new ob)}}Object(b.a)(ob,"OfferPowerBiTrialFactory",ma.a,[]);var Zb=a(1283),Bc=a(77),bd=a(58),Ed=a(579);const ge=(Fa,Mb,gc,Qc,Sc,ud,Zd,ne=null)=>
{ne=Fa.Na(41,ne);ne.activeCell=Mb;ne.showDrillInIndicator=gc;return z.g(Fa,"PivotTableShowExpandButton",ne,Qc,Sc,ud,Zd,0)},be=(Fa,Mb,gc,Qc,Sc,ud,Zd=null)=>{Zd=Fa.Na(41,Zd);Zd.activeCell=Mb;return z.g(Fa,"PivotTableShowDetails",Zd,gc,Qc,Sc,ud,0)},qe=(Fa,Mb,gc,Qc,Sc,ud,Zd,ne,Rd,ie=null)=>{ie=Fa.Na(41,ie);ie.activeCell=Mb;ie.option=gc;ie.userInputText=Qc;ie.userInputInt=Sc;return z.g(Fa,"PivotTableSettingsPaneOperations",ie,ud,Zd,ne,Rd,0)};class ze{constructor(Fa){this.activeCell=this.kc=null;this.iRi=
Mb=>{Z.a(Mb)||((Mb=this.$.xa.getItemByName(Mb.Result.toString()))&&Mb.activate(),Mb=document.querySelector(".ewa-stb-tabs .tab-active"),this.fMj(Mb))};this.SKi=Mb=>{Mb&&!ic.a.rg(Mb.Errors)&&this.Srd(Mb.Result)};this.RKi=()=>{};this.UKi=Mb=>{Mb&&!ic.a.rg(Mb.Errors)&&this.Trd(Mb.Result)};this.TKi=()=>{};this.QKi=(Mb,gc)=>{Mb&&!ic.a.rg(Mb.Errors)&&this.Ord(Mb.Result,gc)};this.PKi=()=>{};this.$=Fa;this.ha=S.g(this.$).ha}Nc(){return!1}executeCommand(Fa,Mb,gc){Fa=R.TaskExtensions.fk();const Qc=Mb.command,
Sc=this.$.oa.va;let ud=null,Zd=1;const ne=this.$.oa.va.Sb();this.activeCell=Y.o(this.ha.sa.activeCell,this.$);this.kc=S.g(this.$).Db.fp(this.ha.sa.activeCell);switch(Qc){case 498319061:d.ULS.sendTraceTag(537154699,0,50,"PivotCommand.ExecuteCommand: PivotTableShowExpandButton is triggered");if(!this.kc)return Fa;ud=(Rd,ie,Ae)=>ge(Sc,this.activeCell,!this.kc.showDrillIndicators,Rd,ie,Ae,null,ne);Zd=218;break;case 1529441790:R.TaskExtensions.Aa(ea.GetServiceTaskFactory.Ra(this.$.da,441,442,0),Rd=>{(Rd=
Rd.result)&&Rd.Izj()},this.$.la,3);break;case -1556797033:this.kc&&this.Eed(this.SKi,this.RKi);break;case -1611233597:this.kc&&this.Eed(this.UKi,this.TKi);break;case 786260386:this.kc&&(gc=Number.parseInvariant(gc.MenuItemId),this.Eed(this.QKi,this.PKi,gc));break;case 1771091375:this.showDetails();break;default:Fa=Wb.a(Qc)}ud&&(Fa=Db.a(this.$.userOperationManager,ud,Rd=>new Ja.a(Zd,0,Rd,void 0,null),Mb));return Fa}Cc(Fa,Mb){Fa=!1;switch(Mb.command){case 498319061:case 1529441790:case -1556797033:case 786260386:case -1611233597:Fa=
!0;break;case 1771091375:Fa=Qb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)}return Fa}Rc(){return!1}dispose(){this.$=null}showDetails(){Db.a(this.$.userOperationManager,(Fa,Mb,gc)=>be(this.$.oa.va,this.activeCell,Ra.b(Fa,this.iRi),Mb,gc,null),Fa=>new Ja.a(262,0,Fa,void 0,null),null)}fMj(Fa){const Mb=cd.a.instance.Wb("Common.ISystemInitiatedFeedback");Mb&&Fa?(Mb.execute(gc=>{gc.logActivity("TeachingUIForShowDetails",null)}),d.ULS.sendTraceTag(523613786,0,50,
"TeachingUIForShowDetails triggered an LPP activity")):d.ULS.sendTraceTag(523613787,0,15,"TeachingUIForShowDetails failed to get a sifFuture")}Eed(Fa,Mb,gc=0){this.$.userOperationManager.Ub(new Ja.a(1016,0,(Qc,Sc,ud)=>z.q(this.$.oa.va,this.activeCell,this.kc.externalSourceIndex,this.kc.pivotTableName,this.$.domElement.id,this.$.isChromeRtl,this.$.workbookContext.NovMode,Ra.b(Qc,Fa),Ra.a(Sc,Mb),ud,0!==gc?gc:null,null,!0),16),null)}Srd(Fa){if(this.oqd(Fa))if(this.pqd(Fa)){var Mb=Fa.PivotFields[0];if(this.kqd(Mb)){var gc=
{};gc.FieldId=Mb.IdString;gc.Location=this.activeCell;gc.DataSourceIndex=this.kc.externalSourceIndex;gc.SelectedFieldIndex=Mb.SortByValueIndex;var Qc=Mb.DisplayString;Qc.length>Zb.n&&(Qc=Qc.substring(0,Zb.n)+"...");gc.ColumnName=A.a.Eg(Qc);gc.SortAscend=Mb.IsSortedAscending&&Mb.IsSortedByValue;Fa=Object(db.a)(new Ed.a,{pivotName:this.kc.pivotTableName,LLb:gc,Zsa:this.Via(Fa.PivotDataItems,!1),$sa:this.Via(Fa.PivotDataItems,!0)});this.$.ud(-1681601147,Bc.a.Eb,0,{["launchSortByValueDialogCommandData"]:Fa})}else this.oj(157,
"AutoFilterSortByValueIncorrectSelection")}else this.oj(755,"SortByValueNoDataFields")}Trd(Fa){if(this.oqd(Fa))if(this.pqd(Fa)){var Mb=Fa.PivotFields[0];if(this.kqd(Mb)){var gc={};gc.FilterType=Zb.e;gc.AdvancedFilter=Fa.AdvancedFiltering;gc.Location=this.activeCell;gc.DataSourceIndex=this.kc.externalSourceIndex;gc.MaxCount=Zb.a;gc.Title=Mb.DisplayString;gc.IsPivotFilter=!0;gc.FieldId=Mb.IdString;gc.AnchorType=0;(Mb=Mb.FilterParameter)?(gc.Count=0<Mb.FilterValue?Mb.FilterValue.toString():"",gc.Top=
Mb.IsTopFilter,gc.Type=Mb.FilterType,gc.SelectedFieldIndex=Zb.g(Fa.PivotDataFields,Mb.DataFieldId)):(gc.Count=Zb.b,gc.Top=!0,gc.Type=1,gc.SelectedFieldIndex=Zb.o);Mb=new zb.a(856841605,Bc.a.Eb,this.$.Mc,0,null);var Qc={};Qc.Top10FilterParameters=gc;Qc.PivotName=this.kc.pivotTableName;Qc.DataFieldIds=this.Via(Fa.PivotDataFields,!1);Qc.DataFieldNames=this.Via(Fa.PivotDataFields,!0);Fa={};Fa[Bc.a.Zf]=bd.a.Ac(Qc);this.$.Ka.Mb(Mb,Fa)}}else this.oj(248,"ValueFilterNoDataFields")}oqd(Fa){return 1===Fa.PivotFields.length}pqd(Fa){return 0<
Fa.PivotDataFields.length&&0<Fa.PivotDataItems.length}kqd(Fa){return!Fa.IsDataField&&!Fa.IsFieldInPageFilterArea}Ord(Fa,Mb){if(this.oqd(Fa))if(Zb.m(Mb)&&!this.pqd(Fa))this.oj(248,"ValueFilterNoDataFields");else{var gc=Fa.PivotFields[0];if(this.kqd(gc)){var Qc=this.Izh(gc.PivotFilterParameters,Mb),Sc={};Sc.ActiveCompareType=this.oah(Mb);Sc.ShowDataFields=Zb.m(Mb);Sc.FilterType=this.oNh(Mb);Sc.ValueTypeText=Zb.j(Mb);Sc.Location=this.activeCell;Sc.ColumnName=gc.DisplayString;Sc.IsPivotFilter=!0;Sc.IsTimeSlicer=
!1;Sc.NonNumericCaptionFilteringEnabled=gc.IsNonnumericCaptionFilteringEnabled;Sc.FieldId=gc.IdString;Sc.AnchorType=0;Sc.ControlGroupOrder=Zb.h();Sc.ShowWholeDays=gc.IsDateField&&!Zb.m(Mb);Sc.EnabledWholeDays=gc.IsEnabledWholeDays;Sc.WholeDays=gc.IsWholeDays;Sc.MemberProperties=!1;Sc.SelectedFieldIndex=Zb.o;Qc&&(Zb.m(Mb)||gc.IsDataField?(Sc.Value1=Qc.FilterValue1.toString(),Sc.Value2=Qc.FilterValue2.toString(),Zb.m(Mb)&&(Sc.SelectedFieldIndex=Zb.g(Fa.PivotDataFields,Qc.DataFieldId))):(Sc.Value1=Qc.FilterString1,
Sc.Value2=Qc.FilterString2));Mb=new zb.a(-2042011094,Bc.a.Eb,this.$.Mc,0,null);Qc={};Qc.CustomFilterParameters=Sc;Qc.FieldId=gc.IdString;Qc.PivotName=this.kc.pivotTableName;Qc.DataFieldIds=this.Via(Fa.PivotDataFields,!1);Qc.DataFieldNames=this.Via(Fa.PivotDataFields,!0);Fa={};Fa[Bc.a.Zf]=bd.a.Ac(Qc);this.$.Ka.Mb(Mb,Fa)}}}Via(Fa,Mb){const gc=[];for(let Qc=0;Qc<Fa.length;++Qc)Mb?gc.push(Fa[Qc].DisplayString):gc.push(Fa[Qc].IdString);return gc}oah(Fa){switch(Fa){case 4:case 18:case 26:return 0;case 5:case 19:case 62:return 1;
case 6:return 2;case 7:return 3;case 8:return 4;case 9:return 5;case 10:return 6;case 11:return 7;case 12:case 20:case 28:return 8;case 13:case 21:case 64:return 9;case 14:case 22:case 27:return 10;case 15:case 23:case 63:return 11;case 16:case 24:case 29:return 12;case 17:case 25:case 65:return 13}return 14}oNh(Fa){return Zb.j(Fa)?Zb.c:Zb.m(Fa)?Zb.f:Zb.k(Fa)?Zb.d:""}Izh(Fa,Mb){for(let gc=0;gc<Fa.length;++gc)if(Fa[gc].FilterType===Mb)return Fa[gc];return null}oj(Fa,Mb){Fa=ic.a.Yc(1,0,0,Fa,0,0,Mb);
Be.a(this.$).oj(Fa)}}Object(b.a)(ze,"PivotCommandHandler",null,[195,2]);class Ce extends $a.a{constructor(Fa){super(Fa)}yd(){const Fa=ea.GetServiceTaskFactory.create(this.$.da,128,this.la,this.hb);this.$.Qx(()=>{Qb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)?R.TaskExtensions.Aa(R.TaskExtensions.Wd([Fa],this.la),()=>{this.gd([new ze(this.$)])},this.la,3):this.gd([new ze(this.$)])})}static ka(Fa){Fa.da.Ga(345,new Ce(Fa))}}Object(b.a)(Ce,"PivotCommandHandlerFactory",
$a.a,[]);class Ve{constructor(Fa,Mb,gc,Qc,Sc){this.pivotTableName=this.activeCell=null;this.opType=0;this.userInputText=null;this.userInputInt=0;this.activeCell=Fa;this.pivotTableName=Mb;this.opType=gc;this.userInputText=Qc;this.userInputInt=Sc}getActiveCell(){return this.activeCell}}Object(b.a)(Ve,"MacroRecorderPivotTableSettingsPaneOperationsPayload",null,[101]);class we{constructor(){this.jGf=0;this.kGf=null}}Object(b.a)(we,"PivotTableSettingsPaneOperationsUserContext",null,[]);class vc{constructor(){this.onSettingChange=
this.settingsInfo=this.type=null;this.hasLessThanTwoRowFields=this.expandAllByDefault=this.isNativePivotTable=this.isRangeChanged=!1;this.onSaveSectionCollapseState=this.sectionCollapseStates=null;this.needFocusOnFirstElement=!1}}Object(b.a)(vc,"PivotTableSettingsTaskPaneProps",null,[]);class ed{constructor(Fa,Mb){this.$=Fa;this.pivotTableSettingsPaneManager=Mb}AI(Fa){Xa.UISurfaces.Lj().then(Mb=>{Mb.showTaskPane("PivotTableSettingsTaskPane",this.Xv(null,Fa,!1,!1,!1,null,!1));return null})}vu(Fa,Mb,
gc,Qc,Sc,ud,Zd){Xa.UISurfaces.Lj().then(ne=>{ne.updateTaskPane("PivotTableSettingsTaskPane",this.Xv(Fa,Mb,gc,Qc,Sc,ud,Zd));return null})}PM(){Xa.UISurfaces.Lj().then(Fa=>{Fa.hideTaskPane("PivotTableSettingsTaskPane",2);return null})}Xv(Fa,Mb,gc,Qc,Sc,ud,Zd){Fa=Object(db.a)(new vc,{type:"PivotTableSettingsTaskPaneProps",settingsInfo:Fa,isRangeChanged:gc,isNativePivotTable:Qc,expandAllByDefault:!0,hasLessThanTwoRowFields:Sc,sectionCollapseStates:this.pivotTableSettingsPaneManager.sectionCollapseStates,
needFocusOnFirstElement:Zd,onSaveSectionCollapseState:(ne,Rd)=>{this.pivotTableSettingsPaneManager.onSaveSectionCollapseState(ne,Rd)},onSettingChange:(ne,Rd,ie)=>{this.pivotTableSettingsPaneManager.QOi(ne,Rd,ie,ud)}});if(ab.a.Ad(this.$))return Object(db.a)(new gb.a,{contentProps:Fa,onOpen:()=>{this.pivotTableSettingsPaneManager.fy()},onClose:()=>{this.pivotTableSettingsPaneManager.qB()},onManualClose:()=>{this.pivotTableSettingsPaneManager.iAd()},title:X.a.instance.ga(1076),width:320,enableResize:!0,
minResizeWidth:320,maxResizeWidth:900});Mb=Object(db.a)(new Ha.a,{type:"ExcelLegacyTaskPaneProps",container:Mb,paneProps:Fa});return Object(db.a)(new gb.a,{contentProps:Mb,onOpen:()=>{this.pivotTableSettingsPaneManager.fy()}})}}Object(b.a)(ed,"PivotTableSettingsReactTaskPane",null,[845]);class Id{constructor(){this.pivotTableName=null;this.rwGrandTotalOn=this.colGrandTotalOn=!1;this.indentIncrement=0;this.displayNullString=this.displayErrorString=this.showItemsWithNoDataOnCol=this.showItemsWithNoDataOnRw=
this.showDrillIndicators=this.autoFormatOnUpdate=!1;this.nullString=this.errorString=null;this.refreshOnLoad=this.saveSourceDataWithFile=!1;this.slicerConnections=this.altTextSummary=this.altText=null}}Object(b.a)(Id,"PivotTableSettingsInfo",null,[]);class Ld{constructor(){this.enabled=!1;this.caption=this.sheet=this.name=null}}Object(b.a)(Ld,"SlicerConnectionItem",null,[]);class ce{constructor(Fa){this.Goc=this.IFb=this.pivotTableSettingsTaskPane=null;this.Ef=!1;this.uca="";this.Lya=!1;this.OHf=
0;this.B2=this.Wla=this.N3b=this.NHf=null;this.Qr=this.KNa=!1;this.ROi=(Mb,gc)=>{if(Z.a(Mb)){const Qc=Mb.Errors[0].Description;Mb=Mb.Errors[0].MessageId;const Sc=gc.jGf;gc=gc.kGf;let ud=this.fja();if(!ud||gc!==ud.mca)if(this.Wla&&gc===this.Wla.mca)ud=this.Wla;else{d.ULS.sendTraceTag(537154689,0,50,`OnPivotTableSettingsChanged Cannot Find PivotTable for opType: ${Sc}`);return}switch(Sc){case 1:ud.pivotTableName=this.uca;break;case 2:ud.rwGrandTotalOn=this.Lya;break;case 3:ud.colGrandTotalOn=this.Lya;
break;case 12:ud.errorString=this.uca;break;case 13:ud.nullString=this.uca;break;case 14:ud.saveSourceDataWithFile=this.Lya;break;case 15:ud.refreshOnLoad=this.Lya;break;case 16:ud.altText=this.uca;break;case 17:ud.altTextSummary=this.uca;break;case 20:ud.indentIncrement=this.OHf}d.ULS.sendTraceTag(537154688,0,50,`OnPivotTableSettingsChangedSuccessCallback encounters error ${Mb} ${Qc} for opType: ${Sc}`);this.updateTaskPane(this.fja())}};this.oEb=()=>{this.hideTaskPane(!0)};this.ila=()=>{const Mb=
this.gridView.inRangePicker||this.gridView.xi||!!(this.ha.Je&470);ab.a.Ad(this.$)?(this.lp()&&!Mb&&this.Wbg(),this.eBc()):this.Ef&&!Mb&&(this.Wbg(),this.B2!==this.Wla&&this.B2&&this.updateTaskPane(this.fja(),!0))};this.Jq=()=>{ab.a.Ad(this.$)?(this.lp()&&(this.B2=this.fja()),this.eBc()):this.Ef&&(this.B2=this.fja(),this.updateTaskPane(this.B2))};this.$=Fa;this.gridView=S.g(this.$);this.Q$h(Fa);this.ha=this.gridView.ha;this.ha.pJ(this.ila);this.gridView.hC(this.ila);this.gridView.aT(this.Jq);this.SL=
Array(6);for(Fa=0;Fa<this.SL.length;Fa++)this.SL[Fa]=!1}get sectionCollapseStates(){return this.SL}get DYa(){return this.$.jc.R1(4128)&&this.EYa}get EYa(){const Fa=new cc.a(this.$.xa);return this.$.isEditMode&&Fa.Ud(8192)||!Fa.li}Izj(){if(ab.a.Ad(this.$))this.Ef?(this.Qr=!1,this.hideTaskPane(!0)):(this.Qr=!0,this.showTaskPane(!0)),this.$.qf();else if(this.pivotTableSettingsTaskPane)this.pivotTableSettingsTaskPane.ig(!this.Ef),this.Ef?this.hideTaskPane(!0):this.showTaskPane(!0);else{const Fa=ea.GetServiceTaskFactory.Ra(this.$.da,
346,347,0),Mb=Ua.a(this.$);R.TaskExtensions.Aa(R.TaskExtensions.Wd([Fa,Mb],this.$.la),()=>{this.pivotTableSettingsTaskPane=Fa.result;Mb.result.uQ(this.pivotTableSettingsTaskPane);this.z5();this.pivotTableSettingsTaskPane.ig(!0);this.showTaskPane(!0)},this.$.la,3)}}onSaveSectionCollapseState(Fa,Mb){this.SL&&0<=Fa&&Fa<this.SL.length&&(this.SL[Fa]=Mb)}QOi(Fa,Mb,gc,Qc){let Sc=this.N3b,ud=this.B2;if(!ud||Qc!==ud.mca)if(this.Wla&&Qc===this.Wla.mca)ud=this.Wla,Sc=this.NHf;else{d.ULS.sendTraceTag(537154690,
0,50,`OnPivotTableSettingsChanged Cannot Find PivotTable for opType: ${Fa}`);return}const Zd=()=>new Ve(Sc,ud.pivotTableName,Fa,Mb,gc);switch(Fa){case 1:this.uca=ud.pivotTableName;Mb=255<Mb.length?Mb.substring(0,255):Mb;ud.pivotTableName=Mb;break;case 2:this.Lya=ud.rwGrandTotalOn;ud.rwGrandTotalOn=!!gc;break;case 3:this.Lya=ud.colGrandTotalOn;ud.colGrandTotalOn=!!gc;break;case 6:ud.autoFormatOnUpdate=!!gc;break;case 7:ud.showDrillIndicators=!!gc;break;case 8:ud.showItemsWithNoDataOnRw=!!gc;break;
case 9:ud.showItemsWithNoDataOnCol=!!gc;break;case 10:ud.displayErrorString=!!gc;break;case 11:ud.displayNullString=!!gc;break;case 12:this.uca=ud.errorString;ud.errorString=Mb;break;case 13:this.uca=ud.nullString;ud.nullString=Mb;break;case 14:this.Lya=ud.saveSourceDataWithFile;ud.saveSourceDataWithFile=!!gc;break;case 15:this.Lya=ud.refreshOnLoad;ud.refreshOnLoad=!!gc;break;case 16:this.uca=ud.altText;ud.altText=Mb;break;case 17:this.uca=ud.altTextSummary;ud.altTextSummary=Mb;break;case 20:this.OHf=
ud.indentIncrement,ud.indentIncrement=gc}const ne=(Rd,ie,Ae)=>{const Se=new we;Se.jGf=Fa;Se.kGf=Qc;return qe(this.$.oa.va,Sc,Fa,Mb,gc,Ra.b(Rd,this.ROi),ie,Ae,Se)};d.ULS.sendTraceTag(595125196,0,50,`OnPivotTableSettingsChanged for opType: ${Fa}`);Qb.EwaSettings.dc()?this.$.userOperationManager.Ub(new Ja.a(225,0,ne,64,Zd),null):this.$.userOperationManager.Ub(new pd.a(225,0,ne,void 0,Zd),null)}Q$h(Fa){this.IFb=new ed(Fa,this)}z5(){this.Goc=this.pivotTableSettingsTaskPane.pM();this.pivotTableSettingsTaskPane.aM(this.oEb)}dispose(){this.ha.RK(this.ila);
this.gridView.AD(this.ila);this.gridView.QN(this.Jq);this.$=this.gridView=this.ha=null;this.hideTaskPane();this.pivotTableSettingsTaskPane&&(this.pivotTableSettingsTaskPane.RN(this.oEb),this.pivotTableSettingsTaskPane=this.Goc=null);this.SL=this.IFb=null}fy(){this.N3b=Y.o(this.ha.sa.activeCell,this.$);this.B2=this.fja();this.updateTaskPane(this.fja())}qB(){this.hideTaskPane()}iAd(){this.Qr=!1;this.hideTaskPane(!0);this.$.qf()}lp(){return this.DYa&&this.Qr}Zr(){const Fa=S.g(this.$).Db.fp(this.ha.sa.activeCell);
return!(this.ha.Je&470)&&!!Fa&&!Fa.rMa(!0)&&this.Qr}showTaskPane(Fa=!1){Fa&&(this.KNa=!0,d.ULS.sendTraceTag(537154659,0,50,"PivotTable settings pane is opened by the user."));this.Ef=!0;this.IFb.AI(this.Goc)}updateTaskPane(Fa,Mb=!1){if(this.Ef&&Fa&&!Fa.rMa(!0)){var gc=new Id;gc.pivotTableName=Fa.yFd;gc.colGrandTotalOn=Fa.colGrandTotalOn;gc.rwGrandTotalOn=Fa.rwGrandTotalOn;gc.indentIncrement=Fa.indentIncrement;gc.autoFormatOnUpdate=Fa.autoFormatOnUpdate;gc.showDrillIndicators=Fa.showDrillIndicators;
gc.showItemsWithNoDataOnRw=Fa.showItemsWithNoDataOnRw;gc.showItemsWithNoDataOnCol=Fa.showItemsWithNoDataOnCol;gc.displayErrorString=Fa.displayErrorString;gc.errorString=Fa.errorString;gc.displayNullString=Fa.displayNullString;gc.nullString=Fa.nullString;gc.saveSourceDataWithFile=Fa.saveSourceDataWithFile;gc.refreshOnLoad=Fa.refreshOnLoad;gc.altText=Fa.altText;gc.altTextSummary=Fa.altTextSummary;gc.slicerConnections=this.bCj(Fa.slicerConnections);this.IFb.vu(gc,this.Goc,Mb,!Fa.isOlap,!Fa.YK||2>Fa.YK.length,
Fa.mca,this.KNa);this.KNa=!1}}hideTaskPane(Fa=!1){this.Ef=!1;this.IFb.PM();Fa&&d.ULS.sendTraceTag(537154658,0,50,"PivotTable settings pane is closed by the user.")}bCj(Fa){const Mb=new nd.a;if(Fa)for(let gc=0;gc<Fa.length;gc++){const Qc=Fa[gc],Sc=new Ld;Sc.name=Qc.Name;Sc.caption=Qc.Caption;Sc.sheet=Qc.WorksheetName;Sc.enabled=Qc.Enabled||!1;Mb.add(Sc)}return Mb.toArray()}fja(){return this.gridView.Db.fp(this.ha.sa.activeCell)}eBc(){this.lp()&&this.Zr()?this.Ef?this.B2!==this.Wla&&this.B2&&this.updateTaskPane(this.fja(),
!0):this.showTaskPane():this.Ef&&this.hideTaskPane()}Wbg(){this.NHf=this.N3b;this.Wla=this.B2;this.N3b=Y.o(this.ha.sa.activeCell,this.$);this.B2=this.fja()}}Object(b.a)(ce,"PivotTableSettingsPaneManager",null,[827,2]);class la extends ma.a{constructor(Fa){super();this.$=Fa;this.Fb()}create(){this.qb(this.$.da.za(441)||this.$.da.Ga(441,new ce(this.$)))}static ka(Fa){Fa.da.Ga(442,new la(Fa))}}Object(b.a)(la,"PivotTableSettingsPaneManagerFactory",ma.a,[]);class jb{}jb.nqh="ewa-ptsp-pane";jb.mqh="ewa-ptsp-header";
jb.oqh="ewa-ptsp-title";jb.kqh="ewa-ptsp-body";jb.lqh="ewa-ptsp-close-button";Object(b.a)(jb,"CssClassNames",null,[]);const ra=jb.nqh,hb=jb.mqh,Eb="cui-taskPaneTitle "+jb.oqh,fc=jb.kqh,Mc=jb.lqh;class xd extends I.a{constructor(Fa,Mb,gc){super(Fa);this.Bye=this.he=null;this.su=0;this.Qr=!1;this.Ec=(Qc,Sc)=>{Sc.fg||this.ig(!1)};this.$j=()=>{this.ig(!1);this.raiseEvent("PivotTableSettingsTaskPaneClosed");return!0};this.$=Mb;this.taskPaneManager=gc;this.$.kk(this.Ec);this.ha=S.g(this.$).ha;v.a(Mb).Xh(this)}dP(Fa){this.get_events().addHandler("PivotTableSettingsTaskPaneRemoved",
Fa)}qR(Fa){this.get_events().removeHandler("PivotTableSettingsTaskPaneRemoved",Fa)}aM(Fa){this.addHandler("PivotTableSettingsTaskPaneClosed",Fa)}RN(Fa){this.removeHandler("PivotTableSettingsTaskPaneClosed",Fa)}get isVisible(){return super.isVisible}set isVisible(Fa){super.isVisible!==Fa&&(super.isVisible=Fa)}get kf(){return this.isVisible}get $d(){return ia.a.xXi}get Yg(){return 14}get Tk(){return x.a.$Oe}get RM(){return X.a.instance.ga(1076)}get titleText(){return X.a.instance.ga(1076)}get wo(){return 320}get isResizable(){return!0}get mc(){return this.domElement}get height(){return this.taskPaneManager.oO.offsetHeight}get DYa(){return this.$.jc.R1(4128)&&
this.EYa}get EYa(){const Fa=new cc.a(this.$.xa);return this.$.isEditMode&&Fa.Ud(8192)||!Fa.li}BH(){}lp(){return this.DYa&&this.Qr}Zr(){const Fa=S.g(this.$).Db.fp(this.ha.sa.activeCell);return!(this.ha.Je&470)&&!!Fa&&!Fa.rMa(!0)&&this.Qr}dR(){}lj(){}Nj(){}mQ(){return!1}dispose(){this.$&&this.$.zl(this.Ec);this.he&&(D.a.instance.Ba(w.a.click,this.he,this.$j),Na.KeyInputManager.instance.Bv(this.he,this.Bye));this.he=this.taskPaneManager=this.$=null;super.dispose()}hg(Fa,Mb){if(!Mb){Fa=F.DOMElementExtensions.getElementById(this.domElement,
"PivotTableName");if(!Fa&&(Fa=F.DOMElementExtensions.Kl(this.domElement.querySelectorAll(F.DOMElementExtensions.qr)),!Fa))return!1;F.DOMElementExtensions.setFocus(Fa)}return!Mb}kh(Fa){return F.DOMElementExtensions.vf(this.mc,Fa)}ig(Fa){this.Qr=Fa;const Mb=this.taskPaneManager;this.isVisible=Fa;this.taskPaneManager.Pw();const gc=!!this.taskPaneManager.Bg&&14===this.taskPaneManager.Bg.taskPane.Yg;Fa&&0<Mb.$z.length&&(!gc||Mb.isCollapsed)&&Mb.VF(this,!0);this.$.qf()}pM(){const Fa=document.getElementById(this.$.Bb+
B.a.GCd);var Mb=this.ZG();Fa.appendChild(Mb);Mb=Za.b("div","PivotTableSettingsPaneBodyId",fc);Fa.appendChild(Mb);return Mb}ZG(){const Fa=Za.b("div","PivotTableSettingsPaneHeaderId",hb),Mb=Za.b("span","PivotTableSettingsPaneTitleId",Eb);Mb.innerText=this.titleText;this.he=na.a.pb("PivotTableSettingsPaneCloseButtonId",Mc,X.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.he.classList.add(Va.AFrameworkApplication.isRtl?B.a.V$:B.a.W$);D.a.instance.ra(w.a.click,this.he,this.$j);this.Bye=Na.KeyInputManager.instance.ms(this.he,
this.$j,Sa.a.$h);Fa.appendChild(Mb);Fa.appendChild(this.he);return Fa}static ka(Fa,Mb){var gc=Fa.Bb;let Qc=document.getElementById(gc+B.a.GCd);Qc||(Qc=document.createElement("div"),Qc.id=Fa.Bb+B.a.GCd,Qc.classList.add(ra),document.getElementById(gc+B.a.WQ).appendChild(Qc));gc=Fa.da;return gc.za(346)||gc.Ga(346,new xd(Qc,Fa,Mb))}}Object(b.a)(xd,"PivotTableSettingsTaskPane",I.a,[826,2,401,102]);class Hd extends ma.a{constructor(Fa){super();this.eh=this.ri=null;this.$=Fa;this.Fb()}get pD(){this.ri||
(this.ri=R.TaskExtensions.Aa(Ua.a(this.$),Fa=>{this.eh=xd.ka(this.$,Fa.result)},this.la,3));return this.ri}create(){const Fa=ea.GetServiceTaskFactory.create(this.$.da,203,this.la,this.hb),Mb=ea.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb);R.TaskExtensions.Aa(R.TaskExtensions.ts(R.TaskExtensions.Wd([Fa,Mb],this.la),()=>this.pD,this.la),()=>{this.qb(this.eh)},this.la,3)}dispose(){this.eh=this.ri=this.$=null;super.dispose()}static ka(Fa){Fa.da.Ga(347,new Hd(Fa))}}Object(b.a)(Hd,"PivotTableSettingsTaskPaneFactory",
ma.a,[]);class Md extends $a.a{constructor(Fa){super(Fa)}yd(){R.TaskExtensions.Aa(ea.GetServiceTaskFactory.create(this.$.da,472,this.la,this.hb),()=>{const Fa=this.$.da.za(13);this.gd([Fa])},this.$.la,3)}static ka(Fa){$a.a.Nd(78,new Md(Fa))}}Object(b.a)(Md,"BICommandHandlerFactory",$a.a,[]);var ae=a(638),me=a(38),Re=a(815),Xe=a(314),qf=a(428),uf=a(415);class Cf{constructor(Fa,Mb){this.pivotTableName=this.pivotTableId=null;this.pivotTableId=Fa;this.pivotTableName=Mb}}Object(b.a)(Cf,"MacroRecorderPivotTableRefreshedPayload",
null,[101]);var Jf=a(390);class Uf extends Jf.a{constructor(Fa,Mb,gc,Qc,Sc=Jf.a.N4c,ud=null){super(Fa,Mb,gc,Qc,Sc,ud)}get KF(){return 4}get TIb(){return!!(this.flags&64)}}Object(b.a)(Uf,"DepartableRefreshWebMethodOperation",Jf.a,[]);var cg=a(153);class wg extends cg.ErrorDialog{constructor(Fa,Mb){super(Fa,wg.fQ(Mb))}Fo(){super.Fo();this.Kna=String.format(X.a.instance.Xa(7),null)}static fQ(Fa){const Mb=ic.a.Yc(12,1,0,0,0,1243883867,"ConfirmDataRefresh");Mb.Description=Fa;Mb.HelpDescription=X.a.instance.ga(1321);
Mb.HelpTopicId=Re.a.U0c;return Mb}}Object(b.a)(wg,"DataRefreshConfirmationDialog",cg.ErrorDialog,[]);const Vf=(Fa,Mb,gc,Qc,Sc,ud,Zd,ne,Rd)=>{const ie=ne?"RefreshAllDirtyDataSources":"RefreshAll";Rd=Fa.Na(1,Rd);const Ae=Rd.context;Ae.RequestId=gc;Ae.CompleteResponseTimeout=Qc;Rd.periodic=Mb;return z.g(Fa,ie,Rd,Sc,ud,Zd,ne,Mb?8:0)};var Da=a(340);class Fb extends l.a{constructor(Fa){super();this.Boc=null;this.xab=!1;this.Vya=null;this.GGd=!1;this.Qa=new me.a;this.rx=null;this.dug=new Map;this.QOa=new Map;
this.xUb=[];this.Hz=(gc,Qc)=>{2===Qc.Lq?this.QOa.clear():1===Qc.Lq&&this.QOa&&this.QOa.forEach((Sc,ud)=>{Qc.xf==Sc&&this.QOa.delete(ud)})};this.Vbi=gc=>{this.aWc(gc.Ea)};this.xTg=()=>{this.mOd(0);this.MMf(!0,null,!1)};this.LOi=gc=>{gc.RequestId||(this.q$a=null,this.$.ea.zp(gc.Errors))};this.MOi=gc=>{this.q$a=null;gc=Pb.a.lf(gc.data);this.$.ea.zp(gc)};this.tAd=gc=>{this.FAf(gc);(gc.DepartableWebMethodOperationCompleted||gc.Errors&&0<gc.Errors.length)&&this.Qa.raiseEvent("refreshAllCompleted",gc,this)};
this.gLi=gc=>{gc&&!Z.a(gc)&&(!(gc=gc.Result)||1>gc.length||(this.rx&&this.rx.cancel(),this.rx=new ae.a,this.A$f(gc,0,this.rx.token)))};this.fLi=gc=>{d.ULS.sendTraceTag(537163298,306,50,"DataRefreshManager::OnGetSensitivityLabelsFailedCallback");gc=Pb.a.lf(gc.data);this.$.ea.zp(gc)};this.Vc=()=>{this.dld()};this.EF=()=>{Qb.EwaSettings.isChangeGateEnabled("OfficeVSO:6013906_MarkRefreshRangeInvalidWhenCurrentSheetIsChanged")&&this.dld()};this.Y8a=(gc,Qc)=>{const Sc=Qc.fd.block;var ud=Sc.pe.PeriodicRefreshExpiryInSeconds;
void 0!==ud&&this.XZf(ud);ud=S.g(this.$);5===Sc.state&&gc===ud.Ea&&((gc=(gc=ud.pG(Qc.fd.hash))?gc.rf:null)&&!gc.Dd(ud.ha.sa.activeCell)||this.dld())};this.Xc=()=>{this.$.ea.fc||this.clear()};this.$=Fa;this.yCd=-1;this.q$a=null;Fa=S.g(this.$);const Mb=Fa.ha;Mb.lE(this.Vc);Mb.iga(this.Vc);Fa.Ea.jga(this.Y8a);this.$.xa.lra(this.EF);this.$.zb.lra(this.EF);this.$.userOperationManager.Hr(this.Hz);this.aWc(Fa.Ea);this.aWc(Ya.a(this.$).Ea);this.$.da.Za(36,this.Vbi);this.$.ea.jk(this.Xc);Fa=this.$.ya.StartupDelayMultiplierForLabelsOnRefreshOnOpen*
this.$.ya.TimeToWaitForApplyingSensitivityLabels;d.ULS.sendTraceTag(537163332,306,50,`DataRefreshManager async call to UpdateSensitivityLabels after ${Fa} ms.`);pa.a.instance.create(()=>{this.QNb()},Fa,Pa.a.Nah,!0,!0)}Tme(Fa){this.Qa.addHandler("refreshCompleted",Fa)}hne(Fa){this.Qa.addHandler("singleRefreshStarted",Fa)}nQf(Fa){this.Qa.removeHandler("singleRefreshStarted",Fa)}tUc(Fa){this.Qa.addHandler("singleRefreshCompleted",Fa)}RId(Fa){this.Qa.removeHandler("singleRefreshCompleted",Fa)}get xgc(){return!!this.SJa()||
this.wAe()||this.zki()}get eNf(){return this.xUb}get AGd(){return this.dug}get confirmationRequired(){return this.$.jc.refreshConfirmationRequired}Nc(){return!1}executeCommand(Fa,Mb,gc,Qc){Fa=Mb.command;switch(Fa){case -1193102612:this.MMf(!1,Mb,"m_excelWebRenderer_ewaCtl_DataSourceDirtinessButton"===gc.SourceControlId);break;case 2054778433:this.refreshSelected(Mb,Qc);break;default:return Wb.a(Fa)}return bb.Task.Ta(!0)}Cc(Fa,Mb){Fa=!1;switch(Mb.command){case 2054778433:case -1193102612:Fa=!0}return Fa}Rc(){return!1}dispose(){if(this.$){const Fa=
S.g(this.$),Mb=Fa.ha;Mb.nI(this.Vc);Mb.mma(this.Vc);this.$.zb.kza(this.EF);this.$.xa.kza(this.EF);this.$.userOperationManager.Co(this.Hz);Fa.Ea.Nq(this.Y8a);Fa.Ea.Mab(this.Y8a);Ya.a(this.$).Ea.Nq(this.Y8a);this.$.da.za(36)&&this.$.da.za(36).Ea.Nq(this.Y8a);this.$.ea&&this.$.ea.Ik(this.Xc)}this.clear();f.a.qc([this.Boc,this.Qa]);this.$=this.Qa=null;super.dispose()}VGb(Fa,Mb,gc){if(this.$.ea.fc){var Qc=Sc=>{var ud=null;if(this.Vya&&Object(k.a)(aa.PivotTableRange,this.Vya)){const Zd=this.Vya;ud=()=>
new Cf(Zd.mca,Zd.pivotTableName)}ud=this.$.userOperationManager.Ub(new Uf(50,0,(Zd,ne,Rd,ie)=>{var Ae=this.$.oa.va.Sb();Ae.FlightHolder=this.$.ya.FlightHolder;null==Zd&&this.AGd.set(Fa,Ae.ClientRequestId);var Se=this.$.oa.va;ne=Qb.EwaSettings.isChangeGateEnabled("OfficeVSO:7021538_FixDepartedOperationCompleteIndication")?Ra.b(this.t0e(Fa),ne):Ra.b(ne,this.t0e(Fa));Ae=Se.Na(1,Ae);const Ff=Ae.context;Ff.RequestId=Zd;Ff.CompleteResponseTimeout=2E3;Ae.connectionName=Fa;Ae.externalSourceIndex=Mb;Ae.userAadToken=
Sc;return z.g(Se,"Refresh",Ae,ne,Rd,ie,null,0)},68,250,ud),gc);this.QOa.set(Fa,ud);this.qRi(Fa)};if(Qb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)){const Sc=ea.GetServiceTaskFactory.Ra(this.$.da,470,471,0);R.TaskExtensions.Aa(Sc,ud=>{ud.result.oTh(Fa).then(Zd=>{Qc(Zd)},Zd=>{d.ULS.sendTraceTag(520680469,0,10,`DataRefreshManager.RefreshConnection: failed to get power query aad token ${Zd}`)})},this.$.la,3)}else Qc(null)}}wx(Fa,Mb){var gc=null;if(this.confirmationRequired&&
Fa)if(this.xab)Mb(!0);else if(gc=gc||Fb.Gxi,Qb.EwaSettings.wz()){Fa=ic.a.Yc(12,1,0,0,0,1243883867,"ConfirmDataRefresh");Fa.Caption=X.a.instance.Xa(7);Fa.Description=gc;Fa.HelpDescription=X.a.instance.ga(1321);Fa.HelpTopicId=Re.a.U0c;const Qc=new Da.a(this.$,Fa);Qc.cP(()=>{this.xab=2===Qc.returnValue;Mb(this.xab)})}else{const Qc=new wg(this.$,gc);Qc.cP(()=>{Qc.hide();this.xab=2===Qc.returnValue;Mb(this.xab)});Qc.Ff()}else Mb(!0)}SJa(){if(!this.GGd){var Fa=S.g(this.$);Fa=Fa.getRangeInformation(Fa.ha.sa.activeCell);
for(let Mb=0,gc=Fa.length;Mb<gc;++Mb){const Qc=Fa[Mb];if(Object(k.a)(qf.a,Qc)){this.Vya=Qc;break}}this.GGd=!0}return this.Vya}QNb(){var Fa=this.$.oa.va.Sb(),Mb=this.$.oa.va,gc=this.gLi,Qc=this.fLi;Fa=Mb.Na(1,Fa);z.g(Mb,"GetSensitivityLabelsForPowerBIDatasets",Fa,gc,Qc,null,null,4)}H$f(Fa){return this.QOa.has(Fa)?(this.$.userOperationManager.ita(this.QOa.get(Fa)),!0):!1}wAe(){if(Qb.EwaSettings.ma(130)){var Fa=this.$.jc;if(!Fa||Fa.inEmbedView||Fa.inWebPart||Fa.inViewerFromWebPart)return!1;Fa=S.g(this.$);
const Mb=Fa.ha.sa.selectedRanges;for(let gc=0;gc<Mb.length;gc++)if(Fa.Db.Qod(Mb[gc]))return!0}return!1}gAj(){const Fa=ic.a.Yc(1,0,0,1504,0,-853845742,"ErrorConnectingToDataSource");Be.a(this.$).vr([Fa])}MMf(Fa,Mb,gc){if(this.$.ea.fc){this.q9i();if(0<this.$.workbookContext.LegacyConnections.length){const Qc=ic.a.Yc(32,2,1650,1663,0,-73730134,"BB_LegacyConnectionsWarning");Qc.HelpDescription=X.a.instance.ga(1645);Qc.HelpTopicId=Xe.a.Tqi;const Sc=ea.GetServiceTaskFactory.Ra(this.$.da,5,4,0);R.TaskExtensions.Aa(Sc,
()=>{const ud=Sc.result;ud&&ud.Yf(33,Qc)},this.$.la,3)}Fa?(Fa=this.$.oa.va.Sb(),this.q$a=Vf(this.$.oa.va,!0,null,0,Ra.b(this.LOi,this.tAd),this.MOi,null,null,Fa)):this.$.userOperationManager.Ub(new Uf(51,0,(Qc,Sc,ud,Zd)=>{const ne=this.$.oa.va.Sb();ne.FlightHolder=this.$.ya.FlightHolder;let Rd=null;gc&&(Rd={});return Vf(this.$.oa.va,!1,Qc,2E3,Qb.EwaSettings.isChangeGateEnabled("OfficeVSO:7021538_FixDepartedOperationCompleteIndication")?Ra.b(this.tAd,Sc):Ra.b(Sc,this.tAd),ud,Zd,Rd,ne)},68,250,()=>
new uf.a),Mb)}}refreshSelected(Fa,Mb){if(this.$.ea.fc&&ta.i(this.$.pa)&&!this.Vxb()){var gc=this.SJa();if(!this.wAe()||gc&&Object(k.a)(aa.PivotTableRange,gc))gc?this.VGb(this.Vya.J0g,this.Vya.externalSourceIndex,Fa):this.gAj();else{let Qc;Fa=ea.GetServiceTaskFactory.Ra(this.$.da,271,272,Mb.ija());R.TaskExtensions.Aa(Fa,Sc=>{(Qc=Sc.result)&&Qc.refreshLinkedEntitiesInRange()},this.$.la,3)}}}clear(){this.mOd(0);this.xab=!1;this.yCd=-1;Fb.KLc=null;this.q$a&&(Va.AFrameworkApplication.vd.tu(this.q$a.Nt),
this.q$a=null)}zki(){var Fa=!1,Mb=S.g(this.$).ha;2===Mb.Je&&(Fa=Mb.Pa.$b,Mb=(null===Fa||void 0===Fa?0:Fa.floatingObject)?Fa.floatingObject.Tc:null,Fa=Fa.sy&&!!Mb&&!!(Mb.Attributes&4));return Fa}Vxb(){return 2===S.g(this.$).ha.Je}dld(){this.GGd=!1;this.Vya=null}mOd(Fa){let Mb=0<Fa;!Mb||this.$.ea.fc&&this.$.jc.allowPeriodicDataRefresh||(Mb=!1);f.a.Ia(this.Boc);this.Boc=null;Mb&&(this.Boc=pa.a.instance.FE(this.xTg,Fa,Pa.a.Lah))}FAf(Fa){Qb.EwaSettings.isChangeGateEnabled("OfficeVSO:6837645_SensitivityLabelOnRefreshCompleted")?
Fa.RequestId||(this.Qa.raiseEvent("refreshCompleted",Fa,this),this.QNb()):(Fa.RequestId||this.Qa.raiseEvent("refreshCompleted",Fa,this),this.QNb())}t0e(Fa){return Mb=>{var gc;this.FAf(Mb);Mb&&(Mb.DepartableWebMethodOperationCompleted||Mb.Errors&&0<Mb.Errors.length)&&(Array.remove(this.xUb,Fa),Qb.EwaSettings.isChangeGateEnabled("OfficeVSO:6635492_ChangeRefreshResultV2")?(Mb.Result=null!==(gc=Mb.Result)&&void 0!==gc?gc:{},Mb.Result.ConnectionName=Fa):Mb.Result=Fa,this.Qa.raiseEvent("singleRefreshCompleted",
Mb,this))}}qRi(Fa){this.xUb.includes(Fa)||this.xUb.push(Fa);this.Qa.raiseEvent("singleRefreshStarted",Fa,this)}A$f(Fa,Mb,gc){const Qc=ea.GetServiceTaskFactory.Ra(this.$.da,274,275,0);let Sc=!1;gc.kK?d.ULS.sendTraceTag(537163297,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled."):R.TaskExtensions.Aa(Qc,()=>{if(({L5a:Sc}=Qc.result.oWc(Fa,Sc)).returnValue)d.ULS.sendTraceTag(537163293,306,50,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Completed successfully on the ${Mb} attempt.`);
else if(Sc&&3>Mb)if(gc.kK)d.ULS.sendTraceTag(537163296,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled before waiting.");else{var ud=this.$.ya.TimeToWaitForApplyingSensitivityLabels;d.ULS.sendTraceTag(537163295,306,100,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: retry async call to AutoApplyOrRecommendPowerBILabel after ${ud} ms on the ${ud} attempt.`);pa.a.instance.create(()=>{this.A$f(Fa,Mb+1,gc)},ud,Pa.a.Mah,!0,!0)}else d.ULS.sendTraceTag(537163294,
306,50,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: No Sensitivity Labels applied on the ${Mb} attempt.  Not scheduling anymore retries.`)},gc,3)}aWc(Fa){Fa.Ks(this.Y8a);Fa=Fa.WWi;0<Fa&&this.XZf(Fa)}XZf(Fa){const Mb=this.$.ea.Ke;Mb>this.yCd&&(this.yCd=Mb,this.mOd(1E3*Fa))}q9i(){const Fa=ea.GetServiceTaskFactory.Ra(this.$.da,5,4,0);R.TaskExtensions.Aa(Fa,()=>{const Mb=Fa.result;Mb&&Mb.FLa(58)&&Mb.removeEntry(58)},this.$.la,3)}static get Gxi(){return Fb.KLc||(Fb.KLc=X.a.instance.Xa(8)+
"<br /><br />"+X.a.instance.Xa(10))}static ka(Fa){Fa.da.Ga(13,new Fb(Fa))}}Fb.KLc=null;Object(b.a)(Fb,"DataRefreshManager",l.a,[16,195]);class Fc extends $a.a{constructor(Fa){super(Fa)}yd(){R.TaskExtensions.Aa(ea.GetServiceTaskFactory.Ra(this.$.da,470,471,this.hb),Fa=>{this.gd([Fa.result])},this.$.la,3)}static ka(Fa){$a.a.Nd(472,new Fc(Fa))}}Object(b.a)(Fc,"PowerQueryManagerCommandHandlerFactory",$a.a,[]);const jd=(Fa,Mb,gc,Qc,Sc,ud,Zd,ne=null)=>{ne=Fa.Na(1,ne);ne.groupOperation=Mb;ne.groupOperationPayload=
gc;return z.g(Fa,"EditPowerQueryGroup",ne,Qc,Sc,ud,Zd,0)},Ad=(Fa,Mb,gc,Qc,Sc,ud,Zd,ne=null)=>{ne=Fa.Na(1,ne);ne.queryAction=Mb;ne.queryActionPayload=gc;return z.g(Fa,"PowerQueryQueryAction",ne,Qc,Sc,ud,Zd,0)},Ud=(Fa,Mb,gc,Qc,Sc,ud=null)=>{ud=Fa.Na(1,ud);return z.g(Fa,"ReadPowerQueryRoaming",ud,Mb,gc,Qc,Sc,4)};var ue=a(867);class re{constructor(Fa,Mb){this.stateId=0;this.REe=!1;this.b6d=null;this.C8d=!1;this.Q5d=null;this.Uf=()=>{const gc=this.$.ea.to.PowerQueryStateId;d.ULS.sendTraceTag(537154444,
0,50,`PowerQueryManager.OnWorkbookMetadataChanged: powerQueriesStateId: ${gc}, this.stateId: ${this.stateId}`);gc>this.stateId&&this.e2a().continueWith(Qc=>{Qc.result?this.stateId=gc:d.ULS.sendTraceTag(537154443,0,15,"PowerQueryManager.OnWorkbookMetadataChanged failed to update the local state")})};this.Ao=()=>{this.e2a()};this.WRj=gc=>{if(gc&&!Z.a(gc)){gc=gc.Result;if(gc.Queries){this.Z$a.clear();for(var Qc of gc.Queries)try{this.Z$a.add(Qc.Name,Qc)}catch(Sc){d.ULS.sendTraceTag(523534750,0,10,"PowerQueryManager.OnGetQueriesSuccess: more than one query with the same name in queryInfo.")}}this.b6d=
gc.QueryGroups;d.ULS.sendTraceTag(537154441,0,50,`PowerQueryManager.OnGetQueriesSuccess: no. queries: ${this.queries?this.queries.length.toString():"null"}`);if(gc.PowerQueryConnectionsInfo){this.NK.clear();Qc=[];for(const Sc of gc.PowerQueryConnectionsInfo)try{this.NK.add(Sc.QueryName,Sc)}catch(ud){d.ULS.sendTraceTag(523534749,0,10,"PowerQueryManager.OnGetQueriesSuccess: same query with more than one connection."),Qc.push(Sc.QueryName)}Qc.forEach(Sc=>{this.NK.remove(Sc)})}this.Q5d=gc.Formulas;this.REe=
!0}};this.szd=()=>{d.ULS.sendTraceTag(537154439,0,15,"PowerQueryManager.OnGetQueriesFailure")};this.uDf=gc=>{this.Qa.raiseEvent("OnUpdatePowerQueryDataKeySucceeded",gc)};this.PSi=gc=>{this.Qa.raiseEvent("OnUpdatePowerQueryDataFailed",gc)};this.lOa=(gc,Qc)=>{if(Qc&&Qc.Result&&Qc.Result.PowerQueryRefreshChallengeResult){if(!Qc.Result.ConnectionName)throw Error.argumentNull;this.ggj(Qc.Result.PowerQueryRefreshChallengeResult,Qc.Result.ConnectionName)}};this.ggj=(gc,Qc)=>{d.ULS.sendTraceTag(520710282,
0,50,"PowerQueryManager:resolveChallenge: Starting challenge resolve");R.TaskExtensions.Aa(Ud(this.$.oa.va,Sc=>{0<(null===Sc||void 0===Sc?void 0:Sc.Errors.length)||(Sc=Sc.Result,Sc=null===Sc||void 0===Sc?void 0:Sc.find(ud=>ud.K===gc.Kind&&ud.P===gc.Path),d.ULS.sendTraceTag(520710281,0,50,`PowerQueryManager:resolveChallenge: data source connection exists: ${!!Sc}`),Sc&&this.E6i(Qc))},()=>{d.ULS.sendTraceTag(520710280,0,50,"PowerQueryManager:resolveChallenge: Read Roaming failed")},null,null),()=>{},
this.$.la,3)};this.$=Fa;this.eDb=Mb;this.Z$a=new M.a(!1);this.Ptg=new M.a(!1);this.Qa=new me.a;this.$.ea.Lu(this.Uf);this.$.ea.$L(this.Ao);this.$.ea.to&&(this.stateId=this.$.ea.to.PowerQueryStateId);Qb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)&&ib.a(this.$).tUc(this.lOa);cd.a.instance.Wb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(gc=>{gc.isFeatureEnabled("ExcelPowerQuery",!1).then(Qc=>{this.C8d=Qc;return null})})}get Iji(){return this.C8d}get queries(){return this.Z$a.values}get groups(){return this.b6d}get formulas(){return this.Q5d}get NK(){return this.Ptg}XGg(Fa){this.Qa.addHandler("OnUpdatePowerQueryDataKeySucceeded",
Fa)}Dcj(Fa){this.Qa.removeHandler("OnUpdatePowerQueryDataKeySucceeded",Fa)}ygc(Fa){if(this.Z$a.mb(Fa)){const Mb=this.Z$a.getItem(Fa);if(1!==Mb.FillObjectType&&!Mb.LoadedToDataModel&&this.NK.mb(Fa))return!0}else d.ULS.sendTraceTag(537154446,0,10,"Query not presesnt in the queryNameToQueryInfo dictionary");return!1}e2a(){const Fa=new yc.a;this.$.userOperationManager.Ub(new Ja.a(587,0,(Mb,gc,Qc)=>ue.c(this.$.oa.va,Ra.b(Mb,this.WRj,this.uDf,()=>{Fa.setResult(!0)}),Ra.a(gc,this.szd,this.PSi,()=>{Fa.setResult(!0)}),
Qc,null),80,()=>new uf.a),null);return Fa.task}tUg(Fa){if(this.NK.mb(Fa)){Fa=this.NK.getItem(Fa).ConnectionName;const Mb=ib.a(this.$).AGd;if(Mb&&Mb.has(Fa))d.ULS.sendTraceTag(525342226,0,50,"PowerQueryManager.cancelRefreshQuery: sending cancellation request"),Fa=Mb.get(Fa),z.h(this.$.oa.va,Fa,null,null,null);else if(!ib.a(this.$).H$f(Fa))return d.ULS.sendTraceTag(525342225,0,15,"PowerQueryManager.cancelRefreshQuery: cannot find canceled connection on running requests map"),!1}return!0}FGd(Fa){this.ygc(Fa)&&
this.WTg(Fa)&&this.NK.mb(Fa)&&(Fa=this.NK.getItem(Fa),ib.a(this.$).VGb(Fa.ConnectionName,Fa.ExternalSourceIndex,null))}handleQueryAction(Fa,Mb){this.rlh(Fa,Mb);this.$.userOperationManager.Ub(new Ja.a(1023,0,(gc,Qc,Sc)=>Ad(this.$.oa.va,Fa,Mb,Ra.b(ud=>{0<ud.Errors.length&&this.e2a()},gc),Ra.a(()=>{this.e2a()},Qc),Sc,null),68),null)}rlh(Fa,Mb){switch(Fa){case 2:this.slh(Mb);break;default:return}this.uDf(void 0,void 0,void 0)}slh(Fa){var Mb=this.queries.find(gc=>gc.Name===Fa.Name);Mb.Name=Fa.ExtraData;
Mb.LoadedToDataModel||((Mb=this.NK.getItem(Fa.Name))?(Mb.ConnectionName="Query - "+Fa.ExtraData,Mb.QueryName=Fa.ExtraData,this.NK.remove(Fa.Name),this.NK.add(Fa.ExtraData,Mb)):d.ULS.sendTraceTag(512492568,0,10,"PowerQueryManager.estimateRenameQuery: Connection info not found"))}Rc(){return!1}Nc(){return!1}executeCommand(Fa,Mb){Fa=R.TaskExtensions.fk();return-1193102612===Mb.command?(this.r6i(),Fa):Wb.a(Mb.command)}Cc(Fa,Mb){switch(Mb.command){case -1193102612:return!0}return!1}oTh(Fa){return this.i0e(Fa)?
this.AHh():Promise.resolve(null)}dispose(){f.a.qc([this.Qa]);Qb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)&&ib.a(this.$).RId(this.lOa);this.$.ea.Hw(this.Uf);this.$.ea.pR(this.Ao);this.$=null}jzj(Fa,Mb){let gc=ic.a.Yc(1,2,2208,0,0,Fa,"PowerQueryRefreshValidationFailed");switch(Fa){case -1543585732:gc.MessageIdName="PowerQueryRefreshProtectedSheetFailed";gc.Description=String.format(X.a.instance.Xa(701),Mb,X.a.instance.ga(2209));break;case 165156185:gc.MessageIdName=
"PowerQueryRefreshSheetViewFailed";gc.Description=String.format(X.a.instance.Xa(701),Mb,X.a.instance.ga(2210));break;default:d.ULS.sendTraceTag(529069344,0,10,`PowerQueryManager.showEwaErrorDialog: unhandled error id ${Fa}`)}Qb.EwaSettings.wz()?new Da.a(this.$,gc):(Fa=new cg.ErrorDialog(this.$,gc),Fa.initialize(),Fa.Ff())}WTg(Fa){var Mb=this.Z$a.getItem(Fa);return Mb?(Mb=this.NMh(Mb))?(this.jzj(Mb,Fa),!1):!0:(d.ULS.sendTraceTag(529069343,0,10,"PowerQueryManager.getErrorMessageIdForQueryRefresh: Query not in the queryNameToQueryInfo dictionary"),
!1)}NMh(Fa){if((Fa=this.sWh(Fa))&&Fa.li)return-1543585732;if(Fa&&Fa.Ed.lv)return 165156185}sWh(Fa){let Mb=void 0,gc=void 0;if(3===Fa.FillObjectType||2===Fa.FillObjectType)Mb=Fa.FillObjectName.split("!")[0];else if(0==Fa.FillObjectType){if(!Fa.FillObjectName)return d.ULS.sendTraceTag(523534751,0,15,"PowerQueryManager.getSheetFromLoadDestination: FillObjectName is undefined for Query loaded to table."),gc;(Fa=this.$.zb.getItemByName(Fa.FillObjectName))?Mb=Fa.sheetName:d.ULS.sendTraceTag(527743194,0,
15,"PowerQueryManager.getSheetFromLoadDestination: cannot find namedObject for query")}Mb&&(gc=this.$.xa.getItemByName(Mb));return gc}r6i(){this.REe?this.NMf(this.queries):this.e2a().continueWith(Fa=>{Fa.result?this.NMf(this.queries):d.ULS.sendTraceTag(537154445,0,10,"PowerQueryManager.RefreshAllQueries failed to fatch queries")})}NMf(Fa){for(const Mb of Fa)this.FGd(Mb.Name)}E6i(Fa){Fa=this.i0e(Fa);if(!Fa)throw Error.argumentNull;this.FGd(Fa)}i0e(Fa){for(const Mb of this.queries)if(this.NK.getItem(Mb.Name).ConnectionName===
Fa)return Mb.Name;return null}AHh(){d.ULS.sendTraceTag(520734801,0,50,"PowerQueryManager:GetToken: Token requested for PQO service");try{return this.eDb.wO("PowerQueryWeb",this.$.ya.PowerQueryAudienceUri).then(Fa=>{if(Fa.IsSuccess)return d.ULS.sendTraceTag(520734800,0,50,"PowerQueryManager.getAuthToken: successfully fetch token."),Fa.Token;d.ULS.sendTraceTag(520734799,0,15,`PowerQueryManager.getAuthToken: failed to get token. Error code: ${Fa.ErrorCode}, Error message : ${Fa.ErrorMessage}`);return Promise.resolve(null)},
()=>{d.ULS.sendTraceTag(520734798,0,15,"PowerQueryManager.getAuthToken: got rejected promise, use fallback value");return Promise.resolve(null)})}catch(Fa){return d.ULS.sendTraceTag(520734797,0,10,`PowerQueryManager.getAuthToken: Exception thrown when fetching token, Exception: ${Fa}`),Promise.resolve(null)}}}Object(b.a)(re,"PowerQueryManager",null,[828,195,2]);var Ue=a(696);class Ie extends ma.a{constructor(Fa){super();this.$=Fa;this.Fb()}create(){const Fa=this.$.da;R.TaskExtensions.Aa(ea.GetServiceTaskFactory.Ra(Fa,
349,350,this.hb),Mb=>{this.qb(Object(Ue.c)(Fa,470,()=>new re(this.$,Mb.result)))},this.$.la,3)}static ka(Fa){Fa.da.Ga(471,new Ie(Fa))}}Object(b.a)(Ie,"PowerQueryManagerFactory",ma.a,[]);var bf;(function(Fa){Fa[Fa.null=-1]="null";Fa[Fa.table=0]="table";Fa[Fa.connectionOnly=1]="connectionOnly";Fa[Fa.pivotTable=2]="pivotTable";Fa[Fa.pivotChart=3]="pivotChart"})(bf||(bf={}));Object(b.b)("FillObjectType",bf);var Ee=a(262),zf=a(341),Af=a(109);class Mf{constructor(){this.name=this.key=null;this.startIndex=
this.count=0;this.data=this.children=null;this.order=this.level=0;this.parentKey=null}}Object(b.a)(Mf,"GroupInfo",null,[]);class mg{constructor(){this.handleQueryAction=this.onCancelQueryRefresh=this.handleQueryGroupOperation=this.onQueryRefresh=this.onQuerySelected=null}}Object(b.a)(mg,"PowerQueryTaskPaneCallbacks",null,[]);class Qa{constructor(){this.callbacks=this.selectedQueryKey=this.groups=this.queries=this.type=null}}Object(b.a)(Qa,"PowerQueryTaskPaneProps",null,[]);class xb{constructor(){this.name=
null;this.rowsLoaded=0;this.lastRefresh=null;this.fillObjectType=0;this.loadedToDataModel=!1;this.queryError=0;this.groupKey=null;this.rowsWithError=this.nestingDepth=0;this.refreshEnabled=this.inRefresh=!1}}Object(b.a)(xb,"QueryInfo",null,[]);class ac{constructor(Fa,Mb,gc){this.kva=new M.a(!1);this.jva=new M.a(!0);this.n4a=new M.a(!0);this.pKa=this.kR=null;this.PMf=0;this.handleQueryGroupOperation=(Qc,Sc)=>{const ud={};ud.Id=Sc.id;ud.Name=Sc.name;ud.Description=Sc.description;ud.ParentId=Sc.parentId;
this.Hya.handleQueryGroupOperation(Qc,ud)};this.handleQueryAction=(Qc,Sc)=>{const ud={},Zd=this.$.da.za(470);ud.Name=Sc.name;ud.ExtraData=Sc.extraData;ud.Formulas=Zd.formulas;Zd.handleQueryAction(Qc,ud)};this.$=Fa;this.Hya=gc;this.isVisible=!1;this.zab=new M.a(!0);this.KGd={};this.powerQueryManager=Mb}eda(){Xa.UISurfaces.Lj().then(Fa=>{Fa.setSelectedTaskPane("PowerQueryTaskPane");return null})}AI(Fa){this.isVisible=!0;Xa.UISurfaces.Lj().then(Mb=>{Mb.showTaskPane("PowerQueryTaskPane",this.e2c(Fa));
return null})}vu(Fa,Mb,gc=null,Qc=null){if(this.isVisible){var Sc=this.e2c(Fa,Mb,gc,Qc);Xa.UISurfaces.Lj().then(ud=>{ud.updateTaskPane("PowerQueryTaskPane",Sc||this.e2c(Fa,Mb,gc,Qc));return null})}else this.Gdg(Mb,gc)}PM(){this.isVisible=!1;Xa.UISurfaces.Lj().then(Fa=>{Fa.hideTaskPane("PowerQueryTaskPane",2);return null})}n5f(Fa){if(!Ee.a.Dh(Fa)){for(const Mb of this.kR)Fa.includes(Mb.name)&&(this.zab.add(Mb.name,Mb),this.KGd[Mb.name]=++this.PMf,d.ULS.sendTraceTag(537154401,0,50,`Refresh started for query #: ${this.PMf}`));
Qb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryTaskPaneMoveGenerateDataStructure",!1)?this.vu(null,this.powerQueryManager.queries,this.powerQueryManager.groups):this.vu(null,null,null)}}Y5f(Fa){if(!Ee.a.Dh(Fa)){for(const Mb of this.kR)Fa.includes(Mb.name)&&(Mb.name in this.KGd&&d.ULS.sendTraceTag(537154400,0,50,`Refresh stoped for query #: ${this.KGd[Mb.name]}`),this.zab.remove(Mb.name));Qb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryTaskPaneMoveGenerateDataStructure",
!1)?this.vu(null,this.powerQueryManager.queries,this.powerQueryManager.groups):this.vu(null,null,null)}}Gdg(Fa=null,Mb=null){Qb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryTaskPaneMoveGenerateDataStructure",!1)?this.wTj(Fa,Mb):this.vTj(Fa,Mb)}wTj(Fa=null,Mb=null){Fa&&(this.kR=[],null===Fa||void 0===Fa?void 0:Fa.forEach(gc=>this.kR.push(this.BDe(gc))));Mb&&(this.pKa=this.f6g(Mb));this.tHf()}vTj(Fa=null,Mb=null){Qb.EwaSettings.Oef()&&Mb&&Mb.length&&Fa?(this.jva.clear(),this.kva.clear(),
this.n4a.clear(),this.kR=[],this.pKa=[],this.RZi(Mb),this.ZZi(Fa),this.pKa=this.A2c("root",-1).children,this.pKa=this.pKa.concat(this.A2c("Other Queries",0))):Fa&&(this.jva.clear(),this.kva.clear(),this.n4a.clear(),this.pKa=this.kR=null,this.kR=this.CDe(Fa,0));this.tHf()}e2c(Fa,Mb=null,gc=null,Qc=null){this.Gdg(Mb,gc);Mb=Object(db.a)(new mg,{onQuerySelected:this.Hya.onQuerySelected,onQueryRefresh:this.Hya.onQueryRefresh,onCancelQueryRefresh:this.Hya.onCancelQueryRefresh,handleQueryGroupOperation:this.handleQueryGroupOperation,
handleQueryAction:this.handleQueryAction});Qc=Object(db.a)(new Qa,{type:"PowerQueryTaskPaneProps",callbacks:Mb,queries:this.kR,groups:this.pKa,selectedQueryKey:Qc});if(ab.a.Ad(this.$))return Object(db.a)(new gb.a,{contentProps:Qc,onOpen:()=>{this.Hya.fy()},onClose:()=>{this.Hya.qB()},width:320,title:X.a.instance.ga(2200)});Fa=Object(db.a)(new Ha.a,{container:Fa,paneProps:Qc});return Object(db.a)(new gb.a,{contentProps:Fa,onOpen:()=>{this.Hya.fy()}})}tHf(){if(this.kR)for(let Mb=0;Mb<this.kR.length;Mb++){var Fa=
!1;const gc=this.kR[Mb],Qc=this.zab.getItem(gc.name);null!=Qc&&(Fa=new Date(gc.lastRefresh),(Fa=(new Date(Qc.lastRefresh)).getTime()===Fa.getTime())||this.zab.remove(Qc.name));gc.inRefresh=Fa;gc.refreshEnabled=this.Hya.Pod(gc.name)}}RZi(Fa){for(var Mb of Fa)Fa=Mb.HasParent?Mb.ParentId:"root",this.kva.add(Mb.Id,Mb),this.ppe(Mb,Fa);Mb={};Mb.Name=X.a.instance.ga(2203);Mb.Id="Other Queries";Mb.Order=zf.a.dS;this.kva.add("Other Queries",Mb);this.kva.add("root",{Name:"root",Id:"root",Order:0})}ZZi(Fa){for(const gc of Fa){Fa=
gc.GroupID||"Other Queries";var Mb=this.jva.getItem(Fa);if("Other Queries"!==Fa&&Mb&&Mb.length){Mb="SubGroupOtherQueries-"+Fa;if(!this.kva.mb(Mb)){const Qc={};Qc.Name=Mb;Qc.Id=Mb;Qc.Order=zf.a.dS;this.kva.add(Mb,Qc);this.ppe(Qc,Fa)}Fa=Mb;gc.GroupID=Mb}Mb=[gc];this.n4a.mb(Fa)&&(Mb=Mb.concat(this.n4a.getItem(Fa)));this.n4a.add(Fa,Mb)}}ppe(Fa,Mb){Fa=[Fa];this.jva.mb(Mb)&&(Fa=Fa.concat(this.jva.getItem(Mb)));this.jva.add(Mb,Fa)}e6g(Fa,Mb){let gc=[];if(this.jva.mb(Fa)){Fa=this.jva.getItem(Fa);Fa.sort((Qc,
Sc)=>qa.HelperMethods.iD(Qc.Order,Sc.Order));for(const Qc of Fa)gc=gc.concat(this.A2c(Qc.Id,Mb+1))}return gc}A2c(Fa,Mb){var gc=this.kva.getItem(Fa);const Qc=this.n4a.getItem(Fa),Sc=Object(db.a)(new Mf,{});Sc.key=gc.Id;Sc.name=gc.Name;Sc.data=gc.Description;gc=this.e6g(Fa,Mb);Sc.children=this.iye(gc);Sc.level=Mb;Sc.count=0;Sc.children.length&&(Sc.startIndex=Sc.children[0].startIndex,Sc.count+=Af.g(Sc.children,ud=>ud.count));Qc&&(Sc.startIndex=this.kR.length,Sc.count+=Qc.length,this.kR=this.kR.concat(this.CDe(Qc,
Fa.includes("SubGroupOtherQueries-")?Mb:Mb+1)));return Sc}CDe(Fa,Mb){const gc=[];for(const Qc of Fa)Fa=this.zab.mb(Qc.Name)&&!Qb.EwaSettings.isChangeGateEnabled("OfficeVSO:5830384_StopRefreshIndicationOnLastUpdateChangesV2")?this.zab.getItem(Qc.Name):this.BDe(Qc,Mb),gc.push(Fa);return gc}BDe(Fa,Mb=0){const gc=new xb;gc.name=Fa.Name;gc.rowsLoaded=Fa.RowsLoaded;gc.lastRefresh=Fa.LastRefresh;gc.fillObjectType=Fa.FillObjectType;gc.loadedToDataModel=Fa.LoadedToDataModel;gc.queryError=Fa.QueryError;gc.nestingDepth=
Mb;gc.rowsWithError=Fa.RowsWithError;gc.groupKey=Fa.GroupID;return gc}f6g(Fa){const Mb=[];Fa.forEach(gc=>{const Qc=Object(db.a)(new Mf,{});Qc.key=gc.Id;Qc.name=gc.Name;Qc.order=gc.Order;Qc.parentKey=gc.ParentId;Qc.data=gc.Description;Mb.push(Qc)});return Mb}iye(Fa){const Mb=[];for(const gc of Fa)Fa=Object(db.a)(new Mf,{}),Fa.key=gc.key,Fa.name=gc.name,Fa.count=gc.count,Fa.startIndex=gc.startIndex,Fa.data=gc.data,Fa.children=this.iye(gc.children),Fa.level=gc.level,Mb.push(Fa);return Mb}}Object(b.a)(ac,
"PowerQueryReactTaskPane",null,[864]);class zc{constructor(Fa,Mb){this.Zoc=this.qca=this.wyc=this.powerQueryTaskPane=null;this.eHf=this.XEf=this.Ef=!1;this.onQuerySelected=gc=>{for(var Qc of this.powerQueryManager.queries)if(Qc.FillObjectName&&Qc.Name===gc){3!==Qc.FillObjectType&&2!==Qc.FillObjectType||Lb.a.contains(Qc.FillObjectName,"!",!0)||d.ULS.sendTraceTag(537154438,0,15,`PowerQueryPaneManager.OnQuerySelected: Selection Query of type : ${bf[Qc.FillObjectType]} and no ! on FillObjectName`);3===
Qc.FillObjectType?(gc=Qc.PivotChartSheetRange,gc.SheetName=Qc.FillObjectName.split("!")[0],Qc=Qc.FillObjectName.split("!")[1],S.g(this.$).ha.Pa.tGa(gc,Qc,0).continueWith(Sc=>{Sc.result||d.ULS.sendTraceTag(537154437,0,15,"PowerQueryPaneManager.OnQuerySelected: Selection of PivotChart Failed")})):(Qc=2===Qc.FillObjectType?Qc.FillObjectName.split("!")[1]:Qc.FillObjectName,(Qc=this.$.zb.getItemByName(Qc))&&Qc.activate());break}};this.nEb=()=>{this.hideTaskPane();this.$.zb.zg(this.re)};this.onCancelQueryRefresh=
gc=>{this.powerQueryManager.tUg(gc)&&this.qca.Y5f([gc])};this.onQueryRefresh=gc=>{this.powerQueryManager.FGd(gc)};this.Pod=gc=>this.powerQueryManager.NK.mb(gc);this.hxf=()=>{this.bLi()};this.re=(gc,Qc)=>{Qc.pa&&2===Qc.pa.type&&this.pyc.mb(Qc.pa.name)&&(Qb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryTaskPaneMoveGenerateDataStructure",!1)?this.updateTaskPane(this.powerQueryManager.queries,this.powerQueryManager.groups,this.pyc.getItem(Qc.pa.name)):this.updateTaskPane(null,null,
this.pyc.getItem(Qc.pa.name)))};this.HAf=(gc,Qc)=>{gc=[];for(const Sc of this.powerQueryManager.NK.values)if(Qc===Sc.ConnectionName){const ud=Sc.QueryName;if(this.powerQueryManager.ygc(ud)){gc.push(ud);break}}this.qca.n5f(gc)};this.lOa=(gc,Qc)=>{if(Qc&&Qc.Result){gc=Qb.EwaSettings.isChangeGateEnabled("OfficeVSO:6635492_ChangeRefreshResultV2")?Qc.Result.ConnectionName:Qc.Result;Qc=[];for(const Sc of this.powerQueryManager.NK.values)if(gc===Sc.ConnectionName){const ud=Sc.QueryName;if(this.powerQueryManager.ygc(ud)){Qc.push(ud);
break}}this.qca.Y5f(Qc)}};this.$=Fa;this.powerQueryManager=Mb;this.pyc=new M.a(!0);this.R$h(Fa);ib.a(this.$).tUc(this.lOa);ib.a(this.$).hne(this.HAf);this.powerQueryManager.XGg(this.hxf);d.ULS.sendTraceTag(542228699,0,15,"PowerQueryPaneManager.ShowPowerQueryTaskPane()")}zAj(){if(ab.a.Ad(this.$))this.showTaskPane();else if(this.powerQueryTaskPane||this.eHf)this.powerQueryTaskPane&&(this.powerQueryTaskPane.ig(!0),this.showTaskPane());else{this.eHf=!0;const Fa=ea.GetServiceTaskFactory.Ra(this.$.da,408,
409,0),Mb=Ua.a(this.$);R.TaskExtensions.Aa(R.TaskExtensions.Wd([Fa,Mb],this.$.la),()=>{this.powerQueryTaskPane=Fa.result;Mb.result.uQ(this.powerQueryTaskPane);this.z5();this.powerQueryTaskPane.ig(!0);this.showTaskPane()},this.$.la,3)}}R$h(Fa){this.qca=new ac(Fa,this.powerQueryManager,this)}z5(){this.Zoc=this.powerQueryTaskPane.pM();this.powerQueryTaskPane.aM(this.nEb)}dispose(){ib.a(this.$).RId(this.lOa);ib.a(this.$).nQf(this.HAf);this.powerQueryManager.Dcj(this.hxf);this.$=null;this.hideTaskPane();
this.powerQueryTaskPane&&(this.powerQueryTaskPane.RN(this.nEb),this.powerQueryTaskPane=this.Zoc=null);this.qca=null}fy(){this.powerQueryManager.e2a();this.$.zb.Pf(this.re)}qB(){this.Ef=!1}handleQueryGroupOperation(Fa,Mb){Db.a(this.$.userOperationManager,(gc,Qc,Sc)=>jd(this.$.oa.va,Fa,Mb,gc,Qc,Sc,null),gc=>new Ja.a(1021,0,gc),null)}showTaskPane(){this.Ef?ab.a.Ad(this.$)&&this.qca.eda():(this.wyc=this.$.Ib.Bc("UserAction","PowerQueryTaskPaneInitialLoadTime"),this.Ef=!0,this.qca.AI(this.Zoc))}updateTaskPane(Fa,
Mb,gc){this.qca.vu(this.Zoc,Fa,Mb,gc);this.wyc&&(this.wyc.stop(),this.wyc=null);for(Fa=0;Fa<this.powerQueryManager.queries.length;Fa++)Mb=this.powerQueryManager.queries[Fa],0===Mb.FillObjectType&&this.pyc.add(Mb.FillObjectName,Mb.Name),Mb.LastRefresh||d.ULS.sendTraceTag(537154436,0,15,"PowerQueryPaneManager.UpdateTaskPane: Invalid date for last refreshed.")}hideTaskPane(){this.Ef=!1;this.qca.PM()}bLi(){this.updateTaskPane(this.powerQueryManager.queries,this.powerQueryManager.groups,null);this.XEf||
(this.PNi(ib.a(this.$).eNf),this.XEf=!0)}PNi(Fa){const Mb=[];for(const gc of Fa)for(const Qc of this.powerQueryManager.NK.values)if(gc===Qc.ConnectionName&&(Fa=Qc.QueryName,this.powerQueryManager.ygc(Fa))){Mb.push(Fa);break}this.qca.n5f(Mb)}}Object(b.a)(zc,"PowerQueryPaneManager",null,[846]);class Yc{constructor(Fa,Mb){this.$oc=null;this.$=Fa;this.oZi=Mb}Rc(){return!1}Nc(){return!1}executeCommand(Fa,Mb){this.$oc||(this.$oc=new zc(this.$,this.oZi));Fa=R.TaskExtensions.fk();return 1156885807===Mb.command?
(this.$oc.zAj(),Fa):Wb.a(Mb.command)}dispose(){this.$=this.$oc=null}Cc(Fa,Mb){Fa=!1;switch(Mb.command){case 1156885807:Fa=Qb.EwaSettings.isChangeGateEnabled("OfficeVSO:6320032_PowerQueryTaskPane")}return Fa}}Object(b.a)(Yc,"PowerQueryPaneCommandHandler",null,[195,2]);class md extends $a.a{constructor(Fa){super(Fa)}yd(){this.$.Qx(()=>{Qb.EwaSettings.isChangeGateEnabled("OfficeVSO:5751619_PowerQueryManagerWebClient")?R.TaskExtensions.Aa(ea.GetServiceTaskFactory.Ra(this.$.da,470,471,1),Fa=>{this.gd([new Yc(this.$,
Fa.result)])},this.$.la,3):this.gd([new Yc(this.$,null)])})}static ka(Fa){$a.a.Nd(407,new md(Fa))}}Object(b.a)(md,"PowerQueryPaneCommandHandlerFactory",$a.a,[]);var sd=a(137);class h{}h.Tph="ewa-pqtp-pane";h.Sph="ewa-pqtp-header";h.Uph="ewa-pqtp-title";h.Qph="ewa-pqtp-body";h.Rph="ewa-pqtp-close-button";Object(b.a)(h,"CssClassNames",null,[]);const Ib=h.Tph,ec=h.Sph,Ec=h.Qph,fd=h.Uph,Cd=B.a.Idb+h.Rph;class Gd extends I.a{constructor(Fa,Mb,gc){super(Fa);this.yye=this.he=null;this.Cp=!1;this.su=0;this.Ec=
(Qc,Sc)=>{Sc.fg||this.ig(!1)};this.$j=()=>{this.ig(!1);this.raiseEvent("PQTPC");return!0};this.$=Mb;this.taskPaneManager=gc;v.a(Mb).Xh(this);this.$.kk(this.Ec)}dP(Fa){this.get_events().addHandler("PQTPR",Fa)}qR(Fa){this.get_events().removeHandler("PQTPR",Fa)}aM(Fa){this.addHandler("PQTPC",Fa)}RN(Fa){this.removeHandler("PQTPC",Fa)}get isVisible(){return super.isVisible}set isVisible(Fa){super.isVisible!==Fa&&(super.isVisible=Fa)}get kf(){return this.isVisible}get $d(){return ia.a.nZi}get Yg(){return 17}get Tk(){return x.a.fth}get RM(){return X.a.instance.ga(2200)}get titleText(){return X.a.instance.ga(2200)}get wo(){return 320}get mc(){return this.domElement}get height(){return this.taskPaneManager.oO.offsetHeight}get isResizable(){return!1}BH(){}lp(){return this.Cp}Zr(){return this.Cp}dR(){}mQ(){return!1}lj(){}Nj(){}dispose(){this.$&&
this.$.zl(this.Ec);this.he&&(D.a.instance.Ba(w.a.click,this.he,this.$j),Na.KeyInputManager.instance.Bv(this.he,this.yye));this.he=this.taskPaneManager=this.$=null;super.dispose()}hg(Fa,Mb){Mb||(Fa=F.DOMElementExtensions.getElementById(this.domElement,"PowerQueryContainerId-1"),Fa||(Fa=this.he),F.DOMElementExtensions.setFocus(Fa));return!Mb}kh(Fa){return F.DOMElementExtensions.vf(this.mc,Fa)}ig(Fa){this.Cp=Fa;const Mb=this.taskPaneManager;this.isVisible=Fa;this.taskPaneManager.Pw();Fa&&0<Mb.$z.length&&
(!Mb.Bg||17!==Mb.Bg.taskPane.Yg||Mb.isCollapsed)&&Mb.VF(this,!0)}pM(){const Fa=document.getElementById(this.$.Bb+B.a.iDd);Fa.setAttribute(sd.a.ariaLabel,X.a.instance.ga(2200));var Mb=this.ZG();Fa.appendChild(Mb);Mb=Za.b("div","PowerQueryPaneBodyId",Ec);Fa.appendChild(Mb);return Mb}ZG(){const Fa=Za.b("div","PowerQueryPaneHeaderId",ec),Mb=Za.b("span","PowerQueryPaneTitleId",fd);Mb.innerText=this.titleText;this.he=na.a.pb("PowerQueryPaneCloseButtonId",Cd,X.a.instance.ga(10),"ClosePaneGlyph_16x16x32",
!1);this.he.classList.add(Va.AFrameworkApplication.isRtl?B.a.V$:B.a.W$);D.a.instance.ra(w.a.click,this.he,this.$j);this.yye=Na.KeyInputManager.instance.ms(this.he,this.$j,Sa.a.$h);Fa.appendChild(Mb);Fa.appendChild(this.he);return Fa}static ka(Fa,Mb){var gc=Fa.Bb;let Qc=document.getElementById(gc+B.a.iDd);Qc||(Qc=document.createElement("div"),Qc.id=Fa.Bb+B.a.iDd,ab.a.Ad(Fa)||document.getElementById(gc+B.a.WQ).appendChild(Qc));Qc.classList.add(Ib);gc=Fa.da;return gc.za(408)||gc.Ga(408,new Gd(Qc,Fa,
Mb))}}Object(b.a)(Gd,"PowerQueryTaskPane",I.a,[825,2,401,102]);class Yd extends ma.a{constructor(Fa){super();this.eh=this.ri=null;this.$=Fa;this.Fb()}get pD(){this.ri||(this.ri=R.TaskExtensions.Aa(Ua.a(this.$),Fa=>{this.eh=Gd.ka(this.$,Fa.result)},this.la,3));return this.ri}create(){const Fa=ea.GetServiceTaskFactory.create(this.$.da,203,this.la,this.hb),Mb=ea.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb);R.TaskExtensions.Aa(R.TaskExtensions.ts(R.TaskExtensions.Wd([Fa,Mb],this.la),()=>
this.pD,this.la),()=>{this.qb(this.eh)},this.la,3)}dispose(){this.eh=this.ri=this.$=null;super.dispose()}static ka(Fa){Fa.da.Ga(409,new Yd(Fa))}}Object(b.a)(Yd,"PowerQueryTaskPaneFactory",ma.a,[]);class fe{constructor(Fa,Mb){this.$=Fa;this.powerQueryManager=Mb}Rc(){return!1}Nc(){return!1}executeCommand(Fa,Mb){Fa=R.TaskExtensions.fk();return-1496653501===Mb.command?Fa:Wb.a(Mb.command)}dispose(){this.$=this.powerQueryManager=null}Cc(Fa,Mb){return-1496653501===Mb.command}}Object(b.a)(fe,"PowerQueryUIFlowManager",
null,[195,2]);class Le extends $a.a{constructor(Fa){super(Fa)}yd(){this.$.Qx(()=>{R.TaskExtensions.Aa(ea.GetServiceTaskFactory.Ra(this.$.da,470,471,this.hb),Fa=>{this.gd([new fe(this.$,Fa.result)])},this.$.la,3)})}static ka(Fa){$a.a.Nd(512,new Le(Fa))}}Object(b.a)(Le,"PowerQueryUIFlowManagerFactory",$a.a,[]);class te{getExpandedRangeForPivotTable(Fa,Mb,gc,Qc,Sc,ud,Zd,ne=null){ne=Fa.Na(1,ne);ne.sheetRange=Mb;ne.activeCell=gc;return z.g(Fa,"GetExpandedRangeForPivotTable",ne,Qc,Sc,ud,Zd,0)}}Object(b.a)(te,
"ExpandRange",null,[822]);class rf extends ma.a{constructor(Fa){super();this.$=Fa;this.Fb()}static ka(Fa){Fa.da.Ga(483,new rf(Fa))}create(){var Fa;this.qb(null!==(Fa=this.$.da.za(482))&&void 0!==Fa?Fa:this.$.da.Ga(482,new te))}}Object(b.a)(rf,"ExpandRangeFactory",ma.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPivotTable");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PivotCommand");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PowerQuery");Type.registerNamespace("_Ewa");
c.a.Hi(".ewa-insertpt-dlg-input{position:relative;width:50%;padding-left:3px}.ewa-insertpt-dlg-label{margin-left:50px;margin-right:5px}.ewa-insertpt-label{vertical-align:text-top}.ewa-insertpt-dlg-sourceRange{white-space:nowrap}");c.a.Hi('.ewa-ptsp-pane{background:#edebe9;height:100%;display:flex;flex-direction:column;overflow:hidden}.ewa-ptsp-header{position:relative;overflow:hidden;padding:16px;background:#edebe9}.ewa-ptsp-title{position:relative;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:normal;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web Semibold","Arial Semibold","Verdana Semibold","sans-serif Semibold";background:#edebe9}.ewa-ptsp-body{background:#edebe9;padding:0 16px;height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-y:auto;overflow-x:hidden}.ewa-ptsp-close-button{display:inline-block;padding:1px;font-size:16px}.ewa-filterconnections-dlg-hr{margin:8px -14px 0 -14px;border:none;height:1.5px;background-color:#e1e1e1}.ewa-filterconnections-dlg-table{border-spacing:1px}.ewa-filterconnections-dlg-table thead tr{display:block;cursor:default;pointer-events:none}.ewa-filterconnections-dlg-table tbody{border:1px solid #e1e1e1;display:block;max-height:120px;overflow-y:auto}.ewa-filterconnections-dlg-table td{text-align:left;width:100px}.ewa-filterconnections-dlg-table tbody tr{display:block}.ewa-filterconnections-dlg-level{width:20px}.ewa-filterconnections-dlg-column{width:100px}');
c.a.Hi('.ewa-pqtp-pane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#f5f5f5}.ewa-pqtp-header{position:relative;overflow:hidden;padding:16px}.ewa-pqtp-title{height:22px;display:inline-block;color:#252423;font-size:16px;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.ewa-pqtp-body{height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-x:hidden;overflow-y:auto}.ewa-pqtp-close-button{height:22px;width:22px;color:#252423;display:inline-block}.ewa-pqtp-close-button .clip16x16{top:2px;left:2px}');
(()=>{Ca.a.Fa(Fa=>{R.TaskExtensions.Aa(ea.GetServiceTaskFactory.Ra(Fa.da,12,477,1),Mb=>{mb.ka(Fa,Mb.result)},Fa.la)})})();(()=>{Ca.a.Fa(Fa=>{sc.ka(Fa);sb.ka(Fa);ua.ka(Fa)})})();Ca.a.Fa(Fe.ka);(()=>{Ca.a.Fa(Fa=>{Gc.ka(Fa)})})();Ca.a.Fa(Ne.NFa);Ca.a.Fa(ob.ka);(()=>{Ca.a.Fa(Fa=>{Ce.ka(Fa);Hd.ka(Fa);la.ka(Fa)})})();(()=>{Ca.a.Fa(Fa=>{Fb.ka(Fa);Md.ka(Fa)})})();(()=>{Ca.a.Fa(Fa=>{md.ka(Fa);Fc.ka(Fa);Yd.ka(Fa);Ie.ka(Fa);Qb.EwaSettings.isChangeGateEnabled("OfficeVSO:7040300_CreatePowerQueryUIManager")&&Le.ka(Fa)})})();
(()=>{Ca.a.Fa(Fa=>{rf.ka(Fa)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.bi.js.map/13629ef5d71ec772f77e34e5d57d6523/EwaDSEsNext.bi.js.map