'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1154:function(t,C,a){t=a(0);var c=a(15),b=a(221),d=a(8),f=a(110);a(199);var e=a(185),k=a(84),l=a(164),m=a(196),v=a(65);class n{}n.local="Local";n.tIj="Thread";Object(t.a)(n,"RecalcServiceCreateMode",null,[]);var w=a(162);class r{constructor(ca){this.A2d=null;this.init(ca)}get V9(){return this.A2d}init(ca){this.A2d=new l.a;if(void 0!==ca&&null!==ca&&void 0!==ca.HeadersList&&null!==ca.HeadersList&&0<ca.HeadersList.length)for(const aa of ca.HeadersList)this.V9.ia(aa.Index,
aa.Name)}}Object(t.a)(r,"ColHeadersListData",null,[]);var u=a(1),y=a(33),x=a(100),B=a(22),z=a(21),A=a(200);class I{constructor(ca,aa){this.sue=ca;this.sheetName=aa;this.puc=!1}}Object(t.a)(I,"CalcBlockInformation",null,[]);class F{constructor(ca,aa,ta,xa,ia){this.type=ca;this.fullName=aa;this.range=ta;this.sheetId=xa;this.attributes=ia;this.zE=null}}Object(t.a)(F,"CalcNamedObject",null,[]);class U{constructor(ca){this.heg=ca;this.Bfe=[];this.Ebg=[];this.RZa={};this.yPd=new Map}get Gj(){return this.Bfe}r_f(ca,
aa){this.Bfe[ca]=aa;this.heg&&aa.J6&&this.yPd.set(aa.J6.sheetName,ca)}getSheetIndex(ca){if(this.heg){if(this.yPd.has(ca))return this.yPd.get(ca)}else for(let aa=1;aa<this.Gj.length;aa++)if(B.a.equals(this.Gj[aa].J6.sheetName,ca,!1))return aa;return-1}}Object(t.a)(U,"GridCache",null,[]);var X=a(681),S=a(551);class H{constructor(ca){this.J6=ca;this.i5=new X.a(S.a.Sk());this.Akc=!1}}Object(t.a)(H,"SheetInformation",null,[]);var D=a(935),J;(function(ca){ca[ca.initialization=0]="initialization";ca[ca.contentReady=
1]="contentReady";ca[ca.cellEdit=2]="cellEdit"})(J||(J={}));Object(t.b)("UpdateDataTrigger",J);class M{constructor(ca){this.fGd=null;this.Fsd=this.eGd=this.sAd=!1;this.ZDd=0;this.QDd=this.SDd=this.TDd=this.RDd=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=this.Sq=this.errorTypeNames=null;this.jt=this.currentStateId=-1;this.Osa="";this.m$=null;this.getNameLoc=(aa,ta)=>this.Pfc()?this.Ue.na(this.currentStateId).Gj[0].i5.mb(ta)?(aa=excelOnlineCalc.location.nameLoc(aa,
ta),excelOnlineCalc.util.success(aa)):excelOnlineCalc.util.success(null):(aa=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(aa));this.getContainingTable=aa=>{if(!this.Pfc())return aa=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(aa);const ta=aa.range.col,xa=aa.range.row;var ia=this.Ue.na(this.currentStateId).Gj[0].i5,ya=null;for(let ib of ia)if(ia=ib.value,2===ia.type&&B.a.equals(aa.sheet.index.toString(),ia.sheetId,!0)){const wa=ia.range;ta>=wa.left-1&&ta<=
wa.right-1&&xa<=wa.bottom-1&&xa>=wa.top-1&&(ya=excelOnlineCalc.location.nameScope(this.documentLoc,ia.sheetId),ya=excelOnlineCalc.location.nameLoc(ya,ia.fullName))}return ya?excelOnlineCalc.util.success(ya):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(aa,ta)=>{if(!this.Pfc()){var xa=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(xa)}xa=aa.name;var ia=this.Ue.na(this.currentStateId).Gj[0].i5;if(ia.mb(xa)){ia=ia.na(xa);const ib=ia.range;if(2!==ia.type)return excelOnlineCalc.util.failure(this.L2c(5));
const wa=ia.zE?ia.zE.V9:null;if(!wa)return excelOnlineCalc.util.success(null);for(var ya of wa)if(B.a.equals(ya.value,ta,!0))return aa=excelOnlineCalc.location.documentLoc(aa.scope.document.path,aa.scope.document.name),aa=excelOnlineCalc.location.sheetIndex(aa,ia.sheetId),ya=excelOnlineCalc.location.gridRange(ib.top-1,ya.key,ib.bottom-ib.top+1,1),ya=excelOnlineCalc.location.sheetGridRange(aa,ya),xa=excelOnlineCalc.location.structRefColumnLoc(xa,ya,!!(ia.attributes&16),!!(ia.attributes&8)),excelOnlineCalc.util.success(xa);
return ib.right-ib.left+1!==wa.count?(xa=excelOnlineCalc.util.unavailable([17,aa,ta]),excelOnlineCalc.util.failure(xa)):excelOnlineCalc.util.failure(this.L2c(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(aa,ta)=>{if(!this.Pfc())return ta=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ta);var xa=this.Ue.na(this.currentStateId).Gj[0].i5;if(xa.mb(aa.name)){var ia=xa.na(aa.name);if(2!==ia.type)return excelOnlineCalc.util.failure(this.L2c(5));xa=!!(ia.attributes&
16);const ya=!!(ia.attributes&8),ib=xa?1:0,wa=ya?1:0;aa=excelOnlineCalc.location.documentLoc(aa.scope.document.path,aa.scope.document.name);aa=excelOnlineCalc.location.sheetIndex(aa,ia.sheetId);ia=ia.range;let sa={};if(1===ta)sa=excelOnlineCalc.location.gridRange(ia.top-ib-1,ia.left-1,ia.bottom+wa-ia.top+ib+1,ia.right-ia.left+1);else if(2===ta)sa=excelOnlineCalc.location.gridRange(ia.top-1,ia.left-1,ia.bottom-ia.top+1,ia.right-ia.left+1);else if(3===ta)if(xa)sa=excelOnlineCalc.location.gridRange(ia.top-
2,ia.left-1,1,ia.right-ia.left+1);else return excelOnlineCalc.util.success(null);else if(4===ta)if(ya)sa=excelOnlineCalc.location.gridRange(ia.bottom,ia.left-1,1,ia.right-ia.left+1);else return excelOnlineCalc.util.success(null);ta=excelOnlineCalc.location.sheetGridRange(aa,sa);return excelOnlineCalc.util.success(ta)}return excelOnlineCalc.util.success(null)};this.getDocumentLoc=(aa,ta)=>{if((B.a.equals(aa,this.documentLoc.path,!0)||!aa)&&B.a.equals(ta,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);
aa=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(aa,ta)]);return excelOnlineCalc.util.failure(aa)};this.getSheetIndex=(aa,ta)=>{if(!this.Ue.mb(this.currentStateId)||!this.Ue.na(this.currentStateId).Gj)return ta=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ta);aa=this.Ue.na(this.currentStateId).Gj;for(let xa=1;xa<aa.length;xa++)if(B.a.equals(aa[xa].J6.sheetName,ta,!0))return excelOnlineCalc.util.success(aa[xa].J6.sheetId);return excelOnlineCalc.util.success(null)};
this.getSheetName=(aa,ta)=>{if(!this.Ue.mb(this.currentStateId)||!this.Ue.na(this.currentStateId).Gj)return ta=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ta);aa=this.Ue.na(this.currentStateId).Gj;for(let xa=1;xa<aa.length;xa++)if(B.a.equals(aa[xa].J6.sheetId,ta,!0))return excelOnlineCalc.util.success(aa[xa].J6.sheetName);return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);
this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);this.Bzf=()=>{this.setNumberFormats()};this.$c=()=>{c.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.Ue=new l.a;this.currentStateId=this.jt=-1;this.Osa="";this.crb=null;this.eGd=!1;this.Sq&&this.clearCache()};this.B4f=(this.Jc=ca)?ca.ya.CalcWebWorkerSmokeTestPingIntervalMS:this.B4f;this.Ue=new l.a;this.crb=null;this.documentLoc=
excelOnlineCalc.location.documentLoc("",this.Jc.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.Vna();this.dnd=y.a.dnd()}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.yId(this.Bzf);this.Jc&&this.Jc.Al(this.$c);this.close()}GNb(ca){if(!this.Sq)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=this.Jc.da.za(268),!this.instantaneousSupportInformationManager))return c.ULS.sendTraceTag(537170198,
0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),!1;2!==ca&&(this.currentStateId=this.Jc.ea.E7a,this.currentStateId===d.a.Ce&&(this.currentStateId=this.Jc.ea.Ke));if(1===ca&&this.currentStateId<this.jt)return c.ULS.sendTraceTag(537170197,0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.jt} - ignoring update`),!1;this.Yoj();0!==ca&&this.eGd||(this.ptj(),this.xqj(),this.hrj(),this.setNumberFormats(),this.instantaneousSupportInformationManager.Eme(this.Bzf),
this.Jc.el(this.$c),this.eGd=!0);this.v5i();let aa=!1;0===ca&&(aa=this.i$h());if(0!==ca||aa)this.Csj()?(this.etj(ca),this.dtj(),this.jt=this.currentStateId,this.aXg()):c.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);2!==ca&&this.resumeRecalc();return!0}evalFormula(ca,aa,ta,xa){if(!this.Sq)return c.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});aa=excelOnlineCalc.calc.sheetCellLocation(null!==
ta&&void 0!==ta?ta:v.d(this.Jc.xa.pa),aa.top-1,aa.left-1);ca=this.Sq.evalFormula(this.Jc.ea.Ke,ca,aa,xa);this.resumeRecalc();return ca}XSg(ca,aa,ta,xa=null){const ia=v.d(this.Jc.xa.pa);let ya=ca.cell.rQ-1,ib=ca.cell.qQ-1;var wa=ya,sa=ib;let Ya=null;xa&&(Ya=excelOnlineCalc.calc.cellLocation(ya,ib),ya=xa.top-1,ib=xa.left-1,wa=xa.bottom-1,sa=xa.right-1);ta=this.MYd(ca,ta,"SetCell");0>ta||(sa=M.j$("CalculateFormula.cell",ia,ya,ib,wa,sa),wa=[],xa=this.dgd(ia),aa=excelOnlineCalc.calc.inferredRangeFormulaEdit(sa,
aa,Ya,xa),wa.push(aa),ca=(aa=this.R2e())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",ia,ya,ib,B.a.Hoe(ca.cell.text),ta,aa.top-1,aa.left-1,aa.bottom-1,aa.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",ia,ya,ib,B.a.Hoe(ca.cell.text),ta,"","","",""),c.ULS.sendTraceTag(537170180,0,50,ca),this.Sq.editRangeFormulas(ta,wa),this.resumeRecalc())}Esb(ca,
aa,ta,xa){if(!this.Sq)return c.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");if(!ta||!aa)return c.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!ta}, outputColumnRange null: ${!aa}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");c.ULS.shipAssertTag(537170178,0,ta.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");
const ia=v.d(this.Jc.xa.pa),ya=this.dgd(ia);var ib=null;if(ca){ib=[];for(const sa of ca)if(sa.column!==ta.left){ca=sa.row-1;var wa=sa.column-1;ca=M.j$("EvalFormulaRangeOnClone.cell",ia,ca,wa,ca,wa);wa=sa.text;ib.push(excelOnlineCalc.calc.rangeWrite(ca,excelOnlineCalc.calc.valueCellData(wa,wa,sa.Gk,null)))}}ta=excelOnlineCalc.calc.cellLocation(ta.top-1,ta.left-1);aa=M.j$("EvalFormulaRangeOnClone.outputColumnRange",ia,aa.top-1,aa.left-1,aa.bottom-1,aa.right-1);xa=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(aa,
xa,ta,ya)];ib=this.Sq.evalOnClonedModel(ib,xa);this.resumeRecalc();return ib}fEe(ca){let aa=null;try{if(ca)if(this.Osa=z.g(this.Jc).Ea.wua(ca),this.currentStateId=ca.uSa,this.currentStateId<this.jt||this.currentStateId===d.a.Ce)c.ULS.sendTraceTag(537170176,0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.Osa} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.jt}`);else{if(this.o$h(),!this.$Ng())if(aa=this.Jc.Ib.Bc("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.Osa} StateId:${this.currentStateId}`),
this.crb=this.Fvb(ca.pa.sheetName),!this.crb){const ya=!!(this.Jc.Bd&32),ib=this.Ue.mb(this.currentStateId)&&this.Ue.na(this.currentStateId).Gj?this.Ue.na(this.currentStateId).Gj.length:0;c.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${ib}, scratchPad:${ya}, sheetNameLength:${ca.pa.sheetName?ca.pa.sheetName.length:-1} Hash:${ca.pa.hash}`)}else if(z.g(this.Jc).Ea.qm.c1a(ca.Od)){var ta=ca.tf;if(ta){var xa=ta.getCalcBlockModel();
if(!xa)c.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block");else if(this.SNg(xa)){this.Ue.na(this.currentStateId).RZa[this.Osa]=new I(xa,ca.pa.sheetName);var ia=ca.pe;ia?this.mBg(ia.NamedObjects):c.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}}else c.ULS.sendTraceTag(537170146,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.Osa}`)}}else c.ULS.shipAssertTag(537170177,
0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{aa&&aa.stop()}}W3a(ca){if(!this.Ue.na(this.currentStateId).Gj||!this.Ue.na(this.currentStateId).Gj[0])return null;var aa=this.Ue.na(this.currentStateId).Gj[0].i5;if(!aa||!aa.mb(ca.name))return null;ca=aa.na(ca.name);if(!ca||!ca.zE)return null;aa=new e.a;for(let ta of ca.zE.V9)aa.add(ta.value);return aa}YSg(ca,aa,ta){var xa=z.g(this.Jc),ia=xa.Vb(aa);ia=this.MYd(ia,null,"CopyPaste");ta=this.MYd(xa.Vb(ca),ta,
"CopyPaste");if(0>ia||0>ta||ia!==ta)c.ULS.sendTraceTag(537170143,0,15,`CalcAsyncEngine::CalculateFormulaForCopyPaste(). Revision not valid. sourceRevision:${ta}, targetRevision:${ia}.`);else{ta=[];xa=v.d(this.Jc.xa.pa);var ya=this.dgd(xa);ca=M.j$("CalculateFormulaForCopyPaste.srcRange",xa,ca.top-1,ca.left-1,ca.bottom-1,ca.right-1);aa=M.j$("CalculateFormulaForCopyPaste.targetRange",xa,aa.top-1,aa.left-1,aa.bottom-1,aa.right-1);aa=excelOnlineCalc.calc.copyPasteRangePasteEdit(aa,ca,ya);ta.push(aa);aa=
ya?String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",xa,ia,ya.row,ya.column,ya.lastRow,ya.lastColumn):String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",xa,ia,"","","","");c.ULS.sendTraceTag(537170142,0,50,aa);this.Sq.editRangePaste(ia,ta);this.resumeRecalc()}}dgd(ca){const aa=this.R2e();let ta=null;aa?ta=M.j$("GetViewport.viewport",ca,aa.top-1,aa.left-1,aa.bottom-
1,aa.right-1):c.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return ta}R2e(){const ca=z.g(this.Jc);let aa=ca.gi;if(z.g(this.Jc).ib.mj){aa=ca.Lf(1).gi;if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&!aa)return c.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;aa.ZQa(1,1);aa.ZQa(3,1)}return aa}MYd(ca,aa,ta){let xa;if(!this.Sq||
!ca)return c.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.Sq}, modifiedCell is null:${!ca}, operation:${ta}`),-1;const ia=ca.cell.rQ-1,ya=ca.cell.qQ-1;if(ca.cell.Sx){if(xa=ca.cell.Sx.Gse,xa===d.a.Ce)return c.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${ca.cell.Sx.Od}, operation:${ta}`),-1}else return c.ULS.sendTraceTag(537170137,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${ca.cell.rQ},${ca.cell.qQ}), operation:${ta}`),
-1;if(xa<this.jt)return c.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${ia},${ya}) - blockRevision:${xa} < lastUpdatedStateId:${this.jt}, operation:${ta}`),-1;if(xa<this.currentStateId)return c.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${ia},${ya}) - blockRevision:${xa} < currentStateId:${this.currentStateId}, operation:${ta}`),-1;aa&&!this.sAd&&(this.Sq.setOnRecalcResults(aa),
this.sAd=!0);return this.oPj()&&!this.GNb(2)?(c.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${ta}`),-1):xa}getFormulaBarText(ca,aa,ta){return aa&&aa.startsWith("'")?aa:ca.cell.formulaBarText||ta.toString()}y8g(ca,aa,ta){let xa=null;if(this.dve()&&this.Ue.na(this.jt).RZa){const ia=this.Ue.na(this.jt).RZa[ca];if(null===ia||void 0===ia?0:ia.puc)xa=ia.sue}ta=this.aei(xa,aa,ta);aa=this.z_g(xa,aa,ta);c.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${ca} StateId:${this.currentStateId} number of formulas ${aa}`)}aei(ca,
aa,ta){let xa=!1;const ia=M.QVe(aa);if(ca){const ya=M.QVe(ca);B.a.equals(ya,ia,!1)&&(xa=!0)}xa?this.RBg(ca,this.jt,ta):this.TBg(aa,ta);return xa}dve(){let ca=!1;this.Sq&&-1!==this.jt&&(ca=this.Sq.stateIdAvailable(this.jt));return ca&&this.Ue.mb(this.jt)&&this.jt<this.currentStateId}z_g(ca,aa,ta){let xa;xa=0;let ia,ya;for(aa.reset();ia=aa.getNextCell();)A.f(ia.formula)&&xa++,(ya=ta?ca.getCell(ia.row,ia.col):null)?this.v_g(aa,ia,ya):this.SBg(aa,ia);if(ta)for(ca.reset();ya=ca.getNextCell();)(ia=aa.getCell(ya.row,
ya.col))||this.Wke(ca,ya);return xa}hrj(){this.Sq.setOnUpdateRequest(()=>{})}grj(){this.Sq.setOnUnresponsive((ca,aa,ta,xa)=>{this.HSi(ca,aa,ta,xa)})}HSi(ca,aa,ta,xa){c.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${ca}, waitTime:${aa}, timeoutCount:${ta}, hasBeenClosed:${xa}.`);xa&&(this.Nfj(),this.Vna())}Nfj(){this.$c(null,null);this.Fsd=this.sAd=!1;this.ZDd=0;this.QDd=this.SDd=this.TDd=this.RDd=-1}close(){this.Sq.close()}clearCache(){this.Sq.clearCache()}resumeRecalc(){this.Sq.resumeRecalc()}xqj(){this.Sq.setA1ReferenceStyle(!0)}v5i(){if(this.instantaneousSupportInformationManager){var ca=
this.instantaneousSupportInformationManager.tbi;const ta=this.instantaneousSupportInformationManager.wbi,xa=this.instantaneousSupportInformationManager.vbi,ia=this.instantaneousSupportInformationManager.ubi;var aa=!1;ca!==this.RDd&&(aa=!0,this.RDd=ca);ta!==this.TDd&&(aa=!0,this.TDd=ta);xa!==this.SDd&&(aa=!0,this.SDd=xa);ia!==this.QDd&&(aa=!0,this.QDd=ia);const ya=[];u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(aa=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",
null),ya.push(aa),aa=!0);u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(aa=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),ya.push(aa),aa=!0);u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(aa=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),ya.push(aa),aa=!0);aa&&(ca=excelOnlineCalc.calc.recalcServiceConfig(null,ca,null,ta,null,null,null,xa,ya,ia),this.Sq.reconfigure(ca))}}etj(ca){let aa=
null;if(this.Ue.mb(this.currentStateId))try{this.m$=[],aa=this.Jc.Ib.Bc("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${J[ca]}`),f.a.forEach(this.Ue.na(this.currentStateId).RZa,(ta,xa)=>{xa.puc||(this.y8g(ta,xa.sue,xa.sheetName),xa.puc=!0)},null),this.Sq.updateRanges(this.currentStateId,this.m$)}finally{aa&&aa.stop()}else c.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}dtj(){const ca=
[],aa=this.dve();var ta=aa&&this.Ue.na(this.jt).Gj&&this.Ue.na(this.jt).Gj[0]&&this.Ue.na(this.jt).Gj[0].Akc?this.Ue.na(this.jt).Gj[0].i5:null;this.Oze(ta,this.Ue.na(this.currentStateId).Gj[0].i5,null,this.jt,ca);this.Ue.na(this.currentStateId).Gj[0].Akc=!0;for(let xa=1;xa<this.Ue.na(this.currentStateId).Gj.length;xa++)ta=-1,aa&&this.Ue.na(this.jt).Gj&&(ta=this.nfd(this.Ue.na(this.currentStateId).Gj[xa].J6.sheetName,this.jt)),ta=-1!==ta&&this.Ue.na(this.jt).Gj[ta].Akc?this.Ue.na(this.jt).Gj[ta].i5:
null,this.Oze(ta,this.Ue.na(this.currentStateId).Gj[xa].i5,this.Ue.na(this.currentStateId).Gj[xa].J6.sheetId,this.jt,ca),this.Ue.na(this.currentStateId).Gj[xa].Akc=!0;this.Sq.updateNamedObjects(this.currentStateId,ca)}Oze(ca,aa,ta,xa,ia){if(void 0!==ta&&null!==ta){var ya=excelOnlineCalc.calc.undefinedNamesWrite(ta);ia.push(ya)}if(ca){var ib=!1;ya=[];var wa=[];if(aa)for(let Ya of aa){const bb=Ya.value;if(ca.mb(Ya.key)){var sa=ca.na(Ya.key);M.yCi(sa,bb)?ib=!0:(sa=excelOnlineCalc.calc.namedObject(Ya.key,
null),ya.push(sa),M.lTc(Ya.key,bb,wa))}else M.lTc(Ya.key,bb,wa)}for(let Ya of ca)aa&&aa.mb(Ya.key)||(ca=excelOnlineCalc.calc.namedObject(Ya.key,null),ya.push(ca));ib&&(aa=excelOnlineCalc.calc.namedObjectsPromote(ta,xa),ia.push(aa));0<ya.length&&(aa=excelOnlineCalc.calc.namedObjectsWrite(ta,ya),ia.push(aa));0<wa.length&&(ta=excelOnlineCalc.calc.namedObjectsWrite(ta,wa),ia.push(ta))}else if(aa){xa=[];for(wa of aa)M.lTc(wa.key,wa.value,xa);0<xa.length&&(ta=excelOnlineCalc.calc.namedObjectsWrite(ta,xa),
ia.push(ta))}}$Ng(){return this.Ue.na(this.currentStateId).RZa[this.Osa]?(c.ULS.sendTraceTag(537170121,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.Osa} StateId:${this.currentStateId} previously handled`),!0):!1}SNg(ca){return 1===ca.getColumnNumbers().length&&ca.getColumnNumbers()[0]===M.$ud+1?!1:!0}i$h(){let ca=!1;z.g(this.Jc).Ea.oad(aa=>{aa.state&1&&this.Jc.ea.Ke===aa.se.Revision&&(this.fEe(aa),ca=!0)});return ca}YBe(ca,aa){var ta=ca.getRowNumbers(),xa=ca.getColumnNumbers();
ca=ta[0]-1;ta=ta[ta.length-1]-1;const ia=xa[0]-1;xa=xa[xa.length-1]-1;aa=this.Fvb(aa);if(!aa){const ya=this.Ue.mb(this.currentStateId)&&this.Ue.na(this.currentStateId).Gj?this.Ue.na(this.currentStateId).Gj.length:0;c.ULS.sendTraceTag(537170120,0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${ya}`)}return M.j$("CreateBlockRangeLocation",aa,ca,ia,ta,xa)}RBg(ca,aa,ta){if(ta=this.YBe(ca,ta)){var xa=M.m3b(ca.getRowNumbers());ca=M.m3b(ca.getColumnNumbers());
aa=excelOnlineCalc.calc.rangePromote(ta,aa,xa,ca);this.m$[this.m$.length]=aa}}TBg(ca,aa){if(aa=this.YBe(ca,aa)){var ta=M.m3b(ca.getRowNumbers());ca=M.m3b(ca.getColumnNumbers());ca=excelOnlineCalc.calc.rangeWrite(aa,null,ta,ca);this.m$[this.m$.length]=ca}}v_g(ca,aa,ta){let xa=null,ia=0,ya=0;switch(aa.valueType){case 2:xa=this.agd(aa);var ib=this.agd(ta);ib=B.a.equals(ib,xa,!1);break;case 1:null===aa.value&&null===ta.value?ib=!0:(ia=parseFloat(aa.value),ib=parseFloat(ta.value)===ia);break;default:null===
aa.value&&null===ta.value?ib=!0:(ya=parseFloat(aa.value),ib=ya===parseFloat(ta.value))}ib&&aa.valueType===ta.valueType&&aa.ifmt===ta.ifmt&&aa.formulaType===ta.formulaType&&B.a.equals(ta.formula,aa.formula,!1)||(void 0!==aa.formula&&null!==aa.formula||void 0!==aa.value&&null!==aa.value||void 0!==aa.text&&null!==aa.text?this.SXb(ca,aa,xa,ia,ya):this.Wke(ca,aa))}mBg(ca){if(this.Jc.zb&&this.Jc.zb.items)for(let ya=0;ya<this.Jc.zb.count;ya++){var aa=this.Jc.zb.items[ya];if(2!==aa.type&&3!==aa.type)continue;
var ta=0,xa=aa.name,ia=xa.lastIndexOf("!");if(0<ia){ta=xa.substr(0,ia);"'"===ta.charAt(0)&&(ta=ta.substr(1,ta.length-2));ta=this.nfd(ta,this.currentStateId);if(-1===ta){aa=this.Ue.mb(this.currentStateId)&&this.Ue.na(this.currentStateId).Gj?this.Ue.na(this.currentStateId).Gj.length:0;c.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${aa}`);continue}xa=xa.substr(ia+1)}ta=this.Ue.na(this.currentStateId).Gj[ta].i5;let ib=aa.usedRange;
2===aa.type&&(ib=w.a(aa));if(ta.mb(xa)){if(ia=ta.na(xa),ia.range=ib,ia.attributes=aa.attributes,2===ia.type&&(xa=M.SRe(aa.name,ca),aa=(ta=u.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc"))?aa.mO:null===xa||void 0===xa?void 0:xa.ColHeadersList,xa||ta))if(!ia.zE)ia.zE=new r(aa);else if(aa)for(const wa of aa.HeadersList)ia.zE.V9.ia(wa.Index,wa.Name)}else if(ia=this.Fvb(aa.sheetName)){ia=new F(aa.type,aa.name,ib,ia,aa.attributes);if(2===ia.type)if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc")&&
aa.mO)ia.zE=new r(aa.mO);else if(aa=M.SRe(aa.name,ca))ia.zE=new r(aa.ColHeadersList);ta.ia(xa,ia)}else aa=this.Ue.mb(this.currentStateId)&&this.Ue.na(this.currentStateId).Gj?this.Ue.na(this.currentStateId).Gj.length:0,c.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${aa}`)}}SXb(ca,aa,ta,xa,ia){var ya=ca.getRowNumbers()[aa.row]-1;ca=ca.getColumnNumbers()[aa.col]-1;ya=M.j$("AddRangeUpdateCommand",this.crb,ya,ca,ya,ca);ca=null;
let ib=aa.formula||aa.text;const wa=excelOnlineCalc.calc.blankValue;let sa=null;void 0!==aa.text&&null!==aa.text||void 0!==aa.value&&null!==aa.value||(ta="",sa="This cell contains blanks only",0===aa.formulaType&&(ib=""));switch(aa.valueType){case 2:null!==ta&&(0===aa.formulaType&&(ca=excelOnlineCalc.calc.valueCellData(ib,ta,aa.ifmt,sa)),1===aa.formulaType&&(ca=excelOnlineCalc.calc.cellFormulaCellData(ib,ta,aa.ifmt,sa)),2===aa.formulaType&&(ca=excelOnlineCalc.calc.valueCellData("",wa,0,"This cell is a part of an array")));
break;case 1:isNaN(xa)?c.ULS.sendTraceTag(537170116,0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${aa.row},${aa.col}) invalid numeric value`):(0===aa.formulaType&&(ca=excelOnlineCalc.calc.valueCellData(ib,xa,aa.ifmt,null)),1===aa.formulaType&&(ca=excelOnlineCalc.calc.cellFormulaCellData(ib,xa,aa.ifmt,null)),2===aa.formulaType&&(ca=excelOnlineCalc.calc.valueCellData("",wa,0,"This cell is a part of an array")));break;case 3:isNaN(ia)?c.ULS.sendTraceTag(537170115,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${aa.row},${aa.col}) invalid boolean value`):
(ta=1===ia?!0:!1,0===aa.formulaType&&(ca=excelOnlineCalc.calc.valueCellData(ib,ta,aa.ifmt,null)),1===aa.formulaType&&(ca=excelOnlineCalc.calc.cellFormulaCellData(ib,ta,aa.ifmt,null)),2===aa.formulaType&&(ca=excelOnlineCalc.calc.valueCellData("",wa,0,"This cell is a part of an array")));break;case 4:isNaN(ia)?c.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${aa.row},${aa.col}) invalid error value`):(ta=excelOnlineCalc.calc.errorValue(ia),0===aa.formulaType&&(ca=excelOnlineCalc.calc.valueCellData(ib,
ta,aa.ifmt,null)),1===aa.formulaType&&(ca=excelOnlineCalc.calc.cellFormulaCellData(ib,ta,aa.ifmt,null)),2===aa.formulaType&&(ca=excelOnlineCalc.calc.valueCellData("",wa,0,"This cell is a part of an array")));break;default:ca=excelOnlineCalc.calc.valueCellData("",wa,aa.ifmt,null)}ca&&(aa=excelOnlineCalc.calc.rangeWrite(ya,ca,null,null),this.m$[this.m$.length]=aa)}SBg(ca,aa){switch(aa.valueType){case 2:this.SXb(ca,aa,this.agd(aa),null,0);break;case 1:this.SXb(ca,aa,null,parseFloat(aa.value),0);break;
default:this.SXb(ca,aa,null,null,parseFloat(aa.value))}}Wke(ca,aa){var ta=ca.getRowNumbers()[aa.row]-1;ca=ca.getColumnNumbers()[aa.col]-1;ta=M.j$("AddRangeUpdateCommandEmptyCell",this.crb,ta,ca,ta,ca);aa=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,aa.ifmt,null);aa=excelOnlineCalc.calc.rangeWrite(ta,aa,null,null);this.m$[this.m$.length]=aa}Fvb(ca){ca=this.nfd(ca,this.currentStateId);return 0<ca?this.Ue.na(this.currentStateId).Gj[ca].J6.sheetId:null}nfd(ca,aa){if(!this.Ue.mb(aa))return c.ULS.sendTraceTag(537170113,
0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${aa} does not exist in GridCache`),-1;const ta=this.Ue.na(aa);return ta.Gj?ta.getSheetIndex(ca):(c.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${aa}`),-1)}Csj(){if(!this.Ue.mb(this.currentStateId)||!this.Ue.na(this.currentStateId).Gj.length)return c.ULS.sendTraceTag(537170083,0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),
!1;const ca=[];for(let aa=1;aa<this.Ue.na(this.currentStateId).Gj.length;aa++){const ta=this.Ue.na(this.currentStateId).Gj[aa];ta&&ca.push(ta.J6)}this.Sq.updateSheetNames(this.currentStateId,ca);this.Sq.updateUnusedCells(this.currentStateId,this.Ue.na(this.currentStateId).Ebg);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var ca=[];for(const aa of this.instantaneousSupportInformationManager.Pxa){const ta=excelOnlineCalc.calc.numberFormat(aa.IfmtIndex,aa.FormatString,
aa.Builtin);ca.push(ta)}this.Sq.setNumberFormats(ca,!0)}}Yoj(){if(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.De){var ca=this.m$h();if(!this.Fsd||ca)this.l3b(),this.instantaneousSupportInformationManager.De.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.De.TrueValueString),this.instantaneousSupportInformationManager.De.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.De.FalseValueString),ca=D.CalcHelper.WCe(this.instantaneousSupportInformationManager,
ca),this.Sq.setLocale(ca),this.Fsd=!0}}ptj(){var ca=null;if(void 0!==this.Jc.workbookContext.TimeZoneInformation&&null!==this.Jc.workbookContext.TimeZoneInformation){ca=null;this.Jc.workbookContext.TimeZoneInformation.StandardDate.Month&&(ca=excelOnlineCalc.date.dateTime(this.Jc.workbookContext.TimeZoneInformation.StandardDate.Year,this.Jc.workbookContext.TimeZoneInformation.StandardDate.Month,this.Jc.workbookContext.TimeZoneInformation.StandardDate.Day,this.Jc.workbookContext.TimeZoneInformation.StandardDate.Hour,
this.Jc.workbookContext.TimeZoneInformation.StandardDate.Minute,this.Jc.workbookContext.TimeZoneInformation.StandardDate.Second,this.Jc.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.Jc.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let aa=null;this.Jc.workbookContext.TimeZoneInformation.DaylightDate.Month&&(aa=excelOnlineCalc.date.dateTime(this.Jc.workbookContext.TimeZoneInformation.DaylightDate.Year,this.Jc.workbookContext.TimeZoneInformation.DaylightDate.Month,
this.Jc.workbookContext.TimeZoneInformation.DaylightDate.Day,this.Jc.workbookContext.TimeZoneInformation.DaylightDate.Hour,this.Jc.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.Jc.workbookContext.TimeZoneInformation.DaylightDate.Second,this.Jc.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.Jc.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));ca=excelOnlineCalc.date.tzData(this.Jc.workbookContext.TimeZoneInformation.Bias,ca,this.Jc.workbookContext.TimeZoneInformation.StandardBias,
aa,this.Jc.workbookContext.TimeZoneInformation.DaylightBias)}else c.ULS.sendTraceTag(537170082,0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");ca=excelOnlineCalc.calc.workbookProps(this.Jc.workbookContext.F1904,this.Jc.workbookContext.FDateCompatibility,ca);this.Sq.setWorkbookProps(ca)}Vna(){u.EwaSettings.ma(305)&&m.c(excelOnlineCalc.worker.runSmokeTest(1/0,this.B4f,!0)).continueWith(xa=>{xa.exception?c.ULS.sendTraceTag(537170079,0,15,`CalcAsyncEngine.TryInitialize: calc smoke test failed: ${xa.exception.toString()}`):
c.ULS.sendTraceTag(537170080,0,50,"CalcAsyncEngine.TryInitialize: calc smoke test ended - a new one should start")});const ca=u.EwaSettings.ma(650)?n.local:n.tIj,[aa,ta]=y.a.UU()?[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()]:[void 0,void 0];this.fGd=m.c(excelOnlineCalc.calc.createRecalcService(ca,aa,ta));this.fGd.continueWith(xa=>{xa.exception?c.ULS.sendTraceTag(537170075,0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${xa.exception.toString()}`):
(c.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),(this.Sq=this.fGd.result)?this.GNb(0)?this.grj():c.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):c.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}m$h(){const ca=this.instantaneousSupportInformationManager.Kia;if(!ca||this.ZDd===ca.length)return null;this.ZDd=ca.length;return D.CalcHelper.GCe(ca)}l3b(){this.errorTypeNames=
D.CalcHelper.l3b()}o$h(){if(!(this.Ue.mb(this.currentStateId)&&0<this.Ue.na(this.currentStateId).Gj.length)){this.Ue.ia(this.currentStateId,new U(this.dnd));this.Ue.na(this.currentStateId).r_f(0,new H(null));var ca=this.Jc.xa;for(let xa=0;xa<ca.count;xa++){var aa=Object(k.a)(x.a,ca.getItem(xa));if(aa){void 0!==aa.sheetId&&null!==aa.sheetId&&void 0!==aa.name&&null!==aa.name&&aa.sheetId.length&&aa.sheetName.length||c.ULS.sendTraceTag(537170074,0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${xa} Id:${aa.sheetId} Hash:${aa.hash} NameLength:${aa.name?
aa.name.length:-1}`);var ta=void 0;ta=excelOnlineCalc.calc.sheetName(aa.sheetId,aa.name);this.Ue.na(this.currentStateId).r_f(xa+1,new H(ta));ta=aa.usedRange.WR();ta=excelOnlineCalc.calc.rangeLocation(0,0,ta.LastRow,ta.LastColumn);aa=excelOnlineCalc.calc.unusedCellsUpdate(aa.sheetId,ta);this.Ue.na(this.currentStateId).Ebg.push(aa)}else c.ULS.sendTraceTag(537170073,0,15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${xa}`)}}}aXg(){for(let ca of this.Ue)ca.key<
this.jt&&this.Ue.remove(ca.key)}agd(ca){ca=ca.value||ca.text;if(void 0===ca||null===ca)ca="";return ca}oPj(){if(!this.Ue.mb(this.currentStateId))return!1;let ca=!1;f.a.forEach(this.Ue.na(this.currentStateId).RZa,(aa,ta)=>{ta.puc||(ca=!0)},null);return ca}L2c(ca){const aa={};aa.reason=ca;aa.kind=1;return aa}Pfc(){return this.Ue.mb(this.currentStateId)&&this.Ue.na(this.currentStateId).Gj&&this.Ue.na(this.currentStateId).Gj[0]&&this.Ue.na(this.currentStateId).Gj[0].i5?!0:!1}static C4g(ca){const aa=[];
if(null===ca||void 0===ca?0:ca.V9)for(let ta of ca.V9)ca=excelOnlineCalc.calc.columnData(ta.key,ta.value),aa.push(ca);return aa}static yCi(ca,aa){if(ca.type!==aa.type||ca.attributes!==aa.attributes||!B.a.equals(ca.fullName,aa.fullName,!1)||!ca.range.equals(aa.range))return!1;if(!ca.zE&&!aa.zE)return!0;if(!ca.zE||!aa.zE||ca.zE.V9.count!==aa.zE.V9.count)return!1;for(let ta of ca.zE.V9){let xa;if(!(ta.value&&({value:xa}=aa.zE.V9.Dc(ta.key)).returnValue&&xa&&B.a.equals(ta.value,xa,!1)))return!1}return!0}static lTc(ca,
aa,ta){var xa=M.j$("NamedObject",aa.sheetId,aa.range.top-1,aa.range.left-1,aa.range.bottom-1,aa.range.right-1);if(2===aa.type){const ia=!!(aa.attributes&16),ya=!!(aa.attributes&8);aa=M.C4g(aa.zE);xa=excelOnlineCalc.calc.namedTableData(xa,ia,ya,aa);ca=excelOnlineCalc.calc.namedObject(ca,xa)}else xa=excelOnlineCalc.calc.namedRangeData(xa),ca=excelOnlineCalc.calc.namedObject(ca,xa);ta.push(ca)}static QVe(ca){const aa=Sys.Serialization.JavaScriptSerializer.serialize(ca.getRowNumbers());ca=Sys.Serialization.JavaScriptSerializer.serialize(ca.getColumnNumbers());
return aa+ca}static m3b(ca){let aa=null;if(1<ca.length)for(let ta=1;ta<ca.length;ta++){let xa=0;for(;ca[ta-1]+1+xa<ca[ta];)aa=aa||[],aa.push(ca[ta-1]+xa),xa++}return aa}static SRe(ca,aa){if(!aa)return null;for(let ta=0,xa=aa.length;ta<xa;++ta)if(B.a.equals(ca,aa[ta].Name,!1))return aa[ta];return null}static j$(ca,aa,ta,xa,ia,ya){const ib=(wa,sa,Ya,bb)=>{(0>Ya||Ya>=bb)&&c.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${wa} invalid ${sa}:${Ya}`)};void 0!==aa&&
null!==aa||c.ULS.sendTraceTag(537170071,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${ca} sheetId is null`);ib(ca,"top",ta,M.Sof);ib(ca,"left",xa,M.$ud);ib(ca,"bottom",ia,M.Sof);ib(ca,"right",ya,M.$ud);return excelOnlineCalc.calc.sheetRangeLocation(aa,ta,xa,ia,ya)}}M.Sof=1048576;M.$ud=16384;Object(t.a)(M,"CalcAsyncEngine",null,[2]);class G{constructor(){this.iK=this.jK=this.qF=this.rF=this.uZ=!1}}Object(t.a)(G,"AbsoluteRelativeReferenceInfo",null,[]);var T=a(977),K=a(24);class L{}L.bHf=
"#";Object(t.a)(L,"Operators",null,[]);var V=a(978);class W{}W.sheet="Sheet";W.sheetRange="SheetRange";W.document="Document";W.W6h="Ident";Object(t.a)(W,"TraverseFormulaQualifierTypes",null,[]);var da=a(979),qa=a(869),O=a(785),ea=a(43),R=a(55),oa=a(64),pa=a(455),Pa=a(38);class Z extends Sys.EventArgs{constructor(ca){super();this.Ck=ca}}Object(t.a)(Z,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);class Ra extends Pa.a{constructor(ca){super();this.Pt=null;this.Sfg=!1;this.CKd=this.instantaneousSupportInformationManager=
this.pFb=null;this.Exd=new Map;this.Xae=null;this.xmc=aa=>{c.ULS.sendTraceTag(537170005,0,50,"CalcManager.OnLocaleInformationAvailable() called");aa.yId(this.xmc);aa.Kia.length?this.dmc(aa,Sys.EventArgs.Empty):(c.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),aa.jme(this.dmc))};this.dmc=aa=>{c.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");aa.pId(this.dmc);this.$Mj(aa)};this.onContentReady=()=>{this.Pt&&
(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Rkd||R.Task.delay(0).continueWith(()=>{this.Pt.GNb(1)},0,null,oa.a.current))};this.Otf=(aa,ta)=>{this.Pt&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Rkd||this.Pt.fEe(ta.fd.block))};c.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.tec=!1;this.jb=ca;this.fq=z.g(ca);this.CEc=null;this.gridView.Ku(this.onContentReady);this.gridView.Ea.KTc(this.Otf);this.$.da.Za(268,
aa=>{aa.De?(c.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),this.xmc(aa,Sys.EventArgs.Empty)):(c.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),aa.Eme(this.xmc))})}gEg(ca){this.addHandler(Ra.G6c,ca)}taj(ca){this.removeHandler(Ra.G6c,ca)}Grf(ca){this.raiseEvent(Ra.G6c,new Z(ca))}get Kr(){return this.CEc}get gridView(){return this.fq}get $(){return this.jb}get jD(){return this.Xae}get localeInfo(){return this.Kr?this.Kr.config.localeInfo:
null}get config(){return this.Kr.config}dispose(){c.ULS.sendTraceTag(537170064,0,50,"CalcManager.Dispose called");this.$.da.Za(268,ca=>{ca.yId(this.xmc);ca.pId(this.dmc)});this.gridView&&(this.gridView.py(this.onContentReady),this.gridView.Ea&&this.gridView.Ea.jPf(this.Otf),this.fq=null);this.CEc=null}ZSg(ca,aa,ta,xa=null){this.Pt&&this.Pt.XSg(ca,aa,ta,xa)}evalFormula(ca,aa,ta,xa){return this.Pt?this.Pt.evalFormula(ca,aa,ta,xa):Promise.reject("calc engine not initialized")}Esb(ca,aa,ta,xa){return this.Pt?
this.Pt.Esb(ca,aa,ta,xa):Promise.reject("CalcEngine is null")}W3a(ca){return this.Pt?(c.ULS.shipAssertTag(537170059,0,2===ca.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table"),this.Pt.W3a(ca)):null}sIg(ca,aa){if(!aa||2!==ca.type)return!1;ca=w.a(ca);return ca.right-ca.left+1===aa.count}CQe(ca){if(!this.pFb)return this.Sfg||c.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),null;var aa=this.Bsa(K.Range.Uc(1,1));aa=this.pFb.parseFormula(excelOnlineCalc.parse.parseLocals(1,
aa.range),ca);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(aa))return c.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{let ta;if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:6518739_FlightRemovalStructuredReferencesHighlighting")){const xa=this.gridView.ha.sa.activeCell,ia=excelOnlineCalc.location.gridCell(xa.top-1,xa.left-1),ya=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),ib=excelOnlineCalc.location.sheetIndex(ya,
this.$.xa.pa.sheetId),wa=this.U8g(ia,ib);this.CKd||(this.CKd=excelOnlineCalc.util.createResolver(this.T8g()));ta=excelOnlineCalc.parse.parseResultHelper.extractReferences(aa,this.Kr.config.localeInfo,u.EwaSettings.ma(587),wa,this.CKd)}else ta=excelOnlineCalc.parse.parseResultHelper.extractReferences(aa,this.Kr.config.localeInfo,u.EwaSettings.ma(587));u.EwaSettings.ma(102)&&this.ESj(ta,ca);return ta}catch(ta){return c.ULS.sendTraceTag(537170055,0,10,`CalcManager.ExtractReferenceWrappers - exception: ${ta.message}`),
null}}extractLetVariables(ca,aa){if(!this.pFb)return this.Sfg||c.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;const ta=this.Bsa(K.Range.Uc(1,1));ca=this.pFb.parseFormula(excelOnlineCalc.parse.parseLocals(1,ta.range),ca);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(ca))return c.ULS.sendTraceTag(537170053,0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(ca,
aa,this.Kr.config.localeInfo)}catch(xa){return c.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${xa.message}`),null}}extractReferences(ca,aa,ta,xa){if(!aa)return c.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!ta)return c.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),null;const ia=this.CQe(ca);if(!ia)return c.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),
null;try{return this.R7g(ia,aa,ta,ca,xa)}catch(ya){return c.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${ya.message}`),null}}mXh(ca,aa,ta,xa){if(!ca)return c.ULS.sendTraceTag(537170019,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - range is null"),null;if(!aa||0>=aa.length)return c.ULS.sendTraceTag(537170018,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - formula is null/empty"),null;ca=this.Bsa(ca);if(!this.Kr||!ca)return null;
const ia=this.lub(ca).returnValue;if(!ia||ia.I5a)return null;ta=excelOnline.utils.getCharIndexInTextFromPoint(ta,xa,u.EwaSettings.ma(587));return 0>ta?null:excelOnlineCalc.runtime.getSubExpressionFromFormulaCharacterIndex(this.Kr.config,ta,aa,ca)}NSg(ca,aa,ta,xa){if(!ca)return c.ULS.sendTraceTag(537170017,0,10,"CalcManager.CalcPartialResultsForFormula - range is null"),null;let ia=null;return this.evalFormula(aa,ca,void 0,excelOnlineCalc.calc.evalFormulaFormatOrigin()).then(ya=>{let ib;const wa=({kind:ib}=
this.Kr.ylh(ya,ta)).returnValue;8!==ib||wa.length&&wa!==D.CalcHelper.unknownError?ya=0:(c.ULS.sendTraceTag(537170016,0,50,"EvalSession.GetPartialResultValueForFormula - EvalResultToString error"),ya=excelOnlineCalc.calc.getEvalFailureReason(ya),void 0!==ya&&null!==ya||c.ULS.shipAssertTag(537170015,0,!1,"CalcHelper.GetEvalFailureReason() - result is not a failure, function should not be called"),ya=1);return ia=xa?new T.a(wa,xa.start,xa.end,ya):new T.a(wa,-1,-1,ya)},ya=>{c.ULS.sendTraceTag(537170014,
0,10,`EvalSession.GetPartialResultValueForFormula - exception: ${ya}`);return Promise.resolve(ia)})}getSubExpressionSpan(ca){return this.Kr&&ca?excelOnlineCalc.runtime.getSubExpressionSpan(ca):null}getFormulaSubExpressionObject(ca,aa,ta){return this.Kr&&ca&&aa&&ta?excelOnlineCalc.runtime.getFormulaSubExpressionObject(this.Kr.config,aa,ta,this.Bsa(ca)):null}pXh(ca,aa,ta){return this.Kr&&ca&&aa?excelOnlineCalc.runtime.getSubstitutedSubExpressionString(this.Kr.config,aa,ta,this.Bsa(ca)):null}nXh(ca,
aa,ta){return this.Kr&&ca&&aa?excelOnlineCalc.runtime.getSubExpressionSubspans(this.Kr.config.localeInfo,aa,ta):null}xQh(){return this.Kr?this.Kr.config.localeInfo.listSeparator:null}isFormulaSubExpressionVolatile(ca){return this.Kr?excelOnlineCalc.runtime.isFormulaSubExpressionVolatile(this.Kr.config.localeInfo,ca):!1}Bsa(ca,aa=!0){return ca&&this.Kr?this.Kr.r9g(this.Kr.hah(),ca.top-1,ca.left-1,aa):null}chi(ca,aa){ca=this.lac(ca);if(void 0===ca||null===ca)return null;ca=this.jD.createFormat(ca.FormatString,
ca.Builtin);if(!excelOnlineCalc.util.isSuccess(ca))return null;aa=this.jD.parseEdit(aa,ca.value);return excelOnlineCalc.util.isSuccess(aa)?aa.value.kind===qa.a.formula:null}jac(ca){if(null==this.jD)return Object(pa.a)("Number formatter is null");if(null==this.instantaneousSupportInformationManager)return Object(pa.a)("Instantaneous manager is null");if(this.Exd.has(ca))return Object(pa.d)(this.Exd.get(ca));if("number"===typeof ca){var aa=this.lac(ca);if(null==aa)return Object(pa.a)(`Invalid ifmt=${ca}`);
var ta=aa.FormatString;aa=aa.Builtin}else ta=ca,aa=!1;ta=this.jD.createFormat(ta,aa);return excelOnlineCalc.util.isSuccess(ta)?(this.Exd.set(ca,ta.value),Object(pa.d)(ta.value)):Object(pa.a)("Could not create number format")}getWorksheetFuncId(ca){return this.localeInfo.getWorksheetFuncId(ca)}R7g(ca,aa,ta,xa,ia){const ya={Items:[]};for(let Ya=0;Ya<ca.length;Ya++){var ib=ca[Ya];const bb={};bb.Start=ib.span.start;bb.End=ib.span.end;if(ia||ib.kind!==V.a.func)if(ia||ib.kind!==V.a.Fri){if(!this.Sgh(ib,
aa,ta))continue;var wa=new G;const mb=this.jUh(ib,aa,wa,xa);if(u.EwaSettings.ma(587)){var sa=this.oQh(ib);const Ca=this.nQh(ib);if(mb||Ca&&0<=sa){let $a={};$a.Span=bb;$a.LetNumber=sa;$a.LetName=Ca;$a.Range=mb;$a.IsRangeRef=wa.uZ;$a.IsAbsoluteFirstRow=wa.rF;$a.IsAbsoluteFirstColumn=wa.qF;$a.IsAbsoluteSecondRow=wa.jK;$a.IsAbsoluteSecondColumn=wa.iK;$a.IsStructRef=ib.kind===V.a.nTd;ya.Items.push($a)}}else mb&&(sa={},sa.Span=bb,sa.Range=mb,sa.IsRangeRef=wa.uZ,sa.IsAbsoluteFirstRow=wa.rF,sa.IsAbsoluteFirstColumn=
wa.qF,sa.IsAbsoluteSecondRow=wa.jK,sa.IsAbsoluteSecondColumn=wa.iK,sa.IsStructRef=ib.kind===V.a.nTd,ya.Items.push(sa))}else ib=ib.ref.value.oper.kind,wa={},wa.Span=bb,wa.IsString=2===ib,wa.IsBoolean=4===ib,wa.IsNumber=1===ib,ya.Items.push(wa);else bb.End=ib.span.start+ib.ref.name.length,ib={},ib.Span=bb,ib.IsFunction=!0,ib.FunctionId=this.getWorksheetFuncId(xa.substring(bb.Start,bb.End)),ya.Items.push(ib)}ya.Items.sort((Ya,bb)=>Ya.Span.Start-bb.Span.Start);return ya}oQh(ca){return ca.kind===V.a.Fjf?
ca.ref.number:-1}nQh(ca){return ca.kind===V.a.Fjf?ca.ref.name:null}jUh(ca,aa,ta,xa){if(ca.kind===V.a.range)return ta.uZ=!0,this.WAe(ca,aa,ta,xa);if(ca.kind===V.a.namedRange){ta=ca.ref;(ca=this.$.zb.getItemByName(ta.name))||(ca=this.$.zb.getItemByName(aa+"!"+ta.name));if(!(ca&&ca.sheetName&&ca.usedRange&&B.a.equals(ca.sheetName,aa,!0)))return null;aa=2===ca.type?w.a(ca):ca.usedRange;return ea.m(aa,ca)}if(ca.kind===V.a.nTd){let ia=ca.ref,ya;ia.name?(ya=this.$.zb.getItemByName(ia.name))||(ya=this.$.zb.getItemByName(aa+
"!"+ia.name)):ya=this.gridView.Db.Yj(this.gridView.ha.sa.activeCell);if(!(ya&&ya.sheetName&&ya.usedRange&&B.a.equals(ya.sheetName,aa,!0)))return null;ta.uZ=!1;return this.WAe(ca,aa,ta,xa)}return null}WAe(ca,aa,ta,xa){ca=ca.ref;if(ca.type){if(ca.type===da.a.column){var ia=ca.startIndex;ca=ca.endIndex;ta.qF=ia.kind===O.a.abs;ta.iK=ca.kind===O.a.abs;return this.createRange(0,ia.index,d.a.dh,ca.index,aa)}if(ca.type===da.a.row)return ia=ca.endIndex,ta.rF=ca.startIndex.kind===O.a.abs,ta.jK=ia.kind===O.a.abs,
this.createRange(ca.startIndex.index,0,ca.endIndex.index,d.a.mh,aa);if(ca.type===da.a.cell){ia=ca.row;var ya=ca.col;ta.rF=ta.jK=ia.kind===O.a.abs;ta.qF=ta.iK=ya.kind===O.a.abs;return this.K0b(ca.span.end,xa)&&(ta=K.Range.Uc(ia.index+1,ya.index+1),ta=this.gridView.Db.F1e(ta))?ea.n(ta,aa):this.createRange(ia.index,ya.index,ia.index,ya.index,aa)}if(ca.type===da.a.range){ia=ca.top;ya=ca.left;xa=ca.bottom;ca=ca.right;const ib=Math.min(ia.index,xa.index),wa=Math.min(ya.index,ca.index),sa=Math.max(ia.index,
xa.index),Ya=Math.max(ya.index,ca.index);ta.rF=ia.kind===O.a.abs;ta.jK=xa.kind===O.a.abs;ta.qF=ya.kind===O.a.abs;ta.iK=ca.kind===O.a.abs;return this.createRange(ib,wa,sa,Ya,aa)}c.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${ca.type}'`);return null}c.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null}K0b(ca,aa){return aa.length>=ca&&0<ca&&aa.charAt(ca-1)===L.bHf}USg(ca,aa,ta){this.Pt&&
this.Pt.YSg(ca,aa,ta)}lac(ca){return this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Pxa&&this.instantaneousSupportInformationManager.Pxa[ca]&&this.jD?this.instantaneousSupportInformationManager.Pxa[ca]:null}toXLNumber(ca){if(!this.jD)return null;ca=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.jD,ca);return excelOnlineCalc.util.isSuccess(ca)?ca.value:null}ESj(ca,aa){if(ca)for(const ta of ca)ta.ref.type&&ta.ref.type===da.a.cell&&(ca=ta.ref,Ra.jZi(ca,
aa)&&(ca.span.end+=1,ta.span.end+=1))}createRange(ca,aa,ta,xa,ia){const ya={};ya.FirstRow=ca;ya.FirstColumn=aa;ya.LastRow=ta;ya.LastColumn=xa;ya.SheetName=ia;return ya}Sgh(ca,aa,ta){var xa=ca.ref.qualifier;if(!xa)return!0;switch(ca.ref.qualifier.type){case W.sheet:return ca=xa.document,B.a.equals(xa.sheet,aa,!0)&&(!ca||B.a.equals(ca.document,ta,!0));case W.sheetRange:return aa=this.$.xa.getItemByName(aa),ta=this.$.xa.getItemByName(xa.sheet1),xa=this.$.xa.getItemByName(xa.sheet2),!!aa&&!!ta&&!!xa&&
(ta.index<=aa.index&&aa.index<=xa.index||xa.index<=aa.index&&aa.index<=ta.index);case W.document:return B.a.equals(xa.document,ta,!0);case W.W6h:return xa=xa.name,B.a.equals(xa,aa,!0)||B.a.equals(xa,ta,!0);default:return c.ULS.sendTraceTag(537170009,0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${xa.type}'`),!1}}$Mj(ca){this.instantaneousSupportInformationManager=ca;ca.Pxa.length&&ca.Kia.length?(this.CEc=new D.CalcHelper(this.gridView.$),this.pFb=this.Kr.createParser(),this.Xae=
this.Kr.createNumberFormatter(),this.tec=!0,c.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.Pt||(c.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.Pt=new M(this.$))):c.ULS.sendTraceTag(537170008,0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${ca.Pxa.length}, functions info count = ${ca.Kia.length}`)}lub(ca){if(!ca)return{returnValue:null,
emptyCell:!1};var aa=this.getSheetName(ca.sheet.index);if(!aa)return c.ULS.sendTraceTag(537169998,0,50,`CalcManager.GetCellFromBlockCache: No sheet index ${ca.sheet.index}`),{returnValue:null,emptyCell:!1};const ta=Ra.convertToRange(ca);aa=this.gridView.lub(aa,ta.top,ta.left);return aa?aa.Mgh?{returnValue:aa,emptyCell:!1}:(c.ULS.sendTraceTag(537169996,0,50,`CalcManager.GetCellFromBlockCache: cell ${ca.range.row} ${ca.range.col} is empty`),{returnValue:null,emptyCell:!0}):(c.ULS.sendTraceTag(537169997,
0,50,`CalcManager.GetCellFromBlockCache: cellProxy is null for cell ${ca.range.row} ${ca.range.col}`),{returnValue:null,emptyCell:!1})}getSheetName(ca){const aa=this.gridView.$.xa.getItem(ca);return aa?aa.sheetName:(c.ULS.sendTraceTag(537169995,0,50,`CalcManager.GetSheetName - no sheet in index ${ca}`),null)}U8g(ca,aa){const ta={allowUnqualifiedCell:!0,wrapCellReferences:!0};ta.config=this.Kr.config;ta.originGridCell=excelOnlineCalc.util.success(ca);ta.originSheet=excelOnlineCalc.util.success(aa);
return ta}T8g(){const ca={};ca.config=this.Kr.config;ca.getNameLoc=this.Pt.getNameLoc;ca.getContainingTable=this.Pt.getContainingTable;ca.getStructRefColumn=this.Pt.getStructRefColumn;ca.getStructRefSpecialRef=this.Pt.getStructRefSpecialRef;ca.getDocumentLoc=this.Pt.getDocumentLoc;ca.getSheetIndex=this.Pt.getSheetIndex;ca.getSheetName=this.Pt.getSheetName;ca.getUserDefinedFuncLoc=this.Pt.getUserDefinedFuncLoc;ca.getSheetRangeIndexes=this.Pt.getSheetRangeIndexes;return ca}static jZi(ca,aa){return aa.length>
ca.span.end&&aa.charAt(ca.span.end)===L.bHf}static convertToRange(ca){return K.Range.Uc(ca.range.row+1,ca.range.col+1)}}Ra.G6c="ECRC";Object(t.a)(Ra,"CalcManager",Pa.a,[516,2]);var Ga=a(37),Ba=a(54);class fa extends b.a{constructor(ca){super();this.$=ca;this.Fb()}create(){if(this.$){c.ULS.sendTraceTag(537169993,0,50,"CalcManagerFactory.Create: Start loading script");if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")){var ca=76;var aa="Current"}else ca=79,aa="Stable";
c.ULS.sendTraceTag(537169992,0,50,`CalcManagerFactory.Create: Calc ${aa} JS was loaded`);Ga.TaskExtensions.Aa(Ba.a.loadScript(ca,4,this.hb,void 0,void 0,265),()=>{c.ULS.sendTraceTag(537169991,0,50,"CalcManagerFactory.Create: Raised create service event");let ta=this.$.da.za(266,!1);ta||(c.ULS.sendTraceTag(537169990,0,50,"CalcManagerFactory.Create: CalcManager is not registered, creating new CalcManager"),ta=new Ra(this.$),u.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")&&
this.$.da.Ga(266,ta));this.qb(ta)},this.la,3)}else c.ULS.sendTraceTag(537169994,0,50,"CalcManagerFactory.Create: ewaControl is null, cann't create the service")}static ka(ca){ca&&ca.da&&ca.da.Ga(265,new fa(ca))}}Object(t.a)(fa,"CalcManagerFactory",b.a,[]);var Y=a(10);a.d(C,"a",function(){return ja});const ja=()=>{Y.a.Fa(fa.ka)}},1200:function(t,C,a){var c=a(10);t=a(0);var b=a(15),d=a(221),f=a(86),e=a(4),k=a(185),l=a(8),m=a(38),v=a(868),n=a(224),w=a(61),r=a(867);class u extends Sys.EventArgs{constructor(){super()}}
Object(t.a)(u,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var y=a(47),x=a(45);a(35);var B=a(29),z=a(1),A=a(610);a(22);var I=a(280),F=a(21);a(200);class U{constructor(M){this.data=M}}Object(t.a)(U,"NumberFormatDataHolder",null,[]);var X=a(164);class S extends m.a{constructor(M,G){super();this.eic=l.a.Ce;this.hYc=null;this.pfb=this.Qhc=!1;this.Tsf=(T,K)=>{var L;(T=F.g(this.$))&&(K=null!==(L=null===K||void 0===K?void 0:K.cell)&&void 0!==L?L:T.Vb(null))&&this.ZAa(K.cell.Gk,!0)};this.VJi=T=>{this.isActive()&&
(B.a.er(T.Errors)||!T.Result?(T=T.Errors?T.Errors.map(K=>JSON.stringify(K)).join(","):"None",b.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${T}`)):(T=T.Result,b.ULS.sendTraceTag(537155725,0,50,`Updating number format category cache, format index = ${T.Index}, category = ${T.Category}`),this.crj(T.Index,T.Category),this.raiseEvent(S.iZc,new v.a(T.Index,T.Category),this)))};this.refresh=()=>{b.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");
this.x0b();this.isActive()&&this.ea.jc.allowEdits&&(this.pfb||this.pn&&!(this.ea.E7a>this.eic)?this.YBc():(b.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),this.Mdd=r.a(this.$.oa.va,this.pn?this.pn.Digest:"",this.DKi,this.CKi,null,null)),b.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),this.lYe())};this.axf=T=>{b.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${T.data.status}, HTTP status = ${T.data.httpStatus}.`);
this.GJa=null};this.a_=()=>{this.pfb=!1;this.ea.BD(this.a_);this.CQa(this.Qhc?S.IPd:S.axd)};this.Xc=(T,K)=>{b.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");n.a(K)&&this.CQa(S.IPd)};this.Uf=()=>{b.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");3!==this.$.workbookContext.CalcMode&&this.mxd(0===this.$.workbookContext.CalcMode)};this.$c=()=>{b.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");
this.CQa(S.IPd);z.EwaSettings.ma(301)&&3!==this.$.workbookContext.CalcMode&&this.mxd(0===this.$.workbookContext.CalcMode)};this.vKi=(T,K,L)=>{b.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.GJa=null;this.isActive()?T.StateId===l.a.Ce?(b.ULS.sendTraceTag(537155682,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.YBc()):!T.Result||this.dX&&this.dX.length?this.CQa(S.axd):this.GAf(T,
K,L):b.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};this.GAf=T=>{this.dX=T.Result;b.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.dX?this.dX.length:-1} functions.`);T=!1;if(this.dX){for(const K of this.dX)K&&(this.ZTe[K.NameUI.toLocaleUpperCase()]=K.FunctionIndex.toString(),K.NameUI!==K.NameDataStrings&&(this.ZTe[K.NameDataStrings.toLocaleUpperCase()]=
K.FunctionIndex.toString(),T=!0),this.zDh.ia(K.FunctionIndex,K.NameUI));this.raiseEvent(S.Xad,Sys.EventArgs.Empty,this)}T&&b.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};this.DKi=T=>{if(this.isActive())if(b.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.Qhc=!1,this.eic=T.StateId,this.eic===l.a.Ce)this.Qhc=!0,this.YBc();else{if(T.Result){var K=this.pn;this.pn=T.Result;b.ULS.sendTraceTag(537155678,
0,50,`InstantaneousSupportInformation updated, new result digest: ${this.pn.Digest}.`);T=[];if(K)T=S.dRh(K.NumberFormats,this.pn.NumberFormats);else for(K=0;K<this.pn.NumberFormats.length;K++)this.$kc.ia(K,this.pn.NumberFormats[K].NumberFormatCategory);for(const L of T)this.$kc.ia(L,this.pn.NumberFormats[L].NumberFormatCategory);this.raiseEvent(S.Jxd,new u(T),this);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StructuredReferencesInRangePicker",!1)&&this.raiseEvent(S.Ckf)}this.CQa(S.axd)}};
this.CKi=T=>{this.isActive()&&(10===T.data.status?b.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(b.ULS.sendTraceTag(21311555,0,10,`Failed to update instantaneous support information, status = ${T.data.status}, HTTP status = ${T.data.httpStatus}.`),this.Qhc=!0,this.YBc()))};b.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");this.ea=M;this.$=G;this.pn=this.GJa=this.Mdd=this.YGb=null;this.$kc=new X.a;this.kub=new X.a;this.dX=
[];this.zDh=new X.a;this.ZTe={};this.ea.jk(this.Xc);this.$.el(this.$c);F.g(this.$).ha.iga(this.Tsf);z.EwaSettings.ma(301)&&this.ea.Lu(this.Uf);this.CQa(S.I8e);b.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end")}Eme(M){this.addHandler(S.Jxd,M)}yId(M){this.removeHandler(S.Jxd,M)}EDg(M){this.addHandler(S.iZc,M)}T$i(M){this.removeHandler(S.iZc,M)}jme(M){this.addHandler(S.Xad,M)}pId(M){this.removeHandler(S.Xad,M)}gFg(M){this.addHandler(S.Ckf,M)}get De(){return this.pn?
this.pn.LocaleInformation:null}get Pxa(){return this.pn?this.pn.NumberFormats:[]}get Kia(){this.dX&&this.dX.length||this.lYe();return this.dX}get tbi(){return this.pn&&void 0!==this.pn.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.pn.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.pn.InstantaneousCalcWebWorkerPrecisionSamplingRate:S.Pbh}get wbi(){return this.pn&&void 0!==this.pn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.pn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?
this.pn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:S.Tbh}get vbi(){return this.pn&&void 0!==this.pn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.pn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.pn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:S.Sbh}get ubi(){return this.pn&&void 0!==this.pn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.pn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.pn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:
S.Rbh}get u$e(){return this.pn?this.pn.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:S.Qbh}get Rkd(){return null!==this.hYc?this.hYc:this.pn?this.pn.InstantaneousCalcManualMode:!1}RMj(M){let G;if(!M)return{returnValue:!0,category:"General"};G="";if(!({category:M}=this.ZAa(M,!1)).returnValue)return{returnValue:!1,category:G};G=this.l2g(M);return{returnValue:!0,category:G}}l2g(M){let G="";switch(M){case 0:G="General";break;case 1:G="Number";break;case 2:G="Currency";break;case 3:G="Accounting";break;
case 4:G="Date";break;case 5:G="Time";break;case 6:G="Percentage";break;case 7:G="Fraction";break;case 8:G="Scientific";break;case 9:G="Text";break;case 10:G="Special";break;case 11:G="Custom"}return G}ZAa(M,G){let T,K=({value:T}=this.$kc.Dc(M,0)).returnValue;!K&&0<M&&this.$&&(b.ULS.sendTraceTag(537155735,0,50,`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${M}`),this.$Ih(M),G&&(T=this.ZIh(M),K=!0),A.a(M,this.$.mG)&&
(T=6));return{returnValue:K,category:T}}Zgi(M){let G=0;if(({category:G}=this.ZAa(M,!0)).returnValue)return 6===G;b.ULS.sendTraceTag(537155733,0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${M}`);return!1}$Bh(M){b.ULS.sendTraceTag(537155730,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");this.GJa=w.o(this.$.oa.va,{FilterType:0},I.b(this.GAf,M),this.axf,null,null,null)}oTe(){this.CQa(S.I8e)}mxd(M){this.hYc=
M}$Ih(M){if(this.kub&&this.$){var G;if(!({value:G}=this.kub.Dc(M)).returnValue||G.isCompleted)b.ULS.sendTraceTag(537155728,0,50,`Getting number format category for format index: ${M}`),(G=r.b(this.$.oa.va,M,this.VJi,null,null,null))&&this.kub.ia(M,G)}else b.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}ZIh(M){return 1<=M&&8>=M?1:9<=M&&12>=M?2:13===M||14===M?6:15===M?8:17===M|18===M?7:19===M?4:16===M||20<=
M&&29>=M||31===M?11:30===M?9:32<=M&&35>=M?3:0}isActive(){const M=void 0===this.ea||null===this.ea,G=!M&&this.ea.fc;b.ULS.sendTraceTag(537155727,0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${G} - sessionStateManager IsNullOrUndefined: ${M}`);return G}crj(M,G){this.$kc.ia(M,G)}dispose(){f.a.Ia(this.YGb);this.YGb=null;this.x0b();for(let M of this.kub){const G=M.value;G&&!G.isCompleted&&e.AFrameworkApplication.vd.tu(G.Nt)}this.kub=null;this.ea&&
(this.ea.Ik(this.Xc),this.pfb&&this.ea.BD(this.a_),this.pfb=!1,this.ea.Hw(this.Uf));this.ea=null;this.$&&F.g(this.$)&&F.g(this.$).ha&&(F.g(this.$).ha.mma(this.Tsf),this.$.Al(this.$c));this.$=null;super.dispose()}isFeatureEnabled(M){try{switch(M){case "LocaleLongDateFormat":return z.EwaSettings.ma(196);case "GetLocaleDayNames":return z.EwaSettings.ma(197);case "CalculateTextWidthIgnoreLetterSpacing":return z.EwaSettings.ma(283);case "OfficeVSO:3657744_CalcFixForDateFormat":return z.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");
case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return z.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case "CalcAutocompleteExperiment":return z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1);case "CalcNewFunctions":return z.EwaSettings.ma(246);case "CalcContractChecks":return z.EwaSettings.ma(247);case "CalcSupportDynamicArrays":return z.EwaSettings.ma(248);case "CalcFormatCalculations":return z.EwaSettings.ma(249);
case "CalcFormulaCacheAPIChanges":return z.EwaSettings.ma(250);case "CalcStrictFormulaChecking":return z.EwaSettings.ma(251);case "CalcSupportRowReference":return z.EwaSettings.ma(262);case "CalcParserUsesPledges":return z.EwaSettings.ma(306);case "CalcWebWorker":return!0;case "CalcWebWorkerTest":return z.EwaSettings.ma(305);case "CalcLookupFunctions":return z.EwaSettings.ma(307);case "CalcLogStopWatch":return z.EwaSettings.ma(370);case "CalcPreventSpillingHack":return z.EwaSettings.ma(252);case "CalcDynamicArrayOperators":return z.EwaSettings.ma(102);
case "CalcDotOperator":return z.EwaSettings.ma(576);case "CalcLetFunction":return z.EwaSettings.ma(694);default:return M.startsWith("OfficeVSO:")?z.EwaSettings.isChangeGateEnabled(M):!1}}catch(G){return b.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${M}): feature parsing failed, returning false. Exception: ${G.toString()}.`),!1}}CQa(M){this.isActive()&&this.ea.jc.allowEdits?(f.a.Ia(this.YGb),this.YGb=null,this.YGb=y.a.instance.create(this.refresh,M,x.a.xbi)):
b.ULS.sendTraceTag(537155723,0,50,`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==this.ea&&null!==this.ea&&void 0!==this.ea.jc&&null!==this.ea.jc?this.ea.jc.allowEdits:!1}, IsEditMode ${void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode}`)}lYe(){b.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");this.GJa?b.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):
this.isActive()?this.dX&&this.dX.length||(this.GJa=w.o(this.$.oa.va,{FilterType:0},this.vKi,this.axf,null,null,null)):b.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}YBc(){this.pfb||(this.pfb=!0,this.ea.kE(this.a_))}x0b(){this.tu(this.Mdd);this.tu(this.GJa);this.GJa=this.Mdd=null}tu(M){M&&!M.isCompleted&&this.$.oa.va.reb(M.Nt)}static dRh(M,G){if(!M||!M.length)return[];if(!G||!G.length){G=Array(M.length);for(var T=
0;T<M.length;++T)G[T]=M[T].IfmtIndex;return G}T=new X.a;for(const K of M)T.ia(K.IfmtIndex,new U(K));M=new k.a;for(const K of G){let L;({value:L}=T.Dc(K.IfmtIndex)).returnValue&&L.data.FormatString===K.FormatString||M.add(K.IfmtIndex)}return M.toArray()}}S.Jxd="isim0";S.iZc="isim1";S.Xad="isim2";S.Ckf="isim3";S.I8e=100;S.IPd=1E3;S.axd=3E5;S.Pbh=.001;S.Tbh=.1;S.Sbh=.2;S.Rbh=.001;S.Qbh=50;Object(t.a)(S,"InstantaneousSupportInformationManager",m.a,[424,2]);var H=a(696);class D extends d.a{constructor(M){super();
this.$=M;this.Fb()}create(){if(this.$){b.ULS.sendTraceTag(537155672,0,50,"InstantaneousSupportInformationManagerFactory.Create: Start loading script");var M=Object(H.a)(this.$.da,268,()=>new S(this.$.ea,this.$));this.qb(M)}}static ka(M){if(!M)throw Error.argumentNull("ewaControl");M.da.Ga(246,new D(M))}}Object(t.a)(D,"InstantaneousSupportInformationManagerFactory",d.a,[]);a.d(C,"a",function(){return J});const J=()=>{c.a.Fa(D.ka)}},1215:function(t,C,a){function c(G){if(G){var T=new v(G.IsRangeRef);
T.rF=G.IsAbsoluteFirstRow;T.qF=G.IsAbsoluteFirstColumn;T.jK=G.IsAbsoluteSecondRow;T.iK=G.IsAbsoluteSecondColumn;return T}}function b(G){var T;if(G){var K=new v(0===G.kind);G=null===(T=null===G||void 0===G?void 0:G.rangeInfo)||void 0===T?void 0:T.positionKindInfo;if(!G)return K;K.rF=0===G.firstRow;K.qF=0===G.firstColumn;K.jK=0===G.secondRow;K.iK=0===G.secondColumn;return K}}t=a(0);var d=a(221),f=a(7),e=a(15),k=a(84),l=a(5),m=a(317);class v{constructor(G){this.iK=this.jK=this.qF=this.rF=!1;this.uZ=
G}}Object(t.a)(v,"MarqueeRangeData",null,[]);class n{constructor(G,T,K,L=!1){this.zUd=G;this.BMb=T;this.t6a=L;K?(this.uZ=K.uZ,this.rF=K.rF,this.qF=K.qF,this.jK=K.jK,this.iK=K.iK):e.ULS.shipAssertTag(524039642,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}}Object(t.a)(n,"MarqueeMetadata",null,[]);var w=a(43),r=a(138),u=a(35),y=a(1),x=a(22),B=a(576),z=a(21),A=a(200),I=a(338),F=a(33),U=a(750),X=a(870);const S="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");
class H{constructor(G,T){this.hK=this.Edb=this.mmf=!1;this.W7=null;this.Vxa=()=>{this.hK=!1};this.Jc=G;this.gridView=z.g(G);this.calcManager=T;this.sii=y.EwaSettings.isChangeGateEnabled("OfficeVSO:5041666_ImplementLogRecorderOnEwaJS");this.naf=y.EwaSettings.ma(683);this.TU=F.a.TU(G);this.Qaa=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug");this.gridView.Xb.em(this.Vxa)}get formulaAssistanceManager(){this.W7||(this.W7=this.Jc.da.za(464));return this.W7}get formulaAssistanceTelemetryManager(){this.TCa||
(this.TCa=this.Jc.da.za(491));return this.TCa}IB(G,T){this.sii&&G.textBox.addEventLogRecord("ColoredReferencesManager.TryUpdateColoredReferences");if(this.Edb||G.sF)return!1;const K=void 0===T||null===T?G.text:T;if(this.calcManager&&1<K.length&&A.f(K)){var L=this.dja(),V=this.A_e(),W=this.Jc.workbookContext.WorkbookFileName;let qa=!1;const O=.01>Math.random()?Object(k.a)(r.a,this.Jc.Ib.Bc("LoadingUIShown","ColoredReferencesManager")):null;try{var da=this.calcManager.extractReferences(K,V,W,!this.naf);
if(!da)return e.ULS.sendTraceTag(524039689,0,50,"ColoredReferencesManager.UpdateColoredReferences: extractReferences is null (might be an invalid formula)"),!1;V=[];W=[];const ea=[],R=[];let oa=0,pa=0;const Pa=new u.a(!1);let Z="";for(const Ga of da.Items)if(qa=Ga.IsStructRef||qa,Ga.IsBoolean||Ga.IsNumber||Ga.IsString){const Ba=Ga.IsBoolean?"rgba(0, 0, 255, 1)":Ga.IsNumber?"rgba(9, 134, 88, 1)":"rgba(163, 21, 21, 1)";this.iE(W,K,oa,Ga.Span.Start,null);this.iE(W,K,Ga.Span.Start,Ga.Span.End,Ba);oa=
Ga.Span.End}else if(y.EwaSettings.ma(587)){if(Ga.Range||Ga.LetName&&0<=Ga.LetNumber){da=null;if(Ga.Range){let fa=w.D(Ga.Range);da=this.JY(fa,Pa,1);V.push(new I.a(fa,L))}else Ga.LetName&&0<=Ga.LetNumber&&(da=Z=this.LJh(Ga.LetName,Ga.LetNumber,Pa,Z),pa!==Pa.count&&G.colors.add(Ga.Span.Start+"-"+Ga.Span.End,S[(Pa.count-1)%S.length]));this.iE(W,K,oa,Ga.Span.Start,null);this.iE(W,K,Ga.Span.Start,Ga.Span.End,da);oa=Ga.Span.End;ea.push(Ga.Span);let Ba=W.length-1;R.push(new n(Ba,W[Ba].text,c(Ga)));pa=Pa.count}}else if(Ga.Range){let Ba=
w.D(Ga.Range),fa=this.JY(Ba,Pa,1);this.iE(W,K,oa,Ga.Span.Start,null);this.iE(W,K,Ga.Span.Start,Ga.Span.End,fa);V.push(new I.a(Ba,L));oa=Ga.Span.End;ea.push(Ga.Span);let Y=W.length-1;R.push(new n(Y,W[Y].text,c(Ga)))}this.iE(W,K,oa,K.length,null);this.svc(G,W,!!T);const Ra=G.textBox.text;if(!x.a.equals(Ra,K,!1)){e.ULS.shipAssertTag(38114182,0,!1,`ColoredReferencesManager.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [${Ra.length}], originalTextLength [${K.length}]`);
let Ga=G.textBox.caretPosition;G.textBox.text=K;G.textBox.caretPosition=Ga;return!0}this.lz(V,Pa,R);y.EwaSettings.ma(587)&&0<V.length&&e.ULS.sendTraceTag(524039688,0,50,"ColoredReferencesManager.UpdateColoredReferences: Cell reference(s) colored");y.EwaSettings.ma(587)&&0<G.colors.count&&e.ULS.sendTraceTag(524039687,0,50,"ColoredReferencesManager.UpdateColoredReferences: Let name(s) colored");return this.hK=!0}finally{O&&O.uAa(()=>{qa&&e.ULS.sendTraceTag(524039686,0,50,`ColoredReferencesManager.UpdateColoredReferences: Formula with structured reference is highlighted in ${O.uc} ms`)})}}else return this.lz(null,
null),this.hK&&(this.hK=!1,L=G.textBox.caretPosition,G.textBox.setPlainText(K),G.textBox.caretPosition=Math.min(L,K.length),T)?!0:!1}ueb(G,T,K){if(this.Edb||G.sF)return!1;const L=isNullOrUndefined(T)?G.text:T;var V=[];const W=new u.a(!1);if(1<L.length&&Object(U.b)(K)){const qa=[],O=[],ea=[];var da=0;const R=this.dja();for(const oa of K.formulaHighlights){this.iE(qa,L,da,oa.span.start,null);switch(oa.kind){case 0:case 1:case 2:K=w.B(oa.rangeInfo.sharedRange);if(isNullOrUndefined(K)){e.ULS.sendTraceTag(521211937,
0,10,`ColoredReferencesManager.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:${oa.kind.toString()},`);this.iE(qa,L,oa.span.start,oa.span.end,null);break}da=this.JY(K,W,1);this.iE(qa,L,oa.span.start,oa.span.end,da);V.push(new I.a(K,R));O.push({Start:oa.span.start,End:oa.span.end});K=qa.length-1;ea.push(new n(K,qa[K].text,b(oa)));break;case 3:this.iE(qa,L,oa.span.start,oa.span.end,null,"rgba(229, 229, 229, 1)")}da=oa.span.end}this.iE(qa,L,da,L.length);this.svc(G,
qa,!!T);T=G.textBox.text;if(!x.a.equals(T,L,!1))return e.ULS.shipAssertTag(521211936,0,!1,`ColoredReferencesManager.UpdateFormulaHighlights: The text we created is different from the original text. Setting the original text back. currentTextLength [${T.length}], originalTextLength [${L.length}]`),T=G.textBox.caretPosition,G.textBox.text=L,G.textBox.caretPosition=T,!0;this.lz(V,W,ea);return this.hK=!0}this.lz(null,null);return this.hK&&(this.hK=!1,V=G.textBox.caretPosition,G.textBox.setPlainText(L),
G.textBox.caretPosition=Math.min(V,L.length),T)?!0:!1}uCb(G,T,K){if(!G||!T||!K)return e.ULS.shipAssertTag(524039685,0,!!G,"ColoredReferencesManager.MoveMarqueeRange: cellContentEditor is null"),e.ULS.shipAssertTag(524039684,0,!!T,"ColoredReferencesManager.MoveMarqueeRange: highlightState is null"),e.ULS.shipAssertTag(524039683,0,!!K,"ColoredReferencesManager.MoveMarqueeRange: newRange is null"),!1;const L=Object(k.a)(n,T.metadata);if(!L)return e.ULS.shipAssertTag(524039682,0,!1,"ColoredReferencesManager.MoveMarqueeRange: marqueeMetadata is null"),
!1;var V=L.zUd,W=L.BMb,da=this.gridView.Db.zmd(K)?K.Fub(L.qF,L.rF):K.RJa(L.qF,L.rF,L.iK,L.jK);if(!da)return e.ULS.shipAssertTag(524039681,0,!1,"ColoredReferencesManager.MoveMarqueeRange: newText is null"),!1;const qa=W.indexOf("!");-1!==qa&&(da=W.substring(0,qa+1)+da);if(!G.textBox.changeTextInExistingTextPart(V,W,da))return e.ULS.shipAssertTag(38926105,0,!1,"ColoredReferencesManager.MoveMarqueeRange: failed to change the text part"),!1;L.BMb=da;V=!0;for(W=1;4>=W;W++)(da=z.g(this.Jc).lb.dv(3,W,T.xT))?
(da.range=K,da.metadata=L):(e.ULS.shipAssertTag(524039680,0,!1,"ColoredReferencesManager.MoveMarqueeRange: highlightStateInPane is null"),V=!1);this.gridView.lb.update(!1,!1);this.gridView.lm&&(this.gridView.hc.textBox.text=G.text);this.gridView.hc.lPa(new m.a({oyb:!0}));return V}wii(G){if(3!==G.xq)return e.ULS.shipAssertTag(524039651,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: not HighlightDivIndex.Marquee."),!1;G=Object(k.a)(n,G.metadata);return G?G.uZ&&!G.t6a:(e.ULS.shipAssertTag(524039650,
0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: marqueeMetadata is null."),!1)}zAa(G,T){e.ULS.sendTraceTag(524039649,0,50,"ColoredReferencesManager.SuspendResumeColoredReferences: "+(T?"suspending":"resuming")+" colored references");T&&this.hK&&(this.hK=!1,this.lz(null,null),G.textBox.Hxe());this.Edb=T}dispose(){this.gridView&&this.gridView.Xb&&this.gridView.Xb.yl(this.Vxa)}IKa(G){const T=this.formulaAssistanceTelemetryManager;T||this.mmf||(this.mmf=!0,e.ULS.sendTraceTag(521211935,0,50,
"ColoredReferencesManager.highlightPreviewRanges: Failed to log highlightPreviewRanges measurement, FormulaAssistanceTelemetryManager unavailable"));null===T||void 0===T?void 0:T.dG(["highlightPreviewRanges"]);this.TU?this.U5h(G):this.T5h(G);null===T||void 0===T?void 0:T.UE(["highlightPreviewRanges"],!0)}U5h(G){var T=this.formulaAssistanceManager.w3a(G,X.a);if(isNullOrUndefined(T))this.Qaa&&this.lz(null,null);else{var K=this.dja(),L=[],V=new u.a(!1),W=[];T=T.formulaHighlights;for(const da of T)if(T=
da.kind,0===T||2===T||1===T)T=w.B(da.rangeInfo.sharedRange),Object(U.b)(T)&&(L.push(new I.a(T,K)),this.JY(T,V,1),W.push(new n(da.span.start,G.substring(da.span.start,da.span.end),b(da),!0)));this.lz(L,V,W)}}T5h(G){const T=this.dja();var K=this.A_e();const L=this.Jc.workbookContext.WorkbookFileName,V=[],W=new u.a(!1),da=[];if(K=this.calcManager.extractReferences(G,K,L,!this.naf)){for(const qa of K.Items)qa.Range&&(K=w.D(qa.Range),V.push(new I.a(K,T)),this.JY(K,W,1),da.push(new n(qa.Span.Start,G.substring(qa.Span.Start,
qa.Span.End),c(qa),!0)));this.lz(V,W,da)}else this.Qaa&&this.lz(null,null)}JY(G,T,K){let L=T.getItem(G.toString());L||(L=S[T.count%S.length],T.add(G.toString(),L));return String.format(L,K)}LJh(G,T,K,L){G="["+G+", "+T+"]";T=K.getItem(G);T||(T=K.count%S.length,T=S[T],L===String.format(T,1)&&(K.add("skip-"+G,T),T=K.count%S.length,T=S[T]),K.add(G,T));return String.format(T,1)}iE(G,T,K,L,V=null,W=null){e.ULS.shipAssertTag(524039648,0,K<=L,"ColoredReferencesManager.AddTextPart: startIndex cannot be larger than endIndex");
K<L&&(T=T.substring(K,L),G.push(Object(f.a)(new B.a,{text:T,color:V,backgroundColor:W})))}lz(G,T,K=null){G&&G.length?(e.ULS.sendTraceTag(524039647,0,50,"ColoredReferencesManager.HighlightRanges: number of ranges to highlight: "+G.length),G.reverse(),K.reverse(),this.gridView.lb.vv(G,[3],!0,(L,V)=>{if(L&&L.range&&V){e.ULS.shipAssertTag(524039643,0,T.mb(L.range.toString()),`ColoredReferencesManager.HighlightRanges: The range '${L.range.toString()}' doesn't exist in the range to color dictionary`);var W=
this.JY(L.range,T,.1),da=this.JY(L.range,T,1);this.Jc.frame&&this.Jc.frame.ZC&&this.Jc.frame.ZC.Zaa||(V.style.background=W);V.style.borderColor=da;K&&(V.setAttribute(l.a.c5a,L.xT.toString()),L.metadata=K[L.xT])}else e.ULS.shipAssertTag(524039646,0,!!L,"ColoredReferencesManager.HighlightRanges: state is null"),e.ULS.shipAssertTag(524039645,0,!!L.range,"ColoredReferencesManager.HighlightRanges: state.Range is null"),e.ULS.shipAssertTag(524039644,0,!!V,"ColoredReferencesManager.HighlightRanges: div is null")})):
(G=this.Jc.Ib.Bc("UserAction","HideRangesHighlightsStopwatch"),this.gridView.lb.Mg([3]),this.gridView.lb.fRa(new I.a(null,this.dja()),[3]),G.stop())}svc(G,T,K){const L=G.textBox;L.kF=!0;var V=L.selection;const W=V.index;V=W+V.length;L.setTextFromTextParts(T);T=L.text.length;L.selectRange(Math.min(W,T),Math.min(V,T));K&&G.lPa(new m.a);L.kF=!1}dja(){return this.rac().sheetId}A_e(){return this.rac().sheetName}rac(){return this.gridView.Mq&&this.gridView.Mq.LF?this.gridView.Mq.LF:this.Jc.pa}}Object(t.a)(H,
"ColoredReferencesManager",null,[427,2]);class D extends d.a{constructor(G){super();this.$=G;this.Fb()}create(){this.$.da.Za(266,G=>{G=y.EwaSettings.fl()||y.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")?this.$.da.za(281)||this.$.da.Ga(281,new H(this.$,G)):new H(this.$,G);this.qb(G)})}static ka(G){G.da.Ga(282,new D(G))}}Object(t.a)(D,"ColoredReferencesManagerFactory",d.a,[]);var J=a(10);a.d(C,"a",function(){return M});const M=()=>{J.a.Fa(D.ka)}},1263:function(t,
C,a){t=a(0);var c=a(221),b=a(802),d=a(1);class f extends c.a{constructor(l){super();this.$=l;this.Fb()}create(){this.$.da.Za(266,l=>{l=d.EwaSettings.fl()||d.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")?this.$.da.za(294)||this.$.da.Ga(294,new b.RelativeAndAbsoluteReferencesManager(l)):new b.RelativeAndAbsoluteReferencesManager(l);this.qb(l)})}static ka(l){l.da.Ga(295,new f(l))}}Object(t.a)(f,"RelativeAndAbsoluteReferencesManagerFactory",c.a,[]);var e=a(10);
a.d(C,"a",function(){return k});const k=()=>{e.a.Fa(f.ka)}},1386:function(t,C,a){a.r(C);t=a(1200);C=a(1154);var c=a(1215);a=a(1263);Type.registerNamespace("_Ewa");Object(t.a)();Object(C.a)();Object(c.a)();Object(a.a)()},785:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.abs="Abs";c.rel="Rel";Object(t.a)(c,"PositionBaseType",null,[])},802:function(t,C,a){a.r(C);t=a(0);var c=a(7),b=a(15);class d{}Object(t.a)(d,"Reference",null,[]);class f extends d{constructor(){super();this.column=
this.row=null}}Object(t.a)(f,"CellReference",d,[]);class e{constructor(){this.end=this.start=0;this.qv=null}ZJg(I,F){for(let U=0;U<this.qv.length;U++){const X=this.wZb(I,this.qv[U]);F+=X;U<this.qv.length-1&&(F+=":")}return F}}Object(t.a)(e,"IReferenceSequence",null,[]);var k=a(24),l=a(785);class m extends e{constructor(){super();this.ogc=!1}hac(){const {RelativeAndAbsoluteReferencesManager:I}=a(802),F=this.qv[0];return I.jrf(F.row.kind===l.a.abs,F.column.kind===l.a.abs)}wZb(I,F){F=k.Range.Uc(F.row.index+
1,F.column.index+1);return this.ogc?F.Fub(1===I||3===I,1===I||2===I):F.RJa(1===I||3===I,1===I||2===I,!0,!0)}}Object(t.a)(m,"CellReferenceSequence",e,[]);class v extends d{constructor(){super();this.secondColumn=this.firstColumn=null}}Object(t.a)(v,"ColumnReference",d,[]);class n extends e{constructor(){super()}hac(){const I=this.qv[0];return a(802).RelativeAndAbsoluteReferencesManager.Epf(I.firstColumn,I.secondColumn).kind===l.a.abs?2:3}wZb(I,F){return k.Range.Otb(F.firstColumn.index+1,F.secondColumn.index+
1).RJa(1===I||3===I,!0,1===I||3===I,!0)}}Object(t.a)(n,"ColumnReferenceSequence",e,[]);class w extends d{constructor(){super();this.right=this.left=this.bottom=this.top=null}}Object(t.a)(w,"RangeReference",d,[]);class r extends e{constructor(){super()}hac(){const {RelativeAndAbsoluteReferencesManager:I}=a(802),F=this.qv[0];return I.jrf(F.top.kind===l.a.abs,F.left.kind===l.a.abs)}wZb(I,F){F=new k.Range(F.top.index+1,F.left.index+1,F.bottom.index+1,F.right.index+1,!1,!1);const U=1===I||3===I;I=1===
I||2===I;return F.RJa(U,I,U,I)}}Object(t.a)(r,"RangeReferenceSequence",e,[]);class u extends d{constructor(){super();this.secondRow=this.firstRow=null}}Object(t.a)(u,"RowReference",d,[]);class y extends e{constructor(){super()}hac(){const I=this.qv[0];return a(802).RelativeAndAbsoluteReferencesManager.Epf(I.firstRow,I.secondRow).kind===l.a.abs?0:1}wZb(I,F){return k.Range.m9b(F.firstRow.index+1,F.secondRow.index+1).RJa(!0,1===I||2===I,!0,1===I||2===I)}}Object(t.a)(y,"RowReferenceSequence",e,[]);var x=
a(978),B=a(979),z=a(200);a.d(C,"RelativeAndAbsoluteReferencesManager",function(){return A});class A{constructor(I){this.calcManager=I}D0a(I,F,U){let X,S;X=F;S=U;if(!I||!z.f(I))return{returnValue:I,Mwd:X,Lwd:S};var H=this.calcManager.CQe(I);if(!H)return b.ULS.sendTraceTag(524039641,0,15,"RelativeAndAbsoluteReferencesManager.CycleThroughRelativeAndAbsoluteReferences: Couldn't extract references (might be invalid formula)"),{returnValue:null,Mwd:X,Lwd:S};H=this.XVh(H,I,F,U);let D=0,J="",M=0,G=0;for(;G<
H.length;G++)if(this.THe(H[G],F,U)){D=H[G].hac();X=H[G].start;break}for(;G<H.length&&this.THe(H[G],F,U);G++)J+=I.substring(M,H[G].start),J=H[G].ZJg(D,J),M=H[G].end;M&&(S=J.length);J+=I.substring(M,I.length);return{returnValue:J,Mwd:X,Lwd:S}}XVh(I,F,U,X){const S=[];for(let M=0;M<I.length;M++){var H=I[M];if(H.kind===x.a.range)if(H=H.ref,H.type===B.a.cell){var D=H;H=Object(c.a)(new m,{start:H.span.start,end:H.span.end,qv:[Object(c.a)(new f,{column:D.col,row:D.row})],ogc:this.calcManager.K0b(H.span.end,
F)});S.push(H)}else if(H.type===B.a.range)this.UHe(H.topLeftSpan,U,X)&&this.UHe(H.bottomRightSpan,U,X)?(D=new w,H.top.index<=H.bottom.index?(D.top=H.top,D.bottom=H.bottom):(D.bottom=H.top,D.top=H.bottom),H.left.index<=H.right.index?(D.left=H.left,D.right=H.right):(D.right=H.left,D.left=H.right),H=Object(c.a)(new r,{start:H.topLeftSpan.start,end:H.bottomRightSpan.end,qv:[D]}),S.push(H)):(D=Object(c.a)(new m,{start:H.topLeftSpan.start,end:H.topLeftSpan.end,qv:[Object(c.a)(new f,{column:H.left,row:H.top})],
ogc:this.calcManager.K0b(H.topLeftSpan.end,F)}),H=Object(c.a)(new m,{start:H.bottomRightSpan.start,end:H.bottomRightSpan.end,qv:[Object(c.a)(new f,{column:H.right,row:H.bottom})],ogc:this.calcManager.K0b(H.topLeftSpan.end,F)}),S.push(D),S.push(H));else if(H.type===B.a.column){D=H;for(H=Object(c.a)(new n,{start:H.span.start,end:H.span.end,qv:[Object(c.a)(new v,{firstColumn:D.startIndex,secondColumn:D.endIndex})]});H.end<F.length-1&&":"===F.charAt(H.end)&&M<I.length-1;)if(D=I[M+1].ref,D.type===B.a.column&&
D.span.start===H.end+1){var J=D;H.qv.push(Object(c.a)(new v,{firstColumn:J.startIndex,secondColumn:J.endIndex}));H.end=D.span.end;M++}else break;S.push(H)}else if(H.type===B.a.row){D=H;for(H=Object(c.a)(new y,{start:H.span.start,end:H.span.end,qv:[Object(c.a)(new u,{firstRow:D.startIndex,secondRow:D.endIndex})]});H.end<F.length-1&&":"===F.charAt(H.end)&&M<I.length-1;)if(D=I[M+1].ref,D.type===B.a.row&&D.span.start===H.end+1)J=D,H.qv.push(Object(c.a)(new u,{firstRow:J.startIndex,secondRow:J.endIndex})),
H.end=D.span.end,M++;else break;S.push(H)}}return S}THe(I,F,U){return!(I.start>U||F>I.end)}UHe(I,F,U){return!(I.start>U||F>I.end)}static Epf(I,F){return I.index<=F.index?I:F}static jrf(I,F){return F||I?F&&I?2:!F&&I?3:0:1}}Object(t.a)(A,"RelativeAndAbsoluteReferencesManager",null,[426])},935:function(t,C,a){a.r(C);t=a(0);var c=a(15),b=a(262),d;(function(y){y[y.paren=0]="paren";y[y.lead=1]="lead";y[y.intern=2]="intern";y[y.trail=3]="trail";y[y.undefined=4]="undefined"})(d||(d={}));Object(t.b)("CurrencyFormatOption",
d);var f;(function(y){y[y.none=-1]="none";y[y.mdy=0]="mdy";y[y.dmy=1]="dmy";y[y.ymd=2]="ymd";y[y.myd=3]="myd";y[y.dym=4]="dym";y[y.ydm=5]="ydm"})(f||(f={}));Object(t.b)("DateOrderOption",f);var e=a(8);class k{constructor(y,x){({CalcHelper:y}=a(935));x&&(x.De||c.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));this.Hrg=y.WCe(x,y.GCe(x.Kia));this.Irg=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.Irg}get localeData(){return this.Hrg}formatNumber(y){return this.localeInfo.formatNumber(y)}}
Object(t.a)(k,"LocaleHolder",null,[]);var l=a(976),m=a(54),v=a(1),n=a(22),w=a(14),r=a(199);a.d(C,"CalcHelper",function(){return u});class u{constructor(y){this.$=y;(this.mz=this.$.da.za(268))||c.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");let x;x=v.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?m.a.current.Rn(76):m.a.current.Rn(79);this.logger=new l.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",
this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.Aba=new k(y,this.mz);excelOnlineCalc.config.initCalc(this.logger,this.mz?B=>this.mz.isFeatureEnabled(B):()=>!1,x);this.umg=excelOnlineCalc.config.calcConfig(this.Aba.localeInfo)}get config(){return this.umg}hah(){if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.xa)return c.ULS.shipAssertTag(537170069,0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;const y=this.$.xa.pa;
return y?y.index:(c.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.xa.pa.index}createParser(){const y={};y.config=this.config;return excelOnlineCalc.parse.createParser(y)}createNumberFormatter(){const y=excelOnlineCalc.numfmt.createFormatGlobals(this.config,(x,B)=>excelOnlineCalc.calc.getTime(this.config,x,B,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(y)}r9g(y,x,B,z){if(!z)return{range:{row:x,col:B},sheet:{document:this.documentLoc,
index:y}};x=excelOnlineCalc.location.gridCell(x,B);y=excelOnlineCalc.location.sheetIndex(this.documentLoc,y);return excelOnlineCalc.location.sheetGridCell(y,x)}ylh(y,x){let B;B=excelOnlineCalc.calc.getEvalResultKind(y);switch(B){case 4:return{returnValue:y?this.Aba.localeInfo.trueName:this.Aba.localeInfo.falseName,kind:B};case 1:return{returnValue:v.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.tzc(this.Aba.formatNumber(y),x):this.Aba.formatNumber(y),
kind:B};case 2:return{returnValue:v.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.tzc(y.toString(),x):y.toString(),kind:B};case 128:return{returnValue:"",kind:B};case 8:switch(y.type){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:return{returnValue:this.Aba.localeInfo.errorNames[y.type],kind:B};default:return{returnValue:u.unknownError,kind:B}}case 32:return{returnValue:v.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?
this.tzc(this.I9g(y,x),x):"##UNSUPPORTED: ARRAY",kind:B};default:return{returnValue:w.a.instance.ga(2217),kind:B}}}tzc(y,x){return y.length<=x?y:y.substring(0,x-3)+"..."}I9g(y,x){let B=this.Aba.localeInfo.leftBrace;for(let z=0;z<y.rows;++z){for(let A=0;A<y.cols;++A)B+=y.opers[z][A],A<y.cols-1&&(B+=this.Aba.localeInfo.columnSeparator);z<y.rows-1&&(B+=this.Aba.localeInfo.rowSeparator)}return this.tzc(B,x-1)+this.Aba.localeInfo.rightBrace}static WCe(y,x=null){const B=u.l3b(),z=y.De.TrueValueString,A=
y.De.FalseValueString,I=y.De.DecimalSeparator.toString(),F=y.De.ListSeparator.toString(),U=y.De.ColumnSeparator.toString(),X=y.De.RowSeparator.toString(),S=y.De.ThousandsDataArray,H=y.De.ThousandSeparator.toString(),D=y.De.Lcid,J=y.De.Country,M=y.De.DigitsNumber,G=y.De.ExpSeparatedBySpace,T=y.De.FractionSeparator.toString(),K=y.De.PercentSeparatedBySpace,L=n.a.zUg(Enum.toString(d,y.De.CurrencyFormat)),V=y.De.CurrencySymbolLead,W=y.De.CurrencySeparatedBySpace,da=y.De.CurrencySymbolString,qa=y.De.DigitsCurrency,
O=-1===y.De.DateOrder?"MDY":r.e(Enum.toString(f,y.De.DateOrder)),ea=y.De.DateSeparator.toString(),R=y.De.DateAlternativeSeparator.toString(),oa=y.De.Year4Digits,pa=y.De.Month2Digits,Pa=y.De.Day2Digits,Z=y.De.LongDateFormat,Ra=y.De.TimeSeparator.toString(),Ga=y.De.TimeAltSeparator,Ba=y.De.Hour2Digits,fa=y.De.Use24HourClock,Y=y.De.AmPmSeparatedBySpace,ja=[y.De.AmString,y.De.PmString],ca=y.De.DayNameShortArray,aa=y.De.DayNameLongArray,ta=y.De.MonthNameShortArray,xa=y.De.MonthNameLongArray,ia=y.De.PictureSpecialArray,
ya=b.a.map(("\x00"+y.De.PictureSingleString).split(""),rb=>"\x00"===rb?null:rb),ib=y.De.PictureColorArray,wa=y.De.PictureDbnumArray,sa=y.De.RowLetter.toString(),Ya=y.De.ColumnLetter.toString(),bb=y.De.LeftBrace.toString(),mb=y.De.RightBrace.toString(),Ca=y.De.LeftBracket.toString(),$a=y.De.RightBracket.toString(),Kb=u.RWh(y.De);return excelOnlineCalc.calc.localeData(x,B,z,A,sa,Ya,bb,mb,Ca,$a,I,F,U,X,S,H,D,J,M,G,T,K,L,V,W,da,qa,O,ea,R,oa,pa,Pa,Z,Ra,Ga,Ba,fa,Y,ja,ca,aa,ta,xa,ia,ya,ib,wa,Kb,y.De.SysDateFormatString,
y.De.SysTimeFormatString)}static GCe(y){const x=[];if(!y)return x;for(const B of y)y=null,B.IsDynamicUdf||(y=excelOnlineCalc.calc.worksheetFunctionName(B.FunctionIndexInServer,B.NameUI)),y&&x.push(y);return x}static l3b(){const y=[],x=Object.keys(e.a.errorNames);for(let B=0;B<x.length;B++){const z=excelOnlineCalc.calc.errorTypeName(B+1,x[B]);z&&y.push(z)}return y}static RWh(y){const x=Array(6);x[1]="#"+y.AllStructRefString;x[3]="#"+y.HeadersStructRefString;x[2]="#"+y.DataStructRefString;x[4]="#"+
y.TotalsStructRefString;x[5]="#"+y.ThisRowStructRefString;return x}}u.unknownError="##ERR##";Object(t.a)(u,"CalcHelper",null,[])},978:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.Fri="literal";c.operator="operator";c.func="function";c.namedRange="namedRange";c.range="range";c.Fjf="letName";c.all="*";c.nTd="structRefRange";Object(t.a)(c,"TraverseFormulaInterestTypes",null,[])},979:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.cell="cell";c.range="range";c.row=
"row";c.column="col";Object(t.a)(c,"TraverseFormulaRefTypes",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.calc.js.map/7592a560d4b67783f2b24ca8ee9a39cc/EwaDSEsNext.calc.js.map