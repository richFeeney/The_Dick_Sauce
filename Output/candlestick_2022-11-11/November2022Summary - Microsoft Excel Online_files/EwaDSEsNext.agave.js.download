/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1140:function(t,C,a){t=a(0);var c=a(15),b=a(691),d=a(77),f=a(37);class e{constructor(gb,Ha){this.automateCommandManager=gb;this.$=Ha}Nc(){return!1}executeCommand(gb,Ha,tb){gb=f.TaskExtensions.fk();Ha=Ha.command;switch(Ha){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 1043696663:case 971811139:case -2126202430:case 1623358083:this.$.ud(2045014907,-1,0,null),this.automateCommandManager.Bqi(Ha,
1904816141===Ha?tb[d.a.Pc].toString():null)}return gb}Cc(gb,Ha){gb=!1;switch(Ha.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case -2126202430:case 1623358083:case 1904816141:case 1043696663:case 1606046412:gb=this.$.fba}return gb}Rc(gb,Ha,tb){return"PopulateAutomateGalleryMenu"===Ha&&this.$.fba?(this.automateCommandManager.Rc(Ha,tb),!0):!1}}Object(t.a)(e,"AutomateCommandHandler",null,[195]);var k=a(454);class l extends b.a{constructor(gb){super(gb)}yd(){k.a(this.$,374,375,
this.hb,()=>{const gb=this.$.da.za(352);gb?this.gd([new e(gb,this.$)]):c.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})}static ka(gb){gb.da.Ga(308,new l(gb))}}Object(t.a)(l,"AutomateCommandHandlerFactory",b.a,[]);b=a(221);var m=a(7),v=a(4);class n{constructor(){this.token=null;this.timeStamp=0}}Object(t.a)(n,"AuthContext",null,[]);var w=a(720),r=a(131),u=a(111),y=a(28),x=a(810),B=a(171),z=a(69);class A{constructor(gb,Ha,tb){var bc,
tc;this.$=gb;this.oAuthManager=Ha;this.Mu=tb;this.Snb=new n;this.Kre=null!==(tc=null===(bc=this.oAuthManager)||void 0===bc?void 0:bc.t5a())&&void 0!==tc?tc:!1}getAuthContext(){return this.Snb}cvb(){const gb=y.a.Wa.Nb,Ha=[];if(this.oAuthManager)Ha.push(Object(m.a)(new z.a,{name:"IsAuthSupported",bool:this.Kre}));else return this.W7b(Ha,gb,"need_OAuthManager","No OAuthManager");if(!this.Mu.yz||!this.Mu.yz.value)return this.W7b(Ha,gb,"need_license","No License");if(v.AFrameworkApplication.fa.qa("IsAnonymousUser"))return this.W7b(Ha,
gb,"need_user","Anonymous User");if(33E5>Date.now()-this.Snb.timeStamp)return Ha.push(Object(m.a)(new z.a,{name:"UsedCachedToken",bool:!0})),B.a(r.a.Txd,!0,0,Ha),Promise.resolve(Object(m.a)(new x.a,{IsSuccess:!0,Token:this.Snb.token}));Ha.push(Object(m.a)(new z.a,{name:"UsedCachedToken",bool:!1}));let tb=1;const bc=(tc,Ma)=>(new Promise(Tb=>{window.setTimeout(()=>{Tb(tc)},Ma)})).then(Tb=>{Ha.push(Object(m.a)(new z.a,{name:"Error"+tb,string:Tb.ErrorMessage}));Ha.push(Object(m.a)(new z.a,{name:"ErrorCode"+
tb,string:Tb.ErrorCode}));tb++;return this.Q$f()});return this.Q$f().catch(tc=>bc(tc,200)).catch(tc=>bc(tc,400)).then(tc=>{tc.IsSuccess?(this.Snb.token=tc.Token,this.Snb.timeStamp=Date.now()):(Ha.push(Object(m.a)(new z.a,{name:"Error"+tb,string:tc.ErrorMessage})),Ha.push(Object(m.a)(new z.a,{name:"ErrorCode"+tb,string:tc.ErrorCode})));Ha.push(Object(m.a)(new z.a,{name:"Attempts",int64:tb}));Ha.push(Object(m.a)(new z.a,{name:"Error",string:tc.ErrorMessage}));Ha.push(Object(m.a)(new z.a,{name:"ErrorCode",
string:tc.ErrorCode}));B.a(r.a.Txd,tc.IsSuccess,u.getElapsedMilliseconds(gb,y.a.Wa.Nb),Ha);return Promise.resolve(tc)}).catch(tc=>{Ha.push(Object(m.a)(new z.a,{name:"Error"+tb,string:tc.ErrorMessage}));Ha.push(Object(m.a)(new z.a,{name:"ErrorCode"+tb,string:tc.ErrorCode}));Ha.push(Object(m.a)(new z.a,{name:"Attempts",int64:tb}));return this.W7b(Ha,gb,tc.ErrorCode,tc.ErrorMessage)})}W7b(gb,Ha,tb,bc){gb.push(Object(m.a)(new z.a,{name:"Error",string:bc}));gb.push(Object(m.a)(new z.a,{name:"ErrorCode",
string:tb}));B.a(r.a.Txd,!1,u.getElapsedMilliseconds(Ha,y.a.Wa.Nb),gb);return Promise.resolve(Object(m.a)(new x.a,{IsSuccess:!1,ErrorMessage:bc,ErrorCode:tb}))}Q$f(){var gb=w.a.qYh();let Ha=0;gb=this.oAuthManager.wO("Maker",gb).then(tb=>{if(tb)return!tb.IsSuccess&&this.axj(tb)?Promise.reject(tb):Promise.resolve(tb);tb=Object(m.a)(new x.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(tb)}).catch(tb=>{let bc=new x.a;Object.getType(tb)===Object.getType(bc)?
bc=tb:(bc.ErrorMessage=tb.toString(),bc.ErrorCode="exception");return Promise.reject(bc)});return Promise.race([gb,new Promise((tb,bc)=>{Ha=window.setTimeout(()=>{bc(Object(m.a)(new x.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},2E4)})]).then(tb=>{window.clearTimeout(Ha);return tb})}axj(gb){return"interaction_required"===gb.ErrorCode||"InitFailed"===gb.ErrorCode||"invalid_resource"===gb.ErrorCode||"login_required"===gb.ErrorCode&&gb.ErrorMessage.startsWith("AADSTS500341")?
!1:!0}}Object(t.a)(A,"AutomateCommandAuth",null,[376]);var I=a(811);class F{constructor(){this.l_=null}}Object(t.a)(F,"AutomateCommandGalleryBase",null,[]);var U=a(372),X=a(30),S=a(557),H=a(1383),D=a(19),J=a(54),M=a(14);a(308);var G=a(587);class T{constructor(gb,Ha){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=gb;this.currentUserMlapiToken=Ha}}Object(t.a)(T,"UserInfo",null,[]);var K=a(513),L=a(170),V=a(61),W=a(33),da=a(1),qa=a(280);const O=gb=>"TestHost"===gb.ya.DocumentHostInfo.HostTier,
ea=(gb,Ha)=>{Ha.WacTaskPaneInfra=W.a.Ad(gb);Ha.TaskpanelessRFB=da.EwaSettings.getBooleanFeatureGate(w.a.Y7f,!1);Ha.OfficeScriptsAutomateTask=w.a.Gsf;Ha.DeferAdminCheck=w.a.cta;Ha.SharedScriptsButton=R()},R=()=>da.EwaSettings.getBooleanFeatureGate(w.a.Ouj,!1),oa=(gb,Ha)=>{O(gb)&&(da.EwaSettings.getBooleanFeatureGate(w.a.Fjc,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(gb.ya.UserSessionId);makerstorage.setUserAccessInfo(new T(Ha,
null));makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,"1")},pa=gb=>{if(O(gb))return da.EwaSettings.getBooleanFeatureGate(w.a.Fjc,!1)?"makerservicelocal":"localstorage";gb=w.a.Vdd();return w.a.K1e(gb)},Pa=(gb,Ha,tb,bc,tc)=>{const Ma=gb.userOperationManager,Tb=gb.oa;let zb=null,ic=null,Qb=null;const wb=()=>{if(Ma.SGa()||0<Tb.va.h3||0<Tb.Pk.h3)return!1;zb&&Ma.Co(zb);ic&&Tb.qt(ic);Qb&&Tb.Oz(Qb);const hc=(Za,ub,uc)=>V.g(Tb.va,"ExecuteRichApiRequest",bc,qa.b(Za,Ha),qa.a(ub,tb),uc,null,
0);da.EwaSettings.dc()?Ma.Yt(new L.a(507,0,hc,80)):Ma.Yt(new K.a(507,0,hc,16));return!0};wb()||(zb=()=>{wb()},ic=()=>{wb()},Qb=()=>{wb()},Ma.Hr(zb),Tb.Ir(ic),Tb.Ly(Qb));return tc.task},Z=gb=>{gb=gb.oa.va.Na(1);gb.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",RequestHeaders:null,RequestBody:"",RequestFlags:256};return gb},Ra=gb=>W.a.Ad(gb)?gb.isChromeRtl?D.a.eqh:D.a.dqh:D.a.Q1a,Ga=
gb=>W.a.Ad(gb)?D.a.IMe:D.a.HMe;class Ba{constructor(gb,Ha){this.automateCommandManager=gb;this.$=Ha}AFh(gb){const Ha=this.automateCommandManager.Sa.sq().rE();if(!R()){var tb=Ba.JT(gb,M.a.instance.ga(2138));this.xTc(tb,w.a.gSi,this.automateCommandManager.Qj,w.a.NDi,M.a.instance.ga(2134),this.automateCommandManager.Sa);Ha.MenuSectionList.push(tb)}tb=Ba.JT(gb,M.a.instance.ga(2139));this.xTc(tb,w.a.eBi,w.a.g5?this.automateCommandManager.ot.$Re(this.automateCommandManager.Qj):this.automateCommandManager.Xp.$Re(this.automateCommandManager.Qj),
w.a.csf,M.a.instance.ga(2135),this.automateCommandManager.Sa);Ha.MenuSectionList.push(tb);tb=Ba.JT(gb,M.a.instance.ga(2140));this.xTc(tb,w.a.Mij,this.automateCommandManager.zB,w.a.csf,"",this.automateCommandManager.Sa);Ha.MenuSectionList.push(tb);tb=Object(m.a)(new U.a,{Id:w.a.foe,ExternalId:w.a.foe,Command:"1606046412",LabelText:M.a.instance.ga(2131),Alt:M.a.instance.ga(2132),Image16by16:J.a.hf(16),Image16by16Class:D.a.fNe,Visible:!0});gb=Ba.JT(gb,null);gb.ControlsId="myScriptsSection.Controls";
if(R()){const bc=Object(m.a)(new U.a,{Id:w.a.u0f,ExternalId:w.a.u0f,Command:"1043696663",LabelText:M.a.instance.ga(2141),Alt:M.a.instance.ga(2141),ExternalImageId:"PeopleSharedIcon_16",Visible:!0});gb.ControlList.push(bc)}gb.ControlList.push(tb);Ha.MenuSectionList.push(gb);return Ha}xTc(gb,Ha,tb,bc,tc,Ma){if(tb&&0<tb.length){Ha=Ma.FC(Ha,1,"Size150by20").N_b();tc={};Ma={};Ma.root=Ba.Jsa(320,30);Ma.flexContainer={display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"left",alignItems:"left",
lineHeight:"normal"};Ma.label={margin:"0px 3px"};tc.galleryButtonInExpanded=Ma;Ha.GalleryStyle=tc;for(tc=0;tc<tb.length&&tc<bc;tc++)Ma=tb.y3(tc),Ha.GalleryItems.push(Ba.y2c(Ma.id,Ma));gb.ControlList.push(Ha)}else tb=Object(m.a)(new G.a,{Id:Ha,ExternalId:Ha,LabelText:tc}),gb.ControlsId=tb.Id+".Controls",gb.ControlList.push(tb)}static vEh(gb){if(gb){const Ha=String.format(w.a.Mai,gb.isShared?w.a.KLj:w.a.gkj,J.a.hf(16));gb=String.format(w.a.Nai,X.a.Eg(gb.name));return String.format(w.a.Lai,Ha,gb)}return""}static JT(gb,
Ha){return Object(m.a)(new S.a,{Id:gb,Title:Ha,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,ControlList:[]})}static y2c(gb,Ha){const tb=w.a.ILj,bc=w.a.ekj,tc=w.a.JLj,Ma=w.a.fkj;return Ha?Ba.ICe(Ha.shareId||Ha.id,Ha.name,Ha.isShared&&!R()?tb:bc,gb,gb,Ha.isShared&&!R()?tc:Ma):Ba.ICe("","","",gb,gb)}static ICe(gb,Ha,tb,bc=null,tc=null,Ma=null){const Tb={},zb={};Tb.root=Ba.Jsa(20,20);zb.root=Ba.Jsa(20,20);return Object(m.a)(new H.a,{Id:gb,ExternalId:bc||gb,
MenuItemId:tc||gb,Command:"1904816141",Icon:tb,Image:J.a.hf(16),ImageClass:Ma,LabelText:Ha,FullIconStyle:Tb,PreviewIconStyle:zb,Alt:Ha})}static Jsa(gb,Ha){const tb={};tb.width=gb;tb["min-width"]=gb;tb.height=Ha;return tb}}Object(t.a)(Ba,"AutomateCommandRenderer",null,[]);class fa{constructor(gb,Ha){this.scripts=gb;this.F4f=Ha}get length(){return this.scripts.length}XJa(gb){for(let Ha=0;Ha<this.scripts.length;Ha++)if(this.scripts[Ha].id===gb||this.scripts[Ha].shareId===gb)return Ha;return-1}sort(){this.F4f(this.scripts)}Js(gb){return-1===
this.XJa(gb.id)?(this.scripts.push(gb),!0):!1}wTc(gb){return-1===this.XJa(gb.id)?(this.scripts=[gb].concat(this.scripts),!0):!1}JAi(gb){gb=this.XJa(gb.id);if(-1!==gb){for(var Ha=this.scripts[gb].u_a();0<gb;)this.scripts[gb]=this.scripts[gb-1],gb--;this.scripts[0]=Ha}}Seb(gb){const Ha=this.XJa(gb.id);if(-1!==Ha){const tb=this.scripts[Ha].shareId;this.scripts[Ha]=gb;this.scripts[Ha].shareId=tb}}ief(gb){const Ha=this.XJa(gb.id);return-1!==Ha?gb.name===this.scripts[Ha].name:!1}N0a(gb){gb=this.XJa(gb);
return-1!==gb?(this.scripts.splice(gb,1),!0):!1}clear(){this.scripts=[]}getScripts(){return this.scripts}uH(gb){gb=this.XJa(gb);return-1!==gb?this.scripts[gb]:null}y3(gb){return 0<=gb&&this.length>gb?this.scripts[gb]:null}$Re(gb){const Ha=new fa([],this.F4f);for(let tb=0;tb<this.scripts.length;tb++){const bc=this.scripts[tb];gb.uH(bc.id)||Ha.Js(bc)}return Ha}Ydb(){const gb=[];for(const Ha of this.scripts)gb.push(Ha.XUd());return gb}}Object(t.a)(fa,"ScriptCollection",null,[]);var Y=a(191);class ja{constructor(gb){this.g$=
Y.b(gb)||{};this.shareId=this.shareId||null}get id(){return this.g$.id}get shareId(){return this.g$.shareId}set shareId(gb){this.g$.shareId=gb||null}get name(){return this.g$.name}get YEe(){return this.g$.dateLastPublished}get body(){return this.g$.body}get description(){return this.g$.description}get qbf(){return this.g$.isCreator}get isShared(){return!!this.shareId&&0<this.shareId.length}u_a(){return new ja(this.g$)}XUd(){return this.g$}}Object(t.a)(ja,"ScriptCore",null,[]);var ca=a(41);class aa extends F{constructor(gb,
Ha){super();this.$=gb;this.Ne=Ha}dfd(gb){switch(gb){case "1":case "2":case "3":case "4":case "5":case "6":return this.l_.y3(parseInt(gb,10)-1);default:return this.Ne.ot.uH(gb)||this.Ne.Xp.uH(gb)||this.Ne.Qj.uH(gb)||this.Ne.zB.uH(gb)}}rdd(gb,Ha){let tb=null;if(this.Ne.z4a)switch(gb){case "1":case "2":case "3":case "4":case "5":case "6":tb=this.l_.y3(parseInt(gb,10)-1);break;default:tb=this.l_.uH(gb)}W.a.isReactRibbonEnabled()?Ha[I.a.GalleryButtonProps]=Ba.y2c(gb,tb):Ha[I.a.InnerHTML]=Ba.vEh(tb);Ha[I.a.Alt]=
tb?tb.name:""}NN(gb){this.l_=this.gGd();this.$.qf();const Ha=[];Ha.push(Object(m.a)(new z.a,{name:"Operation",string:gb}));Ha.push(Object(m.a)(new z.a,{name:"HasReadRecentCachedScripts",bool:this.Ne.dcc}));Ha.push(Object(m.a)(new z.a,{name:"ReadScriptsDone",bool:this.Ne.Ohd}));Ha.push(Object(m.a)(new z.a,{name:"ReadSamplesScriptsDone",bool:this.Ne.KGb}));Ha.push(Object(m.a)(new z.a,{name:"SamplesScriptCount",int64:this.Ne.zB.length}));Ha.push(Object(m.a)(new z.a,{name:"ReadRecentScriptsDone",bool:this.Ne.oab}));
Ha.push(Object(m.a)(new z.a,{name:"RecentScriptCount",int64:this.Ne.ot.length}));Ha.push(Object(m.a)(new z.a,{name:"ReadWorkbookScriptsDone",bool:this.Ne.MV}));Ha.push(Object(m.a)(new z.a,{name:"WorkbookScriptCount",int64:this.Ne.Qj.length}));B.a(r.a.Fsf,!0,0,Ha)}fhd(gb){let Ha=!1,tb="";const bc=new ja(gb.scriptMetadata),tc={Operation:"HandleRefreshRibbonGallery"};tc.RefreshOperation=gb.operationName;switch(gb.operationName){case w.a.aNf:({message:tb,returnValue:Ha}=this.ehd(bc));break;case w.a.ZMf:({message:tb,
returnValue:Ha}=this.chd(bc));break;case w.a.YMf:({message:tb,returnValue:Ha}=this.bhd(bc));break;case w.a.$Mf:({message:tb,returnValue:Ha}=this.dhd(bc));break;case w.a.D6i:({message:tb,returnValue:Ha}=this.L2h(bc))}(tc.GalleryUpdated=Ha)?(c.ULS.sendTraceTag(537170322,0,50,`AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: ${tb}`),this.NN("RefreshGallery")):c.ULS.sendTraceTag(537170321,0,15,`AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: ${tb}`);
tc.Message=tb;c.ULS.sendTraceTag(537170320,0,50,ca.c(tc))}gGd(){const gb=new fa([],()=>{}),Ha=this.Ne.Qj?this.Ne.Qj.length:0,tb=this.Ne.ot?this.Ne.ot.length:0,bc=this.Ne.zB?this.Ne.zB.length:0;let tc=0,Ma=w.a.VHf;for(let Tb=0;Tb<Ma;Tb++)if(Tb<Ha)gb.Js(this.Ne.Qj.y3(Tb));else if(Tb-Ha+tc<tb){const zb=this.Ne.ot.y3(Tb-Ha+tc);this.Ne.Qj.uH(zb.id)?(tc++,Tb--):gb.Js(zb)}else Tb-Ha-tb+tc<bc&&gb.Js(this.Ne.zB.y3(Tb-Ha+tc-tb));return gb}ehd(gb){let Ha;if(this.Ne.ot.wTc(gb))Ha="";else{Ha="";const tb=gb.u_a();
this.Ne.Qj.Seb(tb);this.Ne.Qj.sort();this.Ne.ot.Seb(gb)}return{returnValue:!0,message:Ha}}chd(gb){this.Ne.Qj.N0a(gb.id);return this.Ne.ot.N0a(gb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}}bhd(gb){const Ha=gb.u_a();Ha.shareId=null;this.Ne.ot.wTc(Ha);return this.Ne.Qj.Js(gb)?(this.Ne.Qj.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}}dhd(gb){return this.Ne.Qj.N0a(gb.id)?
{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}}L2h(gb){const Ha=gb.u_a();let tb=!1;this.Ne.Qj.ief(Ha)&&(this.Ne.Qj.Seb(Ha),this.Ne.Qj.sort(),tb=!0);this.Ne.ot.wTc(gb)?tb=!0:this.Ne.ot.ief(gb)&&(this.Ne.ot.Seb(gb),this.Ne.ot.JAi(gb),tb=!0);return{returnValue:tb,message:""}}}Object(t.a)(aa,"AutomateCommandGallery",F,[]);var ta=a(82);class xa{constructor(){this.yz=null}}Object(t.a)(xa,"AutomateCommandLicensingBase",null,
[]);class ia{constructor(gb,Ha,tb=null,bc="",tc=""){this.value=gb;this.isSuccess=Ha;this.timeStamp=tb;this.errorCode=bc;this.errorMessage=tc}}Object(t.a)(ia,"BoolResultWrapper",null,[]);class ya extends xa{constructor(){super()}RZc(){const gb=y.a.Wa.Nb,Ha=[];return new Promise(tb=>{ta.a.instance.Wb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(bc=>{bc.isFeatureEnabled("ExcelOfficeScripting",!1).then(tc=>{Ha.push(Object(m.a)(new z.a,{name:"IsLicensed",bool:tc}));B.a(r.a.Bsf,
!0,u.getElapsedMilliseconds(gb,y.a.Wa.Nb),Ha);this.yz=new ia(tc,!0);tb(tc)}).catch(tc=>{Ha.push(Object(m.a)(new z.a,{name:"IsLicensed",bool:!1}));Ha.push(Object(m.a)(new z.a,{name:"Error",string:tc.toString()}));Ha.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"exception"}));B.a(r.a.Bsf,!1,u.getElapsedMilliseconds(gb,y.a.Wa.Nb),Ha);this.yz=new ia(!1,!1,void 0,"exception",tc.toString());tb(!1)})})})}}Object(t.a)(ya,"AutomateCommandLicensing",xa,[]);var ib=a(1296),wa=a(1294),sa=a(1293),Ya=a(1295),
bb=a(1384),mb=a(27),Ca=a(172),$a=a(569),Kb=a(309),rb=a(5);class cc{constructor(gb,Ha,tb,bc){this.Tid=gb;this.Rwh=Ha;this.Kla=tb;this.nha=bc}}Object(t.a)(cc,"LaunchSDXParams",null,[]);class nc{constructor(gb,Ha,tb,bc,tc,Ma){this.actionName=gb;this.shapeId=Ha;this.scriptLink=tb;this.clickId=bc;this.hba=tc;this.buttonText=Ma}}Object(t.a)(nc,"RunfromButtonParameters",null,[]);var Wb=a(160),Ea=a(58),ua=a(781),ma=a(51),fb=a(46),sb=a(159);class Ua{constructor(gb,Ha,tb,bc,tc,Ma,Tb,zb,ic){this.GA=null;this.cache=
new Kb.a;this.qwa=!1;this.yFa={};this.$=gb;this.EOc=tb;this.indexedDB=bc;this.Xnb=tc;this.Mu=Ma;this.Bga=Tb;this.Ne=zb;this.jC=ic;this.MMg=new Ba(this,gb);this.Ypg=y.a.Wa.Nb;this.d6f="";bc.If()&&(this.qwa=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));gb=!0;if(mb.a.ote){this.cache.If()&&!w.a.cta&&(Ha=this.Ne.MIh(w.a.R9b(this.$)),Ha.isSuccess&&(gb=u.getElapsedSeconds(Ha.timeStamp,y.a.Wa.Nb),this.Mu.yz=new ia(!0,!0),this.GA=new ia(Ha.value,!0),gb=this.GA.value?604800<gb:86400<gb,this.swb=
this.IRa(!0)));this.KGh();if("undefined"!==typeof makerstorage&&this.lhf)if(this.d6f=pa(this.$),O(this.$))oa(this.$,"localstorageToken"),this.Mu.yz=new ia(!0,!0),this.GA=new ia(!0,!0),this.swb=this.IRa(!0);else if((Ha=w.a.Vdd())&&makerstorage.setStorageEnvironmentOverride(Ha),gb||w.a.cta)try{this.$.scb("automateTab",!0),this.swb=w.a.cta?this.Mu.RZc().then(()=>this.Bga.cvb()).then(()=>this.IRa(!1)).catch(()=>this.IRa(!1)):this.Mu.RZc().then(()=>this.Bga.cvb()).then(Qb=>this.J3h(Qb)).then(()=>this.IRa(!1)).catch(()=>
this.IRa(!1))}catch(Qb){c.ULS.sendTraceTag(537170314,0,15,`AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: ${Qb.message}`),this.swb=Promise.resolve(!1),this.$.scb("automateTab",!1)}this.swb?this.swb.then(Qb=>{this.qJd(Qb);this.Ne.TXh()}):this.qJd(!1)}else c.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),this.qJd(!1)}get Xp(){return this.Ne.Xp}get Qj(){return R()?
new fa([],()=>{}):this.Ne.Qj}get zB(){return this.Ne.zB}get ot(){return this.Ne.ot}get Sa(){return this.EOc}get z4a(){return this.Ne.z4a}get initTime(){return this.Ypg}get hba(){const gb=!!this.Mu.yz&&this.Mu.yz.isSuccess&&this.Mu.yz.value;var Ha=!!this.GA&&!this.GA.isSuccess;const tb=!!this.GA&&this.Mu.yz.isSuccess&&this.GA.value;Ha=w.a.cta||tb||Ha&&!mb.a.nka(11);return this.lhf&&gb&&Ha}get lhf(){const gb="TestHost"===this.$.ya.DocumentHostInfo.HostTier;var Ha=v.AFrameworkApplication.fa.Va("UserPrincipalName");
Ha=!v.AFrameworkApplication.fa.qa("IsAnonymousUser")&&!!Ha&&!Ha.includes("ext#")&&!Ha.includes("guest#");return!mb.a.dba&&(gb||this.Bga.Kre&&Ha)}IRa(gb){const Ha=v.AFrameworkApplication.fa.qa("IsO365CommercialHost");let tb="",bc="",tc=!1;var Ma,Tb=(Ma=this.Mu.yz&&this.Mu.yz.isSuccess)&&this.Mu.yz.value;Ma=w.a.cta?Ma:!(Tb&&(!this.GA||!this.GA.isSuccess));this.Mu.yz&&!this.Mu.yz.isSuccess?(bc=this.Mu.yz.errorCode,tb=this.Mu.yz.errorMessage):this.GA&&!this.GA.isSuccess&&(bc=this.GA.errorCode,tb=this.GA.errorMessage);
Tb=[];Tb.push(Object(m.a)(new z.a,{name:"IsScriptingEnabled",bool:this.hba}));Tb.push(Object(m.a)(new z.a,{name:"IsValidHost",bool:Ha}));Tb.push(Object(m.a)(new z.a,{name:"IsUserLicensed",bool:this.Mu.yz?this.Mu.yz.value:!1}));w.a.cta||Tb.push(Object(m.a)(new z.a,{name:"IsAdminSwitchOn",bool:this.GA?this.GA.value:!1}));Tb.push(Object(m.a)(new z.a,{name:"ShowTab",bool:this.hba}));w.a.cta||Tb.push(Object(m.a)(new z.a,{name:"ServiceChecked",bool:!gb}));this.hba?W.a.Awa(this.$)&&(gb=Wb.a(this.$),(null===
gb||void 0===gb?0:gb.Vl)?(Tb.push(Object(m.a)(new z.a,{name:"RibbonType",string:"React"})),gb.Vl.QAj(rb.a.GGb),gb.Vl.sOd(["AutomateAutomateTask"],!w.a.Gsf),da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(tc=!0)):(bc="ribbon_manager_error",tb="The RibbonManager or RibbonUser is null")):this.B5h();Tb.push(Object(m.a)(new z.a,{name:"Error",string:tb}));Tb.push(Object(m.a)(new z.a,
{name:"ErrorCode",string:bc}));B.a(r.a.AEi,Ma,u.getElapsedMilliseconds(this.initTime,y.a.Wa.Nb),Tb);this.$.scb("automateTab",!1);return Promise.resolve(tc)}Rc(gb,Ha){if(!Ha)return!1;Ha.MenuItems=this.MMg.AFh(Ha.MenuId);return!0}aYi(){this.qwa&&(w.a.g5?this.Ne.CLf(this.jC).continueWith(gb=>{gb.result&&this.jC.NN(w.a.wPa)}):this.Ne.$4i(this.jC));O(this.$)?this.T0e(Object(m.a)(new x.a,{IsSuccess:!0,Token:"FakeToken"})):this.Bga.cvb().then(gb=>{this.T0e(gb)})}rdd(gb,Ha,tb){if(w.a.g5)this.jC.rdd(gb,Ha,
tb);else{tb=null;if(this.Ne.z4a)switch(gb){case "1":case "2":case "3":case "4":case "5":case "6":tb=this.jC.l_.y3(parseInt(gb,10)-1);break;default:tb=this.jC.l_.uH(gb)}Ha[I.a.GalleryButtonProps]=Ba.y2c(gb,tb);Ha[I.a.Alt]=tb?tb.name:""}}fhd(gb){if(w.a.g5)this.jC.fhd(gb);else{let Ha=!1,tb="";const bc=new ja(gb.scriptMetadata),tc={Operation:"HandleRefreshRibbonGallery"};tc.RefreshOperation=gb.operationName;switch(gb.operationName){case w.a.aNf:({message:tb,returnValue:Ha}=this.ehd(bc));break;case w.a.ZMf:({message:tb,
returnValue:Ha}=this.chd(bc));break;case w.a.YMf:({message:tb,returnValue:Ha}=this.bhd(bc));break;case w.a.$Mf:({message:tb,returnValue:Ha}=this.dhd(bc))}(tc.GalleryUpdated=Ha)?(c.ULS.sendTraceTag(537170313,0,50,`AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: ${tb}`),this.NN("RefreshGallery")):c.ULS.sendTraceTag(537170312,0,15,`AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: ${tb}`);tc.Message=tb;c.ULS.sendTraceTag(537170311,0,50,
ca.c(tc))}}f3h(gb,Ha,tb,bc){if(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6254340_ExitCellEditModeOnRFBClick")||this.$.rq(null,!1,1023))gb=new nc(w.a.tUf,gb,Ha,tb,this.hba,bc),this.Xnb.bwb(gb)}d5e(gb,Ha,tb){gb=new nc(w.a.aWj,gb,Ha,tb,this.hba);this.Xnb.bwb(gb)}N0h(gb){this.Xnb.Ggd(w.a.dBj,gb)}M0h(gb){this.Xnb.Ggd(w.a.Z0g,gb)}O0h(gb){this.Xnb.Ggd(w.a.hFj,gb)}Bqi(gb,Ha){var tb=ma.b().nj(gb);const bc=[];bc.push(Object(m.a)(new z.a,{name:"SessionId",string:this.$.ya.UserSessionId}));bc.push(Object(m.a)(new z.a,
{name:"MenuItemId",string:Ha}));bc.push(Object(m.a)(new z.a,{name:"WorkbookScriptCount",int64:this.Qj.length}));bc.push(Object(m.a)(new z.a,{name:"PublishedScriptCount",int64:this.Xp.length}));bc.push(Object(m.a)(new z.a,{name:"RecentScriptCount",int64:this.ot.length}));bc.push(Object(m.a)(new z.a,{name:"Command",string:tb}));Ha=this.HVh(gb,Ha);if(tb=this.gQh(gb,tb,Ha))bc.push(Object(m.a)(new z.a,{name:w.a.S9,string:tb.Kla.Kp[w.a.S9]})),ib.a.instance.NMa(tb.Rwh,"Taskpane",tb.nha,tb.Tid,tb.Kla),1904816141===
gb&&(bc.push(Object(m.a)(new z.a,{name:"ScriptId",string:Ha.id})),bc.push(Object(m.a)(new z.a,{name:"ShareId",string:Ha.shareId})),bc.push(Object(m.a)(new z.a,{name:"IsPreviewGallery",bool:!!this.jC.l_.uH(Ha.id)})),bc.push(Object(m.a)(new z.a,{name:"IsOwner",bool:Ha.qbf||!!this.Xp.uH(Ha.id)})),this.$.qf());B.a(r.a.xEi,void 0,void 0,bc)}gQh(gb,Ha,tb){let bc=null;const tc=w.a.su,Ma=new wa.a(w.a.I7e,w.a.sTe,w.a.locale),Tb=new sa.a(w.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,w.a.ZLd),zb=new Ya.a;
zb.Kp.AdminPolicyForFeedback=ca.c(this.yFa);zb.Kp.DocumentHostInfo=Ea.a.Ac(this.$.ya.DocumentHostInfo);zb.Kp.CodeEditorUrl=w.a.m3a(this.$);zb.Kp.MakerTestService=da.EwaSettings.getBooleanFeatureGate(w.a.Fjc,!1);zb.Kp[w.a.JTf]=w.a.W2a(this.$);zb.Kp.StorageModePreference=this.d6f||"";zb.Kp.Source="Ribbon";zb.Kp[w.a.X7f]=Ea.a.Ac(tc);zb.Kp[w.a.Ese]=this.$.Asf?"true":"false";zb.Kp[w.a.S9]=Ca.a.create().toString();var ic=Ra(this.$);const Qb=Ga(this.$);zb.optionalProperties.HeaderCssClass=ic;zb.optionalProperties.TitleCssClass=
Qb;zb.Kp[w.a.y6e]=ic;zb.Kp[w.a.e9f]=Qb;ic={};ic.ribbonCommand=Ha;ic[w.a.b6f]=this.Bga.getAuthContext();ic[w.a.V$a]=this.Ne.BLf?this.Xp.Ydb():null;ic[w.a.yXj]=this.Ne.XFd?this.Qj.Ydb():null;w.a.g5&&(ic[w.a.wPa]=this.Ne.VFd?this.ot.Ydb():null);zb.Kp[w.a.O$e]=Ea.a.Ac(ic);Ha={};ea(this.$,Ha);zb.Kp[w.a.ESe]=Ea.a.Ac(Ha);switch(gb){case -45542983:zb.Kp.Script="";zb.Kp.Destination="Editor";zb.Kp.IsOwner=!0;zb.optionalProperties[bb.a.Zk]=M.a.instance.ga(2127);zb.optionalProperties[bb.a.taskPaneWidth]=tc;zb.optionalProperties[bb.a.sourceLocationOverrideResourceId]=
w.a.m3a(this.$);bc=w.a.G1b;break;case -1342227603:zb.optionalProperties[bb.a.Zk]=M.a.instance.ga(2129);zb.optionalProperties[bb.a.taskPaneWidth]=tc;zb.optionalProperties[bb.a.sourceLocationOverrideResourceId]=w.a.Z_e(this.$);break;case 971811139:case 1606046412:zb.Kp.Script="";zb.Kp.Destination="BackStage";zb.Kp.IsOwner=!0;zb.optionalProperties[bb.a.Zk]=M.a.instance.ga(2127);zb.optionalProperties[bb.a.taskPaneWidth]=tc;zb.optionalProperties[bb.a.sourceLocationOverrideResourceId]=w.a.m3a(this.$);bc=
w.a.G1b;break;case 1043696663:zb.Kp.Script="";zb.Kp.Destination="BackStage_Workbook";zb.optionalProperties[bb.a.Zk]=M.a.instance.ga(2127);zb.optionalProperties[bb.a.taskPaneWidth]=tc;zb.optionalProperties[bb.a.sourceLocationOverrideResourceId]=w.a.m3a(this.$);bc=w.a.G1b;break;case 1845457202:zb.optionalProperties[bb.a.Zk]=M.a.instance.ga(2128);zb.optionalProperties[bb.a.taskPaneWidth]=tc;zb.optionalProperties[bb.a.sourceLocationOverrideResourceId]=w.a.s0e(this.$);bc=w.a.kkj;break;case -2126202430:case 1623358083:case 1904816141:if(tb)zb.Kp.Script=
Ea.a.Ac(tb.XUd()),zb.Kp.Destination="Details",zb.Kp.IsOwner=tb.qbf||!!this.Xp.uH(tb.id),zb.optionalProperties[bb.a.Zk]=M.a.instance.ga(2127),zb.optionalProperties[bb.a.taskPaneWidth]=tc,zb.optionalProperties[bb.a.sourceLocationOverrideResourceId]=w.a.m3a(this.$),bc=w.a.G1b;else return null;break;default:return null}return new cc(Ma,Tb,zb,bc)}HVh(gb,Ha){switch(gb){case -2126202430:gb=this.Ne.xMb.uH(w.a.i8f);break;case 1623358083:gb=this.Ne.xMb.uH(w.a.j8f);break;default:gb=Ha?this.dfd(Ha):null}return gb}KGh(){ta.a.instance.Wb("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(gb=>
{this.yFa.FeedbackEnabled=!0;this.yFa.ScreenshotEnabled=!0;this.yFa.EmailEnabled=!0;gb.EM("Enabled").then(Ha=>{this.yFa.FeedbackEnabled=Ha},()=>{});gb.EM("IncludeScreenshot").then(Ha=>{this.yFa.ScreenshotEnabled=Ha},()=>{});gb.EM("IncludeEmail").then(Ha=>{this.yFa.EmailEnabled=Ha},()=>{})})}J3h(gb){const Ha=y.a.Wa.Nb,tb=[];if(!gb||!gb.IsSuccess){const bc=gb?gb.ErrorCode:"need_token";gb=gb?gb.ErrorMessage:"No Access Token";tb.push(Object(m.a)(new z.a,{name:"ServiceChecked",bool:!1}));tb.push(Object(m.a)(new z.a,
{name:"Error",string:gb}));tb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:bc}));B.a(r.a.Rxd,!1,u.getElapsedMilliseconds(Ha,y.a.Wa.Nb),tb);this.GA=new ia(!1,!1,void 0,bc,gb);return Promise.resolve(!1)}tb.push(Object(m.a)(new z.a,{name:"ServiceChecked",bool:!0}));oa(this.$,gb.Token);return makerstorage.getUserPermissions(this.$.ya.UserSessionId).then(bc=>{this.GA=new ia(bc.OfficeScriptingEnabled,!0);this.Ne.ASg(w.a.R9b(this.$),bc.OfficeScriptingEnabled);tb.push(Object(m.a)(new z.a,{name:"IsEnabled",
bool:this.GA.value}));B.a(r.a.Rxd,!0,u.getElapsedMilliseconds(Ha,y.a.Wa.Nb),tb);return Promise.resolve(this.GA.value)}).catch(bc=>{Object.getType(bc)===makerstorage.StorageServiceError?(tb.push(Object(m.a)(new z.a,{name:"Error",string:bc.message})),tb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:`makerstorage_${bc.errorCode.toString()}_${bc.status.toString()}`}))):(tb.push(Object(m.a)(new z.a,{name:"Error",string:bc.toString()})),tb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"exception"})));
B.a(r.a.Rxd,!1,u.getElapsedMilliseconds(Ha,y.a.Wa.Nb),tb);this.GA=new ia(!1,!1,void 0,"exception",bc.toString());return Promise.resolve(!1)})}T0e(gb){this.Ne.BVh(this.jC);w.a.g5?this.Ne.vUh(gb,this.jC,this.cache):this.UTh(gb);R()||this.Ne.Z4i(Ha=>{this.Ne.oWh(Ha,gb,this.jC)},this.jC)}UTh(gb){const Ha=y.a.Wa.Nb,tb=[];if(gb&&gb.IsSuccess){oa(this.$,gb.Token);var bc=$a.a.create().toString();tb.push(Object(m.a)(new z.a,{name:"CorrelationId",string:bc}));makerstorage.getScripts(bc).then(tc=>{tb.push(Object(m.a)(new z.a,
{name:"HasReadCachedScripts",bool:this.Ne.qwb}));this.Xp.clear();for(const Ma of tc)this.Xp.Js(new ja(Ma));this.Xp.sort();this.Ne.BLf=!0;this.Ne.nab=!0;this.qwa&&(tc=Ea.a.Ac(this.Xp.Ydb()),this.indexedDB.Nbb(new ua.a(w.a.V$a,tc)));tb.push(Object(m.a)(new z.a,{name:"ScriptCount",int64:this.Xp.length}));B.a(r.a.kDb,!0,u.getElapsedMilliseconds(Ha,y.a.Wa.Nb),tb);this.NN(w.a.V$a)}).catch(tc=>{Object.getType(tc)===makerstorage.StorageServiceError?(tb.push(Object(m.a)(new z.a,{name:"Error",string:tc.message})),
tb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:`makerstorage_${tc.errorCode.toString()}_${tc.status.toString()}`})),17===tc.errorCode&&this.cache.JHd(w.a.R9b(this.$))):(tb.push(Object(m.a)(new z.a,{name:"Error",string:tc.toString()})),tb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"exception"})));B.a(r.a.kDb,!1,u.getElapsedMilliseconds(Ha,y.a.Wa.Nb),tb);this.Ne.nab=!0;this.NN(w.a.V$a)})}else bc=gb?gb.ErrorCode:"need_token",gb=gb?gb.ErrorMessage:"No Access Token",tb.push(Object(m.a)(new z.a,
{name:"ServiceChecked",bool:!1})),tb.push(Object(m.a)(new z.a,{name:"Error",string:gb})),tb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:bc})),B.a(r.a.kDb,!1,u.getElapsedMilliseconds(Ha,y.a.Wa.Nb),tb),this.Ne.nab=!0,this.NN(w.a.V$a)}dfd(gb){if(w.a.g5)return this.jC.dfd(gb);switch(gb){case "1":case "2":case "3":case "4":case "5":case "6":return this.jC.l_.y3(parseInt(gb,10)-1);default:return this.Xp.uH(gb)||this.Qj.uH(gb)||this.zB.uH(gb)}}ehd(gb){let Ha;if(this.Xp.Js(gb))this.Xp.sort(),Ha="";
else{Ha="";const tb=gb.u_a();this.Qj.Seb(tb);this.Qj.sort();this.Xp.Seb(gb);this.Xp.sort()}return{returnValue:!0,message:Ha}}chd(gb){this.Qj.N0a(gb.id);return this.Xp.N0a(gb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}}bhd(gb){const Ha=gb.u_a();Ha.shareId=null;this.Xp.Js(Ha)&&this.Xp.sort();return this.Qj.Js(gb)?(this.Qj.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}}dhd(gb){return this.Qj.N0a(gb.id)?
{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}}NN(gb){if(w.a.g5)this.jC.NN(gb);else{this.gGd();this.$.qf();const Ha=[];Ha.push(Object(m.a)(new z.a,{name:"Operation",string:gb}));Ha.push(Object(m.a)(new z.a,{name:"HasReadCachedScripts",bool:this.Ne.qwb}));Ha.push(Object(m.a)(new z.a,{name:"ReadScriptsDone",bool:this.Ne.Ohd}));Ha.push(Object(m.a)(new z.a,{name:"ReadSamplesScriptsDone",bool:this.Ne.KGb}));Ha.push(Object(m.a)(new z.a,
{name:"SamplesScriptCount",int64:this.zB.length}));Ha.push(Object(m.a)(new z.a,{name:"ReadPublishedScriptsDone",bool:this.Ne.nab}));Ha.push(Object(m.a)(new z.a,{name:"PublishedScriptCount",int64:this.Xp.length}));Ha.push(Object(m.a)(new z.a,{name:"ReadWorkbookScriptsDone",bool:this.Ne.MV}));Ha.push(Object(m.a)(new z.a,{name:"WorkbookScriptCount",int64:this.Qj.length}));B.a(r.a.Fsf,!0,0,Ha)}}gGd(){this.jC.l_=new fa([],()=>{});const gb=this.Qj?this.Qj.length:0,Ha=this.Xp?this.Xp.length:0,tb=this.zB?
this.zB.length:0;let bc=0;const tc=w.a.VHf;for(let Ma=0;Ma<tc;Ma++)if(Ma<gb)this.jC.l_.Js(this.Qj.y3(Ma));else if(Ma-gb+bc<Ha){const Tb=this.Xp.y3(Ma-gb+bc);this.Qj.uH(Tb.id)?(bc++,Ma--):this.jC.l_.Js(Tb)}else Ma-gb-Ha+bc<tb&&this.jC.l_.Js(this.zB.y3(Ma-gb+bc-Ha))}qJd(gb){da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(gb?(fb.PageLoadTrackingInfo.instance.A_(rb.a.VN,
["automateTab"]),fb.PageLoadTrackingInfo.instance.VV(rb.a.VN,["automateTab"]),fb.PageLoadTrackingInfo.instance.UV(rb.a.VN,["automateTab"])):fb.PageLoadTrackingInfo.instance.Sca(rb.a.VN,["automateTab"]))}B5h(){da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&sb.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(rb.a.GGb))}}Object(t.a)(Ua,"AutomateCommandManager",null,[375]);var ab=a(1351),na=a(1298),Na=a(248),Va=a(958),Sa=a(50),vb=a(104),Oa=
a(21),yb=a(960);class Ob{constructor(gb,Ha,tb,bc){this.H6a=!1;this.U8a=()=>{this.w1f()?(this.fHf(),Oa.g(this.$).Ea.cId(this.U8a)):this.H6a&&Oa.g(this.$).Ea.cId(this.U8a)};this.BHi=(tc,Ma)=>{Object.getType(Ma)===String&&Ma.toString().endsWith(w.a.vvb(this.$))&&(this.H6a=!1)};this.$=gb;this.Bga=Ha;this.Mu=tb;this.businessBarManager=bc;this.guj()}bwb(gb){if(gb.hba){const Ha=[];Ha.push(Object(m.a)(new z.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.H6a}));Ha.push(Object(m.a)(new z.a,{name:"actionName",
string:gb.actionName}));Ha.push(Object(m.a)(new z.a,{name:w.a.S9,string:gb.clickId.toString()}));this.H6a?this.JWf(gb):this.x1h(gb);B.a(r.a.yEi,void 0,void 0,Ha)}}Ggd(gb,Ha){const tb={};tb[w.a.S9]=Ha;this.HMd(gb,tb)}guj(){this.w1f()?this.fHf():Oa.g(this.$).Ea.Hle(this.U8a)}w1f(){if(this.H6a||O(this.$))return!1;const gb=vb.a(this.$);return Oa.g(this.$).Ea.cZb&&gb.Kdi()}fHf(){this.Mu.yz?this.Mu.yz.value&&this.Bga.cvb():this.Mu.RZc().then(gb=>{gb&&this.Bga.cvb()});B.a(r.a.tEi)}pmj(){const gb=Ca.a.create().toString();
var Ha={};ea(this.$,Ha);const tb={};tb[w.a.b6f]=this.Bga.getAuthContext();const bc={};bc[w.a.ESe]=Ea.a.Ac(Ha);bc[w.a.O$e]=Ea.a.Ac(tb);bc[w.a.Igh]=Ea.a.Ac(this.$.ya.DocumentHostInfo);bc[w.a.oFj]=pa(this.$);bc[w.a.X7f]=Ea.a.Ac(w.a.su);bc[w.a.Ese]=this.$.Asf?"true":"false";bc[w.a.JTf]=w.a.W2a(this.$);bc[w.a.y6e]=Ra(this.$);bc[w.a.e9f]=Ga(this.$);bc[w.a.S9]=gb;Ha=[];Ha.push(Object(m.a)(new z.a,{name:w.a.S9,string:gb}));B.a(r.a.wEi,void 0,void 0,Ha);this.HMd(w.a.r9h,bc)}x1h(gb){this.Gyj(gb);O(this.$)&&
oa(this.$,"localstorage");f.TaskExtensions.Aa(Sa.GetServiceTaskFactory.Ra(this.$.da,374,375,1),Ha=>{this.ksi(Ha.result).continueWith(()=>{this.omj(gb)});this.H6a=!0},this.$.la,3)}ksi(gb){const Ha={};Ha.SolutionId=w.a.solutionId;Ha.Version=w.a.ZLd;Ha.StoreType=OSF.StoreType.Sdx;Ha.StoreId=OSF.StoreType.Sdx;Ha.AssetId=w.a.solutionId;Ha.AssetStoreId=OSF.StoreType.Sdx;Ha.TargetType=1;Ha.SharedRuntimeId=w.a.vvb(this.$);Ha.SourceLocationOverrideResourceId=w.a.vvb(this.$);Ha.IsToBePersisted=!1;const tb=
new ab.a;tb.Zk=M.a.instance.ga(2151);tb.taskPaneWidth=w.a.su;const bc=new Va.a;bc.Xdb=Ga(this.$);bc.N3=Ra(this.$);return gb.Ctc(Ha,tb,void 0,void 0,bc)}omj(gb){this.pmj();Na.a(this.$)&&Na.a(this.$).Vle(this.BHi);this.JWf(gb)}JWf(gb){const Ha={};Ha[w.a.wij]=gb.shapeId;Ha[w.a.vij]=gb.scriptLink;Ha[w.a.S9]=gb.clickId.toString();Ha[w.a.uij]=gb.buttonText;this.HMd(gb.actionName,Ha)}HMd(gb,Ha){const tb=new sa.a(w.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,w.a.ZLd),bc=new wa.a(w.a.I7e,w.a.sTe,this.$.ya.UICultureTag),
tc=new Ya.a;tc.optionalProperties[bb.a.Zk]=M.a.instance.ga(2151);tc.optionalProperties[bb.a.sourceLocationOverrideResourceId]=w.a.vvb(this.$);tc.optionalProperties[bb.a.fSc]=Ha;tc.optionalProperties[bb.a.taskPaneWidth]=w.a.su;ib.a.instance.NMa(tb,na.a.action,gb,bc,tc)}Gyj(gb){da.EwaSettings.getBooleanFeatureGate(w.a.Y7f,!1)&&gb.actionName===w.a.tUf&&(gb=new yb.a(gb.scriptLink,"initializing",gb.clickId.toString(),gb.buttonText),this.businessBarManager.Oke(65,gb))}}Object(t.a)(Ob,"AutomateCommandRunFromButton",
null,[374]);var Ja=a(155),lb=a(22);class Pb{constructor(){this.ot=null;this.qwb=this.KGb=this.MV=this.nab=this.XFd=this.BLf=this.VFd=this.oab=this.dcc=!1;this.xMb=this.zB=this.Qj=this.Xp=null}get z4a(){const gb=w.a.g5?this.dcc:this.qwb;return this.KGb||gb||this.Ohd}get Ohd(){return(w.a.g5?this.oab:this.nab)&&this.MV&&this.KGb}static WCj(gb){gb.sort((Ha,tb)=>tb.YEe-Ha.YEe)}static kxc(gb){gb.sort((Ha,tb)=>lb.a.compare(Ha.name,tb.name,!0))}static dXh(gb){let Ha,tb;tb=Ha=null;if(gb){const bc=gb.indexOf(":");
if(-1!==bc)return Ha=gb.substr(0,bc),tb=gb.substr(bc+1),{returnValue:!0,c6f:Ha,shareId:tb}}return{returnValue:!1,c6f:Ha,shareId:tb}}static $Vh(gb,Ha){const tb={};tb[w.a.wgg]=encodeURIComponent(gb.workbookContext.WorkbookFileName);tb[w.a.RVf]=Ha.Ydb();return ca.c(tb)}static FLf(gb,Ha){return f.TaskExtensions.e$(Ha.x3a(w.a.lCc),tb=>{tb=tb.result;if(""!==tb){var bc=ca.b(tb);tb=bc[w.a.RVf];if(bc[w.a.wgg]===encodeURIComponent(gb.workbookContext.WorkbookFileName)){bc=new fa([],tc=>{Pb.kxc(tc)});for(const tc of tb)bc.Js(new ja(tc));
bc.sort();return bc}}},gb.la,3)}}Object(t.a)(Pb,"AutomateCommandStorageBase",null,[]);var Jb=a(121),Lb=a(99);class Ab extends Pb{constructor(gb,Ha){super();this.$=gb;this.e1a=new DOMParser;this.cache=new Kb.a;this.indexedDB=Ha;Ha.If()&&this.indexedDB.initialize("Scripts","OfficeScriptingCache");this.qwb=!1;this.Xp=new fa([],tb=>{Pb.WCj(tb)});this.Qj=new fa([],tb=>{Pb.kxc(tb)});this.zB=new fa([],tb=>{Pb.kxc(tb)});this.ot=new fa([],()=>{});this.xMb=new fa([],tb=>{Pb.kxc(tb)})}ASg(gb,Ha){if(this.cache.If()){const tb=
{};tb.TimeStamp=y.a.Wa.Nb;tb.IsEnabled=Ha;this.cache.YNd(gb,Ea.a.Ac(tb))}}MIh(gb){let Ha=!1,tb=!1,bc=null;this.cache.If()&&(gb=ca.b(this.cache.Yub(gb)))&&(tb=gb.IsEnabled,bc=new Date(gb.TimeStamp),Ha=!0);return new ia(tb,Ha,bc)}CLf(gb){const Ha=y.a.Wa.Nb,tb=[];return f.TaskExtensions.e$(this.indexedDB.x3a(w.a.wPa),bc=>{const tc=!this.oab||!this.ot.length;bc=bc.result;tb.push(Object(m.a)(new z.a,{name:"ExistingScriptCount",int64:this.ot.length}));if(""!==bc&&(bc=ca.b(bc),tb.push(Object(m.a)(new z.a,
{name:"CachedScriptCount",int64:bc.length})),tc)){for(const Ma of bc)this.ot.Js(new ja(Ma));this.dcc=!0;this.VFd=0<bc.length;B.a(r.a.Dsf,tc,u.getElapsedMilliseconds(Ha,y.a.Wa.Nb),tb);this.DGd(gb);return!0}B.a(r.a.Dsf,tc,u.getElapsedMilliseconds(Ha,y.a.Wa.Nb),tb);return!1},this.$.la,3)}$4i(gb){da.EwaSettings.getBooleanFeatureGate(w.a.yWc,!1)&&!R()&&this.f5i(gb);w.a.g5?this.CLf(gb):this.Y4i(gb)}vUh(gb,Ha,tb){const bc=y.a.Wa.Nb,tc=[];if(gb&&gb.IsSuccess){oa(this.$,gb.Token);var Ma=$a.a.create().toString();
tc.push(Object(m.a)(new z.a,{name:"CorrelationId",string:Ma}));makerstorage.getRecentScripts(Ma).then(Tb=>{tc.push(Object(m.a)(new z.a,{name:"HasReadCachedScripts",bool:this.dcc}));this.ot.clear();for(const zb of Tb)this.ot.Js(new ja(zb));this.oab=this.VFd=!0;this.indexedDB.If()&&(Tb=Ea.a.Ac(this.ot.Ydb()),this.indexedDB.Nbb(new ua.a(w.a.wPa,Tb)));tc.push(Object(m.a)(new z.a,{name:"ScriptCount",int64:this.ot.length}));B.a(r.a.kDb,!0,u.getElapsedMilliseconds(bc,y.a.Wa.Nb),tc);Ha.NN(w.a.wPa)}).catch(Tb=>
{Object.getType(Tb)===makerstorage.StorageServiceError?(tc.push(Object(m.a)(new z.a,{name:"Error",string:Tb.message})),tc.push(Object(m.a)(new z.a,{name:"ErrorCode",string:`makerstorage_${Tb.errorCode.toString()}_${Tb.status.toString()}`})),17===Tb.errorCode&&tb.JHd(w.a.R9b(this.$))):(tc.push(Object(m.a)(new z.a,{name:"Error",string:Tb.toString()})),tc.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"exception"})));B.a(r.a.uEi,!1,u.getElapsedMilliseconds(bc,y.a.Wa.Nb),tc);this.oab=!0;Ha.NN(w.a.wPa)})}else Ma=
gb?gb.ErrorCode:"need_token",gb=gb?gb.ErrorMessage:"No Access Token",tc.push(Object(m.a)(new z.a,{name:"ServiceChecked",bool:!1})),tc.push(Object(m.a)(new z.a,{name:"Error",string:gb})),tc.push(Object(m.a)(new z.a,{name:"ErrorCode",string:Ma})),B.a(r.a.kDb,!1,u.getElapsedMilliseconds(bc,y.a.Wa.Nb),tc),this.oab=!0,Ha.NN(w.a.wPa)}Z4i(gb,Ha){const tb=new Ja.a,bc=Z(this.$);Pa(this.$,tc=>{if((tc=tc.Result)&&200===tc.ResponseStatusCode)tc=tc.ResponseBody.join(""),tc=JSON.parse(tc),gb(this.aWi(tc.value)),
tb.setResult(!0);else{tc=tc?"RichApi_"+tc.ResponseStatusCode:"RichApiError";const Ma=[];Ma.push(Object(m.a)(new z.a,{name:"Error",string:"Failed to read shared script ids from document"}));Ma.push(Object(m.a)(new z.a,{name:"ErrorCode",string:tc}));this.MV=!0;this.j_a(Ha,y.a.Wa.Nb,0,Ma);tb.setResult(!1)}},tc=>{tc=Jb.a.lf(tc.data);c.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");const Ma=[];Ma.push(Object(m.a)(new z.a,{name:"Error",string:"Failure using rich api: "+
tc}));Ma.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"RichApiFailure"}));this.MV=!0;this.j_a(Ha,y.a.Wa.Nb,0,Ma);tb.setResult(!1)},bc,tb)}oWh(gb,Ha,tb){const bc=y.a.Wa.Nb;let tc=0,Ma=0;this.MV=tc===gb.count;const Tb=[];Tb.push(Object(m.a)(new z.a,{name:"ScriptIds",int64:gb.count}));if(gb.count)if(Ha&&Ha.IsSuccess){oa(this.$,Ha.Token);for(var zb of gb){const ic=$a.a.create().toString();makerstorage.getSharedScript(zb.value,ic).then(Qb=>{const wb=[];wb.push(Object(m.a)(new z.a,{name:"BodySize",
int64:Qb.body.length}));wb.push(Object(m.a)(new z.a,{name:"CorrelationId",string:ic}));B.a(r.a.Esf,!0,u.getElapsedMilliseconds(bc,y.a.Wa.Nb),wb);tc++;Qb=new ja(Qb);Qb.shareId=gb.na(Qb.id);this.Qj.Js(Qb);this.MV=tc===gb.count;this.XFd=!0;this.j_a(tb,bc,Ma,Tb)}).catch(Qb=>{const wb=[];Object.getType(Qb)===makerstorage.StorageServiceError?(Tb.push(Object(m.a)(new z.a,{name:"Error",string:Qb.message})),Tb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:`makerstorage_${Qb.errorCode.toString()}_${Qb.status.toString()}`}))):
(wb.push(Object(m.a)(new z.a,{name:"Error",string:Qb.toString()})),wb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"exception"})));wb.push(Object(m.a)(new z.a,{name:"CorrelationId",string:ic}));B.a(r.a.Esf,!1,u.getElapsedMilliseconds(bc,y.a.Wa.Nb),wb);tc++;Ma++;this.MV=tc===gb.count;this.j_a(tb,bc,Ma,Tb)}).finally(()=>{if(da.EwaSettings.getBooleanFeatureGate(w.a.yWc,!1)&&this.indexedDB.If()&&this.MV){const Qb=Pb.$Vh(this.$,this.Qj);this.indexedDB.Nbb(new ua.a(w.a.lCc,Qb))}})}}else zb=Ha?Ha.ErrorCode:
"need_token",Ha=Ha?Ha.ErrorMessage:"No Access Token",Tb.push(Object(m.a)(new z.a,{name:"Error",string:Ha})),Tb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:zb})),this.MV=!0,this.j_a(tb,bc,Ma,Tb);else this.MV=this.XFd=!0,this.j_a(tb,bc,Ma,Tb),da.EwaSettings.getBooleanFeatureGate(w.a.yWc,!1)&&f.TaskExtensions.e$(Pb.FLf(this.$,this.indexedDB),ic=>{ic.result&&(this.indexedDB.X4c(w.a.lCc),this.Qj.clear(),tb.NN("CachedScripts"))},this.$.la,3)}BVh(gb){const Ha={id:"samples-6"};Ha.name=M.a.instance.ga(2145);
this.zB.Js(new ja(Ha));Ha.id="samples-8";Ha.name=M.a.instance.ga(2146);this.zB.Js(new ja(Ha));Ha.id="samples-2";Ha.name=M.a.instance.ga(2142);this.zB.Js(new ja(Ha));Ha.id="samples-4";Ha.name=M.a.instance.ga(2143);this.zB.Js(new ja(Ha));Ha.id="samples-5";Ha.name=M.a.instance.ga(2144);this.zB.Js(new ja(Ha));Ha.id="samples-9";Ha.name=M.a.instance.ga(2147);this.zB.Js(new ja(Ha));this.KGb=!0;gb.NN("SampleScripts")}TXh(){const gb={};gb.id=w.a.i8f;gb.name=M.a.instance.ga(2148);this.xMb.Js(new ja(gb));gb.id=
w.a.j8f;gb.name=M.a.instance.ga(2149);this.xMb.Js(new ja(gb))}aWi(gb){const Ha=new Lb.a;if(gb=this.e1a.parseFromString(gb,"text/xml").querySelector('[id="script-ids-node-id"]')){gb=gb.getElementsByTagName("scriptId");for(let tb=0;tb<gb.length;tb++){const bc=gb[tb].getAttribute("id");if(bc){let tc,Ma;({c6f:tc,shareId:Ma}=Pb.dXh(bc)).returnValue&&Ha.ia(tc,Ma)}}}return Ha}f5i(gb){const Ha=y.a.Wa.Nb,tb=[];f.TaskExtensions.e$(Pb.FLf(this.$,this.indexedDB),bc=>{bc=bc.result;tb.push(Object(m.a)(new z.a,
{name:"ExistingScriptCount",int64:this.Qj.length}));if(bc){tb.push(Object(m.a)(new z.a,{name:"CachedScriptCount",int64:bc.length}));const tc=!this.MV||0===this.Qj.length;if(tc){for(const Ma of bc.getScripts())this.Qj.Js(Ma);this.Qj.sort();B.a(r.a.Sxd,tc,u.getElapsedMilliseconds(Ha,y.a.Wa.Nb),tb);this.DGd(gb);return!0}B.a(r.a.Sxd,tc,u.getElapsedMilliseconds(Ha,y.a.Wa.Nb),tb)}else B.a(r.a.Sxd,!1,u.getElapsedMilliseconds(Ha,y.a.Wa.Nb),tb);return!1},this.$.la,3)}Y4i(gb){const Ha=y.a.Wa.Nb,tb=[];f.TaskExtensions.e$(this.indexedDB.x3a(w.a.V$a),
bc=>{const tc=!this.nab||!this.Xp.length;bc=bc.result;tb.push(Object(m.a)(new z.a,{name:"ExistingScriptCount",int64:this.Xp.length}));if(""!==bc&&(bc=ca.b(bc),tb.push(Object(m.a)(new z.a,{name:"CachedScriptCount",int64:bc.length})),tc)){for(const Ma of bc)this.Xp.Js(new ja(Ma));this.Xp.sort();B.a(r.a.Csf,tc,u.getElapsedMilliseconds(Ha,y.a.Wa.Nb),tb);this.DGd(gb);return!0}B.a(r.a.Csf,tc,u.getElapsedMilliseconds(Ha,y.a.Wa.Nb),tb);return!1},this.$.la,3)}j_a(gb,Ha,tb,bc){this.MV&&(bc.push(Object(m.a)(new z.a,
{name:"ScriptCount",int64:this.Qj.length})),bc.push(Object(m.a)(new z.a,{name:"ScriptErrorCount",int64:tb})),B.a(r.a.vEi,!tb,u.getElapsedMilliseconds(Ha,y.a.Wa.Nb),bc),this.Qj.sort(),gb.NN(w.a.lCc))}DGd(gb){this.qwb=!0;gb.NN("CachedScripts")}}Object(t.a)(Ab,"AutomateCommandStorage",Pb,[]);var nb=a(696);class va extends b.a{constructor(gb){super();this.$=gb;this.Fb()}create(){const gb=Sa.GetServiceTaskFactory.Ra(this.$.da,349,350,this.hb),Ha=J.a.loadScript(133,4,this.hb,void 0,void 0,351),tb=Sa.GetServiceTaskFactory.create(this.$.da,
102,this.$.la,this.hb),bc=Sa.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.hb),tc=Sa.GetServiceTaskFactory.Ra(this.$.da,5,4,this.hb);f.TaskExtensions.Aa(f.TaskExtensions.Wd([gb,Ha,tb,bc,tc],this.la,3),()=>{const Ma=gb.result,Tb=bc.result;var zb=tc.result;const ic=new ya,Qb=new A(this.$,Ma,ic),wb=new Ab(this.$,Tb),hc=new aa(this.$,wb),Za=new Ob(this.$,Qb,ic,zb);da.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")?(zb=Object(nb.b)(this.$.da,352,()=>new Ua(this.$,
Ma,tb.result,Tb,Za,ic,Qb,wb,hc)),this.qb(zb)):this.qb(this.$.da.za(352)||new Ua(this.$,Ma,tb.result,Tb,Za,ic,Qb,wb,hc))},this.la,3)}static ka(gb){gb&&gb.da.Ga(351,new va(gb))}}Object(t.a)(va,"AutomateCommandManagerFactory",b.a,[]);var db=a(10);a.d(C,"a",function(){return Xa});const Xa=()=>{db.a.Fa(gb=>{l.ka(gb);va.ka(gb)})}},1180:function(t,C,a){t=a(0);var c=a(15),b=a(83),d;(function(S){S[S.generalException=0]="generalException";S[S.invalidArgument=1]="invalidArgument";S[S.notAllowed=2]="notAllowed";
S[S.apiNotAvailable=3]="apiNotAvailable";S[S.unresolvedPendingRequest=4]="unresolvedPendingRequest";S[S.timeout=5]="timeout";S[S.adalTimeout=6]="adalTimeout";S[S.userNotSignedIn=7]="userNotSignedIn";S[S.userAborted=8]="userAborted";S[S.silentSignInFailed=9]="silentSignInFailed";S[S.invalidResourceUrl=10]="invalidResourceUrl";S[S.invalidGrant=11]="invalidGrant";S[S.connectionLost=12]="connectionLost";S[S.clientError=13]="clientError";S[S.serverError=14]="serverError"})(d||(d={}));Object(t.b)("ErrorCodes",
d);a(1292);class f{constructor(S,H){this.requestCallback=this.requestParameters=null;this.requestParameters=S;this.requestCallback=H}}Object(t.a)(f,"OutstandingRequest",null,[]);class e{}e.GCi="AADSTS50058";e.invalidResourceUrl="AADSTS50001";e.BCi="AADSTS65001";e.QCi="AADSTS70011";e.userAborted="13002";e.PYi="Popup Window is null";e.OYi="Popup Window closed";e.adalTimeout="Token renewal operation failed due to timeout";e.nKj="tokenRevoked";Object(t.a)(e,"WopiHostErrorType",null,[]);var k=a(4),l=a(728),
m=a(569),v=a(41),n=a(1291);class w{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(t.a)(w,"WopiIdentityInfo",null,[218]);class r{constructor(S,H,D){this.expiration=this.authority=this.accessToken=null;this.accessToken=S;this.authority=H;this.expiration=D}}Object(t.a)(r,"WopiIdentityToken",null,[217]);var u=a(27),y=a(146),x=a(370),B=a(163),z=a(69),A=a(339);class I{constructor(S){this._initialized=!1;this.Y9a={};this.Nxc={};this.kO=
k.AFrameworkApplication.ta.MD;this.Sid=S}A1a(S){this._initialized||(S.eo(B.a.SGf),S.Tl(B.a.SGf,Object(b.a)(this,this.tPi,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(S,H,D=null){this.hNa(S,H);return new Promise((J,M)=>{if(this.old(H))if(H in this.Y9a)M("unresolvedPendingRequest");else{var G=window.setTimeout(()=>{c.ULS.sendTraceTag(37856032,344,10,v.c({["error"]:"Request timeout.",["callerId"]:H}));M("timeout")},12E4);this.ubd(S,H,D,(T,K)=>{window.clearTimeout(G);T?J(T):(c.ULS.sendTraceTag(37856033,
369,15,v.c({["error"]:d[K]})),M(K))})}else c.ULS.sendTraceTag(37856034,344,10,v.c({["error"]:"Caller is not allowed."})),M("notAllowed")})}getPrimaryIdentityInfo(S){return new Promise((H,D)=>{this.old(S)?this.BTh((J,M)=>{J?H(J):(c.ULS.sendTraceTag(37856064,369,10,v.c({["error"]:M.toString()})),D(M))}):(c.ULS.sendTraceTag(37856065,344,10,v.c({["error"]:"Caller is not allowed."})),D("notAllowed"))})}getAuthContext(S){return new Promise((H,D)=>{const J=this.getAuthContextSync(S);J?H(J):D("notAllowed")})}getAuthContextSync(S){if(this.old(S)){const H=
new n.a;H.upn=k.AFrameworkApplication.fa.Va("UserPrincipalName");H.userId=k.AFrameworkApplication.fa.Va("LoggableUserId");H.authority=k.AFrameworkApplication.fa.Va("HostAuthAuthority");H.tenantId=k.AFrameworkApplication.fa.Va("TenantId");H.isAnonymous=k.AFrameworkApplication.fa.qa("IsAnonymousUser");H.supportsAuthToken=this.r6h(S);S=k.AFrameworkApplication.fa.Va("HostAuthType");H.authorityType="aad"===S.toLowerCase()?2:"msa"===S.toLowerCase()?1:0;return H}c.ULS.sendTraceTag(40751647,344,10,v.c({["error"]:"Caller is not allowed."}));
return null}r6h(S){const H=l.a.Vwb;return u.a.Lwa?H&&l.a.b8f?Array.contains(l.a.b8f,S.toLowerCase()):!1:H}ubd(S,H,D,J){var M=[];Array.add(M,Object.assign(new z.a,{name:"CallerId",string:H}));Array.add(M,Object.assign(new z.a,{name:x.a.ySd,string:S.correlationId}));y.a.sendTelemetryEvent(Object.assign(new A.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:M}));M=m.a.create().toString();const G="getAccessToken_"+M,T=this.kO.Bc("ComponentAttach",G);this.Nxc[G]=T;const K=
{};K[x.a.zSd]=M;K[x.a.EDj]=S.resource;K[x.a.FDj]=S.scope;K[x.a.W4f]=k.AFrameworkApplication.fa.Va("HostAuthType");K[x.a.IDj]=k.AFrameworkApplication.fa.Va("UserPrincipalName");K[x.a.GDj]=S.silentLogin;K[x.a.BDj]=S.options;K[x.a.ySd]=S.correlationId;K[x.a.CDj]=H;D&&(K[x.a.addinName]=D.AddinName,K[x.a.ADj]=D.AddinTrustId);this.Sid.execute(L=>{this.A1a(L);L.Fj(B.a.getAuthToken,K)});this.Y9a[M]=new f(S,J)}BTh(S){const H=k.AFrameworkApplication.fa.Va("UserName"),D=k.AFrameworkApplication.fa.Va("UserPrincipalName"),
J=k.AFrameworkApplication.fa.Va("LoggableUserIdSpace"),M=new w;M.email=D;M.displayName=H;switch(J){case "OrgIdPuid":M.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":M.authority="MicrosoftAccount";break;default:M.authority=J}S(M,null)}tPi(S){let H=null;try{let J=S.Values[x.a.zSd];const M=S.Values[x.a.zDj],G=S.Values[x.a.W4f],T=S.Values[x.a.HDj];let K=null,L=null;const V=this.Y9a[J];if("undefined"!==typeof V&&V){var D=[];Array.add(D,Object.assign(new z.a,{name:x.a.ySd,string:V.requestParameters.correlationId}));
y.a.sendTelemetryEvent(Object.assign(new A.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:D}));H=V.requestCallback;delete this.Y9a[J];"undefined"!==typeof M&&M&&M.length?L=new r(M,G,T):K=d[this.Kxi(S)];D="getAccessToken_"+J;D in this.Nxc&&(this.Nxc[D].stop(),delete this.Nxc[D]);H(L,K)}else c.ULS.sendTraceTag(37856066,344,10,v.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:J}))}catch(J){S=S.Values[x.a.zSd],S in this.Y9a&&delete this.Y9a[S],
this.Qic(),c.ULS.sendTraceTag(37856067,344,10,v.c({["error"]:J.message,["stack"]:J.stack})),H&&H(null,"generalException")}}old(S){var H=k.AFrameworkApplication.A_h();S=S.toLowerCase();for(const D of H)if(S===D.toLowerCase())return!0;H=l.a.iVc;for(let D in H)if(S===H[D].toLowerCase())return!0;return!1}Kxi(S){S=S.Values[x.a.DDj];this.Qic();c.ULS.sendTraceTag(39068821,344,15,v.c({["error"]:S}));return S?-1<S.indexOf(e.GCi)?9:-1<S.indexOf(e.PYi)||-1<S.indexOf(e.OYi)?12:-1<S.indexOf(e.invalidResourceUrl)?
10:-1<S.indexOf(e.userAborted)?8:-1<S.indexOf(e.QCi)||-1<S.indexOf(e.BCi)||S===e.nKj?11:-1<S.indexOf(e.adalTimeout)?6:0:13}hNa(S,H){S=this.n6i(S.resource);c.ULS.sendTraceTag(39921882,344,50,v.c({["callerId"]:H,["resource"]:S}))}Qic(){c.ULS.sendTraceTag(39068822,344,50,v.c({["userAgent"]:window.navigator.userAgent}))}n6i(S){return(S?S:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(t.a)(I,"WopiIdentityManager",null,[200]);var F=a(246);class U{constructor(){this.fb=
null}get name(){return"Common.App.WopiIdentity"}Rh(S){this.fb=S;S.register(I,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").tc().Fc(()=>new I(S.Wb("Postmessage.IHostPostmessenger")))}init(){k.AFrameworkApplication.fa&&k.AFrameworkApplication.fa.gv(Object(b.a)(this,this.pB,"onFullAppSettingsReady"))}pB(){try{this.fb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(S){c.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+
S)}}dispose(){}static main(){F.a.instance.yi(new U)}}Object(t.a)(U,"WopiIdentityPackage",null,[4,5]);a.d(C,"a",function(){return X});const X=()=>{Type.registerNamespace("Common.App.WopiIdentity");U.main()}},1185:function(t,C,a){a.r(C);t=a(0);var c=a(7),b=a(15),d=a(4),f=a(155),e=a(185),k=a(84),l=a(513),m=a(170),v=a(61),n=a(50),w=a(37),r=a(225),u=a(121),y=a(526);class x{constructor(Ba){Ba=Ba.split("|");this.$w=Ba[1];this.bQc=Ba[2];this.kTd=Ba[3]}get solutionId(){return this.$w}get solutionVersion(){return this.bQc}get needToRestoreManifest(){return this.kTd===
OSF.StoreTypeEnum.Registry.toString()}}Object(t.a)(x,"AddinStoreInfo",null,[]);class B{}Object(t.a)(B,"CustomFunctionRegistrationInfos",null,[]);var z=a(194),A=a(64);const I=(Ba,fa,Y)=>F(Ba,fa,z.a.none,A.a.current,Y),F=(Ba,fa,Y,ja,ca)=>{Y=Ba.continueWith(()=>{fa(Ba)},3,Y,ja);Y.continueWith(()=>{b.ULS.sendTraceTag(537163463,0,10,ca)},4);return Y},U=(Ba,fa,Y)=>X(Ba,fa,z.a.none,A.a.current,Y),X=(Ba,fa,Y,ja,ca)=>{Y=Ba.Uo(()=>fa(Ba),3,Y,ja);Y.continueWith(()=>{b.ULS.sendTraceTag(537163462,0,10,ca)},4);
return w.TaskExtensions.eAc(Y)},S=(Ba,fa,Y)=>H(Ba,fa,z.a.none,A.a.current,Y),H=(Ba,fa,Y,ja,ca)=>{Y=Ba.Uo(()=>fa(Ba),3,Y,ja);Y.continueWith(()=>{b.ULS.sendTraceTag(537163461,0,10,ca)},4);return Y},D=(Ba,fa,Y)=>J(Ba,fa,z.a.none,A.a.current,Y),J=(Ba,fa,Y,ja,ca)=>{Y=Ba.Uo(()=>fa(Ba),3,Y,ja);Y.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,ca)},4);return w.TaskExtensions.eAc(Y)},M=(Ba,fa,Y)=>G(Ba,fa,z.a.none,A.a.current,Y),G=(Ba,fa,Y,ja,ca)=>{Y=Ba.continueWith(()=>{fa(Ba)},3,Y,ja);Y.continueWith(()=>
{b.ULS.sendTraceTag(537163459,0,10,ca)},4);return Y},T=(Ba,fa)=>{S(a(1185).CustomFunctionsInstaller.sZe("CustomFunctionsRuntimeLogging"),Y=>{if(Y.result&&window.console)switch(Y=K(Ba.severity)+" "+Ba.message+fa,Ba.severity){case 2:window.console.log&&window.console.log(Y);break;case 0:window.console.info&&window.console.info(Y);break;case 1:window.console.error&&window.console.error(Y)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},K=Ba=>
{switch(Ba){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};var L=a(961);class V{}Object(t.a)(V,"InstallationInfo",null,[]);class W{}Object(t.a)(W,"UninstallationInfo",null,[]);var da=a(28),qa=a(90),O=a(35),ea=a(29),R=a(1),oa=a(22),pa=a(280),Pa=a(781),Z=a(55);class Ra{constructor(Ba,fa){this.yPc=Ba;this._message=fa}get severity(){return this.yPc}get message(){return this._message}}Object(t.a)(Ra,"CustomFunctionLog",null,[]);a.d(C,"CustomFunctionsInstaller",
function(){return Ga});class Ga{constructor(Ba,fa,Y){this.qwa=!1;this.nF={};this.$=Ba;this.pj=fa;this.Okd().Dma();this.indexedDB=Y;this.indexedDB.If()&&(this.qwa=!0,this.indexedDB.initialize(Ga.Tjd,Ga.Ujd))}get PU(){return this.pj.PU}o$e(Ba,fa,Y,ja){if(ja.invariantNamespace)for(let ca=0;ca<ja.invariantNamespace.length;++ca){const aa=ja.invariantNamespace.charAt(ca);if("."!==aa&&"_"!==aa&&"a">aa&&"z"<aa&&"A">aa&&"Z"<aa&&"0">aa&&"9"<aa)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${aa}', Position=${ca}.`),
Error.create("InvariantNamespace validation failed");}return U(this.GSg(Y,ja.manifest),()=>U(this.SFd(Ba),ca=>{let aa=ca.result;return(null===aa||void 0===aa?0:aa.isDynamicMetadata)?this.WGd(Ba,fa,aa,!1,!1,!1):U(this.MXj(Ba,fa,ja),ta=>{let xa;aa=(xa=new V,xa.addinId=Y,xa.locale=ja.locale,xa.addinInvariantNamespace=ja.invariantNamespace,xa.addinNamespace=ja.namespace,xa.addinTitle=ja.title,xa.isXllCompatible=ja.isXllCompatible,xa.metadataContent=JSON.stringify(JSON.parse(ta.result)),xa);return this.WGd(Ba,
fa,aa,!1,Ga.xxh(ja.osfControl.getStoreType()),L.a(this.$,ja))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}q$e(Ba,fa,Y,ja){if(!Ga.mqd(Y))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");
return U(this.SFd(Ba),ca=>{ca=ca.result;if(!ca&&(ca=O.a.Dc(this.PU,Ba),!ca))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ba,fa,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");ca.metadataContent=JSON.stringify(JSON.parse(Y));ca.isDynamicMetadata=!0;return this.WGd(Ba,fa,ca,!0,!0,ja)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}Qag(Ba,
fa){this.pj.Yha();const Y=Object(c.a)(new W,{solutionId:Ba}),ja=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ba,fa,null)}.`;return U(this.HHd(Ba),()=>U(this.OHd(Ba),()=>this.VWd(this.pj,Ba,fa,Y),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),ja)}MXj(Ba,fa,Y){const ja=new f.a;OSF.OUtil.xhrGet(Y.metadataUrl,ca=>{ca?ja.setResult(ca):ja.setException(Error.create("Invalid manifest"))},
ca=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ba,fa,null)}. ErrorCode: ${ca}.`);ja.setException(Error.create("Failed to download manifest"))});return ja.task}Okd(){return U(this.fqc(),Ba=>{const fa=Ba.result;if(!fa.length)return Z.Task.Ta(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");
Ba=new e.a;const Y=[];for(let ja=0;ja<fa.length;ja++){const ca=Object(k.a)(String,fa[ja]);Ba.add(S(this.SFd(ca),aa=>{if(aa=aa.result){const ta=O.a.Dc(this.nF,aa.addinId);ta&&ta===aa.metadataContent||(this.nF[aa.addinId]=aa.metadataContent,this.PU[ca]=aa,Y.push(aa))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return D(Z.Task.WhenAllEnumerable(Ba),()=>{if(Y.length){let ja;const ca=(ja=new B,ja.registrationInfos=Y,ja);return this.o_b(this.pj,
fa,ca)}b.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return Z.Task.Ta(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")}r$e(){var Ba=new f.a;new e.a;const fa=[],Y=[];Object.keys(this.PU).forEach(ja=>{ja=Object(k.a)(String,ja);const ca=O.a.Dc(this.PU,ja);fa.push(ca);Y.push(ja)});if(!Y.length)return Ba.setResult(!0),
Ba.task;Ba=Object(c.a)(new B,{registrationInfos:fa});return this.o_b(this.pj,Y,Ba)}fqc(){return S(this.Tdd(y.a.oYa),Ba=>{Ba=Ba.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(Ba||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(Ba||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}Cgg(Ba){return this.dOd(y.a.oYa,Sys.Serialization.JavaScriptSerializer.serialize(Ba))}SFd(Ba){return U(this.Tdd(y.a.D3a(Ba)),
fa=>{fa=fa.result||"";return 0<fa.length?Z.Task.Ta(Sys.Serialization.JavaScriptSerializer.deserialize(fa,!0)):Z.Task.Ta(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}EXj(Ba,fa){return U(this.pKe(Ba),()=>U(this.dOd(y.a.D3a(Ba),Sys.Serialization.JavaScriptSerializer.serialize(fa)),()=>Ga.eOd(y.a.Bhd,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}HHd(Ba){return U(this.iOf(Ba),
()=>U(this.BOf(y.a.D3a(Ba)),()=>U(this.fqc(),fa=>fa.result.length?Z.Task.Ta(!0):Ga.eOd(y.a.Bhd,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}zLf(Ba){return this.Tdd(y.a.C3a(Ba))}zgg(Ba,fa){return U(this.pKe(Ba),
()=>this.dOd(y.a.C3a(Ba),fa),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}OHd(Ba){return U(this.iOf(Ba),()=>this.BOf(y.a.C3a(Ba)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}pKe(Ba){return U(this.fqc(),fa=>{fa=fa.result;const Y=Ba.toLowerCase();if(fa.includes(Y))return Z.Task.Ta(!0);fa.push(Y);return this.Cgg(fa)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}iOf(Ba){return U(this.fqc(),
fa=>{fa=fa.result;const Y=Ba.toLowerCase();return fa.includes(Y)?(fa.splice(Array.indexOf(fa,Y),1),this.Cgg(fa)):Z.Task.Ta(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}GSg(Ba,fa){if(R.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return Ba=new OSF.AddinIdInfo(Ba),Ba.needToRestoreManifest()?this.zgg(Ba.getSolutionId(),fa):Z.Task.Ta(!0);Ba=new x(Ba);return Ba.needToRestoreManifest?this.zgg(Ba.solutionId,
fa):Z.Task.Ta(!0)}Ggj(Ba){if(R.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const Y=new OSF.AddinIdInfo(Ba);return Y.needToRestoreManifest()?S(this.zLf(Y.getSolutionId()),ja=>{(ja=ja.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Y.getSolutionId(),Y.getSolutionVersion(),ja,this.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):Z.Task.Ta(!0)}const fa=new x(Ba);return fa.needToRestoreManifest?
S(this.zLf(fa.solutionId),Y=>{(Y=Y.result)&&OSF.OsfManifestManager.cacheManifestFromXml(fa.solutionId,fa.solutionVersion,Y,this.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):Z.Task.Ta(!0)}BOf(Ba){return this.qwa?this.indexedDB.X4c(Ba):Ga.Z9i(Ba)}dOd(Ba,fa){return this.qwa?this.indexedDB.Nbb(new Pa.a(Ba,fa)):Ga.eOd(Ba,fa)}Tdd(Ba){return this.qwa?this.indexedDB.x3a(Ba):Ga.sZe(Ba)}WGd(Ba,fa,Y,ja,ca,aa){const ta=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ba,
fa,null)}.`;return w.TaskExtensions.eAc(S(this.XGd(this.pj,Ba,fa,Y,!1,ja,aa),()=>ca?this.EXj(Ba,Y):Z.Task.Ta(!0),ta))}XGd(Ba,fa,Y,ja,ca,aa,ta){if(!aa&&(aa=O.a.Dc(this.nF,ja.addinId))&&aa===ja.metadataContent)return Z.Task.Ta(!0);this.nF[ja.addinId]=ja.metadataContent;this.PU[fa]=ja;ta||Ba.rHb(fa);Ba.Yha();return U(this.v7i(fa,Y,ja),()=>this.AEd(ja.addinId,ca),"Failed to register functions for customfunction addin")}v7i(Ba,fa,Y){const ja=new f.a,ca=this.xob(Y);return this.gia(aa=>{R.EwaSettings.ma(256)&&
T(Ga.jrb,Ba);(aa=aa.Result)&&204===aa.ResponseStatusCode?ja.setResult(!0):(delete this.nF[Y.addinId],delete this.PU[Ba],I(this.HHd(Ba),()=>{I(this.OHd(Ba),()=>{this.y2f()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${Ba}. Received status code ${aa?aa.ResponseStatusCode.toString():"Unknown"}.`),ja.setResult(!1))},aa=>{aa=u.a.lf(aa.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ba,
fa,null)}. Errors: ${ea.a.yc(aa)}.`);R.EwaSettings.ma(256)&&T(Ga.irb,Ba);delete this.nF[Y.addinId];delete this.PU[Ba];ja.setResult(!1)},ca,ja,!0)}o_b(Ba,fa,Y){const ja=new f.a,ca=da.a.Wa.je.m;fa.forEach(ta=>{ta=Object(k.a)(String,ta);Ba.Kwe(ta)});Ba.Yha();const aa=this.xXc(Y);return this.gia(ta=>{R.EwaSettings.ma(256)&&T(Ga.jrb,Sys.Serialization.JavaScriptSerializer.serialize(fa));ta=ta.Result;let xa=!0;var ia=Sys.Serialization.JavaScriptSerializer.deserialize(ta.ResponseBody.toString());ia=Array.isArray(ia.value)?
ia.value:null;const ya=new e.a;for(let ib=0;ib<ia.length;ib++)if(!ia[ib]){xa=!1;const wa=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${ta.ResponseStatusCode}.`;ya.add(U(this.HHd(fa[ib]),()=>{delete this.nF[Y.registrationInfos[ib].addinId];delete this.PU[fa[ib]];return this.OHd(fa[ib])},wa))}M(Z.Task.WhenAllEnumerable(ya),()=>{I(this.AEd("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${da.a.Wa.je.m-
ca} Millisecond.`);xa?ja.setResult(xa):M(this.y2f(),()=>{ja.setResult(xa)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},ta=>{ta=u.a.lf(ta.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${ea.a.yc(ta)}.`);
R.EwaSettings.ma(256)&&T(Ga.irb,Sys.Serialization.JavaScriptSerializer.serialize(fa));for(ta=0;ta<Y.registrationInfos.length;ta++)delete this.nF[Y.registrationInfos[ta].addinId],delete this.PU[fa[ta]];ja.setResult(!1)},aa,ja,!0)}VWd(Ba,fa,Y,ja){return U(this.POj(Ba,fa,Y,ja),()=>this.AEd(ja.solutionId,!1),"Failed to unregister functions for customfunction addin")}POj(Ba,fa,Y,ja){const ca=new f.a;Ba.rHb(fa);(Ba=O.a.Dc(this.PU,fa))&&delete this.nF[Ba.addinId];delete this.PU[fa];ja=this.KXc(ja);return this.gia(()=>
{R.EwaSettings.ma(256)&&T(Ga.T3c,fa);ca.setResult(!0)},aa=>{aa=u.a.lf(aa.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(fa,Y,null)}. Errors: ${ea.a.yc(aa)}.`);R.EwaSettings.ma(256)&&T(Ga.S3c,fa);ca.setResult(!1)},ja,ca,!1)}gia(Ba,fa,Y,ja,ca){const aa=this.$.userOperationManager,ta=this.$.oa;let xa=null,ia=null,ya=null;const ib=()=>{if(aa.SGa()||0<ta.va.h3||
0<ta.Pk.h3)return!1;xa&&aa.Co(xa);ia&&ta.qt(ia);ya&&ta.Oz(ya);const wa=Y.request,sa=(bb,mb,Ca)=>{R.EwaSettings.ma(256)&&T(ca?Ga.R3c:Ga.U3c,wa.RequestBody);return v.g(ta.va,"ExecuteRichApiRequest",Y,pa.b(bb,Ba),pa.a(mb,fa),Ca,null,0)};let Ya=0;R.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?wa.RequestFlags&1&&256!==(wa.RequestFlags&256)||(Ya=16):Ya=wa.RequestFlags&1?0:16;R.EwaSettings.dc()?aa.Yt(new m.a(507,0,sa,Ya|64)):aa.Yt(new l.a(507,0,sa,Ya));return!0};ib()||
(xa=()=>{ib()},ia=()=>{ib()},ya=()=>{ib()},aa.Hr(xa),ta.Ir(ia),ta.Ly(ya));return ja.task}xob(Ba){const fa={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};fa.RequestBody=JSON.stringify(Ba);fa.RequestFlags=1;R.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(fa.RequestFlags|=256);Ba=this.$.oa.va.Na(1);Ba.request=fa;return Ba}xXc(Ba){const fa={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};fa.RequestBody=
JSON.stringify(Ba);fa.RequestFlags=1;R.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(fa.RequestFlags|=256);Ba=this.$.oa.va.Na(1);Ba.request=fa;return Ba}KXc(Ba){const fa={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};fa.RequestBody=JSON.stringify(Ba);fa.RequestFlags=1;R.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(fa.RequestFlags|=256);Ba=this.$.oa.va.Na(1);Ba.request=fa;return Ba}AEd(Ba,
fa){const Y=n.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);return X(Y,()=>{Y.result.ZJd();return Ba&&fa?this.Ggj(Ba):Z.Task.Ta(!0)},this.$.la,r.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}y2f(){const Ba=new qa.a(1949669462,0,this.$.Mc,0,null);return this.$.Ka.Mb(Ba)}static sZe(Ba){try{return Z.Task.Ta(localStorage.getItem(Ba))}catch(fa){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${fa.message||
"Unknown"}`),Z.Task.Ta(null)}}static eOd(Ba,fa){try{return localStorage.setItem(Ba,fa),Z.Task.Ta(!0)}catch(Y){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${Y.message||"Unknown"}`),Z.Task.Ta(!1)}}static Z9i(Ba){try{return localStorage.removeItem(Ba),Z.Task.Ta(!0)}catch(fa){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${fa.message||
"Unknown"}`),Z.Task.Ta(!1)}}static xxh(Ba){return oa.a.equals(Ba,"registry",!0)||oa.a.equals(Ba,"uploadfiledevcatalog",!0)||d.AFrameworkApplication.userNameUnknown||d.AFrameworkApplication.limitedEdit}static mqd(Ba){if(!Ba)return!1;try{JSON.parse(Ba)}catch(fa){return!1}return!0}}Ga.Tjd="CustomFunctionCache";Ga.Ujd="CustomFunction";Ga.R3c=new Ra(2,"CustomFunctions [Registration] [Begin] SolutionId=");Ga.jrb=new Ra(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");Ga.irb=new Ra(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
Ga.U3c=new Ra(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");Ga.T3c=new Ra(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");Ga.S3c=new Ra(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(t.a)(Ga,"CustomFunctionsInstaller",null,[821])},1189:function(t,C,a){a.r(C);t=a(0);var c=a(7),b=a(15),d=a(933),f=a(155),e=a(84),k=a(513),l=a(170),m=a(61),v=a(50),n=a(37),w=a(121),r=a(526),u=a(961);class y{constructor(K){K=K.split("|");this.$w=K[1];this.bQc=K[2];
this.kTd=K[3]}get solutionId(){return this.$w}get solutionVersion(){return this.bQc}get needToRestoreManifest(){return this.kTd===OSF.StoreTypeEnum.Registry.toString()}}Object(t.a)(y,"AddinStoreInfo",null,[]);class x{}Object(t.a)(x,"CustomFunctionRegistrationInfos",null,[]);const B=(K,L)=>{if(a(1189).CustomFunctionsLegacyInstaller.bvb("CustomFunctionsRuntimeLogging")&&window.console)switch(L=z(K.severity)+" "+K.message+L,K.severity){case 2:window.console.log&&window.console.log(L);break;case 0:window.console.info&&
window.console.info(L);break;case 1:window.console.error&&window.console.error(L)}},z=K=>{switch(K){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class A{}Object(t.a)(A,"InstallationInfo",null,[]);class I{}Object(t.a)(I,"UninstallationInfo",null,[]);var F=a(152),U=a(35),X=a(29),S=a(1),H=a(14),D=a(280),J=a(860),M=a(55);class G{constructor(K,L){this.yPc=K;this._message=L}get severity(){return this.yPc}get message(){return this._message}}Object(t.a)(G,"CustomFunctionLog",
null,[]);a.d(C,"CustomFunctionsLegacyInstaller",function(){return T});class T{constructor(K){this.nF={};this.$=K;this.Okd().Dma()}o$e(K,L,V,W){const da=new f.a;if(W.invariantNamespace)for(L=0;L<W.invariantNamespace.length;++L){const O=W.invariantNamespace.charAt(L);if("."!==O&&"_"!==O&&"a">O&&"z"<O&&"A">O&&"Z"<O&&"0">O&&"9"<O)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${O}', Position=${L}.`),da.setResult(!1),
da.task}T.cacheManifest(V,W.manifest);let qa=T.TFd(K);(null===qa||void 0===qa?0:qa.isDynamicMetadata)?this.VGd(K,qa,da,!1,!1):OSF.OUtil.xhrGet(W.metadataUrl,O=>{qa=Object(c.a)(new A,{addinId:V,locale:W.locale,addinInvariantNamespace:W.invariantNamespace,addinNamespace:W.namespace,addinTitle:W.title,isXllCompatible:W.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(O))});this.VGd(K,qa,da,!1,u.a(this.$,W))},O=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${K}. ErrorCode: ${O}.`);
da.setResult(!1)});return da.task}q$e(K,L,V,W){L=new f.a;if(!T.mqd(V))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),L.setResult(!1),L.task;const da=T.TFd(K);if(!da)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),L.setResult(!1),L.task;da.metadataContent=JSON.stringify(JSON.parse(V));da.isDynamicMetadata=
!0;this.VGd(K,da,L,!0,W);return L.task}Qag(K){const L=new f.a,V=v.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);n.TaskExtensions.Aa(V,()=>{const W=V.result;W.Yha();const da=Object(c.a)(new I,{solutionId:K});T.IHd(K);T.PHd(K);n.TaskExtensions.Aa(this.VWd(W,K,da),qa=>{F.b(qa)?L.setResult(qa.result):(qa.Sf?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${K}.`):qa.Ch&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${K}.`),
L.setResult(!1))},this.$.la,0)},this.$.la,3);return L.task}Okd(){const K=new f.a,L=T.YFd();0<L.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const V=[];L.forEach(da=>{da=Object(e.a)(String,da);if(da=T.TFd(da)){const qa=U.a.Dc(this.nF,da.addinId);qa&&qa===da.metadataContent||(this.nF[da.addinId]=da.metadataContent,V.push(da))}});if(!V.length)return K.setResult(!0),b.ULS.sendTraceTag(537163521,0,
50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),K.task;const W=v.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);n.TaskExtensions.Aa(W,()=>{const da=W.result,qa=Object(c.a)(new x,{registrationInfos:V});n.TaskExtensions.Aa(this.o_b(da,L,qa),O=>{F.b(O)?K.setResult(O.result):(O.Sf?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):O.Ch&&b.ULS.sendTraceTag(537163490,
0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),K.setResult(!1))},this.$.la,0)},this.$.la,3);return K.task}Fgj(K){K=new y(K);if(K.needToRestoreManifest){const L=T.S4i(K.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(K.solutionId,K.solutionVersion,L,this.$.ya.UICultureTag)}}VGd(K,L,V,W,da){const qa=v.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);n.TaskExtensions.Aa(qa,()=>{n.TaskExtensions.Aa(this.XGd(qa.result,K,L,!1,W,da),
O=>{F.b(O)?((O=O.result)&&T.FXj(K,L),V.setResult(O)):(O.Sf?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${K}.`):O.Ch&&b.ULS.sendTraceTag(537163487,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${K}.`),V.setResult(!1))},this.$.la,0)},this.$.la,3)}XGd(K,L,V,W,da,qa){if(!da&&(da=U.a.Dc(this.nF,V.addinId))&&da===V.metadataContent)return M.Task.Ta(!0);this.nF[V.addinId]=
V.metadataContent;const O=new f.a;qa||K.rHb(L);K.Yha();K=this.xob(V);return this.gia(ea=>{S.EwaSettings.ma(256)&&B(T.jrb,L);const R=ea.Result;204===R.ResponseStatusCode?n.TaskExtensions.Aa(this.zEd(O,V.addinId,W),oa=>{oa.Sf?L?b.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${L}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${V.addinId}.`):
oa.Ch&&(L?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${L}.`):b.ULS.sendTraceTag(537163482,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${V.addinId}.`));O.setResult(!1)},this.$.la,4):(ea=()=>{delete this.nF[V.addinId];T.IHd(L);T.PHd(L);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${L}. Received status code ${R.ResponseStatusCode}.`);
O.setResult(!1)},ea=Object(c.a)(new J.a,{aLa:OSF.InfoType.Error,title:V.addinTitle,description:String.format(H.a.instance.ob(153),H.a.instance.ga(1889)),buttonText:H.a.instance.ga(4),Oga:ea,Fcc:!1,Kha:ea,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),d.a.JQd(ea))},ea=>{ea=w.a.lf(ea.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${L}. Errors: ${X.a.yc(ea)}.`);S.EwaSettings.ma(256)&&
B(T.irb,L);delete this.nF[V.addinId];O.setResult(!1)},K,O,!0)}o_b(K,L,V){const W=new f.a;L.forEach(qa=>{qa=Object(e.a)(String,qa);K.Kwe(qa)});K.Yha();const da=this.xXc(V);return this.gia(qa=>{S.EwaSettings.ma(256)&&B(T.jrb,Sys.Serialization.JavaScriptSerializer.serialize(L));qa=qa.Result;let O=!0;var ea=Sys.Serialization.JavaScriptSerializer.deserialize(qa.ResponseBody.toString());ea=Array.isArray(ea.value)?ea.value:null;for(let R=0;R<ea.length;R++)ea[R]||(O=!1,delete this.nF[V.registrationInfos[R].addinId],
T.IHd(L[R]),T.PHd(L[R]),b.ULS.sendTraceTag(537163478,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${L[R]}. Received status code ${qa.ResponseStatusCode}.`));n.TaskExtensions.Aa(this.zEd(W,"",!1),R=>{R.Sf?b.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):R.Ch&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");
W.setResult(!1)},this.$.la,4);W.setResult(O)},qa=>{qa=w.a.lf(qa.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(L)}. Errors: ${X.a.yc(qa)}.`);S.EwaSettings.ma(256)&&B(T.irb,Sys.Serialization.JavaScriptSerializer.serialize(L));for(const O of V.registrationInfos)delete this.nF[O.addinId];W.setResult(!1)},da,W,!0)}VWd(K,L,V){const W=new f.a;
K.rHb(L);K=this.KXc(V);return this.gia(()=>{S.EwaSettings.ma(256)&&B(T.T3c,L);n.TaskExtensions.Aa(this.zEd(W,V.solutionId,!1),da=>{da.Sf?L&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${L}.`):da.Ch&&L&&b.ULS.sendTraceTag(537163472,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${L}.`);W.setResult(!1)},this.$.la,4)},
da=>{da=w.a.lf(da.data);b.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${L}. Errors: ${X.a.yc(da)}.`);S.EwaSettings.ma(256)&&B(T.S3c,L);W.setResult(!1)},K,W,!1)}gia(K,L,V,W,da){const qa=this.$.userOperationManager,O=this.$.oa;let ea=null,R=null,oa=null;const pa=()=>{if(qa.SGa()||0<O.va.h3||0<O.Pk.h3)return!1;ea&&qa.Co(ea);R&&O.qt(R);oa&&O.Oz(oa);const Pa=V.request,Z=(Ga,Ba,fa)=>{S.EwaSettings.ma(256)&&
B(da?T.R3c:T.U3c,Pa.RequestBody);return m.g(O.va,"ExecuteRichApiRequest",V,D.b(Ga,K),D.a(Ba,L),fa,null,0)};let Ra=Pa.RequestFlags&1?0:16;S.EwaSettings.dc()?qa.Yt(new l.a(507,0,Z,Ra|64)):qa.Yt(new k.a(507,0,Z,Ra));return!0};pa()||(ea=()=>{pa()},R=()=>{pa()},oa=()=>{pa()},qa.Hr(ea),O.Ir(R),O.Ly(oa));return W.task}xob(K){const L={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};L.RequestBody=JSON.stringify(K);L.RequestFlags=1;K=this.$.oa.va.Na(1);K.request=L;return K}xXc(K){const L=
{HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};L.RequestBody=JSON.stringify(K);L.RequestFlags=1;K=this.$.oa.va.Na(1);K.request=L;return K}KXc(K){const L={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};L.RequestBody=JSON.stringify(K);L.RequestFlags=1;K=this.$.oa.va.Na(1);K.request=L;return K}zEd(K,L,V){const W=v.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);n.TaskExtensions.Aa(W,()=>{W.result.ZJd();L&&V&&this.Fgj(L);K.setResult(!0)},
this.$.la,3);return W}r$e(){return M.Task.Ta(!0)}static YFd(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(T.bvb(r.a.oYa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(T.bvb(r.a.oYa)||"[]"):null)||[]}static Dgg(K){T.fOd(r.a.oYa,Sys.Serialization.JavaScriptSerializer.serialize(K))}static TFd(K){K=T.bvb(r.a.D3a(K))||"";return 0<K.length?Sys.Serialization.JavaScriptSerializer.deserialize(K,!0):null}static FXj(K,L){T.oKe(K);T.fOd(r.a.D3a(K),Sys.Serialization.JavaScriptSerializer.serialize(L))}static IHd(K){T.hOf(K);
T.COf(r.a.D3a(K))}static S4i(K){return T.bvb(r.a.C3a(K))}static GXj(K,L){T.oKe(K);T.fOd(r.a.C3a(K),L)}static PHd(K){T.hOf(K);T.COf(r.a.C3a(K))}static oKe(K){const L=T.YFd();K=K.toLowerCase();L.includes(K)||(L.push(K),T.Dgg(L))}static hOf(K){const L=T.YFd();K=K.toLowerCase();L.includes(K)&&(L.splice(Array.indexOf(L,K),1),T.Dgg(L))}static cacheManifest(K,L){K=new y(K);K.needToRestoreManifest&&T.GXj(K.solutionId,L)}static bvb(K){try{return localStorage.getItem(K)}catch(L){return b.ULS.sendTraceTag(537163469,
0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${L.message||"Unknown"}`),null}}static fOd(K,L){try{localStorage.setItem(K,L)}catch(V){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${V.message||"Unknown"}`)}}static COf(K){try{localStorage.removeItem(K)}catch(L){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${L.message||
"Unknown"}`)}}static mqd(K){if(!K)return!1;try{JSON.parse(K)}catch(L){return!1}return!0}}T.R3c=new G(2,"CustomFunctions [Registration] [Begin] SolutionId=");T.jrb=new G(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");T.irb=new G(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");T.U3c=new G(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");T.T3c=new G(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");T.S3c=new G(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");
Object(t.a)(T,"CustomFunctionsLegacyInstaller",null,[821])},1227:function(t,C,a){t=a(0);var c=a(194),b=a(15);class d{}Object(t.a)(d,"AddinCommandsHost",null,[]);var f=a(1308),e=a(1385),k=a(858),l=a(61);const m=(U,X,S,H,D,J)=>{const M=U.Na(9);M.sharedInfo=X;return l.g(U,"InsertAgaveTaskpane",M,S,H,D,J,0)},v=(U,X,S,H,D,J,M=null)=>{M=U.Na(9,M);M.sharedInfo=X;return l.g(U,"ShowAgaveTaskpane",M,S,H,D,J,0)};var n=a(513),w=a(368),r=a(170),u=a(37),y=a(1),x=a(280),B=a(144);class z extends B.a{constructor(U){super();
this.ze=this.xCa="AddInCommandsDialog";this.Rb=5;this.dialogWidth=695;this.dialogHeight=438;this.f1g="100%";this.c1g="408px";this.d1g="15px";this.e1g="0";this.Jsg=U}get containerDiv(){return this.Kk}Lz(){super.Lz();this.Kk.style.width=this.f1g;this.Kk.style.height=this.c1g;this.Kk.style.marginTop=this.d1g;this.Kk.style.padding=this.e1g}BI(){super.BI();this.vb.style.width=String.format("{0}px",this.dialogWidth);this.vb.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();
this.Jsg()}}Object(t.a)(z,"AddInCommandsDialog",B.a,[]);var A=a(55),I=a(64);B=a(99);a.d(C,"a",function(){return F});class F extends d{constructor(U,X,S,H=null,D=null){super();this.$=U;this.oe=X;this.ownerAddinInfo=S;this.Jd=D;this.kQa=H||A.Task.Ta(!0)}Y0g(){const U=this.kQa;this.kQa=A.Task.Ta(!0);return U}disposeHost(U){this.oe.MPa(U)}setOwnerAddinEToken(U){this.ownerAddinInfo.eToken=U}showTaskpane(U,X,S){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let H=null,D=!1,J=(new f.a("m_excelWebRenderer_ewaCtl_",
this.ownerAddinInfo.solutionId,new k.a,!0)).MEe(U.solutionId.substr(this.ownerAddinInfo.solutionId.length));H=X.getSharedRuntimeForTaskpane("Workbook",J);D=!!H&&1===H.LifeTime;this.oe.Nwe(D?this.ownerAddinInfo.solutionId:U.solutionId,D?H:null,null)||(this.Tlf(D,!0),this.kQa=this.Mkd(U,H,(M,G)=>{M?(D&&(M.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,M.SharedRuntime=H),M.WebExtensionOsfControlType=3,this.oe.jHa(M),S(M.InstanceId,G),this.Tlf(D,!1),y.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&
b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),S(null,G))}))}getSettings(U,X){let S=this.oe.S$(U.solutionId);S?X(this.oe.BY(S).OsfPropertyBag):this.kQa=this.Mkd(U,null,H=>{H?X(H.OsfPropertyBag):b.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})}showDialog(U,X,S){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const H=this.$.oa.va,D=M=>{const G=M.Result,T=G?G.AgaveData:
null;T?(this.oe.IDe(T,()=>{const K=new z(()=>{this.disposeHost(T.InstanceId)});K.initializeAndShow("",null,null);return K.containerDiv}),S(T.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),S(null,M.Errors?M.Errors[0].ErrorCause:5001))},J=F.Qqb(U,this.ownerAddinInfo);U=(M,G,T)=>m(H,J,x.b(M,D),G,T,null);y.EwaSettings.dc()?this.kQa=w.a(this.$.userOperationManager,U,M=>new r.a(500,0,M,64),this.Jd):this.kQa=w.a(this.$.userOperationManager,U,M=>new n.a(500,0,M),this.Jd)}createUILessSandbox(U,
X,S){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");const H=X.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),D=!!H&&1===H.LifeTime;(X=this.oe.eAh(D?this.ownerAddinInfo.solutionId:U.solutionId,D?H:null))?S(X,0):this.kQa=this.Mkd(U,H,(J,M)=>{J?(D?(J.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,J.SharedRuntime=H,J.TaskpaneVisible=!1,J.WebExtensionOsfControlType=3,this.oe.jHa(J)):(J.WebExtensionOsfControlType=4,this.oe.IDe(J,()=>{F.xeb.ia(J.InstanceId,new e.a);return F.xeb.na(J.InstanceId).kta})),
S(J.InstanceId,M)):(b.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),S(null,M))})}Mkd(U,X,S){let H=null;const D=this.$.oa.va,J=L=>{const V=L.Result;(H=V?V.AgaveData:null)||S(null,L.Errors?L.Errors[0].ErrorCause:5001)},M=F.Qqb(U,this.ownerAddinInfo);X&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),M.SharedRuntimeId=X.Resid);let G=500;var T=(L,V,W)=>m(D,M,x.b(L,J),V,W,null);let K=0;void 0===M.IsToBePersisted||null===M.IsToBePersisted||M.IsToBePersisted||
(G=538,T=(L,V,W)=>{b.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,null,null,this.ownerAddinInfo.storeId));return v(D,M,x.b(L,J),V,W,null)},K=16);y.EwaSettings.dc()?(K|=64,T=w.a(this.$.userOperationManager,T,L=>new r.a(G,0,L,K),this.Jd)):T=w.a(this.$.userOperationManager,T,L=>new n.a(G,0,L,K),
this.Jd);return u.TaskExtensions.ts(T,()=>H?this.Asd(D,H.InstanceId,(L,V)=>{if(L){X||(H.PrimaryMarketplace.MarketplaceType=U.storeType);H.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;H.OwnerAddinStoreType=this.ownerAddinInfo.storeType;H.OsfPropertyBag=[];for(V=0;V<L.Settings.length;V++){const W=[];W[0]=L.Settings[V].Name;W[1]=L.Settings[V].Value;H.OsfPropertyBag[V]=W}S(H,0)}else S(null,V.Errors?V.Errors[0].ErrorCause:5001)}):A.Task.Ta(!1),c.a.none,3,I.a.current)}Asd(U,X,S){const H=J=>{S(J.Result,
J)},D=(J,M,G)=>{J=x.b(J,H);const T=U.Na(1);T.controlId=X;return l.g(U,"DdaLoadSettings",T,J,M,G,null,0)};return y.EwaSettings.dc()?w.a(this.$.userOperationManager,D,J=>new r.a(501,0,J,80),this.Jd):w.a(this.$.userOperationManager,D,J=>new n.a(501,0,J,16),this.Jd)}Tlf(U,X){var S;U&&(null===(S=window.performance)||void 0===S?0:S.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${X}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(U){F.xeb.mb(U)&&
F.xeb.na(U).initializeAndShowWithTitle()}static hideUILessDialog(U){F.xeb.mb(U)&&F.xeb.na(U).hide()}static Qqb(U,X){const S={};S.SolutionId=U.solutionId;S.Version=U.version;S.StoreType=X.storeType;S.StoreId=U.storeId;S.AssetId=U.solutionId;S.AssetStoreId="omex";S.TargetType=1;S.Width=350;S.OwnerAddinSolutionId=X.solutionId;S.OwnerAddinStoreType=X.storeType;S.SharedRuntimeId=null;S.Preload=!1;return S}}F.xeb=new B.a;Object(t.a)(F,"WACExcelAddinCommandsHost",d,[])},1233:function(t,C,a){var c=a(10);
t=a(0);var b=a(691),d=a(15),f=a(103),e=a(4),k=a(1299),l=a(1),m=a(182),v=a(55);class n{constructor(x,B,z){this.mrb=null;this.$=x;B?(d.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.mrb=new k.a(x,B,z)):d.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}Nc(){return!1}executeCommand(x,B,z){x=!1;switch(B.command){case 73979048:this.mrb&&
this.mrb.TZi(B,f.a.instance,e.AFrameworkApplication.fa,z),x=!0}return x?v.Task.Ta(!0):m.a(B.command)}Cc(x,B){return 73979048===B.command&&l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)}Rc(){return!1}dispose(){this.mrb&&this.mrb.dispose()}}Object(t.a)(n,"DataFromPictureCommandHandler",null,[195,2]);var w=a(37),r=a(50);class u extends b.a{constructor(x){super(x)}yd(){const x=r.GetServiceTaskFactory.Ra(this.$.da,328,327,1),B=r.GetServiceTaskFactory.Ra(this.$.da,
484,485,1);w.TaskExtensions.Aa(w.TaskExtensions.Wd([x,B],this.$.la),()=>{this.gd([new n(this.$,x.result,B.result)])},this.$.la,3)}static ka(x){b.a.Nd(452,new u(x))}}Object(t.a)(u,"DataFromPictureCommandHandlerFactory",b.a,[]);a.d(C,"a",function(){return y});const y=()=>{c.a.Fa(x=>{u.ka(x)})}},1291:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=
this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static BHh(b){switch(b){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(t.a)(c,"WopiAuthContext",null,[342])},1292:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.VDf="OneDriveWOPI";Object(t.a)(c,"HostApplicationType",null,[])},1293:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b,d,f,e){this._id=b;
this.lwg=d;this.tge=f;this.SBa=e}getId(){return this._id}getStoreId(){return this.lwg}getStoreType(){return this.tge}}Object(t.a)(c,"ExtensionIdentity",null,[135])},1294:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b,d,f){this.p$d=f}}Object(t.a)(c,"HostProperties",null,[])},1295:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(){this.optionalProperties={};this.Kp={}}}Object(t.a)(c,"ExtensionLaunchProperties",null,[])},1296:function(t,C,a){a.d(C,
"a",function(){return v});t=a(0);var c=a(1293),b=a(1295),d=a(959),f=a(1298),e=a(1294),k=a(4),l=a(569),m=a(25);class v{constructor(){this.La=k.AFrameworkApplication.wb}NMa(n,w,r,u,y){this.iqi(n,w,r,u,y)}iqi(n,w,r,u,y){const {ExtensionComponentInstance:x}=a(1297),B={};B[d.a.Wsb]=n;B[d.a.Xze]=w;B[d.a.nha]=r;B[d.a.Tid]=u;B[d.a.Kla]=y;u=8;if(k.AFrameworkApplication.kpd(n.getId()))switch(w){case f.a.action:u=this.La.de(m.a.SPe,2,B);break;case f.a.taskpane:u=this.La.de(m.a.H2f,2,B);break;case f.a.sdxDialog:u=
this.La.de(m.a.qic,2,B);break;default:u=16}32===u?(u=l.a.create().toString(),y.optionalProperties.InstanceToken&&(u=y.optionalProperties.InstanceToken),n=new x(n,w,r,u),v.Jv[u]=n):n=new x(n,w,r,null);n.Mnj(B)}hqi(n){var w=n.ExtId;const r=n.ComponentType,u=n.ComponentId;var y=n.HostProps;n=n.OptionalProps;w=new c.a(w.Id,w.StoreId,w.StoreType,w.AppVersion);y=new e.a(y.HostType,y.FormFactor,y.Locale);const x=new b.a;x.optionalProperties=n.OptionalProperties;x.Kp=n.DevProperties;v.instance.NMa(w,r,u,
y,x)}getInstance(n){return v.Jv[n]}V9i(n){delete v.Jv[n]}static get instance(){v.QGc||(v.QGc=new v);return v.QGc}}v.QGc=null;v.Jv={};Object(t.a)(v,"ExtensionLifeCycleManager",null,[118])},1297:function(t,C,a){a.r(C);a.d(C,"ExtensionComponentInstance",function(){return f});t=a(0);var c=a(1296),b=a(4),d=a(25);class f{constructor(e,k,l,m){this.SBa=this.rG=null;this._id=e;this.tmg=l;this.fqg=m;this.La=b.AFrameworkApplication.wb?b.AFrameworkApplication.wb:null}kcd(){return this.tmg}get appVersion(){return this.SBa}Mnj(e){this.rG=
e}stop(){const e=this.La.de(d.a.DYg,2,this.rG);c.a.instance.V9i(this.fqg);return 32===e}Isc(){this.La.de(d.a.aTf,2,this.rG)}}Object(t.a)(f,"ExtensionComponentInstance",null,[136])},1298:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.taskpane="Taskpane";c.action="Action";c.sdxDialog="SDXDialog";Object(t.a)(c,"ComponentTypeNames",null,[])},1299:function(t,C,a){(function(c){a.d(C,"a",function(){return A});var b=a(0),d=a(15),f=a(172),e=a(84),k=a(1305),l=a(38),m=a(248),v=a(43),n=a(368),
w=a(170),r=a(61),u=a(90),y=a(14),x=a(21),B=a(41),z=a(1306);class A extends l.a{constructor(I,F,U){super();this.E8e=k.a.getTypeName();this.dxb=this.yT=this.Jd=null;this.imageHeight=this.imageWidth=0;this.YKa=this.errorMessage=this.tableData=null;this.bjd=0;this.eSc=!1;this.SEe=X=>{if(X){var S={};if(({Ut:S}=B.d(this.Bbh(X.data))).returnValue&&(X=Object(e.a)(Object,S),"."===X.DataFromPictureWildcard))if(X.SessionId!==this.YKa)d.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");
else switch(d.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),X.CmdType){case "ACK":this.eSc=!0;this.W7f.stop();d.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");this.nmj();0<this.errorMessage.length?this.RWf():0<this.tableData.length&&this.iXf();break;case "insert_html":const D=this.$.oa.va;S={};var H=x.g(this.$).ha.sa.Wc.clone();S.PasteId=
f.a.create().toString();S.DestinationRanges=v.s(v.v(H,this.$));H=X.Parameters.split("|",3);d.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${H[0]}|${H[1]}|${H[2]}.`);H=X.Parameters.indexOf("|");H=X.Parameters.indexOf("|",H+1);H=X.Parameters.indexOf("|",H+1);S.SourceHtml=X.Parameters.substring(H+1);S.CopyOperationId=null;const J=D.Na(1,D.Sb());J.pasteHtmlParameters=S;n.a(this.$.userOperationManager,(M,G,T)=>r.g(D,"pasteHtmlContent",J,M,G,T,
null,64),M=>new w.a(204,0,M,1),null);this.bjd++;d.ULS.sendTraceTag(523805135,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.bjd.toString()}`)}}};this.p7h=(X,S)=>{if(X=S.rJ)if(!S.parentPath||1>=S.parentPath.length||S.parentPath[1]!==this.YKa)d.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{d.ULS.sendTraceTag(523805123,
0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");S=X.errorCode;switch(S){case null:case -1:this.errorMessage=y.a.instance.ga(2270);break;case 1:this.errorMessage=y.a.instance.ga(2271);break;case 2:this.errorMessage=y.a.instance.ga(2272)}0<this.errorMessage.length&&d.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${S?S.toString():"null"}.`);this.Moe.stop();this.tableData=X.html;this.eSc&&(0<this.errorMessage.length?
this.RWf():0<this.tableData.length&&this.iXf())}else d.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=I;this.augmentationLoopManager=F;this.uploaderCreator=U;this.initialize()}dispose(){window.removeEventListener("message",this.SEe,!1);super.dispose()}JRi(I,F){d.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let U=new Image;U.onload=()=>{var X=document.createElement("canvas");
X.width=U.width;X.height=U.height;const S=X.getContext("2d");try{S.drawImage(U,0,0,U.width,U.height)}catch(J){d.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${J.message}`);return}let H;try{H=X.toDataURL("image/jpeg")}catch(J){d.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${J.message}`);return}X=H.split(",");if(2>X.length)d.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");
else{X=X[1];try{var D=window.self.atob(X)}catch(J){d.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${J.message}`);return}28E5<D.length?(d.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),F.qzj()):(this.sij(this.Jd,this.yT,X,U.width,U.height),URL.revokeObjectURL(U.src),U=null,d.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};
U.src=I}TZi(I,F,U,X){this.Jd=I;this.yT=X;this.uploaderCreator.X9h(this.$,F,U,X,this)}sij(I,F,U,X,S){this.YKa=f.a.create().toString();this.bjd=0;this.dxb=U;this.imageWidth=X;this.imageHeight=S;this.errorMessage=this.tableData="";this.eSc=!1;this.W7f=this.$.Ib.Og("LoadResource","DataFromPictureTaskpaneLaunch");this.W7f.start();this.pUi(I,F);this.Moe=this.$.Ib.Og("LoadResource","DataFromPictureAnnotation");this.Moe.start();this.XTj()}XTj(){if(this.dxb.length){var I=window.self.atob(this.dxb);var F=new Uint8Array(I.length);
for(let U=0;U<I.length;U++)F[U]=I.charCodeAt(U);this.augmentationLoopManager.WTj(F,this.YKa,this.imageWidth,this.imageHeight)}else d.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}pUi(I,F){F.SessionID=this.YKa;F.DataFromPictureAssetId="FA000000050";F.LoadDataFromPictureTaskpane=!0;I=new u.a(-859308420,I.method,I.mode,I.Re,I.tabName);this.$.Ka.Mb(I,F)}S6c(I){try{const F=c.from(I,"utf16le").toString("base64");return z.a.ZGa(this.YKa,
F)}catch(F){return d.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}Bbh(I){try{const F=z.a.ZGa(this.YKa,I);return c.from(F,"base64").toString("utf16le")}catch(F){return d.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}nmj(){if(this.dxb.length){var I=m.a(this.$).S$("FA000000050"),F={["DataFromPictureWildcard"]:"."};F.imageData=this.S6c(this.dxb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,
"onCustomMessage",F,U=>{U&&d.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else d.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}iXf(){if(this.tableData.length){var I=m.a(this.$).S$("FA000000050"),F={["DataFromPictureWildcard"]:"."};F.tableHtml=this.S6c(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",
F,U=>{U&&d.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else d.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}RWf(){if(this.errorMessage.length){var I=m.a(this.$).S$("FA000000050"),F={["DataFromPictureWildcard"]:"."};F.errorMessage=this.S6c(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",
F,U=>{U&&d.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else d.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",this.SEe,!1);this.augmentationLoopManager.activateAnnotation(this.E8e);this.augmentationLoopManager.bP(this.E8e,this.p7h)}}Object(b.a)(A,"DataFromPictureManager",
l.a,[377])}).call(this,a(1300).mhg)},1300:function(t,C,a){(function(c){function b(){try{var H=new Uint8Array(1);H.__proto__={__proto__:Uint8Array.prototype,nZj:function(){return 42}};return"function"===typeof H.subarray&&0===H.subarray(1,1).byteLength}catch(D){return!1}}function d(H,D){if((f.GO?2147483647:1073741823)<D)throw new RangeError("Invalid typed array length");f.GO?(H=new Uint8Array(D),H.__proto__=f.prototype):(null===H&&(H=new f(D)),H.length=D);return H}function f(H,D,J){if(!(f.GO||this instanceof
f))return new f(H,D,J);if("number"===typeof H){if("string"===typeof D)throw Error("If encoding is specified then the first argument must be a string");return l(this,H)}return e(this,H,D,J)}function e(H,D,J,M){if("number"===typeof D)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&D instanceof ArrayBuffer){D.byteLength;if(0>J||D.byteLength<J)throw new RangeError("'offset' is out of bounds");if(D.byteLength<J+(M||0))throw new RangeError("'length' is out of bounds");
D=void 0===J&&void 0===M?new Uint8Array(D):void 0===M?new Uint8Array(D,J):new Uint8Array(D,J,M);f.GO?(H=D,H.__proto__=f.prototype):H=m(H,D);D=H}else if("string"===typeof D){M=H;H=J;if("string"!==typeof H||""===H)H="utf8";if(!f.Ubf(H))throw new TypeError('"encoding" must be a valid string encoding');J=w(D,H)|0;M=d(M,J);D=M.write(D,H);D!==J&&(M=M.slice(0,D));D=M}else D=v(H,D);return D}function k(H){if("number"!==typeof H)throw new TypeError('"size" argument must be a number');if(0>H)throw new RangeError('"size" argument must not be negative');
}function l(H,D){k(D);H=d(H,0>D?0:n(D)|0);if(!f.GO)for(var J=0;J<D;++J)H[J]=0;return H}function m(H,D){var J=0>D.length?0:n(D.length)|0;H=d(H,J);for(var M=0;M<J;M+=1)H[M]=D[M]&255;return H}function v(H,D){if(f.isBuffer(D)){var J=n(D.length)|0;H=d(H,J);if(0===H.length)return H;D.copy(H,0,0,J);return H}if(D){if("undefined"!==typeof ArrayBuffer&&D.buffer instanceof ArrayBuffer||"length"in D)return(J="number"!==typeof D.length)||(J=D.length,J=J!==J),J?d(H,0):m(H,D);if("Buffer"===D.type&&U(D.data))return m(H,
D.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function n(H){if(H>=(f.GO?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(f.GO?2147483647:1073741823).toString(16)+" bytes");return H|0}function w(H,D){if(f.isBuffer(H))return H.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(H)||H instanceof ArrayBuffer))return H.byteLength;
"string"!==typeof H&&(H=""+H);var J=H.length;if(0===J)return 0;for(var M=!1;;)switch(D){case "ascii":case "latin1":case "binary":return J;case "utf8":case "utf-8":case void 0:return B(H).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*J;case "hex":return J>>>1;case "base64":return A(H).length;default:if(M)return B(H).length;D=(""+D).toLowerCase();M=!0}}function r(H,D,J){var M=!1;if(void 0===D||0>D)D=0;if(D>this.length)return"";if(void 0===J||J>this.length)J=this.length;if(0>=
J)return"";J>>>=0;D>>>=0;if(J<=D)return"";for(H||(H="utf8");;)switch(H){case "hex":H=D;D=J;J=this.length;if(!H||0>H)H=0;if(!D||0>D||D>J)D=J;M="";for(J=H;J<D;++J)H=M,M=this[J],M=16>M?"0"+M.toString(16):M.toString(16),M=H+M;return M;case "utf8":case "utf-8":return x(this,D,J);case "ascii":H="";for(J=Math.min(this.length,J);D<J;++D)H+=String.fromCharCode(this[D]&127);return H;case "latin1":case "binary":H="";for(J=Math.min(this.length,J);D<J;++D)H+=String.fromCharCode(this[D]);return H;case "base64":return 0===
D&&J===this.length?F.RTe(this):F.RTe(this.slice(D,J));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":D=this.slice(D,J);J="";for(H=0;H<D.length;H+=2)J+=String.fromCharCode(D[H]+256*D[H+1]);return J;default:if(M)throw new TypeError("Unknown encoding: "+H);H=(H+"").toLowerCase();M=!0}}function u(H,D,J,M,G){if(0===H.length)return-1;"string"===typeof J?(M=J,J=0):2147483647<J?J=2147483647:-2147483648>J&&(J=-2147483648);J=+J;isNaN(J)&&(J=G?0:H.length-1);0>J&&(J=H.length+J);if(J>=H.length){if(G)return-1;
J=H.length-1}else if(0>J)if(G)J=0;else return-1;"string"===typeof D&&(D=f.from(D,M));if(f.isBuffer(D))return 0===D.length?-1:y(H,D,J,M,G);if("number"===typeof D)return D&=255,f.GO&&"function"===typeof Uint8Array.prototype.indexOf?G?Uint8Array.prototype.indexOf.call(H,D,J):Uint8Array.prototype.lastIndexOf.call(H,D,J):y(H,[D],J,M,G);throw new TypeError("val must be string, number or Buffer");}function y(H,D,J,M,G){function T(W,da){return 1===K?W[da]:W.d5i(da*K)}var K=1,L=H.length,V=D.length;if(void 0!==
M&&(M=String(M).toLowerCase(),"ucs2"===M||"ucs-2"===M||"utf16le"===M||"utf-16le"===M)){if(2>H.length||2>D.length)return-1;K=2;L/=2;V/=2;J/=2}if(G)for(M=-1;J<L;J++)if(T(H,J)===T(D,-1===M?0:J-M)){if(-1===M&&(M=J),J-M+1===V)return M*K}else-1!==M&&(J-=J-M),M=-1;else for(J+V>L&&(J=L-V);0<=J;J--){L=!0;for(M=0;M<V;M++)if(T(H,J+M)!==T(D,M)){L=!1;break}if(L)return J}return-1}function x(H,D,J){J=Math.min(H.length,J);for(var M=[];D<J;){var G=H[D],T=null,K=239<G?4:223<G?3:191<G?2:1;if(D+K<=J)switch(K){case 1:128>
G&&(T=G);break;case 2:var L=H[D+1];128===(L&192)&&(G=(G&31)<<6|L&63,127<G&&(T=G));break;case 3:L=H[D+1];var V=H[D+2];128===(L&192)&&128===(V&192)&&(G=(G&15)<<12|(L&63)<<6|V&63,2047<G&&(55296>G||57343<G)&&(T=G));break;case 4:L=H[D+1];V=H[D+2];var W=H[D+3];128===(L&192)&&128===(V&192)&&128===(W&192)&&(G=(G&15)<<18|(L&63)<<12|(V&63)<<6|W&63,65535<G&&1114112>G&&(T=G))}null===T?(T=65533,K=1):65535<T&&(T-=65536,M.push(T>>>10&1023|55296),T=56320|T&1023);M.push(T);D+=K}H=M.length;if(H<=X)M=String.fromCharCode.apply(String,
M);else{J="";for(D=0;D<H;)J+=String.fromCharCode.apply(String,M.slice(D,D+=X));M=J}return M}function B(H,D){D=D||Infinity;for(var J,M=H.length,G=null,T=[],K=0;K<M;++K){J=H.charCodeAt(K);if(55295<J&&57344>J){if(!G){if(56319<J){-1<(D-=3)&&T.push(239,191,189);continue}else if(K+1===M){-1<(D-=3)&&T.push(239,191,189);continue}G=J;continue}if(56320>J){-1<(D-=3)&&T.push(239,191,189);G=J;continue}J=(G-55296<<10|J-56320)+65536}else G&&-1<(D-=3)&&T.push(239,191,189);G=null;if(128>J){if(0>--D)break;T.push(J)}else if(2048>
J){if(0>(D-=2))break;T.push(J>>6|192,J&63|128)}else if(65536>J){if(0>(D-=3))break;T.push(J>>12|224,J>>6&63|128,J&63|128)}else if(1114112>J){if(0>(D-=4))break;T.push(J>>18|240,J>>12&63|128,J>>6&63|128,J&63|128)}else throw Error("Invalid code point");}return T}function z(H){for(var D=[],J=0;J<H.length;++J)D.push(H.charCodeAt(J)&255);return D}function A(H){var D=F,J=D.JJj;H=(H.trim?H.trim():H.replace(/^\s+|\s+$/g,"")).replace(S,"");if(2>H.length)H="";else for(;0!==H.length%4;)H+="=";return J.call(D,
H)}function I(H,D,J,M){for(var G=0;G<M&&!(G+J>=D.length||G>=H.length);++G)D[G+J]=H[G];return G}var F=a(1302);a(1303);var U=a(1304);C.mhg=f;C.OYj=function(H){+H!=H&&(H=0);return f.ioe(+H)};C.vYj=50;f.GO=void 0!==c.GO?c.GO:b();C.vZj=f.GO?2147483647:1073741823;f.from=function(H,D,J){return e(null,H,D,J)};f.GO&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0}));
f.ioe=function(H){k(H);return d(null,H)};f.uIg=function(H){return l(null,H)};f.isBuffer=function(H){return!(null==H||!H.tqg)};f.compare=function(H,D){if(!f.isBuffer(H)||!f.isBuffer(D))throw new TypeError("Arguments must be Buffers");if(H===D)return 0;for(var J=H.length,M=D.length,G=0,T=Math.min(J,M);G<T;++G)if(H[G]!==D[G]){J=H[G];M=D[G];break}return J<M?-1:M<J?1:0};f.Ubf=function(H){switch(String(H).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;
default:return!1}};f.concat=function(H,D){if(!U(H))throw new TypeError('"list" argument must be an Array of Buffers');if(0===H.length)return f.ioe(0);var J;if(void 0===D)for(J=D=0;J<H.length;++J)D+=H[J].length;D=f.uIg(D);var M=0;for(J=0;J<H.length;++J){var G=H[J];if(!f.isBuffer(G))throw new TypeError('"list" argument must be an Array of Buffers');G.copy(D,M);M+=G.length}return D};f.byteLength=w;f.prototype.tqg=!0;f.prototype.toString=function(){var H=this.length|0;return 0===H?"":0===arguments.length?
x(this,0,H):r.apply(this,arguments)};f.prototype.equals=function(H){if(!f.isBuffer(H))throw new TypeError("Argument must be a Buffer");return this===H?!0:0===f.compare(this,H)};f.prototype.compare=function(H,D,J,M,G){if(!f.isBuffer(H))throw new TypeError("Argument must be a Buffer");void 0===D&&(D=0);void 0===J&&(J=H?H.length:0);void 0===M&&(M=0);void 0===G&&(G=this.length);if(0>D||J>H.length||0>M||G>this.length)throw new RangeError("out of range index");if(M>=G&&D>=J)return 0;if(M>=G)return-1;if(D>=
J)return 1;D>>>=0;J>>>=0;M>>>=0;G>>>=0;if(this===H)return 0;var T=G-M,K=J-D,L=Math.min(T,K);M=this.slice(M,G);H=H.slice(D,J);for(D=0;D<L;++D)if(M[D]!==H[D]){T=M[D];K=H[D];break}return T<K?-1:K<T?1:0};f.prototype.includes=function(H,D,J){return-1!==this.indexOf(H,D,J)};f.prototype.indexOf=function(H,D,J){return u(this,H,D,J,!0)};f.prototype.lastIndexOf=function(H,D,J){return u(this,H,D,J,!1)};f.prototype.write=function(H,D,J,M){if(void 0===D)M="utf8",J=this.length,D=0;else if(void 0===J&&"string"===
typeof D)M=D,J=this.length,D=0;else if(isFinite(D))D|=0,isFinite(J)?(J|=0,void 0===M&&(M="utf8")):(M=J,J=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var G=this.length-D;if(void 0===J||J>G)J=G;if(0<H.length&&(0>J||0>D)||D>this.length)throw new RangeError("Attempt to write outside buffer bounds");M||(M="utf8");for(G=!1;;)switch(M){case "hex":D=Number(D)||0;M=this.length-D;J?(J=Number(J),J>M&&(J=M)):J=M;M=H.length;if(0!==M%2)throw new TypeError("Invalid hex string");
J>M/2&&(J=M/2);for(M=0;M<J;++M){G=parseInt(H.substr(2*M,2),16);if(isNaN(G))break;this[D+M]=G}return M;case "utf8":case "utf-8":return I(B(H,this.length-D),this,D,J);case "ascii":return I(z(H),this,D,J);case "latin1":case "binary":return I(z(H),this,D,J);case "base64":return I(A(H),this,D,J);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":M=H;G=this.length-D;for(var T=[],K=0;K<M.length&&!(0>(G-=2));++K){var L=M.charCodeAt(K);H=L>>8;L%=256;T.push(L);T.push(H)}return I(T,this,D,J);default:if(G)throw new TypeError("Unknown encoding: "+
M);M=(""+M).toLowerCase();G=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.SYj||this,0)}};var X=4096;f.prototype.slice=function(H,D){var J=this.length;H=~~H;D=void 0===D?J:~~D;0>H?(H+=J,0>H&&(H=0)):H>J&&(H=J);0>D?(D+=J,0>D&&(D=0)):D>J&&(D=J);D<H&&(D=H);if(f.GO)D=this.subarray(H,D),D.__proto__=f.prototype;else{J=D-H;D=new f(J,void 0);for(var M=0;M<J;++M)D[M]=this[M+H]}return D};f.prototype.d5i=function(H){if(0!==H%1||0>H)throw new RangeError("offset is not uint");
if(H+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[H]<<8|this[H+1]};f.prototype.copy=function(H,D,J,M){J||(J=0);M||0===M||(M=this.length);D>=H.length&&(D=H.length);D||(D=0);0<M&&M<J&&(M=J);if(M===J||0===H.length||0===this.length)return 0;if(0>D)throw new RangeError("targetStart out of bounds");if(0>J||J>=this.length)throw new RangeError("sourceStart out of bounds");if(0>M)throw new RangeError("sourceEnd out of bounds");M>this.length&&(M=this.length);H.length-
D<M-J&&(M=H.length-D+J);var G=M-J;if(this===H&&J<D&&D<M)for(M=G-1;0<=M;--M)H[M+D]=this[M+J];else if(1E3>G||!f.GO)for(M=0;M<G;++M)H[M+D]=this[M+J];else Uint8Array.prototype.set.call(H,this.subarray(J,J+G),D);return G};f.prototype.fill=function(H,D,J,M){if("string"===typeof H){"string"===typeof D?(M=D,D=0,J=this.length):"string"===typeof J&&(M=J,J=this.length);if(1===H.length){var G=H.charCodeAt(0);256>G&&(H=G)}if(void 0!==M&&"string"!==typeof M)throw new TypeError("encoding must be a string");if("string"===
typeof M&&!f.Ubf(M))throw new TypeError("Unknown encoding: "+M);}else"number"===typeof H&&(H&=255);if(0>D||this.length<D||this.length<J)throw new RangeError("Out of range index");if(J<=D)return this;D>>>=0;J=void 0===J?this.length:J>>>0;H||(H=0);if("number"===typeof H)for(M=D;M<J;++M)this[M]=H;else for(H=f.isBuffer(H)?H:B((new f(H,M)).toString()),G=H.length,M=0;M<J-D;++M)this[M+D]=H[M%G];return this};var S=/[^+\/0-9A-Za-z-_]/g}).call(this,a(1301))},1301:function(t){var C=function(){return this}();
try{C=C||(new Function("return this"))()}catch(a){"object"===typeof window&&(C=window)}t.exports=C},1302:function(t,C){function a(f){var e=f.length;if(0<e%4)throw Error("Invalid string. Length must be a multiple of 4");f=f.indexOf("=");-1===f&&(f=e);return[f,f===e?0:4-f%4]}C.byteLength=function(f){f=a(f);var e=f[1];return 3*(f[0]+e)/4-e};C.JJj=function(f){var e=a(f);var k=e[0];e=e[1];var l=new d(3*(k+e)/4-e),m=0,v=0<e?k-4:k,n;for(n=0;n<v;n+=4)k=b[f.charCodeAt(n)]<<18|b[f.charCodeAt(n+1)]<<12|b[f.charCodeAt(n+
2)]<<6|b[f.charCodeAt(n+3)],l[m++]=k>>16&255,l[m++]=k>>8&255,l[m++]=k&255;2===e&&(k=b[f.charCodeAt(n)]<<2|b[f.charCodeAt(n+1)]>>4,l[m++]=k&255);1===e&&(k=b[f.charCodeAt(n)]<<10|b[f.charCodeAt(n+1)]<<4|b[f.charCodeAt(n+2)]>>2,l[m++]=k>>8&255,l[m++]=k&255);return l};C.RTe=function(f){for(var e=f.length,k=e%3,l=[],m=0,v=e-k;m<v;m+=16383){for(var n=l,w=n.push,r,u=f,y=m+16383>v?v:m+16383,x=[],B=m;B<y;B+=3)r=(u[B]<<16&16711680)+(u[B+1]<<8&65280)+(u[B+2]&255),x.push(c[r>>18&63]+c[r>>12&63]+c[r>>6&63]+c[r&
63]);r=x.join("");w.call(n,r)}1===k?(f=f[e-1],l.push(c[f>>2]+c[f<<4&63]+"==")):2===k&&(f=(f[e-2]<<8)+f[e-1],l.push(c[f>>10]+c[f>>4&63]+c[f<<2&63]+"="));return l.join("")};var c=[],b=[],d="undefined"!==typeof Uint8Array?Uint8Array:Array;for(t=0;64>t;++t)c[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[t],b["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(t)]=t;b[45]=62;b[95]=63},1303:function(t,C){C.read=function(a,c,b,d,f){var e=8*f-d-1;var k=(1<<
e)-1,l=k>>1,m=-7;f=b?f-1:0;var v=b?-1:1,n=a[c+f];f+=v;b=n&(1<<-m)-1;n>>=-m;for(m+=e;0<m;b=256*b+a[c+f],f+=v,m-=8);e=b&(1<<-m)-1;b>>=-m;for(m+=d;0<m;e=256*e+a[c+f],f+=v,m-=8);if(0===b)b=1-l;else{if(b===k)return e?NaN:Infinity*(n?-1:1);e+=Math.pow(2,d);b-=l}return(n?-1:1)*e*Math.pow(2,b-d)};C.write=function(a,c,b,d,f,e){var k,l=8*e-f-1,m=(1<<l)-1,v=m>>1,n=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;e=d?0:e-1;var w=d?1:-1,r=0>c||0===c&&0>1/c?1:0;c=Math.abs(c);isNaN(c)||Infinity===c?(c=isNaN(c)?1:0,d=m):
(d=Math.floor(Math.log(c)/Math.LN2),1>c*(k=Math.pow(2,-d))&&(d--,k*=2),c=1<=d+v?c+n/k:c+n*Math.pow(2,1-v),2<=c*k&&(d++,k/=2),d+v>=m?(c=0,d=m):1<=d+v?(c=(c*k-1)*Math.pow(2,f),d+=v):(c=c*Math.pow(2,v-1)*Math.pow(2,f),d=0));for(;8<=f;a[b+e]=c&255,e+=w,c/=256,f-=8);d=d<<f|c;for(l+=f;0<l;a[b+e]=d&255,e+=w,d/=256,l-=8);a[b+e-w]|=128*r}},1304:function(t){var C={}.toString;t.exports=Array.isArray||function(a){return"[object Array]"==C.call(a)}},1305:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);
C=a(721);var c=a(695);class b extends C.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,{T_:b.getTypeName(),B_:b.Pd()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static Pd(){return["AugLoop_Core_Annotation"]}}Object(t.a)(b,"DetectedHtmlTableAnnotation",C.a,[])},1306:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{static ZGa(b,d){if(!(b&&d&&b.length&&d.length)||256<b.length)return"";const f=
Array(256),e=Array(256);let k,l=0,m=0;let v,n="";for(k=0;256>k;k++)f[k]=k;for(k=0;256>k;k++){var w=b.charCodeAt(k%b.length);if(256<=w)return"";l=(l+f[k]+w)%256;w=f[k];f[k]=f[l];f[l]=w}for(k=0;256>k;k++)e[k]=f[256-k-1];l=k=0;for(b=0;b<d.length;b++){k=(k+1)%256;l=(l+f[k])%256;w=f[k];f[k]=f[l];f[l]=w;w=d.charCodeAt(b);if(256<=w)return"";v=w^f[(f[k]+f[l])%256];m=(m+e[k])%256;w=e[k];e[k]=e[m];e[m]=w;n+=String.fromCharCode(v^f[(e[k]+e[m])%256])}return n}}Object(t.a)(c,"RC4A",null,[])},1308:function(t,C,
a){a.d(C,"a",function(){return b});t=a(0);a(15);var c=a(4);class b{constructor(d,f,e,k){this.ujb=d;c.AFrameworkApplication.fa.qa("AddInCommandsMissingTabIsEnabled")&&e.WQh();this.Mkg=this.$w=f;this.tvg=k}get FCb(){return this.ujb}get solutionId(){return this.$w}get assetId(){return this.Mkg}get jQd(){return this.tvg}wJa(d){d=this.FCb+this.solutionId+d;return this.jQd?(d in b.PYb||(b.PYb[d]="AddinControl"+b.iHg++),b.PYb[d]):d}MEe(d){if(this.jQd){const e=b.PYb;for(let k in e){var f=k;if(d===e[k])return f.substr(this.FCb.length+
this.solutionId.length)}}return d}Y1e(d){d=this.FCb+this.solutionId+d;return this.jQd?(d in b.AUc||(b.AUc[d]="AddinTab"+b.sHg++),b.AUc[d]):d}}b.PYb={};b.AUc={};b.sHg=0;b.iHg=0;Object(t.a)(b,"DefaultRibbonNamingProvider",null,[863])},1355:function(t,C,a){a.r(C);t=a(0);var c=a(15),b=a(84),d;(function(r){r[r.none=0]="none";r[r.testEvent=1]="testEvent";r[r.test1Event=2]="test1Event";r[r.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";r[r.worksheetActivatedEvent=11]="worksheetActivatedEvent";
r[r.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";r[r.worksheetAddedEvent=13]="worksheetAddedEvent";r[r.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";r[r.worksheetDeletedEvent=15]="worksheetDeletedEvent";r[r.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";r[r.worksheetFilteredEvent=17]="worksheetFilteredEvent";r[r.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";r[r.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";r[r.worksheetColumnSortedEvent=
20]="worksheetColumnSortedEvent";r[r.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";r[r.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";r[r.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";r[r.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";r[r.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";r[r.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";r[r.worksheetMovedEvent=27]="worksheetMovedEvent";r[r.worksheetNavigationObjectChangedEvent=
28]="worksheetNavigationObjectChangedEvent";r[r.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";r[r.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";r[r.chartAddedEvent=50]="chartAddedEvent";r[r.chartActivatedEvent=51]="chartActivatedEvent";r[r.chartDeactivatedEvent=52]="chartDeactivatedEvent";r[r.chartDeletedEvent=53]="chartDeletedEvent";r[r.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";r[r.tableDataChangedEvent=101]="tableDataChangedEvent";
r[r.tableAddedEvent=102]="tableAddedEvent";r[r.tableDeletedEvent=103]="tableDeletedEvent";r[r.tableFilteredEvent=104]="tableFilteredEvent";r[r.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";r[r.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";r[r.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";r[r.commentAddedEvent=250]="commentAddedEvent";r[r.commentDeletedEvent=251]="commentDeletedEvent";r[r.commentChangedEvent=252]="commentChangedEvent";r[r.invocationMessage=
1E3]="invocationMessage";r[r.cancellationMessage=1001]="cancellationMessage";r[r.metadataMessage=1002]="metadataMessage";r[r.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";r[r.visualChangeEvent=2001]="visualChangeEvent";r[r.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";r[r.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";r[r.shapeActivatedEvent=2101]="shapeActivatedEvent";r[r.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";r[r.shapeAddedEvent=
2103]="shapeAddedEvent";r[r.shapeDeletedEvent=2104]="shapeDeletedEvent";r[r.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";r[r.wacOperationEvent=2201]="wacOperationEvent";r[r.recordingStateChangedEvent=2202]="recordingStateChangedEvent";r[r.workbookActivatedEvent=2203]="workbookActivatedEvent";r[r.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";r[r.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";r[r.linkedDataTypeRefreshRequestCompletedEvent=
2500]="linkedDataTypeRefreshRequestCompletedEvent";r[r.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";r[r.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";r[r.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";r[r.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";r[r.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";r[r.rangePickerDeactivatedEvent=
2701]="rangePickerDeactivatedEvent";r[r.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";r[r.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";r[r.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";r[r.pivotTableAddedEvent=2900]="pivotTableAddedEvent";r[r.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";r[r.namedItemAddedEvent=3E3]="namedItemAddedEvent";r[r.namedItemDeletedEvent=3001]="namedItemDeletedEvent";r[r.guidedReapplyManagerUpdateAvailableEvent=
3100]="guidedReapplyManagerUpdateAvailableEvent";r[r.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";r[r.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";r[r.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(d||(d={}));Object(t.b)("MessageType",d);var f=a(761),e=a(248),k=a(733),l=a(58),m=a(37),v=a(152),n=a(1);a.d(C,"DdaEventDispatch",function(){return w});class w{constructor(r){this.TA=null;this.N9f={};this.P9f=
{};this.E$c={};this.gxd={};this.ghd=(u,y)=>{u=this.$.Ib.Bc("Task","DdaEventDispatch.HandleServerEvent");y=y.oXf;for(let A=0;A<y.length;A++)switch(y[A].EventType){case 2:var x=y[A],B={};B.Name=x.Name;B.BindingType=x.BindingType;B.ColCount=x.ColCount;B.RowCount=x.RowCount;this.mva(x.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,B,null);break;case 4:this.mva(y[A].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(x=y[A],x.InstanceId){B=Array(x.Entries.length);
for(var z=0;z<x.Entries.length;z++)B[z]=w.Dac(x.Entries[z],x.IsRemoteOverride);0<x.Entries.length&&1===x.Entries[0].Category?this.l0i(x.InstanceId,B):x.InstanceId&&this.mva(x.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,B)}else{this.E$c={};this.gxd={};for(B=0;B<x.Entries.length;B++)this.lHe(x.Entries[B],x.IsRemoteOverride);x=JSON.stringify(this.E$c);B=JSON.stringify(this.gxd);z=JSON.stringify(this.N9f);const I=JSON.stringify(this.P9f);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${x}, Number of Not Fired event: ${B}, Total Number of Fired event: ${z}, Total Number of Not Fired event: ${I}`)}}u.stop()};
this.zJb=(u,y)=>{this.mva(u,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,y)};this.$=r;this.suc=this.ghd}sYb(r){r&&(this.Yha(),this.TA.push(r))}Drc(r){this.TA&&(Array.remove(this.TA,r),this.TA.length||(this.$.wantServerEvents=!1,this.$.jcj(this.suc),this.TA=null))}l0i(r,u){const y=Object(b.a)(k.DdaFacade,e.a(this.$));m.TaskExtensions.Aa(y.qSh(r),x=>{if(v.b(x)){var B=x.result;x=y.fn(B);if(B)if(x.agc)this.mva(B,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u);else if(x.q4b)for(B=0;B<u.length;B++)x.q4b.push(u[B]);
else x.q4b=u}else x.Sf?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):x.Ch&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.la,0)}G0i(r,u){const y=Object(b.a)(k.DdaFacade,e.a(this.$)),x=y.AGh(r);x?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(x,u,this.zJb):y.w3g(r,u)}lHe(r,u){let y=!1;const x=parseInt(r.Type,
10);var B=r.Target;const z=Object(b.a)(k.DdaFacade,e.a(this.$));if((B=z.$i.wSh(x,B))&&0<Object.keys(B).length){y=!0;for(let I in B)if(B=I,z.$i.CZb(B)){const F=Array(1);F[0]=w.Dac(r,u);if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var A=F[0][3];if(void 0!==A&&null!==A&&(A=Object(b.a)(Object,l.a.Vh(A)))&&void 0!==A.triggerControlId&&null!==A.triggerControlId&&void 0!==A.triggerSource&&null!==A.triggerSource){let U=!1;u?(A.triggerSource="Unknown",U=!0):z.mgh(A.triggerControlId,
B)&&(A.triggerSource="ThisLocalAddin",U=!0);U&&(F[0][3]=l.a.Ac(A))}}this.mva(B,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,F)}}y?(this.mdc(d[x],this.E$c),this.mdc(d[x],this.N9f)):(this.mdc(d[x],this.gxd),this.mdc(d[x],this.P9f))}Yha(){this.TA||(this.TA=[],this.$.cne(this.suc),this.$.wantServerEvents=!0)}mdc(r,u){r in u||(u[r]=0);u[r]+=1}AM(r,u,y){const x={};x.Target=u;x.Category=65536;x.Type=r;x.Message=y;x.Id=-1;this.lHe(x,!1)}tAh(r,u){const y={Target:"",Category:2,Type:1E3};y.Message=u;y.Id=
0;u=Array(1);u[0]=w.Dac(y,!1);this.G0i(r,u)}D8b(r,u,y,x){const B={};B.Target=y;B.Category=65536;B.Type=u;B.Message=x;B.Id=-1;u=Array(1);u[0]=w.Dac(B,!1);this.mva(r,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)}sAh(r,u){this.mva(r,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)}mva(r,u,y,x){if(this.TA){var B=Object(b.a)(k.DdaFacade,e.a(this.$));if(!B||u!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&u!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||B.$i.CZb(r)){r=new f.a(u,r,
y,x);for(let z=0,A=this.TA.length;z<A;z++)(u=this.TA[z])&&u(r)}}}static Dac(r,u){const y=Array(6);y[0]=r.Category;y[1]=r.Type;y[2]=r.Target;y[3]=r.Message;y[4]=r.Id;y[5]=u;return y}}Object(t.a)(w,"DdaEventDispatch",null,[])},1384:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.taskPaneWidth="TaskPaneWidth";c.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";c.Zk="TaskPaneTitle";c.Tk="IconCssClass";c.hUd="TaskPaneIconUrl";c.TR="TaskPaneIconId";c.mB="NonPersistedSettings";
c.onTaskPaneClose="OnTaskPaneClose";c.fSc="ActionArgs";Object(t.a)(c,"PropertyNames",null,[])},1385:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);C=a(144);var c=a(88);class b extends C.a{constructor(){super(void 0,void 0,void 0,!0);this.xCa="AddinCommandsUILessDialog";this.aRc="WACDialogTitleText";this.zea="0";this.aX=380;this.jpa=190;this.ze=this.xCa;this.Rb=5;this.Amg=String.format("{0}px",this.aX);this.yea=String.format("{0}px",this.jpa);this.B5e=this.ft=!1;this.Lz()}Lz(){super.Lz();this.Kk.style.width=
this.Amg;this.Kk.style.height=this.yea;this.Kk.style.padding=this.zea}uv(d){this.BI();document.getElementById(this.hi(this.aRc)).innerText=d}BI(){super.BI();this.vb.style.width=String.format("{0}px",this.aX);this.vb.style.height=String.format("{0}px",this.jpa);this.vb.removeAttribute(c.a.Kd);this.vb.removeAttribute(c.a.pE)}hide(){this.Qwb()}get kta(){return this.Kk}initializeAndShowWithTitle(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,null)}}Object(t.a)(b,"AddinCommandsUILessDialog",
C.a,[869])},1415:function(t,C,a){a.r(C);var c=a(508),b=a(952),d=a(1180),f=a(10),e=a(0),k=a(221),l=a(185),m=a(582);class v{constructor(){this.Sfb=null}get jNg(){this.Sfb||(this.Sfb=new l.a,this.Sfb.add(12),this.Sfb.add(11));return this.Sfb}Udi(N){return this.jNg.contains(N.operation)}dOj(N){const Ka=[],Cb=N.payload;for(const jc of Cb.batchedOperations)Ka.push(new m.a(N.operation,jc));return Ka}}Object(e.a)(v,"MacroRecorderBatchedEventList",null,[]);var n=a(15),w=a(58),r=a(120),u=a(637);class y{equals(N,
Ka){return N===Ka}getHashCode(N){return N}Wia(N){return N}}Object(e.a)(y,"UserOperationNameComparer",null,[38,93]);class x{static y_h(){x.Kc||(x.Kc=new u.a(new y),x.Kc.add(507),x.Kc.add(10),x.Kc.add(576),x.Kc.add(563),x.Kc.add(564),x.Kc.add(565),x.Kc.add(566),x.Kc.add(567),x.Kc.add(568),x.Kc.add(569),x.Kc.add(570),x.Kc.add(571),x.Kc.add(572),x.Kc.add(573),x.Kc.add(574),x.Kc.add(575),x.Kc.add(501),x.Kc.add(520),x.Kc.add(1),x.Kc.add(1002),x.Kc.add(129),x.Kc.add(198),x.Kc.add(500),x.Kc.add(519),x.Kc.add(538),
x.Kc.add(1E3),x.Kc.add(1003),x.Kc.add(144),x.Kc.add(502),x.Kc.add(505),x.Kc.add(179),x.Kc.add(205),x.Kc.add(134),x.Kc.add(230),x.Kc.add(103),x.Kc.add(110),x.Kc.add(112),x.Kc.add(113),x.Kc.add(124),x.Kc.add(133),x.Kc.add(154),x.Kc.add(162),x.Kc.add(168),x.Kc.add(172),x.Kc.add(201),x.Kc.add(222),x.Kc.add(227),x.Kc.add(513),x.Kc.add(534),x.Kc.add(539),x.Kc.add(545),x.Kc.add(600),x.Kc.add(547),x.Kc.add(555),x.Kc.add(558),x.Kc.add(562),x.Kc.add(585),x.Kc.add(1001),x.Kc.add(1005),x.Kc.add(1008),x.Kc.add(1010),
x.Kc.add(1011),x.Kc.add(1012),x.Kc.add(1018),x.Kc.add(252),x.Kc.add(253),x.Kc.add(258),x.Kc.add(101),x.Kc.add(102),x.Kc.add(108),x.Kc.add(257),x.Kc.add(119),x.Kc.add(120),x.Kc.add(123),x.Kc.add(126),x.Kc.add(127),x.Kc.add(130),x.Kc.add(140),x.Kc.add(159),x.Kc.add(160),x.Kc.add(165),x.Kc.add(166),x.Kc.add(167),x.Kc.add(169),x.Kc.add(189),x.Kc.add(223),x.Kc.add(214),x.Kc.add(228),x.Kc.add(233),x.Kc.add(247),x.Kc.add(504),x.Kc.add(511),x.Kc.add(512),x.Kc.add(525),x.Kc.add(533),x.Kc.add(537),x.Kc.add(542),
x.Kc.add(544),x.Kc.add(548),x.Kc.add(550),x.Kc.add(551),x.Kc.add(552),x.Kc.add(554),x.Kc.add(577),x.Kc.add(584),x.Kc.add(586),x.Kc.add(587),x.Kc.add(588),x.Kc.add(592),x.Kc.add(1009),x.Kc.add(1016),x.Kc.add(1017));return x.Kc}}x.Kc=null;Object(e.a)(x,"MacroRecorderUnrecognizedEventList",null,[]);class B{constructor(N,Ka,Cb){this.B8b=null;this.Uwi=(jc,Kc)=>{this.x1f()&&this.B$c(Kc)};this.$nf=Ka;this.Znf=Cb;this.$=N;this.$.fba&&this.$.DFg(this.Uwi);N.da.Ga(297,this)}init(N){this.$.fba&&(N?this.B8b=
N:n.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}B$c(N){if(this.x1f())try{if(this.Znf.Udi(N)){const Ka=this.Znf.dOj(N);for(const Cb of Ka)this.iSe(Cb)}else this.iSe(N)}catch(Ka){N=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${r.a(N.operation)}, Exception: ${Ka.stack}`,n.ULS.sendTraceTag(537155423,0,10,N)}}iSe(N){var Ka=this.$nf.yZe(N,!0);Ka?(this.B8b(Ka.eventId,w.a.Ac(N.payload)),n.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Ka.eventId}`)):
(Ka=this.$nf.yZe(N,!1))?n.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Ka.eventId}, but failed to match filters`):x.y_h().contains(N.operation)||(this.B8b(0,w.a.Ac(N.operation)),N=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${r.a(N.operation)}`,n.ULS.sendTraceTag(537155420,0,50,N))}x1f(){return this.$.gka&&this.B8b&&this.$.aba?!0:!1}}Object(e.a)(B,"MacroRecorderEventHandler",null,[835]);var z=a(1);class A{constructor(){this.XGc=
this.YGc=this.VMc=this.zRc=null}get operations(){this.VMc||(this.VMc=new l.a,this.Yb());return this.VMc}get zBc(){this.zRc||(this.zRc=new l.a,this.eg());return this.zRc}get NQe(){this.XGc||(this.XGc=new l.a);return this.XGc}get featureGates(){this.YGc||(this.YGc=new l.a,this.Iva());return this.YGc}eg(){}Iva(){}kd(N){this.zBc.add(N)}Pb(N){this.operations.contains(N)||this.operations.add(N)}lmb(){this.featureGates.add(667)}pke(N){this.NQe.add(N)}}Object(e.a)(A,"MacroRecorderEventBase",null,[]);class I extends A{constructor(){super()}get eventId(){return 130}Yb(){this.Pb(100)}}
Object(e.a)(I,"AccessibilityCheckRunEvent",A,[]);class F extends A{constructor(){super()}get eventId(){return 160}Yb(){this.Pb(241)}eg(){this.kd(N=>N.addToPrintArea)}}Object(e.a)(F,"AddedToPrintAreaEvent",A,[]);class U extends A{constructor(){super()}get eventId(){return 65}Yb(){this.Pb(516)}}Object(e.a)(U,"AutoFilterToggledEvent",A,[]);class X extends A{constructor(){super()}get eventId(){return 118}Yb(){this.Pb(502)}eg(){this.kd(N=>!(N.S3a().FirstColumn===N.S3a().LastColumn&&N.S3a().FirstRow===
N.S3a().LastRow))}}Object(e.a)(X,"AutoSumEvent",A,[]);class S extends A{constructor(N,Ka){super();this.Pea=N;this.VUj=Ka}get eventId(){return this.Pea}Yb(){this.Pb(529);this.Pb(594)}eg(){this.kd(N=>this.VUj.includes(N.qed()))}}Object(e.a)(S,"ChartPropertyAppliedEventBase",A,[]);class H extends S{constructor(){super(84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(e.a)(H,"ChartAxisChangedEvent",S,[]);class D extends S{constructor(){super(80,[-104,-103,300,301,302,303,304,305,306,
307,308,309,310,311])}}Object(e.a)(D,"ChartAxisTitleChangedEvent",S,[]);class J extends S{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(e.a)(J,"ChartDataLabelsChangedEvent",S,[]);class M extends S{constructor(){super(76,[-100])}}Object(e.a)(M,"ChartDataSelectedEvent",S,[]);class G extends S{constructor(){super(83,[500,501,502])}}Object(e.a)(G,"ChartDataTableChangedEvent",S,[]);var T=a(551),K=a(412),L=a(84);class V extends A{constructor(){super()}}Object(e.a)(V,"RichApiRequestExecutedEventBase",
A,[]);class W{constructor(N,Ka,Cb){this.response=this.request=this.eventId=this.source=null;N&&(this.source=N.source,this.eventId=N.eventId,this.request=Ka,this.response=Cb)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(e.a)(W,"MacroRecorderRichApiRequestExecutedPayload",null,[101]);class da extends V{constructor(){super()}get eventId(){return 117}kw(N){da.k6||(da.k6=new u.a(T.a.Sk()),da.k6.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),
da.k6.add("fa000000014"));return!!N&&da.k6.contains(N.toLowerCase())}Yb(){this.Pb(507);this.Pb(10);this.Pb(576)}eg(){this.kd(N=>Object(K.a)(W,N)&&(N=Object(L.a)(W,N),N.isValid&&this.kw(N.source))?(n.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${N.eventId}`),!0):!1)}}da.k6=null;Object(e.a)(da,"ChartFormatRichApiRequestExecutedEvent",V,[]);class qa extends S{constructor(){super(85,[328,329,330,331,332,333,334,335])}}Object(e.a)(qa,
"ChartGridlinesChangedEvent",S,[]);class O extends A{constructor(){super()}get eventId(){return 66}Yb(){this.Pb(528)}}Object(e.a)(O,"ChartInsertedEvent",A,[]);class ea extends S{constructor(){super(81,[100,101,102,103,104,105,106])}}Object(e.a)(ea,"ChartLegendChangedEvent",S,[]);class R extends S{constructor(){super(75,[-101])}}Object(e.a)(R,"ChartRowColumnSwitchedEvent",S,[]);class oa extends S{constructor(){super(79,[0,1,2,-102])}}Object(e.a)(oa,"ChartTitleChangedEvent",S,[]);class pa extends S{constructor(){super(78,
[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(e.a)(pa,"ChartTypeChangedEvent",S,[]);class Pa extends A{constructor(){super()}get eventId(){return 131}Yb(){this.Pb(521)}}Object(e.a)(Pa,"ConnectorFloatingObjectResizedEvent",A,[]);class Z extends A{constructor(){super()}get eventId(){return 129}Yb(){this.Pb(109)}}Object(e.a)(Z,"EntitySelectedEvent",A,[]);class Ra extends A{constructor(){super()}get eventId(){return 49}Yb(){this.Pb(149);
this.Pb(147)}}Object(e.a)(Ra,"FindCellEvent",A,[]);class Ga extends A{constructor(){super()}get eventId(){return 96}Yb(){this.Pb(122)}}Object(e.a)(Ga,"FloatingObjectAltTextAppliedEvent",A,[]);class Ba extends A{constructor(){super()}get eventId(){return 93}Yb(){this.Pb(522)}}Object(e.a)(Ba,"FloatingObjectDeletedEvent",A,[]);class fa extends A{constructor(){super()}get eventId(){return 94}Yb(){this.Pb(524)}}Object(e.a)(fa,"FloatingObjectMovedAndResizedEvent",A,[]);class Y extends A{constructor(){super()}get eventId(){return 95}Yb(){this.Pb(523)}}
Object(e.a)(Y,"FloatingObjectRotatedEvent",A,[]);class ja extends A{constructor(){super()}get eventId(){return 100}Yb(){this.Pb(543)}}Object(e.a)(ja,"GroupDetailsShownOrHiddenEvent",A,[]);class ca extends A{constructor(){super()}get eventId(){return 154}Yb(){this.Pb(125)}}Object(e.a)(ca,"HyperlinksRemovedFromRangeEvent",A,[]);class aa extends V{constructor(){super()}get eventId(){return 125}kw(N){aa.k6||(aa.k6=new u.a(T.a.Sk()),aa.k6.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),aa.k6.add("fa000000005"));
return!!N&&aa.k6.contains(N.toLowerCase())}Yb(){this.Pb(507);this.Pb(10);this.Pb(576)}eg(){this.kd(N=>Object(K.a)(W,N)?(N=Object(L.a)(W,N),N.isValid&&this.kw(N.source)):!1)}}aa.k6=null;Object(e.a)(aa,"IdeasRichApiRequestExecutedEvent",V,[]);class ta extends A{constructor(){super()}get eventId(){return 136}Yb(){this.Pb(115)}}Object(e.a)(ta,"LinkedEntityConvertedEvent",A,[]);class xa extends A{constructor(){super()}get eventId(){return 148}Yb(){this.Pb(114)}}Object(e.a)(xa,"LinkedEntityDisambiguationPaneToggledEvent",
A,[]);class ia extends A{constructor(){super()}get eventId(){return 127}Yb(){this.Pb(119)}}Object(e.a)(ia,"MovedToEdgeEvent",A,[]);class ya extends A{constructor(){super()}get eventId(){return 135}Yb(){this.Pb(191)}Iva(){this.lmb()}}Object(e.a)(ya,"NamedSheetViewCreatedEvent",A,[]);class ib extends A{constructor(){super()}get eventId(){return 166}Yb(){this.Pb(200)}Iva(){this.lmb()}}Object(e.a)(ib,"NamedSheetViewDeletedEvent",A,[]);class wa extends A{constructor(){super()}get eventId(){return 133}Yb(){this.Pb(192)}Iva(){this.lmb()}}
Object(e.a)(wa,"NamedSheetViewExitedEvent",A,[]);class sa extends A{constructor(){super()}get eventId(){return 162}Yb(){this.Pb(199)}Iva(){this.lmb()}}Object(e.a)(sa,"NamedSheetViewRenamedEvent",A,[]);class Ya extends A{constructor(){super()}get eventId(){return 167}Yb(){this.Pb(195)}Iva(){this.lmb()}}Object(e.a)(Ya,"NamedSheetViewSwitchedEvent",A,[]);class bb extends A{constructor(){super()}get eventId(){return 99}Yb(){this.Pb(174)}}Object(e.a)(bb,"OutlineLevelSetEvent",A,[]);class mb extends A{constructor(){super()}get eventId(){return 156}Yb(){this.Pb(244)}}
Object(e.a)(mb,"PageBreakInsertedEvent",A,[]);class Ca extends A{constructor(){super()}get eventId(){return 157}Yb(){this.Pb(245)}}Object(e.a)(Ca,"PageBreakRemovedEvent",A,[]);class $a extends A{constructor(){super()}get eventId(){return 158}Yb(){this.Pb(246)}}Object(e.a)($a,"PageBreaksAllResetEvent",A,[]);class Kb extends A{constructor(){super()}get eventId(){return 112}Yb(){this.Pb(503)}eg(){this.kd(N=>!!N.pasteParameters.ClientEstimationFloatingObjectId&&2===N.pasteParameters.CopyPasteTargetType&&
!N.isFromCurrentSession)}}Object(e.a)(Kb,"PasteArtOtherWorkbookEvent",A,[]);class rb extends A{constructor(){super()}get eventId(){return 52}Yb(){this.Pb(503)}eg(){this.kd(N=>!!N.pasteParameters.ClientEstimationFloatingObjectId&&2===N.pasteParameters.CopyPasteTargetType&&N.isFromCurrentSession)}}Object(e.a)(rb,"PasteArtSameWorkbookEvent",A,[]);class cc extends A{constructor(){super()}get eventId(){return 110}Yb(){this.Pb(204)}}Object(e.a)(cc,"PasteHtmlEvent",A,[]);class nc extends A{constructor(){super()}get eventId(){return 35}Yb(){this.Pb(506)}}
Object(e.a)(nc,"PasteRangeEvent",A,[]);class Wb extends A{constructor(){super()}get eventId(){return 111}Yb(){this.Pb(503)}eg(){this.kd(N=>1===N.pasteParameters.CopyPasteTargetType)}}Object(e.a)(Wb,"PasteShadowWorkbookRangeEvent",A,[]);class Ea extends A{constructor(){super()}get eventId(){return 42}Yb(){this.Pb(180)}}Object(e.a)(Ea,"PasteStringEvent",A,[]);class ua extends A{constructor(){super()}get eventId(){return 134}Yb(){this.Pb(220)}}Object(e.a)(ua,"PendingMergeEvent",A,[]);class ma extends A{constructor(){super()}get eventId(){return 122}Yb(){this.Pb(510)}}
Object(e.a)(ma,"PictureInsertedEvent",A,[]);class fb extends A{constructor(){super()}get eventId(){return 153}Yb(){this.Pb(161)}}Object(e.a)(fb,"PivotDrillToggledEvent",A,[]);class sb extends A{constructor(N,Ka){super();this.Pea=N;this.opType=Ka}get eventId(){return this.Pea}Yb(){this.Pb(225)}eg(){this.kd(N=>N.opType===this.opType)}}Object(e.a)(sb,"PivotTableSettingsChangedEventBase",A,[]);class Ua extends sb{constructor(){super(171,4)}}Object(e.a)(Ua,"PivotTableAllItemLabelsRepeatedEvent",sb,[]);
class ab extends sb{constructor(){super(184,17)}}Object(e.a)(ab,"PivotTableAltTextDescriptionChangedEvent",sb,[]);class na extends sb{constructor(){super(183,16)}}Object(e.a)(na,"PivotTableAltTextTitleChangedEvent",sb,[]);class Na extends sb{constructor(){super(173,6)}}Object(e.a)(Na,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",sb,[]);class Va extends sb{constructor(){super(172,5)}}Object(e.a)(Va,"PivotTableBlankLineAfterEachItemToggledEvent",sb,[]);class Sa extends sb{constructor(){super(170,
3)}}Object(e.a)(Sa,"PivotTableColumnGrandTotalShownEvent",sb,[]);class vb extends A{constructor(){super()}get eventId(){return 98}Yb(){this.Pb(132)}}Object(e.a)(vb,"PivotTableCreatedEvent",A,[]);class Oa extends sb{constructor(){super(177,10)}}Object(e.a)(Oa,"PivotTableDisplayErrorStringToggledEvent",sb,[]);class yb extends sb{constructor(){super(178,11)}}Object(e.a)(yb,"PivotTableDisplayNullStringToggledEvent",sb,[]);class Ob extends sb{constructor(){super(179,12)}}Object(e.a)(Ob,"PivotTableErrorStringChangedEvent",
sb,[]);class Ja extends sb{constructor(){super(174,7)}}Object(e.a)(Ja,"PivotTableExpandCollapseButtonsShownEvent",sb,[]);class lb extends sb{constructor(){super(187,20)}}Object(e.a)(lb,"PivotTableIndentChangedEvent",sb,[]);class Pb extends sb{constructor(){super(176,9)}}Object(e.a)(Pb,"PivotTableItemsWithNoDataOnColumnsShownEvent",sb,[]);class Jb extends sb{constructor(){super(175,8)}}Object(e.a)(Jb,"PivotTableItemsWithNoDataOnRowsShownEvent",sb,[]);class Lb extends sb{constructor(){super(186,19)}}
Object(e.a)(Lb,"PivotTableLayoutTypeSetEvent",sb,[]);class Ab extends sb{constructor(){super(180,13)}}Object(e.a)(Ab,"PivotTableNullStringChangedEvent",sb,[]);class nb extends A{constructor(){super()}get eventId(){return 149}Yb(){this.Pb(219)}}Object(e.a)(nb,"PivotTablePivotLocationChangedEvent",A,[]);class va extends A{constructor(){super()}get eventId(){return 102}Yb(){this.Pb(145)}}Object(e.a)(va,"PivotTablePivotedEvent",A,[]);class db extends sb{constructor(){super(182,15)}}Object(e.a)(db,"PivotTableRefreshDataOnLoadToggledEvent",
sb,[]);class Xa extends A{constructor(){super()}get eventId(){return 104}Yb(){this.Pb(50)}eg(){this.kd(N=>!!N.pivotTableId&&!!N.pivotTableName)}}Object(e.a)(Xa,"PivotTableRefreshedEvent",A,[]);class gb extends sb{constructor(){super(168,1)}}Object(e.a)(gb,"PivotTableRenamedEvent",sb,[]);class Ha extends sb{constructor(){super(169,2)}}Object(e.a)(Ha,"PivotTableRowGrandTotalShownEvent",sb,[]);class tb extends sb{constructor(){super(181,14)}}Object(e.a)(tb,"PivotTableSaveSourceDataWithFileToggledEvent",
sb,[]);var bc=a(603);class tc extends A{constructor(){super()}get eventId(){return 155}Yb(){this.Pb(131)}eg(){this.kd(N=>{N=Object(L.a)(bc.a,N);return!!N&&!!N.AJa()&&!!N.hierarchyName})}}Object(e.a)(tc,"PivotTableSortedEvent",A,[]);class Ma extends sb{constructor(){super(185,18)}}Object(e.a)(Ma,"PivotTableSubTotalsVisibilitySettingSetEvent",sb,[]);class Tb extends A{constructor(){super()}get eventId(){return 206}Yb(){this.Pb(560)}}Object(e.a)(Tb,"PivotValueFieldSettingAppliedEvent",A,[]);class zb extends A{constructor(){super()}get eventId(){return 161}Yb(){this.Pb(243)}}
Object(e.a)(zb,"PrintAreaClearedEvent",A,[]);class ic extends A{constructor(){super()}get eventId(){return 159}Yb(){this.Pb(241)}eg(){this.kd(N=>!N.addToPrintArea)}}Object(e.a)(ic,"PrintAreaSetEvent",A,[]);class Qb extends A{constructor(){super()}get eventId(){return 57}Yb(){this.Pb(517)}}Object(e.a)(Qb,"RangeAutoFilterClearedEvent",A,[]);class wb extends A{constructor(N,Ka){super();this.Pea=N;this.IYd=Ka}get eventId(){return this.Pea}Yb(){this.Pb(11)}eg(){this.kd(N=>16===N.IY().ValidMembers);this.kd(N=>
N.IY().Font.ValidMembers===this.IYd)}}Object(e.a)(wb,"RangeFontFormattedEventBase",A,[]);class hc extends wb{constructor(){super(3,4)}}Object(e.a)(hc,"RangeBoldedEvent",wb,[]);class Za extends A{constructor(){super()}get eventId(){return 2}Yb(){this.Pb(11)}eg(){this.kd(N=>128===N.IY().ValidMembers)}}Object(e.a)(Za,"RangeBorderedEvent",A,[]);class ub{}ub.S9a="Table";ub.Mnc="Sheet";Object(e.a)(ub,"MacroRecorderEventConstants",null,[]);class uc extends A{constructor(){super()}get eventId(){return 113}Yb(){this.Pb(208)}eg(){this.kd(N=>
N.getParameters().FilterType===ub.Mnc)}}Object(e.a)(uc,"RangeCheckedItemsFilteredEvent",A,[]);class Oc extends A{constructor(){super()}get eventId(){return 109}Yb(){this.Pb(105)}}Object(e.a)(Oc,"RangeConditionalFormattingCreatedEvent",A,[]);class Bb extends A{constructor(){super()}get eventId(){return 124}Yb(){this.Pb(221)}}Object(e.a)(Bb,"RangeConditionalFormattingRuleDeletedEvent",A,[]);class Nb extends A{constructor(){super()}get eventId(){return 29}Yb(){this.Pb(508)}eg(){this.kd(N=>3===N.Xs()||
1===N.Xs()||4===N.Xs())}}Object(e.a)(Nb,"RangeContentClearedEvent",A,[]);class dc extends A{constructor(){super()}get eventId(){return 40}Yb(){this.Pb(104)}}Object(e.a)(dc,"RangeCopiedCutCellsInsertedEvent",A,[]);class sc extends A{constructor(){super()}get eventId(){return 114}Yb(){this.Pb(209)}eg(){this.kd(N=>N.getParameters().FilterType===ub.Mnc)}}Object(e.a)(sc,"RangeCustomFilteredEvent",A,[]);class yc extends A{constructor(){super()}get eventId(){return 106}Yb(){this.Pb(121)}}Object(e.a)(yc,
"RangeDataValidationChangedEvent",A,[]);class cd extends wb{constructor(){super(4,64)}}Object(e.a)(cd,"RangeDoubleUnderlinedEvent",wb,[]);class pd extends A{constructor(){super()}get eventId(){return 69}Yb(){this.Pb(190)}}Object(e.a)(pd,"RangeDuplicatesRemovedEvent",A,[]);class Rb extends A{constructor(){super()}get eventId(){return 1}Yb(){this.Pb(527);this.Pb(12)}}Object(e.a)(Rb,"RangeEditedEvent",A,[]);class Dc extends A{constructor(){super()}get eventId(){return 164}Yb(){this.Pb(255)}eg(){this.kd(N=>
4===N.actionType)}}Object(e.a)(Dc,"RangeExternalLinksBrokeAllLinksEvent",A,[]);class nd extends A{constructor(){super()}get eventId(){return 119}Yb(){this.Pb(255)}eg(){this.kd(N=>3===N.actionType)}}Object(e.a)(nd,"RangeExternalLinksBrokeLinkEvent",A,[]);class od extends A{constructor(){super()}get eventId(){return 205}Yb(){this.Pb(256)}Iva(){this.pke("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}Object(e.a)(od,"RangeExternalLinksChangeSourceEvent",A,[]);class wd extends A{constructor(){super()}get eventId(){return 163}Yb(){this.Pb(553)}eg(){this.kd(N=>
1===N.actionType)}}Object(e.a)(wd,"RangeExternalLinksRefreshedAllEvent",A,[]);class Pc extends A{constructor(){super()}get eventId(){return 77}Yb(){this.Pb(553)}eg(){this.kd(N=>0===N.actionType)}}Object(e.a)(Pc,"RangeExternalLinksRefreshedEvent",A,[]);class Hb extends A{constructor(){super()}get eventId(){return 165}Yb(){this.Pb(224)}}Object(e.a)(Hb,"RangeExternalLinksSetAutoRefreshEvent",A,[]);class Nc extends A{constructor(){super()}get eventId(){return 5}Yb(){this.Pb(11)}eg(){this.kd(N=>64===N.IY().ValidMembers)}}
Object(e.a)(Nc,"RangeFillColoredEvent",A,[]);class Db extends A{constructor(){super()}get eventId(){return 59}Yb(){this.Pb(155)}}Object(e.a)(Db,"RangeFilledEvent",A,[]);class Cc extends A{constructor(){super()}get eventId(){return 115}Yb(){this.Pb(176)}eg(){this.kd(N=>N.yU().AutoFilterType===ub.Mnc&&!!N.yU().CriteriaType)}}Object(e.a)(Cc,"RangeFilterAppliedEvent",A,[]);class Xc extends A{constructor(){super()}get eventId(){return 58}Yb(){this.Pb(176)}eg(){this.kd(N=>N.yU().AutoFilterType===ub.Mnc&&
!N.yU().CriteriaType)}}Object(e.a)(Xc,"RangeFilterClearedEvent",A,[]);class ld extends A{constructor(){super()}get eventId(){return 41}Yb(){this.Pb(518)}}Object(e.a)(ld,"RangeFilterReappliedEvent",A,[]);class Dd extends A{constructor(){super()}get eventId(){return 86}Yb(){this.Pb(150)}}Object(e.a)(Dd,"RangeFlashFilledEvent",A,[]);class Od extends wb{constructor(){super(6,32)}}Object(e.a)(Od,"RangeFontColoredEvent",wb,[]);class Qd extends wb{constructor(){super(7,8)}}Object(e.a)(Qd,"RangeFontItalicizedEvent",
wb,[]);class Nd extends wb{constructor(){super(8,1)}}Object(e.a)(Nd,"RangeFontNamedEvent",wb,[]);class he extends wb{constructor(){super(9,2)}}Object(e.a)(he,"RangeFontSizedEvent",wb,[]);class ve extends A{constructor(){super()}get eventId(){return 74}Yb(){this.Pb(215)}}Object(e.a)(ve,"RangeFormattedAsTableEvent",A,[]);class Td extends A{constructor(){super()}get eventId(){return 97}Yb(){this.Pb(188)}}Object(e.a)(Td,"RangeGroupedOrUngroupedEvent",A,[]);class ke extends A{constructor(){super()}get eventId(){return 60}Yb(){this.Pb(11)}eg(){this.kd(N=>
2===N.IY().ValidMembers)}}Object(e.a)(ke,"RangeHorizontallyAlignedEvent",A,[]);class xe extends A{constructor(){super()}get eventId(){return 43}Yb(){this.Pb(526)}}Object(e.a)(xe,"RangeHyperlinkAppliedEvent",A,[]);class le extends A{constructor(){super()}get eventId(){return 63}Yb(){this.Pb(11)}eg(){this.kd(N=>256===N.IY().ValidMembers)}}Object(e.a)(le,"RangeIndentChangedEvent",A,[]);class Je extends A{constructor(){super()}get eventId(){return 53}Yb(){this.Pb(156)}eg(){this.kd(N=>2===N.Xs()||5===
N.Xs()||6===N.Xs()||7===N.Xs())}}Object(e.a)(Je,"RangeMergedEvent",A,[]);class Fe extends A{constructor(){super()}get eventId(){return 107}Yb(){this.Pb(216)}}Object(e.a)(Fe,"RangeNamedCellStyleAppliedEvent",A,[]);class eb extends A{constructor(){super()}get eventId(){return 12}Yb(){this.Pb(11)}eg(){this.kd(N=>32===N.IY().ValidMembers)}}Object(e.a)(eb,"RangeNumberFormattedEvent",A,[]);var Xb=a(954);class oc extends A{constructor(){super()}get eventId(){return 108}Yb(){this.Pb(141)}eg(){this.kd(N=>
Object(K.a)(Xb.a,N))}}Object(e.a)(oc,"RangeSortedEvent",A,[]);class Gc extends wb{constructor(){super(10,128)}}Object(e.a)(Gc,"RangeStrikedThroughEvent",wb,[]);class Vc extends wb{constructor(){super(11,16)}}Object(e.a)(Vc,"RangeUnderlinedEvent",wb,[]);class P extends A{constructor(){super()}get eventId(){return 61}Yb(){this.Pb(11)}eg(){this.kd(N=>1===N.IY().ValidMembers)}}Object(e.a)(P,"RangeVerticallyAlignedEvent",A,[]);class Ta extends A{constructor(){super()}get eventId(){return 62}Yb(){this.Pb(11)}eg(){this.kd(N=>
8===N.IY().ValidMembers)}}Object(e.a)(Ta,"RangeWrapTextToggledEvent",A,[]);class pb extends A{constructor(){super()}get eventId(){return 103}Yb(){this.Pb(51)}}Object(e.a)(pb,"RefreshedAllEvent",A,[]);class Yb extends A{constructor(){super()}get eventId(){return 47}Yb(){this.Pb(148)}}Object(e.a)(Yb,"ReplaceAllEvent",A,[]);class Ac extends A{constructor(){super()}get eventId(){return 91}Yb(){this.Pb(532)}eg(){this.kd(N=>95!==N.getShapeType()&&96!==N.getShapeType()&&97!==N.getShapeType()&&98!==N.getShapeType()&&
100!==N.getShapeType()&&102!==N.getShapeType()&&103!==N.getShapeType())}}Object(e.a)(Ac,"ShapeInsertedEvent",A,[]);class Zc extends A{constructor(){super()}get eventId(){return 92}Yb(){this.Pb(531)}}Object(e.a)(Zc,"ShapeStyleSetEvent",A,[]);var id=a(809);class gd extends A{constructor(N,Ka){super();this.Pea=N;this.IYd=Ka}get eventId(){return this.Pea}Yb(){this.Pb(581)}eg(){this.kd(N=>Object(K.a)(id.a,N)&&4===N.getShapeTextFormat().ValidMembers);this.kd(N=>Object(K.a)(id.a,N)&&N.getShapeTextFormat().Font.ValidMembers===
this.IYd)}}Object(e.a)(gd,"ShapeTextFontFormattedEventBase",A,[]);class Ub extends gd{constructor(){super(193,4)}}Object(e.a)(Ub,"ShapeTextBoldedEvent",gd,[]);var Lc=a(956);class hd extends A{constructor(){super()}get eventId(){return 191}Yb(){this.Pb(581)}eg(){this.kd(N=>Object(K.a)(Lc.a,N))}}Object(e.a)(hd,"ShapeTextChangedEvent",A,[]);class Kd extends gd{constructor(){super(196,32)}}Object(e.a)(Kd,"ShapeTextFontColorChangedEvent",gd,[]);class Wd extends gd{constructor(){super(197,1)}}Object(e.a)(Wd,
"ShapeTextFontNameChangedEvent",gd,[]);class oe extends gd{constructor(){super(198,2)}}Object(e.a)(oe,"ShapeTextFontSizeChangedEvent",gd,[]);class We extends A{constructor(){super()}get eventId(){return 199}Yb(){this.Pb(581)}eg(){this.kd(N=>Object(K.a)(id.a,N)&&2===N.getShapeTextFormat().ValidMembers)}}Object(e.a)(We,"ShapeTextHorizontallyAlignedEvent",A,[]);class Ze extends gd{constructor(){super(194,8)}}Object(e.a)(Ze,"ShapeTextItalicizedEvent",gd,[]);class Be extends gd{constructor(){super(195,
16)}}Object(e.a)(Be,"ShapeTextUnderlinedEvent",gd,[]);class af extends A{constructor(){super()}get eventId(){return 200}Yb(){this.Pb(581)}eg(){this.kd(N=>Object(K.a)(id.a,N)&&1===N.getShapeTextFormat().ValidMembers)}}Object(e.a)(af,"ShapeTextVerticallyAlignedEvent",A,[]);class ff extends A{constructor(){super()}get eventId(){return 13}Yb(){this.Pb(138)}}Object(e.a)(ff,"SheetAddedEvent",A,[]);var Pe=a(8);class Ne extends A{constructor(){super()}get eventId(){return 142}Yb(){this.Pb(237)}eg(){this.kd(N=>
!!N.insertDeleteMultiRangeParameters);this.kd(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(N=>{N=N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>N.DeltaColumn&&!N.DeltaRow&&(!!N.InsertDeleteRange.FirstRow||N.InsertDeleteRange.LastRow!==Pe.a.Az)||!N.DeltaColumn&&0>N.DeltaRow&&(!!N.InsertDeleteRange.FirstColumn||N.InsertDeleteRange.LastColumn!==Pe.a.rw)})}}Object(e.a)(Ne,"SheetCellsDeletedEvent",A,[]);class se extends A{constructor(){super()}get eventId(){return 143}Yb(){this.Pb(237)}eg(){this.kd(N=>
!!N.insertDeleteMultiRangeParameters);this.kd(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(N=>{N=N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<N.DeltaColumn&&!N.DeltaRow&&(!!N.InsertDeleteRange.FirstRow||N.InsertDeleteRange.LastRow!==Pe.a.Az)||!N.DeltaColumn&&0<N.DeltaRow&&(!!N.InsertDeleteRange.FirstColumn||N.InsertDeleteRange.LastColumn!==Pe.a.rw)})}}Object(e.a)(se,"SheetCellsInsertedEvent",A,[]);class Wa extends A{constructor(){super()}get eventId(){return 139}Yb(){this.Pb(237)}eg(){this.kd(N=>
!!N.insertDeleteMultiRangeParameters);this.kd(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(N=>0>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.kd(N=>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===Pe.a.Az)}}Object(e.a)(Wa,"SheetColumnDeletedEvent",
A,[]);class Sb extends A{constructor(){super()}get eventId(){return 138}Yb(){this.Pb(237)}eg(){this.kd(N=>!!N.insertDeleteMultiRangeParameters);this.kd(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(N=>0<N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.kd(N=>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
Pe.a.Az)}}Object(e.a)(Sb,"SheetColumnInsertedEvent",A,[]);class wc extends A{constructor(){super()}get eventId(){return 14}Yb(){this.Pb(137)}}Object(e.a)(wc,"SheetDeletedEvent",A,[]);class Uc extends A{constructor(){super()}get eventId(){return 137}Yb(){this.Pb(185)}}Object(e.a)(Uc,"SheetDirectionChangedEvent",A,[]);class ob extends A{constructor(){super()}get eventId(){return 54}Yb(){this.Pb(139)}}Object(e.a)(ob,"SheetDuplicatedEvent",A,[]);class Zb extends A{constructor(){super()}get eventId(){return 15}Yb(){this.Pb(207)}}
Object(e.a)(Zb,"SheetNameEditedEvent",A,[]);class Bc extends A{constructor(){super()}get eventId(){return 90}Yb(){this.Pb(151)}}Object(e.a)(Bc,"SheetPaneFrozenEvent",A,[]);class bd extends A{constructor(){super()}get eventId(){return 120}Yb(){this.Pb(226)}}Object(e.a)(bd,"SheetPrintSettingsSavedEvent",A,[]);var Ed=a(853);class ge extends A{constructor(){super()}get eventId(){return 215}Yb(){this.Pb(507)}Iva(){this.pke("Microsoft.Office.Excel.SheetProtectionMacroRecording")}eg(){this.kd(N=>Object.getType(N)===
Ed.a)}}Object(e.a)(ge,"SheetProtectionPausedResumedEvent",A,[]);class be extends A{constructor(){super()}get eventId(){return 64}Yb(){this.Pb(557)}}Object(e.a)(be,"SheetReorderedEvent",A,[]);class qe extends A{constructor(){super()}get eventId(){return 141}Yb(){this.Pb(237)}eg(){this.kd(N=>!!N.insertDeleteMultiRangeParameters);this.kd(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(N=>0>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);
this.kd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.kd(N=>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Pe.a.rw)}}Object(e.a)(qe,"SheetRowDeletedEvent",A,[]);class ze extends A{constructor(){super()}get eventId(){return 140}Yb(){this.Pb(237)}eg(){this.kd(N=>!!N.insertDeleteMultiRangeParameters);this.kd(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.kd(N=>0<N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.kd(N=>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Pe.a.rw)}}Object(e.a)(ze,"SheetRowInsertedEvent",A,[]);class Ce extends A{constructor(){super()}get eventId(){return 39}Yb(){this.Pb(135)}}Object(e.a)(Ce,"SheetRowsColumnsAutoFitEvent",A,[]);class Ve extends A{constructor(){super()}get eventId(){return 36}Yb(){this.Pb(136)}}
Object(e.a)(Ve,"SheetRowsColumnsResizedEvent",A,[]);class we extends A{constructor(){super()}get eventId(){return 68}Yb(){this.Pb(183)}}Object(e.a)(we,"SheetShowGridlinesToggledEvent",A,[]);class vc extends A{constructor(){super()}get eventId(){return 67}Yb(){this.Pb(184)}}Object(e.a)(vc,"SheetShowHeadingsToggledEvent",A,[]);class ed extends A{constructor(){super()}get eventId(){return 89}Yb(){this.Pb(213)}}Object(e.a)(ed,"SheetSpellCheckedEvent",A,[]);class Id extends A{constructor(){super()}get eventId(){return 70}Yb(){this.Pb(515)}}
Object(e.a)(Id,"SheetTabColoredEvent",A,[]);class Ld extends A{constructor(){super()}get eventId(){return 71}Yb(){this.Pb(157)}}Object(e.a)(Ld,"SheetVisibilityChangedEvent",A,[]);class ce extends A{constructor(){super()}get eventId(){return 126}Yb(){this.Pb(239)}}Object(e.a)(ce,"SheetsVisibilityChangedEvent",A,[]);class la extends A{constructor(){super()}get eventId(){return 188}Yb(){this.Pb(203)}}Object(e.a)(la,"SlicerInsertedEvent",A,[]);class jb extends A{constructor(){super()}get eventId(){return 189}Yb(){this.Pb(173)}eg(){this.kd(N=>
!N.clearFilter)}}Object(e.a)(jb,"SlicerSelectionAppliedEvent",A,[]);class ra extends A{constructor(){super()}get eventId(){return 190}Yb(){this.Pb(173)}eg(){this.kd(N=>N.clearFilter)}}Object(e.a)(ra,"SlicerSelectionClearedEvent",A,[]);class hb extends A{constructor(){super()}get eventId(){return 27}Yb(){this.Pb(208)}eg(){this.kd(N=>N.getParameters().FilterType===ub.S9a)}}Object(e.a)(hb,"TableCheckedItemsFilteredEvent",A,[]);class Eb extends A{constructor(){super()}get eventId(){return 144}Yb(){this.Pb(237)}eg(){this.kd(N=>
!!N.insertDeleteMultiRangeParameters);this.kd(N=>N.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(N=>0>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(Eb,"TableColumnDeletedEvent",A,[]);class fc extends A{constructor(){super()}get eventId(){return 145}Yb(){this.Pb(237)}eg(){this.kd(N=>!!N.insertDeleteMultiRangeParameters);this.kd(N=>N.insertDeleteMultiRangeParameters.IsTableCommand);
this.kd(N=>0<N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(fc,"TableColumnInsertedEvent",A,[]);var Mc=a(955);class xd extends A{constructor(){super()}get eventId(){return 121}Yb(){this.Pb(141)}eg(){this.kd(N=>Object(K.a)(Mc.a,N))}}Object(e.a)(xd,"TableColumnSortedEvent",A,[]);class Hd extends A{constructor(){super()}get eventId(){return 105}Yb(){this.Pb(193)}}Object(e.a)(Hd,
"TableConvertedToRangeEvent",A,[]);class Md extends A{constructor(){super()}get eventId(){return 16}Yb(){this.Pb(206)}}Object(e.a)(Md,"TableCreatedEvent",A,[]);class ae extends A{constructor(){super()}get eventId(){return 30}Yb(){this.Pb(209)}eg(){this.kd(N=>N.getParameters().FilterType===ub.S9a)}}Object(e.a)(ae,"TableCustomFilteredEvent",A,[]);class me extends A{constructor(){super()}get eventId(){return 25}Yb(){this.Pb(187)}eg(){this.kd(N=>1===N.options.OperationType)}}Object(e.a)(me,"TableCustomSortedEvent",
A,[]);class Re extends A{constructor(){super()}get eventId(){return 28}Yb(){this.Pb(176)}eg(){this.kd(N=>N.yU().AutoFilterType===ub.S9a);this.kd(N=>0===N.yU().CriteriaType)}}Object(e.a)(Re,"TableFilterClearedEvent",A,[]);class Xe extends A{constructor(){super()}get eventId(){return 32}Yb(){this.Pb(176)}eg(){this.kd(N=>N.yU().AutoFilterType===ub.S9a);this.kd(N=>{const Ka=new l.a;Ka.add(1);Ka.add(2);Ka.add(8);Ka.add(9);Ka.add(10);Ka.add(11);Ka.add(12);Ka.add(13);Ka.add(14);Ka.add(15);Ka.add(16);Ka.add(17);
Ka.add(18);Ka.add(19);Ka.add(20);Ka.add(21);Ka.add(22);Ka.add(23);Ka.add(24);Ka.add(25);Ka.add(26);Ka.add(27);Ka.add(28);Ka.add(29);Ka.add(30);Ka.add(31);Ka.add(32);Ka.add(33);Ka.add(34);Ka.add(35);Ka.add(36);Ka.add(37);Ka.add(38);Ka.add(39);return Ka.contains(N.yU().CriteriaType)})}}Object(e.a)(Xe,"TableItemFilteredEvent",A,[]);class qf extends A{constructor(){super()}get eventId(){return 101}Yb(){this.Pb(217)}}Object(e.a)(qf,"TableRenamedEvent",A,[]);class uf extends A{constructor(){super()}get eventId(){return 73}Yb(){this.Pb(211)}}
Object(e.a)(uf,"TableResizedEvent",A,[]);class Cf extends A{constructor(){super()}get eventId(){return 44}Yb(){this.Pb(514)}}Object(e.a)(Cf,"TableRowColumnRearrangedEvent",A,[]);class Jf extends A{constructor(){super()}get eventId(){return 146}Yb(){this.Pb(237)}eg(){this.kd(N=>!!N.insertDeleteMultiRangeParameters);this.kd(N=>N.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(N=>0>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}
Object(e.a)(Jf,"TableRowDeletedEvent",A,[]);class Uf extends A{constructor(){super()}get eventId(){return 147}Yb(){this.Pb(237)}eg(){this.kd(N=>!!N.insertDeleteMultiRangeParameters);this.kd(N=>N.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(N=>0<N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(Uf,"TableRowInsertedEvent",A,[]);class cg extends A{constructor(){super()}get eventId(){return 26}Yb(){this.Pb(177)}eg(){this.kd(N=>
N.yU().AutoFilterType===ub.S9a)}}Object(e.a)(cg,"TableSortedEvent",A,[]);class wg extends A{constructor(){super()}get eventId(){return 87}Yb(){this.Pb(212)}}Object(e.a)(wg,"TableStyleAppliedEvent",A,[]);class Vf extends A{constructor(){super()}get eventId(){return 88}Yb(){this.Pb(196)}}Object(e.a)(Vf,"TableStyleOptionToggledEvent",A,[]);class Da extends A{constructor(){super()}get eventId(){return 31}Yb(){this.Pb(210)}eg(){this.kd(N=>N.getParameters().FilterType===ub.S9a)}}Object(e.a)(Da,"TableTop10FilteredEvent",
A,[]);class Fb extends A{constructor(){super()}get eventId(){return 207}Yb(){this.Pb(238)}}Object(e.a)(Fb,"TextToColumnsEvent",A,[]);class Fc extends A{constructor(){super()}get eventId(){return 128}Yb(){this.Pb(559)}}Object(e.a)(Fc,"ValuesSortedEvent",A,[]);class jd extends A{constructor(){super()}get eventId(){return 55}Yb(){this.Pb(197)}}Object(e.a)(jd,"WorkbookCalculationModeSetEvent",A,[]);class Ad extends A{constructor(){super()}get eventId(){return 34}Yb(){this.Pb(181)}eg(){this.kd(N=>!!N.parentCommentId)}}
Object(e.a)(Ad,"WorkbookCommentRepliedEvent",A,[]);class Ud extends A{constructor(){super()}get eventId(){return 33}Yb(){this.Pb(181)}eg(){this.kd(N=>!N.parentCommentId)}}Object(e.a)(Ud,"WorkbookCommentedEvent",A,[]);class ue extends A{constructor(){super()}get eventId(){return 56}Yb(){this.Pb(128)}}Object(e.a)(ue,"WorkbookRecalculatedEvent",A,[]);class re extends A{constructor(){super()}get eventId(){return 46}Yb(){this.Pb(171)}}Object(e.a)(re,"WorkbookRedoEvent",A,[]);class Ue extends A{constructor(){super()}get eventId(){return 45}Yb(){this.Pb(170)}}
Object(e.a)(Ue,"WorkbookUndoEvent",A,[]);class Ie extends A{constructor(){super()}get eventId(){return 116}Yb(){this.Pb(507);this.Pb(576);this.Pb(10)}eg(){this.kd(N=>{if(Object(K.a)(W,N)&&(N=Object(L.a)(W,N),void 0!==N.source&&null!==N.source&&void 0!==N.eventId&&null!==N.eventId))return n.ULS.sendTraceTag(537155426,0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${N.source}; eventId: ${N.eventId}.`),!0;n.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");
return!1})}}Object(e.a)(Ie,"DefaultRichApiRequestExecutedEvent",A,[]);class bf extends A{constructor(){super()}get eventId(){return 216}Yb(){this.Pb(1022)}}Object(e.a)(bf,"TablelAltTextEditedEvent",A,[]);class Ee extends A{constructor(){super()}get eventId(){return 217}Yb(){this.Pb(263)}}Object(e.a)(Ee,"FloatingObjectZOrderChangedEvent",A,[]);var zf=a(957);class Af extends A{constructor(){super()}get eventId(){return 192}Yb(){this.Pb(507)}eg(){this.kd(N=>Object(K.a)(zf.a,N)?!0:!1)}}Object(e.a)(Af,
"VisualPropertySetEvent",A,[]);class Mf{constructor(N){this.yb=null;this.$=N}get macroRecorderEvents(){this.yb||(this.yb=new l.a,this.yb.add(new Rb),this.yb.add(new Za),this.yb.add(new hc),this.yb.add(new cd),this.yb.add(new Nc),this.yb.add(new Od),this.yb.add(new Qd),this.yb.add(new Nd),this.yb.add(new he),this.yb.add(new Gc),this.yb.add(new Vc),this.yb.add(new eb),this.yb.add(new ff),this.yb.add(new wc),this.yb.add(new Zb),this.yb.add(new Md),this.yb.add(new Eb),this.yb.add(new fc),this.yb.add(new Jf),
this.yb.add(new Uf),this.yb.add(new Sb),this.yb.add(new Wa),this.yb.add(new ze),this.yb.add(new qe),this.yb.add(new me),this.yb.add(new cg),this.yb.add(new hb),this.yb.add(new Re),this.yb.add(new Nb),this.yb.add(new ae),this.yb.add(new Da),this.yb.add(new Xe),this.yb.add(new Ud),this.yb.add(new Ad),this.yb.add(new nc),this.yb.add(new Ve),this.yb.add(new Ne),this.yb.add(new se),this.yb.add(new Ce),this.yb.add(new dc),this.yb.add(new ld),this.yb.add(new xe),this.yb.add(new Ea),this.yb.add(new Cf),this.yb.add(new re),
this.yb.add(new Ue),this.yb.add(new Yb),this.yb.add(new Ra),this.yb.add(new rb),this.yb.add(new Je),this.yb.add(new ob),this.yb.add(new jd),this.yb.add(new ue),this.yb.add(new Qb),this.yb.add(new Xc),this.yb.add(new Db),this.yb.add(new ke),this.yb.add(new P),this.yb.add(new Ta),this.yb.add(new le),this.yb.add(new be),this.yb.add(new U),this.yb.add(new O),this.yb.add(new vc),this.yb.add(new we),this.yb.add(new pd),this.yb.add(new Ld),this.yb.add(new Id),this.yb.add(new uf),this.yb.add(new ve),this.yb.add(new R),
this.yb.add(new M),this.yb.add(new Pc),this.yb.add(new pa),this.yb.add(new oa),this.yb.add(new D),this.yb.add(new ea),this.yb.add(new J),this.yb.add(new G),this.yb.add(new H),this.yb.add(new qa),this.yb.add(new Dd),this.yb.add(new wg),this.yb.add(new Vf),this.yb.add(new ed),this.yb.add(new Bc),this.yb.add(new Ac),this.yb.add(new Zc),this.yb.add(new Ba),this.yb.add(new fa),this.yb.add(new Y),this.yb.add(new Ga),this.yb.add(new Td),this.yb.add(new vb),this.yb.add(new bb),this.yb.add(new ja),this.yb.add(new qf),
this.yb.add(new va),this.yb.add(new pb),this.yb.add(new Xa),this.yb.add(new Hd),this.yb.add(new yc),this.yb.add(new Fe),this.yb.add(new oc),this.yb.add(new Oc),this.yb.add(new cc),this.yb.add(new Wb),this.yb.add(new Kb),this.yb.add(new uc),this.yb.add(new sc),this.yb.add(new Cc),this.yb.add(new X),this.yb.add(new ma),this.yb.add(new nd),this.yb.add(new bd),this.yb.add(new xd),this.yb.add(new Bb),this.yb.add(new ce),this.yb.add(new ia),this.yb.add(new Fc),this.yb.add(new Z),this.yb.add(new I),this.yb.add(new Pa),
this.yb.add(new wa),this.yb.add(new ua),this.yb.add(new ya),this.yb.add(new ta),this.yb.add(new Uc),this.yb.add(new xa),this.yb.add(new nb),this.yb.add(new fb),this.yb.add(new ca),this.yb.add(new tc),this.yb.add(new mb),this.yb.add(new Ca),this.yb.add(new $a),this.yb.add(new ic),this.yb.add(new F),this.yb.add(new zb),this.yb.add(new sa),this.yb.add(new wd),this.yb.add(new Dc),this.yb.add(new Hb),this.yb.add(new ib),this.yb.add(new Ya),this.yb.add(new gb),this.yb.add(new Ha),this.yb.add(new Sa),this.yb.add(new Ua),
this.yb.add(new Va),this.yb.add(new Na),this.yb.add(new Ja),this.yb.add(new Jb),this.yb.add(new Pb),this.yb.add(new Oa),this.yb.add(new yb),this.yb.add(new Ob),this.yb.add(new Ab),this.yb.add(new tb),this.yb.add(new db),this.yb.add(new na),this.yb.add(new ab),this.yb.add(new Ma),this.yb.add(new Lb),this.yb.add(new lb),this.yb.add(new la),this.yb.add(new jb),this.yb.add(new ra),this.yb.add(new hd),this.yb.add(new Ub),this.yb.add(new Ze),this.yb.add(new Be),this.yb.add(new Kd),this.yb.add(new Wd),this.yb.add(new oe),
this.yb.add(new We),this.yb.add(new af),this.yb.add(new od),this.yb.add(new Tb),this.yb.add(new Fb),this.yb.add(new ge),this.yb.add(new bf),this.yb.add(new Ee),this.yb.add(new Af),z.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.C9i());return this.yb}yZe(N,Ka){let Cb=this.zZe(N,this.macroRecorderEvents,Ka);Cb||(Cb=this.zZe(N,Mf.s_h(),Ka),!Cb&&this.Sdf(N,Mf.CFe,Ka)&&(Cb=Mf.CFe));return Cb}zZe(N,Ka,Cb){const jc=new l.a;for(let Kc of Ka)this.Sdf(N,Kc,Cb)&&jc.add(Kc);
return 1===jc.count?jc.na(0):1<jc.count?Mf.RHh(jc):null}Sdf(N,Ka,Cb){const jc=Mf.vUi(N,Ka);return Cb?jc&&Mf.vVj(N,Ka):jc}C9i(){const N=new l.a;for(let Ka of this.yb){let Cb=!1;for(let jc of Ka.featureGates)if(!z.EwaSettings.ma(jc)){N.add(Ka);Cb=!0;break}if(!Cb)for(let jc of Ka.NQe)if(!z.EwaSettings.getBooleanFeatureGate(jc,!1)){N.add(Ka);break}}for(let Ka of N)this.yb.remove(Ka)}static s_h(){Mf.WBb||(Mf.WBb=new l.a,Mf.WBb.add(new da),Mf.WBb.add(new aa));return Mf.WBb}static vUi(N,Ka){return Ka.operations.contains(N.operation)}static vVj(N,
Ka){Ka=Ka.zBc;if(!Ka.count)return!0;let Cb=!0;for(let jc of Ka)if(!jc(N.payload)){Cb=!1;break}return Cb}static RHh(N){let Ka=N.na(0);for(let Cb of N)Cb.zBc.count>Ka.zBc.count&&(Ka=Cb);return Ka}}Mf.WBb=null;Mf.CFe=new Ie;Object(e.a)(Mf,"MacroRecorderEventList",null,[]);class mg extends k.a{constructor(N){super();this.$=N;this.Fb()}create(){this.qb(this.$.da.za(297)||new B(this.$,new Mf(this.$),new v))}static ka(N){N.da.Ga(298,new mg(N))}}Object(e.a)(mg,"MacroRecorderEventHandlerFactory",k.a,[]);var Qa=
a(1140),xb=a(1233),ac=a(7);a(557);class zc{constructor(){this.Elg=new l.a}get c0b(){return this.Elg}fSh(N){n.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",N);const Ka=new l.a;for(let Cb of this.c0b)for(let jc of Cb.hDb)jc.id===N&&Ka.add(jc);return Ka}bke(N){this.c0b.add(N)}x9i(N){for(let Ka of this.c0b)if(Ka.boe===N.boe){this.c0b.remove(Ka);break}}static Meh(N,Ka,Cb=null){N=zc.tKh(N);0<N.length&&(zc.Vuc(N,!1),Cb&&Cb(Ka,N))}static tKh(N){const Ka=[];if(N&&N.hDb&&0<N.hDb.count)for(let Cb of N.hDb)if(Cb.controls&&
0<Cb.controls.count)for(let jc of Cb.controls)if(jc.menuItems&&0<jc.menuItems.count)for(let Kc of jc.menuItems)Array.add(Ka,Kc.id);return Ka}static Vuc(N,Ka){if(N.length){var Cb=[];for(const jc of N)Cb.push(appChrome.actions.updateControlEnabledDisabledState(jc,Ka));appChrome.api.dispatch(Cb)}}}Object(e.a)(zc,"ContextMenuExtensibilityCache",null,[867,868]);var Yc=a(1453),md=a(83),sd=a(4),h=a(860),Ib=a(806);class ec{SXa(N,Ka=null){if(N=Ib.a.L2a(N)){appChrome.addInApi.dispatchActionsToInstallAddIn(N,
Ka);for(const Cb of N.tabs)if(Cb.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(N,()=>{});break}}}YHd(N){(N=Ib.a.L2a(N))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(N)}static Ueh(N,Ka,Cb=null){N=ec.eVh(N);0<N.length&&(ec.Vuc(N,!1),Cb&&Cb(Ka,N))}static eVh(N){const Ka=[];if(N&&(N=N.oV,N.Is&&0<N.Is.count))for(let Cb of N.Is)if(Cb.groups&&0<Cb.groups.length)for(const jc of Cb.groups)if(jc.controls&&0<jc.controls.length)for(const Kc of jc.controls)Array.add(Ka,Kc.id);return Ka}static Vuc(N){if(N.length){var Ka=
[];for(const Cb of N)Ka.push(appChrome.actions.updateControlEnabledDisabledState(Cb,!0));appChrome.api.dispatch(Ka)}}}Object(e.a)(ec,"OneLineRibbonExtensibilityManager",null,[898]);var Ec=a(933);class fd{constructor(){this.d1d=this.SCc=null}get hSc(){return this.SCc||(this.SCc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set hSc(N){this.SCc=N}get JMg(){return this.d1d||(this.d1d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromAssetIdRuntimeId(N,
Ka){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(N,Ka)}Egd(N,Ka,Cb,jc,Kc,kd=null,qd=null){n.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",N);if((N=Ka.nia(Kc.ownerAddinInfo.storeType,Kc.ownerAddinInfo.solutionId))&&N.sB&&!N.sB.getIsUpgrading())if(Ka=null,0<N.sB.getNotificationParams().length&&(Ka=this.Bte(N.sB.getNotificationParams()[0]))&&2147758681===Ka.errorCode&&(N.isUpgraded=!0),2!==N.sB.getStatus()&&(1!==N.sB.getStatus()||Ka&&2147758681===Ka.errorCode))Ka&&
this.i2f(N,Ka,qd);else try{Cb.setOwnerAddinEToken(N.sB.getEToken()),Kc.action(Cb,jc.eca),kd&&kd()}catch(yd){n.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",sd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?yd.stack:yd.message)),Ec.a.HQd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}i2f(N,Ka,Cb=null){const jc=N.sB;if(1===jc.getNotificationParams().length||Ka.Fcc){const Kc=
Ka.Oga,kd=Ka.Kha;Ka.Oga=()=>{jc.removeFirstNotification();if(0<jc.getNotificationParams().length){const qd=this.Bte(jc.getNotificationParams()[0]);this.i2f(N,qd)}2147758681===Ka.errorCode&&(ec.Ueh(N.Do,jc,Object(md.a)(this,this.t9e,"initUpgradeStateDetectTask")),zc.Meh(N.hqb,jc,Object(md.a)(this,this.t9e,"initUpgradeStateDetectTask")));Kc&&Kc()};Ka.Kha=()=>{kd&&kd();Cb&&Cb()};Ec.a.JQd(Ka)}}t9e(N,Ka){let Cb=null;Cb=()=>{N.getIsUpgrading()?window.setTimeout(Cb,1E3):N.getUpgradingFailed()?ec.Vuc(Ka,
!0):sd.AFrameworkApplication.ta.updateCommandUI()};window.setTimeout(Cb,1E3)}Bte(N){const Ka=new h.a;Ka.aLa=N.infoType;Ka.id=N.id;Ka.title=N.title;Ka.description=N.description;Ka.buttonText=N.buttonTxt;Ka.Oga=N.buttonCallback;Ka.Fcc=N.highPriority;Ka.Kha=N.dismissCallback;Ka.errorCode=N.errorCode;Ka.u8e=N.iframeNotificationUrl;return Ka}}Object(e.a)(fd,"AddinCommandsActionHandler",null,[872]);var Cd=a(82),Gd=a(155),Yd=a(691),fe=a(5),Le=a(734),te=a(692);class rf{constructor(N,Ka){this.Sa=N;this.x1g=
Ka}XEh(N){if(void 0!==N&&null!==N&&N===fe.a.IAe)N="ContextMenuCell";else return null;const Ka=this.Sa.zc();this.oEh(Ka,N);return Ka}oEh(N,Ka){Ka=this.x1g.fSh(Ka);for(let Cb of Ka){Ka=Cb.controls;for(let jc of Ka)this.aEh(N,jc)}}aEh(N,Ka){var Cb=Ka.HT[Le.a.id];const jc=Ka.HT[Le.a.TTa],Kc=Ka.HT[Le.a.WTa];let kd="Image16by16",qd=Ka.HT[Le.a.UTa];te.c(Kc)&&(kd="None");0<Ka.menuItems.count?(Cb=this.Sa.Ru(Cb,Cb,jc,798637440),Cb.cKb(kd,Kc,null),this.VEh(Cb.menu,Ka),N.buttons.push(Cb)):N.buttons.push(this.Sa.bHa(Cb,
jc,qd,Kc,kd,null,!1))}VEh(N,Ka){const Cb=this.Sa.zc();for(let jc of Ka.menuItems){Ka=jc.Rka[Le.a.id];const Kc=jc.Rka[Le.a.TTa],kd=jc.Rka[Le.a.WTa];let qd="Image16by16";const yd=jc.Rka[Le.a.UTa];te.c(kd)&&(qd="None");Ka=this.Sa.bHa(Ka,Kc,yd,kd,qd,null,!1);Cb.buttons.push(Ka)}N.nc.push(Cb)}}Object(e.a)(rf,"AddInCommandsContextMenuExtensibilityHandler",null,[837]);var Fa=a(855);class Mb{constructor(){this.mi=null;this.visible=!1}}Object(e.a)(Mb,"AddinStatusCommandValues",null,[]);class gc{static C1i(N){const Ka=
new Mb;Ka.mi=N.nYa;Ka.visible=Ka.mi?!0:!1;return Ka}static Hwc(N,Ka,Cb,jc,Kc){const kd=document.getElementById(Cb);kd?gc.Xzj(N,Ka,kd,jc,Kc):n.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Cb))}static Xzj(N,Ka,Cb,jc,Kc){Cb?N.nYa===CommonUIStrings.l_ErrorLoadingAddInsTitle?Ec.a.Jyj(Ka,Cb,jc,Kc):N.nYa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&Ec.a.bAj(Ka,Cb):n.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}
Object(e.a)(gc,"AddinCommandsStatusHandler",null,[]);var Qc=a(38),Sc=a(224),ud=a(14);class Zd extends Qc.a{constructor(N,Ka){super();this.agaveCommandManager=this.statusBarManager=null;this.Mxe=()=>{this.UF&&this.UF.qxe()};this.S3e=()=>{this.raiseEvent("LAC")};this.Xc=(Cb,jc)=>{!Cb.fc&&Sc.b(jc)&&this.statusBarManager&&(this.statusBarManager.PF(this),this.statusBarManager=null)};this.UF=Ka;this.$=N;this.UEj=N.Bb+"OfficeAddinLabel-Medium14";this.$.da.Za(29,Cb=>{this.statusBarManager=Cb;Cb.oJ(this)});
this.$.ea.jk(this.Xc);this.UF.mDg(this.S3e);this.$.da.Za(206,Cb=>{this.agaveCommandManager=Cb;Cb.NEg(this.Mxe)})}qq(N){this.addHandler("LAC",N)}Oq(N){this.removeHandler("LAC",N)}Rr(N,Ka){if("QueryAddinLabel"!==N)return!1;Ka[Fa.a.LabelText]!==this.UF.nYa&&(N=gc.C1i(this.UF),Ka[Fa.a.LabelText]=N.mi,Ka[Fa.a.Visible]=N.visible,window.setTimeout(()=>{this.Hwc()},0));return!0}nn(){return!0}Hwc(){this.$&&gc.Hwc(this.UF,this.$.domElement,this.UEj,ud.a.instance.ga(338),ud.a.instance.ga(339))}dispose(){this.$.ea.Ik(this.Xc);
this.UF.H$i(this.S3e);this.agaveCommandManager&&(this.agaveCommandManager.Taj(this.Mxe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.PF(this),this.statusBarManager=null);this.UF=this.$=null;super.dispose()}}Object(e.a)(Zd,"AddinCommandsStatusBarManager",Qc.a,[191,192]);var ne=a(1307),Rd=a(717),ie=a(146),Ae=a(124),Se=a(569),Ff=a(136);class $f{constructor(){this.mYa=null}setErrorMessageForAddin(N,Ka){this.mYa||(this.mYa={});this.mYa[N]=Ka}LMh(N){return this.mYa&&N in
this.mYa?this.mYa[N]:null}}Object(e.a)($f,"AddinCommandsErrorManager",null,[]);var za=a(328),Aa=a(95);class xc{constructor(){this.Gq=this.KN=0;this.wUc=null;this.Cpc=this.nzc=0;this.Toa=this.DHc=this.iDc=this.w2b=this.Gia=this.c9=null}get une(){this.iDc||(this.iDc=new l.a);return this.iDc}get Rad(){this.DHc||(this.DHc=new l.a);return this.DHc}get TGa(){this.Toa||(this.Toa=new l.a);return this.Toa}}Object(e.a)(xc,"AddinCommandsListLoaderContext",null,[]);var zd=a(812);class de{}Object(e.a)(de,"AppsForOfficeEntitlementQueryInfo",
null,[]);var pe=a(41);const $e=N=>{const Ka={};Ka.solutionId=N.solutionId;Ka.version=N.version;Ka.storeType=N.storeType;Ka.storeId=N.storeId;Ka.assetId=N.assetId;Ka.assetStoreId=N.assetStoreId;Ka.targetType=N.targetType;Ka.requireConsent=N.requireConsent||!1;Ka.isAddinCommands=!0;Ka.addinCommandsActionType=0;return Ka};class Df{constructor(N,Ka){this.entitlement=N;this.metadata=Ka}MJj(){const N=$e(this.entitlement);N.targetType=this.targetType;return N}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(e.a)(Df,"AddinEntitlementEx",null,[]);var Sf=a(255),Bf=a(30);class kg{constructor(){this.addinId=null;this.targetType=0;this.storeId=this.solutionId=null}}Object(e.a)(kg,"AddinAbstract",null,[]);class wf extends Sys.EventArgs{constructor(){super();
this.Do=this.Zj=null}}Object(e.a)(wf,"InsertionParamEventArgs",Sys.EventArgs,[]);class lg{constructor(N,Ka,Cb,jc=null){this.JIb=sd.AFrameworkApplication.fa.Va("RoamingServiceHandlerWebServiceBase");this.appName=N;this.Whb=Ka;this.Shb=Cb;this.$jb=jc}F7b(N){const Ka=new Sys.StringBuilder(this.JIb);Ka.append("RoamingServiceHandler.ashx?action=");Ka.append("getAddinTeachingCalloutSettings");Ka.append("&");Ka.append(this.Led(N));Ka.append("&");Ka.append(sd.AFrameworkApplication.ij);sd.AFrameworkApplication.vd.Bm(Ka.toString(),
1,null,null,!0,2,Object(md.a)(this,this.hja,"getRequestSuccessCallback"),Object(md.a)(this,this.w3,"getRequestFailureCallback"),null)}X1a(N){var Ka=new Sys.StringBuilder(this.JIb);Ka.append("RoamingServiceHandler.ashx?action=");Ka.append("saveAddinTeachingCalloutSettings");Ka.append("&");Ka.append(sd.AFrameworkApplication.ij);Ka=Ka.toString();N=pe.c(N);sd.AFrameworkApplication.vd.Bm(Ka,2,N,null,!0,4,null,Object(md.a)(this,this.AV,"postRequestFailureCallback"),null)}hja(N){let Ka=!1,Cb=null;try{if(0<
N.data.Vd.length){const jc=Object(L.a)(Object,pe.a(N.data.Vd)),Kc=jc?jc[this.appName]:null;Kc&&(Cb=Object(L.a)(Object,pe.a(Kc.toString())))}Ka=!0}catch(jc){this.w3(null)}Ka&&this.Whb&&this.Whb(Cb)}w3(N){this.Shb&&this.Shb(N?N.data:null)}AV(N){this.$jb&&this.$jb(N?N.data:null)}Led(N){const Ka=new Sys.StringBuilder("requestedsettings=");for(let Cb=0;Cb<N.count;Cb++)Ka.append(N.na(Cb)),Cb<N.count-1&&Ka.append(";");return Ka.toString()}}Object(e.a)(lg,"AddinTeachingUIRoamingRequestHandler",null,[]);class ng extends Sys.EventArgs{constructor(N){super();
this.solutionId=N.solutionId;this.assetId=N.assetId;this.storeType=N.storeType;this.storeId=N.storeId;this.assetStoreId=N.assetStoreId;this.targetType=N.targetType;this.width=N.width;this.height=N.height;this.displayName=N.displayName;this.version=N.version}}Object(e.a)(ng,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var If=a(339);class Qf{constructor(N){this.pYa=this.Zj=null;this.pQa=!1;this.Toa=this.rPb=this.cma=this.Sh=this.PW=this.WN=null;this.Qa=N}get appName(){return sd.AFrameworkApplication.fa.Va("WebAppShortName")}get Umb(){this.PW||
(this.PW=new lg(this.appName,Object(md.a)(this,this.hja,"getRequestSuccessCallback"),Object(md.a)(this,this.w3,"getRequestFailureCallback"),Object(md.a)(this,this.AV,"postRequestFailureCallback")));return this.PW}get pra(){this.rPb||(this.rPb=new l.a);return this.rPb}set pra(N){this.rPb=N}get TGa(){this.Toa||(this.Toa=new l.a);return this.Toa}set TGa(N){this.Toa=N}dTc(N,Ka){window.addEventListener?(this.Zj=N,this.pYa=Ka,window.addEventListener("LaunchAddinTaskpane",Object(md.a)(this,this.Ozd,"onLaunchButtonClickedEventHandler"),
!0),window.addEventListener("DismissCallout",Object(md.a)(this,this.Syd,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(md.a)(this,this.Hyd,"onCloseButtonClickedEventHandler"),!0),sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&window.addEventListener("FGWebSurfaceEvent",Object(md.a)(this,this.uDb,"onCampaignLaunchedHandler"),!0)):n.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}eMj(N,
Ka,Cb,jc){this.Sh=N;this.pra=Ka;this.TGa=Cb;this.cma=jc;n.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",Ka?Ka.count.toString():"null",Cb?Cb.count.toString():"null");0<this.pra.count||0<this.TGa.count?(N=new l.a,N.add(this.appName),this.Umb.F7b(N)):this.cma(new l.a,null)}Ozd(){const N=new Sf.ScriptSharpLegacyMap;this.pYa&&this.pYa.tabs&&!this.pYa.tabs[0].isOfficeTab&&N.ia("SDX.FeatureFlags","NonOfficeTab");this.Eka(Qf.FU(this.Zj),
"ClickOnLaunch",N);sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Oka();this.pYa?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.pYa,()=>{const Ka=new wf;Ka.Zj=this.Zj;this.Qa.raiseEvent(Rd.a.Nrd,Ka)}):n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}Hyd(){this.Eka(Qf.FU(this.Zj),"ClickOnClose");sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&this.Oka()}Syd(){this.Eka(Qf.FU(this.Zj),"ClickOnDismiss");sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Oka()}uDb(N){if(N&&(N=N.detail)&&N.id&&this.Fld(N.id)){const Ka=(N.action||"").toLowerCase();if(N.success&&"opened"===Ka)this.Eka(Qf.FU(this.Zj),"CampaignLaunched"),n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.Oka(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",
Object(md.a)(this,this.uDb,"onCampaignLaunchedHandler"),!0);else{let Cb;try{Cb=JSON.stringify(N),n.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Cb)}catch(jc){Cb="id : "+N.id+" telemetryEventName: "+N.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Cb+" Error: "+(jc?jc.toString():""))}}}}Fld(N){N=Bf.a.ll(N);return-1!==N.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==N.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==N.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||
-1!==N.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==N.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==N.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}u6(N){if(this.appName){const Ka={},Cb={};Cb.LastTeachingUIShowTime=(new Date).toUTCString();Cb.AddinHasShown=N;Ka[this.appName]=pe.c(Cb);this.Umb.X1a(Ka);n.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(539530528,220,10,
"Fail to save roaming service since AppName is null")}Oka(){if(!this.pQa){const N=window.g_roamingAddinList;N&&(this.u6(N),this.pQa=!0)}}hja(N){N?this.xQd(N)?(n.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),this.WN="AddinHasShown"in N&&N.AddinHasShown?N.AddinHasShown.toString():null,this.Vpb()):(n.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.cma(this.pra,null)):(n.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.WN=null,this.Vpb())}w3(N){n.ULS.sendTraceTag(539530529,
220,10,"GET data from Roaming Settings Service with status: {0}, fallback",N?N.httpStatus:-1);this.cma(this.pra,null)}AV(N){n.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",N?N.httpStatus:-1)}Vpb(){const N=this.f5c();0===N.targetType?(N.solutionId?this.YEd(N):this.Eka(null,"NoSolutionId"),this.ndg(N),this.cma(this.pra,null)):this.cma(this.pra,N);n.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",N.addinId)}YEd(N){const Ka=new de;
Ka.callbackFunc=Cb=>{if(Cb.errorCode){if(this.Eka(N.solutionId,"FailToGetAppDetails"),sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)){var jc=window.g_roamingAddinList;jc&&this.u6(jc)}}else if(Cb.value)for(jc of Cb.value){var Kc=jc[1];if(Kc===N.solutionId){Cb={};Cb.solutionId=Kc;Cb.assetId=jc[5];Kc=sd.AFrameworkApplication.fa.isChangeGateEnabled("QueryEntitlementDetailsStoreTypeFixEnabled");Cb.storeType=Kc?jc[12]:jc[6];sd.AFrameworkApplication.fa.isChangeGateEnabled("StoreIdFixEnabled")?
Cb.storeId=N.storeId:Cb.storeId=jc[11];Cb.assetStoreId=jc[6];Cb.targetType=jc[3];Cb.width=jc[7];Cb.height=jc[8];Cb.displayName=jc[0];Cb.version=jc[4];n.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",N.solutionId);jc=new ng(Cb);this.Qa.raiseEvent(Rd.a.NQd,jc);break}}};Ka.storeType=OSF.StoreTypeEnum.PrivateCatalog;Ka.fromInsertDialog=!1;Ka.refresh=!1;this.Sh.queryEntitlementDetails(Ka)}xQd(N){if("LastTeachingUIShowTime"in N){if(N=+new Date-+new Date(N.LastTeachingUIShowTime.toString()),
N<sd.AFrameworkApplication.fa.IM("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",N),!1}else n.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");return!0}f5c(){let N=new za.a(new kg,0),Ka=new za.a(new kg,0),Cb=0,jc=0,Kc=0;var kd=new l.a;for(var qd of this.pra)kd.add(qd);for(let yd of this.TGa)kd.add(yd);for(let yd of kd)if(!("excatalog"!==yd.storeType||te.c(yd.installTimeInMS)||!yd.installTimeInMS||
yd.installTimeInMS<=sd.AFrameworkApplication.fa.IM("DateTimeInMSForNewAddin",16409952E5))){kd=Qf.$tb(yd);if(this.WN&&(qd=this.WN.split(","),0<qd.length&&Array.contains(qd,kd))){Kc++;n.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}kd.startsWith("private_")?(N=Qf.kZe(yd,N),jc++):(Ka=Qf.kZe(yd,Ka),Cb++)}n.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",jc,Cb,Kc);return 0<Ka.value?
Ka.key:0<N.value?N.key:Object.assign(new kg,{addinId:null,targetType:-1,solutionId:null,storeId:null})}Eka(N,Ka,Cb=null){N={["AppTeachingUICalloutAction"]:Ka,["SDX.Id"]:N,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Cb)for(let jc of Cb.keys)N[jc]=Cb.na(jc);ie.a.sendTelemetryEvent(Object.assign(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(N)}))}ndg(N){N&&(N=this.WN?this.WN+","+N.addinId:N.addinId,sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)?window.g_roamingAddinList=N:this.u6(N))}static FU(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.storeType,N.assetId,null,null,N.storeId)}static kZe(N,Ka){return Ka.value<N.installTimeInMS?new za.a(Object.assign(new kg,{addinId:Qf.$tb(N),targetType:N.targetType,storeId:N.storeId,solutionId:N.solutionId}),N.installTimeInMS):Ka}static $tb(N){return Telemetry.PrivacyRules.IsPrivateAddin(N.storeType,N.assetId,null,null,N.storeId)?"private_"+N.installTimeInMS:N.solutionId}}Object(e.a)(Qf,
"PrivateCatalogTeachingCalloutHandler2",null,[]);var dg=a(80);const ph=()=>{const N=dg.a.SY(window.location.href.toLowerCase(),"wdomexsrctype");return!!N&&"4"===N},Ag=()=>dg.a.SY(window.location.href.toLowerCase(),"wdtpl"),Sg=()=>{const N=dg.a.SY(window.location.href.toLowerCase(),"wdomexsrctype");return!!N&&"1"===N},ch=N=>{let Ka=null;switch(N){case 0:Ka="omex";break;case 1:Ka="spcatalog";break;case 2:Ka="spapp";break;case 3:Ka="filesystem";break;case 4:Ka="exchange";break;case 6:Ka="registry";break;
case 7:Ka="inmemory";break;case 8:Ka="uploadfiledevcatalog";break;case 9:Ka="hardcodedpreinstall";break;case 10:Ka="excatalog";break;case 16:Ka="wopicatalog"}return Ka},ah=N=>{let Ka=-1;switch(N.toLowerCase()){case "omex":Ka=0;break;case "spcatalog":Ka=1;break;case "spapp":Ka=2;break;case "filesystem":Ka=3;break;case "exchange":Ka=4;break;case "registry":Ka=6;break;case "inmemory":Ka=7;break;case "uploadfiledevcatalog":Ka=8;break;case "hardcodedpreinstall":Ka=9;break;case "excatalog":Ka=10;break;
case "wopicatalog":Ka=16}return Ka};var ih=a(680);class Bg{constructor(N){this.Dr=null;this.rA=N}get_current(){if(!this.Dr)throw Error.argumentOutOfRange();return this.Dr.data}moveNext(){if(!this.Dr)return this.Dr=this.rA,!!this.rA;if(!this.Dr.next)return!1;this.Dr=this.Dr.next;return!0}qkc(){if(!this.Dr)return this.Dr=this.rA,!!this.rA;if(!this.Dr.previous)return!1;this.Dr=this.Dr.previous;return!0}reset(){this.Dr=this.rA}}Object(e.a)(Bg,"ListEnumerator",null,[0]);class xg{constructor(N,Ka,Cb){this.next=
Cb;this.previous=Ka;this.data=N}}Object(e.a)(xg,"ListNode",null,[]);class dh{constructor(){this.wA=this.gq=null;this._count=0}add(N){this.gq?this.wA=this.wA.next=new xg(N,this.wA,null):this.gq=this.wA=new xg(N,null,null);this._count=this.count+1}insert(N,Ka){if(N>this.count||0>N)throw Error.argumentOutOfRange("pos");if(N===this.count)this.add(Ka);else{for(var Cb=this.gq;0!==N--;)Cb=Cb.next;N=new xg(Ka,Cb.previous,Cb);N.previous?N.previous.next=N:this.gq=N;N.next?N.next.previous=N:this.wA=N;this._count=
this.count+1}}remove(N){let Ka=this.gq;for(;Ka&&Ka.data!==N;)Ka=Ka.next;if(!Ka)return!1;Ka.previous?Ka.previous.next=Ka.next:this.gq=Ka.next;Ka.next?Ka.next.previous=Ka.previous:this.wA=Ka.previous;this._count=this.count-1;return!0}clear(){let N=this.gq,Ka;for(this.wA=this.gq=null;N;)Ka=N.next,N.previous=null,N.next=null,N=Ka;this._count=0}indexOf(N){let Ka=this.gq,Cb=0;for(;Ka&&Ka.data!==N;)Ka=Ka.next,Cb++;return Ka?Cb:-1}na(N){return this.at(N).data}get count(){return this._count}getEnumerator(){return new Bg(this.gq)}[Symbol.iterator](){return Object(ih.a)(this.getEnumerator())}A$b(N){N=
this.at(N);return new Bg(N)}toArray(){const N=Array(this.count);let Ka=0;for(let Cb of this)N[Ka]=Cb,Ka++;return N}at(N){let Ka=this.gq,Cb=0;for(;Cb!==N;){if(!Ka)throw Error.argumentOutOfRange("pos");Ka=Ka.next;Cb++}return Ka}}Object(e.a)(dh,"List",null,[1]);class $g extends Sys.EventArgs{constructor(N){super();this.properties=N}}Object(e.a)($g,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class of{constructor(){this.addinId=null;this.targetType=0;this.storeId=this.solutionId=null}}
Object(e.a)(of,"MiniAddinInfo",null,[]);class ka{constructor(N,Ka,Cb){this.Qa=new Aa.a;this.context=new xc;this.HQc=this.e6f=this.nSd=this.oFa=this.WN=this.PW=null;this.contextActivationMgr=N;this.jHg=Ka;this.pFa=Cb;this.appName=sd.AFrameworkApplication.fa.Va("WebAppShortName")}get tMb(){this.HQc||(this.HQc=new Qf(this.Qa));return this.HQc}kDg(N){this.Qa.addHandler(Rd.a.Qmb,N)}FGg(N){this.Qa.addHandler(Rd.a.NQd,N)}yNj(N){null!==N&&(this.context.KN=N[Rd.a.d9],this.context.Gq=N[Rd.a.eP],this.context.nzc=
this.context.Cpc=0,N=Rd.a.qFa in N?N[Rd.a.qFa]:0,-1!==this.context.KN&&0!==this.context.Gq&&(this.context.c9=new dh,this.context.Gia=new dh,this.context.w2b=new dh,this.context.wUc=this.jHg.createAddinDataProvider(ch(this.context.KN),this.contextActivationMgr),this.context.wUc?this.context.wUc.getEntitlementsAsync(this.contextActivationMgr.eca,!0,N,Ka=>{this.mNi(Ka)}):n.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.KN)))}mNi(N){if(N&&0<N.length){this.context.nzc=
N.length;const Cb=sd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?Ag():null;for(let jc=0;jc<N.length;jc++){const Kc=N[jc];if(sd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&Sg()&&Kc&&Kc.storeType&&"omex"===Kc.storeType.toLowerCase()&&Kc.assetId&&Cb&&Kc.assetId.toLowerCase()===Cb.toLowerCase()){var Ka={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:ka.FU(Kc)};ie.a.sendTelemetryEvent(Object.assign(new If.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:Ae.a.Uj(Ka)}))}!Kc||1!==Kc.targetType&&-1!==Kc.targetType?this.nlc():(Ka={},sd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(Ka.solutionId=Kc.solutionId,Ka.version=Kc.version):(Ka.marketplaceId=Kc.solutionId,Ka.marketplaceVersion=Kc.version),Ka.storeType=Kc.storeType,Ka.storeId=Kc.storeId,Ka.targetData=Kc,ka.uMb?this.contextActivationMgr.isAddinCommandsExAsync(Ka,
Object(md.a)(this,this.HMi,"onIsAddinCommandsExCompleted")):this.contextActivationMgr.isAddinCommandsAsync(Ka,(kd,qd,yd)=>{kd?(qd&&this.context.c9.add(yd.targetData),10===this.context.KN&&(kd=yd.targetData,qd=kd.targetType,te.c(yd.targetTypeForExp)||(qd=yd.targetTypeForExp,kd.targetType=qd),this.context.Gia.add(kd),0===qd&&this.context.w2b.add(kd))):(yd=yd.targetData,n.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(yd.solutionId,
yd.storeType,yd.assetId,null,null,yd.storeId),yd.storeType));this.nlc()}))}}else this.nlc()}nlc(){var N;(N=this.context).Cpc=N.Cpc+1;this.context.Cpc>=this.context.nzc&&(this.pFa.EXf(this.context.KN,!1),0<this.context.nzc&&10===this.context.KN&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(N=!1,sd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&ph()&&(N=this.Cti()),this.Qsi(),sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&!N?ka.uMb?this.tMb.eMj(this.contextActivationMgr,this.context.une,this.context.TGa,(Ka,Cb)=>{const jc=new l.a;for(let Kc of Ka)Ka=Kc.MJj(),Cb&&Cb.solutionId===Kc.solutionId&&(Ka.showCallout=!0,this.tMb.ndg(Cb)),jc.add(Ka);this.cma(jc)}):this.GGh(this.context.c9):this.KXb(this.context.c9)):this.KXb(this.context.c9))}KXb(N){if(ka.uMb)this.cma(this.T_g(N));else{var Ka=new l.a;if(N)for(let Cb of this.context.c9)Ka.add($e(Cb));this.context.c9&&1>this.context.c9.count&&zd.a.teb(Rd.a.Rmb,"false",this.context.KN);
N={["ack2"]:Ka};N[Rd.a.d9]=this.context.KN;N[Rd.a.eP]=this.context.Gq;this.Qa.raiseEvent(Rd.a.Qmb,new $g(N),this)}}T_g(N){const Ka=new l.a;if(N)for(let Cb of N)Ka.add($e(Cb));return Ka}cma(N){N&&N.count||zd.a.teb(Rd.a.Rmb,"false",this.context.KN);N={["ack2"]:N};N[Rd.a.d9]=this.context.KN;N[Rd.a.eP]=this.context.Gq;this.Qa.raiseEvent(Rd.a.Qmb,new $g(N),this)}u6(N){if(this.appName){const Ka={},Cb={};Cb.LastTeachingUIShowTime=(new Date).toUTCString();Cb.AddinHasShown=N;Ka[this.appName]=pe.c(Cb);this.PW&&
(this.PW.X1a(Ka),n.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else n.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}GGh(N){(this.oFa=N)?(N=new l.a,N.add(this.appName),this.PW=new lg(this.appName,Object(md.a)(this,this.hja,"getRequestSuccessCallback"),Object(md.a)(this,this.w3,"getRequestFailureCallback"),Object(md.a)(this,this.AV,"postRequestFailureCallback")),
this.PW.F7b(N)):(N={["ack2"]:new l.a},N[Rd.a.d9]=this.context.KN,N[Rd.a.eP]=this.context.Gq,this.Qa.raiseEvent(Rd.a.Qmb,new $g(N),this))}hja(N){N?this.xQd(N)?(n.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.WN="AddinHasShown"in N&&N.AddinHasShown?N.AddinHasShown.toString():null,this.Vpb()):(n.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.KXb(this.oFa)):(n.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.WN=null,this.Vpb())}w3(N){n.ULS.sendTraceTag(539530529,
306,10,"GET data from Roaming Settings Service with status: {0}, fallback",N?N.httpStatus:-1);this.KXb(this.oFa)}AV(N){n.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",N?N.httpStatus:-1)}Vpb(){const N=this.f5c();if(0===N.targetType){N.solutionId?(this.nSd=N.solutionId,this.e6f=N.storeId,this.YEd()):this.Eka("NoSolutionId");if(N.addinId){const Ka=this.WN?this.WN+","+N.addinId:N.addinId;sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)?window.g_roamingAddinList=Ka:this.u6(Ka)}this.Ake(null)}else this.Ake(N.addinId);n.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",N.addinId)}YEd(){const N=new de;N.callbackFunc=Ka=>{if(Ka.errorCode){if(this.Eka("FailToGetAppDetails"),sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)){var Cb=window.g_roamingAddinList;Cb&&this.u6(Cb)}}else if(Ka.value)for(Cb of Ka.value){var jc=Cb[1];if(jc===this.nSd){Ka={};Ka.solutionId=
jc;Ka.assetId=Cb[5];jc=sd.AFrameworkApplication.fa.isChangeGateEnabled("QueryEntitlementDetailsStoreTypeFixEnabled");Ka.storeType=jc?Cb[12]:Cb[6];sd.AFrameworkApplication.fa.isChangeGateEnabled("StoreIdFixEnabled")?Ka.storeId=this.e6f:Ka.storeId=Cb[11];Ka.assetStoreId=Cb[6];Ka.targetType=Cb[3];Ka.width=Cb[7];Ka.height=Cb[8];Ka.displayName=Cb[0];Ka.version=Cb[4];Cb=new ng(Ka);this.Qa.raiseEvent(Rd.a.NQd,Cb);break}}};N.storeType=OSF.StoreTypeEnum.PrivateCatalog;N.fromInsertDialog=!1;N.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(N)}xQd(N){if("LastTeachingUIShowTime"in
N){if(N=+new Date-+new Date(N.LastTeachingUIShowTime.toString()),N<sd.AFrameworkApplication.fa.IM("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",N),!1}else n.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0}f5c(){let N=new za.a(new of,0),Ka=new za.a(new of,0),Cb=0,jc=0,Kc=0;var kd=new dh;if(0<this.context.c9.count)for(var qd of this.context.c9)kd.add(qd);if(0<this.context.w2b.count)for(let yd of this.context.w2b)kd.add(yd);
for(let yd of kd)if(!("excatalog"!==yd.storeType||te.c(yd.installTimeInMS)||!yd.installTimeInMS||yd.installTimeInMS<=sd.AFrameworkApplication.fa.IM("DateTimeInMSForNewAddin",16409952E5))){kd=ka.$tb(yd);if(this.WN&&(qd=this.WN.split(","),0<qd.length&&Array.contains(qd,kd))){Kc++;n.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}kd.startsWith("private_")?(N.value<yd.installTimeInMS&&(N=new za.a(Object.assign(new of,{addinId:kd,targetType:yd.targetType,storeId:yd.storeId,
solutionId:yd.solutionId}),yd.installTimeInMS)),jc++):(Ka.value<yd.installTimeInMS&&(Ka=new za.a(Object.assign(new of,{addinId:kd,targetType:yd.targetType,storeId:yd.storeId,solutionId:yd.solutionId}),yd.installTimeInMS)),Cb++)}n.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",jc,Cb,Kc);return 0<Ka.value?Ka.key:0<N.value?N.key:Object.assign(new of,{addinId:null,targetType:-1,solutionId:null,storeId:null})}Ake(N){const Ka=
new l.a;for(let jc of this.oFa){const Kc=$e(jc);if(N){var Cb=ka.$tb(jc);N===Cb&&(Kc.showCallout=!0,Cb=this.WN?this.WN+","+N:N,sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=Cb:this.u6(Cb))}Ka.add(Kc)}this.oFa&&1>this.oFa.count&&zd.a.teb(Rd.a.Rmb,"false",this.context.KN);N={["ack2"]:Ka};N[Rd.a.d9]=this.context.KN;N[Rd.a.eP]=this.context.Gq;this.Qa.raiseEvent(Rd.a.Qmb,new $g(N),this)}Cti(){if(ka.uMb)return this.Dti(this.context.Rad);
var N=!1;if(this.context.Gia&&1>this.context.Gia.count)return N;const Ka=Ag();if(!Ka)return N;for(let Cb of this.context.Gia)if(Cb.storeId&&Cb.storeId.toLowerCase()===Ka.toLowerCase()||Cb.assetId&&Cb.assetId.toLowerCase()===Ka.toLowerCase())N={["SDX_Id"]:ka.FU(Cb),["SDX_TargetType"]:te.c(Cb.targetType)?"":Cb.targetType.toString()},ie.a.sendTelemetryEvent(Object.assign(new If.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Ae.a.Uj(N)})),N=!0;return N}Qsi(){if(ka.uMb)this.Rsi(this.context.Rad);
else if(!(this.context.Gia&&1>this.context.Gia.count))if(this.pFa.Odf()){var N=this.pFa.b0e();N?(N=this.RWe(this.context.Gia,N),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(N=this.RWe(this.context.Gia,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.pFa.d_f(N)}else n.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}RWe(N,Ka){const Cb={};let jc=!1;for(let Kc of N)if(N=ka.FU(Kc))!Ka||N in Ka||(this.ixa(Kc,N),n.ULS.sendTraceTag(527523849,
306,50,"New addin detected,log to AppInstall")),"private"===N.toLowerCase()?jc||(jc=!0,Cb[N]=null):Cb[N]=null;return Cb}ixa(N,Ka){var Cb=N.installTimeInMS?(new Date(N.installTimeInMS)).toISOString():"";Cb={["SDX.Id"]:Ka,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:te.c(N.targetType)?"":N.targetType.toString(),["SDX.AdminDeploymentTime"]:Cb};ie.a.sendTelemetryEvent(Object.assign(new If.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ae.a.Uj(Cb)}));1===N.targetType&&(N={["SDX.Id"]:Ka,
["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},ie.a.sendTelemetryEvent(Object.assign(new If.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Ae.a.Uj(N)})))}Dti(N){let Ka=!1;if(N&&1>N.count)return Ka;const Cb=Ag();if(!Cb)return Ka;for(let jc of N)if(jc.storeId&&jc.storeId.toLowerCase()===Cb.toLowerCase()||jc.assetId&&jc.assetId.toLowerCase()===Cb.toLowerCase())N={["SDX_Id"]:ka.d0e(jc),["SDX_TargetType"]:te.c(jc.targetType)?"":jc.targetType.toString()},ie.a.sendTelemetryEvent(Object.assign(new If.a,
{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Ae.a.Uj(N)})),Ka=!0;return Ka}Rsi(N){if(!(N&&1>N.count))if(this.pFa.Odf()){var Ka=this.pFa.b0e();Ka?(N=this.SWe(N,Ka),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(N=this.SWe(N,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.pFa.d_f(N)}else n.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}SWe(N,Ka){const Cb={};let jc=!1;for(let Kc of N)if(N=ka.d0e(Kc))!Ka||N in
Ka||(this.Dvi(Kc,N),n.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===N.toLowerCase()?jc||(jc=!0,Cb[N]=null):Cb[N]=null;return Cb}Dvi(N,Ka){var Cb=N.installTimeInMS?(new Date(N.installTimeInMS)).toISOString():"";Cb={["SDX.Id"]:Ka,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:te.c(N.targetType)?"":N.targetType.toString(),["SDX.AdminDeploymentTime"]:Cb};ie.a.sendTelemetryEvent(Object.assign(new If.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ae.a.Uj(Cb)}));
1===N.targetType&&(N={["SDX.Id"]:Ka,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},ie.a.sendTelemetryEvent(Object.assign(new If.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Ae.a.Uj(N)})))}HMi(N,Ka,Cb,jc){N?(-1===jc.targetType&&(jc.targetType=Cb.targetTypeForExp),N=new Df(Cb.targetData,jc),Ka&&this.context.une.add(N),10===this.context.KN&&(this.context.Rad.add(N),0===N.targetType&&this.context.TGa.add(N))):(Ka=Cb.targetData,n.ULS.sendTraceTag(542978528,220,
15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ka.solutionId,Ka.storeType,Ka.assetId,null,null,Ka.storeId),Ka.storeType));this.nlc()}Eka(N){N={["AppTeachingUICalloutAction"]:N,["SDX.Id"]:this.nSd,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ie.a.sendTelemetryEvent(Object.assign(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(N)}))}static get uMb(){return sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",
!1)}static FU(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.storeType,N.assetId,null,null,N.storeId)}static d0e(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.storeType,N.assetId,null,null,N.storeId)}static $tb(N){return Telemetry.PrivacyRules.IsPrivateAddin(N.storeType,N.assetId,null,null,N.storeId)?"private_"+N.installTimeInMS:N.solutionId}}Object(e.a)(ka,"AddInCommandsListLoader",null,[]);class qb{constructor(N){this.Usg=N}get eca(){return this.Usg}insertOsfControl(N){return this.eca.insertOsfControl(N)}getManifestInvaildErrorString(){return this.eca.getManifestInvaildErrorString()}isAddinCommandsAsync(N,
Ka){this.eca.isAddinCommandsAsync(N,Ka)}isAddinCommandsExAsync(N,Ka){this.eca.isAddinCommandsExAsync(N,Ka)}ownerAddinControlRecreated(N,Ka){this.eca.ownerAddinControlRecreated(N,Ka)}queryEntitlementDetails(N){this.eca.queryEntitlementDetails(N)}}Object(e.a)(qb,"ContextActivationMgrWrapper",null,[861]);class pc{createAddinDataProvider(N,Ka){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(N,Ka.eca)}static get instance(){pc.Ma||(pc.Ma=new pc);return pc.Ma}}pc.Ma=null;Object(e.a)(pc,
"OSFAddinDataProviderFactory",null,[860]);class Ic{constructor(){this.Ver=1}}Object(e.a)(Ic,"CacheItem",null,[]);class Bd{constructor(N){this.wDa=N}Jl(N){const Ka=this.wDa.getItem(N);if(Ka){let Cb=new Ic;try{Cb=Sys.Serialization.JavaScriptSerializer.deserialize(Ka,!0)}catch(jc){return this.wDa.removeItem(N),null}return Cb.Data?Cb.Data:Cb.data}return null}KPa(N){this.wDa.removeItem(N)}}Object(e.a)(Bd,"AppsDataCacheManager",null,[147]);var Sd=a(813);class je{constructor(){new Bd(Sd.a.instance)}EXf(N,
Ka){N=Rd.a.VXe()+N;Sd.a.instance.setItem(N,Ka.toString())}b0e(){var N=Rd.a.e0e();n.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",N);N=Sd.a.instance.getItem(N);return pe.a(N)}d_f(N){const Ka=Rd.a.e0e();n.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",Ka);Sd.a.instance.setItem(Ka,pe.c(N))}Odf(){return!!Sd.a.instance.localStorage}static get instance(){je.Ma||(je.Ma=new je);return je.Ma}}je.Ma=null;Object(e.a)(je,"AddInCommandsCacheManager",null,[865]);class Ke{constructor(N,Ka,Cb,jc,Kc,
kd){this.Gq=N;this.Zj=Ka;this.cW=Cb;this.displayName=Kc;this.xif=kd}}Object(e.a)(Ke,"PostLaunchAddinCommandsParameters",null,[]);class gf{constructor(N,Ka,Cb){this.pQa=!1;this.PW=null;this.$a=N;this.nib=Ka;this.Hfb=Cb}dTc(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(md.a)(this,this.Ozd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(md.a)(this,this.Syd,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",
Object(md.a)(this,this.Hyd,"onCloseButtonClickedEventHandler"),!0),sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&window.addEventListener("FGWebSurfaceEvent",Object(md.a)(this,this.uDb,"onCampaignLaunchedHandler"),!0)):n.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}Ozd(){const N={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:gf.FU(this.nib),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};this.Hfb&&this.Hfb.tabs&&!this.Hfb.tabs[0].isOfficeTab&&(N["SDX.FeatureFlags"]="NonOfficeTab");ie.a.sendTelemetryEvent(Object.assign(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(N)}));sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Oka();this.Hfb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Hfb,()=>{const Ka=new wf;Ka.Zj=this.nib;this.$a.raiseEvent(Rd.a.Nrd,
Ka)}):n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}Hyd(){const N={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:gf.FU(this.nib),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ie.a.sendTelemetryEvent(Object.assign(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(N)}));sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&this.Oka()}Syd(){const N={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:gf.FU(this.nib),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ie.a.sendTelemetryEvent(Object.assign(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(N)}));sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Oka()}uDb(N){if(N&&(N=N.detail)&&N.id&&this.Fld(N.id)){const Cb=
(N.action||"").toLowerCase();if(N.success&&"opened"===Cb){var Ka={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:gf.FU(this.nib),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ie.a.sendTelemetryEvent(Object.assign(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(Ka)}));n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.Oka();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",
Object(md.a)(this,this.uDb,"onCampaignLaunchedHandler"),!0)}else try{Ka=JSON.stringify(N),n.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Ka)}catch(jc){Ka="id : "+N.id+" telemetryEventName: "+N.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Ka+" Error: "+(jc?jc.toString():""))}}}Fld(N){N=Bf.a.ll(N);return-1!==N.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==N.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==N.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||
-1!==N.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==N.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==N.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}u6(N){const Ka=sd.AFrameworkApplication.fa.Va("WebAppShortName");if(Ka){const Cb={},jc={};jc.LastTeachingUIShowTime=(new Date).toUTCString();jc.AddinHasShown=N;Cb[Ka]=pe.c(jc);this.PW=new lg(Ka,null,null,Object(md.a)(this,this.AV,"postRequestFailureCallback")),this.PW.X1a(Cb),n.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(523535565,
220,10,"Fail to save roaming service since AppName is null")}Oka(){if(!this.pQa){const N=window.g_roamingAddinList;N&&(this.u6(N),this.pQa=!0)}}AV(N){n.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",N?N.httpStatus:-1)}static FU(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.storeType,N.assetId,null,null,N.storeId)}}Object(e.a)(gf,"PrivateCatalogTeachingCalloutHandler",null,[]);class ba{constructor(N){this.o9d=null;this.j7d=
N}get Vwa(){return this.o9d}SXa(N,Ka=null){this.j7d.SXa(N,Ka);this.o9d=N}YHd(N){this.j7d.YHd(N)}}Object(e.a)(ba,"RibbonExtensibilityManagerWithChangeDetection",null,[898]);var cb=a(859),Vb=a(99);class E{static JYe(N){const Ka=new l.a;if(E.Nze)for(var Cb of E.Nze)Ka.add(Cb);Cb=null;switch(N){case "Workbook":Cb=E.pXj;break;case "Document":Cb=E.Hgh;break;case "Presentation":Cb=E.n_i}if(Cb)for(const jc of Cb)Ka.add(jc);return Ka}}E.Nze=["PrimaryCommandSurface","ContextMenu"];E.pXj=null;E.Hgh=null;E.n_i=
null;Object(e.a)(E,"ExtensionPointType",null,[]);class ha{constructor(N){this.kbe=null;if(te.c(N))throw n.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.ikg=N}get hDb(){return this.kbe||(this.kbe=new l.a)}get boe(){return this.ikg}}Object(e.a)(ha,"ContextMenuExtensibility",null,[873]);class Ia{constructor(N,Ka=null,Cb=0){if(te.c(N))throw n.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),
Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.Nsg=N;this.dwg=Ka;this.Mog=Cb}get oV(){return this.Nsg}get startedNode(){return this.dwg}get WFh(){return this.Mog}}Object(e.a)(Ia,"RibbonExtensibility",null,[902]);class Gb{constructor(N){this.Lng=N.entitlement}get entitlement(){return this.Lng}createActionContext(N,Ka){N={};N.ownerAddinInfo=this.entitlement;N.action=Ka;return N}}Object(e.a)(Gb,"AddInCommandsContextProvider",null,[]);class mc{constructor(N,Ka,
Cb){this.x0d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=N;this.eventBuilder=Ka;this.contextMenuBuilder=Cb}get wne(){return this.x0d}T4g(N){return new Gb(N)}createActionBuilder(N,Ka){return OfficeExt.DefaultControlActionBinder.createActionBuilder(N,Ka.entitlement,Ka.manifest)}startApplyAddin(N){this.x0d=N;const Ka=this.T4g(N);this.actionBuilder=this.createActionBuilder(Ka,N)}endApplyAddin(){}pbd(N,Ka,Cb=0){return this.ribbonBuilder.Is&&
0<this.ribbonBuilder.Is.count?new Ia(this.kFh(N,Ka),this.wne.startedNode,Cb):null}rUe(){var N=null;if(this.contextMenuBuilder.Wjc&&0<this.contextMenuBuilder.Wjc.count){N||(N=this.wne.entitlement.solutionId);N=new ha(N);for(let Ka of this.contextMenuBuilder.Wjc)N.hDb.add(Ka);return N}return null}kFh(N,Ka){return this.ribbonBuilder.Is&&0<this.ribbonBuilder.Is.count?new Ib.a(this.ribbonBuilder.Is,N,Ka):null}}Object(e.a)(mc,"AddinCommandsBuilder",null,[]);class kc{constructor(N,Ka,Cb,jc,Kc,kd,qd){this.oSa=
new Vb.a;this.Gq=N;this.Sh=Ka;this.No=Cb;this.ribbonManager=jc;this.contextMenuManager=Kc;this.UF=kd;this.nga=qd;this.kO=sd.AFrameworkApplication.ta.MD}TAb(N,Ka,Cb,jc,Kc,kd,qd){const yd=(Jd,Vd,Oe,Qe)=>{Kc(Jd,Vd,Oe,Qe);Jd=cb.a[this.Gq]+Vd.assetId;({value:Vd}=this.oSa.Dc(Jd)).returnValue&&(Vd.stop(),this.oSa.remove(Jd))};if(0!==this.Gq&&N){n.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",N.count);4===this.Gq&&(n.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",
jc)),this.dXg(N,jc),kd());for(let Jd of N)if(N=Jd,n.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.No.QM,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId))),this.cfg(N))if(qd&&N.requireConsent)qd(N,Vd=>{try{if(this.kO){const Qe=cb.a[this.Gq]+Vd.solutionId,lf=this.kO.Bc("ComponentAttach",Qe);this.oSa.ia(Qe,lf)}const Oe=this.UF.nia(Vd.storeType,Vd.solutionId);6!==this.Gq&&(Oe&&(this.h1b(Oe),Oe.sB.purge(!1)),
this.Sh.insertOsfControl(this.XFb(Vd,Ka,Cb,yd)),Oe&&this.Sh.ownerAddinControlRecreated(Vd.solutionId,Vd.storeType))}catch(Oe){n.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.No.QM,Telemetry.PrivacyRules.GetPrivacyCompliantId(Vd.solutionId,Vd.ownerAddinStoreType||Vd.storeType,Vd.assetId,null,null,Vd.storeId),Vd.version,Vd.storeType,Vd.storeId,Oe.message)),yd(!1,Vd,null,null)}});
else try{if(this.kO){const Oe=cb.a[this.Gq]+N.solutionId,Qe=this.kO.Bc("ComponentAttach",Oe);this.oSa.ia(Oe,Qe)}const Vd=this.UF.nia(N.storeType,N.solutionId);6!==this.Gq&&(Vd&&(this.h1b(Vd),Vd.sB.purge(!1)),this.Sh.insertOsfControl(this.XFb(N,Ka,Cb,yd)),Vd&&this.Sh.ownerAddinControlRecreated(N.solutionId,N.storeType))}catch(Vd){n.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.No.QM,
Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId),N.version,N.storeType,N.storeId,Vd.message)),yd(!1,N,null,null)}else yd(!1,N,null,null)}}eqi(N,Ka,Cb,jc,Kc,kd){const qd=(yd,Jd,Vd,Oe)=>{kd(yd,Jd,Vd,Oe);yd=cb.a[this.Gq]+Jd.solutionId;({value:Jd}=this.oSa.Dc(yd)).returnValue&&(Jd.stop(),this.oSa.remove(yd))};if(6===this.Gq&&N)if(n.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.No.QM,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,
N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId))),this.cfg(N))try{if(this.kO){const Jd=cb.a[this.Gq]+N.solutionId,Vd=this.kO.Bc("ComponentAttach",Jd);this.oSa.ia(Jd,Vd)}const yd=this.UF.nia(N.storeType,N.solutionId);yd||qd(!1,N,null,null);sd.AFrameworkApplication.ta&&sd.AFrameworkApplication.ta.Oa.delayInstallAddInIsEnabled?this.PUe(N,Ka,jc,Kc,Cb,Jd=>{qd(Jd,N,Cb,yd.displayName)}):(this.PUe(N,Ka,jc,Kc,Cb),qd(!0,N,Cb,yd.displayName))}catch(yd){n.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.No.QM,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId),N.version,N.storeType,N.storeId,yd.message)),qd(!1,N,null,null)}else qd(!1,N,null,null)}XEi(N,Ka,Cb,jc,Kc,kd){if(kd)if(kd._isAddinCommandsManifest(this.No.QM))try{sd.AFrameworkApplication.ta&&sd.AFrameworkApplication.ta.Oa.delayInstallAddInIsEnabled?this.OUe(N,Ka,Cb,Kc,kd,qd=>{jc(qd,N,kd,kd.getDefaultDisplayName())}):(this.OUe(N,Ka,Cb,Kc,kd),jc(!0,N,kd,kd.getDefaultDisplayName()))}catch(qd){n.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.No.QM,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId),N.version,N.storeType,N.storeId,qd.message)),jc(!1,N,kd,kd.getDefaultDisplayName())}else n.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.No.QM,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId),N.version,N.storeType,N.storeId)),jc(!1,N,null,null);else n.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.No.QM,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId),N.version,N.storeType,N.storeId)),
jc(!1,N,null,null)}XFb(N,Ka,Cb,jc){const Kc={},kd=document.createElement("div");kd.setAttribute("visible","false");Kc.div=kd;Kc.id=N.solutionId;Kc.solutionId=N.solutionId;Kc.version=N.version;Kc.storeType=N.storeType;Kc.storeId=N.storeId;Kc.assetId=N.assetId;Kc.assetStoreId=N.assetStoreId;Kc.isvirtualOsfControl=!0;Kc.virtualOsfControlActivationCallback=(qd,yd)=>{const Jd=this.UF.nia(N.storeType,N.solutionId);Jd&&(Jd.isUpgraded&&(N.isUpgraded=!0),this.h1b(Jd));this.XEi(N,Ka,Cb,jc,qd,yd)};Kc.reason=
3===this.Gq?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Kc}OUe(N,Ka,Cb,jc,Kc,kd=null){const qd={};qd.solutionId=jc.getSolutionId();qd.version=jc.getVersion();qd.storeType=jc.getStoreType();qd.storeId=jc.getStoreId();qd.assetId=jc.getSolutionId();qd.assetStoreId=jc.getAssetStoreId();qd.targetType=jc.getOsfControlType();let yd=null,Jd=null;if(sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))yd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.No.QM,this.No.formFactor)).parseExtensions(qd,Kc,this.nga),Jd=E.JYe(this.No.QM);else try{yd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.No.QM,this.No.formFactor)).parseExtensions(qd,Kc,this.nga),Jd=E.JYe(this.No.QM)}catch(Oe){throw n.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Oe.message),Oe;}if(Jd&&0<Jd.count){if(sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var Vd=Ka(N);Ka=Cb(N);Cb=!!sd.AFrameworkApplication.fa&&sd.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Vd=new mc(Vd,null,Ka);for(let Oe of Jd)Vd.commandSurface=Oe,yd.apply(Vd,this.nga,Cb)}else try{let Oe=Ka(N),Qe=Cb(N),lf=!!sd.AFrameworkApplication.fa&&sd.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Vd=new mc(Oe,null,Qe);for(let qg of Jd)Vd.commandSurface=qg,yd.apply(Vd,this.nga,lf)}catch(Oe){throw n.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+
Oe.message),Oe;}if(OSF.OUtil.checkFlight(14))try{let Oe=Vd.pbd(N.solutionId,Kc.getDefaultDisplayName()),Qe=Vd.rUe();Oe&&this.ribbonManager.SXa(Oe,kd);Qe&&this.contextMenuManager.bke(Qe);this.UF.Hke(jc,Oe,Qe,Kc.getDefaultDisplayName());n.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Kc.getDefaultDisplayName())}catch(Oe){throw OfficeExt.DevConsole.log(Oe),n.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Oe.message),Oe;}else try{let Oe=Vd.pbd(N.solutionId,
Kc.getDefaultDisplayName()),Qe=Vd.rUe();Oe&&this.ribbonManager.SXa(Oe);Qe&&this.contextMenuManager.bke(Qe);this.UF.Hke(jc,Oe,Qe,Kc.getDefaultDisplayName());n.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Kc.getDefaultDisplayName())}catch(Oe){throw n.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Oe.message),Oe;}}}PUe(N,Ka,Cb,jc,Kc,kd=null){const qd={};qd.solutionId=N.solutionId;qd.version=N.version;qd.storeType=N.storeType;qd.storeId=N.assetStoreId;
qd.assetId=N.assetId;qd.assetStoreId=N.assetStoreId;qd.targetType=N.targetType;const yd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.No.QM,this.No.formFactor);try{const Jd=Ka.getManifest(),Vd=yd.parse(qd,Jd,Kc,this.nga,Ka.getSharedRuntimeId(),Ka),Oe=Cb(N),Qe=jc(N),lf=new mc(Oe,null,Qe);lf.commandSurface="PrimaryCommandSurface";Vd.apply(lf,this.nga,!0);if(lf.ribbonBuilder.Is&&0<lf.ribbonBuilder.Is.count){const qg=lf.pbd(N.solutionId,Ka.getManifest().getDefaultDisplayName(),1);sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.SXa(qg,kd):qg&&this.ribbonManager.SXa(qg,kd);this.UF.oBg(Ka,qg,Kc,Ka.getManifest().getDefaultDisplayName());n.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",Ka.getManifest().getDefaultDisplayName())}}catch(Jd){n.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",Ka.getManifest().getDefaultDisplayName(),Jd.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Jd)}}h1b(N){N.Do&&this.ribbonManager.YHd(N.Do);
N.hqb&&this.contextMenuManager.x9i(N.hqb);this.UF.e9i(N.sB.getStoreType(),N.sB.getSolutionId())}dXg(N,Ka){Ka=ch(Ka);for(let Cb of this.UF.j5a){if(Cb.sB.getStoreType()!==Ka)continue;let jc=!0;for(let Kc of N){const kd=Kc;if(kd&&Cb.Fff(kd.storeType,kd.solutionId)){jc=!1;break}}jc&&(this.h1b(Cb),Cb.sB.purge(!1))}}cfg(N){return!!N&&!!N.solutionId&&!!N.version&&!!N.storeType&&!!N.storeId}}Object(e.a)(kc,"AddInCommandsIntegration",null,[]);class lc{constructor(N,Ka,Cb,jc,Kc,kd,qd,yd=null){this.$a=new Aa.a;
this.kDc=N;this.Fmg=Ka;this.Tm=Cb;this.the=jc;this.DWa=Kc;this.Xjg=kd;this.sPb=qd;this.Fsg=yd;this.xqg=sd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled");this.lJc=sd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")}lDg(N){this.$a.addHandler(Rd.a.vne,N)}cFg(N){this.$a.addHandler(Rd.a.Nrd,N)}EGg(N){this.$a.addHandler(Rd.a.o2f,N)}sDg(N){this.$a.addHandler(Rd.a.vWc,N)}xqi(N,Ka,Cb){const jc=Cb[Rd.a.Pmb],
Kc=void 0===Cb[Rd.a.eP]?0:Cb[Rd.a.eP];if(jc&&0!==Kc)if(0>=jc.count&&4!==Kc)this.YGf(new Ke(Kc,null,null,Ka,null,!0));else{var kd=jc.count,qd=new ba(new ec),yd=void 0===Cb[Rd.a.d9]?-1:Cb[Rd.a.d9],Jd=new kc(Kc,this.Tm,this.kDc,qd,this.Fmg,this.DWa,this.sPb),Vd=ag=>this.the.CQg(ag.solutionId,this.sPb,this.kDc,N),Oe=ag=>this.the.NPg(ag.solutionId),Qe=(ag,bg,Rf)=>{kd--;Rf=new Ke(Kc,bg,qd,Ka,Rf,0>=kd);if(ag&&bg)this.YGf(Rf);else{if(3===Kc||bg&&bg.isUpgraded)ag="",bg&&(ag=Telemetry.PrivacyRules.GetPrivacyCompliantId(bg.solutionId,
bg.ownerAddinStoreType||bg.storeType,bg.assetId,null,null,bg.storeId)),bg={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:ag},ie.a.sendTelemetryEvent(Object.assign(new If.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ae.a.Uj(bg)}));this.XGf(Rf)}kd||sd.AFrameworkApplication.ta.updateCommandUI()},lf=(ag,bg,Rf,rg)=>{Qe(ag,bg,rg)},qg=()=>{this.txd();0>=jc.count&&4===Kc&&this.DWa.ENd()};6===Kc?(yd=Cb[Rd.a.dIa],Cb=Cb[Rd.a.eIa],Jd.eqi(jc.na(0),
yd,Cb,Vd,Oe,(ag,bg,Rf,rg)=>{Qe(ag,bg,rg)})):Jd.TAb(jc,Vd,Oe,yd,lf,qg,this.Fsg)}else ie.a.sendTelemetryEvent(Object.assign(new If.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ae.a.Uj({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),n.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.kDc.QM)),this.XGf(new Ke(Kc,null,null,Ka,null,!0))}XGf(N){this.txd(N);this.f3f(!1,
N)}YGf(N){const Ka=N.Zj;let Cb=null;null!==Ka&&(Cb=Ka.storeType,Cb=Cb.toLowerCase());if(N&&"omex"===Cb&&(3===N.Gq||Ka.isUpgraded)){var jc={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ka.solutionId,Ka.ownerAddinStoreType||Ka.storeType,Ka.assetId,null,null,Ka.storeId)};ie.a.sendTelemetryEvent(Object.assign(new If.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Ae.a.Uj(jc)}))}this.txd(N);jc=this.lJc&&Sg()&&"omex"===
Cb&&!!N.cW&&!!Ka.solutionId&&2===N.Gq&&Ka.solutionId.toLowerCase()===Ag().toLowerCase();if("omex"===Cb&&N.cW&&(3===N.Gq&&"hardcodedpreinstall"!==Cb||Ka.isUpgraded)||jc)jc=new wf,jc.Zj=Ka,jc.Do=N.cW.Vwa,this.$a.raiseEvent(Rd.a.vWc,jc);if(this.xqg){jc=ph();const Kc=Ag();jc&&Ka&&"excatalog"===Ka.storeType&&N.cW&&5===N.Gq&&Kc&&(Ka.storeId&&Ka.storeId.toLowerCase()===Kc.toLowerCase()||Ka.assetId&&Ka.assetId.toLowerCase()===Kc.toLowerCase())&&(jc=new wf,jc.Zj=Ka,jc.Do=N.cW.Vwa,this.$a.raiseEvent(Rd.a.vWc,
jc),n.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."))}Ka&&(je.instance.EXf(ah(Cb),!0),"uploadfiledevcatalog"===Cb&&(jc=this.Xjg.createAddinDataProvider(Cb,this.Tm))&&jc.localCacheAddinCommands(this.Tm.eca,Ka.solutionId,Ka.version,Ka.storeId),zd.a.teb(Rd.a.Rmb,"true",ah(Cb)));this.f3f(!0,N)}f3f(N,Ka){N?sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&Ka.cW&&5===Ka.Gq&&Ka.cW.Vwa&&void 0!==Ka.Zj.showCallout&&
null!==Ka.Zj.showCallout&&Ka.Zj.showCallout?(sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)?(new Qf(this.$a)).dTc(Ka.Zj,Ib.a.L2a(Ka.cW.Vwa)):(new gf(this.$a,Ka.Zj,Ib.a.L2a(Ka.cW.Vwa))).dTc(),N=new wf,N.Do=Ka.cW.Vwa,N.Zj=Ka.Zj,this.$a.raiseEvent(Rd.a.o2f,N)):3!==Ka.Gq?Ka.xif&&this.DWa.ENd():Ka.cW&&Ka.cW.Vwa&&"hardcodedpreinstall"!==Ka.Zj.storeType&&Ec.a.Lyj(Ka.displayName,Ka.cW.Vwa,Ka.Zj.isAutoLaunched):3===Ka.Gq?Ka.Zj&&"uploadfiledevcatalog"===
Ka.Zj.storeType.toLowerCase()?(Ka=this.sPb.LMh(Ka.Zj.solutionId),Ec.a.HQd(Ka?Ka:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.DWa.KYf():Ka.xif&&this.DWa.ENd()}txd(N=null){var Ka=N?N.Zj:null;const Cb=new wf;if(Cb.Zj=Ka){var jc=this.DWa.nia(Ka.storeType,Ka.solutionId,6===N.Gq?1:0);if(jc&&jc.Do){Cb.Do=jc.Do;var Kc=this.lJc?Ag():null;Kc=this.lJc&&Sg()&&!!Ka.solutionId&&!!Kc&&Ka.solutionId.toLowerCase()===Kc.toLowerCase()&&2===N.Gq;if(3===N.Gq&&"hardcodedpreinstall"!==
Ka.storeType||Kc)N="",jc.Do.oV&&jc.Do.oV.Is&&(jc=jc.Do.oV.Is.na(0))&&(N=jc.id),Ka={["SDX_CommandPlacement"]:N,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ka.solutionId,Ka.ownerAddinStoreType||Ka.storeType,Ka.assetId,null,null,Ka.storeId)},ie.a.sendTelemetryEvent(Object.assign(new If.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Ae.a.Uj(Ka)}))}}this.$a.raiseEvent(Rd.a.vne,Cb)}}Object(e.a)(lc,"LaunchAddinCommandsHandler",
null,[866]);class ad{}ad.TTa="Alt";ad.UTa="Command";ad.id="Id";ad.WTa="Image16by16";ad.bPb="LabelText";ad.XTa="Title";ad.GROUP="Group";ad.G_d="Groups";ad.xfb="Controls";ad.button="Button";ad.X$="FlyoutAnchor";ad.LARGE="Large";ad.SMALL="Small";Object(e.a)(ad,"AddinDataNodeConstants",null,[]);a(372);a(565);a(560);a(159);class vd{constructor(N,Ka){this.DDa=this.Y2d=null;if(te.c(N)||te.c(Ka))throw n.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");
this.Lmg=Ka;this._id=N;this.HT[ad.id]=this._id}get id(){return this._id||""}get HT(){return this.Y2d||(this.Y2d={})}get controlType(){return this.Lmg||""}get menuItems(){return this.DDa||(this.DDa=new l.a)}}Object(e.a)(vd,"ControlDefinition",null,[870]);class td{constructor(N){this.U$d=null;if(te.c(N))throw n.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=N;this.Rka[ad.id]=this._id}get Rka(){return this.U$d||
(this.U$d={})}get id(){return this._id||""}}Object(e.a)(td,"MenuItemDefinition",null,[900]);class Xd{constructor(N){this.Voa=null;if(te.c(N))throw n.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=N}get id(){return this._id}get controls(){return this.Voa||(this.Voa=new l.a)}}Object(e.a)(Xd,"OfficeMenuDefinition",null,[871]);var $d=a(25);class He{constructor(N,Ka,Cb){this.WI=
this.IUa=null;this.uMc=N;this.xUa=Ka;this.ZTa=Cb;this.dsg=new l.a}get Ckc(){return this.uMc}get Jpb(){return this.xUa}get gSc(){return this.ZTa}addButton(N){n.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",N.actionType);this.WI=new vd(this.Sra(N.id),ad.button);this.WI.HT[ad.bPb]=N.label;this.WI.HT[ad.TTa]=N.label;this.WI.HT[ad.WTa]=N.icon["16"];this.gob(this.WI.HT[ad.id],N.action);this.aFa(this.WI.HT);this.IUa.controls.add(this.WI);this.WI=null}startBuildMenu(N){if(te.c(this.IUa))this.IUa=
new Xd(N.id);else{const Ka=this.Sra(N.id);this.WI=new vd(Ka,ad.X$);this.CZa(this.WI.HT,N);this.WI.HT[ad.WTa]=N.icon["16"];this.WI.HT[ad.UTa]=$d.a.alwaysEnabled}}addMenuItem(N){n.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",N.actionType);const Ka=new td(this.Sra(N.id));this.CZa(Ka.Rka,N);N.icon&&(Ka.Rka[ad.WTa]=N.icon["16"]);this.gob(Ka.Rka[ad.id],N.action);this.aFa(Ka.Rka);this.WI.menuItems.add(Ka)}endBuildMenu(){te.c(this.WI)?(this.Wjc.add(this.IUa),this.IUa=null):(this.IUa.controls.add(this.WI),
this.WI=null)}get Wjc(){return this.dsg}gob(N,Ka){this.gSc.bindAction(N,Ka)}aFa(N){this.Jpb.aFa(N)}Sra(N){return this.Ckc.wJa(N)}CZa(N,Ka){N[ad.bPb]=Ka.label;N[ad.TTa]=Ka.label}}Object(e.a)(He,"ContextMenuExtensibilityCreator",null,[895,888]);class De{constructor(N){this.ujb=N}get FCb(){return this.ujb}wJa(N){return this.FCb+N}}Object(e.a)(De,"DefaultContextMenuNamingProvider",null,[896]);var Ge=a(1308);class jf{bindAction(N,Ka){OfficeExt.DefaultControlActionBinder.bindAction(N,Ka)}}Object(e.a)(jf,
"DefaultUIControlActionBinder",null,[893]);class df{constructor(N){this.kCa=N}get command(){return this.kCa}aFa(N){N[ad.UTa]=this.command}}Object(e.a)(df,"DefaultUIControlCommandBinder",null,[894]);var nf=a(32);class sf{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(e.a)(sf,"AddInControl",null,[]);class pf{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(e.a)(pf,
"AddInGroup",null,[]);class Lf{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(e.a)(Lf,"AddInMenuItem",null,[]);class vf{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(e.a)(vf,"AddInTab",null,[]);class Hg{constructor(N,Ka,Cb,jc,Kc,kd){this.pPb=new l.a;this.Ngb=this.Bea=this.JUa=null;this.uMc=N;this.ZTa=Ka;this.xUa=Cb;
this.$w=jc;this.sPb=Kc;this.W4d=kd}get Ckc(){return this.uMc}get Is(){return this.pPb}get gSc(){return this.ZTa}get Jpb(){return this.xUa}startBuildTab(N){const Ka=N.isOfficeTab?N.id:this.Ckc.Y1e(N.id),Cb=N.isOfficeTab?null:N.label;this.JUa=Object.assign(new vf,{id:Ka,title:Cb,isOfficeTab:N.isOfficeTab,visible:N.visible,groups:[],tabType:N.tabType,insertBefore:N.insertBefore,insertAfter:N.insertAfter,autoFocus:N.autoFocus})}startBuildGroup(N){const Ka=this.Sra(N.id);this.Bea=Object.assign(new pf,
{id:Ka,mlrId:N.mlrId,title:N.label,controls:[],groupType:0})}addNativeGroup(N){this.Bea=Object.assign(new pf,{id:N.id,mlrId:N.mlrId,title:N.label,controls:[],groupType:1});this.JUa.groups.push(this.Bea)}addButton(N){const Ka=this.Sra(N.id);Ka&&(this.gob(Ka,N.action),n.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",N.actionType),N=Object.assign(new sf,{id:Ka,title:N.label,iconLocation:this.Cdd(N),enabled:N.enabled,controlType:0,attributes:this.CZa()}),this.W4d.Pje(new nf.a(Ka,
this.Jpb.command.toString())),this.Bea.controls.push(N))}addNativeControl(N){N.id&&(n.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",N.actionType),N=Object.assign(new sf,{id:N.id,title:"",iconLocation:"",enabled:N.enabled,controlType:2,attributes:this.CZa()}),this.Bea.controls.push(N))}startBuildMenu(N){const Ka=this.Sra(N.id);Ka&&(this.Ngb=Object.assign(new sf,{id:Ka,title:N.label,iconLocation:this.Cdd(N),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(N){const Ka=
this.Sra(N.id);Ka&&(this.gob(Ka,N.action),n.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",N.actionType),N=Object.assign(new Lf,{id:Ka,title:N.label,iconLocation:this.Cdd(N),enabled:N.enabled,attributes:this.CZa()}),this.W4d.Pje(new nf.a(Ka,this.Jpb.command.toString())),this.Ngb.menuItems.push(N))}endBuildMenu(){te.c(this.Ngb.id)||this.Bea.controls.push(this.Ngb);this.Ngb=null}endBuildGroup(){te.c(this.Bea.id)||this.JUa.groups.push(this.Bea);this.Bea=null}endBuildTab(){te.c(this.JUa.id)||
this.pPb.add(this.JUa);this.JUa=null}CZa(){const N={};this.aFa(N);return N}Cdd(N){return N.icon["80"]?N.icon["80"]:N.icon["32"]}aFa(N){this.Jpb.aFa(N)}Sra(N){return this.Ckc.wJa(N)}gob(N,Ka){this.gSc.bindAction(N,Ka)}}Object(e.a)(Hg,"OneLineRibbonExtensibilityCreator",null,[887,888]);class Ig{constructor(N,Ka){this.ujb=N;this.ZTa=new jf;this.xUa=new df(Ka)}NPg(N){N=new De(N);return new He(N,this.xUa,this.ZTa)}CQg(N,Ka,Cb,jc){Cb=new Ge.a(this.ujb,N,Cb,!0);return new Hg(Cb,this.ZTa,this.xUa,N,Ka,jc)}}
Object(e.a)(Ig,"UIExtensibilityFactory",null,[862]);var Cg=a(90),Tg=a(858),eh=a(22),ef=a(37),Mg=a(77),og=a(50);class Qg{constructor(N){this.nFa=this.sFa=this.Zj=this.Do=null;this.tOf=0;this.aNi=()=>{if(this.Zj&&this.nFa){const Ka=new Cg.a($d.a.G1,0,0,2,null);this.addinUICommandHandler.executeCommand(0,Ka,{["SourceControlId"]:this.nFa},null);n.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.Myj=(Ka,Cb)=>{Ka=null;if(Cb)if(Ka=Cb,this.Zj=Ka.Zj,(this.Do=Ka.Do)&&this.Do.oV&&
this.Do.oV.Is&&(this.sFa=this.Do.oV.Is.na(0)),this.sFa&&this.sFa.id)if(this.sFa.isOfficeTab)if(Cb=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),Ka=this.Zj.solutionId,Ka in Cb?this.nFa=Cb[Ka]:(Cb=Qg.GetPrivacyCompliantId(this.Zj),n.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${Cb}`),this.nFa=this.FGh(this.Do)),this.nFa)if(eh.a.contains(this.sFa.id,fe.a.LV,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Ib.a.L2a(this.Do),
()=>{this.G3f(this.Med(this.nFa))});else{if(Cb=this.$.Ka)Cb.kne(this.NCf),n.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else n.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),Cb={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:Qg.GetPrivacyCompliantId(this.Zj),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ie.a.sendTelemetryEvent(Object(ac.a)(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Ae.a.Uj(Cb)})),this.a5();else this.I3f(this.Med(this.sFa.id),0);else n.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),Cb={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:Qg.GetPrivacyCompliantId(this.Zj),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ie.a.sendTelemetryEvent(Object(ac.a)(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(Cb)})),this.a5();
else this.a5()};this.NCf=()=>{if(eh.a.contains(this.sFa.id,appChrome.selectors.getSelectedTabId(),!0)){var Ka=this.$.Ka;Ka&&Ka.qQf(this.NCf);this.G3f(this.Med(this.nFa))}};this.cNi=()=>{var Ka={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Qg.VTa(this.zC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ie.a.sendTelemetryEvent(Object(ac.a)(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(Ka)}));this.a5();let Cb=
{};Cb[Mg.a.Zf]=this.zC;Ka={};Ka.solutionId=this.zC.solutionId;Ka.assetId=this.zC.assetId;Ka.assetStoreId=this.zC.assetStoreId;Ka.height=0!=this.zC.height?this.zC.height:600;Ka.storeId=this.zC.storeId;Ka.storeType=this.zC.storeType;Ka.targetType=this.zC.targetType;Ka.width=0!=this.zC.width?this.zC.width:600;Ka.displayName=this.zC.displayName;Ka.version=this.zC.version;Ka.isAddinCommands=!1;Cb[Rd.a.qra]=Ka;let jc=new Cg.a(-741808261,0,0,2,null);ef.TaskExtensions.Aa(og.GetServiceTaskFactory.Ra(this.$.da,
374,375,1),Kc=>{Kc=Kc.result;null!=Kc&&Kc.insertAgave(Cb,jc)},this.$.la,3)};this.QGi=()=>{let Ka={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Qg.VTa(this.zC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ie.a.sendTelemetryEvent(Object(ac.a)(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(Ka)}));this.a5()};this.jIi=()=>{let Ka={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Qg.VTa(this.zC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};ie.a.sendTelemetryEvent(Object(ac.a)(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(Ka)}));this.a5()};this.AV=Ka=>{n.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${Ka?Ka.httpStatus:-1}`)};this.$=N.$;this.addinUICommandHandler=N;this.appName=sd.AFrameworkApplication.fa.Va("WebAppShortName")||"Excel";this.mHg=sd.AFrameworkApplication.fa.nd("AddinMaxDOMElementDetectionTimesForTeachingUI",
10)}static GetPrivacyCompliantId(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.storeType,N.assetId,null,null,N.storeId)}static VTa(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.storeType,N.assetId,null,null,N.storeId)}A8i(N){this.zC=N;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.cNi,!0),window.addEventListener("DismissCallout",this.jIi,!0),window.addEventListener("CloseCallout",this.QGi,!0))}Med(N){return"[id="+N+"]"}I3f(N,
Ka){Ka>this.mHg?(window.clearTimeout(this.tOf),this.H3f("[data-unique-id='pivotOverflowButton']"),n.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+N)?this.H3f(N):this.tOf=window.setTimeout(()=>{this.I3f(N,Ka+1)},1E3)}G3f(N){var Ka=document.querySelector("button[data-unique-id='RightPaddle']");if(Ka)N={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:Qg.GetPrivacyCompliantId(this.Zj),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"},ie.a.sendTelemetryEvent(Object(ac.a)(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(N)}));else if(Ka=document.querySelector("button"+N),!Ka||"none"===window.getComputedStyle(Ka).display)if(Ka=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!Ka){Ka={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Qg.GetPrivacyCompliantId(this.Zj),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};
ie.a.sendTelemetryEvent(Object(ac.a)(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(Ka)}));n.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.a5();return}this.m$f(Ka,"ShowTeachingUIForAddinButton")}H3f(N){N=document.querySelector("button"+N);if(!N&&(N=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!N)){N={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Qg.GetPrivacyCompliantId(this.Zj),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};ie.a.sendTelemetryEvent(Object(ac.a)(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(N)}));n.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.a5();return}this.m$f(N,"ShowTeachingUIForAddinTab")}m$f(N,Ka){N.setAttribute("lpp-id","latestAddin");const Cb=Cd.a.instance.Wb("Common.ISystemInitiatedFeedback");Cb&&N?(Cb.execute(jc=>{jc.logActivity(Ka,null)}),N={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Qg.GetPrivacyCompliantId(this.Zj),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ie.a.sendTelemetryEvent(Object(ac.a)(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(N)})),n.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(n.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),N={["AppTeachingUICalloutAction"]:"NoSifFutureObject",
["SDX.Id"]:Qg.GetPrivacyCompliantId(this.Zj),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ie.a.sendTelemetryEvent(Object(ac.a)(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(N)})),this.a5())}FGh(N){if(!N)return null;N=N.oV;if((null===N||void 0===N?0:N.Is)&&0<N.Is.count)for(let Ka of N.Is)if(Ka.groups&&0<Ka.groups.length)for(const Cb of Ka.groups)if(Cb.controls&&0<Cb.controls.length)for(const jc of Cb.controls){if(jc.attributes&&
0===jc.controlType&&jc.enabled)return jc.id;if(jc.menuItems)for(const Kc of jc.menuItems)if(Kc.attributes&&Kc.enabled)return jc.id}return null}fBj(){var N=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(N&&"none"!==window.getComputedStyle(N).display)n.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{N=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==N){N={["AppTeachingUICalloutAction"]:"NoAnchor",
["SDX.Id"]:Qg.VTa(this.zC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ie.a.sendTelemetryEvent(Object(ac.a)(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(N)}));n.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.a5();return}n.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const Ka=Cd.a.instance.Wb("Common.ISystemInitiatedFeedback");null==
Ka||null==N?(N={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Qg.VTa(this.zC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ie.a.sendTelemetryEvent(Object(ac.a)(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(N)})),n.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.a5()):(Ka.execute(Cb=>{Cb.logActivity("ShowTeachingUIForContentAddin",null)}),N={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Qg.VTa(this.zC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ie.a.sendTelemetryEvent(Object(ac.a)(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj(N)})),n.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}u6(N){const Ka={},Cb={};Cb.LastTeachingUIShowTime=(new Date).toUTCString();Cb.AddinHasShown=N;Ka[this.appName]=pe.c(Cb);this.Umb=new lg(this.appName,null,null,
this.AV),this.Umb.X1a(Ka),n.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}a5(){if(sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&!this.pQa){const N=window.g_roamingAddinList;N&&(this.u6(N),this.pQa=!0)}}}Object(e.a)(Qg,"AddinTeachingCalloutHandler",null,[]);var Qh=a(1227),Fi=a(416),Eh=a(11),$h=a(182),Rh=a(40),Eg=a(21),kh=a(55);class Gi{constructor(N,
Ka,Cb,jc,Kc,kd,qd=null){this.disposed=!1;this.CFi=(yd,Jd)=>{if(Jd)if(Jd)if(yd=Jd.Zj){Jd=Jd.Do;var Vd=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(yd.solutionId in Vd)Jd=Vd[yd.solutionId];else if(Jd=this.xKh(Jd),void 0===Jd||null===Jd){n.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Vd=new Cg.a($d.a.G1,0,0,2,null);this.executeCommand(0,Vd,{["SourceControlId"]:Jd},null);yd.isAutoLaunched=!0}else n.ULS.sendTraceTag(528098435,220,
15,"insertionParam is null");else n.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else n.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.k$e=(yd,Jd)=>{"Insert"==Jd.tabName&&(yd=this.$.Ka,null!=yd&&(yd.qQf(this.k$e),n.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.tMb.fBj())};this.bNi=(yd,Jd)=>{yd=null;Jd&&(yd=Jd);(null===yd||void 0===yd?0:yd.Do)&&this.Trj(yd.Do);this.$.qf();z.EwaSettings.ma(87)&&yd&&yd.Zj&&this.IMg(yd.Zj)};this.$=
N;n.ULS.shipAssertTag(537170659,0,!(void 0===Ka||null===Ka),`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${Rh.a.y2()}`);this.oe=Ka;this.HAe=Cb;this.OYb=jc;this.oga=Kc;this.Smb=kd;this.No=new Tg.a;this.nga=new $f;this.C9c=qd;ne.a.Uwb=ne.a.OPe;this.F4c=new l.a;this.Y0a=new l.a}dispose(){void 0!==this.Smb&&null!==this.Smb&&(this.Smb.dispose(),this.Smb=null);this.oe=this.$=null;this.disposed=!0}bwj(N,Ka){switch(N){case $d.a.G1:N=this.Nvj(Ka);break;default:N=!1}return N}Nc(){return!1}executeCommand(N,
Ka,Cb){N=ef.TaskExtensions.fk();Ka=Ka.command;switch(Ka){case 843847158:break;case -2025863019:Ec.a.HQd(Cb[Rd.a.xUc].toString(),()=>{Eg.g(this.$).focus()});break;case -1777565636:Qh.a.showUILessDialog(Cb[Rd.a.Tmb].toString());this.oe.$yj(Cb[Rd.a.Tmb].toString());break;case 1592314317:Qh.a.hideUILessDialog(Cb[Rd.a.Tmb].toString());this.oe.n5h(Cb[Rd.a.Tmb].toString());break;case $d.a.G1:N=this.Egd(Cb);break;case $d.a.SAb:this.TAb(Cb);break;case $d.a.yma:this.yma(Cb);break;case $d.a.IQd:this.Smb.Hwc();
break;case $d.a.refreshAddinCommands:this.p6i();break;case 1949669462:this.oga.KYf(!0);break;case -1014260128:N=this.executeDynamicAddInCommandsAPI(Cb);break;default:N=$h.a(Ka)}return N}Cc(N,Ka){N=!1;switch(Ka.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case $d.a.yma:case $d.a.IQd:case $d.a.refreshAddinCommands:case 1949669462:case $d.a.SAb:case -1014260128:N=!0;break;case $d.a.G1:N=!sd.AFrameworkApplication.protectedFile}return N}Rc(){return!1}xKh(N){if(!N)return n.ULS.sendTraceTag(528098432,
220,10,"Failed to get button id for addin"),null;if((N=N.oV)&&N.Is&&0<N.Is.count)for(let Ka of N.Is){if(Ka.groups&&1===Ka.groups.length){N=Ka.groups[0];if(N.controls&&1===N.controls.length){const Cb=N.controls[0];if(Cb.attributes&&!Cb.controlType&&Cb.enabled)return Cb.id}N.controls&&n.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}Ka.groups&&n.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}p6i(){if(this.oga.Dsd()){this.oga.qxe();var N=this.Jbd();if(N&&0<N.count)for(let Ka of N)N=
{[Rd.a.d9]:Ka,[Rd.a.eP]:4,[Rd.a.qFa]:(new Date).getTime()},this.yma(N)}}yma(N){n.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${N[Rd.a.eP]}, DataProvider ${N[Rd.a.d9]}.`);this.oga.goj();window.setTimeout(()=>{if(void 0===this.oe||null===this.oe)n.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${Rh.a.y2()}`);else{const Ka=new ka(new qb(this.oe.Sh),pc.instance,
je.instance);Ka.kDg((Cb,jc)=>{this.TAb(jc.properties)});sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&sd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&Ka.FGg((Cb,jc)=>{null==jc?ie.a.sendTelemetryEvent(Object(ac.a)(new If.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ae.a.Uj({["AppTeachingUICalloutAction"]:"InvalidEventArgs",["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"})})):(this.tMb=new Qg(this),this.tMb.A8i(jc),Cb=this.$.Ka,null!=Cb&&(Cb.kne(this.k$e),n.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Ka.yNj(N)}},0)}TAb(N){if(!this.disposed){n.ULS.sendTraceTag(537170655,220,50,`LaunchOperationType ${N[Rd.a.eP]}.`);try{if(z.EwaSettings.ma(186)){const Cb=N[Rd.a.Pmb];if(Cb&&0<Cb.count){const jc=Cb.count;for(let Kc=jc-1;0<=Kc;Kc--){const kd=Cb.na(Kc);OSF.OsfControl.isFirstPartyStoreString(kd.storeType)||
Cb.remove(Cb.na(Kc))}if(Cb.count<jc){const Kc=og.GetServiceTaskFactory.Ra(this.$.da,5,4,0);ef.TaskExtensions.Aa(Kc,()=>{Kc.result.Yf(36,null)},this.$.la,3)}if(!Cb.count)return}}if(void 0===this.oe||null===this.oe)n.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${Rh.a.y2()}`);else{var Ka=null;Ka=sd.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled")?new lc(this.No,this.HAe,new qb(this.oe.Sh),new Ig(this.$.Bb,$d.a.G1),this.oga,
pc.instance,this.nga,(Cb,jc)=>{const Kc={};Kc.InstanceId=Se.a.create().toString();Kc.PrimaryMarketplace={};Kc.PrimaryMarketplace.SolutionId=Cb.solutionId;Kc.PrimaryMarketplace.SolutionVersion=Cb.version;Kc.PrimaryMarketplace.MarketplaceType=Cb.storeType;Kc.PrimaryMarketplace.MarketplaceRef=Cb.storeId;Kc.WebExtensionType=1;this.oe.lBj(Kc,()=>{jc(Cb)})}):new lc(this.No,this.HAe,new qb(this.oe.Sh),new Ig(this.$.Bb,$d.a.G1),this.oga,pc.instance,this.nga);Ka.sDg(this.CFi);Ka.lDg(this.bNi);if(sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)){const Cb=new Qg(this);Ka.cFg(Cb.aNi);Ka.EGg(Cb.Myj)}this.$.da.za(53).Vl&&Ff.a.get_instance().rk(5,null).continueWith(()=>{this.disposed||Ka.xqi(this.C9c,this.$.domElement,N)})}}catch(Cb){n.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${Cb.message}.`)}}}Egd(N){const Ka=ef.TaskExtensions.fk();N=N[this.No.qha];const Cb=this.OYb.hSc(N),jc=new Qh.a(this.$,this.oe,Cb.ownerAddinInfo,Ka);return this.R3e(Ka,N,Cb,jc)}R3e(N,Ka,Cb,jc){this.OYb.Egd(Ka,this.oga,jc,new qb(this.oe.Sh),
Cb,()=>{N=jc.Y0g()},()=>{Eg.g(this.$).focus()});return N}IMg(N){const Ka=ef.TaskExtensions.fk();var Cb=this.oe.S$(N.solutionId);if(Cb){var jc=this.oe.BY(Cb);if(Eh.HelperMethods.iw(jc)&&0!==jc.SharedRuntime.State)return}jc=this.OYb.JMg;const Kc=N.solutionId in jc?jc[N.solutionId]:null;if(Kc){const kd=this.OYb.hSc(Kc),qd=new Qh.a(this.$,this.oe,kd.ownerAddinInfo,Ka),yd=Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,null!==kd.ownerAddinInfo?kd.ownerAddinInfo.storeType:N.storeType,N.assetId,
null,null,N.storeId);jc=Jd=>{if(Jd){const Vd={};for(const Oe of Jd)Vd[Oe[0]]=Oe[1];(Jd=Rd.a.tne in Vd?Vd[Rd.a.tne]:null)&&"true"===Jd.toLowerCase()&&(n.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${N.storeType}, StoreId ${N.storeId}, SolutionId ${yd}.`),this.R3e(Ka,Kc,kd,qd))}};n.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${N.storeType}, StoreId ${N.storeId}, SolutionId ${yd}.`);if(Cb)jc(this.oe.BY(Cb).OsfPropertyBag);else if(Cb=
this.$.ea.workbookContext.WebExtensions)for(const Jd of Cb)if((1===Jd.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===N.targetType&&Jd.PrimaryMarketplace.MarketplaceType.toLowerCase()===N.storeType.toLowerCase()&&Jd.PrimaryMarketplace.MarketplaceRef.toLowerCase()===N.storeId.toLowerCase()&&Jd.PrimaryMarketplace.SolutionId.toLowerCase()===N.solutionId.toLowerCase()){jc(Jd.OsfPropertyBag);break}}}WTd(N,Ka,Cb=!1){N&&(!Cb||Ka||this.F4c.contains(N)||this.F4c.add(N),(Cb=
this.Y0a.contains(N))&&Ka&&this.Y0a.remove(N),Cb||Ka||this.Y0a.add(N))}Trj(N){if((N=N.oV)&&N.Is)for(let Ka of N.Is)if(Ka.groups)for(const Cb of Ka.groups)if(Cb.controls)for(const jc of Cb.controls)if(this.WTd(jc.id,jc.enabled,!0),1===jc.controlType&&jc.menuItems)for(const Kc of jc.menuItems)this.WTd(Kc.id,Kc.enabled,!0)}Jbd(){const N=new l.a;z.EwaSettings.ma(53)&&(this.$.ea.Tg.get(27)&&(N.add(0),N.add(16)),this.$.ea.Tg.get(33)&&N.add(1),N.add(8));return N}executeDynamicAddInCommandsAPI(N){let Ka=
!0;if(void 0===N||null===N||void 0===N[Rd.a.dsb]||null===N[Rd.a.dsb])return kh.Task.Ta(!1);switch(N[Rd.a.dsb]){case 1:Ka=this.EQj(N);break;case 2:Ka=this.Xrj(N);break;case 4:this.Y0a.clear();this.Y0a.addRange(this.F4c);break;case 3:Ka=this.installContextualTab(N);break;default:Ka=!1}return kh.Task.Ta(Ka)}Nvj(N){return N&&this.No.qha in N?(N=N[this.No.qha])?this.Y0a.contains(N):!1:!1}EQj(N){var Ka=null;let Cb=null,jc=null,Kc=!0;void 0!==N[Rd.a.X2]&&null!==N[Rd.a.X2]&&void 0!==N[this.No.qha]&&null!==
N[this.No.qha]&&void 0!==N[Rd.a.W2]&&null!==N[Rd.a.W2]&&(Ka=N[Rd.a.X2],Cb=N[Rd.a.h6b],jc=N[this.No.qha],Kc=N[Rd.a.W2]);if(!Ka||!jc)return n.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;N=(new Ge.a(this.$.Bb,Ka,this.No,!0)).wJa(jc);Ka={DynamicAddinCommandsApiName:"UpdateControlEnableState"};Ka.AssetId=Cb;Ka.MaskedTabId=N;Ka.IsToEnable=Kc;n.ULS.sendTraceTag(537170648,220,50,w.a.Ac(Ka));this.WTd(N,Kc);Fi.a.fC.updateCommandUI();return!0}Xrj(N){var Ka,
Cb,jc=null,Kc=null;let kd=null;var qd=null;let yd=!0;void 0!==N[Rd.a.k6c]&&null!==N[Rd.a.k6c]&&void 0!==N[Rd.a.X2]&&null!==N[Rd.a.X2]&&void 0!==N[this.No.qha]&&null!==N[this.No.qha]&&void 0!==N[Rd.a.W2]&&null!==N[Rd.a.W2]&&(jc=N[Rd.a.k6c],Kc=N[Rd.a.X2],kd=N[Rd.a.h6b],qd=N[this.No.qha],yd=N[Rd.a.W2]);if(!jc||!Kc||!qd)return n.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;N=(new Ge.a(this.$.Bb,Kc,this.No,!0)).Y1e(qd);qd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};
qd.StoreType=jc;qd.AssetId=kd;qd.MaskedTabId=N;qd.IsToShow=yd;n.ULS.sendTraceTag(537170646,220,15,w.a.Ac(qd));jc=this.oga.nia(jc,Kc,1);Kc=!1;if(null===(Cb=null===(Ka=null===jc||void 0===jc?void 0:jc.Do)||void 0===Ka?void 0:Ka.oV)||void 0===Cb?0:Cb.Is)for(let Jd of jc.Do.oV.Is)if(Jd.id===N){Kc=!0;break}if(!Kc)return n.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;Ka=[];yd?appChrome.selectors.getSelectedTabId()!==N&&Ka.push(appChrome.actions.activateRibbonTab(N)):
(appChrome.selectors.getSelectedTabId()===N&&Ka.push(appChrome.actions.setCurrentTab(fe.a.LV)),Ka.push(appChrome.actions.deactivateRibbonTab(N)));appChrome.api.dispatch(Ka);return!0}installContextualTab(N){let Ka=null,Cb=null,jc=null;var Kc=null;if(void 0!==N[Rd.a.X2]&&null!==N[Rd.a.X2]&&void 0!==N[Rd.a.W2]&&null!==N[Rd.a.W2]){const kd=N[Rd.a.W2];Ka=N[Rd.a.X2];void 0!==kd[Rd.a.dIa]&&null!==kd[Rd.a.dIa]&&void 0!==kd[Rd.a.eIa]&&null!==kd[Rd.a.eIa]&&(Cb=kd[Rd.a.dIa],jc=kd[Rd.a.eIa],Kc=kd[Rd.a.l6c])}if(!(Ka&&
jc&&Cb&&Kc))return n.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;N=this.oga.nia(Kc.PrimaryMarketplace.MarketplaceType,Kc.PrimaryMarketplace.SolutionId,1);if(null===N||void 0===N?0:N.Do)return n.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;N={};N.solutionId=Kc.PrimaryMarketplace.SolutionId;N.version=Kc.PrimaryMarketplace.SolutionVersion;N.storeType=Kc.PrimaryMarketplace.MarketplaceType;N.storeId=Kc.PrimaryMarketplace.MarketplaceRef;
N.assetId=Kc.PrimaryMarketplace.SolutionId;N.assetStoreId=Kc.PrimaryMarketplace.MarketplaceRef;N.targetType=Kc.WebExtensionOsfControlType;N.width=Kc.TaskpaneWidth;N.height=0;N.isAddinCommands=!0;Kc=new l.a;Kc.add(N);N={};N[Rd.a.Pmb]=Kc;N[Rd.a.eP]=6;N[Rd.a.dIa]=Cb;N[Rd.a.eIa]=jc;this.TAb(N);return!0}}Object(e.a)(Gi,"AddinUICommandHandler",null,[838,195,2]);var Wi=a(62),Hi=a(597),Xi=a(18),Ii=a(16);class ai extends Yd.a{constructor(N){super(N);this.handler=null;this.Yyg=()=>{n.ULS.sendTraceTag(38410434,
0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.Bd&16384)}]`);const Ka=new Gd.a;this.$.da.Za(53,Vd=>{n.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");Ka.setResult(Vd)});const Cb=Ka.task,jc=new zc,Kc=Yc.a.getInstance(),kd=new Zd(this.$,Kc),qd=og.GetServiceTaskFactory.create(this.$.da,203,this.la,this.hb),yd=this.b7i(jc),Jd=og.GetServiceTaskFactory.Ra(this.$.da,349,
350,this.hb);return ef.TaskExtensions.Aa(ef.TaskExtensions.Wd([Cb,qd,yd,Jd],this.la),()=>{n.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");ef.TaskExtensions.Aa(og.GetServiceTaskFactory.create(this.$.da,106,this.la,this.hb),Vd=>{this.handler=new Gi(this.$,Vd.result,jc,new fd,Kc,kd,Cd.a.instance.vh("Common.IExternalUICommandDefinitionMapping"));n.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");
this.gd([this.handler]);this.$.da.Ga(198,this.handler)},this.la,3)},this.la,3)};this.pbh=()=>{void 0!==this.handler&&null!==this.handler?(this.$.Ka.Iab(this.handler),this.$.da.XT(198),this.handler=null):n.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.da.XT(204);Ii.a(Xi.a,21,this.$.da,198)}}yd(){n.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");Wi.a(this.$).add(Object(ac.a)(new Hi.a,
{Ovc:()=>{const N=this.$.ea.vF&&this.$.ea.fc&&!!(this.$.Bd&16384)&&this.$.isEditMode;this.$.ea.fc&&n.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${N}] IsSessionFullyLoaded [${this.$.ea.vF}] IsSessionActive [${this.$.ea.fc}] ShowCommandUI [${!!(this.$.Bd&16384)}] IsEditMode [${this.$.isEditMode}]`);return N},YWb:this.Yyg,B4b:this.pbh,c2a:2}))}b7i(N){const Ka=og.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb);
return ef.TaskExtensions.Aa(Ka,()=>{n.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.da.Ga(204,new rf(Ka.result,N))},this.la,3)}static ka(N){Yd.a.Nd(199,new ai(N))}}Object(e.a)(ai,"AddinUICommandHandlerFactory",Yd.a,[]);var bi=a(1185),ci=a(1189),Sh=a(696);class ui extends k.a{constructor(N){super();this.$=N;this.Fb()}create(){let N;if(z.EwaSettings.ma(400)){const Ka=og.GetServiceTaskFactory.create(this.$.da,
106,this.$.la,this.hb),Cb=og.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.hb);ef.TaskExtensions.Aa(kh.Task.zL(Ka,Cb),()=>{z.EwaSettings.isChangeGateEnabled("OfficeVSO:6894126_FAMServiceRegistrationFixes")?this.qb(Object(Sh.a)(this.$.da,278,()=>new bi.CustomFunctionsInstaller(this.$,Ka.result,Cb.result))):this.qb(this.$.da.za(278)||new bi.CustomFunctionsInstaller(this.$,Ka.result,Cb.result))},this.$.la,3)}else z.EwaSettings.isChangeGateEnabled("OfficeVSO:6894126_FAMServiceRegistrationFixes")?
N=Object(Sh.c)(this.$.da,278,()=>new ci.CustomFunctionsLegacyInstaller(this.$)):(N=this.$.da.za(278))||(N=this.$.da.Ga(278,new ci.CustomFunctionsLegacyInstaller(this.$))),this.qb(N)}static ka(N){N.da.Ga(279,new ui(N))}}Object(e.a)(ui,"CustomFunctionsInstallerFactory",k.a,[]);var vi=a(86),Fh=a(47),fh=a(45);class di{constructor(N,Ka){this.qPa=this.rPa=null;this.p$f=(Cb,jc)=>{let Kc=null,kd=null,qd=null;jc?(Object(K.a)(382,jc)?(Kc=jc.zFa,qd=jc.instanceId):Object(K.a)(520,jc)&&(Kc=jc.get_element(),qd=
jc.instanceId),Kc)?(kd=Object(L.a)(816,Cb),kd)?this.WLf(qd,Kc,kd)||qd in this.qPa||(this.rPa[qd]=0,this.qPa[qd]=Fh.a.instance.FE(()=>{10<=this.rPa[qd]||this.WLf(qd,Kc,kd)?(delete this.rPa[qd],this.qPa[qd].dispose(),delete this.qPa[qd]):this.rPa[qd]+=1},500,fh.a.YHg,!0,!1)):n.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):n.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):n.ULS.sendTraceTag(537170626,
0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=N;this.$=Ka;this.kWc=!1;this.$.da.Ga(224,this)}ka(N){this.kWc?n.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.kWc=!0,this.qPa={},this.rPa={},N?N.WDg(this.p$f):n.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(N){if(N){N.jaj(this.p$f);N=this.qPa;for(let Ka in N)vi.a.Ia(N[Ka]);this.rPa=this.qPa=
null;this.kWc=!1}else n.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}WLf(N,Ka,Cb){if(this.ydi(Cb,N))return!1;N=Ka.querySelector("iframe");if(!N)return n.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;N=N.title;if(!N||!N.length)return n.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(N);
return!0}ydi(N,Ka){return(N=N.Sh.getOsfControl(Ka))?N.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}}Object(e.a)(di,"AgaveOnSelectedReadoutHandler",null,[817]);class Th extends k.a{constructor(N){super();this.$=N;this.Fb()}create(){const N=this.$.da;ef.TaskExtensions.Aa(og.GetServiceTaskFactory.Ra(N,211,212,this.hb),Ka=>{Ka=N.za(224)||new di(Ka.result,this.$);this.qb(Ka)},this.la,3)}static ka(N){N.da.Ga(225,new Th(N))}}Object(e.a)(Th,"AgaveOnSelectedReadoutHandlerFactory",k.a,[]);var yg=a(733),
ei=a(54);const lh=(N,Ka)=>ei.a.zsd(65,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,sd.AFrameworkApplication.fa.nd("MaxRetriesForLoadingScript",0),N,Ka);var Ji=a(237);class Uh{constructor(N,Ka,Cb){this.iframe=N;this.onSuccess=Ka;this.onError=Cb;$addHandler(window,"message",Object(md.a)(this,this.Y4e,"handleResponse"))}Y4e(N){try{if(N&&N.rawEvent&&N.rawEvent.origin&&this.iframe&&this.iframe.id){var Ka=this.qFf(N.rawEvent.origin);const Cb=this.qFf(document.domain);if(T.a.Sk().equals(Cb,
Ka))if(N.rawEvent.source&&N.rawEvent.source.frameElement&&N.rawEvent.source.frameElement.id&&T.a.Sk().equals(N.rawEvent.source.frameElement.id,this.iframe.id)){Ka=null;try{Ka=JSON.parse(N.rawEvent.data)}catch(jc){n.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",jc.message)}Ka?(Ka.statusCode!==Ji.a.FO||void 0!==Ka.error&&Ka.error?(n.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",
Ka.statusCode,Ka.error),this.onError()):(n.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(Ka.authorizationCode?Ka.authorizationCode:Ka.signInUrl)),$removeHandler(window,"message",Object(md.a)(this,this.Y4e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):n.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):n.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):n.ULS.sendTraceTag(575976219,
344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else n.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else n.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else n.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Cb){n.ULS.sendTraceTag(23707649,
344,10,"Exception in authentication proxy message handler: {0}.",Cb.message)}}qFf(N){let Ka="";try{N&&(Ka=-1<N.indexOf("//")?N.split("/")[2]:N.split("/")[0])&&(Ka=Ka.split(":")[0],Ka=Ka.split("?")[0])}catch(Cb){n.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Cb.message)}return Ka}static ka(N,Ka,Cb){new Uh(N,Ka,Cb)}}Object(e.a)(Uh,"ResponseHandler",null,[]);var dd=a(251);class Fd{constructor(N){this.NEa=N}tryAuthenticate(N,Ka){this.o$a(Fd.Mpg,()=>{N()},Ka)}tryAuthorize(N,
Ka){this.o$a(Fd.Tkg,N,Ka)}getSignInUrl(N,Ka){this.o$a(Fd.Sfe,N,Ka)}signOut(N,Ka){this.o$a(Fd.Pvg,N,Ka)}o$a(N,Ka,Cb){var jc=new dd.QueryStringBuilder("AuthenticationProxyHandler.aspx");jc.Qi("responseType",N);sd.AFrameworkApplication.NXa(jc);jc=String.format("{0}{1}&{2}",this.NEa,jc.toString(),sd.AFrameworkApplication.ij);const Kc=document.createElement("iframe");Kc.setAttribute("id","privateCatalogIframe");Kc.setAttribute("name","privateCatalogIframe");Kc.setAttribute("style","display: none");T.a.Sk().equals(N,
Fd.Sfe)||Kc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Uh.ka(Kc,Ka,Cb);Kc.setAttribute("src",jc);document.body.appendChild(Kc)}}Fd.Tkg="authcode";Fd.Mpg="identitytoken";Fd.Sfe="signinurl";Fd.Pvg="signout";Object(e.a)(Fd,"AuthenticationProxy",null,[]);class Nf{}Nf.getUserId="getUserId";Nf.getLastStoreUpdate="laststoreupdate";Nf.getEntitlement="getEntitlements";Nf.getEToken="getEToken";Nf.getManifest="getManifest";Nf.getAppState="getAppState";
Nf.getKilledApps="getRemovedAddins";Nf.getAppDetails="getAppDetails";Nf.removeApps="removeAddin";Nf.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";Nf.getPrivateCatalogAddIns="getAddIns";Nf.getPrivateCatalogManifests="getAppManifests";Nf.isStoreDisabled="isStoreDisabled";Object(e.a)(Nf,"S2SWebRequestActions",null,[]);var Yi=a(574);class Ah{getUserId(N,Ka){const Cb=new l.a;Cb.add(new za.a("corr",N));this.iW(Nf.getUserId,Cb,1,Ka)}getLastStoreUpdate(N,Ka,Cb){const jc=new l.a;jc.add(new za.a("lc",
N));jc.add(new za.a("corr",Ka));this.iW(Nf.getLastStoreUpdate,jc,1,Cb)}getEntitlement(N,Ka,Cb,jc){N=new l.a;N.add(new za.a("av",Ka));N.add(new za.a("corr",Cb));this.iW(Nf.getEntitlement,N,1,jc)}getEToken(N,Ka,Cb,jc,Kc,kd){const qd=new l.a;qd.add(new za.a("cmu",N));qd.add(new za.a("cmf",Ka));qd.add(new za.a("assetid",Cb));qd.add(new za.a("expver",jc));qd.add(new za.a("corr",Kc));this.iW(Nf.getEToken,qd,1,kd)}getManifest(N,Ka,Cb,jc){const Kc=new l.a;Kc.add(new za.a("cmu",N));Kc.add(new za.a("assetid",
Ka));Kc.add(new za.a("corr",Cb));this.iW(Nf.getManifest,Kc,1,jc)}getAppState(N,Ka,Cb){const jc=new l.a;jc.add(new za.a("ma",N));jc.add(new za.a("corr",Ka));this.iW(Nf.getAppState,jc,1,Cb)}getKilledApps(N,Ka){const Cb=new l.a;Cb.add(new za.a("corr",N));this.iW(Nf.getKilledApps,Cb,1,Ka)}getAppDetails(N,Ka,Cb,jc){const Kc=new l.a;Kc.add(new za.a("cmo",N));Kc.add(new za.a("corr",Cb));this.sendWithBody(Nf.getAppDetails,Kc,Ka,2,jc,!1)}removeApps(N,Ka,Cb){const jc=new l.a;jc.add(new za.a("corr",Ka));this.sendWithBody(Nf.removeApps,
jc,N,2,Cb,!1)}getLastPrivateCatalogUpdate(N,Ka,Cb,jc,Kc,kd){const qd=new l.a;qd.add(new za.a("catalog","privatecatalog"));qd.add(new za.a("clientCode",N));qd.add(new za.a("clientVersion",Ka));qd.add(new za.a("corr",Kc));N=String.format("authorizationCode={0}&refreshToken={1}",Cb?Bf.a.ff(Cb):"",jc?Bf.a.ff(jc):"");this.sendWithBody(Nf.getLastPrivateCatalogUpdate,qd,N,2,kd,!0)}getPrivateCatalogAddIns(N,Ka,Cb,jc,Kc,kd){const qd=new l.a;qd.add(new za.a("catalog","privatecatalog"));qd.add(new za.a("clientCode",
N));qd.add(new za.a("clientVersion",Ka));qd.add(new za.a("corr",Kc));N=String.format("authorizationCode={0}&refreshToken={1}",Cb?Bf.a.ff(Cb):"",jc?Bf.a.ff(jc):"");this.sendWithBody(Nf.getPrivateCatalogAddIns,qd,N,2,kd,!0)}getPrivateCatalogManifests(N,Ka,Cb,jc,Kc){const kd=new l.a;kd.add(new za.a("catalog","privatecatalog"));kd.add(new za.a("corr",jc));N=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Bf.a.ff(N),Ka?Bf.a.ff(Ka):"",Cb?Bf.a.ff(Cb):"");this.sendWithBody(Nf.getPrivateCatalogManifests,
kd,N,2,Kc,!0)}isStoreDisabled(N,Ka){const Cb=new l.a;Cb.add(new za.a("corr",N));this.iW(Nf.isStoreDisabled,Cb,2,Ka)}iW(N,Ka,Cb,jc){this.sendWithBody(N,Ka,null,Cb,jc,!1)}sendWithBody(N,Ka,Cb,jc,Kc,kd){const qd=new dd.QueryStringBuilder("AddinServiceHandler.ashx");qd.Qi("action",N);qd.Qi("app",Yi.a[sd.AFrameworkApplication.ta.Oa.xj]);for(let yd of Ka)qd.Qi(yd.key,yd.value);Ka=String.format("{0}{1}&{2}",sd.AFrameworkApplication.ta.Oa.iV,qd.toString(),sd.AFrameworkApplication.ij);sd.AFrameworkApplication.vd.Bm(Ka,
jc,Cb,null,!1,2,yd=>{let Jd=null,Vd=null;yd&&yd.data&&(yd.data.responseHeaders["X-BlockedForMinor"]&&"1"===yd.data.responseHeaders["X-BlockedForMinor"].toString()&&(yd.data.httpStatus=451),Jd=yd.data.Vd,Vd=yd.data.responseHeaders);Kc(yd.data.httpStatus,Jd,Vd)},yd=>{var Jd=null;let Vd=null;kd&&yd&&yd.data&&yd.data.Vd&&(Jd=yd.data.Vd,Vd=yd.data.responseHeaders);Kc(yd.data.httpStatus,Jd,Vd);if(sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",
!0)){Jd={message:"AddinServiceHandler request failed"};Jd.code=yd.data.httpStatus;Jd.action=N;if(yd.data.request||yd.data.request.get_headers())Jd["X-UserSessionId"]=yd.data.request.get_headers()["X-UserSessionId"];408===yd.data.httpStatus||503===yd.data.httpStatus?n.ULS.sendTraceTag(538784582,220,10,JSON.stringify(Jd)):n.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Jd))}else n.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",yd.data.httpStatus)},null,void 0,void 0,void 0,void 0,
"AddinServiceHandler_"+N,void 0,void 0,void 0,void 0,["X-UserKey"])}}Object(e.a)(Ah,"S2SWebRequestManager",null,[]);class fi extends k.a{constructor(N){super();this.VLf=this.ddaFacade=null;this.$=N;N.da.Ga(106,this);this.Fb()}get oe(){return this.ddaFacade||(this.ddaFacade=new yg.DdaFacade(this.$,this.VLf))}create(){n.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");sd.AFrameworkApplication.disableWholeAppsForOfficeFeature?n.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${sd.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):
z.EwaSettings.ma(404)?Cd.a.instance.Wb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(N=>{N.isFeatureEnabled("mso_officeStore",!0).then(Ka=>{yg.DdaFacade.H2b=Ka;this.RCe();return null})}):this.RCe()}RCe(){const N=og.GetServiceTaskFactory.Ra(this.$.da,224,225,this.hb),Ka=ei.a.zsd(64,()=>!(void 0===window.OSF||null===window.OSF),this.$.ya.MaxRetriesForLoadingScript,this.$.la,this.hb,106),Cb=lh(this.la,this.hb);ef.TaskExtensions.Aa(ef.TaskExtensions.Wd([N,Ka,Cb],this.$.la),
()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?n.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${Rh.a.y2()}`):this.S8h();n.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.VLf=N.result;this.qb(this.oe);n.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.la,3)}S8h(){z.EwaSettings.ma(64)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Ah);
this.$.me.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Ah,new Fd(sd.AFrameworkApplication.fa.appSettings.WebServiceBase),z.EwaSettings.ma(71),z.EwaSettings.ma(431));OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new Ah);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Ah)}dispose(){vi.a.Ia(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static ka(N){new fi(N)}}Object(e.a)(fi,"DdaFacadeServiceFactory",
k.a,[]);var gi=a(454);class Vh{constructor(N,Ka,Cb,jc,Kc,kd){this.$=N;this.agaveCommandManager=kd}Rc(){return!1}Nc(){return!1}Cc(N,Ka,Cb,jc){let Kc=!1;switch(Ka.command){case -684355545:Kc=!0;break;case -741808261:Kc=!!Cb;break;case -859308420:Kc=!!jc&&1===jc.Sy;break;case 418618014:Kc=1===N&&!!jc&&1===jc.Sy;break;case -515602470:Ka=z.EwaSettings.ma(234)&&2===N;Kc=(1===N||Ka)&&!!jc&&1===jc.Sy;break;case 2086613372:Kc=z.EwaSettings.ma(234)&&2===N&&!!jc&&1===jc.Sy;break;case -1336341324:Kc=z.EwaSettings.ma(479)&&
1===N&&!!jc&&1===jc.Sy;break;case 451940422:Kc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",!1)&&1===N&&!!jc&&1===jc.Sy;break;case -1444574190:case -336193495:Kc=1===N&&!!jc&&1===jc.Sy;break;case 1296389134:Kc=1===N&&!!jc&&1===jc.Sy;break;case -1473679467:Kc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&1===N&&!!jc&&1===jc.Sy;break;case 1221897806:Kc=z.EwaSettings.ma(166)&&2===N;break;case 1172793074:case 1930653487:Kc=
z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===N;break;case -1753056834:Kc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:Kc=!0;break;case 301511274:Kc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:Kc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:Kc=this.$.isEditMode&&
this.$.ea.IKb}return Kc}executeCommand(N,Ka,Cb){let jc=ef.TaskExtensions.fk();const Kc=Ka.command;switch(Ka.command){case -1473679467:gi.a(this.$,488,489,1,kd=>{jc=kd.Uai(Cb.SourceControlId,Ka)});break;case 1296389134:this.agaveCommandManager.fEj(Cb.SourceControlId,Cb.LabelText);break;case -684355545:this.agaveCommandManager.FYc();break;case -741808261:jc=this.agaveCommandManager.insertAgave(Cb,Ka);gi.a(this.$,488,489,1,kd=>{kd.yzg(Cb)});break;case -1336341324:z.EwaSettings.ma(479)&&(jc=this.agaveCommandManager.Rgd(Cb,
N,Ka));break;case 1172793074:z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&(jc=this.agaveCommandManager.Rgd(Cb,N,Ka));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:jc=this.agaveCommandManager.Rgd(Cb,N,Ka);break;default:jc=$h.a(Kc)}return jc}}Object(e.a)(Vh,"AgaveCommandHandler",null,
[195]);class Ki{}Object(e.a)(Ki,"Selection",null,[]);var wi=a(1294),xh=a(1293),xi=a(1295),Pg=a(1384),Li=a(1296);class Gh{}Object(e.a)(Gh,"SmartLookupApplicationInterface",null,[]);class hi{}Object(e.a)(hi,"ApplicationProperties",null,[]);class Hh{}Object(e.a)(Hh,"EnterpriseUserInfo",null,[]);class sg{}Object(e.a)(sg,"FeatureGates",null,[]);class yh{constructor(N,Ka,Cb=!0){this.jKj=9E5;this.mKj=3E5;this.aud=null;this.Pmf="";this.Ytd=0;this.prb=Date.now;this.pxa=N;this.c8a=Ka;Cb&&this.Gbd()}DWh(){const N=
this.prb();if(N<this.Ytd+this.jKj)return N>this.Ytd+this.mKj&&this.Gbd(),this.Pmf;this.Gbd();return""}Gbd(){this.aud=this.aud||new Promise(N=>{this.EWh().then(Ka=>{this.Pmf=Ka;this.Ytd=this.prb();this.aud=null;N(Ka)})})}EWh(){return this.c8a&&this.c8a.length?new Promise(N=>{this.pxa.wO("SmartLookup",this.c8a).then(Ka=>{Ka.IsSuccess?Ka.Token||(N(""),n.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(n.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+
Ka.ErrorCode+": "+Ka.ErrorMessage),N(""));N(Ka.Token)}).catch(Ka=>{Ka=pe.c(Ka);n.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Ka);N("")})}):(n.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(e.a)(yh,"SmartLookupAuthenticationManager",null,[857]);class ii{static FMh(){switch(Object(L.a)(String,sd.AFrameworkApplication.Qb.AudienceGroup)||""){case "Dogfood":if(sd.AFrameworkApplication.fa){let N=
sd.AFrameworkApplication.fa.Va("UserPrincipalName");N=Bf.a.ll(N);const Ka=sd.AFrameworkApplication.fa.lo("SmartLookupINTEnabledForSKITeam")?sd.AFrameworkApplication.fa.fw("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(Ka,N)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static bWh(){switch(sd.AFrameworkApplication.fa.qa("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":sd.AFrameworkApplication.fa.qa("IntentSvcEnableProdSourceLocationOverride")?"PROD":sd.AFrameworkApplication.fa.qa("IntentSvcEnableIntSourceLocationOverride")?
"INT":ii.FMh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(e.a)(ii,"Utils",null,[]);var qh=a(555),Wh=a(172);class zh{constructor(N){n.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.vnf=sd.AFrameworkApplication.fa.qa("IsTellMeUpSellEnterpriseEnabled");
this.jwi=sd.AFrameworkApplication.fa.Va("SmartLookupApprovedOriginPattern");this.c8a=sd.AFrameworkApplication.fa.Va("SmartLookupShredderServiceEndpoint");this.Owi=dg.a.HM(sd.AFrameworkApplication.fa.Va("AppCatalogUrl")||"");this.b8a=new sg;this.b8a.EnableAllTabV2=!0;this.b8a.EnableIntentService=!0;this.b8a.EnableInDocumentSearch=sd.AFrameworkApplication.fa.qa("SmartLookupEnableInDocumentSearch");this.b8a.EnableLocalSearch=sd.AFrameworkApplication.fa.qa("SmartLookupEnableLocalSearch");this.b8a.IntentServiceEndpoint=
ii.bWh();this.Jwi=new yh(N,this.c8a)}get approvedOriginPattern(){return this.jwi}iHh(){return Promise.resolve(this.jHh())}jHh(){const N=new hi;N.anid="";N.applicationVersion=sd.AFrameworkApplication.buildVersion;N.appCorrelationId=Wh.a.create().toString();N.themePlatform=zh.xWj;N.lcid=sd.AFrameworkApplication.lcid;N.launchUtcTime=(new Date).toUTCString();N.featureGates=this.b8a;var Ka=qh.a.YJ(sd.AFrameworkApplication.lcid);Ka=Ka?Ka.name:null;N.market=this.o$b(Ka);N.uiLanguage=Ka;N.sessionId=sd.AFrameworkApplication.userSessionId;
N.themeId=0;N.parentalControl=zh.EVi;const Cb=new Hh;Cb.CountryCode=this.o$b(Ka);Cb.ServiceEndpoint=this.c8a;Cb.IsGoLocal=!1;Cb.IsEnabled=this.vnf;Cb.IsEnterpriseEnabled=this.vnf;Cb.TenantRoot=this.Owi;N.enterpriseUserInfo=Cb;N.accessToken=this.Jwi.DWh();return N}o$b(N){N=N.split("-");return N[N.length-1]}}zh.xWj="web";zh.EVi="yes";Object(e.a)(zh,"SmartLookupManager",null,[844]);class Ug extends Qc.a{constructor(N){super();this.$=N;this.isFirstLaunch=!1}Rc(){return!1}Nc(){return!1}Cc(N,Ka){N=z.EwaSettings.ma(134);
return-983891024===Ka.command&&N}executeCommand(N,Ka){N=ef.TaskExtensions.fk();-983891024===Ka.command&&this.fqi();return N}fqi(){var N=new zh(null);const Ka={};var Cb=Eg.g(this.$).Vb(null).originalText;Cb=Object(ac.a)(new Ki,{neighborhood:Cb,mentionStart:0,mentionLength:Cb?Cb.length:0});const jc=Object(ac.a)(new Gh,{selection:Cb,entryPoint:0});N.iHh().then(kd=>{kd.applicationName=Ug.appName;kd.isFirstLaunch=this.isFirstLaunch;kd.themeId=5;Ka[Ug.smartLookupApplicationInterface]=JSON.stringify(jc);
Ka[Ug.pJg]=JSON.stringify(kd);this.isFirstLaunch=!1});N=new wi.a("ExcelOnline","Web","en-Us");Cb=new xh.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const Kc=new xi.a;Kc.optionalProperties[Pg.a.Zk]=ud.a.instance.ga(1807);Kc.optionalProperties[Pg.a.taskPaneWidth]=350;Kc.optionalProperties[Pg.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";Kc.Kp=Ka;Li.a.instance.NMa(Cb,"Taskpane","SmartLookupSDXTaskpane",N,Kc)}}Ug.pJg="AppProperties";Ug.appName="Excel";Ug.smartLookupApplicationInterface=
"SmartLookupApplicationInterface";Object(e.a)(Ug,"SmartLookupCommandHandler",Qc.a,[195]);class Ih extends Yd.a{constructor(N){super(N)}yd(){gi.a(this.$,374,375,this.hb,N=>{this.gd([new Vh(this.$,null,null,null,null,N),new Ug(this.$)])})}static ka(N){Yd.a.Nd(76,new Ih(N))}}Object(e.a)(Ih,"AgaveCommandHandlerFactory",Yd.a,[]);var mf=a(1309),gh=a(106);class Dg{constructor(){this.oe=null;this.X$a=(N,Ka,Cb,jc,Kc)=>{if(2===Cb){N=Kc?Kc:{};Ka=N.callback;Cb=N.refresh?N.refresh:!1;if(!Ka)return 16;sd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&
null!=N.storeType?this.oe.tJf(Ka,Cb,N.storeType):this.oe.yca(Ka,Cb)}return 32};this.a8i=(N,Ka,Cb,jc,Kc)=>{2===Cb&&(N=Kc?Kc.callback:null)&&this.oe.VDg(N);return 32};this.Tai=(N,Ka,Cb,jc,Kc)=>{2===Cb&&this.oe.eAd(null,OSF.AgaveHostAction.InsertAgave,Kc);return 32}}initialize(N){Dg.initialized||(this.oe=N,this.Gg(),Dg.initialized=!0)}Gg(){sd.AFrameworkApplication.wb.Ie($d.a.X$a,gh.a.frame,this.X$a,96);sd.AFrameworkApplication.wb.Ob($d.a.R6i,gh.a.frame,this.a8i);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterInsertOfficeAddinCommand",
!1)&&sd.AFrameworkApplication.wb.Ie($d.a.h$e,gh.a.frame,this.Tai,96)}static get instance(){Dg.Ma||(Dg.Ma=new Dg);return Dg.Ma}}Dg.Ma=null;Dg.initialized=!1;Object(e.a)(Dg,"AgaveCommandActor",null,[]);var gg=a(1351),Rg=a(1298),Jh=a(110),Kh=a(350),Mi=a(346),yi=a(1231),Gg=a(19),zi=a(341);class ji{constructor(){this.lUd=this.Dyc=null;this.su=0;this.Byc=null}}Object(e.a)(ji,"FirstPartyAddinTaskpaneOverrides",null,[]);class Lh{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=
null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(e.a)(Lh,"IdeasSelectionContext",null,[]);class Ni extends Lh{constructor(){super();this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(e.a)(Ni,"IdeasTableSelectionContext",Lh,[]);class Oi{constructor(){this.sheetName=null;this.lastRow=this.firstRow=this.lastColumn=this.firstColumn=0}}Object(e.a)(Oi,"AutoFilterRange",
null,[]);class Ai{constructor(){this.autoFilterType=this.autoFilterRange=null;this.id=this.itemIndex=0}}Object(e.a)(Ai,"IdeasAutoFilterSource",null,[]);class ki{constructor(N,Ka){this.selection=N;this.tables=Ka}}Object(e.a)(ki,"IdeasXLIMTableBoundaries",null,[]);var Jg=a(61);const Pi=(N,Ka,Cb,jc,Kc,kd,qd=null)=>{qd=N.Na(9,qd);qd.sharedInfo=Ka;return Jg.g(N,"ShowAgaveTaskpane",qd,Cb,jc,Kc,kd,0)};var Vg=a(958),Wg=a(65),Bi=a(131),vh=a(43),li=a(513),Bh=a(368),Ch=a(170),Qi=a(162),Ri=a(563),Tf=a(280),pg=
a(104),Si=a(132),Ci=a(51),mi=a(144),jh=a(179);class sh extends mi.a{constructor(){super();this.yea="calc(100% - 46px)";this.pCa="15px";this.zea="0";this.qGc="WACDialogPanel";this.aX=695;this.rGc=462;this.jpa="80%";this.fEc=350;this.Wfb="100%";this.Rb=5;this.ze="AppsForOfficeInsertionDialog";this.DGc=!!sd.AFrameworkApplication.fa&&sd.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix")}Lz(){super.Lz();this.Kk.style.width=this.Wfb;this.Kk.style.height=this.yea;this.Kk.style.marginTop=
this.pCa;this.Kk.style.padding=this.zea}Wya(){this.Kk.style.width=this.Wfb;this.Kk.style.height=this.yea;this.Kk.style.marginTop=this.pCa;this.Kk.style.padding=this.zea;this.aX>jh.a.Nla?(this.vb.style.width=String.format("{0}px",jh.a.Nla),this.vb.style.overflowX="scroll",sd.AFrameworkApplication.isRtl?this.vb.style.right="0":this.vb.style.left="0"):(this.vb.style.width=String.format("{0}px",this.aX),this.vb.style.overflowX="hidden");this.vb.offsetHeight>jh.a.Lla||this.rGc+50>jh.a.Lla?(this.vb.style.height=
String.format("{0}px",jh.a.Lla),this.vb.style.overflowY="scroll",this.vb.style.top="0",sd.AFrameworkApplication.isRtl?this.vb.style.right="0":this.vb.style.left="0",this.DGc||(this.vb.style.marginTop="-48px"),this.Kk.style.minHeight=String.format("{0}px",this.fEc)):(this.vb.style.overflowY="hidden",this.vb.style.top="10%",this.vb.style.height=this.jpa);this.csa()}csa(){if(this.vb){var N=this.vb.style.zIndex;this.vb.style.zIndex="-9999";if(this.aX>jh.a.Nla)sd.AFrameworkApplication.isRtl?this.vb.style.marginRight=
"0":this.vb.style.marginLeft="0";else{const Ka=String.format("{0}px",Math.floor(-this.vb.offsetWidth/2));sd.AFrameworkApplication.isRtl?this.vb.style.marginRight=Ka:this.vb.style.marginLeft=Ka;sd.AFrameworkApplication.isRtl?this.vb.style.right="50%":this.vb.style.left="50%"}this.vb.style.zIndex=String(N)}else n.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}BI(){super.BI();const N=document.getElementById(this.hi(this.qGc));N.style.width=String.format("{0}px",this.aX);
N.style.height=this.jpa}get kta(){return this.Kk}}Object(e.a)(sh,"AppsForOfficeInsertionDialog",mi.a,[119]);class Ti extends mi.a{constructor(){super();this.yea="calc(100% - 46px)";this.pCa="15px";this.zea="0";this.qGc="WACDialogPanel";this.aX=695;this.rGc=462;this.jpa="80%";this.fEc=350;this.Wfb="100%";this.Rb=5;this.ze="SDXDialog"}Lz(){super.Lz();this.Kk.style.width=this.Wfb;this.Kk.style.height=this.yea;this.Kk.style.marginTop=this.pCa;this.Kk.style.padding=this.zea}Wya(){this.Kk.style.width=this.Wfb;
this.Kk.style.height=this.yea;this.Kk.style.marginTop=this.pCa;this.Kk.style.padding=this.zea;this.aX>jh.a.Nla?(this.vb.style.width=String.format("{0}px",jh.a.Nla),this.vb.style.overflowX="scroll",sd.AFrameworkApplication.isRtl?this.vb.style.right="0":this.vb.style.left="0"):(this.vb.style.width=String.format("{0}px",this.aX),this.vb.style.overflowX="hidden");this.vb.offsetHeight>jh.a.Lla||this.rGc+50>jh.a.Lla?(this.vb.style.height=String.format("{0}px",jh.a.Lla),this.vb.style.overflowY="scroll",
this.vb.style.top="0",sd.AFrameworkApplication.isRtl?this.vb.style.right="0":this.vb.style.left="0",this.Kk.style.minHeight=String.format("{0}px",this.fEc)):(this.vb.style.overflowY="hidden",this.vb.style.top="10%",this.vb.style.height=this.jpa);this.csa()}csa(){if(this.vb){var N=this.vb.style.zIndex;this.vb.style.zIndex="-9999";if(this.aX>jh.a.Nla)sd.AFrameworkApplication.isRtl?this.vb.style.marginRight="0":this.vb.style.marginLeft="0";else{const Ka=String.format("{0}px",Math.floor(-this.vb.offsetWidth/
2));sd.AFrameworkApplication.isRtl?this.vb.style.marginRight=Ka:this.vb.style.marginLeft=Ka;sd.AFrameworkApplication.isRtl?this.vb.style.right="50%":this.vb.style.left="50%"}this.vb.style.zIndex=String(N)}else n.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}BI(){super.BI();const N=document.getElementById(this.hi(this.qGc));N.style.width=String.format("{0}px",this.aX);N.style.height=this.jpa}get kta(){return this.Kk}}Object(e.a)(Ti,"SDXDialog",mi.a,[]);var Xg=a(959),
th=a(171),ni=a(572),oi;(function(N){N[N.Valid=2]="Valid";N[N.Invalid=4]="Invalid";N[N.All=6]="All"})(oi||(oi={}));Object(e.b)("MetadataState",oi);var pi=a(338);class xf extends Qc.a{constructor(N,Ka,Cb,jc,Kc){super();this.Zza={};this.K$c={};this.Iya=this.sdxDialog=this.Kva=null;this.Bab=!1;this.W1h=(kd,qd,yd,Jd,Vd)=>{if(2!==yd)return 32;kd=Vd[Xg.a.Wsb];qd=Vd[Xg.a.nha];yd=Vd[Xg.a.Kla];Vd=new gg.a;Vd.Mdc=yd.optionalProperties.InstanceToken;Vd.sourceLocationOverrideResourceId=yd.optionalProperties[Pg.a.sourceLocationOverrideResourceId];
Vd.mB=yd.Kp;Vd.nha=qd;qd=null!=Vd.Mdc?Vd.Mdc:(new Se.a(Wh.a.create(),1)).toString();yd=null!=Vd.mB?Vd.mB:{};Jd={};Jd.id=qd;Jd.solutionId=kd.getId();Jd.version=kd.SBa;Jd.storeType=kd.getStoreType();Jd.storeId=kd.getStoreId();Jd.assetId=null;Jd.assetStoreId=null;Jd.settings=yd;Jd.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;Jd.osfControlType=OSF.OsfControlType.ContainerLevel;Jd.sourceLocationOverrideResourceId=Vd.sourceLocationOverrideResourceId;Jd.featureGates=sd.AFrameworkApplication.fa.WXe(kd.getId());
this.qic(Vd,Jd);return 32};this.qic=(kd,qd)=>{this.sdxDialog=new Ti;this.sdxDialog.initializeAndShow("",null,null);qd.div=this.sdxDialog.kta;kd={};kd.InstanceId=qd.id;kd.WebExtensionType=2;kd.PrimaryMarketplace={};kd.PrimaryMarketplace.SolutionId=qd.solutionId;kd.PrimaryMarketplace.MarketplaceType=qd.storeType;kd.PrimaryMarketplace.MarketplaceRef=qd.storeId;kd.PrimaryMarketplace.SolutionVersion=qd.version;kd.SrcLocationOverrideResourceId=qd.sourceLocationOverrideResourceId;kd.WebExtensionOsfControlType=
6;this.Zza[qd.solutionId]=qd.settings;kd.OsfPropertyBag=this.Yjc([],qd.solutionId);this.oe.jHa(kd);this.oe.Sh.insertOsfControl(qd)};this.i3h=(kd,qd,yd,Jd,Vd)=>{if(2!==yd)return 32;kd=Vd[Xg.a.Wsb];yd=Vd[Xg.a.nha];Vd=Vd[Xg.a.Kla];qd=new gg.a;qd.Mdc=Vd.optionalProperties.InstanceToken;qd.Zk=Vd.optionalProperties[Pg.a.Zk];qd.TR=Vd.optionalProperties[Pg.a.TR];Pg.a.taskPaneWidth in Vd.optionalProperties&&(qd.taskPaneWidth=Vd.optionalProperties[Pg.a.taskPaneWidth]);qd.sourceLocationOverrideResourceId=Vd.optionalProperties[Pg.a.sourceLocationOverrideResourceId];
qd.mB=Vd.Kp;qd.onTaskPaneClose=Vd.optionalProperties[Pg.a.onTaskPaneClose];qd.nha=yd;yd=new Cg.a(-859308420,0,2,0,"");Jd=kd.getStoreType()===OSF.StoreType.Sdx;const Oe=new Vg.a;Oe.N3=Vd.optionalProperties.HeaderCssClass||Gg.a.Q1a;Oe.Xdb=Vd.optionalProperties.TitleCssClass;this.O6(yd,kd.getId(),qd,Jd,Oe);return 32};this.T2h=(kd,qd,yd,Jd,Vd)=>{if(2!==yd)return 32;kd=Vd[Xg.a.Wsb].getId();Vd=Vd[Xg.a.Kla].optionalProperties[Pg.a.sourceLocationOverrideResourceId];return kd?(this.oe.Sh.refreshOsfControl(kd,
Vd),32):8};this.bZi=kd=>{kd=kd.Result;if(kd=null===kd?null:kd.SolutionId)this.oe.eke(kd),pg.a(this.$).Ima(3,kd)};this.WGf=(kd,qd)=>{var yd;const Jd=(kd=kd.Result)?kd.AgaveData:null;if(Jd){var Vd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Jd.PrimaryMarketplace.SolutionId,Jd.PrimaryMarketplace.MarketplaceType,null===(yd=null===Jd||void 0===Jd?void 0:Jd.AssetMarketplace)||void 0===yd?void 0:yd.SolutionId,null,null,Jd.PrimaryMarketplace.MarketplaceRef);n.ULS.shipAssertTag(537170434,0,Jd.TaskpaneWidth===
xf.fch,`Taskpane width is ${Jd.TaskpaneWidth}, assetId is ${Vd}.`);if(yd=this.K$c[Jd.PrimaryMarketplace.SolutionId])yd.Dyc&&(Jd.TaskpaneTitle=yd.Dyc),yd.Byc&&(Jd.TaskpaneIconId=yd.Byc),yd.lUd&&(Jd.TaskpaneButtonTooltip=yd.lUd),0<yd.su&&(Jd.TaskpaneWidth=yd.su);qd&&(Jd.FocusOnIframeWhenLoaded=qd.focusOnIframeWhenLoaded,qd.width&&(Jd.TaskpaneWidth=qd.width),Jd.TaskpaneIconCssClass=qd.Tk,Jd.TaskpaneHeaderCssClass=qd.N3,Jd.TaskpaneTitleCssClass=qd.Xdb,Jd.IsFirstPartyOptOutAppContextOptmization=qd.isFirstPartyOptOutAppContextOptmization);
this.Zza[Jd.PrimaryMarketplace.SolutionId]&&(Jd.OsfPropertyBag=this.Yjc(Jd.OsfPropertyBag,Jd.PrimaryMarketplace.SolutionId));Ri.a(Jd)||(Jd.WebExtensionOsfControlType=1);Jd&&(this.oe.eke(kd.SolutionId),this.oe.jHa(Jd))}else n.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.Kxh=kd=>{kd&&(this.R9c.$hf(kd),this.Sve())};this.$Gf=kd=>{kd=kd.toDataURL("image/jpeg");const qd=this.oe.S$(xf.N6e+"."+xf.rbc),yd={};yd.screenshot=kd;
OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(qd,"onScreenshot",yd,()=>{})};this.r1h=(kd,qd,yd,Jd,Vd)=>{if(2!==yd)return 32;if(Jh.a.Dh(Vd)||Vd[Xg.a.Xze]!==Rg.a.action)return 8;qd=Vd[Xg.a.Kla];return qd?(kd=(kd=this.vSh(Vd))?this.oe.S$(kd):null)?(Vd=this.oe.t3g(Vd[Xg.a.nha],qd.optionalProperties[Pg.a.fSc]),z.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(yd=this.oe.BY(kd),yd.TaskpaneTitle!==qd.optionalProperties[Pg.a.Zk]&&(yd.TaskpaneTitle=qd.optionalProperties[Pg.a.Zk],
yd.TaskpaneIconCssClass=qd.optionalProperties.IconCssClass,yd.TaskpaneIconUrl=qd.optionalProperties.TaskPaneIconUrl,yd.TaskpaneIconId=qd.optionalProperties.TaskPaneIconId,z.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(qd=this.oe.Sh,qd.changeIframeTitle(kd,yd.TaskpaneTitle),yd=qd.getOsfControl(kd),qd.raiseOsfControlStatusChange(yd)):(qd=this.oe.Sh.getOsfControl(kd),this.oe.Sh.raiseOsfControlStatusChange(qd)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(kd,
Vd,this.zJb),32):8:8};this.zJb=(kd,qd)=>{this.oe.oAh(kd,qd)};this.fHd=()=>{ef.TaskExtensions.e$(og.GetServiceTaskFactory.Ra(this.$.da,20,404,1),kd=>{kd.result.X3a()},this.$.la)};this.$=N;this.viewBlockContainerHelpers=Cb;this.oe=Ka;this.R9c=jc;this.ai=Kc;this.ai.Ob($d.a.H2f,gh.a.frame,this.i3h);this.ai.Ob($d.a.aTf,gh.a.frame,this.T2h);this.ai.Ob($d.a.SPe,gh.a.frame,this.r1h);this.ai.Ob($d.a.qic,gh.a.frame,this.W1h)}NEg(N){this.addHandler(xf.mBd,N)}Taj(N){this.removeHandler(xf.mBd,N)}dispose(){vi.a.Ia(this.Kva);
this.Kva=null;this.Bab&&(this.$.ea.Wn(this.fHd),this.Bab=!1);super.dispose()}FYc(){this.Kva.hide()}fEj(N,Ka){if(N){this.raiseEvent(xf.mBd);const Cb=N.split("|");this.qui(N,Ka,Cb);this.Kva=new sh;this.Kva.initializeAndShow("",null,null);this.oe.zqi(this.Kva.kta,Cb)}}Rgd(N,Ka,Cb){var jc=ef.TaskExtensions.fk();if(-515602470===Cb.command||-336193495===Cb.command||2086613372===Cb.command||-1444574190===Cb.command||-1336341324===Cb.command||451940422===Cb.command)jc=this.L1h(N,Ka,Cb);418618014===Cb.command&&
(Ka=new gg.a,Ka.Zk=ud.a.instance.ga(1820),jc=this.O6(Cb,xf.$4h,Ka,!0));if((Cb.tabName===this.$.Bb+fe.a.zTf||Cb.tabName===fe.a.KV)&&2===Cb.Re||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),N[Mg.a.Pc])||N[Mg.a.Pc]===fe.a.oQ)return this.D4e(N,Cb);if(7===Cb.Re&&N.SourceControlId===this.$.Bb+fe.a.qbc)return N.MenuItemId=fe.a.$Fd,this.D4e(N,Cb);1221897806===Cb.command&&(jc=this.q2f(Cb,"Format"));if(1930653487===Cb.command||1172793074===Cb.command)jc=this.q2f(Cb,"Data");
-1753056834===Cb.command&&(jc=this.Vzj(Cb));932597253===Cb.command&&(n.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),th.c(932597253,!0),Ka=new gg.a,Ka.Zk=ud.a.instance.ga(2162),Ka.sourceLocationOverrideResourceId=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?xf.kZi:xf.mZi,Ka.focusOnIframeWhenLoaded=!0,Ka.taskPaneWidth=xf.r8e,jc={},jc.LaunchSource=Object(L.a)(String,N.SourceControlId),jc.LaunchMode="Default",Ka.mB=jc,jc=this.O6(Cb,
xf.lZi,Ka,!0));301511274===Cb.command&&(jc=this.eAj(Cb));515196233===Cb.command&&((Ka=this.$.da.za(465))&&Ka.U6e(),Ka=new gg.a,Ka.Zk=ud.a.instance.ga(2234),jc={},jc.SourceUILocation=Kh.a[Cb.Re],Ka.mB=jc,jc=new Vg.a,jc.N3=Gg.a.Q1a,jc=this.O6(Cb,xf.wUi,Ka,!0,jc,void 0,Ka.Zk));1723441034===Cb.command&&(Ka=new gg.a,Ka.Zk=ud.a.instance.ga(2246),Ka.focusOnIframeWhenLoaded=!0,Ka.taskPaneWidth=xf.c1i,jc=new Vg.a,jc.N3=Gg.a.voh,jc=this.O6(Cb,ni.a,Ka,!0,jc));z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)&&N.LoadDataFromPictureTaskpane&&(Ka={},jc=new gg.a,jc.Zk=ud.a.instance.ga(2273),Ka.SessionID=N.SessionID,jc.mB=Ka,jc.focusOnIframeWhenLoaded=!0,jc=this.O6(Cb,N.DataFromPictureAssetId,jc,!0));return jc}insertAgave(N,Ka){var Cb=ef.TaskExtensions.fk();const jc=this.$;let Kc;var kd=N[Rd.a.qra];Kc=N[Mg.a.Zf];let qd=null;Vg.a.key in N&&(qd=N[Vg.a.key]);this.Kva&&this.Kva.hide();if(!Kc||!kd)return n.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),Cb;this.$.v4&&fe.a.Hda in
N&&(Kc.EnabledInViewMode=N[fe.a.Hda]);N=this.WJh(Ka.command);if(!Kc.EnabledInViewMode&&!jc.rq(null,!1,N))return Cb;let yd=void 0===Kc.IsToBePersisted||null===Kc.IsToBePersisted||Kc.IsToBePersisted?0:16;if(1===Kc.TargetType)Cb=this.nbi(Kc,kd,Ka,qd,yd);else{kd=Eg.g(jc);Cb=this.viewBlockContainerHelpers.kfb(kd);const Jd=jc.ea.isNamedObjectViewMode?jc.pa.sheetName:jc.pa.name;let Vd,Oe,Qe,lf;Cb?(kd=Cb.Fe,Vd=kd.rf.top,Oe=kd.rf.left,Qe=Cb.OI.x,lf=Cb.OI.y):(Vd=Oe=1,Cb=this.viewBlockContainerHelpers.eKa(kd),
Qe=Cb.x,lf=Cb.y);const qg=this.$.oa.va.Sb();Cb=(ag,bg,Rf)=>{var rg=jc.oa.va,Ng=Vd,Lg=Oe,Og=Qe,Dh=lf;ag=Tf.b(ag,this.bZi);const Zh=rg.Na(9,qg);Zh.sharedInfo=Kc;Zh.sheetName=Jd;Zh.positionRow=Ng;Zh.positionCol=Lg;Zh.positionOffsetX=Og;Zh.positionOffsetY=Dh;return Jg.g(rg,"InsertWebExtension",Zh,ag,bg,Rf,null,0)};z.EwaSettings.dc()?(yd|=64,Cb=Bh.a(this.$.userOperationManager,Cb,ag=>new Ch.a(534,0,ag,yd),Ka)):Cb=Bh.a(this.$.userOperationManager,Cb,ag=>new li.a(534,0,ag,yd),Ka)}return Cb}R0g(){var N=Cd.a.instance.Wb("Common.App.ICustomerFeedbackUiWrapper");
if(!z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",!1)){var Ka=Cd.a.instance.Wb("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.R9c?this.R9c.Fib?this.Sve():Ka.instance.V5c(this.Kxh):n.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined")}Ka={};sd.AFrameworkApplication.fa.yke(Ka);N=N.instance.getContext(Ka);Ka={};"telemetryGroup"in N&&(Ka=N.telemetryGroup);Ka.processSessionId=N.sessionId;Ka.officeBuild=N.build;N.telemetryGroup=
Ka;N.feedbackType=-1;N.userVoiceEnabled=!1;"disableIncludeScreenshot"in N||(N.disableIncludeScreenshot=!1);"screenshot"in N||(N.screenshot=!1);N.disableScreenshotPreview=!1;N.includeScreenshotSelectedDefault=!0;return N}zZi(N){if(!this.Iya&&z.EwaSettings.getBooleanFeatureGate(xf.V6h,!1)){var Ka=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";Ka=this.vte(Ka);const Cb=new Vg.a;Cb.Tk=Gg.a.L8c;Cb.N3=Gg.a.EMe;Cb.Xdb=Gg.a.l8c;
this.Iya=this.Ctc(Ka,null,!1,null,Cb);Si.b(this.$).Cd(Bi.a.AZi,{["Location"]:Kh.a[N.Re],["InputMethod"]:Mi.a[N.method]},void 0,!0);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&this.cWd()}}LYf(N){const Ka=this.$.ea.Tg.get(17);Cd.a.instance.Wb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Cb=>{Cb.isFeatureEnabled("mso_sendASmile",Ka).then(jc=>{N.FeedbackEnabled=Ka&&jc;return null})})}q2f(N,Ka){const Cb=Eg.g(this.$),jc=new gg.a;
var Kc={};Kc.ActiveTab=Ka;Kc.DatapaneFlighting=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);Kc.AceFlighting=!0;Kc.ChartNewSDXRecording=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);Kc.ThemeColorsFlighting=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");Kc.UOMirror=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",
!1);Kc.FormatTaskPaneAceButtonDark=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",!1);Kc.FormatTaskPaneBetterFeedbackButton=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",!1);Kc.FormatTaskPaneBetterScrollbar=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);Kc.FormatTaskPaneUXImprovePhase2=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",
!1);this.LYf(Kc);Kc.startTimeMs=Date.now();Kc.UserSessionId=this.$.ya.UserSessionId;(Ka=Cb.ha.Pa.Yn)&&(Kc.SubSelection=Ka);n.ULS.sendTraceTag(592524688,0,50,`Chart task pane launched. UserSessionId: ${Kc.UserSessionId}, UILocation: ${void 0===N.Re||null===N.Re?"Null":Kh.a[N.Re]}, SubSelection: ${Ka||"ChartRoot"}`);jc.mB=Kc;jc.Zk=ud.a.instance.ga(983);Kc=new Vg.a;Kc.N3=Gg.a.Q1a;return this.O6(N,xf.OVg,jc,!0,Kc)}Vzj(N){const Ka=new gg.a;Ka.mB={};Ka.Zk=ud.a.instance.ga(1806);Ka.TR=xf.Vjf;const Cb=new Vg.a;
Cb.N3=Gg.a.Q1a;return this.O6(N,xf.Vjf,Ka,!0,Cb,void 0,Ka.Zk)}eAj(N){const Ka=new gg.a;Ka.mB={};Ka.Zk=ud.a.instance.ga(2186);const Cb=new Vg.a;Cb.N3=Gg.a.fqh;Cb.Xdb=Gg.a.JMe;return this.O6(N,xf.QBi,Ka,!0,Cb)}D4e(N,Ka){const Cb=xf.N6e;var jc=N[Mg.a.Pc].toString();const Kc={},kd=new gg.a;kd.Zk=ud.a.instance.ga(9);switch(jc){case "A0":Kc.query=(N[Mg.a.Zf]||"").split("|").slice(2,zi.a.dS).join("|");break;case "A1":Kc.query=N.CommandValueId;break;case "Help":Kc.gwdropdownflightinfo=z.EwaSettings.ma(239);
Kc.query="";break;case fe.a.$Fd:z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(kd.Zk=ud.a.instance.ga(1772),kd.sourceLocationOverrideResourceId=xf.rbc,Kc.feedback=this.R0g()):Kc.query=jc;break;case "HelpArticle":Kc.query=N[Mg.a.Zf];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":Kc.query=jc;break;default:return kh.Task.Ta(!0)}kd.mB=Kc;jc=new Vg.a;jc.N3=Gg.a.Q1a;return this.O6(Ka,Cb,kd,!1,jc,N[fe.a.Hda]||!1)}vte(N){const Ka={Version:"0.0.0.0"};
Ka.AssetId=xf.UKa;Ka.SolutionId=xf.UKa;Ka.AssetStoreId="";Ka.StoreType=OSF.StoreType.Sdx;Ka.Height=0;Ka.Width=0;Ka.StoreId=OSF.StoreType.Sdx;Ka.TargetType=OSF.OsfControlTarget.TaskPane;Ka.IsToBePersisted=!1;Ka.SourceLocationOverrideResourceId=N;Ka.SharedRuntimeId=N;return Ka}L1h(N,Ka,Cb){function jc(){qd.LaunchMode="Default";z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Kc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Kc.sourceLocationOverrideResourceId=
"Insights.Https.Bundle";Kc.Zk=ud.a.instance.ga(1819);Kc.TR=xf.$Uc;Kc.Tk=Gg.a.L8c;kd.Tk=Gg.a.L8c}const Kc=new gg.a,kd=new Vg.a,qd={};this.Iya&&this.LYf(qd);qd.LaunchSource="";qd.StartTimeMs=Date.now();qd.CorrelationId=Wh.a.create().toString();Kc.mB=qd;Kc.focusOnIframeWhenLoaded=!0;Kc.taskPaneWidth=xf.r8e;kd.N3=Gg.a.EMe;kd.Xdb=Gg.a.l8c;switch(Cb.command){case -1444574190:let Vd;qd.LaunchMode="RecommendedPivotTables";qd.SelectionContext="";qd.LaunchSource="PivotTableHandRaise"===Object(L.a)(String,N.SourceControlId)?
"PivotTableHandRaise":"InsertPivotTable";if(this.$&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&N.SourceSelection){var yd=N.SourceSelection.split(",")[0];Ka=z.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(({sheetName:yd,QKf:Vd,range:Jd}=vh.Z(yd,this.$.xa)).returnValue&&!Eg.g(this.$).Db.s4(Jd))N=this.$.xa.getItemByName(yd),qd.SelectionContext=JSON.stringify(Object(ac.a)(new Lh,{address:Vd,addressWithSheet:yd+"!"+Jd.hz(!1),
sheetId:Wg.d(N),sheetName:yd,isSheetEmpty:!1,columnCount:Jd.width,rowCount:Jd.height,columnIndex:Jd.left+Ka,rowIndex:Jd.top+Ka,selectionType:"Continuous"}));else if((N=this.$.zb.getItemByName(Object(L.a)(String,N.SourceSelection)))&&Wg.n(N)){var Jd=Qi.a(N,!0);yd=this.$.xa.getItemByName(N.sheetName);qd.SelectionContext=JSON.stringify(Object(ac.a)(new Ni,{tableName:N.name,hasTableHeaders:Qi.d(N),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Jd.hz(!1),addressWithSheet:yd.name+"!"+Jd.hz(!1),
sheetId:Wg.d(yd),sheetName:yd.name,isSheetEmpty:!1,columnCount:Jd.width,rowCount:Jd.height,columnIndex:Jd.left+Ka,rowIndex:Jd.top+Ka,selectionType:"Continuous"}))}}z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Kc.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":Kc.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";Kc.Zk=ud.a.instance.ga(1818);Kc.TR=xf.yXi;Kc.Tk=Gg.a.aPe;kd.Tk=Gg.a.aPe;break;case -336193495:qd.LaunchMode="RecommendedCharts";
z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Kc.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":Kc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";Kc.Zk=ud.a.instance.ga(1817);Kc.TR=xf.u5i;Kc.Tk=Gg.a.bPe;kd.Tk=Gg.a.bPe;break;case -1336341324:if(!z.EwaSettings.ma(479))return kh.Task.Ta(!1);qd.LaunchMode="NL";Kc.TR=xf.$Uc;z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Kc.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":
Kc.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(z.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Kc.Zk=ud.a.instance.ga(1822);qd.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:Kc.Zk=ud.a.instance.ga(1823);qd.NLLaunchModeBrandingCandidatesIndex=2;break;default:Kc.Zk=ud.a.instance.ga(1821),qd.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!z.EwaSettings.ma(234))return kh.Task.Ta(!1);qd.LaunchMode=
"ChartDesigner";qd.LaunchSelectionMode=Ka.toString();z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Kc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Kc.sourceLocationOverrideResourceId="Insights.Https.Bundle";Kc.Zk=ud.a.instance.ga(1824);Kc.TR=xf.$Uc;break;case 451940422:qd.LaunchSource="AutoFilter";Jd=JSON.parse(N.CommandValueId);qd.AutoFilterSource=JSON.stringify(Object.assign(new Ai,{autoFilterRange:{sheetName:Jd.AutoFilterRange.SheetName,firstColumn:Jd.AutoFilterRange.FirstColumn,
lastColumn:Jd.AutoFilterRange.LastColumn,firstRow:Jd.AutoFilterRange.FirstRow,lastRow:Jd.AutoFilterRange.LastRow},autoFilterType:Jd.AutoFilterType,itemIndex:Jd.ItemIndex,id:Jd.Id}));jc();break;default:z.EwaSettings.ma(234)&&(qd.LaunchSelectionMode=Ka.toString()),z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&(qd.XlimTableBoundaries=this.HXh()),jc()}z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Kc.sourceLocationOverrideResourceId=
"Insights.Https.PPE.Bundle":Kc.sourceLocationOverrideResourceId="Insights.Https.Bundle";return this.Iya?this.Iya.Uo(()=>this.IWf(qd,Kc)):this.t$h(Cb,Kc,kd,qd)}t$h(N,Ka,Cb,jc){this.Iya=this.Ctc(this.vte(Ka.sourceLocationOverrideResourceId),Ka,!1,N,Cb,!1);return z.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?(jc.NoActionMsgOnFirstInstance=!0,this.Zza[xf.UKa]=jc,this.Iya):this.Iya.Uo(()=>this.IWf(jc,Ka))}IWf(N,Ka){const Cb=this.oe.S$(this.oe.O2a(xf.UKa,Ka.sourceLocationOverrideResourceId));
if(Cb){this.Zza[xf.UKa]=N;const jc=this.Yjc(this.oe.BY(Cb).OsfPropertyBag,xf.UKa);this.oe.BY(Cb).OsfPropertyBag=jc}this.NMa(xf.UKa,"LaunchIdeasAction",N,Ka);return kh.Task.Ta(!0)}O6(N,Ka,Cb=null,jc=!1,Kc=null,kd=!1,qd=null){ef.TaskExtensions.fk();Cb||(Cb=new gg.a);const yd={Version:"0.0.0.0"};yd.AssetId=Ka;yd.SolutionId=Ka;yd.AssetStoreId="";yd.StoreType=jc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;yd.Height=0;yd.Width=0;yd.StoreId=jc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;yd.TargetType=OSF.OsfControlTarget.TaskPane;
yd.IsToBePersisted=!1;yd.SourceLocationOverrideResourceId=Cb.sourceLocationOverrideResourceId;if(Cb.Zk||qd)this.K$c[Ka]=Object(ac.a)(new ji,{Dyc:Cb.Zk,lUd:qd,Byc:Cb.TR});z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Cb.mB||(Cb.mB={}),Cb.mB.ShowFeedback=this.$.isFeedbackEnabled,this.Zza[Ka]=Cb.mB):Cb.mB&&(this.Zza[Ka]=Cb.mB);Ka={};Ka[Mg.a.Zf]=yd;qd={};qd.solutionId=yd.SolutionId;qd.version=yd.Version;qd.storeType=yd.StoreType;
qd.storeId=yd.StoreId;qd.assetId=yd.AssetId;qd.assetStoreId=yd.AssetStoreId;qd.height=yd.Height;qd.targetType=yd.TargetType;qd.width=yd.Width;qd.isAddinCommands=!jc;Ka[Rd.a.qra]=qd;Kc||(Kc=new Vg.a);Kc.focusOnIframeWhenLoaded=Cb.focusOnIframeWhenLoaded;Kc.width=Cb.taskPaneWidth;Ka[Vg.a.key]=Kc;Ka[fe.a.Hda]=kd;return this.insertAgave(Ka,N)}nbi(N,Ka,Cb,jc,Kc){const kd=(Vd,Oe)=>{var Qe=Vd.SolutionId;var lf=OSF.OsfControl.isFirstPartyStoreString(Vd.StoreType);lf&&Vd.SourceLocationOverrideResourceId&&
(Qe=this.oe.O2a(Qe,Vd.SourceLocationOverrideResourceId));var qg=this.oe.Nwe(Qe,null,Vd.SharedRuntimeId);lf&&(z.EwaSettings.ma(295)&&qg&&(lf=this.oe.S$(Qe))&&(Qe=null,Qe=this.Yjc(this.oe.BY(lf).OsfPropertyBag,Vd.SolutionId),(lf=this.oe.Sh.getOsfControl(lf))&&lf.setSettings(Qe)),Vd.SharedRuntimeId&&qg||this.oe.Sh.refreshOsfControl(Vd.SolutionId,Vd.SourceLocationOverrideResourceId));if(!qg){const ag=this.$.oa.va.Sb();let bg=519;qg=(Rf,rg,Ng)=>{var Lg=this.$.oa.va;Rf=Tf.b(Rf,this.WGf);const Og=Lg.Na(9,
ag);Og.sharedInfo=Vd;return Jg.g(Lg,"InsertAgaveTaskpane",Og,Rf,rg,Ng,jc,0)};void 0===Vd.IsToBePersisted||null===Vd.IsToBePersisted||Vd.IsToBePersisted||(bg=538,qg=(Rf,rg,Ng)=>{const Lg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Vd.SolutionId,Vd.StoreType,Vd.AssetId,null,null,Vd.StoreId);n.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${Vd.StoreType}, StoreId ${Vd.StoreId}, SolutionId ${Lg}.`);return Pi(this.$.oa.va,Vd,Tf.b(Rf,this.WGf),rg,Ng,jc,ag)});return z.EwaSettings.dc()?
(Kc|=64,Bh.a(this.$.userOperationManager,qg,Rf=>new Ch.a(bg,0,Rf,Kc),Oe)):Bh.a(this.$.userOperationManager,qg,Rf=>new li.a(bg,0,Rf,Kc),Oe)}return ef.TaskExtensions.raa()},qd=Vd=>{var Oe=Telemetry.PrivacyRules.GetPrivacyCompliantId(Vd.solutionId,Vd.storeType,Vd.assetId,null,null,Vd.storeId);n.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${Oe} from ${Vd.storeType}.`);Oe={};const Qe=new l.a;Qe.add(Vd);Oe[Rd.a.Pmb]=Qe;Oe[Rd.a.eP]=3;Vd=new Cg.a($d.a.SAb,0,this.$.Mc,0,null);return this.$.Ka.Mb(Vd,
Oe)};if(!z.EwaSettings.ma(53)||N.StoreId===OSF.StoreType.FirstParty)return kd(N,Cb,jc);if(Ka.isAddinCommands)return qd(Ka);const yd=new Gd.a,Jd={};Jd.marketplaceId=N.SolutionId;Jd.marketplaceVersion=N.Version;Jd.storeType=N.StoreType;Jd.storeId=N.StoreId;Jd.targetData=N;z.EwaSettings.ma(93)&&(Jd.clearCache=!0);this.oe.Sh.isAddinCommandsAsync(Jd,(Vd,Oe,Qe)=>{yd.setResult(Oe);Vd||(Vd=Qe.targetData,Oe=Telemetry.PrivacyRules.GetPrivacyCompliantId(Vd.SolutionId,Vd.StoreType,Vd.AssetId,null,null,Vd.StoreId),
n.ULS.sendTraceTag(537170438,220,10,`Judging AddinCommands failed for ${Oe} from ${Vd.StoreType} during addin inserting`))});return ef.TaskExtensions.ts(yd.task,Vd=>Vd.result?qd(Ka):kd(N,Cb,jc),this.$.la)}Yjc(N,Ka){if(!this.Zza[Ka])return N;const Cb={};if(N)for(const Kc of N)Cb[Kc[0]]=Kc[1];N=this.Zza[Ka];for(var jc of Object.keys(N))jc===xf.Mxh&&z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Cb[jc]=Sys.Serialization.JavaScriptSerializer.serialize(N[jc]):
Cb[jc]=Sys.Serialization.JavaScriptSerializer.serialize(N[jc].toString());jc=Object.keys(Cb).length;jc=Array(jc);N=0;for(const Kc of Object.keys(Cb))jc[N]=[Kc,Cb[Kc].toString()],N++;return jc}qui(N,Ka,Cb){const jc=this.$.ya.UserSessionId,Kc=this.$.ya.UICultureTag,kd=this.$.ya.UICultureTagLcid,qd=this.$.ya.WacHostId;let yd="",Jd="";5<=Cb.length&&(yd=Cb[3],Jd=Cb[4]);this.rui(yd,Jd,N,Ka,Kc,kd,jc,qd)}rui(N,Ka,Cb,jc,Kc,kd,qd,yd){const Jd={};Jd.a=qd;Jd.b=Cb;Jd.c=jc;Jd.d=N;Jd.e=Ka;Jd.f=Kc;Jd.g=kd;Jd.h=yd;
Ci.b().Le(36,Jd)}Sve(){if(yi.a.ssf())n.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.$Gf);return}catch(N){n.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(N?N.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.$Gf)}catch(N){n.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(N?N.toString():null))}}}Ctc(N,Ka=null,Cb=!1,jc=null,Kc=null,kd=!0){var qd=
N.SolutionId;let yd=kh.Task.Ta(!1);N&&qd&&N.SharedRuntimeId&&(jc=jc||new Cg.a(-859308420,0,2,0,""),qd={},qd.solutionId=N.SolutionId,qd.version=N.Version,qd.storeType=N.StoreType,qd.storeId=N.StoreId,qd.assetId=N.AssetId,qd.assetStoreId=N.AssetStoreId,qd.height=N.Height,qd.targetType=N.TargetType,qd.width=0,qd.isAddinCommands=!1,qd.sharedRuntimeId=N.SharedRuntimeId,N.Preload=kd,Kc=Kc?Kc:new Vg.a,Kc.width=0,Ka&&(Kc.focusOnIframeWhenLoaded=Ka.focusOnIframeWhenLoaded,kd=new ji,Ka.Zk&&(kd.Dyc=Ka.Zk),0<
Ka.taskPaneWidth&&(kd.su=Ka.taskPaneWidth),Ka.TR&&(kd.Byc=Ka.TR),this.K$c[N.SolutionId]=kd),Ka={},Ka[Mg.a.Zf]=N,Ka[Rd.a.qra]=qd,Ka[Vg.a.key]=Kc,Ka[fe.a.Hda]=Cb,yd=this.insertAgave(Ka,jc));return yd}NMa(N,Ka,Cb,jc=null){if(N&&Ka){N=new xh.a(N,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");const Kc=new wi.a("ExcelOnline","Web",this.$.ya.UICultureTag),kd=new xi.a;kd.optionalProperties[Pg.a.fSc]=Cb;jc&&(jc.sourceLocationOverrideResourceId&&(kd.optionalProperties[Pg.a.sourceLocationOverrideResourceId]=
jc.sourceLocationOverrideResourceId),jc.Zk&&(kd.optionalProperties[Pg.a.Zk]=jc.Zk),jc.Tk&&(kd.optionalProperties.IconCssClass=jc.Tk),jc.hUd&&(kd.optionalProperties.TaskPaneIconUrl=jc.hUd),jc.TR&&(kd.optionalProperties.TaskPaneIconId=jc.TR));Li.a.instance.NMa(N,Rg.a.action,Ka,Kc,kd)}}vSh(N){if(!Jh.a.Dh(N)){var Ka=N[Xg.a.Wsb];if(Ka&&(Ka=Ka.getId(),N=N[Xg.a.Kla],Ka&&N))return this.O2a(Ka,N.optionalProperties[Pg.a.sourceLocationOverrideResourceId])}return null}O2a(N,Ka=null){return N&&Ka?`${N}.${Ka}`:
N}WJh(N){switch(N){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return z.EwaSettings.ma(234)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}}cWd(){this.$.ea.Fg?this.fHd():(this.$.ea.El(this.fHd),this.Bab=!0)}HXh(){var N=this.$.da.za(20);if(!N)return this.cWd(),"";N=N.X3a();if(!N)return this.cWd(),"";var Ka=this.$.xa.getItemByName(this.$.ea.isNamedObjectViewMode?this.$.pa.sheetName:this.$.pa.name);
Ka=Wg.d(Ka);var Cb=Eg.g(this.$).ha.sa.selectedRanges;const jc=[];for(const kd of Cb){Cb=new pi.a(kd,Ka);var Kc=N.Bac(Cb,oi.Valid);Cb=[];if(Kc)for(const qd of Kc)(Kc=qd.table.nE)&&(Kc=Kc.range.toString())&&Cb.push(Kc);Cb=new ki(kd.toString(),Cb);jc.push(Cb)}return JSON.stringify(jc)}}xf.V6h="Microsoft.Office.Excel.IdeasXLOPreload";xf.mBd="IDS";xf.N6e="FA000000012";xf.UKa="FA000000005";xf.$4h="HelloWorld";xf.OVg="FA000000014";xf.rbc="Help.GiveFeedback.Url";xf.Mxh="feedback";xf.Vjf="FA000000066";xf.mZi=
"PowerBi.Url";xf.kZi="PowerBi.DevUrl";xf.lZi="FA000000054";xf.QBi="FA000000064";xf.wUi="FA000000075";xf.$Uc="AnalyzeDataTaskPane";xf.u5i="RecommendedChartsTaskPane";xf.yXi="PivotTableTaskPane";xf.fch=350;xf.r8e=320;xf.c1i=320;Object(e.a)(xf,"AgaveCommandManager",Qc.a,[819,820]);class qi extends k.a{constructor(N){super();this.$=N;this.Fb()}create(){const N=this.$.da,Ka=og.GetServiceTaskFactory.create(N,106,this.la,this.hb),Cb=og.GetServiceTaskFactory.create(N,104,this.la,this.hb),jc=ei.a.loadScript(36,
0,this.hb,void 0,void 0,375);ef.TaskExtensions.Aa(ef.TaskExtensions.Wd([Cb,Ka,jc],this.la),()=>{let Kc=null;z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(Kc=Cd.a.instance.Wb("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);Dg.instance.initialize(Ka.result);const kd=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(Sh.c)(this.$.da,374,()=>new xf(this.$,Ka.result,Cb.result,
Kc,sd.AFrameworkApplication.wb)):new xf(this.$,Ka.result,Cb.result,Kc,sd.AFrameworkApplication.wb);N.Ga(206,kd);this.qb(N.za(374)||N.Ga(374,kd))},this.la,3);Cd.a.instance.register(mf.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").tc().Fc(()=>new mf.a(this.$.Qu))}static ka(N){N.da.Ga(375,new qi(N))}}Object(e.a)(qi,"AgaveCommandManagerFactory",k.a,[]);var Di=a(559);class mh{constructor(){this.initialized=!1;this.agaveCommandManager=this.oe=this.G_a=null;this.DT={}}initialize(N){z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",
!1)&&!this.initialized&&this.xij(N)}Uai(N,Ka){let Cb=ef.TaskExtensions.fk();if(this.initialized&&N&&0<N.length){let jc=this.MGh(N);N in this.DT&&(Cb=this.agaveCommandManager.insertAgave(jc,Ka))}return Cb}yzg(N){this.initialized&&(N=N[Mg.a.Zf]||{},!N.SolutionId||N.SolutionId in this.DT||this.oe.yca(Ka=>{this.yca(Ka)},!0))}O2h(N){this.initialized&&(N=N||"")&&0<N.length&&N in this.DT&&(delete this.DT[N],this.oe.yca(Ka=>{this.yca(Ka)},!0))}MGh(N){return N in this.DT?this.DT[N]:{}}yca(N){var Ka=!1;if(N&&
!N.errorCode){if(N.value)for(const Cb of N.value)N=Cb[1],Cb[3]==OSF.OsfControlTarget.InContent&&N&&0<N.length&&!(N in this.DT)&&(Ka={NoReporting:!1,IsSystemInitiated:!1},Ka.description=Cb[2],Ka.iconUrl=Cb[9],Ka[Rd.a.qra]={solutionId:Cb[1],version:Cb[4],storeType:Cb[12],storeId:Cb[11],assetId:Cb[5],assetStoreId:Cb[6],targetType:Cb[3],width:Cb[7],height:Cb[8],displayName:Cb[0],id:Cb[1]},Ka[Mg.a.Zf]={SolutionId:Cb[1],Version:Cb[4],StoreType:Cb[12],StoreId:Cb[11],AssetId:Cb[5],AssetStoreId:Cb[6],TargetType:Cb[3],
Width:Cb[7],Height:Cb[8],Id:Cb[1]},this.DT[N]=Ka,Ka=!0);Ka&&this.N4g()}}N4g(){let N=[];for(const Ka in this.DT)N.push({id:Ka,controlType:0,title:this.DT[Ka][Rd.a.qra].displayName});if(0<N.length){for(const Ka in this.DT)appChrome.addInApi.registerAddinIcon("AddinIcon_"+Ka,this.DT[Ka].iconUrl);this.VWg();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:mh.zsf,isOfficeTab:!0,groups:[{id:mh.s$e,title:mh.t$e,controls:N}]}]});for(const Ka in this.DT)this.G_a.addCommandToMaps(Object(ac.a)(new nf.a(Ka,
"-1473679467"),{legacyControlId:Ka}))}}VWg(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:mh.zsf,isOfficeTab:!0,groups:[{id:mh.s$e,title:mh.t$e,controls:[]}]}]})}xij(N){const Ka=og.GetServiceTaskFactory.Ra(N.da,374,375,1),Cb=og.GetServiceTaskFactory.create(N.da,106,N.la,1);ef.TaskExtensions.Aa(ef.TaskExtensions.Wd([Ka,Cb],N.la),()=>{this.agaveCommandManager=Ka.result;this.G_a=Cd.a.instance.vh("Common.IExternalUICommandDefinitionMapping")||new Di.a(N.Bb,N);sd.AFrameworkApplication.wb.Ob($d.a.dOf,
gh.a.frame,(jc,Kc,kd,qd,yd)=>{this.O2h(yd)});this.oe=Cb.result;this.oe.yca(jc=>{this.yca(jc)},!0);this.initialized=!0},N.la,3)}}mh.zsf="tabinsert";mh.s$e="installedContentAddins";mh.t$e=ud.a.instance.ga(2281);Object(e.a)(mh,"AgaveCommandRibbon",null,[818]);class Xh extends k.a{constructor(N){super();this.$=N;this.Fb()}create(){if(z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)){const N=this.$.da,Ka=new mh;Ka.initialize(this.$);this.qb(N.za(488)||
N.Ga(488,Ka))}}static ka(N){N.da.Ga(489,new Xh(N))}}Object(e.a)(Xh,"AgaveCommandRibbonFactory",k.a,[]);var Ui=a(1292),hg=a(730);class Mh{constructor(){this.h5d=this.C4d=this.Hea=null;this.iib=0}get displayName(){return this.Hea}set displayName(N){this.Hea=N}get email(){return this.C4d}set email(N){this.C4d=N}get federationProvider(){return this.h5d}set federationProvider(N){this.h5d=N}get identityType(){return this.iib}set identityType(N){this.iib=N}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(N){switch(N){case 4:return this.displayName;
case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N,Ka){switch(N){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ka,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ka,
0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ka,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ka,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Ka){this.invokePropertySet(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokeMethodAsync(N,Ka){N=this.invokeMethod(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}static X5g(N){const Ka=new Mh;Ka.displayName=N.displayName;Ka.email=N.email;switch(N.authority){case Ui.a.VDf:Ka.identityType=1;break;default:Ka.identityType=0}Ka.federationProvider="";return Ka}}Object(e.a)(Mh,"OfficeIdentityInfo",null,[]);class rh{static get TKe(){return rh.Png}static B$b(N){return N in rh.TKe?rh.TKe[N].toString():N}}rh.map=null;rh.Png={["GeneralException"]:hg.a.generalException,
["AccessDenied"]:hg.a.bSc,["ApiNotAvailable"]:hg.a.apiNotAvailable,["UserNotSignedIn"]:hg.a.userNotSignedIn,["UserAborted"]:hg.a.userAborted,["UnsupportedUserIdentity"]:hg.a.DPj,["InvalidResourceUrl"]:hg.a.invalidResourceUrl,["InvalidGrant"]:hg.a.invalidGrant,["AddinIsAlreadyRequestingToken"]:hg.a.lHg,["ResourceNotAllowed"]:hg.a.pgj,["ClientError"]:hg.a.clientError,["ServerError"]:hg.a.serverError};Object(e.a)(rh,"SingleSignOnErrorCodeMap",null,[]);class Nh{constructor(N,Ka){this.gPb=N;this.iib=Ka}get accessToken(){return this.gPb}set accessToken(N){this.gPb=
N}get tokenIdenityType(){return this.iib}set tokenIdenityType(N){this.iib=N}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(N){switch(N){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N,Ka){switch(N){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ka,
0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ka,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Ka){this.invokePropertySet(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Ka){N=this.invokeMethod(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}}
Object(e.a)(Nh,"SingleSignOnToken",null,[]);class Yh{constructor(){this.a1d=null;this.Hee=this.IUb=this.UD="";this.Ufe=!0;this.options=null}get authChallenge(){return this.a1d}set authChallenge(N){this.a1d=N}get correlationId(){return this.UD}set correlationId(N){this.UD=N}get policy(){return null}set policy(N){}get resource(){return this.IUb}set resource(N){this.IUb=N}get scope(){return this.Hee}set scope(N){this.Hee=N}get silentLogin(){return this.Ufe}set silentLogin(N){this.Ufe=N}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(N){switch(N){case 3:return this.authChallenge;
case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N,Ka){switch(N){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ka,0,"string");return;case 7:this.correlationId=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ka,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ka,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ka,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ka,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ka,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertySetAsync(N,Ka){this.invokePropertySet(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Ka){N=this.invokeMethod(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}}Object(e.a)(Yh,"TokenParameters",null,[779]);class ri{constructor(N,Ka){this.Fgb=Ka;this.sA=N}get roamingSettings(){return null}getAccessToken(N){const Ka=this.Fgb.getOsfControl(this.sA),
Cb=Ka.getManifest(),jc=Cb.getMarketplaceID();this.hNa(N,jc);return OfficeExtension.WacRuntime.Utility.createPromise((Kc,kd)=>{Ka.isFirstParty()&&this.Fgb._enableFirstPartySSO?this.Pdi(Cb,N)?Cd.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(N,jc).then(qd=>{Kc(qd)},qd=>{kd(qd)}):kd(hg.a.bSc):kd(hg.a.apiNotAvailable)}).then(Kc=>{let kd;switch(Kc.authority){case Ui.a.VDf:kd=1;break;default:kd=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Nh(Kc.accessToken,
kd))},Kc=>{this.logErrorResponse(N,jc,Kc);return Kc?OfficeExtension.WacRuntime.Utility.createPromise((kd,qd)=>{qd(OfficeExtension.WacRuntime.Utility.createRichApiException(Kc,rh.B$b(Kc)))}):OfficeExtension.WacRuntime.Utility.createPromise((kd,qd)=>{qd(OfficeExtension.WacRuntime.Utility.createRichApiException(hg.a.generalException,rh.B$b(hg.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const N=this.Fgb.getOsfControl(this.sA);N.getManifest();const Ka=N.getManifest().getMarketplaceID();
return OfficeExtension.WacRuntime.Utility.createPromise((Cb,jc)=>{Cd.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(Ka).then(Kc=>{Cb(Kc)},Kc=>{jc(Kc.toString())})}).then(Cb=>{Cb=Mh.X5g(Cb);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Cb)},Cb=>Cb?OfficeExtension.WacRuntime.Utility.createPromise((jc,Kc)=>{Kc(OfficeExtension.WacRuntime.Utility.createRichApiException(Cb,rh.B$b(Cb)))}):OfficeExtension.WacRuntime.Utility.createPromise((jc,Kc)=>
{Kc(OfficeExtension.WacRuntime.Utility.createRichApiException(hg.a.generalException,rh.B$b(hg.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(N){switch(N){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertySetAsync(N,Ka){this.invokePropertySet(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Ka){switch(N){case 1:return this.hGh(Ka);case 3:return this.yHh();case 2:return this.ATh()}N=this.invokeMethod(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}hGh(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,Yh);return this.getAccessToken(N)}yHh(){return this.getAuthContext()}ATh(){return this.getPrimaryIdentityInfo()}Pdi(N,
Ka){let Cb=!1;const jc=N.getWebApplicationAuthorizations();N=null;for(const Kc of jc)if(Kc.getResource().toLowerCase()===Ka.resource.toLowerCase()){N=Kc;Cb=!0;break}if(!Cb)return!1;Ka=Ka.scope.split(" ,+");for(const Kc of Ka)if(Kc&&Kc.length){Ka=!1;for(const kd of N.getScopes())Kc.toLowerCase()===kd.toLowerCase()&&(Ka=!0);if(!Ka)return!1}return!0}hNa(N,Ka){N=this.lsf(N.resource);n.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:Ka,["resource"]:N})}logErrorResponse(N,Ka,Cb){N=this.lsf(N.resource);
n.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:Ka,["resource"]:N,["error"]:Cb})}lsf(N){return N.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(e.a)(ri,"AuthenticationService",null,[]);class Oh{create(N,Ka){return new ri(N,Ka)}}Object(e.a)(Oh,"AuthenticationServiceFactory",null,[]);var Ph=a(842),Q=a(962),La=a(944);class kb{}kb.generalException="generalException";kb.invalidArgument="invalidArgument";kb.notAllowed="notAllowed";kb.apiNotAvailable="apiNotAvailable";
kb.unresolvedPendingRequest="unresolvedPendingRequest";kb.timeout="timeout";kb.adalTimeout="adalTimeout";kb.userNotSignedIn="userNotSignedIn";kb.userAborted="userAborted";kb.silentSignInFailed="silentSignInFailed";kb.invalidResourceUrl="invalidResourceUrl";kb.invalidGrant="invalidGrant";kb.connectionLost="connectionLost";kb.clientError="clientError";kb.serverError="serverError";Object(e.a)(kb,"WopiHostErrorCodes",null,[]);var $b=a(728);class qc{}Object(e.a)(qc,"OAuthCallerMetadata",null,[]);var Rc=
a(27);class Jc{constructor(N){this.pxa=N;this.Gng=sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}Lyg(N,Ka,Cb,jc,Kc,kd){if(!this.pxa)return jc=new Q.a,jc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(jc);const qd=new qc;qd.AddinName=Kc;qd.AddinTrustId=kd;let yd=-1;kd=null;if(jc&&this.rdf())kd=this.pxa.V$f(Rd.a.Ryc,N,jc,Jc.g0e(Kc),qd);else{const Jd=Date.now();kd=this.pxa.wO(Rd.a.Ryc,N,qd).then(Vd=>{yd=Date.now()-
Jd;const Oe=(Ka||Cb)&&"login_required"===Vd.ErrorCode;return(Ka&&("interaction_required"===Vd.ErrorCode||"consent_required"===Vd.ErrorCode||"invalid_grant"===Vd.ErrorCode)||Oe)&&this.rdf()?this.pxa.V$f(Rd.a.Ryc,N,null,Jc.g0e(Kc),qd):Promise.resolve(Vd)})}return kd.then(Jd=>{const Vd=new Q.a;Jd.IsSuccess?(Vd.token=Jd.Token,Jd.Telemetry&&(Vd.QSa=Jd.Telemetry.fromCache,Vd.expiresOn=Jd.Telemetry.expiresOn)):(Vd.errorCode=this.Jxi(Jd),Vd.pUd=this.GVi(Jd));return Vd}).catch(()=>{const Jd=new Q.a;Jd.errorCode=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Jd)}).then(Jd=>{Jd.zga="OauthManager";0<=yd&&(Jd.Kvb=yd);return Jd})}kgi(N){const Ka=(sd.AFrameworkApplication.fa.Va(sd.AFrameworkApplication.j7)||"").toLowerCase();return(Rc.a.Lwa||"teams"===Ka&&$b.a.Vwb)&&!Jc.Pfi(N)||!this.pxa||!this.pxa.t5a()?!1:!0}rdf(){return this.Gng||1!==La.a.N9b()}Jxi(N){switch(N.ErrorCode){case "UserCancelled":case "interaction_required":N=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;
case "consent_required":case "invalid_grant":N=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":N=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":N=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":N=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":N=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:N=
N.ErrorCode===kb.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:N.ErrorCode===kb.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:N.ErrorCode===kb.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:N.ErrorCode===kb.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:N.ErrorCode===kb.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return N}GVi(N){let Ka=
"";(N=RegExp("AADSTS(\\d+)").exec(N.ErrorMessage))&&1<N.length&&(Ka=N[1]);return Ka}static g0e(N){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,N)}static Pfi(N){if(!N)return!1;N=N.toLowerCase();for(const Ka of Ph.AppsForOfficeSingleSignOnManager.qSe)if(Ka===N)return!0;return!1}}Object(e.a)(Jc,"AppsforOfficeTokenFromOauthManager",null,[214]);class Hc{constructor(N){this.Qwi=N}static Vna(){if(sd.AFrameworkApplication.fa.qa("AppForOfficeSSOV2IsEnabled")){var N=
null;try{N=Cd.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(Ka){n.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+Ka)}N=new Jc(N);Hc.Ma=new Hc(N)}}static getInstance(){Hc.b7d||(Hc.Vna(),Hc.b7d=!0);return Hc.Ma}}Hc.Ma=null;Hc.b7d=!1;Object(e.a)(Hc,"AppsForOfficeOauthManagerFactory",null,[197]);var rc=a(1291),Wc=a(133);class $c{constructor(N,Ka,Cb,jc){this.menuItemId=N;this.bG=Ka;this.BFj=Cb;this.yyh=jc}}Object(e.a)($c,"NewDocumentParameters",null,[]);const rd=N=>
{var Ka=N.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Cb=Ka.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Cb.addParameter("shortcuts","String[]",1,null,0);Ka.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Cb=Ka.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Cb.addParameter("shortcuts","Object",1,null,0);Ka=N.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}",
"{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Cb=Ka.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Cb.addParameter("pickerCustomizationJsonString","String",1,null,0);Ka=N.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Cb=Ka.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Cb.addParameter("base64File","String",1,null,0);Ka=N.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}",
"",3,0);Ka.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Cb=Ka.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Cb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ka=N.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);Ka.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,
0);Cb=Ka.addMethod("Register",1,"Void",0,0,"Register",0);Cb.addParameter("metadata","String",1,null,0);Cb.addParameter("javascript","String",1,null,0);Ka=N.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);Ka.addProperty("Enabled",1,"Boolean",1,!1,null,0);Ka.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);Ka.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);Ka=N.addEnumType("Microsoft.Authentication.IdentityType");Ka.addEnumField("OrganizationAccount",
0);Ka.addEnumField("MicrosoftAccount",1);Ka=N.addEnumType("Microsoft.Authentication.AuthorityType");Ka.addEnumField("External",0);Ka.addEnumField("Msa",1);Ka.addEnumField("Aad",2);Ka=N.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);Ka.addProperty("DisplayName",4,"String",1,!1,null,0);Ka.addProperty("Email",3,"String",1,!1,null,0);Ka.addProperty("FederationProvider",2,"String",1,!1,null,0);Ka.addProperty("IdentityType",
1,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ka=N.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);Ka.addProperty("AppId",4,"String",1,!1,null,0);Ka.addProperty("Authority",2,"String",1,!1,null,0);Ka.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);Ka.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);Ka.addProperty("TenantId",6,"String",1,!1,null,0);Ka.addProperty("Upn",
1,"String",1,!1,null,0);Ka=N.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);Ka.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Cb=Ka.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Cb.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);Ka.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",
2,1,"AuthContext",0);Ka.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);Ka=N.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);Ka.addProperty("AuthChallenge",3,"String",1,!1,null,0);Ka.addProperty("CorrelationId",7,"String",1,!1,null,0);Ka.addProperty("Policy",4,"String",1,!1,null,0);Ka.addProperty("Resource",2,"String",1,!1,null,0);Ka.addProperty("Scope",
5,"String",1,!1,null,0);Ka.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);Ka=N.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);Ka.addProperty("AccessToken",2,"String",1,!1,null,0);Ka.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ka=N.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);Ka.addProperty("Id",1,"String",1,
!0,null,0);Ka.addProperty("Value",2,"Object",1,!1,null,0);Ka=N.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Cb=Ka.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Cb.addParameter("id","String",1,null,0);Cb=Ka.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Cb.addParameter("id","String",1,null,0);Ka=N.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}",
"{43a4559c-806b-4e89-914e-da9256212148}",3,0);Ka.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Cb=Ka.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Cb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ka=N.addEnumType("Microsoft.AppRuntime.AppRuntimeState");Ka.addEnumField("Inactive",0);Ka.addEnumField("Background",1);Ka.addEnumField("Visible",2);Ka=N.addEnumType("Microsoft.AppRuntime.Visibility");
Ka.addEnumField("Hidden",1);Ka.addEnumField("Visible",2);Ka=N.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);Ka.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Cb=Ka.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Cb.addParameter("jsonCreate","String",1,null,0);Cb=Ka.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Cb.addParameter("jsonUpdate",
"String",1,null,0);Cb=Ka.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Cb.addParameter("id","String",1,null,0);Cb=Ka.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Cb.addParameter("id","String",1,null,0);Ka.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ka=N.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);Ka.addProperty("Id",2,"String",1,!0,null,0);Cb=Ka.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",
0);Cb.addParameter("visibility","Boolean",1,null,0);Ka.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ka=N.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);Ka.addProperty("Enabled",3,"Boolean",1,!1,null,0);Ka.addProperty("Id",2,"String",1,!0,null,0);Ka.addProperty("Label",4,"String",1,!0,null,0);Cb=Ka.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Cb.addParameter("enabled","Boolean",1,null,0);Ka.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",
0);Ka=N.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);Ka.addMethod("GetCount",3,"Int32",1,1,"Count",0);Cb=Ka.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Cb.addParameter("key","String",1,null,0);Ka.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ka.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);Ka=N.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");Ka.addEnumField("Unknown",0);Ka.addEnumField("Basic",
1);Ka.addEnumField("Premium",2);Ka=N.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Cb=Ka.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Cb.addParameter("feature","String",1,null,0);Cb.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Cb=Ka.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",
0);Cb.addParameter("feature","String",1,null,0);Cb=Ka.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Cb.addParameter("feature","String",1,null,0);Cb.addParameter("fallbackValue","Boolean",1,null,0);Ka.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Cb=Ka.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Cb.addParameter("experienceId","String",1,null,0);Cb=Ka.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",
4);Cb.addParameter("feature","String",1,null,0);Ka=N.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);Ka.addProperty("Id",5,"String",1,!0,null,0);Ka.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);Ka.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);Ka=N.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);
Ka.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);Ka=N.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);Ka.addMethod("Disable",3,"Void",0,1,"Disable",0);Ka.addMethod("Enable",2,"Void",0,1,"Enable",0);Ka.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var Pd=a(183);class ee{constructor(N,Ka){this.Yrg=N;this.ssg=Ka}createAndOpenWorkbook(N){if(N&&
N.length>this.Yrg)throw n.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",N.length),OfficeExtension.WacRuntime.Utility.createRichApiException(hg.a.invalidArgument,Pd.a.ga(1766));const Ka=new $c("blank","agave",N?"streamBase64":"streamEmpty",N);let Cb=null;return OfficeExtension.WacRuntime.Utility.createPromise((jc,Kc)=>{const kd=new Wc.StandardDialog;kd.Rb=4;kd.wl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,qd=>{2===qd||0===qd?Kc("Cancelled"):
(Cb=window.open(""),this.ssg.create(jc,Kc,Ka).h0a())})}).then(jc=>{if(!jc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(hg.a.generalException,Pd.a.ga(1762));try{Cb.top.location.href=jc}catch(Kc){n.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",Rc.a.jp,Kc),n.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),
Cb.location.replace(jc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},jc=>{if("Cancelled"===jc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(hg.a.qBd,Pd.a.ga(1765));Cb.close();this.FIj();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertySetAsync(N,Ka){this.invokePropertySet(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Ka){switch(N){case 1:return this.M3g(Ka)}N=this.invokeMethod(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}M3g(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return this.createAndOpenWorkbook(N)}FIj(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(hg.a.generalException,
Pd.a.ga(1762));}}Object(e.a)(ee,"WacWorkbook",null,[]);const ye=(N,Ka)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof N+", objectId="+N+", value="+Ka);return null},Me=N=>{N.add("InternalTest","PreviewExecutionMethod",ye)};var cf=a(248),Te=a(729),Hf=a(736);class Ye{constructor(N){this.jb=N}get $(){return this.jb}}Object(e.a)(Ye,"RichApiPreviewExecutionContext",null,[]);var ig=a(24),eg=a(862),Kf=a(33),zg=a(208),Fg=a(210),Yg=a(117),nh=a(12);class yf extends Fg.a{constructor(N,
Ka,Cb,jc){super(N,"Select Data");this.hob=null;this.aFe=Ka;this.w4c=Cb;this.callback=jc}get oc(){return"DdaBindingPrompt"}start(N,Ka){let Cb="<div class='"+Yg.a.Ymh+" "+Gg.a.Zo+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+Yg.a.VE+"' /></div>";Cb=String.format(Cb,Bf.a.Eg(this.w4c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Lb.innerHTML=Cb;this.hob=nh.DOMElementExtensions.getElementById(this.Lb,"bindingText");N=Ka?N.j2a(Ka,this.w4c.DdaBindingsMethod.BindingId):
null;(null===N||void 0===N?0:N.IsValidRef)?(Ka=new ig.Range(N.Reference.FirstRow+1,N.Reference.FirstColumn+1,N.Reference.LastRow+1,N.Reference.LastColumn+1,!1,!1),this.hob.value=N.Reference.SheetName+"!"+Ka):(N=Eg.g(this.$).ha,this.hob.value=Wg.f(this.$.pa)||!N.sa.wg?"":N.Dha);this.initialize();this.Ff()}Fo(){this.b_c();this.addButton(0);this.addButton(1);super.Fo()}setFocus(){nh.DOMElementExtensions.setFocus(this.hob)}validate(){return!0}commit(){let N=this.hob.value.trim();const Ka=N.indexOf("!");
-1!==Ka&&(N=this.wWh(N.substring(0,Ka))+N.substr(Ka));this.aFe.addBinding(this.w4c,N,0,this.callback);return!0}Zra(){this.aFe.VP.sf(Te.a.internalError,this.callback);super.Zra()}wWh(N){N=eh.a.trimStart(N.trim(),"=");return N.length?N.startsWith("'")&&N.endsWith("'")?N:Eh.HelperMethods.S6b(N):""}}Object(e.a)(yf,"DdaBindingPrompt",Fg.a,[]);class kf{constructor(N){this.ea=N}sf(N,Ka){if(Ka){const Cb={};Cb.Error=N;Cb.Version=this.ea.Ke;Ka(Cb)}}mJa(N,Ka){this.sf(N,Ka)}oH(N,Ka){this.sf(Te.a.STe(N.Errors[0].MessageId),
Ka)}Yu(N){N&&N(this.GP())}GP(){const N={Error:0};N.Version=this.ea.Ke;return N}}Object(e.a)(kf,"DdaErrorGenerator",null,[]);var hf=a(281),Of=a(97);class jg{constructor(N,Ka,Cb){this.$=N;this.VP=Ka;this.fA=Cb}mwd(N,Ka){const Cb=N.DdaGoToByIdMethod.GoToType,jc=N.DdaGoToByIdMethod.SelectionMode,Kc=N.DdaGoToByIdMethod.Id.toString().trim(),kd=qd=>{const yd=this.$.xa.getItemByName(qd.SheetName);(null===yd||void 0===yd?0:yd.visible)?(Eg.g(this.$).Dg(qd,null,null,null,3,Of.a.lbh,void 0,void 0,void 0,void 0,
!0),this.VP.Yu(Ka)):this.VP.sf(Te.a.wUg,Ka)};0===Cb?this.GBi(Kc,jc,N.DdaMethod.ControlId,kd,Ka):1===Cb?this.KBi(Kc,jc,kd,Ka):this.VP.sf(Te.a.APj,Ka)}GBi(N,Ka,Cb,jc,Kc){this.fA.ddaGetBinding(Cb,N,kd=>{if(!hf.a(kd)&&kd.Result&&kd.Result.Reference){kd=kd.Result;var qd={};qd.SheetName=kd.Reference.SheetName;qd.FirstRow=kd.Reference.FirstRow;qd.FirstColumn=kd.Reference.FirstColumn;qd.LastRow=kd.Reference.LastRow;qd.LastColumn=kd.Reference.LastColumn;jg.MUc(qd,Ka);1!==kd.BindingType?jc(qd):this.fA.ddaGetBindingData(Cb,
N,1,0,2,0,0,-1,-1,yd=>{hf.a(yd)||!yd.Result?this.VP.oH(yd,Kc):(yd=yd.Result,2!==Ka&&(qd.FirstRow-=yd.Headers.length,0>qd.FirstRow&&(qd.FirstRow=0)),jc(qd))},Kc)}else this.VP.mJa(Te.a.M4f,Kc)},Kc)}KBi(N,Ka,Cb,jc){var Kc=vh.z(N);Kc?(Kc=vh.v(Kc,this.$),jg.MUc(Kc,Ka),Cb(Kc)):this.$.ea.isNamedObjectViewMode&&this.$.zb.Ek(N)?this.$.zb.pa=this.$.zb.getItemByName(N):(Kc=kd=>{hf.a(kd)||!kd.Result?this.$.xa.contains(N)?(kd={},kd.SheetName=N,kd.FirstRow=0,kd.FirstColumn=0,kd.LastRow=0,kd.LastColumn=0,Cb(kd)):
this.VP.mJa(Te.a.M4f,jc):(kd=kd.Result,jg.MUc(kd,Ka),Cb(kd))},this.$.xa.pa?this.fA.parseRangeForGoto(N,this.$.xa.pa.name,Kc,jc):this.fA.parseRange(N,Kc,jc))}static MUc(N,Ka){N.LastRow=2===Ka?N.FirstRow:N.LastRow;N.LastColumn=2===Ka?N.FirstColumn:N.LastColumn}}Object(e.a)(jg,"DdaNavigator",null,[]);const fg=(N,Ka,Cb,jc,Kc,kd)=>{const qd=N.Na(1);qd.request=Ka;return Jg.g(N,"ExecuteRichApiRequest",qd,Cb,jc,Kc,kd,0)};var Yf=a(292),Pf;(function(N){N[N.unsupported=0]="unsupported";N[N.surface=1]="surface";
N[N.combo=2]="combo";N[N.column=3]="column";N[N.column3D=4]="column3D";N[N.bar=5]="bar";N[N.bar3D=6]="bar3D";N[N.line=7]="line";N[N.line3D=8]="line3D";N[N.pie=9]="pie";N[N.pie3D=10]="pie3D";N[N.scatter=11]="scatter";N[N.bubble=12]="bubble";N[N.area=13]="area";N[N.area3D=14]="area3D";N[N.doughnut=15]="doughnut";N[N.radar=16]="radar";N[N.stock=17]="stock";N[N.waterfall=18]="waterfall";N[N.funnel=19]="funnel";N[N.treemap=20]="treemap";N[N.sunburst=21]="sunburst";N[N.boxWhisker=22]="boxWhisker";N[N.histogram=
23]="histogram";N[N.pareto=24]="pareto";N[N.regionMap=25]="regionMap";N[N.noVisibleSeries=26]="noVisibleSeries";N[N.complexDataSource=27]="complexDataSource";N[N.pivotChart=28]="pivotChart"})(Pf||(Pf={}));Object(e.b)("ChartCategory",Pf);class Zf{constructor(N,Ka){this.source=N;this.eventId=Ka}}Object(e.a)(Zf,"MacroRecorderEventData",null,[]);class Gf{constructor(N,Ka,Cb){this.parentName=N;this.$=Ka;this.request=Cb}PUh(N){var Ka;if(void 0===N||null===N||void 0===N.RequestBody||null===N.RequestBody)return null;
const Cb=JSON.parse(N.RequestBody);if(void 0!==N.ActiveChartId&&null!==N.ActiveChartId){Cb.ActiveChartId=N.ActiveChartId;const jc=Eg.g(this.$).ha.Pa.$b;if(null===(Ka=null===jc||void 0===jc?void 0:jc.floatingObject)||void 0===Ka?0:Ka.Tc)Cb.ActiveChartType=Pf[jc.floatingObject.Tc.ChartCategory]}void 0!==N.SheetMultiRange&&null!==N.SheetMultiRange&&(Cb.SheetName=N.SheetMultiRange.SheetName);return Cb}bVh(N){if(void 0===N||null===N||void 0===N.Result||null===N.Result)return null;N=N.Result;return void 0===
N.ResponseBody||null===N.ResponseBody||N.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(N.ResponseBody.join(""))}wki(N){return!!N&&!(void 0===N.eventId||null===N.eventId)&&0<N.eventId.length}jj(N){return()=>{if(this.$.aba){const Ka=this.LQg(this.request);if(this.wki(Ka)){const Cb=this.PUh(this.request),jc=this.bVh(N);if(Cb&&!Jh.a.isEmpty(Cb)&&jc&&!Jh.a.isEmpty(jc))return n.ULS.sendTraceTag(537163164,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),
new W(Ka,Cb,jc);n.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${Cb?"(not null)":"(null)"}; responseInfo: ${jc?"(not null)":"(null)"}`}`)}}return new W(null,null,null)}}LQg(N){const Ka=this.xki(N.SolutionId),Cb=Gf.xUh(N);if(Cb&&Ka)return n.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:Cb,["request.SolutionId"]:N.SolutionId})}`),new Zf(N.SolutionId,Cb);N=JSON.stringify({["recorderEventId"]:Cb,["isRecorderAwareAddin"]:Ka,
["request.SolutionId"]:N.SolutionId});n.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${N}`);return null}xki(N){if(!N)return!1;N=N.toLowerCase();return Gf.v_h().contains(N)}static v_h(){Gf.cza||(Gf.cza=new u.a(T.a.Sk()),Gf.cza.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Gf.cza.add("fa000000005"),Gf.cza.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Gf.cza.add("fa000000014"),Gf.cza.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return Gf.cza}static xUh(N){let Ka=null;var Cb=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',
"mi");if(Cb.test(N.RequestBody))Ka=Cb.exec(N.RequestBody)[1];else{N=N.RequestHeaders;if(!N)return Ka;Cb=Pe.a.qEi.toLowerCase();for(let jc=0;jc<N.length;jc++)if(N[jc].Name.toLowerCase()===Cb){Ka=N[jc].Value;break}}return Ka}}Gf.cza=null;Object(e.a)(Gf,"DdaRichApiRequestRecorder",null,[]);class vg extends Yf.a{constructor(N,Ka,Cb,jc,Kc,kd,qd,yd){super(10,0,Ka,yd);this.flb=Cb;this.zhb=jc;this.L2=Kc;this.HEa=kd;this.request=qd;this.cLd=new Gf("10",N,qd)}get KF(){return z.EwaSettings.dc()?super.KF:2}get mBc(){return this.HEa}get wt(){return this.flb}get N$(){return this.zhb}a2(N){return super.a2(N)||
this.sTg(N)}jj(){return this.cLd.jj(this.dd)}Zdb(){const N={OperationType:3};N.RichApiRequest=this.request;return N}sTg(N){return(Ka,Cb,jc)=>fg(N,this.request,Tf.b(Ka,this.flb),Tf.a(Cb,this.zhb),jc,this.L2)}}Object(e.a)(vg,"DdaRichApiRequestBatchOperation",Yf.a,[]);class bh extends Ch.a{constructor(N,Ka,Cb,jc){super(576,0,Cb,jc);this.cLd=new Gf("576",N,Ka)}get KF(){return z.EwaSettings.dc()?super.KF:0}jj(){return this.cLd.jj(this.dd)}}Object(e.a)(bh,"DdaRichApiRequestOperation",Ch.a,[]);class Wf{constructor(N,
Ka){this.jI=(Cb,jc)=>{this.VP.mJa(Te.a.internalError,jc)};this.$=N;this.VP=Ka}ddaAddBinding(N,Ka,Cb,jc,Kc,kd,qd){this.PJ((yd,Jd,Vd)=>{var Oe=this.$.oa.va,Qe=this.Tia();yd=Tf.b(yd,kd);Jd=Tf.a(Jd,this.jI);const lf=Oe.Na(9);lf.controlId=N;lf.bindingId=Ka;lf.bindingType=Cb;lf.currentSheetName=Qe;lf.formula=jc;lf.options=Kc;return Jg.g(Oe,"DdaAddBinding",lf,yd,Jd,Vd,qd,0)},qd,563)}ddaReleaseBinding(N,Ka,Cb,jc){this.PJ((Kc,kd,qd)=>{var yd=this.$.oa.va;Kc=Tf.b(Kc,Cb);kd=Tf.a(kd,this.jI);const Jd=yd.Na(9);
Jd.controlId=N;Jd.bindingId=Ka;return Jg.g(yd,"DdaReleaseBinding",Jd,Kc,kd,qd,jc,0)},jc,564)}ddaGetBinding(N,Ka,Cb,jc){this.PJ((Kc,kd,qd)=>{var yd=this.$.oa.va;Kc=Tf.b(Kc,Cb);kd=Tf.a(kd,this.jI);const Jd=yd.Na(1);Jd.controlId=N;Jd.bindingId=Ka;return Jg.g(yd,"DdaGetBinding",Jd,Kc,kd,qd,jc,0)},jc,565,16)}ddaGetAllBindings(N,Ka,Cb){this.PJ((jc,Kc,kd)=>{var qd=this.$.oa.va;jc=Tf.b(jc,Ka);Kc=Tf.a(Kc,this.jI);const yd=qd.Na(1);yd.controlId=N;return Jg.g(qd,"DdaGetAllBindings",yd,jc,Kc,kd,Cb,0)},Cb,566,
16)}ddaGetBindingData(N,Ka,Cb,jc,Kc,kd,qd,yd,Jd,Vd,Oe){this.PJ((Qe,lf,qg)=>{var ag=this.$.oa.va,bg=this.Tia();Qe=Tf.b(Qe,Vd);lf=Tf.a(lf,this.jI);const Rf=ag.Na(1);Rf.controlId=N;Rf.bindingId=Ka;Rf.coerceType=Cb;Rf.valueFormat=jc;Rf.filterType=Kc;Rf.startRow=kd;Rf.startCol=qd;Rf.rowCount=yd;Rf.colCount=Jd;Rf.currentSheetName=bg;return Jg.g(ag,"DdaGetBindingData",Rf,Qe,lf,qg,Oe,0)},Oe,567,16)}ddaSetBindingData(N,Ka,Cb,jc,Kc,kd,qd){this.PJ((yd,Jd,Vd)=>{var Oe=this.$.oa.va,Qe=this.Tia();yd=Tf.b(yd,kd);
Jd=Tf.a(Jd,this.jI);const lf=Oe.Na(9);lf.controlId=N;lf.bindingId=Ka;lf.startRow=Cb;lf.startCol=jc;lf.currentSheetName=Qe;lf.bindingData=Kc;return Jg.g(Oe,"DdaSetBindingData",lf,yd,Jd,Vd,qd,0)},qd,568)}ddaGetSelectedData(N,Ka,Cb,jc,Kc,kd,qd){this.PJ((yd,Jd,Vd)=>{var Oe=this.$.oa.va,Qe=this.Tia();yd=Tf.b(yd,kd);Jd=Tf.a(Jd,this.jI);const lf=Oe.Na(1);lf.controlId=N;lf.coerceType=Ka;lf.valueFormat=Cb;lf.filterType=jc;lf.currentSheetName=Qe;lf.formula=Kc;return Jg.g(Oe,"DdaGetSelectedData",lf,yd,Jd,Vd,
qd,0)},qd,569,16)}ddaSetSelectedData(N,Ka,Cb,jc,Kc){this.PJ((kd,qd,yd)=>{var Jd=this.$.oa.va,Vd=this.Tia();kd=Tf.b(kd,jc);qd=Tf.a(qd,this.jI);const Oe=Jd.Na(9);Oe.controlId=N;Oe.currentSheetName=Vd;Oe.formula=Ka;Oe.bindingData=Cb;return Jg.g(Jd,"DdaSetSelectedData",Oe,kd,qd,yd,Kc,0)},Kc,570)}ddaLoadSettings(N,Ka,Cb){this.PJ((jc,Kc,kd)=>{var qd=this.$.oa.va;jc=Tf.b(jc,Ka);Kc=Tf.a(Kc,this.jI);const yd=qd.Na(1);yd.controlId=N;return Jg.g(qd,"DdaLoadSettings",yd,jc,Kc,kd,Cb,0)},Cb,501,16)}ddaSaveSettings(N,
Ka,Cb,jc,Kc){this.PJ((kd,qd,yd)=>{var Jd=this.$.oa.va;kd=Tf.b(kd,jc);qd=Tf.a(qd,this.jI);const Vd=Jd.Na(9);Vd.controlId=N;Vd.settings=Ka;Vd.overwriteIfStale=Cb;return Jg.g(Jd,"DdaSaveSettings",Vd,kd,qd,yd,Kc,0)},Kc,571)}ddaAddRowsColumns(N,Ka,Cb,jc,Kc,kd){this.PJ((qd,yd,Jd)=>{var Vd=this.$.oa.va,Oe=this.Tia();qd=Tf.b(qd,Kc);yd=Tf.a(yd,this.jI);const Qe=Vd.Na(9);Qe.controlId=N;Qe.bindingId=Ka;Qe.isRow=Cb;Qe.currentSheetName=Oe;Qe.bindingData=jc;return Jg.g(Vd,"DdaAddRowsColumns",Qe,qd,yd,Jd,kd,0)},
kd,572)}ddaDeleteAllDataValues(N,Ka,Cb,jc){this.PJ((Kc,kd,qd)=>{var yd=this.$.oa.va,Jd=this.Tia();Kc=Tf.b(Kc,Cb);kd=Tf.a(kd,this.jI);const Vd=yd.Na(9);Vd.controlId=N;Vd.bindingId=Ka;Vd.currentSheetName=Jd;return Jg.g(yd,"DdaDeleteAllDataValues",Vd,Kc,kd,qd,jc,0)},jc,573)}ddaClearBindingFormats(N,Ka,Cb,jc){this.PJ((Kc,kd,qd)=>{var yd=this.$.oa.va,Jd=this.Tia();Kc=Tf.b(Kc,Cb);kd=Tf.a(kd,this.jI);const Vd=yd.Na(9);Vd.controlId=N;Vd.bindingId=Ka;Vd.currentSheetName=Jd;return Jg.g(yd,"DdaClearBindingFormats",
Vd,Kc,kd,qd,jc,0)},jc,574)}ddaSetBindingFormats(N,Ka,Cb,jc,Kc,kd){this.PJ((qd,yd,Jd)=>{var Vd=this.$.oa.va,Oe=this.Tia();qd=Tf.b(qd,Kc);yd=Tf.a(yd,this.jI);const Qe=Vd.Na(9);Qe.controlId=N;Qe.bindingId=Ka;Qe.currentSheetName=Oe;Qe.bindingData=Cb;Qe.isSetFormats=jc;return Jg.g(Vd,"DdaSetBindingFormats",Qe,qd,yd,Jd,kd,0)},kd,575)}parseRange(N,Ka,Cb){this.PJ((jc,Kc,kd)=>{const qd=this.$.oa.va.Sb();return Jg.v(this.$.oa.va,N,-1,Tf.b(jc,Ka),Tf.a(Kc,this.jI),kd,Cb,qd)},Cb,162,16)}parseRangeForGoto(N,Ka,
Cb,jc){this.PJ((Kc,kd,qd)=>{const yd=this.$.oa.va.Sb();return Jg.w(this.$.oa.va,N,Ka,Tf.b(Kc,Cb),Tf.a(kd,this.jI),qd,jc,yd)},jc,562,16)}executeRichApiRequest(N,Ka,Cb){z.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(N.RequestFlags&=8191);if(z.EwaSettings.ma(258))this.Awh(this.$.oa.va.Sb(),Ka,()=>{this.VP.mJa(Te.a.internalError,Cb)},Cb,N);else{let jc=yg.DdaFacade.ped(N);!z.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.rb.Zx||jc&16?(z.EwaSettings.dc()&&(jc|=64),this.$.userOperationManager.Yt(new bh(this.$,N,(Kc,kd,qd)=>fg(this.$.oa.va,N,Tf.b(Kc,Ka),Tf.a(kd,this.jI),qd,Cb),jc))):(this.VP.mJa(Te.a.oCc,Cb),n.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}}Tia(){return this.$.ea.isNamedObjectViewMode?this.$.pa.sheetName:this.$.activeItemName}PJ(N,Ka,Cb,jc=0){!z.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.Zx||jc&16?z.EwaSettings.dc()?
this.$.userOperationManager.Yt(new Ch.a(Cb,0,N,jc|64)):this.$.userOperationManager.Yt(new li.a(Cb,0,N,jc)):(this.VP.mJa(Te.a.oCc,Ka),n.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}Awh(N,Ka,Cb,jc,Kc){let kd=yg.DdaFacade.ped(Kc);if(!z.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.Zx||kd&16){var qd=this.$.Ib.Bc("UserAction","Rich Api request");z.EwaSettings.dc()&&(kd|=64);this.$.userOperationManager.Ub(new vg(this.$,N,Ka,
Cb,jc,qd,Kc,kd),null)}else this.VP.mJa(Te.a.oCc,jc),n.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")}}Object(e.a)(Wf,"DdaWebServiceHelper",null,[]);class si{constructor(N,Ka,Cb,jc){this.nyh=N;this.fileSize=Ka;this.ZBj=jc}}Object(e.a)(si,"DocumentFile",null,[]);class oh{}oh.generalException="GeneralException";oh.eJg="ApiNotFound";oh.qBd="OperationCancelled";oh.invalidArgument="InvalidArgument";Object(e.a)(oh,"ErrorCodes",null,[]);class Ei{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}
Object(e.a)(Ei,"WacApiDelegates",null,[]);var Vi=a(612);class tg extends Ei{constructor(N,Ka){super();this.hgf=(Cb,jc)=>{Cb=tg.i2g(Cb,jc);if(!Vi.a(this.$,Cb))return!0;Cb=this.$.shortcutKeyManager.y1e(Cb);return!!Cb&&0<Cb.length};this.addinId=N;this.$=Ka}replaceShortcuts(N){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,N,this.hgf)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(N){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(N,
this.hgf)}static G6g(N,Ka){const Cb=document.createEvent("KeyboardEvent");if(Rc.a.wF)Cb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(N&8),!!(N&32),!!(N&4),!!(N&256));else{const jc=[];N&4&&jc.push("Shift");N&8&&jc.push("Control");N&32&&jc.push("Alt");Cb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,jc.join(" "),!1,"en-US")}N=new Sys.UI.DomEvent(Cb);N.keyCode=Ka;return N}static i2g(N,Ka){if(Rc.a.Tf)switch(Ka){case 189:Ka=173;break;case 187:Ka=61;break;case 186:Ka=59}return tg.G6g(N,
Ka)}}Object(e.a)(tg,"ExcelWacApiDelegates",Ei,[]);class ug{constructor(N){this.XHa={};this.yyi=N}sAg(N,Ka){this.$bc(N)||(this.XHa[N]={});if(this.Ofi(N))return n.ULS.sendTraceTag(537163157,344,50,`App ${N} has reach the limit of number of cached files.`),Te.a.ezi;this.XHa[N][Ka.nyh.toString()]=Ka;return Te.a.success}gMh(N,Ka){let Cb=null;this.$bc(N)&&(Cb=this.XHa[N][Ka.toString()]);Cb||n.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${N}, fileHandler:${Ka}] doesn't exist`);return Cb}$bc(N){return N in
this.XHa}X8i(N,Ka){if(this.$bc(N)){const Cb=this.XHa[N];delete Cb[Ka.toString()];1>Object.keys(Cb).length&&delete this.XHa[N];return Ka.toString()in Cb?Te.a.internalError:Te.a.success}return Te.a.internalError}Ofi(N){return this.$bc(N)?Object.keys(this.XHa[N]).length>=this.yyi:!1}static getInstance(N){return N.da.za(200)||N.da.Ga(200,new ug(ug.zyi))}static tCi(){return++ug.KSg}}ug.cyi=4194304;ug.zyi=1;ug.KSg=0;Object(e.a)(ug,"GetFileApiHelper",null,[]);class Zg{constructor(N){this.sA=N}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.sA)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Ka){this.invokePropertySet(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){switch(N){case 1:return this.YCi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Ka){N=this.invokeMethod(N,
Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}YCi(){this.notifyActionHandlerReady();return null}}Object(e.a)(Zg,"AddinInternalService",null,[]);class Xf{constructor(N,Ka){this.XI=Ka;this.sA=N}getAppRuntimeState(){return this.XI.getAppRuntimeState(this.sA)?2:1}setAppRuntimeState(N){switch(N){case 2:N=!0;break;case 1:N=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(hg.a.invalidArgument,Pd.a.ga(1766));}this.XI.setAppRuntimeState(this.sA,N)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Ka){this.invokePropertySet(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N,Ka){switch(N){case 2:return this.kHh();case 1:return this.Xnj(Ka)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,
Ka){N=this.invokeMethod(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}kHh(){return this.getAppRuntimeState()}Xnj(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"int");this.setAppRuntimeState(N);return null}}Object(e.a)(Xf,"AppRuntimeService",null,[]);var Kg=a(966);class hh{constructor(N,Ka,Cb,jc){this.$w=N;this.P0=Cb;this.Ey=jc.Sh.getOsfControl(Ka)}disable(){try{if(!Pd.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.RBe();
if(!this.Eff())return this.SBe();this.P0.HOj(this.$w)}catch(N){return n.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",N.message||"Unknown"),this.PBe()}return null}enable(){try{if(!Pd.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.RBe();if(!this.Eff())return this.SBe();this.P0.W6i(this.$w)}catch(N){return n.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
N.message||"Unknown"),this.PBe()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Ka){this.invokePropertySet(N,
Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){switch(N){case 1:return this.MBa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Ka){switch(N){case 3:return this.Qeh();case 2:return this.Ljh()}N=this.invokeMethod(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}Qeh(){return this.disable()}Ljh(){return this.enable()}MBa(){this._OnAccess();return null}RBe(){return Kg.a(hg.a.notImplemented,
Pd.a.ga(1767))}SBe(){return Kg.a(hg.a.sharedRuntimeNotAvailable,Pd.a.ga(1771))}PBe(){return Kg.a(hg.a.generalException,Pd.a.ga(1762))}Eff(){const N=this.Ey.getSharedRuntimeId();return!!N&&0<N.length}}Object(e.a)(hh,"BeforeDocumentCloseNotification",null,[]);class uh{constructor(){this.uge=this.Dae=this.oA=!1}get enabled(){return this.oA}set enabled(N){this.oA=N}get nativeRuntime(){return this.Dae}set nativeRuntime(N){this.Dae=N}get streamingEnabled(){return this.uge}set streamingEnabled(N){this.uge=
N}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(N){switch(N){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N,Ka){switch(N){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ka,
0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ka,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ka,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Ka){this.invokePropertySet(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokeMethodAsync(N,Ka){N=this.invokeMethod(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}}Object(e.a)(uh,"CustomFunctionEngineStatus",null,[]);class wh{constructor(N,Ka,Cb){this.jqg=N;this.kqg=Ka;this.eug=Cb}get status(){const N=new uh;N.enabled=this.jqg;N.streamingEnabled=this.kqg;N.nativeRuntime=!1;return N}register(N){return OfficeExtension.WacRuntime.Utility.createPromise(this.eug(N))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(N){switch(N){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Ka){this.invokePropertySet(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Ka){switch(N){case 1:return this.M7i(Ka)}N=this.invokeMethod(N,
Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}M7i(N){const Ka=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,1,"string");return this.register(Ka,N)}}Object(e.a)(wh,"CustomFunctionManager",null,[]);var ti=a(943);class bj{constructor(N,Ka,Cb,jc){this.M1d="";this.uRb=0;this.IO=N;this._id=Ka;this.sA=Cb;this.XI=jc}get id(){return this._id}_RegisterStateChange(){this.uRb||this.IO.execute(N=>
{this.M1d=N.gma(this._id,Ka=>{this.XI.rAh(this.sA,this._id,JSON.stringify(Ka))})});this.uRb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.uRb--;this.uRb||this.IO.execute(N=>{N.CHd(this._id,this.M1d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(N){switch(N){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Ka){this.invokePropertySet(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Ka){switch(N){case 6:return this.Ljg();case 7:return this.Njg()}N=
this.invokeMethod(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}Ljg(){return this._RegisterStateChange()}Njg(){return this._UnregisterStateChange()}}Object(e.a)(bj,"LicenseFeature",null,[]);class cj{constructor(N,Ka){this.IO=Cd.a.instance.Wb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.sA=N;this.XI=Ka;this.Vsg=this.XI.Sh.getOsfControl(this.sA)}getFeatureTier(N,Ka){return OfficeExtension.WacRuntime.Utility.createPromise(Cb=>{const jc=1===Ka?1:2===
Ka?2:0;this.IO.execute(Kc=>{Kc.getFeatureTier(N,jc).then(kd=>{Cb(this.rQh(kd))},()=>{Cb(Ka)})})})}getLicenseFeature(N){N=new bj(this.IO,N,this.sA,this.XI);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}isFeatureEnabled(N,Ka){return OfficeExtension.WacRuntime.Utility.createPromise(Cb=>{this.IO.execute(jc=>{jc.isFeatureEnabled(N,Ka).then(Kc=>{Cb(Kc)},()=>{Cb(Ka)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(N=>{this.IO.execute(Ka=>{Ka=
Ka.isFreemiumUpsellEnabled();N(Ka)})})}launchUpsellExperience(N){if(this.Vsg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.IO.execute(Ka=>{Ka.launchUpsellExperience(N)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(hg.a.bSc,"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Ka){this.invokePropertySet(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N,Ka){switch(N){case 6:return this.Mjg(Ka)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Ka){switch(N){case 2:return this.$Mh(Ka);case 5:return this.qQh(Ka);
case 1:return this.Agi(Ka);case 3:return this.ghi();case 4:return this.Hqi(Ka)}N=this.invokeMethod(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}$Mh(N){const Ka=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,1,"int");return this.getFeatureTier(Ka,N)}qQh(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return this.getLicenseFeature(N)}Agi(N){const Ka=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,
0,"string");N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,1,"boolean");return this.isFeatureEnabled(Ka,N)}ghi(){return this.isFreemiumUpsellEnabled()}Hqi(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return this.launchUpsellExperience(N)}Mjg(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");this._TestFireStateChangedEvent(N);return null}rQh(N){switch(N){case 1:return 1;case 2:return 2;default:return 0}}}Object(e.a)(cj,"License",
null,[]);var ij=a(152);const dj=(N,Ka,Cb)=>jc=>(Kc,kd)=>{ef.TaskExtensions.Aa(og.GetServiceTaskFactory.create(Ka.da,279,Ka.la,1),qd=>{qd=qd.result;let yd=!1;var Jd=Cb.Sh.getOsfControl(N);let Vd=null;Jd&&(Vd=Jd.getStoreType(),(Jd=Jd.getManifest())&&Jd.getSharedRuntimeForCustomFunctions("Workbook")&&(yd=!0));ef.TaskExtensions.Aa(qd.q$e(N,Vd,jc,yd),Oe=>{ij.b(Oe)?Oe.result?Kc(null):kd(OfficeExtension.WacRuntime.Utility.createRichApiException(hg.a.invalidArgument,ud.a.instance.ga(1766))):kd(OfficeExtension.WacRuntime.Utility.createRichApiException(hg.a.generalException,
ud.a.instance.ga(1762)))},Ka.la,3)},Ka.la,3)};class Zi{constructor(N){if(!N)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.yud=N}areShortcutsInUse(N){return OfficeExtension.WacRuntime.Utility.createPromise((Ka,Cb)=>{this.yud.checkShortcutsInUse(N).then(jc=>{Ka(jc)}).catch(jc=>{Cb(jc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((N,Ka)=>{this.yud.getShortcuts().then(Cb=>{N(Cb)}).catch(Cb=>{Ka(Cb)})})}replaceShortcuts(N){return OfficeExtension.WacRuntime.Utility.createPromise((Ka,
Cb)=>{this.yud.replaceShortcuts(N).then(()=>{Ka(null)}).catch(jc=>{Cb(jc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Ka){this.invokePropertySet(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokeMethodAsync(N,Ka){switch(N){case 3:return this.OKg(Ka);case 1:return this.AWh();case 2:return this.vdj(Ka)}N=this.invokeMethod(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}OKg(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"Array<string>");return this.areShortcutsInUse(N)}AWh(){return this.getShortcuts()}vdj(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"any");return this.replaceShortcuts(N)}}Object(e.a)(Zi,"ActionService",
null,[]);var jj=a(516);class ej{constructor(){this.Lqa=null}nWh(){this.Lqa||(this.Lqa=jj.a.Uq(Cd.a.instance.Wb("Common.App.SharedFilePicker.ISharedFilePicker")));return this.Lqa}getSharedFilePickerResponse(N){return OfficeExtension.WacRuntime.Utility.createPromise((Ka,Cb)=>{try{const jc=this.nWh();kh.Task.WAA.call(null,jc).continueWith(()=>{const Kc=jc.result;if(Kc){let kd={};({Ut:kd}=pe.d(N)).returnValue?Kc.Xcd(kd).then(qd=>{qd&&0<qd.length?Ka(qd):Cb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker returned null or an empty array."))}).catch(qd=>{Cb(qd)}):Cb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Cb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(jc){Cb(jc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,Ka){this.invokePropertySet(N,Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,Ka){switch(N){case 1:return this.mWh(Ka)}N=this.invokeMethod(N,
Ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}mWh(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return this.getSharedFilePickerResponse(N)}}Object(e.a)(ej,"SharedFilePicker",null,[]);class fj{createInstance(N,Ka){switch(N){case "Microsoft.Office.ActionService":return new Zi(Ka);case "Microsoft.Office.SharedFilePicker":return new ej}return null}}Object(e.a)(fj,"WacApiHost",null,[]);class gj{constructor(N,Ka,Cb,jc,Kc){this.GRc=null;this.CPb=
N;this.sA=Ka;this.XI=Cb;this.jb=jc;this.cyg=Kc}hostName(){return"ExcelOnline"}appId(){return this.CPb}createInstance(N){switch(N){case "Microsoft.Authentication.AuthenticationService":return Cd.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.sA,this.XI.Sh);case "Microsoft.Authentication.TokenParameters":return new Yh;case "Microsoft.ExcelServices.CustomFunctionManager":N=this.jb.ma(121);var Ka=this.jb.ma(122);return new wh(N,Ka,dj(this.CPb,
this.jb,this.XI));case "Microsoft.AppRuntime.AppRuntimeService":return new Xf(this.sA,this.XI);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return N=cf.a(this.jb),new hh(this.CPb,this.sA,N,this.XI);case "Microsoft.DynamicRibbon.DynamicRibbon":return N=cf.a(this.jb),new ti.DynamicRibbon(this.CPb,this.sA,this.XI,N,N.fn(this.sA).ml);case "Microsoft.Office.Licensing.License":return new cj(this.sA,this.XI);case "Microsoft.InternalService.AddinInternalService":return new Zg(this.sA);
default:if(this.GRc||(this.GRc=new fj),Ka=this.GRc.createInstance(N,this.cyg))return Ka}n.ULS.sendTraceTag(537163155,0,10,`Typename: ${N} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException(hg.a.generalException,hg.a.generalException);}}Object(e.a)(gj,"RichApiHost",null,[]);var kj=a(378),hj=a(28),lj=a(118),$i=a(35),mj=a(100),nj=a(283),oj=a(42),pj=a(249),qj=a(6),rj=a(68),sj=a(199);class tf{constructor(N,Ka,Cb){this.rangePicker=
null;this.$=N;this.oe=Ka;this.we=new kf(N.ea);this.fA=new Wf(N,this.we);this.$qf=Cb;this.X7b=new Map}get VP(){return this.we}dispose(){this.$=this.X7b=null}Nc(){return!1}Rc(){return!1}executeCommand(N,Ka,Cb){N=Ka.command;switch(N){case 451041795:this.we.sf(Cb[Mg.a.Zf],Cb[Mg.a.L2]);break;case 974713501:this.b2h(Cb[Mg.a.Zf],Cb[Mg.a.L2]);break;case 1237877382:this.we.Yu(Cb[Mg.a.L2]);break;default:return $h.a(N)}return kh.Task.Ta(!0)}Cc(N,Ka,Cb){if(N=!!Cb)switch(Ka.command){case 974713501:case 1237877382:case 451041795:break;
default:N=!1}return N}b2h(N,Ka){var Cb;const jc=N.DdaMethod;if("undefined"===typeof jc.DispatchId)this.we.sf(Te.a.internalError,Ka);else if(tf.Hfi(N)||this.$.Bd&1){if(jc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new yf(this.$,this,N,Ka)).start(this.oe,N.DdaMethod.ControlId):jc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.NVh(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.vsj(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(N,this.vcd(N.DdaMethod.ControlId),0,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.THh(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.hoj(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.SHh(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.W8i(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.PGh(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.Asd(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(N.DdaAddRowsColumns.IsRow=!0,this.ble(N,Ka)):jc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(N.DdaAddRowsColumns.IsRow=!1,this.ble(N,Ka)):jc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.zch(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.iXg(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(N.DdaSetBindingFormats.IsSetFormats=!0,this.TXf(N,Ka)):jc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(N.DdaSetBindingFormats.IsSetFormats=!1,this.TXf(N,Ka)):jc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(N,N.DdaBindingsMethod.ItemName,N.DdaBindingsMethod.FailOnCollision?2:1,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.dNh(Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.mwd(N,Ka):jc.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.dMh(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.eMh(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.Y8i(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(N.DdaMethod.ControlId,N),this.we.Yu(Ka)):
jc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?z.EwaSettings.ma(23)?this.we.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ka):this.Azi(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?z.EwaSettings.ma(23)?this.we.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ka):this.wzi(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(N,Ka):jc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(N,Ka):this.we.sf(Te.a.uBd,Ka),z.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&jc.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod){N=this.oe.BY(N.DdaMethod.ControlId);Ka="";if(N){Ka=yg.DdaFacade.getSolutionId(N,this.$);let Kc=N.PrimaryMarketplace.MarketplaceType;Kc===OSF.StoreType.InMemory?N.OwnerAddinSolutionId&&N.AssetMarketplace&&(Kc=N.AssetMarketplace.MarketplaceType):Kc===OSF.StoreType.WopiCatalog&&(Kc=OSF.StoreType.OMEX);
Ka=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ka,Kc,null===(Cb=N.AssetMarketplace)||void 0===Cb?void 0:Cb.SolutionId,null,null,N.PrimaryMarketplace.MarketplaceRef)}n.ULS.sendTraceTag(537163224,344,50,`DDA method Id: ${jc.DispatchId}, AppID: ${Ka}`)}}else this.we.sf(Te.a.OHe,Ka)}THh(N,Ka){N.DdaGetBindingData.CoerceType=tf.I1b(N.DdaGetBindingData.CoerceType);N.DdaGetBindingData.FilterType=tf.xRe(N.DdaGetBindingData.FilterType);N.DdaGetBindingData.ValueFormat=tf.Xeg(N.DdaGetBindingData.ValueFormat);
if(this.ihc(N.DdaGetBindingData.CoerceType,Ka)){if(N.DdaGetBindingData){const Cb=N.DdaGetBindingData;0===Cb.FilterType&&(Cb.FilterType=2);Cb.StartCol|=0;Cb.StartRow|=0;Cb.ColCount=void 0===Cb.ColCount?-1:Cb.ColCount;Cb.RowCount=void 0===Cb.RowCount?-1:Cb.RowCount}this.fA.ddaGetBindingData(N.DdaMethod.ControlId,N.DdaGetBindingData.BindingId,N.DdaGetBindingData.CoerceType,N.DdaGetBindingData.ValueFormat,N.DdaGetBindingData.FilterType,N.DdaGetBindingData.StartRow,N.DdaGetBindingData.StartCol,N.DdaGetBindingData.RowCount,
N.DdaGetBindingData.ColCount,Cb=>{if(hf.a(Cb)||!Cb.Result)this.we.oH(Cb,Ka);else{const jc=this.we.GP();jc.Data=tf.tte(Cb.Result);Ka(jc)}},Ka)}}hoj(N,Ka){N.DdaSetBindingData.CoerceType=tf.I1b(N.DdaSetBindingData.CoerceType);if(this.ihc(N.DdaSetBindingData.CoerceType,Ka)){var Cb=tf.yXc(N.DdaSetBindingData.CoerceType,N.DdaSetBindingData.Data);tf.mec(Cb)?this.we.sf(Te.a.bAc,Ka):(1===Cb.CoerceType&&(Cb.CellFormat||(Cb.CellFormat=N.DdaSetBindingData.CellFormat),Cb.TableOptions||(Cb.TableOptions=N.DdaSetBindingData.TableOptions)),
N.DdaSetBindingData&&(N.DdaSetBindingData.StartCol|=0,N.DdaSetBindingData.StartRow|=0),this.fA.ddaSetBindingData(N.DdaMethod.ControlId,N.DdaSetBindingData.BindingId,N.DdaSetBindingData.StartRow,N.DdaSetBindingData.StartCol,Cb,jc=>{hf.a(jc)?this.we.oH(jc,Ka):this.we.Yu(Ka)},Ka))}}NVh(N,Ka){N.DdaGetBindingData.CoerceType=tf.I1b(N.DdaGetBindingData.CoerceType);N.DdaGetBindingData.ValueFormat=tf.Xeg(N.DdaGetBindingData.ValueFormat);N.DdaGetBindingData.FilterType=tf.xRe(N.DdaGetBindingData.FilterType);
if(this.ihc(N.DdaGetBindingData.CoerceType,Ka)){var Cb=this.vcd(N.DdaMethod.ControlId);Cb?this.fA.ddaGetSelectedData(N.DdaMethod.ControlId,N.DdaGetBindingData.CoerceType,N.DdaGetBindingData.ValueFormat,N.DdaGetBindingData.FilterType,Cb,jc=>{if(hf.a(jc))this.we.oH(jc,Ka);else{const Kc=this.we.GP();Kc.Data=tf.tte(jc.Result);Ka(Kc)}},Ka):this.we.sf(Te.a.g1e,Ka)}}dMh(N,Ka){const Cb=N[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],jc=N[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],
Kc=N.DdaMethod.ControlId,kd=ug.getInstance(this.$);if(0>=jc)n.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.we.sf(Te.a.nci,Ka);else if(jc>ug.cyi)n.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.we.sf(Te.a.dXe,Ka);else{var qd=null;switch(Cb){case 1:qd="Compressed";break;case 0:qd="Text";break;case 2:qd="Pdf";break;default:n.ULS.sendTraceTag(537163219,344,15,`Requested file type ${Cb} is not supported.`);
this.we.sf(Te.a.lRe,Ka);return}if("Text"===qd)n.ULS.sendTraceTag(537163218,344,15,`Requested file type ${qd} is not supported.`),this.we.sf(Te.a.lRe,Ka);else{z.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(N=new Sys.StringBuilder,N.append(eg.a(this.$,qd)),"Pdf"===qd&&zg.a.Zg(N,Pe.a.aFd,"WholeWorkbook"),N=N.toString()):N=eg.a(this.$,qd);var yd=null,Jd=new XMLHttpRequest;Jd.onreadystatechange=()=>{if(4===Jd.readyState)if(200===Jd.status){var Vd=Jd.response;
if(Vd){yd=new Uint8Array(Vd);Vd=this.we.GP();var Oe=yd.length,Qe=ug.tCi(),lf={},qg=0;for(let ag=0;ag<Oe;ag+=jc){const bg=[],Rf=ag+jc<Oe?ag+jc:Oe;for(let rg=0,Ng=ag;Ng<Rf;rg++,Ng++)bg[rg]=yd[Ng];lf[(qg++).toString()]=bg}lf=new si(Qe,Oe,jc,lf);lf=kd.sAg(Kc,lf);lf!==Te.a.success?this.we.sf(lf,Ka):(Vd[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Qe,Vd[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Oe,n.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${qd}, the file size is ${Oe}`),
Ka(Vd))}else n.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${qd}.`),this.we.sf(Te.a.internalError,Ka)}else 500===Jd.status?this.we.sf(Te.a.STe(parseInt(Jd.statusText,10)),Ka):(n.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${qd}.`),this.we.sf(Te.a.aCi,Ka))};Jd.open("GET",N,!0);Jd.responseType="arraybuffer";Jd.setRequestHeader("If-Modified-Since","0");Jd.send(null)}}}eMh(N,Ka){var Cb=N[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],
jc=N[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];N=N.DdaMethod.ControlId;(Cb=ug.getInstance(this.$).gMh(N,Cb))?(Cb=Cb.ZBj,0>jc||jc>=Object.keys(Cb).length?this.we.sf(Te.a.U7h,Ka):(jc=Cb[jc.toString()],Cb=this.we.GP(),Cb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=jc,Cb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=jc.length,Ka(Cb))):this.we.sf(Te.a.internalError,Ka)}Y8i(N,Ka){var Cb=N[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];N=
N.DdaMethod.ControlId;Cb=ug.getInstance(this.$).X8i(N,Cb);Cb===Te.a.success?this.we.Yu(Ka):this.we.sf(Cb,Ka)}vsj(N,Ka){N.DdaSetBindingData.CoerceType=tf.I1b(N.DdaSetBindingData.CoerceType);if(this.ihc(N.DdaSetBindingData.CoerceType,Ka)){var Cb=this.vcd(N.DdaMethod.ControlId);if(Cb){var jc=tf.yXc(N.DdaSetBindingData.CoerceType,N.DdaSetBindingData.Data),Kc=Eg.g(this.$).ha;1===jc.CoerceType&&(!jc.Data&&Kc.sa.C4&&(jc.Headers||(jc.Headers=[]),jc.Headers.length||jc.Headers.push([]),jc.Headers[0].length||
jc.Headers[0].push("")),tf.mec(jc)||(jc.CellFormat||(jc.CellFormat=N.DdaSetBindingData.CellFormat),jc.TableOptions||(jc.TableOptions=N.DdaSetBindingData.TableOptions)));if(tf.mec(jc))this.we.sf(Te.a.bAc,Ka);else{var kd=Kc.sa.Wc.clone(),qd=Kc.sa.activeCell.clone();this.fA.ddaSetSelectedData(N.DdaMethod.ControlId,Cb,jc,yd=>{var Jd;if(hf.a(yd))this.we.oH(yd,Ka);else{yd=kd.clone();const Vd=jc.Headers?jc.Headers[0].length:jc.Data[0].length;1!==jc.CoerceType||jc.Data?1===jc.CoerceType&&(null===(Jd=jc.TableOptions)||
void 0===Jd?0:Jd.length)&&0==jc.TableOptions[0]?(yd.top+=1,yd.bottom=yd.top+jc.Data.length-1):yd.bottom=yd.top+jc.Data.length-(1===jc.CoerceType?0:1):yd.bottom=yd.top+1;yd.right=yd.left+Vd-1;Jd=yd.contains(qd)?qd:yd.topLeft;Kc.updateSelection(yd,Jd,0);this.we.Yu(Ka)}},Ka)}}else this.we.sf(Te.a.Ove,Ka)}}addBinding(N,Ka,Cb,jc){Ka?this.fA.ddaAddBinding(N.DdaMethod.ControlId,N.DdaBindingsMethod.BindingId,N.DdaBindingsMethod.BindingType,Ka,Cb,Kc=>{if(hf.a(Kc))this.we.oH(Kc,jc);else{const kd=this.we.GP();
kd.Bindings=Array(1);kd.Bindings[0]=this.oe.s_b(Kc.Result);jc(kd)}},jc):this.we.sf(Te.a.vlj,jc)}SHh(N,Ka){this.fA.ddaGetBinding(N.DdaMethod.ControlId,N.DdaBindingsMethod.BindingId,Cb=>{if(hf.a(Cb)||!Cb.Result)this.we.oH(Cb,Ka);else{const jc=this.we.GP();jc.Bindings=Array(1);jc.Bindings[0]=this.oe.s_b(Cb.Result);Ka(jc)}},Ka)}dNh(N){const Ka=this.we.GP(),Cb={};Cb[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;Ka[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=
Cb;N(Ka)}W8i(N,Ka){this.fA.ddaReleaseBinding(N.DdaMethod.ControlId,N.DdaBindingsMethod.BindingId,Cb=>{hf.a(Cb)?this.we.oH(Cb,Ka):this.we.Yu(Ka)},Ka)}PGh(N,Ka){this.fA.ddaGetAllBindings(N.DdaMethod.ControlId,Cb=>{if(hf.a(Cb))this.we.oH(Cb,Ka);else{const jc=this.we.GP();if(Cb.Result){Cb=Cb.Result;jc.Bindings=Array(Cb.length);for(let Kc=0;Kc<Cb.length;Kc++)jc.Bindings[Kc]=this.oe.s_b(Cb[Kc])}else jc.Bindings=null;Ka(jc)}},Ka)}Asd(N,Ka){this.fA.ddaLoadSettings(N.DdaMethod.ControlId,Cb=>{if(hf.a(Cb))this.we.oH(Cb,
Ka);else{const jc=this.we.GP();jc.Properties=Cb.Result;Ka(jc)}},Ka)}saveSettings(N,Ka){const Cb={Settings:[]};for(let jc=0;jc<N.DdaSettingsMethod.Properties.length;jc++){const Kc={};Kc.Name=N.DdaSettingsMethod.Properties[jc][0];Kc.Value=N.DdaSettingsMethod.Properties[jc][1];Cb.Settings[jc]=Kc}this.fA.ddaSaveSettings(N.DdaMethod.ControlId,Cb,N.DdaSettingsMethod.OverwriteIfStale,jc=>{hf.a(jc)?this.we.oH(jc,Ka):this.we.Yu(Ka)},Ka)}ble(N,Ka){const Cb=tf.yXc(1,N.DdaAddRowsColumns.Data);tf.mec(Cb)?this.we.sf(Te.a.bAc,
Ka):this.fA.ddaAddRowsColumns(N.DdaMethod.ControlId,N.DdaAddRowsColumns.BindingId,N.DdaAddRowsColumns.IsRow,Cb,jc=>{hf.a(jc)?this.we.oH(jc,Ka):this.we.Yu(Ka)},Ka)}zch(N,Ka){this.fA.ddaDeleteAllDataValues(N.DdaMethod.ControlId,N.DdaBindingsMethod.BindingId,Cb=>{hf.a(Cb)?this.we.oH(Cb,Ka):this.we.Yu(Ka)},Ka)}iXg(N,Ka){this.fA.ddaClearBindingFormats(N.DdaMethod.ControlId,N.DdaClearBindingFormats.BindingId,Cb=>{hf.a(Cb)?this.we.oH(Cb,Ka):this.we.Yu(Ka)},Ka)}TXf(N,Ka){const Cb={},jc=N.DdaSetBindingFormats.IsSetFormats;
jc?Cb.CellFormat=N.DdaSetBindingFormats.CellFormat:Cb.TableOptions=N.DdaSetBindingFormats.TableOptions;this.fA.ddaSetBindingFormats(N.DdaMethod.ControlId,N.DdaSetBindingFormats.BindingId,Cb,jc,Kc=>{hf.a(Kc)?this.we.oH(Kc,Ka):this.we.Yu(Ka)},Ka)}executeRichApiRequest(N,Ka){var Cb;const jc=N.ArrayData,Kc={},kd=Eg.g(this.$).ha;if(jc){if("WacPartition"===jc[0]){this.fwh(N,Ka);return}const Qe=Object(L.a)(yg.DdaFacade,cf.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===jc[0]){var qd=Qe.fn(N.DdaMethod.ControlId);
qd&&(qd.agc=!0,qd.SIf())}Kc.HttpMethod=jc[1];Kc.PathAndQuery=jc[2];Kc.RequestHeaders=tf.zYe(jc[3]);Kc.RequestBody=jc[4];Kc.AppPermission=jc[5];qd=jc[6];Kc.RequestFlags=qd;var yd=0;if(Wg.i(this.$.pa))switch(kd.Je){case 1:yd=2;break;case 2:yd=3;break;case 128:yd=4;break;default:yd=1}var Jd=null;kd.Pa.SA&&(Jd=kd.Pa.SA.ej);Kc.SheetMultiRange=vh.r(kd.sa.selectedRanges,this.$);Kc.ActiveCell=vh.v(kd.sa.activeCell,this.$);Kc.ActiveChartId=Jd;Kc.SelectionState=yd;yd=this.oe.BY(N.DdaMethod.ControlId);Kc.InstanceId=
yd?yd.InstanceId:"";if(yd&&yd.PrimaryMarketplace){Jd=yg.DdaFacade.getSolutionId(yd,this.$);let lf=yd.PrimaryMarketplace.MarketplaceType;if(lf===OSF.StoreType.InMemory){if(!yd.OwnerAddinSolutionId){this.we.sf(Te.a.Ixb,Ka);return}if(yd.AssetMarketplace)lf=yd.AssetMarketplace.MarketplaceType;else{this.we.sf(Te.a.Ixb,Ka);return}}else lf===OSF.StoreType.WopiCatalog&&(lf=OSF.StoreType.OMEX);let qg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Jd,lf,null===(Cb=yd.AssetMarketplace)||void 0===Cb?void 0:Cb.SolutionId,
null,null,yd.PrimaryMarketplace.MarketplaceRef);Kc.CompliantSolutionId=qg;Kc.SolutionId=Jd;Kc.MarketplaceType=lf;Kc.SolutionVersion=yd.PrimaryMarketplace.SolutionVersion;Kc.StoreLocation=yd.PrimaryMarketplace.MarketplaceRef}else Kc.SolutionId=Kc.MarketplaceType="",Kc.CompliantSolutionId="";Kc.IsEventsEnabled=void 0===Qe||null===Qe||Qe.$i.CZb(Kc.InstanceId);Kc.RequestGuid=Wh.a.create().toString();Cb=Kc.RequestBody.length;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&
Cb>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.we.sf(Te.a.Oej,Ka);n.ULS.sendTraceTag(537163213,0,50,`Request payload size:${Cb} exceeded the limit`);return}z.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&qd&4096&&(Cb=new Ye(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Cb,Me,jc),Kc.RequestBody=jc[4])}const Vd=tf.K0e(Kc.RequestHeaders);tf.mCd++;const Oe=hj.a.Wa.Nb;z.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&
Kc&&Kc.RequestBody&&n.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${Kc.RequestBody.length}`);this.fA.executeRichApiRequest(Kc,Qe=>{var lf;this.bXf(Oe,!0,Qe.ServerCorrelationId);var qg=null;let ag=null;var bg=Qe.ServerCorrelationId;if(null===(lf=null===Qe||void 0===Qe?void 0:Qe.Errors)||void 0===lf?0:lf[0])qg=Qe.Errors[0].MessageIdName,ag=Qe.Errors[0].Description,z.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&rj.a(this.$).jd.XL(Qe.Errors[0].MessageId);
if(hf.a(Qe)||!Qe.Result)this.gNa(bg,Vd,"Server error",qg,ag),this.we.oH(Qe,Ka);else{let rg=null;if(z.EwaSettings.ma(258))if((lf=Qe.Result)&&lf.length){for(let Og=0;Og<lf.length;Og++)if(lf[Og].RequestGuid===Kc.RequestGuid){rg=lf[Og];break}rg||this.we.oH(Qe,Ka)}else rg=Qe.Result;else rg=Qe.Result;if(!qg&&rg&&rg.ResponseBody&&rg.ResponseBody[0])if(Qe=rg.ResponseBody[0],Qe.startsWith('{"Error":')){1<rg.ResponseBody.length&&(Qe=Qe.substring(0,Qe.indexOf("}")+1),Qe+="}");try{var Rf=w.a.Vh(Qe);Rf.Error&&
this.gNa(bg,Vd,"Pipeline error",Rf.Error.Code,Rf.Error.Message)}catch(Og){this.gNa(bg,Vd,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.gNa(bg,Vd);else this.gNa(bg,Vd,"Server error",qg,ag);const Ng=(Rf=rg.SheetMultiRange)?Rf.SheetName:null;Qe=rg.ActiveChartId;const Lg=rg.SelectionState;qg=5===Lg&&!!Rf||6===Lg||7===Lg||8===Lg;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&this.$.rb.Zx&&qg)this.we.sf(Te.a.oCc,Ka),n.ULS.sendTraceTag(537163211,
0,50,`${Lg.toString()} is not allowed`);else if(5===Lg&&Rf){if(this.$.xa&&Ng)if(this.$.xa.Ek(Ng))this.ASc(Ng);else{let Og=null;Og=()=>{this.$.xa.Ek(Ng)&&(n.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.ASc(Ng),this.$.xa.LHb(Og))};this.$.xa.Fmb(Og);if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let Dh=null;Dh=()=>{this.$.xa.Ek(Ng)&&(this.ASc(Ng),this.$.xa.pma(Dh))};this.$.xa.lga(Dh)}}}else if(6===Lg||7===Lg||8===
Lg||9===Lg){if(Rf){const Og=vh.g(Rf.Ranges);if(Ng&&vh.cb(Og,!0))if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!this.$.xa.Ek(Ng)){let Dh=null;Dh=()=>{this.sdg(kd,Og,Ng,Lg);this.$.xa.pma(Dh)};this.$.xa.lga(Dh)}else this.sdg(kd,Og,Ng,Lg)}7===Lg?(Qe="38.{"+sj.e(Qe)+"}",pg.a(this.$).Ima(0,Qe,!0)):8===Lg&&pg.a(this.$).Ima(2,Qe,!0);9===Lg&&(this.$.ya.ApiCallToSetPageLayout=!0)}rg.PostProcessActions?this.$.Xef?(bg=w.a.Vh(rg.PostProcessActions),this.gZi(bg).then(()=>
{this.Ybb(rg,Ka);this.C$c(N.DdaMethod.ControlId,Kc);return Promise.resolve(null)},Og=>{this.Ybb(rg,Ka,Og);return Promise.reject(Og)})):(this.gNa(bg,Vd,"Promise not supported",null,"Promise is not supported on this browser."),this.we.sf(Te.a.internalError,Ka)):this.Ybb(rg,Ka)}},Qe=>{this.bXf(Oe,!1,null);this.gNa(null,Vd,"Web service error");Ka(Qe)})}C$c(N,Ka){const Cb=Object(L.a)(yg.DdaFacade,cf.a(this.$));(null===Cb||void 0===Cb?0:Cb.bLd)&&Cb.fn(N)&&tf.kwj(Ka.RequestHeaders)&&(n.ULS.sendTraceTag(537163209,
0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${N}; SolutionId: ${Ka.SolutionId}.`),Cb.bLd.Qkh(N))}fwh(N,Ka){var Cb=this.oe.BY(N.DdaMethod.ControlId);const jc=yg.DdaFacade.getSolutionId(Cb,this.$);var Kc=null;Kc=yg.DdaFacade.tua(Cb,this.$);Kc=new tg(Kc,this.$);Kc=new gj(jc,N.DdaMethod.ControlId,this.oe,this.$,Kc);const kd={ResponseHeaders:[]};kd.ResponseBody=Array(1);Cb=tf.zYe(N.ArrayData[3]);const qd=tf.K0e(Cb);Cb=new ee(this.$.ya.CreateWorkbookMaxAllowedBase64Size,
this.$qf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Kc,rd,Cb,N.ArrayData).then(yd=>{if(!yd)return this.otd(!1,"The rich api executor call failed",qd),n.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),kd.ResponseStatusCode=500,this.Ybb(kd,Ka),null;this.otd(!0,"The rich api executor call succeeded",qd);kd.ResponseStatusCode=yd[0];kd.ResponseBody[0]=yd[2];this.Ybb(kd,Ka);return null},yd=>{kd.ResponseStatusCode=400;kd.ResponseBody[0]=yd.toString();this.otd(!1,"The rich api executor call failed",
qd);n.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${jc}`);this.Ybb(kd,Ka);return null})}bXf(N,Ka,Cb){tf.mCd--;N=lj.a(hj.a.Wa,N);n.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${N}, requests pending:${tf.mCd}, request result:${Ka?"success":"false"}, server correlationid: ${Cb}.`)}Ybb(N,Ka,Cb=null){const jc=Array(3);jc[0]=N.ResponseStatusCode;jc[1]=tf.gXh(N.ResponseHeaders);const Kc=[];var kd=!1;if(Cb&&N.ResponseBody){const qd=
w.a.Vh(N.ResponseBody.join(""));qd.Error||(kd={},kd.Error=Cb,kd.TraceIds=qd.TraceIds,kd.ProcessedResults={},kd.ProcessedResults.Results=qd.Results,Kc[0]=w.a.Ac(kd),kd=!0)}jc[2]=kd?Kc:N.ResponseBody;N=this.we.GP();N.Data=jc;Ka(N)}mwd(N,Ka){(new jg(this.$,this.we,this.fA)).mwd(N,Ka)}Azi(N,Ka){n.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");const Cb=N[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],jc=N[Rd.a.yUc],Kc=N[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];N=this.$.da.za(232).U0a.Bzi(N.DdaMethod.ControlId,
Cb,jc,Kc);N===Te.a.success?this.we.Yu(Ka):(n.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.we.sf(N,Ka))}wzi(N,Ka){n.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const Cb=N[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],jc=N[Rd.a.yUc],Kc=N[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.za(232).U0a.tmj(N.DdaMethod.ControlId,Cb,jc,Kc);this.we.Yu(Ka)}getAccessToken(N,Ka){n.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");const Cb=(Kc,kd)=>
{var qd;if(Kc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Kc=this.we.GP(),Kc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=kd.accessToken,Ka(Kc);else{kd=this.oe.BY(N.DdaMethod.ControlId);let yd=null!==kd.OwnerAddinStoreType?kd.OwnerAddinStoreType:kd.PrimaryMarketplace.MarketplaceType;n.ULS.sendTraceTag(537163202,0,10,`${({["errorCode"]:Kc.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(yg.DdaFacade.getSolutionId(kd,this.$),yd,null===(qd=kd.AssetMarketplace)||
void 0===qd?void 0:qd.SolutionId,null,null,kd.PrimaryMarketplace.MarketplaceRef),["storeType"]:yd})}.`);this.we.sf(Kc,Ka)}},jc=!z.EwaSettings.ma(23);ef.TaskExtensions.Aa(og.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),Kc=>{const kd=this.oe.Sh,qd=Hc.getInstance();Ph.AppsForOfficeSingleSignOnManager.getInstance(kd,Kc.result,qd).getAccessToken(N.DdaMethod.ControlId,jc,N,Cb)},this.$.la)}getAuthContext(N,Ka){ef.TaskExtensions.Aa(og.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),()=>
{var Cb=this.oe.Sh.getOsfControl(N.DdaMethod.ControlId);if(Cb.isFirstParty()){Cb=Cb.getManifest();var jc=Cb.getMarketplaceID(),Kc=Cb.getWebApplicationId(),kd=Cb.getWebApplicationMsaId();Cd.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(jc).then(qd=>{const yd=this.we.GP(),Jd={};Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Kc;Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=kd||Kc;Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=
qd.upn;Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=qd.userId;Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=qd.authority;Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=rc.a.BHh(qd.authorityType);Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=qd.isAnonymous;Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=qd.tenantId;Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=qd.supportsAuthToken;
yd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Jd;Ka(yd)},qd=>{const yd=this.we.GP(),Jd={},Vd=new rc.a;Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Kc;Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=kd||Kc;Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Vd.upn;Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Vd.userId;Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Vd.authority;Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=
Vd.authorityType;Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Vd.isAnonymous;Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Vd.tenantId;Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=qd;Jd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Vd.supportsAuthToken;yd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Jd;yd.Error=1;Ka(yd)})}},this.$.la)}vfi(N){const Ka=Eg.g(this.$).ha;return 16===Ka.Je&&!!Ka.Pa.$b&&
!!Ka.Pa.$b.floatingObject&&eh.a.equals(Ka.Pa.$b.floatingObject.id,N,!0)}vcd(N){const Ka=Eg.g(this.$).ha;return Ka.sa.wg?1===Ka.Je||this.vfi(N)?Ka.Dha:null:null}ihc(N,Ka){return 1!==N&&2!==N&&3!==N?(this.we.sf(Te.a.Xye,Ka),!1):!0}otd(N,Ka,Cb){const jc={};jc.a=this.$.ya.UserSessionId;jc.b=N;jc.c=Ka;jc.d=null;jc.e=Cb;Ci.b().Le(37,jc)}gNa(N,Ka,Cb=null,jc=null,Kc=null){const kd={};N&&(kd.ServerCorrelationId=N);void 0!==Ka&&null!==Ka&&(kd.Source=Ka);Cb&&(kd.ErrorType=Cb);jc&&(kd.MessageId=jc);Kc&&(kd.StatusDescription=
Kc);z.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&jc&&"ExternalDataRefreshFailed"===jc&&(kd.StatusDescription="");n.ULS.sendTraceTag(50688452,0,50,w.a.Ac(kd))}gZi(N){let Ka=new Promise(Cb=>{Cb(null)});for(let Cb=0;Cb<N.length;Cb++)Ka=this.fZi(Ka,N[Cb]);return Ka}fZi(N,Ka){if(!Ka)return n.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),N.then(()=>Promise.reject(tf.P2a(oh.generalException,ud.a.instance.ga(1762),null)));switch(Ka.actionType){case 1:case 2:N=N.then(()=>
{const Cb=Object(L.a)(yg.DdaFacade,cf.a(this.$));if(Cb.fn(Ka.controlId))switch(Cb.$i.q1h(Ka),Ka.messageType){case 14:case 100:Cb.aLd.ZZb(Ka);break;case 11:case 12:Cb.Chj.Pnb(Ka);break;case 51:case 52:Cb.Ahj.Pnb(Ka);break;case 2101:case 2102:Cb.Bhj.Pnb(Ka);break;case 2E3:Cb.Dhj.ZZb(Ka);break;case 2201:this.$.gka&&Cb.bLd.HLg(Ka);break;case 2203:Cb.Ehj.ILg(Ka);break;case 2700:z.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&Cb.$Kd.ZZb(Ka)}else n.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${Ka.controlId}] doesn't exist.`);
return Promise.resolve(null)});break;case 3:N=N.then(()=>{this.c1h(Ka);return Promise.resolve(null)});break;case 15:z.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(N=N.then(()=>{this.I2h(Ka);return Promise.resolve(null)}));break;case 4:N=N.then(()=>{if(z.EwaSettings.ma(104)){var Cb=Eg.g(this.$).ha.sa.activeCell;Cb.top!==Ka.row+1&&Cb.left!==Ka.column+1&&(Cb=vh.v(ig.Range.Uc(Ka.row+1,Ka.column+1),this.$),Eg.g(this.$).Dg(Cb,null,null,null,3,Of.a.jbh));gi.a(this.$,243,242,0,jc=>{jc.Zcb(Ka.row+
1,Ka.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:N=N.then(()=>{Object(L.a)(yg.DdaFacade,cf.a(this.$)).$i.MJe(Ka.controlId,Ka.isEnableEvents);return Promise.resolve(null)});break;case 5:N=N.then(()=>this.E$g(Ka));break;case 6:N=N.then(()=>this.qUi(Ka));break;case 8:N=N.then(()=>{z.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(L.a)(yg.DdaFacade,cf.a(this.$)).hXg();const Cb=new pj.a(qj.a.Jj,5,null);oj.a(this.$).ls(Cb);
return Promise.resolve(null)});break;case 9:N=N.then(()=>this.loj(Ka));break;case 10:N=N.then(()=>this.wXj(Ka));break;case 11:N=N.then(()=>this.vXj());break;case 12:N=N.then(()=>this.sXj());break;case 13:N=N.then(()=>this.tXj(Ka));break;case 14:N=N.then(()=>this.uXj(Ka));break;case 16:N=N.then(()=>Promise.resolve(Ka));break;case 17:N=N.then(()=>this.ukj(Ka,Object(L.a)(yg.DdaFacade,cf.a(this.$))));break;case 18:Eg.g(this.$).focus();break;case 19:this.W3e(Ka.entryType,!1,Ka.options);break;case 20:this.W3e(Ka.entryType,
!0,Ka.options);break;default:N=N.then(()=>Promise.reject(tf.P2a(oh.eJg,ud.a.instance.ga(1763),null)))}return N}I2h(N){var Ka=Object(L.a)(yg.DdaFacade,cf.a(this.$)).fn(N.controlId);if(Ka&&!(0===N.operationType^!Ka.$ca)){Eg.g(this.$).Hgc=!0;switch(N.operationType){case 0:var Cb=new nj.a(document.createElement("input"));Cb.text=N.range;Ka.bai(Eg.g(this.$).Df.$8g(Cb,new kj.a(this.$)));Ka.$ca.startEdit(!0);break;case 1:Ka.SOf();this.rangePicker=null;break;case 2:Ka.$ca.Hdg(N.range);break;case 3:Ka.$ca.Hdg(N.startingRange);
Ka=N.expandSelection;Cb=N.getNextDataRegionCell;let jc=0;switch(N.keyboardDirectionValue){case 2:jc=38;N=Ka&&Cb?105288353:Ka?-31900117:Cb?542791952:137938150;break;case 3:jc=40;N=Ka&&Cb?-1297307319:Ka?-1603798598:Cb?1713663844:-798660877;break;case 0:jc=37;N=Ka&&Cb?-403586027:Ka?2039316657:Cb?-2012742350:-1470715894;break;case 1:jc=39;N=Ka&&Cb?784916030:Ka?589730764:Cb?1324884057:-1231471547;break;default:N=1461300262}Ka=this.q3b("keydown",jc,Ka,Cb);Eg.g(this.$).LIb(Ka,new Cg.a(N,1,0,8,null))}Eg.g(this.$).Hgc=
!1}}q3b(N,Ka,Cb,jc){const Kc=document.createEvent("KeyboardEvent");if(Rc.a.wF)Kc.initKeyboardEvent(N,!1,!1,window.self,"A",0,jc,!1,Cb,!1);else{let kd="";Cb&&(kd+="Shift");jc&&(kd+=0<kd.length?" Control":"Control");Kc.initKeyboardEvent(N,!1,!1,window.self,"A",0,kd,!1,"en-US")}N=new Sys.UI.DomEvent(Kc);N.keyCode=Ka;return N}c1h(N){switch(N.operationType){case 1:ef.TaskExtensions.Aa(og.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1),Ka=>{Ka.result.ZJd()},this.$.la,3);break;case 2:if(N=Object(L.a)(yg.DdaFacade,
cf.a(this.$)).fn(N.controlId))N.agc=!0,N.SIf()}}E$g(N){const Ka=N.fileBase64;return Ka&&Ka.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(tf.P2a(oh.invalidArgument,ud.a.instance.ga(1766),"Application.CreateWorkbook")):(new Promise((Cb,jc)=>{const Kc=new Wc.StandardDialog;Kc.Rb=4;Kc.wl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,kd=>{2!==kd&&0!==kd||jc(tf.P2a(oh.qBd,ud.a.instance.ga(1765),"Application.CreateWorkbook"));kd=new $c("blank",
"agave",Ka?"streamBase64":"streamEmpty",Ka);this.$qf.create(Cb,jc,kd).h0a()})})).then(Cb=>{this.X7b.set(N.fakeFileId,Cb);return Promise.resolve(null)},Cb=>Cb?Promise.reject(Cb):Promise.reject(tf.P2a(oh.generalException,ud.a.instance.ga(1762),"Application.CreateWorkbook")))}qUi(N){return new Promise((Ka,Cb)=>{if(this.X7b.has(N.fakeFileId)){const jc=this.X7b.get(N.fakeFileId);Cb=new Wc.StandardDialog;Cb.Rb=4;Cb.wl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,
1,Kc=>{1===Kc&&Eh.HelperMethods.Ve(jc,void 0,void 0,"DdaMethodHandler.fileUrl");Ka(null)})}else Cb(tf.P2a(oh.generalException,ud.a.instance.ga(1762),"Document.Open"))})}loj(N){return new Promise(Ka=>{Object(L.a)(yg.DdaFacade,cf.a(this.$)).FTf=N.runtimeCalculationMode;const Cb=this.$.da.za(268);Cb&&Cb.mxd(3===N.runtimeCalculationMode);Ka(null)})}wXj(N){Kf.a.Yzb(this.$)&&this.$.da.za(331).Zbb(0,N.urlStr,!0,!0,null);return Promise.resolve(null)}vXj(){Kf.a.Yzb(this.$)&&this.$.da.za(331).Zbb(1,null,!0,
!0,null);return Promise.resolve(null)}sXj(){Kf.a.Yzb(this.$)&&this.$.da.za(331).JJe();return Promise.resolve(null)}tXj(N){Kf.a.Yzb(this.$)&&this.$.da.za(331).Zbb(5,N.urlStr,!0,!0,null);return Promise.resolve(null)}uXj(N){if(Kf.a.Yzb(this.$)){const Ka=this.$.da.za(331);for(const Cb of Ka.K$)Cb.IsActive&&Cb.HostEditUrl&&Cb.UrlStr===N.hostEditUrlStr&&Eh.HelperMethods.Ve(Cb.HostEditUrl,"_blank")}return Promise.resolve(null)}ukj(N,Ka){const Cb=Hf.a.dW;N=w.a.Vh(N.payload);const jc={};"eventId"in N&&"payload"in
N&&(jc.eventId=N.eventId,jc.payload=N.payload);Ka.AM(2201,Cb,w.a.Ac(jc));return Promise.resolve(null)}W3e(N,Ka,Cb){const jc=this.$.da.za(5);jc&&(N=this.vIh(N))&&(Ka?jc.removeEntry(N):jc.Oke(N,Cb))}vIh(N){switch(N){case 0:return 65}}ASc(N){N=Object(L.a)(mj.a,this.$.xa.getItemByName(N));(null===N||void 0===N?0:N.visible)&&N.activate(!0)}sdg(N,Ka,Cb,jc){var Kc=N.sa.Xr;const kd=Kc<Ka.length&&Ka[Kc].contains(N.sa.activeCell);N=kd?N.sa.activeCell:Ka[0].topLeft;Kc=kd?Kc:0;Eg.g(this.$).WY(Ka,Kc,Cb,null,N,
null,null,3,Of.a.kbh,void 0,void 0,void 0,6===jc)}static get fbh(){tf.epa||(tf.epa={},tf.epa[Microsoft.Office.WebExtension.CoercionType.Table]=1,tf.epa[Microsoft.Office.WebExtension.CoercionType.Text]=2,tf.epa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,tf.epa[Microsoft.Office.WebExtension.CoercionType.Html]=4,tf.epa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return tf.epa}static get ibh(){tf.Tgb||(tf.Tgb={},tf.Tgb[Microsoft.Office.WebExtension.FilterType.All]=1,tf.Tgb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=
2);return tf.Tgb}static get mbh(){tf.Ugb||(tf.Ugb={},tf.Ugb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,tf.Ugb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return tf.Ugb}static zYe(N){if(!N||!N.length)return null;const Ka=Array(N.length/2);for(let Cb=0;Cb<N.length/2;Cb++)Ka[Cb]={},Ka[Cb].Name=N[2*Cb],Ka[Cb].Value=N[2*Cb+1];return Ka}static gXh(N){if(!N||!N.length)return null;const Ka=Array(2*N.length);for(let Cb=0;Cb<N.length;Cb++)Ka[2*Cb]=N[Cb].Name,Ka[2*Cb+1]=N[Cb].Value;
return Ka}static R$c(N){if(!N||!N.length)return null;const Ka=Array(N.length);for(let Cb=0,jc=N.length;Cb<jc;Cb++){const Kc=N[Cb].length;if(Kc){Ka[Cb]=Array(Kc);for(let kd=0;kd<Kc;kd++)Ka[Cb][kd]=null==N[Cb][kd]?null:N[Cb][kd].toString()}else return null}return Ka}static I1b(N){return"string"===typeof N?$i.a.aq(tf.fbh,N,0):N}static xRe(N){return"string"===typeof N?$i.a.aq(tf.ibh,N,0):N}static Xeg(N){return"string"===typeof N?$i.a.aq(tf.mbh,N,0):N}static Hfi(N){switch(N.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static yXc(N,
Ka){const Cb={};Cb.CoerceType=N;1===Cb.CoerceType?(Cb.Data=tf.R$c(Ka.Rows),Cb.Headers=tf.R$c(Ka.Headers)):Cb.Data=tf.R$c(Ka);return Cb}static tte(N){return 1===N.CoerceType?{["Headers"]:N.Headers,["Rows"]:N.Data}:N.Data}static mec(N){return 1===N.CoerceType?!N.Data&&!N.Headers:!N.Data}static K0e(N){let Ka="Unknown";if(!N)return Ka;for(let Cb=0;Cb<N.length;Cb++)if(N[Cb].Name.toLowerCase()===Pe.a.Fhj){Ka=N[Cb].Value;break}return Ka}static kwj(N){if(!N)return!1;const Ka=Pe.a.rEi.toLowerCase();for(let Cb=
0;Cb<N.length;Cb++)if(N[Cb].Name.toLowerCase()===Ka)return!0;return!1}static P2a(N,Ka,Cb){const jc={};jc.Code=N;jc.Message=Ka;jc.Location=Cb;jc.ActionIndex=0;return jc}}tf.epa=null;tf.Tgb=null;tf.Ugb=null;tf.mCd=0;Object(e.a)(tf,"DdaMethodHandler",null,[195,2]);class aj extends Yd.a{constructor(N){super(N)}yd(){const N=og.GetServiceTaskFactory.create(this.$.da,106,this.la,this.hb),Ka=og.GetServiceTaskFactory.create(this.$.da,165,this.la,this.hb),Cb=lh(this.la,this.hb);ef.TaskExtensions.Aa(ef.TaskExtensions.Wd([N,
Ka,Cb],this.la),()=>{const Kc=N.result,kd=Cd.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");this.gd([new tf(this.$,Kc,kd)])},this.la,3);const jc=Cd.a.instance;ef.TaskExtensions.Aa(og.GetServiceTaskFactory.create(this.$.da,137,this.$.la,this.hb),()=>{jc.register(Oh,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").tc().Fc(()=>new Oh)},this.$.la)}static ka(N){Yd.a.Nd(82,new aj(N))}}Object(e.a)(aj,"DdaCommandHandlerFactory",Yd.a,[]);
Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");c.a.Hi("");c.a.Hi(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Object(b.a)();Type.registerNamespace("Common.App.AppsForOfficeCommon");
Object(d.a)();(()=>{f.a.Fa(N=>{mg.ka(N)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(Qa.a)();Object(xb.a)();Type.registerNamespace("CommandUI.AddInCommands");(()=>{f.a.Fa(N=>{z.EwaSettings.ma(53)&&ai.ka(N)})})();(()=>{f.a.Fa(N=>{z.EwaSettings.ma(121)&&ui.ka(N)})})();f.a.Fa(Th.ka);f.a.Fa(fi.ka);Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");(()=>{f.a.Fa(N=>{Ih.ka(N);
qi.ka(N);Xh.ka(N)})})();f.a.Fa(aj.ka)},1453:function(t,C,a){t=a(0);var c=a(185),b=a(95);class d{constructor(){this.JIe=this.displayName=this.hqb=this.Do=this.sB=null;this.isUpgraded=!1}Fff(e,k){return this.sB.getStoreType().toLowerCase()===e.toLowerCase()&&this.sB.getSolutionId().toLowerCase()===k.toLowerCase()}}Object(t.a)(d,"AddinCommandsResourceItem",null,[]);a.d(C,"a",function(){return f});class f{constructor(){this.jDc=null;this.YHc=0;this.DJc=!1;this.$a=new b.a;this.dqg=new c.a}mDg(e){this.$a.addHandler("AddinCommandsLoadingMessageChanged",
e)}H$i(e){this.$a.removeHandler("AddinCommandsLoadingMessageChanged",e)}get nYa(){return this.jDc}xcb(e){e!==this.jDc&&(this.jDc=e,this.$a.raiseEvent("AddinCommandsLoadingMessageChanged"))}goj(){this.YHc++;this.nYa||this.xcb(CommonUIStrings.l_LoadingAddInsTitle)}ENd(){this.YHc--;this.Dsd()&&(this.DJc?this.nYa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.xcb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.xcb(null))}KYf(e=!1){this.DJc=!0;this.xcb(e?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:
CommonUIStrings.l_ErrorLoadingAddInsTitle)}qxe(){this.DJc=!1;this.Dsd()?this.xcb(null):this.xcb(CommonUIStrings.l_LoadingAddInsTitle)}Dsd(){return 0>=this.YHc}get j5a(){return this.dqg}nia(e,k,l=0){for(let m of this.j5a)if(m.Fff(e,k)&&(!m.Do||m.Do.WFh===l))return m;return null}Hke(e,k,l,m){const v=new d;v.sB=e;v.Do=k;v.hqb=l;v.displayName=m;this.j5a.add(v)}oBg(e,k,l,m){const v=new d;v.sB=e;v.Do=k;v.hqb=null;v.JIe=l;v.displayName=m;this.j5a.add(v)}e9i(e,k){let l=0;for(let m of this.j5a)m.sB.getStoreType()===
e&&m.sB.getSolutionId()===k?this.j5a.removeAt(l):l++}static getInstance(){f.Ma||(f.Ma=new f);return f.Ma}}f.Ma=null;Object(t.a)(f,"AddinCommandsResourceManager",null,[])},729:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);var c=a(35);class b{static get yzi(){return b.bae||(b.bae={["-2002156328"]:b.Xye,["-1954750170"]:b.g1e,["317650254"]:b.YYg,["-1005263101"]:b.gci,["1353664579"]:b.Nlj,["159671765"]:b.hci,["1446690022"]:b.dXe,["1150069548"]:b.bAc,["-1409306331"]:b.Ove,["338507772"]:b.TEe,["-457159301"]:b.eVi,
["-1037701970"]:b.Hah,["-1893322318"]:b.mci,["965579896"]:b.Jah,["93287890"]:b.Iah,["358088857"]:b.Xoj,["-1223650923"]:b.TEe,["2007306190"]:b.$Ug,["1549955423"]:b.Ase,["-1275974171"]:b.lci,["382101082"]:b.tUi,["-898776235"]:b.kBi,["335464256"]:b.$Ai,["1677378049"]:b.kci,["-261992848"]:b.AOj,["-980820954"]:b.Ase,["-931375837"]:b.sUi,["929186550"]:b.rih,["-982144310"]:b.b1i,["-785741187"]:b.eci,["2125217573"]:b.oci,["299124955"]:b.fci,["1669853884"]:b.Uhj,["-1515932330"]:b.ZYg,["314621024"]:b.pCh,["-300049690"]:b.dVg,
["14766835"]:b.Ytj,["-1251992761"]:b.OHe,["-2087635043"]:b.invalidOrTimedOutSession,["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.WEa,["49173765"]:b.WEa,["-907155566"]:b.WEa,["-1201603824"]:b.WEa,["1541165282"]:b.WEa,["-1347753427"]:b.WEa,["134912532"]:b.WEa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static STe(d){return c.a.aq(b.yzi,
d.toString(),b.internalError)}}b.success=0;b.Xye=1E3;b.g1e=1001;b.YYg=1002;b.gci=1003;b.Nlj=1004;b.hci=1005;b.dXe=1008;b.lRe=1009;b.invalidSheetName=1014;b.bAc=2E3;b.Ove=2001;b.TEe=2002;b.eVi=2003;b.Hah=2004;b.mci=2005;b.Jah=2007;b.Iah=2008;b.Xoj=2009;b.$Ug=2014;b.vlj=3E3;b.Ase=3002;b.lci=3004;b.tUi=3005;b.kBi=3006;b.$Ai=3007;b.kci=3008;b.AOj=3009;b.sUi=3010;b.Ytj=4002;b.uBd=5E3;b.internalError=5001;b.OHe=5002;b.Ixb=5004;b.APj=5007;b.U7h=5008;b.invalidOrTimedOutSession=5012;b.oCc=5016;b.WEa=5102;
b.Oej=5103;b.responsePayloadSizeLimitExceeded=5104;b.wUg=7001;b.M4f=7002;b.rih=8E3;b.b1i=8001;b.eci=8010;b.oci=8011;b.fci=8012;b.Uhj=8020;b.ZYg=8021;b.pCh=8022;b.dVg=8023;b.ezi=11E3;b.aCi=11001;b.nci=11002;b.bae=null;Object(t.a)(b,"DdaErrorIds",null,[])},730:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.generalException="GeneralException";c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.bSc="AccessDenied";c.notSupported="NotSupported";c.apiNotAvailable="ApiNotAvailable";
c.notAllowed="NotAllowed";c.qBd="OperationCancelled";c.userNotSignedIn="UserNotSignedIn";c.userAborted="UserAborted";c.DPj="UnsupportedUserIdentity";c.invalidResourceUrl="InvalidResourceUrl";c.invalidGrant="InvalidGrant";c.lHg="AddinIsAlreadyRequestingToken";c.pgj="ResourceNotAllowed";c.clientError="ClientError";c.serverError="ServerError";c.V1g="ControlIdNotFound";c.ehj="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.invalidRibbonDefinition="InvalidRibbonDefinition";c.sharedRuntimeNotAvailable=
"SharedRuntimeNotAvailable";Object(t.a)(c,"ErrorCodes",null,[])},733:function(t,C,a){a.r(C);var c=a(0),b=a(7),d=a(15),f=a(1296),e=a(83),k=a(95);class l{constructor(P,Ta,pb){this._id=P;this.Zjg=Ta;this.jmg=pb;this.Z$e=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get kHg(){return this.Zjg}get CZg(){return this.jmg}execute(P,Ta,pb){pb=pb||{};pb.commandMode=this.Z$e;Ta.invokeAppCommand(this.kHg,this.CZg,pb,()=>{P.SNi(this.id)})}}Object(c.a)(l,"AddinNativeActionBase",null,[206]);class m extends l{constructor(P,
Ta){super(1,P,Ta);this.Z$e=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(c.a)(m,"AddinTakeSnapshotAction",l,[]);class v{x3g(P){return new l(3,P,this.DGh().getNativeActionName(3))}DGh(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(v,"AddinNativeActionManager",null,[173]);var n=a(144);class w{invokeAppCommand(P,Ta,pb,Yb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(P,Ta,pb,Yb)}static getInstance(){w.Ma||(w.Ma=new w);return w.Ma}}w.Ma=null;Object(c.a)(w,
"OSFAddinCommandsRuntimeManager",null,[172]);var r=a(4),u=a(179),y=a(27);class x extends n.a{constructor(P,Ta,pb){super();this.E8=null;this.aRc="WACDialogTitleText";this.zea="0";this.pCa="15px";this.zmg="0px";this.yea="calc(100% - 30px)";this.ymg="100%";this.Cde=0;this.$a=new k.a;this.akg=new v;this.Rb=5;this.ze=this.xCa=pb;this.mGc=P;this.S3d=Ta;this.DGc=!!r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix")}yFg(P){this.$a.addHandler("OnDialogClosedEventKey",
P)}Tqj(){this.FDa=null}Lz(){super.Lz();this.Kk.style.width="100%";this.Kk.style.height=this.gcc?this.yea:this.ymg;this.Kk.style.marginTop=this.gcc?this.pCa:this.zmg;this.Kk.style.padding=this.zea}BI(){super.BI();this.vb.style.width=String.format("{0}px",this.mGc*window.innerWidth/100);this.vb.style.height=String.format("{0}px",this.S3d*window.innerHeight/100);this.vb.style.minWidth="0px";this.DGc&&r.AFrameworkApplication.isRtl&&100===this.mGc&&(this.vb.style.right="0px",this.vb.style.marginRight=
"0px");this.E8=document.getElementById(this.hi(this.aRc));this.E8.style.position="absolute";this.E8.style.whiteSpace="nowrap";this.E8.style.textOverflow="ellipsis";r.AFrameworkApplication.isRtl?(this.E8.style.right="14px",this.E8.style.left="44px"):(this.E8.style.right="44px",this.E8.style.left="14px")}uv(P){super.uv(P);this.E8&&this.E8.setAttribute("title",P)}get kta(){return this.Kk}eKd(){this.vb.style.width=String.format("{0}px",this.mGc*window.innerWidth/100);this.vb.style.height=String.format("{0}px",
this.S3d*window.innerHeight/100);this.vb.style.overflowY="hidden";this.vb.style.overflowX="hidden";this.vb.style.marginTop="";this.vb.style.top="";y.a.k4&&r.AFrameworkApplication.isRtl?(this.vb.style.right="",this.vb.style.marginRight=""):(this.vb.style.left="",this.vb.style.marginLeft="")}hide(){this.akg.x3g(this.xCa).execute(this,w.getInstance(),{});this.Cde=window.setTimeout(()=>{this.$a.raiseEvent("OnDialogClosedEventKey",this.xCa);u.a.prototype.hide.call(this)},500)}SNi(P){3===P&&(window.clearTimeout(this.Cde),
this.$a.raiseEvent("OnDialogClosedEventKey",this.xCa),super.hide())}}Object(c.a)(x,"AppsForOfficeDialog",n.a,[148,149]);class B{constructor(){this.dialog=this.ze=null}}Object(c.a)(B,"DialogInfo",null,[]);class z{}z.url="url";z.height="height";z.width="width";z.C5c="displayInIframe";z.Ecc="hideTitle";Object(c.a)(z,"DialogSettings",null,[]);class A{constructor(){this.height=this.width=0;this.ze=this.controlId=this.pageUrl=null;this.Ecc=this.C5c=!1}}Object(c.a)(A,"DisplayDialogParams",null,[]);class I extends Sys.EventArgs{constructor(P,
Ta,pb=null,Yb="",Ac=""){super();this.controlId=P;this.messageType=Ta;this.messageContent=pb;this.messageOrigin=Yb;this.targetOrigin=Ac}}Object(c.a)(I,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class F extends Sys.EventArgs{constructor(P,Ta,pb=null,Yb="",Ac=""){super();this.controlId=P;this.messageType=Ta;this.messageContent=pb;this.messageOrigin=Yb;this.targetOrigin=Ac}}Object(c.a)(F,"OnMessageParentEventArgs",Sys.EventArgs,[]);var U=a(41),X=a(30),S=a(172),H=a(99);class D{constructor(P){this.$a=
new k.a;this.Tm=P}GFg(P){this.$a.addHandler("OnMessageParentEventKey",P)}FFg(P){this.$a.addHandler("OnMessageDialogEventKey",P)}showDialog(P,Ta,pb,Yb){if(D.w7.mb(Ta))d.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),pb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const Kd=U.b(P),Wd=Kd[z.url];if(this.Tm.getOsfControl(Ta).checkAppDomains(Wd)){var Ac=new A;Ac.width=Kd[z.width];Ac.height=Kd[z.height];Ac.pageUrl=Wd;Ac.C5c=Kd[z.C5c];
Ac.Ecc=Kd[z.Ecc];Ac.controlId=Ta;Ac.ze=S.a.create().toString();var Zc=new B;Zc.ze=Ac.ze;var id=this.Tm.getOsfControl(Ac.controlId).getManifest().getDefaultDisplayName(),gd=this.Tm.getOsfControl(Ac.controlId).getStoreType().toLowerCase();P=null;var Ub=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",!1);P=(4===r.AFrameworkApplication.ta.Oa.xj&&"hardcodedpreinstall"===gd||Ub&&"sdxcatalog"===gd)&&Ac.Ecc?this.createAndShowAppsForOfficeDialog(Ac.width,
Ac.height,Ac.ze,!0,id):this.createAndShowAppsForOfficeDialog(Ac.width,Ac.height,Ac.ze,!1,id);var Lc=this.Tm.getOsfControl(Ac.controlId),hd=Lc.getManifest();Ub={};Ub.id=Ac.ze;Ub.solutionId=Lc.getSolutionId();Ub.version=Lc.getVersion();Ub.storeType=gd;Ub.storeId=Lc.getStoreId();Ub.assetId=Lc.getAssetId();Ub.assetStoreId=Lc.getAssetStoreId();Ub.ownerAddinSolutionId=Lc.getOwnerAddinSolutionId();Ub.ownerAddinStoreType=Lc.getOwnerAddinStoreType();Ub.appDomains=hd.getAppDomains();Ub.dialogUrl=Wd;Ub.osfControlType=
1;Ub.agaveName=id;Ub.div=P.kta;d.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ub.solutionId,Ub.ownerAddinStoreType||Ub.storeType,Ub.assetId,null,null,Ub.storeId),X.a.Sv(Ac.pageUrl));this.Tm.insertDialogControl(Ub);P.yFg(Object(e.a)(this,this.eIi,"onDialogClosed"));Zc.dialog=P;D.w7.ia(Ac.controlId,Zc);Yb&&Yb(Ub);pb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else d.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),
pb(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Kd){d.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",Kd.message),pb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Bzi(P,Ta,pb,Yb){r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===Yb&&(Yb=pb);try{const Ac=this.wJa(P);Ac&&this.$a.raiseEvent("OnMessageParentEventKey",new F(Ac,OSF.DialogMessageType.DialogMessageReceived,
Ta,pb,Yb))}catch(Ac){return d.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Ac.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Dpb(P,Ta){if(D.w7.mb(P))try{const pb=D.w7.na(P);pb.dialog&&pb.dialog.hide();this.Tm.purgeDialogControl(pb.ze);D.w7.remove(P);Ta(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(pb){d.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",
pb.message),Ta(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else d.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),Ta(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}tmj(P,Ta,pb,Yb){r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===Yb&&(Yb=pb);if(D.w7.mb(P)&&(P=D.w7.na(P),P.dialog))try{this.$a.raiseEvent("OnMessageDialogEventKey",new I(P.ze,OSF.DialogMessageType.DialogParentMessageReceived,
Ta,pb,Yb))}catch(Ac){d.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Ac.message)}}wJa(P){let Ta=null;for(let pb of D.w7)if(pb.value.ze===P){Ta=pb.key;break}return Ta}eIi(P,Ta){if(P=this.wJa(Ta))this.Tm.purgeDialogControl(Ta),D.w7.remove(P),this.$a.raiseEvent("OnMessageParentEventKey",new F(P,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(P,Ta,pb,Yb,Ac){P=new x(P,Ta,pb);Ac=Yb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,
Ac);Yb&&(P.gcc=!1,P.ft=!1);P.initializeAndShow(Ac,null,null);P.Tqj();return P}static e_h(){return D.w7}static getInstance(P){D.Ma||(D.Ma=new D(P));return D.Ma}}D.Ma=null;D.w7=new H.a;Object(c.a)(D,"AppsForOfficeDialogManager",null,[120]);var J=a(842),M=a(1308),G=a(1385),T=a(933),K=a(717),L=a(174),V=a(1309),W=a(119),da=a(82),qa=a(86),O=a(637),ea=a(551),R=a(681),oa=a(84),pa=a(412),Pa=a(155),Z=a(185),Ra=a(38),Ga=a(5),Ba=a(858),fa=a(1227),Y=a(78);class ja{constructor(){this.command=0;this.properties=
null}}Object(c.a)(ja,"DdaRequestInfo",null,[]);var ca=a(729),aa=a(77);class ta extends Y.a{constructor(P,Ta){super();this.requests=[];this.disposed=this.G0b=!1;this.Jf=()=>{if(!this.disposed){this.grid.Xb.yl(this.Jf);this.G0b=!1;const pb=this.requests;this.requests=[];for(let Yb of pb)this.ddaFacade.fK(Yb.command,Yb.properties)}};this.ddaFacade=P;this.grid=Ta}qch(P,Ta){this.disposed||(this.G0b||(this.grid.Xb.em(this.Jf),this.G0b=!0),this.requests.push(Object(b.a)(new ja,{command:P,properties:Ta})))}dispose(){if(!this.disposed){this.disposed=
!0;this.G0b&&this.grid.Xb.yl(this.Jf);var P=this.requests;this.requests=null;for(let Ta of P)(P=Ta.properties?Ta.properties[aa.a.L2]:null)&&this.ddaFacade.sf(ca.a.Ixb,P);this.ddaFacade=this.grid=null;super.dispose()}}static FZg(P,Ta){var pb=!1;974713501===P&&(Ta=(P=Ta?Ta[aa.a.Zf]:null)?P.DdaMethod:null)&&Ta.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(pb=P.ArrayData,pb=!!pb&&64===(pb[6]&64));return pb}}Object(c.a)(ta,"DdaCellEditDelayRequestHandler",Y.a,[]);var xa=a(761);
class ia extends xa.a{constructor(P,Ta,pb,Yb,Ac,Zc,id){super(P,Ta,pb);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Yb;this.messageContent=Ac;this.messageOrigin=Zc;this.targetOrigin=id}}Object(c.a)(ia,"DialogMessageReceivedEventArgs",xa.a,[]);class ya extends xa.a{constructor(P,Ta,pb,Yb,Ac,Zc,id){super(P,Ta,pb);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Yb;this.messageContent=Ac;this.messageOrigin=
Zc;this.targetOrigin=id}}Object(c.a)(ya,"DialogParentMessageReceivedEventArgs",xa.a,[]);var ib=a(1),wa=a(21);class sa{constructor(P){this.Sh=this.zVc=null;this.HNi=(Ta,pb)=>{this.handlers.mb(pb.controlId)&&(Ta=new ia(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,pb.controlId,null,pb.messageType,pb.messageContent,pb.messageOrigin,pb.targetOrigin),this.handlers.na(pb.controlId)(Ta),pb.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(pb.controlId))};this.GNi=(Ta,pb)=>{this.$jc.mb(pb.controlId)&&
(Ta=new ya(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,pb.controlId,null,pb.messageType,pb.messageContent,pb.messageOrigin,pb.targetOrigin),this.$jc.na(pb.controlId)(Ta))};this.handlers=new H.a;this.$jc=new H.a;this.Kg=P;this.U0a.GFg(this.HNi);this.U0a.FFg(this.GNi)}get U0a(){this.zVc||(this.zVc=D.getInstance(this.contextActivationMgr));return this.zVc}get contextActivationMgr(){!this.Sh&&this.Kg&&(this.Sh=this.Kg.Sh);return this.Sh}addHandler(P,Ta,pb,Yb){if(ib.EwaSettings.ma(23))this.Kg.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
pb);else{d.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const Ac=Zc=>{Zc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ia(P,Ta),this.Kg.Yu(pb)):(d.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.Kg.sf(Zc,pb))};this.handlers.mb(P)?Ac(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(P,Yb,Ac)}}fBg(P,Ta,pb){ib.EwaSettings.ma(23)?this.Kg.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
pb):(d.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.$jc.ia(P,Ta),this.Kg.Yu(pb))}removeHandler(P,Ta){ib.EwaSettings.ma(23)?this.Kg.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ta):this.handlers.mb(P)?(d.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.U0a.Dpb(P,pb=>{this.handlers.remove(P);pb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.Kg.Yu(Ta):(d.ULS.sendTraceTag(537170498,
0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.Kg.sf(pb,Ta))})):this.Kg.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Ta)}a$i(P,Ta){ib.EwaSettings.ma(23)?this.Kg.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ta):(d.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.$jc.remove(P),this.Kg.Yu(Ta))}showDialog(P,Ta,pb){try{ib.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&wa.g(this.Kg.$).eb&&
wa.g(this.Kg.$).Go(!0),this.U0a.showDialog(Ta,P,pb,Yb=>{this.Kg.xBg(this.ERg(Yb))})}catch(Yb){d.ULS.sendTraceTag(537170496,0,10,`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${Yb.message}`),pb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}ERg(P){const Ta={};Ta.InstanceId=P.id;Ta.WebExtensionType=P.osfControlType===OSF.OsfControlTarget.InContent?0:1;Ta.PrimaryMarketplace={};Ta.PrimaryMarketplace.SolutionId=P.solutionId;Ta.PrimaryMarketplace.SolutionVersion=P.version;
Ta.PrimaryMarketplace.MarketplaceRef=P.storeId;Ta.PrimaryMarketplace.MarketplaceType=P.storeType;return Ta}static ka(P){if(!P.$.da.za(232)){const Ta=new sa(P);P.$.da.Ga(232,Ta)}}}Object(c.a)(sa,"DialogMessageReceivedEventManager",null,[858]);class Ya{constructor(P,Ta){this.TA=null;this.Pea=P;this.Ewg=Ta}sYb(P){P&&(this.TA||(this.TA=[]),this.TA.push(P))}Drc(P){this.TA&&Array.remove(this.TA,P)}get eventId(){return this.Pea}get targetId(){return this.Ewg}get f4h(){return 0<this.TA.length}$xi(P){return this.eventId!==
P.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===P.ddaBinding.Name:!0}m0b(P){this.TA&&Array.forEach(this.TA,Ta=>{Ta(P)})}jma(){this.TA=[]}}Object(c.a)(Ya,"DdaEventRegistration",null,[]);class bb{constructor(P){this.OE=null;this.Dva=!1;this.Vc=()=>{this.OE.forEach(Ta=>{Ta.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Ta.m0b(new xa.a(Ta.eventId,"",null))})};this.Kg=
P}invokeDdaMethod(P,Ta){const pb={};pb[aa.a.Zf]=P;pb[aa.a.L2]=Ta;this.Kg.fK(974713501,pb)}registerDdaEventAsync(P,Ta,pb,Yb,Ac){bb.uyb(P)?(bb.gmd(P)&&this.Jid(),this.OE||(this.OE=[]),Ta=this.itb(P,pb),Ta||(Ta=new Ya(P,pb),this.OE.push(Ta)),Ta.sYb(Yb),this.Kg.Yu(Ac)):this.Kg.sf(-1,Ac)}unregisterDdaEventAsync(P,Ta,pb,Yb,Ac){bb.uyb(P)?((P=this.itb(P,pb))&&P.Drc(Yb),this.Kg.Yu(Ac)):this.Kg.sf(-1,Ac)}Jid(){this.Dva||(wa.g(this.Kg.$).ha.lE(this.Vc),this.Dva=!0)}itb(P,Ta){if(!this.OE)return null;for(let pb=
0;pb<this.OE.length;pb++){const Yb=this.OE[pb];if(Yb.eventId===P&&Yb.targetId===Ta)return Yb}return null}static uyb(P){return P===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static gmd(P){return P===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(c.a)(bb,"EmbeddingPage",null,[841]);var mb=a(177);class Ca extends xa.a{constructor(P,Ta,pb,Yb,Ac,Zc,id,gd){super(P,Ta,pb);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=Zc-Yb.Reference.FirstColumn;
this.columnCount=gd;P=Math.max(Ac,Yb.Reference.FirstRow);Ac=Math.min(Ac+id-1,Yb.Reference.LastRow);P>Ac?this.startRow=this.rowCount=void 0:(this.startRow=P-Yb.Reference.FirstRow,this.rowCount=Ac-P+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}Object(c.a)(Ca,"DdaBindingSelectionEventArgs",xa.a,[]);var $a=a(198),Kb=a(24),rb=a(43),cc=a(50),nc=a(413),Wb=a(33),Ea=a(37),ua=a(563),ma=a(109),fb=a(54),
sb=a(90),Ua=a(12),ab=a(11),na=a(104);class Na{}Na.Hrh="ewa-wx-disabled-div";Na.Grh="ewa-wx-container-div";Na.GMe="ewa-ptp-nov2-flex";Object(c.a)(Na,"CssClassNames",null,[]);const Va=Na.Hrh,Sa=Na.Grh;class vb extends mb.a{constructor(P,Ta,pb,Yb=!1){super();this.bcb=0;this.OE=null;this.Dva=!1;this.ppc=null;this.ZT=0;this.r4b=this.LUa=this.QFc=this.$0d=null;this.z8d=!1;this.WMc=this.$ca=this.zZd=null;this.Vc=()=>{this.enabled&&(this.Dmj(),this.ppc=rb.d(wa.g(this.$).ha.sa.selectedRanges))};this.e4e=Ac=>
{Ac.controlId===this.Ld.InstanceId&&Array.forEach(this.OE,Zc=>{Zc.$xi(Ac)&&Zc.m0b(Ac)})};this.gtf=Ac=>{if((Ac=Object(oa.a)(382,Ac))&&!Ac.Zr())if(!this.Ld||OSF.OsfControl.isFirstPartyStoreString(this.Ld.PrimaryMarketplace.MarketplaceType)||this.$.p9){Ac.mf=this.Ld;Ac.pj=this.Kg;this.zZd=Ac;this.hvc(Ac.zFa);const Zc=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&Wb.a.Ad(this.$)&&ab.HelperMethods.iw(this.Ld)&&this.Ld.Preload&&!this.Ld.TaskpaneVisible;Zc?Ac.Gzd():
ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(Ac.Gzd(),(this.Ld.SharedRuntime&&1===this.Ld.SharedRuntime.LifeTime||this.Ld.SharedRuntimeId)&&!this.Ld.TaskpaneVisible&&Ac.ig(!1)):((this.Ld.SharedRuntime&&1===this.Ld.SharedRuntime.LifeTime||this.Ld.SharedRuntimeId)&&!this.Ld.TaskpaneVisible&&Ac.ig(!1),Ac.Gzd());this.s5a||(Wb.a.Ad(this.$)?Zc||Ac.O5():nc.a(this.$).result.VF(Ac,!0));this.$.da.za(77).iPf(this.gtf);this.t9=Object(oa.a)(402,Ac)}else d.ULS.sendTraceTag(537170464,
0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(Ac,Zc)=>{3===Zc.control.floatingObject.type&&Zc.control.floatingObject.ml.InstanceId===this.B0.WebExtensionId&&(this.t9=Object(oa.a)(402,Zc.control),this.hvc(Zc.control.Gd.firstChild),na.a(this.$).urc(this.onFloatingObjectControlAdded))};this.jb=P.$;this.Kg=P;this.Ld=pb;this.Ld.InstanceId=pb.SrcLocationOverrideResourceId?P.O2a(pb.InstanceId,pb.SrcLocationOverrideResourceId):pb.InstanceId;this.fi=Ta;this.B0={};this.B0.WebExtensionId=
pb.InstanceId;this.DEf="osfControl_"+pb.InstanceId;this.s5c="disabled_"+pb.InstanceId;this.B0.BindingData=pb.BindingData;this.s5a=this.Kg.s5a(pb.InstanceId);this.dec=this.Kg.dec(pb.InstanceId);this.Pbe=pb.WebExtensionOsfControlType;this.QHf=Yb}get controlId(){return this.Ld.InstanceId}bai(P){this.$ca||(this.$ca=P)}SOf(){this.$ca&&(this.$ca.dispose(),this.$ca=null)}get controlType(){return this.Ld.WebExtensionType}get ownerAddinSolutionId(){return this.Ld.OwnerAddinSolutionId}get $(){return this.jb}get enabled(){return!this.ZT}get iy(){return this.WMc}get IT(){return this.Ld.SrcLocationOverrideResourceId?
this.Kg.O2a(this.Ld.PrimaryMarketplace.SolutionId,this.Ld.SrcLocationOverrideResourceId):this.Ld.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.Ld.SrcLocationOverrideResourceId}get ml(){return this.Ld}get t9(){return this.$0d}set t9(P){this.$0d=P}get osfControlType(){return this.Pbe}get Wsa(){return this.QFc}set Wsa(P){this.QFc=P}get q4b(){return this.LUa}set q4b(P){this.LUa=P}get focusOnIframeWhenLoaded(){return this.Ld.FocusOnIframeWhenLoaded}get agc(){return this.z8d}set agc(P){this.z8d=
P}ckd(){if(!OSF.OsfControl.isFirstPartyStoreString(this.Ld.PrimaryMarketplace.MarketplaceType)&&ib.EwaSettings.ma(186)){const Ta=cc.GetServiceTaskFactory.Ra(this.$.da,5,4,0);Ea.TaskExtensions.Aa(Ta,()=>{Ta.result.Yf(36,null)},this.la,3);return this}if(1===this.Ld.WebExtensionType)Ea.TaskExtensions.Aa(nc.a(this.$),Ta=>{Ta.result.Cqb(this.$.da,77,6,this.gtf,1)},this.la,3);else{var P=this.ERe();const Ta=na.a(this.$);P||(P={Type:3},P.Id=this.B0.WebExtensionId,P.WebExtensionData=this.Ld,P.ContentHtml=
"<div/>",P.Version=0,P.AbsoluteLeft=0,P.AbsoluteTop=0,P.AbsoluteRight=0,P.AbsoluteBottom=0,P.Width=0,P.Height=0,P.ZOrder=0,P.OriginDeltaX=0,P.OriginDeltaY=0,P=new $a.a(P),Ta.$2b(P,null),P=Ta.vq(P.Lg()));P?(this.hvc(P.Gd.firstChild),this.t9=Object(oa.a)(402,P)):Ta.iYb(this.onFloatingObjectControlAdded)}return this}m9e(P){this.hvc(P);return this}Mlc(){this.QHf||this.Kg.Sh.purgeOsfControl(this.controlId,!1);this.Nag(!0);const P=this.ERe();P&&na.a(this.$).deleteFloatingObject(P);this.Kg.$i.K9i(this.controlId);
this.Kg.$i.MJe(this.controlId,!0);this.WMc=null}Tzd(P){this.B0=P}invokeDdaMethod(P,Ta){if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var pb={};pb[aa.a.Zf]=P;pb[aa.a.L2]=Ta;this.Kg.fK(974713501,pb)}else this.Kg.sf(ca.a.Ixb,Ta)}d7i(P,Ta,pb,Yb){if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!vb.Rgh(P)||void 0!==Ta&&null!==Ta&&void 0!==this.j2a(Ta)&&null!==this.j2a(Ta))if(d.ULS.sendTraceTag(36444195,0,50,`eventId: ${P}, targetId: ${Ta}`),
vb.Fbf(P)&&this.c6h(),vb.gmd(P)&&this.Jid(),vb.Dbf(P))ib.EwaSettings.ma(23)?this.Kg.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Yb):this.Kg.$.da.za(232).addHandler(this.controlId,pb,Yb,Ta);else if(vb.Ebf(P))ib.EwaSettings.ma(23)?this.Kg.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Yb):this.Kg.$.da.za(232).fBg(this.controlId,pb,Yb);else{vb.Cbf(P)&&this.g4e(-1777565636,Yb);this.OE||(this.OE=[]);var Ac=this.itb(P,Ta);Ac||(Ac=new Ya(P,Ta),this.OE.push(Ac));Ac.jma();
Ac.sYb(pb);this.Kg.Yu(Yb);P===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.LUa&&(this.r4b=pb)}else this.Kg.sf(3002,Yb);else this.Kg.sf(-1,Yb)}KOj(P,Ta,pb,Yb){vb.Dbf(P)?ib.EwaSettings.ma(23)?this.Kg.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Yb):this.Kg.$.da.za(232).removeHandler(this.controlId,Yb):vb.Ebf(P)?ib.EwaSettings.ma(23)?this.Kg.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Yb):this.Kg.$.da.za(232).a$i(this.controlId,Yb):(vb.Cbf(P)&&this.g4e(1592314317,
Yb),Ta=this.itb(P,Ta),this.enabled?(Ta&&(Ta.Drc(pb),Ta.f4h||Array.remove(this.OE,Ta),this.OE.length?vb.Fbf(P)&&this.Oag(!1):this.Nag(!1)),this.Kg.Yu(Yb)):this.Kg.sf(-1,Yb))}ka(P){Ua.DOMElementExtensions.getElementById(P,this.DEf)||P.appendChild(Ua.DOMElementExtensions.pf(this.iy))}showHide(P){Ua.DOMElementExtensions.setVisible(this.iy,P)}resize(P,Ta){Ua.DOMElementExtensions.Dv(this.iy,P);Ua.DOMElementExtensions.MI(this.iy,Ta)}LGe(P){if(!this.ZT&&!Ua.DOMElementExtensions.getElementById(this.iy,this.s5c)&&
this.iy){const Ta=document.createElement("div");Ta.id=this.s5c;Ta.className=Va;Ta.style.backgroundImage="url("+fb.a.current.Rn(103)+")";Ta.style.opacity=P?"1":"0";Ta.style.backgroundRepeat="no-repeat";Ta.style.backgroundPosition="center";this.iy.insertBefore(Ta,this.iy.firstChild)}this.ZT++}Ijh(){0<this.ZT&&this.ZT--;this.ZT||(Ua.DOMElementExtensions.pf(Ua.DOMElementExtensions.getElementById(this.iy,this.s5c)),this.Dva&&!rb.Q(this.ppc,wa.g(this.$).ha.sa.selectedRanges)&&this.Vc(null,null))}j2a(P){if(!this.B0||
!this.B0.BindingData)return null;for(let Ta=0;Ta<this.B0.BindingData.length;Ta++)if(this.B0.BindingData[Ta].Name===P)return this.B0.BindingData[Ta];return null}getDefaultIconUrl(){const P=this.B_e();return P?P.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.Ld.TaskpaneTitle)return this.Ld.TaskpaneTitle;const P=this.B_e();return P?P.getDefaultDisplayName():null}SIf(){if(this.LUa&&this.r4b){const P=new xa.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.LUa);this.r4b(P);
this.r4b=this.LUa=null}}ig(P){this.zZd&&this.zZd.ig(P)}Joj(){this.$.ea.isNamedObjectViewMode&&this.Uji()&&(this.$.da.za(34).Ioj(this.iy),this.showHide(!1));if(this.Kg.LWj){if(!this.QHf){const P={};P.div=this.iy;P.id=this.Ld.InstanceId;P.solutionId=this.Ld.PrimaryMarketplace.SolutionId;P.version=this.Ld.PrimaryMarketplace.SolutionVersion;P.storeId=this.Ld.PrimaryMarketplace.MarketplaceRef;P.storeType=this.Ld.PrimaryMarketplace.MarketplaceType;P.ownerAddinSolutionId=this.Ld.OwnerAddinSolutionId;P.ownerAddinStoreType=
this.Ld.OwnerAddinStoreType;this.Ld.AssetMarketplace&&(P.assetId=this.Ld.AssetMarketplace.SolutionId,P.assetStoreId=this.Ld.AssetMarketplace.MarketplaceRef);P.settings=this.Ld.OsfPropertyBag;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?P.reason=this.s5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.dec?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:
P.reason=this.s5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;P.osfControlType=0===this.Ld.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;P.isForUILessAction=4===this.Ld.WebExtensionOsfControlType;P.sourceLocationOverrideResourceId=this.Ld.SrcLocationOverrideResourceId;P.focusOnIframeWhenLoaded=this.Ld.FocusOnIframeWhenLoaded;ua.a(this.Ld)&&(P.featureGates=r.AFrameworkApplication.fa.WXe(P.solutionId));
P.hostInfoFlags=0;this.Wsa&&(P.hostInfoFlags|=2);ab.HelperMethods.iw(this.Ld)&&(P.hostInfoFlags|=1);this.$.p9||(d.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),P.hostInfoFlags|=4);ib.EwaSettings.ma(632)&&(P.hostInfoFlags|=8);ib.EwaSettings.ma(53)&&ib.EwaSettings.ma(93)&&!this.QFc&&(P.virtualOsfControlActivationCallback=()=>{this.Kg.XAd(this.Ld)});P.sharedRuntimeId=this.Ld.SharedRuntime?this.Ld.SharedRuntime.Resid:this.Ld.SharedRuntimeId;!ab.HelperMethods.iw(this.Ld)||this.Ld.Preload||
ua.a(this.Ld)||this.Kg.Sh.getOsfControl(a(733).DdaFacade.getSolutionId(this.Ld,this.$))||(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Kg.XAd(this.Ld):this.Kg.XAd(this.Ld));P.initialDisplayMode=this.Ld.TaskpaneVisible?2:1;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(P.titleOverride=this.ml.TaskpaneTitle);this.Kg.Sh.insertOsfControl(P)}this.ZT=0}else this.LGe(!0)}Nag(P){this.Oag(P);this.tOj()}c6h(){this.bcb||
this.fi.sYb(this.e4e);this.bcb++}Oag(P){0<this.bcb&&(P?this.bcb=0:this.bcb--,this.bcb||this.fi.Drc(this.e4e))}Jid(){if(!this.Dva){const P=wa.g(this.$).ha;this.ppc=rb.d(wa.g(this.$).ha.sa.selectedRanges);P.lE(this.Vc);this.Dva=!0}}tOj(){this.Dva&&(wa.g(this.$).ha.nI(this.Vc),this.Dva=!1)}wlj(P){var Ta=new Kb.Range(P.Reference.FirstRow+1,P.Reference.FirstColumn+1,P.Reference.LastRow+1,P.Reference.LastColumn+1,!1,!1);1===P.BindingType&&(P.HasHeaders&&--Ta.top,P.HasTotals&&(Ta.bottom+=1));var pb=wa.g(this.$).ha.sa.selectedRanges;
P=Ta.Hxb(this.ppc);pb=Ta.Hxb(pb);return(Ta=Ta.Ge(wa.g(this.$).ha.sa.activeRange))&&(ma.e(P)&&!ma.e(pb)||!ma.e(P)&&!ma.e(pb)&&!rb.Q(P,pb))?Ta:null}Dmj(){Array.forEach(this.OE,P=>{if(P.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&P.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.Kg.$i.CZb(this.controlId))if(P.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)P.m0b(new xa.a(P.eventId,this.controlId,null));else if(P.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const Ta=
this.j2a(P.targetId);if((null===Ta||void 0===Ta?0:Ta.IsValidRef)&&(this.$.ea.isNamedObjectViewMode?this.$.zb.pa.sheetName:this.$.xa.pa.name)===Ta.Reference.SheetName){const pb=this.wlj(Ta);pb&&P.m0b(new Ca(P.eventId,this.controlId,this.Kg.s_b(Ta),Ta,pb.top-1,pb.left-1,pb.height,pb.width))}}})}itb(P,Ta){if(!this.OE)return null;for(let pb=0;pb<this.OE.length;pb++){const Yb=this.OE[pb];if(Yb.eventId===P&&Yb.targetId===Ta)return Yb}return null}ERe(){const P=na.a(this.$).tU;for(let Ta=P.length-1;0<=Ta;--Ta){const pb=
P[Ta];if(3===pb.floatingObject.type&&pb.floatingObject.ml.InstanceId===this.B0.WebExtensionId)return pb}return null}Uji(){for(let P=0;P<this.$.zb.count;P++)if(this.$.zb.getItem(P).WKa===this.B0.WebExtensionId)return!0;return!1}hvc(P){this.WMc=P;this.iy.id=this.DEf;this.iy.className=Sa;this.iy.dir=this.$.isChromeRtl?"rtl":"ltr";this.Joj()}B_e(){if(!this.enabled)return null;const P=ua.a(this.ml)?"":this.ml.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.ml.PrimaryMarketplace.SolutionId,
P)}g4e(P,Ta){if(ib.EwaSettings.ma(23))this.Kg.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ta);else try{if(d.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.Pbe)this.Kg.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,Ta);else{const pb={};pb[K.a.Tmb]=this.controlId;const Yb=new sb.a(P,0,this.$.isEditMode?2:1,0,null);this.$.Ka.Mb(Yb,pb);this.Kg.Yu(Ta)}}catch(pb){d.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${pb.message}.`),
this.Kg.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Ta)}}static Rgh(P){return P===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||P===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static Fbf(P){return P===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||P===OSF.DDA.EventDispId.dispidSettingsChangedEvent||P===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static gmd(P){return P===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||P===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static Dbf(P){return P===
OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static Ebf(P){return P===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static Cbf(P){return P===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}Object(c.a)(vb,"OsfControl",mb.a,[856]);class Oa{constructor(){this.qYa={}}add(P){this.qYa[P]=!0}remove(P){delete this.qYa[P]}clear(){for(const P of Object.keys(this.qYa))delete this.qYa[P]}w5e(){return 0<Object.keys(this.qYa).length}CGh(){return Object.keys(this.qYa)}}Object(c.a)(Oa,
"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var yb=a(58);class Ob{constructor(P,Ta,pb){this.KNf=this.JNf=0;this.HKb=this.J$a=null;this.oGi=()=>{var Yb=wa.g(this.$).ha.Pa.SA;if(this.Rld(Yb)&&(Yb=this.oub(Yb))){var Ac={};Ac.chartId=Yb;Ac.worksheetId=this.Uia();Ac=yb.a.Ac(Ac);this.qia(51,Yb,Ac);this.qia(51,this.Uia(),Ac)}};this.pGi=()=>{if(this.J$a){var Yb={};Yb.chartId=this.J$a;Yb.worksheetId=this.HKb;Yb=yb.a.Ac(Yb);this.qia(52,this.J$a,Yb);this.qia(52,this.HKb,Yb)}Yb=wa.g(this.$).ha.Pa.SA;
this.Rld(Yb)?(this.J$a=this.oub(Yb),this.HKb=this.Uia()):this.HKb=this.J$a=null};this.$=P;this.$i=Ta;this.fi=pb}Pnb(P){51===P.messageType?this.JNf=this.MFa(P.actionType,this.JNf,this.oGi):52===P.messageType&&(this.KNf=this.MFa(P.actionType,this.KNf,this.pGi))}MFa(P,Ta,pb){if(1===P)Ta||wa.g(this.$).ha.Pa.QTc(pb),Ta++,this.usj();else if(2===P){if(1>Ta)return Ta;1===Ta&&wa.g(this.$).ha.Pa.oId(pb);Ta--}return Ta}qia(P,Ta,pb){Ta&&this.$i.oZ(P,Ta)&&this.fi.AM(P,Ta,pb)}oub(P){return P&&P.floatingObject?
(P=P.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===P.length?P[0]:null:null}Uia(){const P=this.$.xa.pa;return P&&0===P.aG?P.sheetId:null}usj(){const P=wa.g(this.$).ha.Pa.SA;this.Rld(P)&&(this.J$a=this.oub(P),this.HKb=this.Uia())}Rld(P){return!!P&&!!P.floatingObject&&0===P.floatingObject.type}}Object(c.a)(Ob,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var Ja=a(736),lb=a(191),Pb=a(608),Jb=a(100),Lb=a(342),Ab=a(55);class nb extends Y.a{constructor(P,Ta,
pb){super();this.ZT=this.iza=0;this.Vc=(Yb,Ac)=>{if(this.enabled&&!(this.wdf()||null!==Ac&&void 0!==Ac&&Ac.Ogf)&&(Yb=Object(oa.a)(Jb.a,this.$.xa.pa))&&0===Yb.aG){const Zc=Yb.sheetId,id=this.WWe();let gd=null,Ub=null;this.$i.Cgf()&&(gd=this.grid.Db.Yj(this.grid.ha.sa.activeCell),Ub=Zc in this.Rhc?this.Rhc[Zc]:null);this.Hqe(Zc,id)&&Ea.TaskExtensions.Aa(Ab.Task.Ta(!0),()=>{this.E3h(Zc,id);this.q3h(Zc,id,gd,Ub)},this.la);this.JHe(Zc,id,gd)}};this.$=P;this.$i=Ta;this.fi=pb;this.grid=wa.g(P);this.HMa=
{};this.Rhc={}}get enabled(){return!this.ZT&&0<this.iza}ZZb(P){Object(oa.a)(Lb.a,this.$.xa);1===P.actionType?(this.iza||this.grid.ha.lE(this.Vc),this.iza++):2!==P.actionType||1>this.iza||(1===this.iza&&this.grid.ha.nI(this.Vc),this.iza--)}Tuc(P){P?this.ZT++:(0<this.ZT&&this.ZT--,this.ZT||this.Vc(null,new Pb.a(!1)))}WWe(){return this.grid.ha.sa.selectedRanges}Hqe(P,Ta){return ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!P&&lb.e(this.HMa)||
P in this.HMa)&&!rb.Q(this.HMa[P],Ta):P in this.HMa&&!rb.Q(this.HMa[P],Ta)}JHe(P,Ta,pb){this.HMa[P]=rb.d(Ta);this.Rhc[P]=pb}wdf(){return this.grid.eb||this.grid.xi}eSe(P,Ta){this.$i.oZ(14,P)&&this.fi.AM(14,P,Ta);this.$i.oZ(14,Ja.a.dW)&&this.fi.AM(14,Ja.a.dW,Ta)}E3h(P,Ta){const pb={};pb.worksheetId=P;pb.address=this.Qed(Ta);Ta=yb.a.Ac(pb);this.eSe(P,Ta)}q3h(P,Ta,pb,Yb){if(this.$i.Cgf()){var Ac="";let Zc="";Yb&&(Ac=Yb.ej);pb&&(Zc=pb.ej);Yb?pb?(Ta=pb.usedRange.Hxb(Ta),Ac!==Zc&&this.E8b(Ac,"",P),this.E8b(Zc,
this.Qed(Ta),P)):this.E8b(Ac,"",P):pb&&(Ac=pb.usedRange.Hxb(Ta),this.E8b(Zc,this.Qed(Ac),P))}}E8b(P,Ta,pb){if(this.$i.oZ(100,P)){const Yb={};Yb.address=Ta;Yb.worksheetId=pb;this.fi.AM(100,P,yb.a.Ac(Yb))}}Qed(P){return rb.i(P,",",this.$,!1)}dispose(){0<this.iza&&this.grid.ha.nI(this.Vc);this.Rhc=this.HMa=null;this.iza=0;this.fi=this.$i=this.$=this.grid=null}}Object(c.a)(nb,"RichApiEventSelectionChangedHandler",Y.a,[]);var va=a(338);class db extends nb{constructor(P,Ta,pb){super(P,Ta,pb);this.Hif=this.Iif=
null}WWe(){return va.a.Mqb(this.grid.ha.rangePicker.LK)}Hqe(P,Ta){return this.Iif!==P||!rb.Q(this.Hif,Ta)}JHe(P,Ta){this.Iif=P;this.Hif=rb.d(Ta)}wdf(){return!this.grid.eb&&!this.grid.xi}eSe(P,Ta){this.$i.oZ(2700,Ja.a.dW)&&this.fi.AM(2700,Ja.a.dW,Ta)}}Object(c.a)(db,"RichApiEventPickedRangesChangedHandler",nb,[]);class Xa{constructor(P,Ta,pb){this.FPa=this.EPa=0;this.gGa=this.Sga=null;this.zwf=()=>{var Yb=wa.g(this.$).ha.Pa.SA;if(0<this.FPa&&this.Sga&&this.gGa){var Ac={};Ac.shapeId=this.Sga;Ac.worksheetId=
this.gGa;Ac=yb.a.Ac(Ac);this.fireEvent(2102,this.Sga,Ac)}this.Fli(Yb)?(this.Sga=this.WMj(Yb),this.gGa=this.Uia(),this.Sga&&this.gGa)?0<this.EPa&&(Yb={},Yb.shapeId=this.Sga,Yb.worksheetId=this.gGa,Yb=yb.a.Ac(Yb),this.fireEvent(2101,this.Sga,Yb)):d.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.Sga}', or worksheet id: '${this.gGa}' from a Floating object or gridview.`):this.gGa=this.Sga=null};this.$=P;this.$i=Ta;this.fi=pb}Pnb(P){const Ta=wa.g(this.$).ha;1===
P.actionType?(this.EPa||this.FPa||Ta.Pa.QTc(this.zwf),2101===P.messageType?this.EPa++:2102===P.messageType&&this.FPa++):2===P.actionType&&(2101===P.messageType?this.EPa=0<this.EPa?this.EPa-1:0:2102===P.messageType&&(this.FPa=0<this.FPa?this.FPa-1:0),this.EPa||this.FPa||Ta.Pa.oId(this.zwf))}Fli(P){return!!P&&!!P.floatingObject&&(0===P.floatingObject.type||7===P.floatingObject.type||1===P.floatingObject.type||3===P.floatingObject.type||5===P.floatingObject.type)}WMj(P){if(!P||!P.floatingObject)return null;
P=P.floatingObject.id;var Ta=P.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));Ta=Ta&&1===Ta.length?Ta[0]:null;return Ta?Ta:(d.ULS.sendTraceTag(537170457,344,10,`Expect get the guid like shape id from the floating object id: '${P}', but we failed.`),null)}Uia(){const P=this.$.xa.pa;return P&&0===P.aG?P.sheetId:null}fireEvent(P,Ta,pb){Ta&&this.$i.oZ(P,Ta)&&this.fi.AM(P,Ta,pb)}}Object(c.a)(Xa,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class gb{constructor(P,Ta,pb){this.NNf=this.MNf=
this.ONf=this.LNf=0;this.CTi=(Yb,Ac)=>{Yb=Object(oa.a)(Jb.a,Ac.pa);this.Y6a(Yb)&&(Ac={},Ac.worksheetId=Yb.sheetId,Ac=yb.a.Ac(Ac),this.qia(11,Yb.sheetId,Ac))};this.FTi=(Yb,Ac)=>{Yb=Object(oa.a)(Jb.a,Ac.tD);this.Y6a(Yb)&&(Ac={},Ac.worksheetId=Yb.sheetId,Ac=yb.a.Ac(Ac),this.qia(12,Yb.sheetId,Ac))};this.DTi=(Yb,Ac)=>{Yb=Object(oa.a)(Jb.a,Ac.pa);this.Y6a(Yb)&&(Ac={},Ac.worksheetId=Yb.sheetId,Yb=yb.a.Ac(Ac),this.qia(11,null,Yb,!0))};this.ETi=(Yb,Ac)=>{Yb=Object(oa.a)(Jb.a,Ac.tD);this.Y6a(Yb)&&(Ac={},Ac.worksheetId=
Yb.sheetId,Yb=yb.a.Ac(Ac),this.qia(12,null,Yb,!0))};this.$=P;this.$i=Ta;this.fi=pb}Pnb(P){11===P.messageType?P.targetId===Ja.a.dW?this.KLg(P.actionType):this.JLg(P.actionType):12===P.messageType&&(P.targetId===Ja.a.dW?this.LLg(P.actionType):this.MLg(P.actionType))}JLg(P){this.LNf=this.MFa(P,this.LNf,this.CTi)}MLg(P){this.ONf=this.MFa(P,this.ONf,this.FTi)}KLg(P){this.MNf=this.MFa(P,this.MNf,this.DTi)}LLg(P){this.NNf=this.MFa(P,this.NNf,this.ETi)}MFa(P,Ta,pb){1===P?Ta=this.iWc(Ta,pb):2===P&&(Ta=this.e5c(Ta,
pb));return Ta}iWc(P,Ta){P||this.$.xa.Pf(Ta);P++;return P}e5c(P,Ta){if(1>P)return P;1===P&&this.$.xa.zg(Ta);P--;return P}Y6a(P){return!!P&&0===P.aG}qia(P,Ta,pb,Yb=!1){Ta=Yb?Ja.a.dW:Ta;this.$i.oZ(P,Ta)&&this.fi.AM(P,Ta,pb)}}Object(c.a)(gb,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var Ha=a(236),tb=a(13),bc=a(222);class tc extends Sys.EventArgs{constructor(P,Ta,pb,Yb){super();this.sheet=P;this.XUg=Ta;this.offsetX=pb;this.offsetY=Yb}}Object(c.a)(tc,"ClickInActiveCellEventArgs",Sys.EventArgs,
[]);class Ma{constructor(P,Ta,pb){this.v1b=null;this.cqd=!1;this.onPointerDown=Yb=>{let Ac;3===Yb.tb?({r_a:Ac}=this.gridView.V9b(Yb.clientPoint),this.cqd=!!Ac&&this.gridView.ha.sa.PHe(Ac)):this.cqd=!1;this.v1b=Yb.clientPoint;return!1};this.ed=Yb=>{if(this.gridView.inRangePicker||this.gridView.xi||this.cqd||Yb.shiftKey||Yb.ctrlKey||Yb.Ca.button!==Sys.UI.MouseButton.leftButton||!this.v1b||!Yb.clientPoint||Yb.clientPoint.x!==this.v1b.x||Yb.clientPoint.y!==this.v1b.y)return!1;const Ac=({r_a:Yb}=this.gridView.V9b(Yb.clientPoint)).returnValue,
Zc=Object(oa.a)(Jb.a,this.$.xa.pa);if(Ac&&Zc&&0===Zc.aG){if(!this.gridView.ha.sa.q3.contains(Yb))return!1;Yb=new tc(Zc,Yb,ab.HelperMethods.ICd(Ac.x),ab.HelperMethods.ICd(Ac.y));this.GTi(Yb)}return!1};this.$=P;this.gridView=wa.g(P);this.$i=Ta;this.fi=pb;this.D8i()}dispose(){this.ePj()}D8i(){for(const P of this.gridView.tn){const Ta=P.domElement;Ha.a.instance.ra(tb.a.pointerDown,Ta,this.onPointerDown);bc.a.instance.ra(tb.a.click,Ta,this.ed)}}ePj(){for(const P of this.gridView.tn){const Ta=P.domElement;
Ha.a.instance.Ba(tb.a.pointerDown,Ta,this.onPointerDown);bc.a.instance.Ba(tb.a.click,Ta,this.ed)}}GTi(P){var Ta=P.sheet;if(this.Y6a(Ta)){var pb={};pb.worksheetId=Ta.sheetId;pb.address=P.XUg.toString();pb.offsetX=P.offsetX;pb.offsetY=P.offsetY;P=Ta.sheetId;this.$i.oZ(21,P)&&(Ta=yb.a.Ac(pb),this.fi.AM(21,P,Ta));P=Ja.a.dW;this.$i.oZ(21,P)&&(pb=yb.a.Ac(pb),this.fi.AM(21,P,pb))}}Y6a(P){return!!P&&0===P.aG}}Object(c.a)(Ma,"RichApiEventSingleClickedHandler",null,[]);class Tb{constructor(P,Ta,pb){this.gHb=
0;this.A$a=this.G$a=null;this.GDf=()=>{const Yb=wa.g(this.$).ha.Pa.SA;if(Yb)if(this.phf(Yb)){const Ac=this.Uia();this.D$c(Ac);this.G$a=Yb.floatingObject.id;this.A$a=Ac}else this.G$a&&(this.D$c(this.A$a),this.A$a=this.G$a=null);else this.G$a&&(this.D$c(this.A$a),this.A$a=this.G$a=null)};this.$=P;this.$i=Ta;this.fi=pb}ZZb(P){2E3===P.messageType&&(1===P.actionType?(this.gHb||wa.g(this.$).ha.Pa.QTc(this.GDf),this.gHb++,this.Qoj()):2===P.actionType&&this.gHb&&(1===this.gHb&&wa.g(this.$).ha.Pa.oId(this.GDf),
this.gHb--))}D$c(P){var Ta;const pb={};pb.worksheetId=P;pb.revisionLoad=!1;if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(ib.EwaSettings.ma(709)||ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){const Yb=wa.g(this.$).ha.Pa.SA;(null===(Ta=null===Yb||void 0===Yb?void 0:Yb.floatingObject)||void 0===Ta?0:Ta.Tc)?pb.selectedVisualId=Yb.floatingObject.Tc.VisualID:pb.selectedVisualId=null}Ta=
yb.a.Ac(pb);P&&this.$i.oZ(2E3,P)&&this.fi.AM(2E3,P,Ta)}Uia(){const P=this.$.xa.pa;return P&&0===P.aG?P.sheetId:null}Qoj(){const P=wa.g(this.$).ha.Pa.SA;this.phf(P)&&(this.G$a=P.floatingObject.id,this.A$a=this.Uia())}phf(P){return!!P&&P.wqd()}}Object(c.a)(Tb,"RichApiEventVisualSelectionChangedHandler",null,[]);class zb{constructor(P,Ta,pb){this.hHb=0;this.xgg=!0;this.U8b=0;this.Yod=!0;this.Vwe=()=>{const Yb=document.hasFocus();if(this.xgg!==Yb){if(Yb){const Ac=yb.a.Ac({});this.fi.AM(2203,Ja.a.dW,Ac)}this.xgg=
Yb}};this.Wwe=Yb=>{(0<Yb.timeRemaining()||Yb.didTimeout)&&this.Vwe();window.requestIdleCallback(this.Wwe)};this.$=P;this.$i=Ta;this.fi=pb;window.requestIdleCallback||(this.Yod=!1)}ILg(P){1===P.actionType?(this.hHb||this.cMg(),this.hHb++):2!==P.actionType||1>this.hHb||(1===this.hHb&&this.Adh(),this.hHb--)}cMg(){if(this.$i.oZ(2203,Ja.a.dW))if(this.Yod){const P={};P.timeout=this.$.ya.CheckFocusTimeout;this.U8b=window.requestIdleCallback(this.Wwe,P)}else this.U8b=window.setInterval(this.Vwe,this.$.ya.CheckFocusTimeInterval)}Adh(){this.Yod?
window.cancelIdleCallback(this.U8b):window.clearInterval(this.U8b)}}Object(c.a)(zb,"RichApiEventWorkbookActivatedHandler",null,[]);var ic;(function(P){P[P.none=0]="none";P[P.registerEvent=1]="registerEvent";P[P.unregisterEvent=2]="unregisterEvent";P[P.customFunction=3]="customFunction";P[P.showCard=4]="showCard";P[P.createWorkbook=5]="createWorkbook";P[P.openWorkbook=6]="openWorkbook";P[P.enableEvents=7]="enableEvents";P[P.closeWorkbook=8]="closeWorkbook";P[P.setCalculationMode=9]="setCalculationMode";
P[P.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";P[P.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";P[P.workbookLinksEnableContent=12]="workbookLinksEnableContent";P[P.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";P[P.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";P[P.rangePicker=15]="rangePicker";P[P.enableRichApiRecording=16]="enableRichApiRecording";P[P.recordAction=17]="recordAction";P[P.focus=18]="focus";P[P.businessBarShow=19]="businessBarShow";
P[P.businessBarHide=20]="businessBarHide"})(ic||(ic={}));Object(c.b)("PostProcessActionType",ic);var Qb=a(248);class wb{constructor(P,Ta,pb){this.EEf=null;this.B$c=(Yb,Ac)=>{const Zc=Ja.a.dW,id={};id.eventId=Yb;id.payload=Ac;this.$i.oZ(2201,Zc)&&this.fi.AM(2201,Zc,yb.a.Ac(id))};this.$=P;this.$i=Ta;this.fi=pb;this.D$h()}HLg(P){1===P.actionType?(this.$.aba=!0,Object(oa.a)(a(733).DdaFacade,Qb.a(this.$)).C$c(!0)):2===P.actionType&&(this.$.aba=!1);this.EEf=P.controlId;d.ULS.sendTraceTag(537170456,0,50,
`AttachOrDetachMacroRecorderEventHandler: actionType: ${ic[P.actionType]}; controlId: ${this.EEf}; this.ewaControl.IsMacroRecorderListening: ${this.$.aba}.`)}Qkh(P){Object(oa.a)(a(733).DdaFacade,Qb.a(this.$)).hSe(P,this.$.aba)}D$h(){this.$.fba&&Ea.TaskExtensions.Aa(cc.GetServiceTaskFactory.Ra(this.$.da,297,298,1),P=>{(P=P.result)&&P.init(this.B$c)},this.$.la,3)}}Object(c.a)(wb,"RichApiMacroRecorderEventHandler",null,[]);class hc{}Object(c.a)(hc,"SessionRecreationInfo",null,[]);class Za{constructor(P,
Ta,pb){this.$=P;this.$i=Ta;this.runtimeCalculationMode=pb}TBi(){return ib.EwaSettings.ma(259)?this.$i.p4h()||0!==this.runtimeCalculationMode:!1}QQg(){var P={};P.eventRegistrationInfos=this.$i.QMh();P.runtimeCalculationMode=this.runtimeCalculationMode;P=Object(b.a)(new hc,{runtimeState:P});const Ta={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};Ta.RequestBody=JSON.stringify(P);Ta.RequestFlags=1;return Ta}}Object(c.a)(Za,"RichApiRuntimeStateHandler",null,[]);class ub{constructor(P,
Ta,pb,Yb,Ac,Zc,id,gd,Ub){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=P;this.processUtcTime=Ta;this.dequeueUtcTime=pb;this.inQueueDurationInMS=Yb;this.executionDurationInMS=Ac;this.operationCount=Zc;this.ServerCorrelationId=id;this.UserOperationName=gd;this.IsDocumentHidden=Ub}}Object(c.a)(ub,"UserOperationQueueItemsStatisticsData",
null,[]);var uc=a(324),Oc=a(31),Bb=a(19),Nb=a(291),dc=a(48),sc=a(591),yc=a(65),cd=a(59),pd=a(71);class Rb extends uc.a{constructor(P,Ta,pb){super(pb,P);this.fva=this.hashCode=null;this.z2b=!1;this.Lm=(Yb,Ac)=>{Ac.fd.hash===this.hashCode&&this.fva&&Object(oa.a)(a(733).DdaFacade,this.$.da.za(35)).Fzj(this.fva.InstanceId)};this.nf=(Yb,Ac)=>{switch(Ac.fd.block.state){case 1:case 3:case 5:this.Wma(Ac)}};this.Li=()=>{this.xGb(!0)};this.yo=(Yb,Ac)=>{this.isVisible&&this.iTa(Ac.tD);this.clearCache()};this.re=
(Yb,Ac)=>{this.kSa(Ac.pa,!!Ac.tD)};this.vN=()=>{this.$.ea.Gla()};this.LTa=Ta;this.domElement.classList.add(Oc.a.t7b);this.domElement.classList.add(Bb.a.Zo);pb.tabIndex=0;this.kSa(this.$.pa,!1);this.Gc.ka("mousedown",this.vN);this.Gc.ka("contextmenu",Yb=>{pd.g(Yb)});this.$.xa.qJ(this.yo);this.$.zb.qJ(this.yo);this.$.zb.Pf(this.re);this.$.xa.Pf(this.re);this.Ea.Ks(this.nf);this.Ea.MG(this.Lm);this.Ea.kx(this.Li);ib.EwaSettings.dc()&&this.Ku(this.Yxa)}get Ea(){return this.LTa}dispose(){this.$&&(this.$.xa.SK(this.yo),
this.$.zb.SK(this.yo),this.$.zb.zg(this.re),this.$.xa.zg(this.re));this.LTa&&(this.LTa.Nq(this.nf),this.LTa.mI(this.Lm),this.LTa.sv(this.Li));ib.EwaSettings.dc()&&this.py(this.Yxa);this.clearCache();qa.a.Ia(this.LTa);this.LTa=null;Ua.DOMElementExtensions.pf(this.domElement);super.dispose()}Ioj(P){Ua.DOMElementExtensions.pf(Ua.DOMElementExtensions.getElementById(this.domElement,P.id));this.domElement.appendChild(P)}pkd(){if(this.fva&&!this.z2b){var P=Object(oa.a)(a(733).DdaFacade,Qb.a(this.$)).fn(this.fva.InstanceId);
P&&(P.resize(this.fva.Width,this.fva.Height),P.ka(this.domElement),P.showHide(!0),this.z2b=!0)}}$6a(){return!0}Wma(P){this.fva=P.fd.block.pe;this.z2b=!1;this.pkd()}iTa(P){this.$.ea.mZ&&P&&(P.yu||(P.yu=new Nb.a),P.yu.Ph=new dc.a(this.domElement.scrollLeft,this.domElement.scrollTop),P.yu.QFb=20)}clearCache(){this.Ea.KPa(this.hashCode);this.fva=this.hashCode=null;this.z2b=!1}kSa(P,Ta){if(this.isVisible=!!P&&yc.o(P))this.hashCode=this.Ea.hra(P,cd.a.G4b,this.hashCode),this.wvc(Ta)}static NFa(P){if(!P.da.za(34)){const Ta=
P.Cf;P.da.Ga(34,new Rb(P,new sc.a(P,P.ea,P.oa.Pk,3,0),Ta.appendChild(Ta.ownerDocument.createElement("div"))))}}}Object(c.a)(Rb,"WebExtensionView",uc.a,[854,834,2]);var Dc=a(224),nd=a(513),od=a(368),wd=a(432),Pc=a(170),Hb=a(61),Nc=a(121),Db=a(47),Cc=a(45),Xc=a(152),ld=a(111),Dd=a(62),Od=a(28),Qd=a(29),Nd=a(281),he=a(22),ve=a(14),Td=a(280),ke=a(735),xe=a(51),le=a(146),Je=a(861);const Fe=P=>{le.a.sendOtelEvent(Object.assign(new Je.a,{otelEvent:P}))},eb=P=>{le.a.sendOtelCustomerContent(Object.assign(new Je.a,
{otelEvent:P}))};var Xb=a(199),oc=a(860),Gc=a(25);a.d(C,"DdaFacade",function(){return Vc});class Vc extends Ra.a{constructor(P,Ta){super();this.fi=this.Tm=this.ea=null;this.wf=[];this.jIa=null;this.disposed=this.initialized=this.ROb=this.BEe=!1;this.zBa=null;this.Rnc=[];this.wEe=[];this.NOa=[];this.I0a=null;this.zCd=new O.a(ea.a.Sk());this.NYb=new R.a(ea.a.Sk());this.xFb=[];this.XFf=[];this.M4b=350;this.Swa=this.uea=null;this.LRc=!1;this.iee=this.hee=this.gee=this.eee=this.aee=this.fee=this.bee=this.dee=
this.$de=this.cee=null;this.Uf=()=>{this.zBa=this.ea.to.WebExtensions;for(var pb=this.wf.length-1;0<=pb;--pb){var Yb=this.wf[pb],Ac;if(Ac=!this.kAh(Yb.controlId))Ac=Yb,Ac=ib.EwaSettings.ma(121)?!Ac.Wsa:!0;Ac&&(Yb.Mlc(),this.wf.splice(pb,1))}if(this.zBa)for(let Zc=0,id=this.zBa.length;Zc<id;Zc++)pb=this.zBa[Zc],(Yb=this.fn(pb.WebExtensionId))&&Yb.Tzd(pb)};this.Nmc=pb=>{this.raiseEvent("csc",pb.getID())};this.eAd=(pb,Yb,Ac)=>{if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4841553_AddinKeyboardShortcutsInTaskpane")&&
Yb===OSF.AgaveHostAction.KeyboardShortcuts){var Zc=Object(oa.a)(Object,Ac);Yb={};Yb.keyCode=Zc.keyCode;Yb.type="keydown";Yb.ctrlKey=Zc.ctrlKey;Yb.shiftKey=Zc.shiftKey;Yb.altKey=Zc.altKey;Yb.metaKey=Zc.metaKey;Zc=this.fn(pb);pb=Zc.t9;Yb.srcElement=Object(pa.a)(382,pb)?pb.zFa:wa.g(this.$).mc;pb=new Sys.UI.DomEvent(Yb);Zc=Vc.tua(Zc.ml,this.$);Yb={};Yb.focusedAddinId=Zc;Zc=new sb.a(1461300262,1,this.$.Mc,6,null);wa.g(this.$).LIb(pb,Zc,Yb)}else if(Yb===OSF.AgaveHostAction.Select)this.T3e(!0);else if(Yb===
OSF.AgaveHostAction.UnSelect)this.T3e(!1);else if(Yb===OSF.AgaveHostAction.CancelDialog)this.fK(-684355545,null);else if(Yb===OSF.AgaveHostAction.InsertAgave)pb={},Ac&&(pb[K.a.qra]=Ac,pb[aa.a.Zf]=Vc.Qqb(Ac),this.fK(-741808261,pb));else if(Yb===OSF.AgaveHostAction.InsertDevManifest)pb={},Ac&&(pb[K.a.qra]=Ac,pb[aa.a.Zf]=Vc.Qqb(Ac),this.fK(-741808261,pb));else if(Yb===OSF.AgaveHostAction.InsertDevManifestError)pb=Object(oa.a)(Object,Ac),pb={[K.a.xUc]:this.Tm.getDevManifestInvalidUrlErrorString(pb.manifestUrl)},
this.fK(-2025863019,pb);else if(Yb===OSF.AgaveHostAction.NotifyHostError)pb={[K.a.xUc]:this.Tm.getManifestInvaildErrorString()},this.fK(-2025863019,pb);else if(Yb===OSF.AgaveHostAction.RefreshAddinCommands)ib.EwaSettings.ma(53)&&this.fK(Gc.a.refreshAddinCommands,null);else if(Yb===OSF.AgaveHostAction.CtrlF6Exit||Yb===OSF.AgaveHostAction.CtrlF6ExitShift){if(Zc=this.$.da.za(15)){(pb=this.fn(pb).t9)&&pb.Ixc();y.a.Tf&&document.activeElement.blur();var id={keyCode:117,type:"keydown",ctrlKey:!0};id.shiftKey=
Yb===OSF.AgaveHostAction.CtrlF6ExitShift;id.srcElement=Object(pa.a)(382,pb)?pb.zFa:wa.g(this.$).mc;pb=new Sys.UI.DomEvent(id);Zc.zla(pb)}}else if(Yb===OSF.AgaveHostAction.PageIsReady){if((pb=this.fn(pb).t9)&&pb.xYa===OSF.OsfControlTarget.TaskPane&&(pb=this.$.da.za(183))&&this.wf){Yb=Wb.a.Ad(this.$);for(Zc of this.wf)Vc.vLa(Zc.IT)&&(Yb?pb.hg(!0,!1):pb.setFocusOnToolbarFirstElement())}}else if(Yb===OSF.AgaveHostAction.TabExit){Yb=this.fn(pb);const Lc=Yb.t9;if(Lc)if(Lc.xYa===OSF.OsfControlTarget.InContent)Lc.kif();
else{if(Lc.xYa===OSF.OsfControlTarget.TaskPane)if(Wb.a.Ad(this.$))y.a.Tf&&document.activeElement.blur(),L.UISurfaces.Lj().then(hd=>{const Kd=Object(pa.a)(382,Lc)?Lc:null;Kd?Kd.isResizable?hd.focusResizeHandle():hd.focusTabbedTaskPaneArea():hd.focusTabbedTaskPaneArea();return null});else if(Yb=this.$.da.za(183))y.a.Tf&&document.activeElement.blur(),(pb=document.getElementById(this.$.Bb+Ga.a.Vkc))&&Ua.DOMElementExtensions.isVisible(pb)?Ua.DOMElementExtensions.setFocus(pb):Yb.setFocusOnToolbarFirstElement()}else Yb&&
4===Yb.osfControlType&&this.Tm.notifyAgave(pb,OSF.AgaveHostAction.TabIn)}else if(Yb===OSF.AgaveHostAction.TabExitShift)(Yb=this.fn(pb),Zc=Yb.t9)?Zc.xYa===OSF.OsfControlTarget.InContent?Zc.lif():Zc.xYa===OSF.OsfControlTarget.TaskPane&&(pb=Object(pa.a)(382,Zc)?Zc:null)&&(y.a.Tf&&document.activeElement.blur(),pb.SYf()):Yb&&4===Yb.osfControlType&&this.Tm.notifyAgave(pb,OSF.AgaveHostAction.TabIn);else if(Yb===OSF.AgaveHostAction.EscExit||Yb===OSF.AgaveHostAction.ExitNoFocusable||Yb===OSF.AgaveHostAction.ExitNoFocusableShift)if(Zc=
this.fn(pb).t9)Zc.Ixc();else{if(Yb===OSF.AgaveHostAction.EscExit){Yb=null;for(id of D.e_h())if(id.value.ze===pb){id.value.dialog.hide();Yb=id.key;break}Yb&&(pb=this.fn(Yb))&&4!==pb.osfControlType&&this.Sh.notifyAgave(Yb,OSF.AgaveHostAction.TabIn)}}else if(Yb===OSF.AgaveHostAction.InstallCustomFunctions)if(ib.EwaSettings.ma(121)){Dd.a(this.$).nTe(()=>!1);var gd=this.$.da;Ea.TaskExtensions.Aa(cc.GetServiceTaskFactory.Ra(gd,278,279,1),Lc=>{Lc=Lc.result;gd.za(278)||gd.Ga(278,Lc);const hd=Ac.osfControl.getStoreType();
Lc.o$e(Ac.osfControl.getSolutionId(),hd,Vc.gLh(Ac.osfControl),Ac).Dma()},this.la,3)}else d.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(Yb===OSF.AgaveHostAction.UninstallCustomFunctions)if(ib.EwaSettings.ma(121)){Dd.a(this.$).nTe(()=>!1);var Ub=this.$.da;Ea.TaskExtensions.Aa(cc.GetServiceTaskFactory.Ra(Ub,278,279,1),Lc=>{Lc=Lc.result;Ub.za(278)||Ub.Ga(278,Lc);Lc.Qag(Ac.solutionId,Ac.storeType).Dma()},this.la,
3)}else d.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else Yb===OSF.AgaveHostAction.SendTelemetryEvent?Fe(Ac):Yb===OSF.AgaveHostAction.SendCustomerContent?eb(Ac):Yb===OSF.AgaveHostAction.LaunchExtensionComponent?f.a.instance.hqi(Ac):Yb===OSF.AgaveHostAction.RefreshRibbonGallery?(pb=this.$.da.za(352))&&pb.fhd(Ac):Yb===OSF.AgaveHostAction.RemoveAppCommandsAddin?(this.h$i(Ac.solutionId),Wb.a.Ad(this.$)||(pb=this.$.da.za(183))&&
pb.Pw(),ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&r.AFrameworkApplication.wb.de(Gc.a.dOf,2,Ac.solutionId)):Yb===OSF.AgaveHostAction.GetOriginalControlId&&(pb=new M.a(this.$.Bb,Ac.ownerAddinSolutionId,new Ba.a,!0),Ac.originalControlId=pb?pb.MEe(Ac.controlId):Ac.controlId)};this.Emj=(pb,Yb)=>{const Ac=Array(2);Ac[0]=Yb;Ac[1]=null;this.fi.tAh(pb,JSON.stringify(Ac))};this.kTi=()=>{this.$.pa&&yc.o(this.$.pa)&&this.$.da.za(34).pkd()};
this.$c=()=>{this.gkf()};this.bR=(pb,Yb)=>{var Ac,Zc;1===Yb.Lq&&(pb=Yb.xf)&&(Yb=new ub(ld.toTimestamp(pb.enqueueUtcTime),ld.toTimestamp(pb.processUtcTime),ld.toTimestamp(pb.dequeueUtcTime),ld.getElapsedMilliseconds(pb.enqueueUtcTime,pb.processUtcTime),ld.getElapsedMilliseconds(pb.processUtcTime,pb.dequeueUtcTime),pb.operationCount,(null===(Zc=null===(Ac=pb.operation)||void 0===Ac?void 0:Ac.dd)||void 0===Zc?0:Zc.ServerCorrelationId)?pb.operation.dd.ServerCorrelationId:null,pb.operation?Enum.toString(wd.a,
pb.operation.operationName):null,ke.a.bD(ld.getElapsedMilliseconds(pb.enqueueUtcTime,Od.a.Wa.Nb))),Ac=Sys.Serialization.JavaScriptSerializer.serialize(Yb),d.ULS.sendTraceTag(50872916,0,50,Ac))};this.Xc=(pb,Yb)=>{!this.ea.fc&&Dc.a(Yb)?(Array.forEach(this.wf,this.qvf),this.wf.length=0,this.ROb=!1):(Yb.EH&&(d.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),this.ESf()),this.WK(),ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&
(this.ROb=!1))};this.Ao=()=>{ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(d.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),this.ESf());this.WK();ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.ROb=!1)};this.qvf=pb=>{pb.Mlc();this.raiseEvent("cd",pb.controlId)};this.jb=P;this.QUc=Ta;this.initialize();sa.ka(this);this.FTf=0;(P=(P=!(y.a.np||y.a.dba))&&(!ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||
!y.a.Tf))&&OfficeExt.ShortcutKeyDispatchManager.init();this.eqg={}}get KZb(){return this.uea||(this.uea=new V.a(this.$.Qu))}Vle(P){this.addHandler("cd",P)}iaj(P){this.removeHandler("cd",P)}XDg(P){this.addHandler("csc",P)}kaj(P){this.removeHandler("csc",P)}UDg(P){this.addHandler("ca",P)}haj(P){this.removeHandler("ca",P)}VDg(P){this.addHandler("ci",P)}WDg(P){this.addHandler("ekros",P)}jaj(P){this.removeHandler("ekros",P)}bCd(P,Ta){try{return JSON.parse(P)[Ta].toLowerCase()}catch(pb){return""}}lvj(P){const Ta=
this.bCd(P,"AudienceGroup"),pb=this.bCd(P,"SessionOrigin");try{const Yb=parseInt(this.bCd(P,"Ring"),10);if("automation"!==Ta&&"bluechicken"!==pb&&-2<=Yb)return!0}catch(Yb){if("automation"!==Ta&&"bluechicken"!==pb)return!0}return!1}get Sh(){if(!this.Tm){const P={},Ta=!(this.$.Bd&1),pb=fb.a.current.HN,Yb=this.$.workbookContext,Ac=W.a.kL+W.a.W1b;P.pageBaseUrl=pb.LayoutsContentUrlPrefix;P.appName=OSF.AppName.ExcelWebApp;P.appVersion="16";P.appSettings=this.$Oh();P.singleSignOnSettings=J.AppsForOfficeSingleSignOnManager.HWh();
P.clientMode=Ta?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;P.appUILocale=this.$.ya.UICultureTag;P.dataLocale=this.$.ya.DataCultureTag;P.docUrl=Yb.ClientUrl;P.hostControl=this;P.formFactor=OSF.FormFactor.Default;P.lcid=this.$.mG.toString();P.localizedScriptsUrl=W.a.kL+W.a.J0c;P.localizedImagesUrl=Ac;P.localizedStylesUrl=W.a.kL+W.a.Mze;P.localizedResourcesUrl=Ac;P.osfOmexBaseUrl=pb.OsfOmexBaseUrl;P.firstPartyManifestCDNUrl=pb.FirstPartyAddInManifestCDN;P.sdxAssetsToPrefetchMapping=r.AFrameworkApplication.fa.Va("SdxAssetsToPrefetchMapping");
P.sdxCdnUrl=pb.SdxCdnUrl;P.sdxDmsUrl=pb.SdxDmsUrl;P.devCatalogUrl=pb.DevCatalogUrl;P.controlStatusChanged=this.Nmc;P.notifyHost=this.eAd;P.allowExternalMarketplace=this.$.ea.Tg.get(27)&&Vc.H2b;P.enableAddinCommands=ib.EwaSettings.ma(53);P.enableBlackForestRedirect=ib.EwaSettings.ma(88);P.enableMyOrg=this.$.ea.Tg.get(33);P.enableMyApps=this.$.ea.Tg.get(34);P.enableDevCatalog=ib.EwaSettings.ma(44);P.enablePrivateCatalog=this.dwj();P.enableTaskpaneUpgradeToAppCommand=ib.EwaSettings.ma(93);P.showSignOutFromPrivateCatalogMessage=
this.$.ea.Tg.get(36);P.enableUploadFileDevCatalog=ib.EwaSettings.ma(53)&&!ib.EwaSettings.ma(282);P.userNameHashCode=X.a.Sv(r.AFrameworkApplication.userName);P.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();P.enableSingleSignOnForAddin=!ib.EwaSettings.ma(23)&&r.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;P.enableDisplayBlockedMinorError=ib.EwaSettings.ma(183);P.hideAppsExtensionUrl=r.AFrameworkApplication.hideAppsExtensionUrl;P.enableAnonymousUseLegacyCatalogService=
ib.EwaSettings.ma(173);P.enableInsertDialogAccessibilityFix=ib.EwaSettings.ma(180);P.disableAppsForOfficeThirdParty=ib.EwaSettings.ma(186);P.enableFirstPartySSO=ib.EwaSettings.ma(198);P.wacSessionId=this.$.ya.UserSessionId;P.disableLogging=!this.$.ya.AriaLoggingIsEnabled;P.enableFirstPartySDXErrorMessages=ib.EwaSettings.ma(211);P.enableRichApiCellEditDelay=ib.EwaSettings.ma(190);P.isHostDocumentDomain=ib.EwaSettings.ma(226);P.loggableUserId=r.AFrameworkApplication.fa.Va("LoggableUserId");P.sessionStartInfoJson=
r.AFrameworkApplication.fa.Va("SessionStartInfoJson");P.wopiHostOriginFromPostMessage=r.AFrameworkApplication.wopiHostOriginFromPostMessage;P.wopiHostOriginFromWacPropBag=r.AFrameworkApplication.fa.Va("PostMessageOrigin");P.wacIsEmbedded=r.AFrameworkApplication.fa.qa("IsEmbedded");P.accessibilityAllowFocusAddinTaskpane=r.AFrameworkApplication.fa.qa("AccessibilityAllowFocusAddinTaskpane");P.enableRemoveAppCommandsAddin=r.AFrameworkApplication.fa.qa("RemoveAppCommandsAddinIsEnabled");P.isHostFrameTrustCheckEnabledForAddIns=
r.AFrameworkApplication.fa.qa("HostFrameTrustCheckIsEnabledForAddIns");P.isHostFrameTrusted=r.AFrameworkApplication.isHostFrameTrusted;P.agaveAddinUploadEnabled=ib.EwaSettings.ma(46);P.hostAllowedOfficeStore=r.AFrameworkApplication.fa.qa("HostAllowedOfficeStore");P.hostAllowedSdxEmbedding=r.AFrameworkApplication.fa.qa("HostAllowedSdxEmbedding");P.hostInstallAddIns=r.AFrameworkApplication.fa.Va("HostInstallAddIns");P.hostInstallAddInsIsEnabled=r.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled");
P.approvedAddIns=r.AFrameworkApplication.fa.Va("ApprovedAddIns");P.addinEnforceHttpsIsEnabled=this.lvj(P.sessionStartInfoJson);P.hostFeatureGateFlag=0;P.isUpnCheckEnabled=r.AFrameworkApplication.fa.qa("IsUpnCheckEnabled");P.wacUpn=r.AFrameworkApplication.fa.Va("UserPrincipalName");P.isReactRibbonEnabled=Wb.a.isReactRibbonEnabled();P.enableSetFocusOnTaskpaneOnUserAction=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);P.isSafariWithIndexedDBDisabled=
ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&y.a.cMa;P.isIndexedDBDisabled=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&y.a.cMa||ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&y.a.Tf;P.enableCustomShortcuts=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");P.changeGetModifierKeyStringOutputOrder=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");
P.officeJsUrl=r.AFrameworkApplication.aL("OfficeJs/excel.js",5);P.enableOfficeJsUrlParam=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",!1);this.Tm=new OSF.ContextActivationManager(P);this.Tm.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.Tm.setWSA(r.AFrameworkApplication.Bn);this.Tm&&"undefined"!==typeof this.Tm.hostCheckReadyHandler&&r.AFrameworkApplication.SEg(Object(e.a)(this.Tm,this.Tm.hostCheckReadyHandler,"hostCheckReadyHandler"));
try{const Zc=da.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Tm.setOAuthManager(Zc)}catch(Zc){}}return this.Tm}get LWj(){return this.LRc}get $i(){return this.cee}get zma(){return this.$de}get aLd(){return this.dee}get $Kd(){return this.bee}get Chj(){return this.fee}get Ahj(){return this.aee}get Bhj(){return this.eee}get Dhj(){return this.gee}get Ehj(){return this.hee}get bLd(){return this.iee}get PU(){return this.eqg}get $(){return this.jb}s_b(P){const Ta={};Ta.Name=P.Name;Ta.BindingType=
P.BindingType;Ta.HasHeaders=P.HasHeaders;P.IsValidRef&&(Ta.ColCount=P.Reference.LastColumn-P.Reference.FirstColumn+1,Ta.RowCount=P.Reference.LastRow-P.Reference.FirstRow+1);return Ta}zqi(P,Ta){this.Tm.launchInsertDialog(P,null,this.UPg(Ta))}yca(P,Ta){if(r.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.tJf(P,Ta,OSF.StoreTypeEnum.MarketPlace);else{const pb={};pb.callbackFunc=P;pb.storeType=OSF.StoreTypeEnum.MarketPlace;pb.fromInsertDialog=!1;pb.refresh=
Ta;this.Tm.queryEntitlementDetails(pb)}}tJf(P,Ta,pb){const Yb={};Yb.callbackFunc=P;Yb.storeType=pb;Yb.fromInsertDialog=!1;Yb.refresh=Ta;this.Tm.queryEntitlementDetails(Yb)}invokeDdaMethod(P,Ta){const pb=this.fn(P.DdaMethod.ControlId);pb?pb.invokeDdaMethod(P,Ta):this.sf(ca.a.internalError,Ta)}registerDdaEventAsync(P,Ta,pb,Yb,Ac){(Ta=this.fn(Ta))?Vc.uyb(P)?Ta.d7i(P,pb,Yb,Ac):this.sf(ca.a.uBd,Ac):this.sf(ca.a.internalError,Ac)}unregisterDdaEventAsync(P,Ta,pb,Yb,Ac){(Ta=this.fn(Ta))?Vc.uyb(P)?Ta.KOj(P,
pb,Yb,Ac):this.sf(ca.a.uBd,Ac):this.sf(ca.a.internalError,Ac)}dispose(){this.disposed||(this.$.Al(this.$c),this.ea.Ik(this.Xc),this.ea.pR(this.Ao),this.ea.Hw(this.Uf),this.QUc.detach(this),this.$.userOperationManager.Co(this.bR),this.Rnc=this.wf=this.fi=this.QUc=this.jb=null,this.jIa&&(this.jIa.dispose(),this.jIa=null),qa.a.Ia(this.aLd),qa.a.Ia(this.$Kd),this.I0a&&(this.I0a.dispose(),this.I0a=null),super.dispose(),this.disposed=!0,d.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))}ycd(P){return(P=
this.fn(P))?P.getDefaultIconUrl():null}Tuc(P){if(this.BEe!==P){this.BEe=P;for(let Ta=0,pb=this.wf.length;Ta<pb;Ta++){const Yb=this.wf[Ta];P?Yb.LGe(!1):Yb.Ijh()}this.aLd.Tuc(P);this.$Kd.Tuc(P)}}BLh(P){return(P=this.fn(P))?P.getDefaultDisplayName():null}sf(P,Ta,pb=!0){const Yb={};Yb[aa.a.Zf]=P;Yb[aa.a.L2]=Ta;this.fK(451041795,Yb,pb)}Yu(P){const Ta={};Ta[aa.a.L2]=P;this.fK(1237877382,Ta)}fK(P,Ta,pb=!0){const Yb=new sb.a(P,0,this.$.Mc,0,null),Ac=Ta?Ta[aa.a.L2]:null;this.I0a&&wa.g(this.$).eb&&ta.FZg(P,
Ta)?this.I0a.qch(P,Ta):(P=this.$.Ka.Mb(Yb,Ta),pb&&Ea.TaskExtensions.Aa(P,Zc=>{Xc.a(Zc)?this.sf(ca.a.internalError,Ac,!1):Zc.result||(wa.g(this.$).eb?this.sf(ca.a.Ixb,Ac,!1):this.sf(ca.a.internalError,Ac,!1))},this.la,8))}g1g(P){return!!this.pia(Ta=>Vc.getSolutionId(Ta.ml,this.$)===Vc.getSolutionId(P,this.$)&&Ta.ml.PrimaryMarketplace.MarketplaceType===P.PrimaryMarketplace.MarketplaceType&&Ta.ml.PrimaryMarketplace.MarketplaceRef===P.PrimaryMarketplace.MarketplaceRef&&Ta.ml.PrimaryMarketplace.SolutionVersion===
P.PrimaryMarketplace.SolutionVersion)}fn(P){return this.pia(Ta=>Ta.controlId.startsWith(P))}Yzh(P){return this.pia(Ta=>Ta.Wsa===P)}FRe(P){return this.pia(Ta=>Ta.IT===P&&!!Ta.Wsa)}XRe(P,Ta,pb,Yb){return this.pia(Ac=>Ac.IT===P&&Ac.ml.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Ta.toLowerCase()&&Ac.ml.PrimaryMarketplace.MarketplaceType.toLowerCase()===pb.toLowerCase()&&!!Ac.ml.SharedRuntime&&!!Ac.ml.SharedRuntime.Resid&&!!Yb&&!!Yb.Resid&&Ac.ml.SharedRuntime.Resid.toLowerCase()===Yb.Resid.toLowerCase())}wLg(P,
Ta){if(P=this.fn(P))P.ka(Ta),P.showHide(!0)}Fzj(P){(P=this.fn(P))&&P.showHide(!1)}jHa(P){var Ta;if(1!==P.WebExtensionType||this.$.Bd&8388608&&P.TaskpaneVisible||this.$.Bd&8388608&&!P.TaskpaneVisible&&ab.HelperMethods.iw(P)){let pb=null;ab.HelperMethods.iw(P)&&(pb=Vc.tua(P,this.$),P.TaskpaneWidth||(P.TaskpaneWidth=this.M4b));const Yb=(new vb(this,this.fi,P)).ckd();d.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(P.PrimaryMarketplace.SolutionId,
P.PrimaryMarketplace.MarketplaceType,null===(Ta=P.AssetMarketplace)||void 0===Ta?void 0:Ta.SolutionId,null,null,P.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${P.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${ab.HelperMethods.iw(P)}`);pb&&(Yb.Wsa=pb);this.wf.push(Yb);this.Swa=null;this.s5a(P.InstanceId)||(P=String.format("{0}|{1}|{2}|{3}|{4}",P.PrimaryMarketplace.SolutionId,P.PrimaryMarketplace.SolutionVersion,P.PrimaryMarketplace.MarketplaceRef,P.PrimaryMarketplace.MarketplaceType,P.WebExtensionType),
this.raiseEvent("ci",P))}}lBj(P,Ta){P.TaskpaneWidth=this.M4b;P.TaskpaneVisible=!0;const pb={};pb.SolutionId=P.PrimaryMarketplace.SolutionId;pb.TargetType=P.WebExtensionType;pb.Version=P.PrimaryMarketplace.SolutionVersion;pb.StoreType=P.PrimaryMarketplace.MarketplaceType;pb.StoreId=P.PrimaryMarketplace.MarketplaceRef;pb.AssetId=P.PrimaryMarketplace.SolutionId;pb.AssetStoreId=P.PrimaryMarketplace.MarketplaceRef;pb.Width=P.TaskpaneWidth;const Yb=new vb(this,this.fi,P,!0);Yb.ckd();this.wf.push(Yb);const Ac=
()=>{this.MPa(Yb.controlId);this.Sh.purgeOsfControl(Yb.controlId,!1);Ta()};let Zc=null;Zc=Db.a.instance.FE(()=>{Yb.iy&&(qa.a.Ia(Zc),Zc=null,this.Sh.insertBlankControlWithErrorUX(this.XFb(Yb,pb),Ac))},100,Cc.a.hbh)}$4g(P){if(P&&P.length){var Ta=[];P.forEach(pb=>{if(pb.ContainsCustomFunctions){const Yb=Vc.tua(pb,this.$);this.zCd.contains(Yb)||(this.zCd.add(Yb),this.XFf.push(pb));this.g1g(pb)||Ta.push(pb)}});Ta.length&&this.HBe(Ta)}}IDe(P,Ta){this.fn(P.InstanceId)||(Ta=Ta(),P=(new vb(this,this.fi,P)).m9e(Ta),
this.wf.push(P),this.Swa=null)}$yj(P){Vc.B0a.mb(P)&&Vc.B0a.na(P).initializeAndShowWithTitle()}n5h(P){Vc.B0a.mb(P)&&Vc.B0a.na(P).hide()}qSh(P){var Ta=null;let pb,Yb,Ac=null;pb=Vc.hgd(P,!0);if(!pb)return d.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),Ab.Task.Ta(null);(Yb=this.Tm.getOsfControl(Vc.getSolutionId(pb,this.$)))&&(Ta=Yb.getManifest())&&(Ac=Ta.getSharedRuntimeForCustomFunctions("Workbook"));if(Ta=Ac&&1===Ac.LifeTime?this.XRe(pb.PrimaryMarketplace.SolutionId,
pb.PrimaryMarketplace.MarketplaceRef,pb.PrimaryMarketplace.MarketplaceType,Ac):this.Yzh(P))return Ab.Task.Ta(Ta.controlId);const Zc=new Pa.a;ab.HelperMethods.lhc(Ac)&&(pb.SharedRuntime=Ac);P=Yb?Yb.getNotificationParams():[];if(!P.length)return this.kCe(pb);this.k2f(P,()=>{Ea.TaskExtensions.Aa(Zc.task,()=>{this.kCe(pb)},this.la,3)},()=>{});return Zc.task}AGh(P){P=Vc.hgd(P,!1);if(!P)return d.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;let Ta=null;
var pb=this.Tm.getOsfControl(Vc.getSolutionId(P,this.$));pb&&(pb=pb.getManifest())&&(Ta=pb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return ab.HelperMethods.lhc(Ta)&&(P=this.XRe(P.PrimaryMarketplace.SolutionId,P.PrimaryMarketplace.MarketplaceRef,P.PrimaryMarketplace.MarketplaceType,Ta))?P.controlId:null}w3g(P,Ta){var pb=Vc.hgd(P,!1);if(pb){var Yb=null,Ac=this.Tm.getOsfControl(Vc.getSolutionId(pb,this.$));Ac&&(Ac=Ac.getManifest())&&(Yb=Ac.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));
if(ab.HelperMethods.lhc(Yb)){pb.SharedRuntime=Yb;var Zc=pb.PrimaryMarketplace.SolutionId;Ac=pb.PrimaryMarketplace.SolutionVersion;var id=OSF.OsfManifestManager.getCachedManifest(Zc,Ac);if(id)if(this.NYb.mb(P))Yb=this.NYb.na(P),Ea.TaskExtensions.Aa(Yb,Lc=>{(Lc=Lc.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Lc,Ta,this.fi.zJb)},this.la,3);else{var gd={};gd.solutionId=Zc;gd.version=Ac;gd.storeType=pb.PrimaryMarketplace.MarketplaceType;gd.storeId=pb.PrimaryMarketplace.MarketplaceRef;
gd.assetId=Zc;gd.assetStoreId=null;gd.targetType=OSF.OsfControlTarget.TaskPane;var Ub=new Pa.a;pb=Ea.TaskExtensions.fk();pb=new fa.a(this.$,this,gd,pb);Yb=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(Zc,Yb.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(id,Yb,Ac);pb.createUILessSandbox(gd,id,(Lc,hd)=>{Lc&&!hd?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Lc,Ta,this.fi.zJb),Ub.setResult(Lc)):Ub.setResult(null);this.NYb.remove(P)});this.NYb.ia(P,
Ub.task)}}}else d.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}Kwe(P){(P=this.FRe(P))&&(P.ml.SharedRuntime||this.rHb(P.controlId))}rHb(P){(P=this.FRe(P))&&this.MPa(P.controlId)}mgh(P,Ta){if(!this.wf||!P||!Ta)return!1;if(P.toLowerCase()===Ta.toLowerCase())return!0;let pb=null,Yb=null;for(let Ac=0,Zc=this.wf.length;Ac<Zc;Ac++){const id=this.wf[Ac];if(id.ownerAddinSolutionId&&(id.controlId===P&&(pb=id.ownerAddinSolutionId.toLowerCase()),id.controlId===
Ta&&(Yb=id.ownerAddinSolutionId.toLowerCase()),pb&&Yb))break}return pb&&pb===Yb?!0:!1}xBg(P){this.fn(P.InstanceId)||(P=new vb(this,this.fi,P),this.wf.push(P),this.Swa=null)}IOf(P){if(this.wf&&0<=P&&P<this.wf.length){const Ta=this.wf[P],pb=Ta.iy;this.wf.splice(P,1);this.qvf(Ta);Ua.DOMElementExtensions.pf(pb)}}MPa(P){if(this.wf)for(let Ta=0,pb=this.wf.length;Ta<pb;Ta++)if(this.wf[Ta].controlId===P){this.IOf(Ta);break}}h$i(P){if(this.wf){P=P.toLowerCase();for(let Ta=0,pb=this.wf.length;Ta<pb;Ta++)if(P===
this.wf[Ta].ownerAddinSolutionId.toLowerCase()){this.IOf(Ta);break}}}bMg(P){P.ln&&(this.fn(P.floatingObject.ml.InstanceId)||(this.dec(P.floatingObject.ml.InstanceId)||this.Rnc.push(P.floatingObject.ml.InstanceId),this.jHa(P.floatingObject.ml)),this.ea.isNamedObjectViewMode&&this.wLg(P.floatingObject.ml.InstanceId,P.Gd))}S$(P){if(this.wf)for(let Ta=0,pb=this.wf.length;Ta<pb;Ta++)if(1===this.wf[Ta].controlType&&he.a.equals(this.wf[Ta].IT,P,!0))return this.wf[Ta].controlId;return null}zzh(P){const Ta=
[];if(this.wf)for(let pb=0,Yb=this.wf.length;pb<Yb;pb++)he.a.equals(this.wf[pb].IT,P,!0)&&Ta.push(this.wf[pb].controlId);return Ta}eAh(P,Ta){if(!Ta||!P)return null;if(this.wf)for(let pb=0,Yb=this.wf.length;pb<Yb;pb++)if(1===this.wf[pb].controlType&&he.a.equals(this.wf[pb].IT,P,!0)&&this.wf[pb].ml.SharedRuntime&&he.a.equals(this.wf[pb].ml.SharedRuntime.Resid,Ta.Resid,!0))return this.wf[pb].controlId;return null}O2a(P,Ta=null){return P?Ta?`${P}.${Ta}`:P:""}Nwe(P,Ta,pb){if(this.Swa===P)return!0;this.Swa=
P;let Yb=null,Ac=!1;if(!Yb&&this.wf)for(let Zc=0,id=this.wf.length;Zc<id;Zc++)if(1===this.wf[Zc].controlType&&he.a.equals(this.wf[Zc].IT,P,!0)){let gd=!1,Ub=!1;Ta?(gd=!0,Ub=!!this.wf[Zc].ml.SharedRuntime&&he.a.equals(this.wf[Zc].ml.SharedRuntime.Resid,Ta.Resid,!0)):pb&&(gd=!0,Ub=he.a.equals(this.wf[Zc].ml.SharedRuntimeId,pb,!0));if(!gd||Ub){Ub&&this.wf[Zc].ig(!0);Yb=this.wf[Zc].controlId;Ac=!0;this.Swa=null;break}}Yb&&this.raiseEvent("ca",Yb);return Ac}setAppRuntimeState(P,Ta){var pb;if(P){const Yb=
this.fn(P);if(Yb&&ab.HelperMethods.iw(Yb.ml))Yb.ig(Ta),Ta&&(this.raiseEvent("ca",P),(null===(pb=Yb.iy)||void 0===pb?0:pb.firstChild)&&(P=Yb.iy.firstChild.title)&&0<P.length&&this.KZb.vmj(P));else throw d.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(ve.a.instance.ga(2247));}else throw d.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(ve.a.instance.ga(2248));}getAppRuntimeState(P){if(P)if((P=
this.fn(P))&&ab.HelperMethods.iw(P.ml))P=P.ml.TaskpaneVisible;else throw d.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(ve.a.instance.ga(2247));else throw d.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(ve.a.instance.ga(2248));return P}j2a(P,Ta){return(P=this.fn(P))?P.j2a(Ta):null}s5a(P){return this.Pwe(this.Rnc,P)}dec(P){return this.Pwe(this.wEe,P)}eke(P){this.wEe.push(P)}BY(P){return(P=
this.fn(P))?P.ml:null}oxd(P){this.raiseEvent("ekros",P,this)}XAd(P){if(P){var Ta=this.fn(P.InstanceId);Ta&&(P.SharedRuntime||P.SharedRuntimeId||(this.MPa(Ta.controlId),this.Sh.purgeOsfControl(Ta.controlId,!1)),Ta={},Ta.SolutionId=P.PrimaryMarketplace.SolutionId,Ta.TargetType=P.WebExtensionType,Ta.Version=P.PrimaryMarketplace.SolutionVersion,Ta.StoreType=P.PrimaryMarketplace.MarketplaceType,Ta.StoreId=P.PrimaryMarketplace.MarketplaceRef,Ta.AssetId=P.PrimaryMarketplace.SolutionId,Ta.AssetStoreId=P.PrimaryMarketplace.MarketplaceRef,
Ta.Width=P.TaskpaneWidth,Ta.SharedRuntimeId=P.SharedRuntimeId,this.n$f(Ta))}}Yha(){this.fi.Yha()}AM(P,Ta,pb){this.fi.AM(P,Ta,pb)}hSe(P,Ta){Ta=Vc.J8g(Ta);P=this.BY(P);this.fi.D8b(P.InstanceId,2202,Ja.a.dW,Ta)}C$c(P){for(let Ta=0,pb=this.wf.length;Ta<pb;Ta++)this.hSe(this.wf[Ta].controlId,P)}pAh(P,Ta){Ta=Vc.b4g(Ta);this.fi.D8b(P,65539,"",Ta)}rAh(P,Ta,pb){this.fi.D8b(P,1,Ta,pb)}oAh(P,Ta){this.fi.sAh(P,Ta)}t3g(P,Ta){return[[2,1E3,"",JSON.stringify([P,Ta]),0,!1]]}Vdi(){return!!this.zma&&this.zma.w5e()}hXg(){this.zma&&
this.zma.clear()}qAh(){if(this.zma&&this.zma.w5e()){var P=this.zma.CGh();for(const Ta of P){P=this.zzh(Ta);for(const pb of P)this.fi.D8b(pb,65540,"","{}")}}}W6i(P){this.zma.add(P)}HOj(P){this.zma.remove(P)}pia(P){if(!this.wf)return null;for(const Ta of this.wf)if(P(Ta))return Ta;return null}kCe(P){const Ta=new Pa.a,pb=Vc.tua(P,this.$);if(ab.HelperMethods.iw(P))d.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.UFf(P,Yb=>{Yb?(P.InstanceId=Yb.InstanceId,P.WebExtensionOsfControlType=
3,P.TaskpaneVisible=!1,this.jHa(P),Ta.setResult(P.InstanceId)):(d.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(P.PrimaryMarketplace.SolutionId,P.PrimaryMarketplace.MarketplaceType,null,null,null,P.PrimaryMarketplace.MarketplaceRef)} failed`),Ta.setException(Error.create("Null insert data")))});else{Vc.B0a.ia(P.InstanceId,new G.a);const Yb=Vc.B0a.na(P.InstanceId).kta;this.Z4g(P,Yb,pb);this.UFf(P,null);Ta.setResult(P.InstanceId)}return Ta.task}Z4g(P,
Ta,pb){this.fn(P.InstanceId)||(P=new vb(this,this.fi,P),P.Wsa=pb,P.m9e(Ta),this.wf.push(P),this.Swa=null)}UFf(P,Ta){const pb=Vc.tua(P,this.$);if(!this.zCd.contains(pb))this.xFb.push(P),1<=this.xFb.length&&this.VFf(P,Ta);else if(Ta)for(const Yb of this.XFf)if(Vc.tua(Yb,this.$)===pb){Ta(Yb,0);break}}VFf(P,Ta){let pb=null;const Yb={};Yb.SolutionId=Vc.getSolutionId(P,this.$);Yb.TargetType=P.WebExtensionType;Yb.Version=P.PrimaryMarketplace.SolutionVersion;Yb.StoreType=P.PrimaryMarketplace.MarketplaceType;
Yb.StoreId=P.PrimaryMarketplace.MarketplaceRef;Yb.AssetId=P.PrimaryMarketplace.SolutionId;Yb.AssetStoreId=P.PrimaryMarketplace.MarketplaceRef;Yb.Width=P.TaskpaneWidth;Yb.ContainsCustomFunctions=!0;ab.HelperMethods.iw(P)&&(Yb.SharedRuntimeId=P.SharedRuntime.Resid);const Ac=this.$.oa.va;P=this.$.oa.va.Sb();const Zc=Ac.Na(9,P);Zc.sharedInfo=Yb;const id=Ub=>{Ub=Nc.a.lf(Ub.data);d.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${Qd.a.yc(Ub)}`)},
gd=Ub=>{Ub&&!Nd.a(Ub)||d.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Yb.SolutionId,Yb.StoreType,Yb.AssetId,null,null,Yb.StoreId)} finish with errors: ${Qd.a.yc(Ub.Errors)}`);this.xFb.shift();0<this.xFb.length&&this.VFf(this.xFb[0],Ta)};if(Ta){const Ub=Lc=>{const hd=Lc.Result;(pb=hd?hd.AgaveData:null)||Ta(null,Lc.Errors?Lc.Errors[0].ErrorCause:5001);Ta(pb,0)};P=(Lc,hd,Kd)=>Hb.g(Ac,"InsertAgaveTaskpane",Zc,Td.b(Lc,gd,Ub),Td.a(hd,id),
Kd,null,0)}else P=(Ub,Lc,hd)=>Hb.g(Ac,"InsertAgaveTaskpane",Zc,Td.b(Ub,gd),Td.a(Lc,id),hd,null,0);ib.EwaSettings.dc()?od.a(this.$.userOperationManager,P,Ub=>new Pc.a(519,0,Ub,64),null):od.a(this.$.userOperationManager,P,Ub=>new nd.a(519,0,Ub),null)}dwj(){return this.$.me.get(35)}UHd(P){P=this.fn(P);(null===P||void 0===P?0:P.$ca)&&P.SOf()}cDi(P){var Ta=this.pia(pb=>Vc.vLa(pb.IT));Ta&&(Ta=this.Sh.getOsfControl(Ta.controlId))&&Ta.notifyAgave(OSF.AgaveHostAction.SendMessage,P)}Jei(){return!!this.pia(P=>
1===P.controlType&&Vc.vLa(P.IT))}Iei(){const P=this.pia(Ta=>Vc.vLa(Ta.IT));return P?P.iy?Ua.DOMElementExtensions.isVisible(P.iy):!1:!1}Kpj(){const P=this.pia(Ta=>Vc.vLa(Ta.IT));P&&(P.ig(!0),this.raiseEvent("ca",P.controlId))}initialize(){const {DdaEventDispatch:P}=a(1355),Ta=void 0===this.$||null===this.$||ib.EwaSettings.ma(259);void 0!==this.$&&null!==this.$||d.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");Ta&&d.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+
this.initialized);this.initialized||(Rb.NFa(this.$),this.ea=this.$.ea,this.fi=new P(this.$),this.$.el(this.$c),this.ea.jk(this.Xc),this.ea.$L(this.Ao),this.ea.Lu(this.Uf),this.$.userOperationManager.Hr(this.bR),this.gkf(),this.pNi(),this.P9h(),this.$.da.Ga(35,this),this.QUc.ka(this),Ta&&d.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.cee=new Ja.a,Ta&&d.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.fee=new gb(this.$,
this.$i,this.fi),new Ma(this.$,this.$i,this.fi),this.dee=new nb(this.$,this.$i,this.fi),this.bee=new db(this.$,this.$i,this.fi),this.aee=new Ob(this.$,this.$i,this.fi),this.eee=new Xa(this.$,this.$i,this.fi),this.gee=new Tb(this.$,this.$i,this.fi),this.hee=new zb(this.$,this.$i,this.fi),this.$.fba&&(this.iee=new wb(this.$,this.$i,this.fi)),ib.EwaSettings.ma(190)&&(this.I0a=new ta(this,wa.g(this.$))),ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&
(this.$de=new Oa),this.initialized=!0,d.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}kAh(P){if(!this.zBa)return null;for(let Ta=0,pb=this.zBa.length;Ta<pb;Ta++)if(P.startsWith(this.zBa[Ta].WebExtensionId))return this.zBa[Ta];return null}gkf(){var P,Ta=this.ea;if(Ta.fc&&!this.ROb){if(Ta.workbookContext){if(this.LRc=this.$.ea.Tg.get(22),null===(P=Ta.workbookContext.WebExtensions)||void 0===P?0:P.length){P=Ta.workbookContext.WebExtensions;Ta=!1;for(let pb=P.length-1;0<=pb;pb--){if(!this.ea.isNamedObjectViewMode){this.Rnc.push(P[pb].InstanceId);
if(1!==P[pb].WebExtensionType){P.splice(pb,1);continue}if(ab.HelperMethods.iw(P[pb])&&0!==P[pb].SharedRuntime.State)1===P[pb].SharedRuntime.State?P[pb].TaskpaneVisible=!1:2===P[pb].SharedRuntime.State?P[pb].TaskpaneVisible=!0:d.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!P[pb].ContainsCustomFunctions&&!P[pb].TaskpaneVisible&&!ua.a(P[pb])){P.splice(pb,1);continue}}const Yb=OSF.OsfControl.isFirstPartyStoreString(P[pb].PrimaryMarketplace.MarketplaceType);if(ib.EwaSettings.ma(186)&&
!Yb&&(P.splice(pb,1),!Ta)){Ta=!0;const Ac=cc.GetServiceTaskFactory.Ra(this.$.da,5,4,3);Ea.TaskExtensions.Aa(Ac,()=>{Ac.result.Yf(36,null)},this.la,3)}ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&P[pb].PrimaryMarketplace&&Vc.vLa(P[pb].PrimaryMarketplace.SolutionId)&&(d.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),P.splice(pb,1))}this.HBe(P)}}else this.LRc=!1;this.ROb=!0}}T3e(P){const Ta=wa.g(this.$),
pb=Ta.ha.Pa.$b;if(pb&&P){P=!1;if(this.wf)for(const Yb of this.wf)if(Vc.vLa(Yb.IT)||Vc.Jhi(Yb.IT)){P=!0;break}P||Ta.ha.Pa.dH(pb)}}pNi(){this.Sh&&this.ea.isNamedObjectViewMode&&this.$.pa&&yc.o(this.$.pa)&&(this.$.da.za(34).wQ?this.$.da.za(34).pkd():this.$.da.za(34).Ku(this.kTi))}HBe(P){let Ta=null;Ta=pb=>{const Yb=pb.WebExtensionData,Ac=pb.IsTaskPane,Zc=pb.RecordHandler,id=()=>{this.NOa.shift();0<this.NOa.length&&Ta(this.NOa[0])};if(this.S$(Yb.PrimaryMarketplace.SolutionId))id();else{Ac&&(Yb.WebExtensionOsfControlType=
1);var gd=ua.a(Yb);if(!Ac||Yb.TaskpaneVisible||gd||Yb.SharedRuntime&&0!==Yb.SharedRuntime.State||Yb.ContainsCustomFunctions){var Ub=new vb(this,this.fi,Yb,!Ac);d.ULS.sendTraceTag(537170517,0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Yb.PrimaryMarketplace.SolutionId,Yb.PrimaryMarketplace.MarketplaceType,null,null,null,Yb.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Yb.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${ab.HelperMethods.iw(Yb)}`);
Ub.ckd();ab.HelperMethods.iw(Yb)&&(Ub.Wsa=Vc.tua(Yb,this.$),Yb.TaskpaneWidth=this.M4b);gd&&(Yb.WebExtensionToolTip="");Ac&&Yb.TaskpaneVisible&&!gd&&(Yb.TaskpaneWidth=this.M4b);this.wf.push(Ub);var Lc=this.Swa=null;Lc=Db.a.instance.FE(()=>{Ub.iy&&(qa.a.Ia(Lc),Lc=null,Zc&&Zc(pb,Ub),id())},100,Cc.a.gbh)}else id()}};for(let pb=0;pb<P.length;pb++)if(!this.fn(P[pb].InstanceId))if(1!==P[pb].WebExtensionType)this.jHa(P[pb]);else if(!ib.EwaSettings.ma(53))this.Mlb(P[pb],Ta);else if(this.$.Bd&8388608||P[pb].TaskpaneVisible){const Yb=
{};Yb.marketplaceId=P[pb].PrimaryMarketplace.SolutionId;Yb.marketplaceVersion=P[pb].PrimaryMarketplace.SolutionVersion;Yb.storeType=P[pb].PrimaryMarketplace.MarketplaceType;Yb.storeId=P[pb].PrimaryMarketplace.MarketplaceRef;Yb.targetData=P[pb];this.Sh.isAddinCommandsAsync(Yb,(Ac,Zc,id)=>{if(Ac){var gd=id.targetData;if(Zc){if(ib.EwaSettings.ma(87))if(Yb.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Ac=Yb.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),Zc=Yb.storeType.toLowerCase()===
OSF.StoreType.PrivateCatalog.toLowerCase(),(Ac||Zc)&&ab.HelperMethods.iw(gd)&&this.Mlb(gd,Ta);else if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.n2h(id,Ta);else{let Ub=!1;this.yca(Lc=>{if(!Lc.errorCode){if(Lc.value)for(const hd of Lc.value){if(Ub)break;Ub=Xb.e(hd[1])===Xb.e(gd.PrimaryMarketplace.SolutionId)}Ub?ab.HelperMethods.iw(gd)&&this.Mlb(gd,Ta):(Lc={},Lc.SolutionId=id.marketplaceId,Lc.TargetType=gd.WebExtensionType,Lc.Version=id.marketplaceVersion,
Lc.StoreType=gd.PrimaryMarketplace.MarketplaceType,Lc.StoreId=id.storeId,Lc.AssetId=id.marketplaceId,Lc.AssetStoreId=id.storeId,Lc.Width=gd.TaskpaneWidth,gd.TaskpaneVisible=!0,this.Sie(Lc,gd,Ta))}},!0)}}else this.Mlb(gd,Ta)}else Ac=id.targetData,d.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ac.PrimaryMarketplace.SolutionId,Ac.PrimaryMarketplace.MarketplaceType,null,null,null,Ac.PrimaryMarketplace.MarketplaceRef)} from ${Ac.PrimaryMarketplace.MarketplaceType} during document loading`)})}}n2h(P,
Ta){let pb=!1;this.yca(Yb=>{const Ac=P.targetData;if(!Yb.errorCode){if(Yb.value)for(const Zc of Yb.value){if(pb)break;pb=Xb.e(Zc[1])===Xb.e(Ac.PrimaryMarketplace.SolutionId)}pb?ab.HelperMethods.iw(Ac)&&this.Mlb(Ac,Ta):(Yb={},Yb.SolutionId=P.marketplaceId,Yb.TargetType=Ac.WebExtensionType,Yb.Version=P.marketplaceVersion,Yb.StoreType=Ac.PrimaryMarketplace.MarketplaceType,Yb.StoreId=P.storeId,Yb.AssetId=P.marketplaceId,Yb.AssetStoreId=P.storeId,Yb.Width=Ac.TaskpaneWidth,Ac.TaskpaneVisible=!0,this.Sie(Yb,
Ac,Ta))}},!0)}Mlb(P,Ta){const pb={};pb.WebExtensionData=P;pb.IsTaskPane=!0;this.NOa.push(pb);1===this.NOa.length&&Ta(pb)}Sie(P,Ta,pb){const Yb={};Yb.ActivationInfo=P;Yb.WebExtensionData=Ta;Yb.IsTaskPane=!1;Yb.RecordHandler=(Ac,Zc)=>{const id=Ac.ActivationInfo;this.Sh.insertBlankControlWithErrorUX(this.XFb(Zc,id),()=>{this.MPa(Zc.controlId);this.Sh.purgeOsfControl(Zc.controlId,!1);this.n$f(id)})};this.NOa.push(Yb);1===this.NOa.length&&pb(Yb)}n$f(P){var Ta={};Ta.solutionId=P.SolutionId;Ta.version=P.Version;
Ta.storeType=P.StoreType;Ta.storeId=P.StoreId;Ta.assetId=P.AssetId;Ta.assetStoreId=P.AssetStoreId;Ta.targetType=P.TargetType;Ta.sharedRuntimeId=P.SharedRuntimeId;P=new Z.a;P.add(Ta);Ta={};Ta[K.a.Pmb]=P;Ta[K.a.eP]=3;P=new sb.a(Gc.a.SAb,0,this.$.Mc,0,null);this.$.Ka.Mb(P,Ta)}XFb(P,Ta){const pb={};pb.div=P.iy;pb.id=P.controlId;pb.solutionId=Ta.SolutionId;pb.version=Ta.Version;pb.storeId=Ta.StoreId;pb.storeType=Ta.StoreType;pb.osfControlType=OSF.OsfControlTarget.TaskPane;return pb}ESf(){if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){const pb=
[];for(var P=0;P<this.wf.length;P++){var Ta=this.wf[P];0!==Ta.osfControlType&&3!==Ta.osfControlType&&4!==Ta.osfControlType||pb.push(Ta)}P=!1;for(Ta=0;Ta<pb.length;Ta++){const Yb=pb[Ta];this.MPa(Yb.controlId);!P&&Yb&&Yb.ml&&(P=ab.HelperMethods.iw(Yb.ml))}P&&this.fK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4})}ib.EwaSettings.ma(400)&&Ea.TaskExtensions.Aa(cc.GetServiceTaskFactory.Ra(this.$.da,278,279,3),pb=>{pb&&(pb=pb.result)&&(this.$.da.za(278)||this.$.da.Ga(278,pb),pb.r$e().Dma())},this.la,
3)}WK(){var P=new Za(this.$,this.$i,this.FTf);void 0===this.$||null===this.$?d.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):ib.EwaSettings.ma(259)&&d.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.$i||null===this.$i));if(P.TBi()){const Ta=()=>{},pb=Zc=>{Zc=Nc.a.lf(Zc.data);d.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${Qd.a.yc(Zc)}.`)},
Yb=P.QQg();P=(Zc,id,gd)=>Hb.g(this.$.oa.va,"ExecuteRichApiRequest",this.RQg(Yb),Td.b(Zc,Ta),Td.a(id,pb),gd,null,0);let Ac=Vc.ped(Yb);ib.EwaSettings.dc()?(Ac|=64,this.$.userOperationManager.Yt(new Pc.a(507,0,P,Ac))):this.$.userOperationManager.Yt(new nd.a(507,0,P,Ac))}}RQg(P){const Ta=this.$.oa.va.Na(1);Ta.request=P;return Ta}Pwe(P,Ta){if(P)for(let pb=0;pb<P.length;pb++)if(he.a.equals(P[pb],Ta,!0))return!0;return!1}UPg(P){const Ta={};Ta.navigationMode=OSF.OsfNavigationMode.DefaultMode;Ta.assetId=null;
Ta.category=null;if(!P||3>P.length)return Ta;if(P[0]){const pb=parseInt(P[0],10);isNaN(parseInt(pb,10))||(Ta.navigationMode=pb)}P[1]&&(Ta.assetId=P[1]);P[2]&&(Ta.category=P[2]);return Ta}P9h(){if(ib.EwaSettings.ma(61)){var P=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(P&&"*"!==P.trim()){this.jIa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new bb(this),P,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.me.get(2));try{this.jIa.init()}catch(Ta){try{this.jIa.dispose()}catch(pb){}this.jIa=
null;d.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+Ta.message)}P={};P.a=this.$.ya.UserSessionId;xe.b().Le(39,P)}}}k2f(P,Ta,pb){const Yb=Vc.gPg(P[0]),Ac=Yb.Oga,Zc=Yb.Kha;Yb.Oga=()=>{Ac&&Ac();const id=Yb.aLa!==OSF.InfoType.Error?Ta:null;P.shift();P.length?this.k2f(P,id,pb):id&&id()};Yb.Kha=()=>{Zc&&Zc();pb&&Yb.aLa!==OSF.InfoType.Error&&pb()};T.a.JQd(Yb)}$Oh(){const P={};P.AddinRibbonControlsOverriddenByApi=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();
P.AddinActionDefinitionHybridMode=ib.EwaSettings.ma(635).toString();P.UseActionIdForUILessCommand=ib.EwaSettings.ma(638).toString();P.AllowStorageAccessByUserActivationOnIFrame=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();P.RequirementSetRibbonApiOnePointTwo=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();P.flightingTreatmentVariables=r.AFrameworkApplication.fa.M8b;
P.ShortcutInfoArrayInUserPreferenceData=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return P}static get H2b(){return Vc.Z2d}static set H2b(P){Vc.Z2d=P}static getSolutionId(P){let Ta=P.PrimaryMarketplace.SolutionId;ib.EwaSettings.ma(293)&&P.OwnerAddinSolutionId&&(Ta=P.OwnerAddinSolutionId);return Ta}static ped(P){let Ta=0;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?P.RequestFlags&1&&256!==(P.RequestFlags&
256)||(Ta=16):Ta=P.RequestFlags&1?0:16;return Ta}static tua(P,Ta){Ta=Vc.getSolutionId(P,Ta);return Vc.$We(Ta,P.PrimaryMarketplace.SolutionVersion,P.PrimaryMarketplace.MarketplaceType,P.PrimaryMarketplace.MarketplaceRef)}static J8g(P){return JSON.stringify({["recording"]:P})}static b4g(P){const Ta={};Ta.visibility=P?"Visible":"Hidden";return JSON.stringify(Ta)}static gLh(P){let Ta=P.getSolutionId(),pb=P.getVersion(),Yb=P.getStoreType();P=P.getStoreId();return Vc.$We(Ta,pb,Yb,P)}static $We(P,Ta,pb,
Yb){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",P,Ta,Vc.eXh(pb).toString(),Yb)}static hgd(P,Ta){var pb=P.split("|");if(7>pb.length)return d.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==pb[0])return d.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${pb[0]}'.`),null;let Yb=pb[1];const Ac=pb[2],Zc=Vc.fXh(pb[3]),id=pb[4];pb=pb[5];Yb&&Yb.length||(Yb=pb);pb=
{};pb.InstanceId=String.format("{{{0}}}",S.a.create().toString());pb.WebExtensionOsfControlType=4;pb.WebExtensionType=1;pb.PrimaryMarketplace={};pb.PrimaryMarketplace.SolutionId=Yb;pb.PrimaryMarketplace.SolutionVersion=Ac;pb.PrimaryMarketplace.MarketplaceRef=id;pb.PrimaryMarketplace.MarketplaceType=Zc;pb.ContainsCustomFunctions=Ta?!0:!1;Ta&&(pb.OsfPropertyBag=[["customFunctionAddinId",P]]);return pb}static fXh(P){P=parseInt(P,10);return P===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:P===OSF.StoreTypeEnum.Catalog?
OSF.StoreType.SPCatalog:P===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:P===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:P===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:P===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:P===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:P===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:P===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:P===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:
P===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null}static eXh(P){return P===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:P===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:P===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:P===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:P===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:P===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:P===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:P===OSF.StoreType.HardCodedPreinstall?
OSF.StoreTypeEnum.HardCodedPreinstall:P===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:P===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:P===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}static Qqb(P){const Ta={};Ta.Version=P.version;Ta.AssetId=P.assetId;Ta.AssetStoreId=null!==P.assetStoreId?P.assetStoreId.toString():null;Ta.StoreType=P.storeType;Ta.Height=P.height;Ta.SolutionId=P.solutionId;Ta.StoreId=P.storeId;Ta.TargetType=P.targetType;Ta.Width=
1===Ta.TargetType?0:P.width;Ta.SharedRuntimeId=P.sharedRuntimeId;return Ta}static uyb(P){return P===OSF.DDA.EventDispId.dispidSettingsChangedEvent||P===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||P===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||P===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||P===OSF.DDA.EventDispId.dispidRichApiMessageEvent||P===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||P===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||P===
OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static gPg(P){return Object(b.a)(new oc.a,{aLa:P.infoType,id:P.id,title:P.title,description:P.description,buttonText:P.buttonTxt,Oga:P.buttonCallback,Fcc:P.highPriority,Kha:P.dismissCallback,errorCode:P.errorCode,u8e:P.iframeNotificationUrl})}static vLa(P){let Ta="FA000000014"===P;Ta||(Ta="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===P);return Ta}static Jhi(P){return"FA000000005"===P}}Vc.B0a=new H.a;Vc.Z2d=!0;Object(c.a)(Vc,"DdaFacade",
Ra.a,[227,839,816,840,841,2])},736:function(t,C,a){a.d(C,"a",function(){return d});t=a(0);var c=a(15),b=a(110);class d{constructor(){this.pHd=0;this.QV={};this.xsa={}}wSh(f,e){return this.QV[d.BXc(f,e)]}MJe(f,e){e||void 0!==this.xsa[f]&&null!==this.xsa[f]?e&&void 0!==this.xsa[f]&&null!==this.xsa[f]&&delete this.xsa[f]:this.xsa[f]=1}CZb(f){return void 0===this.xsa[f]||null===this.xsa[f]}q1h(f){const e=d.BXc(f.messageType,f.targetId);1===f.actionType?this.N2h(f.controlId,f.messageType,e):2===f.actionType&&
this.x3h(f.controlId,f.messageType,e)}K9i(f){if(f){var e=Object.keys(this.QV);if(!(void 0===e||null===e||0>=e.length))for(const k of e)e=this.QV[k],e[f]&&(delete e[f],Object.keys(e).length||delete this.QV[k])}}oZ(f,e){f=d.BXc(f,e);f=this.QV[f];return!!f&&0<Object.keys(f).length}p4h(){return!b.a.isEmpty(this.QV)}Cgf(){return 0<this.pHd}QMh(){const f=[],e=this.QV;for(let m in e){var k=m,l=e[m];for(let v in l){l=v;const n={};n.eventType=parseInt(k.split("#")[0],10);n.targetId=k.split("#")[1];n.addinId=
l;f.push(n)}}return f}N2h(f,e,k){if(this.QV[k])k=this.QV[k],k[f]=k[f]?k[f]+1:1;else{let l={};l[f]=1;this.QV[k]=l}100===e&&this.pHd++}x3h(f,e,k){if(this.QV[k]){const l=this.QV[k];if(f){const m=l[f];1===m?(delete l[f],Object.keys(l).length||delete this.QV[k]):l[f]=m-1;100===e&&this.pHd--}else c.ULS.sendTraceTag(537170459,0,50,`The OsfControl[${f}] doesn't register event with key[${k}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${k}] that will be unregistered doesn't exist.`)}static BXc(f,
e){return String.format("{0}#{1}",f,e)}}d.dW="Workbook";Object(t.a)(d,"RichApiEventRegistration",null,[])},761:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b,d,f,e=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=b;this.controlId=d;this.ddaBinding=f;this.ArrayData=e}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(t.a)(c,"DdaEventArgs",null,[])},806:function(t,C,a){t=a(0);class c{constructor(){this.title=
this.id=this.tabs=null}}Object(t.a)(c,"AddInDataTransferObject",null,[]);a.d(C,"a",function(){return b});class b{constructor(d,f,e){this.pPb=d;this.Vjg=f;this.Wjg=e}get Is(){return this.pPb}get SAg(){return this.Vjg}get TAg(){return this.Wjg}static L2a(d){return(d=d.oV)?Object.assign(new c,{tabs:d.Is.toArray(),id:d.SAg,title:d.TAg}):null}}Object(t.a)(b,"OneLineRibbonExtensibility",null,[])},842:function(t,C,a){a.r(C);t=a(0);var c=a(185),b=a(15),d=a(99);class f{constructor(){this.startTime=0;this.callback=
null}}Object(t.a)(f,"SSOCallbackInfo",null,[]);class e{constructor(){this.accessToken=null}}Object(t.a)(e,"AccessTokenInformation",null,[329]);var k=a(962);class l{constructor(){this.token=null;this.expiresOn=0;this.zga=this.authChallenge=null}}Object(t.a)(l,"CachedTokenInfo",null,[]);class m{constructor(){this.TPb=new c.a;this.k9=this.j9=!1;this.Nna=this.authChallenge=null;this.startTime=this.retryCount=0;this.Ane=null}get callbacks(){return this.TPb}}Object(t.a)(m,"SSORequestInfo",null,[]);class v extends m{constructor(){super();
this.errorCode=0}}Object(t.a)(v,"SSOFailedRequestInfo",m,[]);var n=a(4);class w{constructor(U,X,S,H){this.GS=new c.a;this.BG=new c.a;this.Ooa=null;this.nkb=new c.a;this.M9d=Promise.resolve(null);this.Qfe=!1;this.IUb=X;this.Kmg=U;this.tge=S;this.$jg=H}cxj(U){if(this.Ooa&&this.Ooa.authChallenge===U.authChallenge){if(Date.now()/1E3+w.oyi>this.Ooa.expiresOn)return this.Ooa=null,!1;U=new k.a;U.token=this.Ooa.token;U.expiresOn=this.Ooa.expiresOn;U.zga=this.Ooa.zga;U.QSa=!0;U.Kvb=0;this.cwb(U);return!0}return!1}Jvj(U){for(let X=
0;X<this.BG.count;X++)if(this.BG.na(X).authChallenge===U.authChallenge&&this.BG.na(X).Nna===U.Nna){let S;(S=this.BG.na(X)).retryCount=S.retryCount+1;U.retryCount=this.BG.na(X).retryCount;if(this.BG.na(X).retryCount<w.Myi||!this.BG.na(X).j9&&U.j9||!this.BG.na(X).k9&&U.k9){if(!this.BG.na(X).j9&&U.j9||!this.BG.na(X).k9&&U.k9)U.retryCount=0;this.BG.removeAt(X);break}U=new k.a;U.errorCode=this.BG.na(X).errorCode;this.cwb(U);return!0}return!1}MCg(U,X){for(let S=0;S<this.BG.count;S++)if(this.BG.na(S).Nna===
U.Nna&&this.BG.na(S).authChallenge===U.authChallenge)return;this.BG.add(Object.assign(new v,{j9:U.j9,k9:U.k9,authChallenge:U.authChallenge,Nna:U.Nna,errorCode:X,retryCount:U.retryCount}))}get resource(){return this.IUb}tbd(U,X,S,H,D,J){const {AppsForOfficeSingleSignOnManager:M}=a(842);""===S&&(S=null);if(this.Qfe)M.W4(J,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var G=null;for(let T of this.GS)if(T.j9===U&&T.k9===X&&T.authChallenge===S&&T.Nna===D){G=T;break}G||(G=Object.assign(new m,
{j9:U,k9:X,authChallenge:S,Ane:H,Nna:D,retryCount:0,startTime:M.ew()}),this.GS.add(G));G.retryCount=0;G.callbacks.add(J);this.M9d=this.M9d.then(()=>{var {AppsForOfficeSingleSignOnManager:T}=a(842);if(0<this.GS.count){var K=this.GS.na(0);if(this.cxj(K)||this.Jvj(K))return null;for(let V=0;V<this.nkb.count;)this.nkb.na(V)+w.xIj<T.ew()?this.nkb.removeAt(V):V++;if(this.nkb.count>=w.Iyi||this.GS.count>=w.kyi)return K=new k.a,K.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.cwb(K),
null;let L=null;n.AFrameworkApplication.ta&&(T=n.AFrameworkApplication.ta.MD)&&(L=T.Bc("ComponentAttach",this.Kmg+w.kwg));return K.Nna.Lyg(this.resource,K.j9,K.k9,K.authChallenge,this.$jg,K.Ane).then(V=>{L&&L.stop();this.cwb(V)},()=>{L&&L.stop();const V=new k.a;V.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.cwb(V)})}return null})}}cwb(U){const {AppsForOfficeSingleSignOnManager:X}=a(842);try{if(this.GS.count){var S=this.GS.na(0);this.GS.removeAt(0);var H=null;U.errorCode||(H=
new e,H.accessToken=U.token);U.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&U.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&U.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&U.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.MCg(S,U.errorCode);var D={};null!=U.Kvb&&(D.getTokenSilentTime=U.Kvb.toString());null!=U.Nfd&&(D.getTokenPopupTime=U.Nfd.toString());null!=U.Bdd&&(D.getIDTokenTime=U.Bdd.toString());null!=
U.QSa&&(D.tokenCached=U.QSa.toString());U.pUd&&(D.detailedError=U.pUd);U.zga&&(D.authLibrary=U.zga);S.retryCount&&(D.retryCount=S.retryCount);for(var J of S.callbacks)X.W4(J,U.errorCode,H,D);null!=U.QSa&&U.QSa||this.nkb.add(S.startTime);if(!U.errorCode)for(null!=U.expiresOn&&(this.Ooa=Object.assign(new l,{token:U.token,expiresOn:U.expiresOn,authChallenge:S.authChallenge,zga:U.zga})),this.BG.clear(),J=0;J<this.GS.count;)if(this.GS.na(J).authChallenge===S.authChallenge){for(let M of this.GS.na(J).callbacks)X.W4(M,
U.errorCode,H,D);this.GS.removeAt(J)}else J++}}catch(M){b.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",M.message)}}shutdown(){this.Qfe=!0;this.GS.clear()}}w.xIj=6E4;w.Iyi=6;w.kyi=6;w.Myi=3;w.oyi=300;w.kwg="GetAccessToken";Object(t.a)(w,"SSOCallbackManager",null,[]);var r=a(717),u=a(728),y=a(124),x=a(80),B=a(27),z=a(30),A=a(146),I=a(339);a.d(C,"AppsForOfficeSingleSignOnManager",function(){return F});class F{constructor(U,X,S=null){this.hDc=new d.a;const H=new c.a;
X&&H.add(X.Qwi);S&&H.addRange(S);this.Tm=U;this.lxg=H}ubd(U,X,S,H,D,J,M,G,T,K){K=Object.assign(new f,{startTime:F.ew(),callback:K});try{const W=!!S&&""!==S;var L=K.startTime;const da=this.getOsfControl(U);let qa=da.getStoreType()||"",O=da.getOwnerAddinStoreType()||"",ea=da.getSolutionId()||"";const R=da.getVersion()||"";qa=qa.toLowerCase();O=O.toLowerCase();ea=ea.toLowerCase();var V=x.a.Add(X)||"";const oa=x.a.Add(da.getIframeUrl())||"",pa=V.toLowerCase()===oa.toLowerCase();V=qa;"inmemory"===qa&&
(V=O);const Pa=Telemetry.PrivacyRules.GetPrivacyCompliantId(ea,V,da.getAssetId(),null,null,da.getStoreId()),Z={["callInstanceId"]:L.toString(),["controlAssetId"]:Pa,["controlVersion"]:R,["storeType"]:qa,["ownerStoreType"]:O,["allowConsentPrompt"]:H.toString(),["forMSGraphAccess"]:D.toString(),["allowSignInPrompt"]:J.toString(),["hasAddinAuthChallenge"]:W.toString(),["securityOriginEqualsSourceLocation"]:pa.toString(),["singleSignOnEnabled"]:M.toString(),["accountTypeFilter"]:G||""};b.ULS.sendTraceTag(51401115,
344,50,"{0}",Z);A.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:y.a.Uj(Z)}));L=!0;const Ra=n.AFrameworkApplication.fa.Va("HostAuthType");switch(G){case "aad":L="aad"===Ra;break;case "msa":L="msa"===Ra;break;default:L=!G||"noFilter"===G}if(L){G=null;if(M)for(let Ga of this.lxg)if(Ga.kgi(ea)){G=Ga;break}G?this.isSSOAddin(U)?(M=!0,"omex"===V&&(M=!1),"spapp"===V||"spcatalog"===V?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),
F.W4(K,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):D&&!M?(b.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),F.W4(K,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(D&&"exchange"===V&&(H=!1),this.tbd(U,X,S,V,H,J,T,G,K))):(b.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),F.W4(K,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):F.W4(K,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)}else F.W4(K,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(W){this.Qic(),b.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",W.message),F.W4(K,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(U,X,S,H){this.ubd(U,S[r.a.yUc]||null,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||
!1,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,X,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,H)}tbd(U,X,S,H,D,J,M,G,T){this.hDc.mb(U)?H=this.hDc.na(U):(H=new w(U,this.getWebApplicationResource(U).split(",")[0],H,this.getDefaultDisplayName(U)),this.hDc.add(U,H));const K=H.resource;U=F.$Uh(K,this.getWebApplicationId(U));const L=OfficeExt.WACUtils.getHostSecure(X);
U&&L?U.toLowerCase()===L.toLowerCase()?H.tbd(D,J,S,M,G,T):(F.iNa('SSO Resource "'+K+'" cannot be used from "'+X+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),F.W4(T,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(U||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),L||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),F.W4(T,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,
null,null))}Qic(){b.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(U){return this.Tm.getOsfControl(U)}isSSOAddin(U){return this.getOsfControl(U).getManifest().isSSOAddin()}getWebApplicationId(U){return this.getOsfControl(U).getManifest().getWebApplicationId()}getWebApplicationResource(U){return this.getOsfControl(U).getManifest().getWebApplicationResource()}getDefaultDisplayName(U){return this.getOsfControl(U).getManifest().getDefaultDisplayName()}static HWh(){try{const U=
{};B.a.Lwa&&u.a.Vwb&&(U.UiHostSupportsAuthTokenAddinList=F.qSe);U.UiHostSupportsAuthToken=u.a.Vwb;return U}catch(U){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",U.message)}return null}static getInstance(U,X,S=null){F.Ma||(F.Ma=new F(U,S));return F.Ma}static iNa(U){window.console.warn&&window.console.warn(U)}static $Uh(U,X){if(!U)return"";X||(X="");let S=U.toLowerCase();var H=X.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(H)||
(F.iNa('SSO App Id "'+X+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));S.endsWith(H)||(F.iNa('SSO Resource "'+U+'" does not end with App Id "'+X+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!S.startsWith("https://")&&!S.startsWith("api://"))return F.iNa('SSO Resource "'+U+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(X=0;X<U.length;X++){H=U.charAt(X);const D=z.a.charCodeAt(U,X);if(33>D||126<D||"&"===H||"?"===H||"#"===H||"%"===H||"\\"===H)return F.iNa('SSO Resource "'+U+'" contains an invalid character "'+H+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+H+"' in resource URI."),""}if(0<=U.indexOf("::"))return F.iNa('SSO Resource "'+U+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
U.length)return F.iNa('SSO Resource "'+U+'" is '+U.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+U.length+"."),"";S.startsWith("api://")&&(S="https://"+S.substring(6,S.length));return 8===S.length?"":OfficeExt.WACUtils.getHostSecure(S)||""}static W4(U,X,S,H){var D=U.startTime;let J=0;0<D&&(J=F.ew()-D);D={["callInstanceId"]:D.toString(),["callDuration"]:J.toString(),["errorCode"]:X.toString()};if(H)for(let M in H)D[M]=
H[M];b.ULS.sendTraceTag(51401116,344,50,"{0}",D);A.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:y.a.Uj(D)}));U.callback(X,S)}static ew(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(U){}return Date.now()}}F.qSe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");F.Ma=null;Object(t.a)(F,
"AppsForOfficeSingleSignOnManager",null,[237])},858:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);var c=a(14);class b{constructor(){this.NPe={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};this.MPe={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ga(1634),c.a.instance.ga(1638)],["tabformulas"]:["Ribbon.Formulas",c.a.instance.ga(1635),c.a.instance.ga(1639)],["tabdeveloper"]:["Ribbon.Developer",
c.a.instance.ga(1636),c.a.instance.ga(1640)],["tabaddins"]:["Ribbon.AddIns",c.a.instance.ga(1637),c.a.instance.ga(1641)]};this.C7b=null}get qha(){return"SourceControlId"}get QM(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}WQh(){if(!this.C7b){this.C7b={};for(const d of Object.keys(this.NPe))this.C7b[d]=this.NPe[d];for(const d of Object.keys(this.MPe))this.C7b[d]=this.MPe[d][0]}}}Object(t.a)(b,"AddinCommandsStringProvider",null,[859])},860:function(t,C,a){a.d(C,"a",function(){return c});
t=a(0);class c{constructor(){this.aLa=0;this.Oga=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.Fcc=!1;this.u8e=this.Kha=null}}Object(t.a)(c,"AddInCommandsNotificationParameters",null,[])},933:function(t,C,a){t=a(0);var c=a(15),b=a(83),d=a(151),f=a(13),e=a(88);class k extends Sys.UI.Control{constructor(H,D,J,M){super(document.createElement("div"));this.mS=this.kS=this.Tw=this.wG=this.DG=this.Joa=this.nqa=null;this.Zhb=this.Bpa=!1;this.content=this.Gp=null;this.C0=0;
this.ise=null;this.lT=0;this.nCf=null;this.Qge=H;this.bce=D;this.UO=J;this.AJ=M;this.qg=D.ownerDocument;this.fcc=this.ft=this.rib=!1}get rV(){this.nqa||(this.nqa=this.qg.createElement("div"),this.nqa.id=this.hi("WACCalloutOuter"),this.nqa.className="WACCalloutOuter",this.nqa.setAttribute(e.a.Kd,e.a.RYa),this.nqa.style.width=this.C0+"px");return this.nqa}get cob(){if(!this.Joa){this.Joa=this.qg.createElement("div");this.Joa.id=this.hi("WACCalloutBeakContainer");this.Joa.className="WACCalloutBeakContainer";
var H="CalloutBeakTopFilled_32x16x32";if(5===this.lT||6===this.lT||4===this.lT)H="CalloutBeakBottomFilled_32x16x32";H=d.createClusteredImage(32,16,H,"WACCalloutBeak",!0,"");this.Joa.appendChild(H)}return this.Joa}set cob(H){this.Joa=H}get DLa(){return this.rib}get title(){return this.Gp}set title(H){this.Gp!==H&&(this.Gp=H,this.kS&&(this.kS.innerText=this.Gp))}get ft(){return this.Bpa}set ft(H){this.Bpa!==H&&(this.Bpa=H,this.DG&&(this.DG.contains(this.Tw)&&!this.Bpa?this.DG.removeChild(this.Tw):!this.DG.contains(this.Tw)&&
this.Bpa&&this.Yje()))}get fcc(){return this.Zhb}set fcc(H){this.Zhb!==H&&(this.Zhb=H,this.DG&&(this.DG.contains(this.kS)&&!this.Zhb?this.DG.removeChild(this.kS):!this.DG.contains(this.kS)&&this.Zhb&&this.qle()))}show(){this.rib||(this.r5g(),this.ho(),this.bce.appendChild(this.rV),this.rV.style.display="Block",this.Gsj(),this.rib=!0,this.nCf&&this.nCf())}dismiss(){this.rib&&(this.R0a(),this.bce.removeChild(this.rV),this.rib=!1,this.AJ&&this.AJ())}dispose(){this.dismiss();this.kS=this.Tw=this.wG=this.Joa=
this.DG=this.nqa=null;Sys.Component.prototype.dispose.call(this)}hi(H){return this.get_element().id+H}r5g(){this.DG=this.qg.createElement("div");this.DG.id=this.hi("WACCalloutHeader");this.DG.className="WACCalloutHeader";this.ft&&this.Yje();this.fcc&&this.qle();this.wG=this.qg.createElement("div");this.wG.id=this.hi("WACCalloutContent");this.wG.className="WACCalloutContent";this.wG.style.width=190<this.C0?this.C0-26+"px":"164px";this.wG.appendChild(this.content);this.rV.appendChild(this.cob);this.rV.appendChild(this.DG);
this.rV.appendChild(this.wG)}Yje(){this.Tw=this.qg.createElement("a");this.Tw.className="WACCalloutCloseAnchor";this.Tw.id=this.hi("WACCalloutCloseAnchor");this.Tw.href="#";this.DG.appendChild(this.Tw);const H=d.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.Tw.appendChild(H)}qle(){this.kS=this.qg.createElement("div");this.kS.className="WACCalloutTitle UIFontBold";this.kS.style.width=190<this.C0?this.C0-30+"px":"160px";this.kS.id=
this.hi("WACCalloutTitle");this.kS.innerText=this.title;this.DG.contains(this.Tw)?this.DG.insertBefore(this.kS,this.Tw):this.DG.appendChild(this.kS)}Gsj(){var H=this.Qge;let D;if(1===this.lT){var J=this.ise.y+16;D=-16}else 2===this.lT||3===this.lT||0===this.lT?(J=H.y+H.height+15,D=-15):(J=H.y-this.rV.clientHeight-15-2,D=this.rV.clientHeight-1);this.rV.style.top=J+"px";this.cob.style.top=D+"px";1===this.lT?(H=this.ise.x-16,this.rV.style.left="50%",this.rV.style.marginLeft=-this.C0/2+"px",J=Sys.UI.DomElement.getBounds(this.rV),
this.cob.style.left=H-J.x+"px"):(J=H.x+this.Qge.width/2,2===this.lT||5===this.lT?(H=20,J-=36):0===this.lT||4===this.lT?(H=this.C0/2-16,J-=this.C0/2):(H=this.C0-20-32,J=J-this.C0+36),this.rV.style.left=J+"px",this.cob.style.left=H+"px")}ho(){this.ft&&!this.mS&&(this.mS=Object(b.a)(this,this.U9,"closeHandler"),this.UO.ra(f.a.click,this.Tw,this.mS,null))}R0a(){this.ft&&this.mS&&(this.UO.Ba(f.a.click,this.Tw,this.mS),this.mS=null)}U9(){this.dismiss();return!0}}Object(t.a)(k,"Callout",Sys.UI.Control,[236]);
class l extends k{constructor(H,D,J,M,G,T=null){super(H,J,G.vW,T);this.kae=0;this.C0=this.aRh(M);this.kXa=D;this.We=G;this.yJj=7;this.pl=this.kXa.ownerDocument.createElement("div");this.pl.className="ModalCalloutControlOverlay";this.pl.tabIndex=0;this.kXa.insertBefore(this.pl,this.kXa.firstChild)}show(){this.DLa||(this.We.cpc(),this.We.nP(!1),this.pl.style.zIndex=String(this.We.x1),super.show(),this.Bj(),this.kae=window.setTimeout(Object(b.a)(this,this.dismiss,"dismiss"),1E3*this.yJj))}dismiss(){this.DLa&&
(this.We.wM(!1),this.ek(),this.kXa&&this.kXa.contains(this.pl)&&this.kXa.removeChild(this.pl),super.dismiss(),window.clearTimeout(this.kae))}Bj(){this.We.nra(Object(b.a)(this,this.dismiss,"dismiss"));this.We.zy.ra(f.a.click,this.pl,Object(b.a)(this,this.ed,"onClick"))}ek(){this.We.Xab(Object(b.a)(this,this.dismiss,"dismiss"));this.We.zy.Ba(f.a.click,this.pl,Object(b.a)(this,this.ed,"onClick"))}ed(){this.dismiss();return!0}aRh(H){let D=0;switch(H){case 0:D=190;break;case 1:D=250;break;case 2:D=300;
break;case 3:D=360}return D}}Object(t.a)(l,"ModalCallout",k,[]);var m=a(457),v=a(174);class n extends l{constructor(H,D,J,M,G,T=null){super(H,D,J,M,G,T);this.zTb=null}show(){if(!this.DLa){const H=Object.assign(new m.a,{onShow:()=>{l.prototype.show.call(this)}});v.UISurfaces.tH().then(D=>{const J=D.externalNotification();this.zTb=D.addNotification(J,H);return null},D=>{c.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",D);return null})}}dismiss(){this.DLa&&this.zTb&&(v.UISurfaces.tH().then(H=>
{H.removeNotification(this.zTb);return this.zTb=null},H=>{c.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",H);return null}),super.dismiss())}}Object(t.a)(n,"ReactManagedModalCallout",l,[]);var w=a(4);class r{static d7g(H,D,J){return w.AFrameworkApplication.ta.Oa.BQ?new n(H,D,J,3,w.AFrameworkApplication.ta,null):new l(H,D,J,3,w.AFrameworkApplication.ta,null)}}Object(t.a)(r,"ModalCalloutControlFactory",null,[]);var u=a(53),y=a(856),x=a(462),B=a(857),z=a(133),A=a(56),I=a(39),
F=a(82),U=a(806),X=a(692);a.d(C,"a",function(){return S});class S{static get KZb(){return S.uea||(S.uea=F.a.instance.vh("Common.Utils.IAriaNotifier"))}static OBe(H,D,J,M){S.eJ&&S.eJ.DLa&&S.eJ.dismiss();S.eJ=r.d7g(D,H,H);S.eJ.content=J;X.b(M)||(S.eJ.title=M,S.eJ.fcc=!0);H=new Sys.UI.Bounds(0,0,A.a.dbc(),A.a.cbc());S.eJ.lT=S.TIh(H,D,S.eJ.C0);S.eJ.show();S.KZb&&S.KZb.sendNotification(J.innerText,!0)}static c2c(H,D,J,M=null){v.UISurfaces.tH().then(G=>{let T=null;S.kkb&&(G.removeNotification(S.kkb),S.kkb=
null);const K=G.callout(Object.assign(new y.a,{target:H,title:D,content:J,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new B.a,{onDismiss:()=>{G.removeNotification(T)},directionalHint:null!=M?M:null})})),L=Object.assign(new m.a,{expirationOptions:Object.assign(new x.a,{displayTimeoutSeconds:7,onExpire:()=>{G.removeNotification(S.kkb)}})});T=S.kkb=G.addNotification(K,L);return null},G=>{c.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",
G);return null})}static HQd(H,D=null){S.eJ&&S.eJ.DLa&&S.eJ.dismiss();const J=new z.StandardDialog;J.RRa=!1;J.Rb=0;J.Xz(u.a.Spi,CommonUIStrings.l_DialogError,X.b(H)?S.iXe():H,D)}static JQd(H){S.eJ&&S.eJ.DLa&&S.eJ.dismiss();c.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",H.errorCode));const D=X.b(H.description)?S.iXe():H.description,J=new z.StandardDialog;let M=null;H.Oga?(J.Rb=1,J.rc(1,H.buttonText),J.S_(1)):J.Rb=0;M=G=>{1===G?H.Oga():H.Kha&&H.Kha()};
J.RRa=!1;0===H.aLa?J.Xz(H.errorCode,H.title?H.title:CommonUIStrings.l_DialogError,D,M):1===H.aLa?J.oW(H.title?H.title:CommonUIStrings.l_DialogWarning,D,M):J.jAa(H.title?H.title:CommonUIStrings.l_DialogInfo,D,M)}static TIh(H,D,J){let M=4;const G=H.x+H.width-D.x-D.width;D.x-H.x+D.width/2<=J/2?M=5:G+D.width/2<=J/2&&(M=6);return M}static Kyj(H,D,J,M=!1){(D=U.a.L2a(D))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(D,G=>{G&&(M||S.c2c(G,
J,H,5))})}static Lyj(H,D,J=!1){S.Kyj(D.startedNode?D.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,H),D,D.startedNode?D.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,H),J)}static Jyj(H,D,J,M){if(S.feg)H=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,J,M,CommonUIStrings.l_InsertionDialogRefresh)),S.c2c(D,H,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{D=
I.a.ep(D);var G=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),T=document.createElement("span");T.innerText=G[0];var K=document.createElement("span");K.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,J,M,CommonUIStrings.l_InsertionDialogRefresh);K.className="UIFontBold";J=document.createElement("span");J.innerText=G[1];M=document.createElement("div");Sys.UI.DomElement.addCssClass(M,"ModalCalloutControl");M.appendChild(T);M.appendChild(K);M.appendChild(J);
S.OBe(H,D,M,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static bAj(H,D){var J=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,M=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;S.feg?S.c2c(D,J,M):(D=I.a.ep(D),S.OBe(H,D,S.wRg(M),J))}static wRg(H){const D=document.createElement("div");Sys.UI.DomElement.addCssClass(D,"ModalCalloutControl");D.innerText=H;return D}static iXe(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get feg(){return w.AFrameworkApplication.ta.Oa.Ji&&
w.AFrameworkApplication.ta.Oa.BQ}}S.eJ=null;S.kkb=null;S.uea=null;Object(t.a)(S,"AddInCommandsNotificationFactory",null,[])},943:function(t,C,a){a.r(C);t=a(0);var c=a(15),b=a(1453),d=a(146),f=a(124),e=a(717),k=a(730),l=a(339);class m{constructor(u,y,x,B){this.oA=!1;this._id=u;this.$w=y;this.P0=x;this.Ld=B}get enabled(){return this.oA}set enabled(u){const {DynamicRibbon:y}=a(943);var x=this.Ld.OwnerAddinStoreType;const B=this.Ld.PrimaryMarketplace.MarketplaceRef,z=this.Ld.AssetMarketplace?this.Ld.AssetMarketplace.SolutionId:
null,A=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.$w,x,null,null,null,B);x={["addinSolutionId"]:A,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ld.OwnerAddinSolutionId,x,z,null,null,B),["ownerAddinStoreType"]:x,["ribbonControlType"]:"Button",["toggle"]:u};d.a.sendTelemetryEvent(Object.assign(new l.a,{name:y.Fyc+"ControlUpdate",dataFields:f.a.Uj(x)}));this.oA=u;this.P0.fK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.$w,["PrivacyCompliantSolutionId"]:A,
["SourceControlId"]:this.id,["MethodData"]:this.oA})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(u){switch(u){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertyGetAsync(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}invokePropertySet(u,
y){switch(u){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(y,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertySetAsync(u,y){this.invokePropertySet(u,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(u,y){switch(u){case 5:return this.qpj(y);case 1:return this.MBa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokeMethodAsync(u,y){u=this.invokeMethod(u,
y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}qpj(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"boolean");this.setEnabled(u);return null}MBa(){this._OnAccess();return null}}Object(t.a)(m,"RibbonButton",null,[]);class v{constructor(u,y,x,B){this._id=u;this.$w=y;this.P0=x;this.Ld=B}get id(){return this._id}setVisibility(u){const {DynamicRibbon:y}=a(943),x=this.Ld.OwnerAddinStoreType;var B=this.Ld.PrimaryMarketplace.MarketplaceRef;const z=this.Ld.AssetMarketplace?
this.Ld.AssetMarketplace.SolutionId:null,A=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.$w,x,z,null,null,B);B={["addinSolutionId"]:A,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ld.OwnerAddinSolutionId,x,z,null,null,B),["ownerAddinStoreType"]:x,["ribbonControlType"]:"Tab",["toggle"]:u};d.a.sendTelemetryEvent(Object.assign(new l.a,{name:y.Fyc+"ControlUpdate",dataFields:f.a.Uj(B)}));this.P0.fK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.$w,
["PrivacyCompliantSolutionId"]:A,["StoreType"]:x,["SourceControlId"]:this.id,["MethodData"]:u})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(u){switch(u){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertyGetAsync(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}invokePropertySet(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
}invokePropertySetAsync(u,y){this.invokePropertySet(u,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(u,y){switch(u){case 3:return this.jtj(y);case 1:return this.MBa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokeMethodAsync(u,y){u=this.invokeMethod(u,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}jtj(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"boolean");this.setVisibility(u);
return null}MBa(){this._OnAccess();return null}}Object(t.a)(v,"RibbonTab",null,[]);var n=a(966),w=a(183);a.d(C,"DynamicRibbon",function(){return r});class r{constructor(u,y,x,B,z){this.$w=u;this.XI=x;this.P0=B;this.Ld=z;this.Fgb=this.XI.Sh;this.Ey=this.Fgb.getOsfControl(y);this.Xrg=this.Ey.getManifest()}get buttons(){return null}executeRequestCreate(u){try{var y=this.Ld.OwnerAddinStoreType;const B=this.Ld.PrimaryMarketplace.MarketplaceRef,z=this.Ld.AssetMarketplace?this.Ld.AssetMarketplace.SolutionId:
null;var x=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.$w,y,z,null,null,B);const A={["addinSolutionId"]:x,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ld.OwnerAddinSolutionId,y,z,null,null,B),["ownerAddinStoreType"]:this.Ld.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};d.a.sendTelemetryEvent(Object.assign(new l.a,{name:r.Fyc+"ExecuteRequestCreate",dataFields:f.a.Uj(A)}));const I=w.a.Vh(u);u={};y={};y[e.a.dIa]=this.Ey;y[e.a.eIa]=I;y[e.a.l6c]=this.Ld;u[e.a.dsb]=
3;u[e.a.X2]=this.$w;u[e.a.h6b]=x;u[e.a.W2]=y;this.P0.fK(-1014260128,u);let F=r.A9b("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,F)}catch(B){x=r.A9b("ExecuteRequestCreate",!1,B.toString()),c.ULS.sendTraceTag(538572825,0,50,x)}return null}executeRequestUpdate(u){try{var y=this.Ld.OwnerAddinStoreType;const B=this.Ld.PrimaryMarketplace.MarketplaceRef,z=this.Ld.AssetMarketplace?this.Ld.AssetMarketplace.SolutionId:null;var x=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.$w,y,z,null,
null,B);const A={["addinSolutionId"]:x,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ld.OwnerAddinSolutionId,y,z,null,null,B),["ownerAddinStoreType"]:this.Ld.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};d.a.sendTelemetryEvent(Object.assign(new l.a,{name:r.Fyc+"ExecuteRequestUpdate",dataFields:f.a.Uj(A)}));const I=w.a.Vh(u);u={};y={};y[e.a.dIa]=this.Ey;y[e.a.eIa]=I;y[e.a.l6c]=this.Ld;u[e.a.dsb]=3;u[e.a.X2]=this.$w;u[e.a.h6b]=x;u[e.a.W2]=y;this.P0.fK(-1014260128,
u);let F=r.A9b("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,F)}catch(B){x=r.A9b("ExecuteRequestUpdate",!1,B.toString()),c.ULS.sendTraceTag(538572823,0,50,x)}return null}getButton(u){let y=null;if(!this.Pbf())return this.QBe();if(u&&0<u.length){if(!this.axe(u))return this.iCe(u);y=new m(u,this.$w,this.P0,this.Ld)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)}getTab(u){let y=null;if(!this.Pbf())return this.QBe();if(this.Ey.getOwnerAddinControlRecreated())return this.r6g();
if(u&&0<u.length){if(!this.axe(u))return this.iCe(u);y=new v(u,this.$w,this.P0,this.Ld)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(u){switch(u){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertyGetAsync(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}invokePropertySet(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
}invokePropertySetAsync(u,y){this.invokePropertySet(u,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(u){switch(u){case 1:return this.MBa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokeMethodAsync(u,y){switch(u){case 7:return this.uwh(y);case 6:return this.vwh(y);case 3:return this.yIh(y);case 5:return this.GXh(y)}u=this.invokeMethod(u,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}uwh(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,
0,"string");return this.executeRequestCreate(u)}vwh(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.executeRequestUpdate(u)}yIh(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.getButton(u)}GXh(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.getTab(u)}MBa(){this._OnAccess();return null}iCe(u){return n.a(k.a.V1g,w.a.ga(1768)+u)}QBe(){return n.a(k.a.ehj,w.a.ga(1764))}r6g(){return n.a(k.a.hostRestartNeeded,
w.a.ga(1769))}Pbf(){var u=this.Ey.getSharedRuntimeId();u=!!u&&0<u.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",u));return u}axe(u){const y=this.Xrg.getRibbonExtensionControlMap();return u in y||this.gWg(u)}gWg(u){var y=this.aAh();if(y){y=y.JIe;for(const x of y.tabs){if(x.id===u)return!0;for(const B of x.groups)for(const z of B.controls){if(z.id===u)return!0;if("Menu"===z.type){y=z;for(const A of y.items)if(A.id===u)return!0}}}}return!1}aAh(){return b.a.getInstance().nia(this.Ld.PrimaryMarketplace.MarketplaceType,
this.Ld.PrimaryMarketplace.SolutionId,1)}static A9b(u,y,x){const B={};B.methodName="DynamicRibbon."+u;B.result=y?"Succeeded":"Failed";B.message=x;return w.a.Ac(B)}}r.Fyc="Office.Online.Extensibility.Ribbon.";Object(t.a)(r,"DynamicRibbon",null,[])},952:function(t,C,a){a.d(C,"a",function(){return b});var c=a(953);const b=()=>{Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=c.a}},958:function(t,C,a){a.d(C,"a",function(){return c});
t=a(0);class c{constructor(){this.focusOnIframeWhenLoaded=!1;this.width=0;this.Xdb=this.N3=this.Tk=null;this.isFirstPartyOptOutAppContextOptmization=!1}}c.key="InsertAgaveClientSideParametersKey";Object(t.a)(c,"InsertAgaveClientSideParameters",null,[])},959:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.Wsb="extId";c.Xze="ComponentType";c.nha="ComponentId";c.Tid="HostProps";c.Kla="OptionalProps";Object(t.a)(c,"ActionPropertyNames",null,[])},961:function(t,C,a){a.d(C,"a",function(){return c});
const c=(b,d)=>{let f=!1;b&&(b=d.osfControl,(d=b.getManifest())&&d.getSharedRuntimeForCustomFunctions("Workbook")&&!b.getIsUpgrading()&&(f=!0));return f}},962:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.zga=this.QSa=this.Bdd=this.Nfd=this.Kvb=this.pUd=null}}Object(t.a)(c,"AppsForOfficeOauthResult",null,[])},966:function(t,C,a){a.d(C,"a",function(){return c});const c=(b,d)=>OfficeExtension.WacRuntime.Utility.createPromise((f,
e)=>{e(OfficeExtension.WacRuntime.Utility.createRichApiException(b,d))})}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.agave.js.map/c98bab0c0f5d4660ee548eed861f5c08/EwaDSEsNext.agave.js.map