'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1228:function(t,C,a){t=a(0);var c=a(7),b=a(15),d=a(27),f=a(86),e=a(13),k=a(84),l=a(412),m=a(78),v=a(8),n=a(67),w=a(454);class r{constructor(qa,O){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=O;this.parentElement=qa}i4g(){const qa=this.j4g();w.a(this.$,243,242,0,O=>{this.cardViewManager=O;O.z2f(this.parentElement,2,qa)})}T6e(){this.cardViewManager&&
this.cardViewManager.FKa(-1,-1,this.parentElement)}j4g(){const qa={layoutId:"AutoDetectTooltip"};qa.description=this.longDescription;qa.convertToDomainName=this.convertToDomainName;qa.longDescription=this.longDescription;qa.urlValue=this.urlValue;qa.imageAltText=this.imageAltText;qa.helpText=this.helpText;qa.helpId=this.helpId;return qa}}Object(t.a)(r,"AutoDetectCardManager",null,[]);var u=a(31),y=a(211),x=a(30),B=a(222),z=a(19),A=a(54);class I extends m.a{constructor(qa,O){super();this.ed=ea=>{if(ea.Cb.id===
this.ZHa.firstChild.id){ea=this.Ore;const R={};R.Id=ea.Tnb;this.convertToLinkedEntityManager.B1c(R,!0,ea);this.ZHa.removeChild(this.ZHa.firstChild);return!0}return!1};this.Ore=qa;this.convertToLinkedEntityManager=O;this.ZHa=document.createElement("div");this.ZHa.className="clip16x16";this.Jva=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',x.a.Eg("autodetectid"+this.Ore.left),z.a.D8c,A.a.hf(11));this.ZHa.innerHTML=this.Jva;
qa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");B.a.instance.ra(e.a.click,qa,this.ed)}get domElement(){return this.ZHa}dispose(){if(this.ZHa){const qa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");B.a.instance.Ba(e.a.click,qa,this.ed)}super.dispose()}static get RRg(){return"clip16x16"}}Object(t.a)(I,"AutoDetectColumnHeaderButton",m.a,[]);var F=a(1),U=a(1084),X=a(11),S=a(21),H=a(164);class D extends m.a{constructor(qa,O){super();this.$=qa;this.gridView=
S.g(qa);this.convertToLinkedEntityManager=O;this.n0c=new H.a}dispose(){super.dispose()}ufh(qa){for(let O of this.gridView.iha)for(let ea of O){const R=ea,oa=R.Sn,pa=U.a(R.L3);this.cAg(qa,pa,oa);R.TNd(pa)}}cAg(qa,O,ea){if(O.length){var R=ea.length;ea[R-1]<qa.left||(ea=X.HelperMethods.mx(new y.a(ea),0,R,qa.left,X.HelperMethods.iD),0>ea||!(O=O[ea]))||(this.gridView.rtl?O.classList.add(u.a.wth):O.classList.add(u.a.vth),this.n0c.mb(qa.left)||this.n0c.add(qa.left,new I(qa,this.convertToLinkedEntityManager)),
qa=this.n0c.na(qa.left).domElement,!O.getElementsByClassName(I.RRg).length&&this.bDj(O)&&O.appendChild(qa))}}bDj(qa){const O=parseInt(qa.style.width,10),ea=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";qa=gridRenderer.CanvasRendererGlobals.measureTextWidth(qa.firstChild.innerHTML,D.R5g(ea),!0,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<O-(O/2+qa/2)?!0:!1}static R5g(qa){return`${"normal"} ${"normal"} ${qa} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}
Object(t.a)(D,"AutoDetectColumnHeaderManager",m.a,[]);var J=a(421),M=a(24),G=a(65),T=a(145),K=a(12),L=a(14),V=a(171),W=a(69);a.d(C,"a",function(){return da});class da extends m.a{constructor(qa,O,ea,R){super();this.isMac=d.a.isMac;this.GXa=-1;this.P3b=null;this.Nsa=-1;this.eN=this.Bhc=this.CRd=this.FZ=this.Pre=!1;this.jT=null;this.yg=()=>{this.Tva&&this.gridView&&this.mW()};this.Ec=()=>{this.Tx()};this.ed=()=>{this.ZGa();S.g(this.$).hg(!0,!1)};this.x5=(pa,Pa)=>{Pa?(this.Nbg(this.P3b),this.fdb()):
(pa=[29],this.gridView.lb.Mg(pa),this.gridView.lb.oi(null,pa),this.jT&&this.jT.T6e())};this.Yi=()=>{this.h6a()&&this.Eh.hide();1===this.gridView.ha.Je&&this.mW()};this.ZQ=()=>{const pa=this.gridView.ha.Je;this.gridView.ha.sa.activeCell&&1===pa&&this.mW()};this.onKeyUp=pa=>this.UAb?this.FZ?!1:17===pa.Ca.keyCode&&this.CRd?(this.eN?(this.fdb(),this.Wca()):this.kKb(),!0):!1:this.FZ=!1;this.onKeyDown=pa=>{if(!this.UAb)return this.FZ=!1;this.CRd=!1;this.FZ=pa.ctrlKey;switch(pa.Ca.keyCode){case 27:return this.eN?
(this.x5(null,!1),this.Wca()):this.jT&&(this.jT.T6e(),this.kKb()),!0;case 13:if(this.eN)return this.eN=!1,this.ZGa(),!0;break;case 17:return this.CRd=!0}return!1};const {AutoDetectActionButton:oa}=a(1336);this.$=qa;this.Unb=F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);O||b.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.convertToLinkedEntityManager=R;R.PFb();this.Eh=new oa(qa,O,this.ed,ea,
"");this.sMg=new D(this.$,R);this.gridView=S.g(this.$);this.gridView.ha.cT(this.yg);this.gridView.Xb.YXa(this.yg);this.gridView.Ku(this.ZQ);qa.kk(this.Ec);qa.EA(this.Yi);this.gridBlockManager=Object(k.a)(580,this.gridView.Ea);this.Fq=qa.frame.xt;this.mW()}get mc(){return this.Eh.domElement(1)}get UAb(){const qa=this.Eh.domElement(da.bea);return qa?K.DOMElementExtensions.isVisible(qa):!1}get Tva(){return this.$.isEditMode&&F.EwaSettings.ma(135)&&F.EwaSettings.ma(138)&&(new T.a(this.$.xa)).li?!1:-1!==
this.Nsa}dispose(){this.gridView&&this.gridView.ha.rR(this.yg);if(this.$){const qa=this.$;qa.zl(this.Ec);qa.zD(this.Yi);S.g(qa).py(this.ZQ)}f.a.Ia(this.Eh);this.Fq=this.$=this.gridView=this.Eh=null;super.dispose()}Tx(){this.x5(null,!1);this.GXa=-1;this.Eh.hide();this.nOj();this.eN=!1}Wca(){this.Eh.getButton(da.bea).obb();this.eN=!1}kKb(){this.Eh.getButton(da.bea).JFb();this.Nbg(this.P3b);this.eN=!0;this.$.da.Za(211,qa=>{qa.pPa(L.a.instance.ga(1748))})}onAutoDetectUIShown(){if(this.Tva&&-1!==this.GXa)this.convertToLinkedEntityManager.onAutoDetectUIShown()}tMg(qa){var O=
new M.Range(1===qa.top?1:qa.top-1,qa.left,qa.bottom,qa.right,!0,!1);O=this.gridView.getRangeInformation(O);for(const ea of O)if(Object(l.a)(J.AutoDetectRange,ea)&&this.vec(qa,!1,ea))return!0;return!1}ZGa(){if(this.Tva&&-1!==this.GXa){this.Eh.getButton(da.bea).JFb();var qa={};qa.Id=this.Nsa;qa.StringId=null;this.convertToLinkedEntityManager.B1c(qa,!0,this.P3b);b.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");qa=[Object(c.a)(new W.a,{name:"Domain",
int64:this.Nsa})];V.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,qa);this.Nsa=-1}}xIh(){let qa=L.a.instance.ga(1744);if(-1!==this.Nsa){qa+=" ";try{qa+=this.convertToLinkedEntityManager.oAb(this.Nsa.toString())}catch(O){b.ULS.sendTraceTag(537166982,0,10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.Nsa}`)}}qa+=" ";return qa=this.Unb?qa+L.a.instance.ga(1747):qa+L.a.instance.ga(this.isMac?1746:1745)}fdb(){this.Unb&&(this.jT||(this.jT=new r(this.mc,
this.$),this.jT.convertToDomainName=L.a.instance.ga(1749),this.jT.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.jT.imageAltText=L.a.instance.ga(1751),this.jT.helpId="HID_DataTypes_Wolfram",this.jT.helpText=L.a.instance.ga(1750)),this.jT.longDescription=this.convertToLinkedEntityManager.sVd(this.GXa.toString()),this.jT.i4g())}vec(qa,O,ea){if((new M.Range(ea.top,ea.left,ea.bottom===v.a.dh?ea.bottom:ea.bottom+1,ea.right,!0,!1)).Dd(qa)){if(O){if(ea&&
ea.Tnb!==this.GXa){this.GXa=ea.Tnb;qa=ea.Tnb.toString();O=this.Unb?"":this.convertToLinkedEntityManager.sVd(qa);const R=this.convertToLinkedEntityManager.J6h(qa);this.Eh.Web(this.convertToLinkedEntityManager.oAb(qa),O,R,da.bea)}this.Nsa=ea.Tnb;this.P3b=ea}return!0}return!1}mW(){if(this.convertToLinkedEntityManager){var qa=this.gridView.ha.Je;if(this.gridBlockManager&&this.gridBlockManager.uhd){var O=this.gridView.ha.sa.activeCell,ea=!this.gridBlockManager.Sr(O),R=this.gridView.getRangeInformation(this.gridView.gi);
for(const oa of R)if(Object(l.a)(J.AutoDetectRange,oa))switch(R=oa,R.UWg){case 3:if(this.vec(O,!0,R)){if(1!==qa||ea){this.Tx();return}b.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.$Gd();this.Eh.hAa(O,this.x5);this.Pre||(this.Pre=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(F.EwaSettings.ma(471)||F.EwaSettings.ma(472))&&this.sMg.ufh(R);break;default:b.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.Tx()}}Nbg(qa){const O=
[29];this.gridView.lb.oi(qa,O);this.gridView.lb.zn(O)}h6a(){return this.$.ea.isNamedObjectViewMode&&G.f(this.$.pa)}$Gd(){this.Unb&&!this.Bhc&&this.Fq&&(this.Fq.pt(e.a.Kb,this.$.domElement,this.onKeyDown,!0),this.Fq.pt(e.a.Fd,this.$.domElement,this.onKeyUp,!0),this.Bhc=!0)}nOj(){this.Unb&&this.Bhc&&this.Fq&&(this.Fq.At(e.a.Kb,this.$.domElement,this.onKeyDown,!0),this.Fq.At(e.a.Fd,this.$.domElement,this.onKeyUp,!0),this.Bhc=!1)}static get bea(){return 1}static DKh(qa){return L.a.instance.ga(1805)+n.a.space+
qa}}Object(t.a)(da,"AutoDetectManager",m.a,[])},1336:function(t,C,a){a.r(C);a.d(C,"AutoDetectActionButton",function(){return e});t=a(0);C=a(78);var c=a(1228),b=a(54),d=a(14),f=a(21);class e extends C.a{constructor(k,l,m,v,n){super();this.$=k;this.jo=v.u3b(k,l,m,"",b.a.hf(11),n,"AutoDetectPointerDown",d.a.instance.ga(1805)+"...")}get jz(){return this.jo.jz}dispose(){this.jo.dispose();this.$=null;super.dispose()}domElement(k){return this.jo.domElement(k)}getButton(k){return this.jo.getButton(k,!1)}Web(k,
l,m,v){this.jo.pTa(c.a.DKh(k),l,v);this.jo.Icg(m,l,v)}hAa(k,l){const m=f.g(this.$),v=m.ib.Vi(k);k=m.mg(k,v);const n=m.Lf(v).Mm;if(k&&0<=k.x&&0<=k.y&&n.width>k.width+160){let w=k.bottomRight.x+this.jz,r=k.topLeft.y+this.jz,u=!1;w+160>n.bottomRight.x&&(w=k.topLeft.x-this.jz,u=!0);if(r<n.topLeft.y+this.jz){if(m.ib.VSa){this.hide();return}r=n.topLeft.y+this.jz}this.jo.u6b(l,v);this.Bp(w,r,m.rtl,v,u)}else this.hide()}Bp(k,l,m,v,n){this.jo.Bp(k,l,m,v,!1,n)}hide(){this.jo.hide()}}Object(t.a)(e,"AutoDetectActionButton",
C.a,[])},1442:function(t,C,a){a.r(C);t=a(0);var c=a(691),b=a(15),d=a(5),f=a(77),e=a(37),k=a(1),l=a(182),m=a(21),v=a(171);class n{constructor(G,T){this.$=T;this.convertToLinkedEntityManager=G}Nc(G,T){switch(T){case -1203788282:case 48568533:case -1662108744:return G=m.g(this.$),T=this.convertToLinkedEntityManager.Zyi||7E3,(null===G||void 0===G?0:G.ha)&&G.ha.sa.Wc.WG>T?!0:!1;default:return!1}}executeCommand(G,T,K){G=e.TaskExtensions.fk();T=T.command;switch(T){case -1203788282:this.convertToLinkedEntityManager.D2g(K[f.a.Pc].toString());
break;case 311599363:this.convertToLinkedEntityManager.convertLinkedEntityToText();break;case 439914789:this.convertToLinkedEntityManager.refreshLinkedEntitiesInRange();break;case 2127195269:this.convertToLinkedEntityManager.launchDisambiguationPaneForSearch();break;case -1662108744:this.convertToLinkedEntityManager.launchLinkedEntityDataTypeSelectorPane(K[f.a.Pc].toString());break;case 1266950951:this.convertToLinkedEntityManager.dqi();break;case 49813714:this.convertToLinkedEntityManager.convertToLinkedEntityFromAutoDetect();
break;case -1081442996:k.EwaSettings.ma(648)&&this.convertToLinkedEntityManager.OJe();break;case 1702917262:k.EwaSettings.ma(648)&&this.convertToLinkedEntityManager.showHelpArticle(d.a.EPj);break;case -90814711:k.EwaSettings.ma(648)&&this.convertToLinkedEntityManager.showUntrustedImageBusinessBarIfNecessary();break;case 48568533:case -1027730316:if(48568533===T||K[f.a.zjf]&&"ConvertToLinkedEntityGallery"===K[f.a.zjf].toString())b.ULS.sendTraceTag(559982275,0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),
v.a("ExpandDataTypeGallery");break;default:G=l.a(T)}return G}Cc(G,T){switch(T.command){case -1203788282:case 439914789:case 2127195269:case 49813714:return k.EwaSettings.ma(130);case -1081442996:case 1702917262:case -90814711:return k.EwaSettings.ma(648);case 48568533:case -1027730316:case -1662108744:case 311599363:case 1266950951:return!0;default:return!1}}Rc(G,T,K){return"PopulateConvertToLinkedEntityMenu"===T&&k.EwaSettings.ma(130)?this.convertToLinkedEntityManager.Rc(G,T,K):!1}}Object(t.a)(n,
"ConvertToLinkedEntityCommandHandler",null,[195]);var w=a(454);class r extends c.a{constructor(G){super(G)}yd(){w.a(this.$,271,272,this.hb,G=>{this.gd([new n(G,this.$)])})}static ka(G){c.a.Nd(273,new r(G))}}Object(t.a)(r,"ConvertToLinkedEntityCommandHandlerFactory",c.a,[]);C=a(221);var u=a(756),y=a(50),x=a(413),B=a(696);class z extends C.a{constructor(G){super();this.$=G;this.Fb()}create(){const G=y.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.hb),T=y.GetServiceTaskFactory.Ra(this.$.da,
5,4,this.hb),K=y.GetServiceTaskFactory.Ra(this.$.da,388,387,this.hb);if(this.$.Ml)e.TaskExtensions.Aa(e.TaskExtensions.Wd([G,T,K],this.la),()=>{const L=Object(B.a)(this.$.da,271,()=>new u.ConvertToLinkedEntityManager(this.$,G.result,K.result,null,null,T.result));this.qb(L)},this.$.la,3);else{const L=y.GetServiceTaskFactory.Ra(this.$.da,257,258,this.hb),V=x.a(this.$);e.TaskExtensions.Aa(e.TaskExtensions.Wd([G,L,V,T,K],this.la),()=>{this.qb(this.$.da.za(271)||new u.ConvertToLinkedEntityManager(this.$,
G.result,K.result,L.result,V.result,T.result))},this.$.la,3)}}static ka(G){G.da.Ga(272,new z(G))}}Object(t.a)(z,"ConvertToLinkedEntityManagerFactory",C.a,[]);var A=a(235),I=a(258),F=a(33),U=a(245),X=a(12),S=a(700);const H=a(19).a.cth;class D extends A.a{constructor(G,T,K){super(G);this.su=0;this.Cp=!1;this.Ec=()=>{this.ig(!1)};this.$=T;this.taskPaneManager=K;I.a(T).Xh(this);this.$.kk(this.Ec);F.a.Ad(this.$)&&(this.isVisible=!1)}dP(G){this.get_events().addHandler("EnrichmentTaskPaneRemoved",G)}qR(G){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",
G)}mE(G){this.addHandler("EnrichmentTaskPaneVilibilityChanged",G)}SF(G){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",G)}zFg(G){this.addHandler("EnrichmentTaskPaneOnFocus",G)}vbj(G){this.removeHandler("EnrichmentTaskPaneOnFocus",G)}get isVisible(){return super.isVisible}set isVisible(G){super.isVisible=G;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get kf(){return this.isVisible}get $d(){return U.a.nkh}get Yg(){return 10}get Tk(){return H}get RM(){return this.titleText}get titleText(){return"Enrichment"}get wo(){return 300}get isResizable(){return!1}get mc(){return this.domElement}get height(){return this.taskPaneManager.oO.offsetHeight}get GB(){return this.taskPaneManager.rua(this.mc,
this.titleText,this.wo,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.wo)}BH(){}lp(){return this.Cp}Zr(){return this.Cp}dR(){}dispose(){this.$&&this.$.zl(this.Ec);this.taskPaneManager=this.$=null;super.dispose()}hg(G,T){T||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!T}kh(G){return X.DOMElementExtensions.vf(this.mc,G)}lj(){}Nj(){}ig(G){this.Cp=G;const T=this.taskPaneManager;this.isVisible=G;F.a.Ad(this.$)?G?this.taskPaneManager.O5("EnrichmentTaskPane",
this.GB):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(G&&0<T.$z.length&&(!T.Bg||10!==T.Bg.taskPane.Yg||T.isCollapsed)&&T.VF(this,!0),T.Pw());G||(m.g(this.$).hg(!0,!1),this.$.qf())}mQ(){return!1}static ka(G,T){var K=G.Bb;let L=document.getElementById(K+d.a.lKe);L||(L=S.a("div",G.Bb+d.a.lKe,"cui-taskpane"),F.a.Ad(G)||(K=document.getElementById(K+d.a.WQ),void 0!==K&&null!==K?K.appendChild(L):b.ULS.sendTraceTag(537166720,0,10,`EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: ${G.aD}`)));
K=G.da;return K.za(257)||K.Ga(257,new D(L,G,T))}}Object(t.a)(D,"EnrichmentTaskPane",A.a,[579,2,401,102]);class J extends C.a{constructor(G){super();this.eh=this.ri=null;this.$=G;this.Fb()}get pD(){this.ri||(this.ri=e.TaskExtensions.Aa(x.a(this.$),G=>{this.eh=D.ka(this.$,G.result)},this.la,3));return this.ri}create(){const G=y.GetServiceTaskFactory.create(this.$.da,203,this.la,this.hb),T=y.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb);e.TaskExtensions.Aa(e.TaskExtensions.ts(e.TaskExtensions.Wd([G,
T],this.la),()=>this.pD,this.la),()=>{this.qb(this.eh)},this.la,3)}dispose(){this.eh=this.ri=this.$=null;super.dispose()}static ka(G){G.da.Ga(258,new J(G))}}Object(t.a)(J,"EnrichmentTaskPaneFactory",C.a,[]);var M=a(10);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Enrichment");(()=>{M.a.Fa(G=>{J.ka(G);z.ka(G);r.ka(G)})})()},756:function(t,C,a){a.r(C);var c=a(0),b=a(15),d=a(86),f=a(262),e=a(4),k=a(30),l=a(811),m=a(136),v=a(82),n=a(84),w=a(38),r=a(19),u=a(5),y=a(160),x=a(1228),B=
a(1231),z=a(172),A=a(555),I=a(341),F=a(61);const U=(zb,ic,Qb,wb,hc,Za=null)=>{Za=zb.Na(1,Za);return F.g(zb,"GetRichDataClassificationLabels",Za,ic,Qb,wb,hc,4)},X=(zb,ic,Qb,wb,hc,Za,ub,uc,Oc=null)=>{Oc=zb.Na(1,Oc);Oc.selectedRanges=ic;Oc.domainId=Qb;Oc.autodetect=wb;return F.g(zb,"ConvertToLinkedEntity",Oc,hc,Za,ub,uc,4)},S=(zb,ic,Qb,wb,hc,Za=null)=>{Za=zb.Na(1,Za);return F.g(zb,"OnAutoDetectUIShown",Za,ic,Qb,wb,hc,4)},H=(zb,ic,Qb,wb,hc,Za=null)=>{Za=zb.Na(1,Za);return F.g(zb,"GetLinkedEntityMetadata",
Za,ic,Qb,wb,hc,4)},D=(zb,ic,Qb,wb,hc,Za,ub=null)=>{ub=zb.Na(1,ub);ub.selectedRanges=ic;return F.g(zb,"ConvertLinkedEntityToText",ub,Qb,wb,hc,Za,4)},J=(zb,ic,Qb,wb,hc,Za,ub=null)=>{ub=zb.Na(1,ub);ub.selectedRanges=ic;return F.g(zb,"RefreshLinkedEntitiesInRange",ub,Qb,wb,hc,Za,4)},M=(zb,ic,Qb,wb,hc,Za,ub,uc,Oc,Bb,Nb=null)=>{Nb=zb.Na(1,Nb);Nb.selectedRanges=ic;Nb.isChangeObject=Qb;Nb.isFloodgateEnabled=wb;Nb.isStarterData=hc;Nb.starterDataDomainId=Za;return F.g(zb,"GetDataSelectorPaneData",Nb,ub,uc,
Oc,Bb,4)},G=(zb,ic,Qb,wb,hc,Za,ub,uc=null)=>{uc=zb.Na(9,uc);uc.activeCell=ic;uc.selectionIndex=Qb;return F.g(zb,"SelectLinkedEntityForDisambiguation",uc,wb,hc,Za,ub,4)},T=(zb,ic,Qb,wb,hc,Za,ub,uc,Oc,Bb,Nb,dc=null)=>{dc=zb.Na(1,dc);dc.searchCell=ic;dc.searchQuery=Qb;dc.isFloodgateEnabled=wb;dc.isStarterData=hc;dc.starterDataDomainId=Za;dc.starterDataDomainIdString=ub;return F.g(zb,"LinkedEntitySearch",dc,uc,Oc,Bb,Nb,4)},K=(zb,ic,Qb,wb,hc,Za,ub,uc,Oc=null)=>{Oc=zb.Na(1,Oc);Oc.cell=ic;Oc.starterDataDomainId=
Qb;Oc.starterDataDomainIdString=wb;return F.g(zb,"InsertStarterDataTable",Oc,hc,Za,ub,uc,4)},L=(zb,ic,Qb,wb,hc,Za,ub,uc=null)=>{uc=zb.Na(1,uc);uc.activeCell=ic;uc.isBackward=Qb;return F.g(zb,"MoveToNextAmbiguousLinkedEntity",uc,wb,hc,Za,ub,4)},V=(zb,ic,Qb,wb,hc,Za,ub=null)=>{ub=zb.Na(9,ub);ub.activeCell=ic;return F.g(zb,"CancelSearchLinkedEntity",ub,Qb,wb,hc,Za,4)},W=(zb,ic,Qb,wb,hc,Za,ub,uc=null)=>{uc=zb.Na(1,uc);uc.selectedRanges=ic;uc.letyDomainId=Qb;return F.g(zb,"GetDataTypeSelectorData",uc,
wb,hc,Za,ub,4)},da=(zb,ic,Qb,wb,hc,Za=null)=>{Za=zb.Na(1,Za);return F.g(zb,"GetErrorMessageForLinkedDataTypeRefresh",Za,ic,Qb,wb,hc,4)},qa=(zb,ic,Qb,wb,hc,Za=null)=>{Za=zb.Na(1,Za);return F.g(zb,"GetHasUntrustedImageUrls",Za,ic,Qb,wb,hc,4)},O=(zb,ic,Qb,wb,hc,Za=null)=>{Za=zb.Na(1,Za);return F.g(zb,"LinkedEntitiesEnableUntrustedImages",Za,ic,Qb,wb,hc,0)},ea=(zb,ic,Qb,wb,hc,Za=null)=>{Za=zb.Na(1,Za);return F.g(zb,"LinkedEntityTryAutoRefresh",Za,ic,Qb,wb,hc,0)};var R=a(83),oa=a(700),pa=a(784);class Pa{}
Pa.D6h="EnrichmentContentFrame";Pa.width=320;Object(c.a)(Pa,"EnrichmentConstants",null,[]);class Z{constructor(zb){this.messageType=0;this.messageType=zb}}Object(c.a)(Z,"EnrichmentResponseMessage",null,[]);class Ra extends Z{constructor(zb,ic){super(zb);this.messageContent=null;this.messageContent=ic}}Object(c.a)(Ra,"EnrichmentResponseMessageWithContent",Z,[]);class Ga extends Ra{constructor(zb,ic,Qb){super(zb,ic);this.telemetryJson=null;this.telemetryJson=Qb}}Object(c.a)(Ga,"EnrichmentResponseMessageWithContentAndTelemetryData",
Ra,[]);var Ba=a(259),fa=a(13),Y=a(94),ja=a(44),ca=a(85),aa=a(108),ta=a(41),xa=a(80),ia=a(27),ya=a(106),ib=a(692),wa=a(25);class sa{constructor(zb,ic,Qb,wb,hc){this.Wq=this.gk=this.e7d=this.d7d=this.Iv=this.Du=null;this.Ww=!1;this.Ai=zb;this.Xd=ic;this.OO=Qb;this.Zb=wb;this.La=hc;this.opa=aa.KeyInputManager.tl(ca.a.rBa,0)}get QKb(){return!0}get ssb(){return e.AFrameworkApplication.fa.Va("EnrichmentPaneUrl")}dispose(){this.QKb&&this.Wq&&(this.Ai.Ba(fa.a.click,this.Wq,Object(R.a)(this,this.$j,"onClosePaneClick")),
this.Xd.Ba(fa.a.Fd,this.Wq,Object(R.a)(this,this.iyf,"onKeyHide")));this.Wq=null;this.Iv&&(this.TOj(),this.Iv.parentNode.removeChild(this.Iv),this.Iv=null);this.Zb.vi("EnrichmentPaneId").vk(this.opa)}show(zb,ic,Qb){this.Du=zb;this.Ww||(this.gk=this.f0a(),this.ada.appendChild(this.gk),this.J7i(),this.La.Ob(wa.a.sye,ya.a.frame,Object(R.a)(this,this.o1h,"handleEscapeKeyAction")),this.sRa(),this.Ww=!0);this.Iv.src=this.ssb&&this.ssb.length?this.ssb+"?culture="+ic.market+"&appName="+ic.applicationName+
"&themeId="+ic.themeId+"&featuresBitMask="+ic.featuresBitMask:sa.Xrf;this.d7d=ic;this.e7d=Qb;this.$cb()}CAc(zb,ic){zb=new Ga(2,zb,ic);this.Voc(zb)}sRa(){const zb=this.Zb.vi("EnrichmentPaneId");zb.parent=Ba.AFrame.tNa;this.Ai.nmb("EnrichmentPaneId",this.gk);zb.bindAction(this.opa,wa.a.sye)}VYf(){if(this.Iv){Y.FocusManager.Una(this.Iv.contentWindow);const zb=new Ga(4,null,null);this.Voc(zb)}}$j(){this.B1b();return!0}iyf(zb){zb=zb.Ca.keyCode;return zb===Sys.UI.Key.enter||zb===Sys.UI.Key.space?(this.B1b(),
!0):!1}B1b(){this.hide();if(this.Du)this.Du.onPaneClosed()}f0a(){const zb=oa.a("div","EnrichmentPaneId","EnrichmentPane");this.QKb&&zb.appendChild(this.C2c());this.r$h(zb);return zb}C2c(){const zb=oa.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),ic=oa.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");ic.innerText=CommonUIStrings.l_EnrichmentPaneTitle;ic.title=CommonUIStrings.l_EnrichmentPaneTitle;const Qb=pa.a.pb("CloseEnrichmentPane","EnrichmentPaneCloseButton",
CommonUIStrings.l_Close,"ClosePaneGlyph_16x16x32",!1);this.Ai.ra(fa.a.click,Qb,Object(R.a)(this,this.$j,"onClosePaneClick"));this.Xd.ra(fa.a.Fd,Qb,Object(R.a)(this,this.iyf,"onKeyHide"));zb.appendChild(ic);zb.appendChild(Qb);this.Wq=Qb;return zb}r$h(zb){this.Iv=oa.b("iframe","","EnrichmentFrame");zb.appendChild(this.Iv);this.Iv.id=Pa.D6h;this.Iv.setAttribute("role","presentation")}J7i(){ja.a.addHandler(this.Iv,"load",Object(R.a)(this,this.Kxf,"onIFrameLoad"));ja.a.addHandler(this.Iv,"error",Object(R.a)(this,
this.kmc,"onIFrameError"));$addHandler(window,"message",Object(R.a)(this,this.Lxf,"onIFrameMessage"))}TOj(){ja.a.removeHandler(this.Iv,"load",Object(R.a)(this,this.Kxf,"onIFrameLoad"));ja.a.removeHandler(this.Iv,"error",Object(R.a)(this,this.kmc,"onIFrameError"));$removeHandler(window,"message",Object(R.a)(this,this.Lxf,"onIFrameMessage"))}rbh(){this.Iv.src=sa.Xrf}hide(){this.zcc();this.rbh()}o1h(zb,ic,Qb){if(1!==Qb&&(this.hide(),this.Du))this.Du.onPaneClosed();return 32}Kxf(){}kmc(){}Lxf(zb){zb=
zb.rawEvent;if(!this.Iv||-1!==this.Iv.src.indexOf(zb.origin)){try{var ic=ta.a(zb.data)}catch(Qb){return}if(!ib.c(ic.messageType)){zb=window.g_badCastCallback;window.g_badCastCallback=null;switch(ic.messageType){case 2:this.Voc(new Ga(1,ta.c(this.d7d),this.e7d));break;case 1:this.Voc(new Ra(0,this.UGh()));break;case 3:this.Du&&this.Du.selectEntity(ic.messageContent);break;case 5:this.Du&&this.Du.vCb(ic.messageContent);break;case 8:this.Du&&(ic=ta.a(ic.messageContent),0<ic.DomainId?this.Du.$Ld(ic.Query,
ic.TelemetryJson,ic.DomainId,ic.DomainIdString):this.Du.searchEntity(ic.Query,ic.TelemetryJson));break;case 6:this.Du&&this.Du.cancelSearch();break;case 11:ic=ta.a(ic.messageContent);ic=sa.q3b("keydown","f6",ca.a.ICc,!0,!1,ic,!0,!1);this.Iv&&this.Iv.dispatchEvent(ic);break;case 12:if(ta.a(ic.messageContent).keyCode===ca.a.uL&&(ic=sa.q3b("keydown","esc",ca.a.uL,!0,!1,!1,!1,!1),this.Iv&&(this.Iv.dispatchEvent(ic),this.hide(),this.Du)))this.Du.onPaneClosed();break;case 13:this.Du&&this.Du.selectDataType(ic.messageContent);
break;case 14:this.Du&&this.Du.showHelpArticle(ic.messageContent);break;case 15:this.Du&&this.Du.showSurveyDialog(ic.messageContent);break;case 16:this.Du&&(ic=ta.a(ic.messageContent),this.Du.insertTable(ic.DomainId,ic.DomainIdString))}window.g_badCastCallback=zb}}}UGh(){return ta.c([2,1,3,5,8,6])}Voc(zb){zb=ta.c(zb);this.Iv.contentWindow.postMessage(zb,xa.a.naa(this.ssb))}static q3b(zb,ic,Qb,wb,hc,Za,ub,uc){ia.a.kv?(Za=String.format("{0} {1} {2}",Za?"Shift":"",ub?"Control":"",uc?"Alt":""),Za.trim(),
Qb=document.createEvent("KeyboardEvent"),Qb.initKeyboardEvent(zb,wb,hc,window.self,ic,0,Za,!1,"en-US")):(ic={},ic.keyCode=Qb,ic.ctrlKey=ub,ic.shiftKey=Za,ic.altKey=uc,ic.bubbles=wb,ic.cancelable=hc,Qb=new KeyboardEvent(zb,ic));return Qb}}sa.Xrf="about:blank";Object(c.a)(sa,"EnrichmentPane",null,[649,2]);class Ya extends sa{constructor(zb){super(e.AFrameworkApplication.ta.zy,e.AFrameworkApplication.ta.xt,e.AFrameworkApplication.ta.Mda,e.AFrameworkApplication.ta.Ee,e.AFrameworkApplication.wb);this.taskPane=
zb;this.taskPane.zFg(this.VYf)}get ada(){return this.taskPane.mc}set ada(zb){this.taskPane.mc.innerHTML=zb.innerHTML}$cb(){this.taskPane.isVisible||this.taskPane.ig(!0)}zcc(){this.taskPane.ig(!1)}dispose(){this.taskPane&&(this.taskPane.vbj(this.VYf),this.taskPane=null);super.dispose()}}Object(c.a)(Ya,"EnrichmentTaskPaneWrapper",sa,[]);class bb{constructor(zb){this.Fy=null;this.Oea=zb}gqi(zb,ic){this.Fy=zb;this.Oea&&this.Oea.show(this,ic,null)}CAc(zb,ic){this.Oea&&this.Oea.CAc(zb,ic)}Owb(){this.Oea&&
this.Oea.hide()}dispose(){this.Oea&&(this.Oea.dispose(),this.Oea=null)}selectEntity(zb){return this.Fy?this.Fy.selectEntity(zb):!1}searchEntity(zb,ic){this.Fy&&this.Fy.searchEntity(zb,ic)}$Ld(zb,ic,Qb,wb){this.Fy&&this.Fy.$Ld(zb,ic,Qb,wb)}vCb(zb){return this.Fy?this.Fy.vCb(zb):!1}onPaneClosed(){if(this.Fy)this.Fy.onPaneClosed()}cancelSearch(){this.Fy&&this.Fy.cancelSearch()}selectDataType(zb){this.Fy&&this.Fy.selectDataType(zb)}showHelpArticle(zb){this.Fy&&this.Fy.showHelpArticle(zb)}showSurveyDialog(zb){this.Fy&&
this.Fy.showSurveyDialog(zb)}insertTable(zb,ic){this.Fy&&this.Fy.insertTable(zb,ic)}}Object(c.a)(bb,"EnrichmentManager",null,[648,2]);class mb extends bb{constructor(zb){super(zb)}dispose(){super.dispose()}}Object(c.a)(mb,"ExcelEnrichmentManager",bb,[]);var Ca=a(14);class $a{constructor(zb){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=
null;this.campaignId=zb;this.commentQuestion=Ca.a.instance.ob(198);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=Ca.a.instance.ob(194);this.ratingValuesAscending=[Ca.a.instance.ob(195),Ca.a.instance.ob(196),Ca.a.instance.ob(197)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=Ca.a.instance.ob(193)}}Object(c.a)($a,"FloodgateSurvey",null,[]);var Kb=a(24),rb=a(77),cc=a(415),nc=a(43),Wb=a(368),Ea=a(170),ua=a(33),ma=a(90),fb=a(29),sb=a(1),
Ua=a(280),ab=a(21);class na{constructor(){this.market=this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(c.a)(na,"EnrichmentMessageContentAppProperties",null,[]);class Na{constructor(zb,ic,Qb,wb,hc){this.ota=this.ZGe=!1;this.Wbb=this.lwa=!0;this.SEb=this.YKb=!1;this.ldb=null;this.eoc=0;this.ZQ=()=>{(this.Wbb||this.ota)&&2!==this.eoc&&(this.SEb||this.Qrd(!1))};this.Xc=
()=>{b.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};this.FHi=Za=>{fb.a.rg(Za.Errors)?(Za=fb.a.yc(Za.Errors),Za.includes("OperationSucceededWithAlert")?b.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):b.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${Za}`)):Za.Result&&(this.$.ea.Ik(this.Xc),this.$.ea.jk(this.Xc),Za=Za.Result,this.ldb=Za.SkydanceFeatureBitmask,this.Tvd(Za),this.YKb=
!0)};this.yg=()=>{(this.Wbb||this.ota)&&this.Qrd(!1)};this.emc=(Za,ub)=>{fb.a.rg(Za.Errors)?b.ULS.sendTraceTag(36975688,0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${fb.a.yc(Za.Errors)}`):Za.Result&&(Za=Za.Result,Za.DisambiguationJson?(this.YKb=!1,this.TZf(ub),this.ldb=Za.SkydanceFeatureBitmask,ub=Za.DisambiguationJson,b.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),
this.SEb=!1,this.xjf(ub)):b.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};this.eKi=(Za,ub)=>{fb.a.rg(Za.Errors)?(ub=fb.a.yc(Za.Errors),b.ULS.sendTraceTag(36975689,0,10,`Failed to retrieve disambiguation data for search. errors: ${ub}`)):Za.Result&&(Za=Za.Result,Za.DisambiguationJson?(this.TZf(ub),this.ldb=Za.SkydanceFeatureBitmask,ub=Za.DisambiguationJson,b.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),
this.SEb=!0,this.xjf(ub)):b.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.NNi=Za=>{fb.a.rg(Za.Errors)?(Za=fb.a.yc(Za.Errors),b.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${Za}`),this.Wbb=!0):Za.Result&&(Za=Za.Result,this.ldb=Za.SkydanceFeatureBitmask,this.Tvd(Za),this.YKb=!0)};this.CQi=Za=>{if(fb.a.rg(Za.Errors)){const ub=fb.a.yc(Za.Errors);b.ULS.sendTraceTag(36975691,
0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${ub}`)}Za.Result?(this.Tvd(Za.Result),this.YKb=!0):this.nsa()};this.CBf=Za=>{fb.a.rg(Za.Errors)?(Za=fb.a.yc(Za.Errors),b.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${Za}`)):Za.Result?this.C6b.CAc(Za.Result,null):(b.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.nsa())};
this.tMi=Za=>{fb.a.rg(Za.Errors)?(Za=fb.a.yc(Za.Errors),b.ULS.sendTraceTag(537166926,0,15,`Failed to insert starter data table. Error id names: ${Za}`)):this.nsa()};this.$=zb;this.gridView=ab.g(this.$);this.gridView.ha.cT(this.yg);this.gridView.Ku(this.ZQ);this.LKe=wb;this.convertToLinkedEntityManager=hc;ua.a.Ad(this.$)||Qb.uQ(ic);zb=new Ya(ic);this.C6b=new mb(zb);v.a.instance.Wb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Za=>{Za.isFeatureEnabled("mso_sendASmile",!0).then(ub=>
{this.lwa=ub;return null})})}dispose(){this.$&&(this.gridView.ha.rR(this.yg),this.gridView.py(this.ZQ))}selectEntity(zb){const ic=nc.o(this.gridView.ha.sa.activeCell,this.$),Qb=()=>new cc.a;Wb.a(this.$.userOperationManager,(wb,hc,Za)=>G(this.$.oa.va,ic,zb,Ua.b(wb,this.CQi),hc,Za,null),wb=>new Ea.a(109,0,wb,void 0,Qb),null);return!0}searchEntity(zb,ic,Qb=!1,wb=0,hc=null){b.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${ic}`);const Za=
nc.o(this.gridView.ha.sa.activeCell,this.$);Wb.a(this.$.userOperationManager,(ub,uc,Oc)=>T(this.$.oa.va,Za,zb,this.lwa,Qb,wb,hc,Ua.b(ub,this.CBf),uc,Oc,null),ub=>new Ea.a(110,0,ub,16),null)}vCb(zb){const ic=nc.o(this.gridView.ha.sa.activeCell,this.$);this.Wbb=!1;Wb.a(this.$.userOperationManager,(Qb,wb,hc)=>L(this.$.oa.va,ic,zb,Ua.b(Qb,this.NNi),wb,hc,null),Qb=>new Ea.a(111,0,Qb,16),null);return!0}onPaneClosed(){this.ota=!1;this.ZGe=!0;this.eoc=0;this.SEb=!1}cancelSearch(){const zb=this.rMd();zb&&
Wb.a(this.$.userOperationManager,(ic,Qb,wb)=>V(this.$.oa.va,zb,Ua.b(ic,this.CBf),Qb,wb,null),ic=>new Ea.a(112,0,ic,16),null)}selectDataType(zb){b.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.nsa();if(zb&&zb.length)if(zb=JSON.parse(zb))if(null==zb.domainId)b.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var ic={};ic.Id=zb.domainId;ic.StringId=zb.stringId;
this.convertToLinkedEntityManager.convertToLinkedEntity(ic)}else b.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else b.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}showHelpArticle(zb){const ic=new ma.a(-859308420,rb.a.Eb,this.$.Mc,9,null);this.$.Ka.Mb(ic,{[rb.a.Zf]:"HelpID="+zb,["InputMethod"]:rb.a.Eb,["ShouldCanvasTakeFocus"]:!0,[rb.a.Pc]:u.a.oQ})}showSurveyDialog(zb){B.a.xLb(new $a(zb))}insertTable(zb,
ic){const Qb=this.rMd();Qb&&Wb.a(this.$.userOperationManager,(wb,hc,Za)=>K(this.$.oa.va,Qb,zb,ic,Ua.b(wb,this.tMi),hc,Za,null),wb=>new Ea.a(259,0,wb,1),null)}Qrd(zb){this.launchOrCloseDisambiguationPane(zb)}launchDisambiguationPaneForSearch(){b.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const zb=this.tlj();zb&&Wb.a(this.$.userOperationManager,(ic,Qb,wb)=>M(this.$.oa.va,zb,!0,this.lwa,!1,null,
Ua.b(ic,this.eKi),Qb,wb,1),ic=>new Ea.a(114,0,ic,16),null)}launchLinkedEntityDataTypeSelectorPane(zb,ic){Wb.a(this.$.userOperationManager,(Qb,wb,hc)=>W(this.$.oa.va,zb,ic,Ua.b(Qb,this.emc),wb,hc,2),Qb=>new Ea.a(233,0,Qb,16),null)}aqi(zb,ic){zb&&Wb.a(this.$.userOperationManager,(Qb,wb,hc)=>M(this.$.oa.va,zb,!1,!1,!0,ic,Ua.b(Qb,this.emc),wb,hc,2),Qb=>new Ea.a(257,0,Qb,16),null)}TZf(zb){zb&&(this.eoc=zb)}xjf(zb){if(sb.EwaSettings.ma(648)){var ic=new ma.a(-90814711,rb.a.Eb,0,10,null);this.$.Ka.Mb(ic,
null)}this.ota?this.C6b.CAc(zb,null):(ic=3,null!=this.ldb?ic=this.ldb:b.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),(zb=this.GMh(zb,ic))||b.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.LKe||b.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.C6b.gqi(this.LKe,zb),this.ota=!0)}nsa(){this.ota&&(b.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),
this.C6b.Owb(),this.ota=!1,this.eoc=0,this.SEb=!1)}Tvd(zb){var ic=zb.Row+1;zb=zb.Column+1;0>ic||0>zb?(b.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.nsa(),this.$.ea.Ik(this.Xc)):(ic=new Kb.Range(ic,zb,ic,zb,!0,!1),this.gridView.ha.updateSelection(ic,ic,60),this.Wbb=!0)}GMh(zb,ic){const Qb=new na;Qb.applicationVersion=e.AFrameworkApplication.buildVersion;Qb.applicationName="ExcelWac";Qb.anid="00000000-0000-0000-0000-000000000000";
Qb.sessionId=e.AFrameworkApplication.userSessionId;Qb.appCorrelationId=z.a.create().toString();var wb=A.a.YJ(e.AFrameworkApplication.lcid);wb=wb?wb.name:null;Qb.uiLanguage=wb;Qb.market=this.o$b(wb);Qb.themeId=0;Qb.disambiguationJson=zb;ic<=I.a.dS?Qb.featuresBitMask=ic:b.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Qb}o$b(zb){zb=zb.split("-");return zb[zb.length-1]}launchOrCloseDisambiguationPane(zb){const ic=this.gridView.ha.sa.activeCell;
if(this.rMd()&&ic)if(this.gridView.Db.eec(ic)){if((!this.ZGe||zb||this.YKb)&&!this.gridView.eb){zb&&(this.Wbb=!0);var Qb=nc.q(ic,this.$);Wb.a(this.$.userOperationManager,(wb,hc,Za)=>M(this.$.oa.va,Qb,!1,this.lwa,!1,null,Ua.b(wb,this.emc),hc,Za,1),wb=>new Ea.a(114,0,wb,16),null)}}else this.nsa();else this.nsa()}v6i(){if(this.ota){var zb=this.gridView.ha.sa.activeCell;if(zb){var ic=nc.q(zb,this.$);Wb.a(this.$.userOperationManager,(Qb,wb,hc)=>M(this.$.oa.va,ic,!1,this.lwa,!1,null,Ua.b(Qb,this.emc),wb,
hc,1),Qb=>new Ea.a(114,0,Qb,16),null)}else this.nsa()}}rMd(){const zb=this.gridView.ha.sa;return zb.jba()?nc.o(zb.activeCell,this.$):null}tlj(){const zb=this.gridView.ha.sa;return zb.jba()?nc.q(zb.activeCell,this.$):null}}Object(c.a)(Na,"ConvertToLinkedEntityDisambiguationPane",null,[2]);var Va=a(7),Sa=a(372),vb=a(1383),Oa=a(54),yb=a(709);class Ob{constructor(zb,ic,Qb){this.Tjf=2;this.Sjf="Size64by48";this.$=zb;this.Sa=ic;this.convertToLinkedEntityManager=Qb;this.Hwa=sb.EwaSettings.ma(668)}SEh(zb,
ic){var {ConvertToLinkedEntityManager:Qb}=a(756);this.sRj();ic=this.Sa.sq(ic).rE();let wb=0,hc=0,Za=!1;for(var ub of zb.Categories){const uc=this.yFh(ub,wb);uc&&(this.Hwa&&hc===Qb.J7a&&(Za=!0),ic.MenuSectionList.push(uc),++wb);++hc}this.Hwa&&Za&&wb<=Qb.Ujf&&ic.MenuSectionList.splice(Qb.J7a,1);Qb=this.Sa.zc().Q_b();ub=Oa.a.hf(11);for(const uc of zb.LongButtons)this.convertToLinkedEntityManager.Cxj(uc)&&this.bCg(Qb,uc,ub);0<Qb.ControlList.length&&ic.MenuSectionList.push(Qb);return ic}bCg(zb,ic,Qb){if(ic){var wb=
"Data.ConvertToLinkedEntityMenuItem_"+ic.Name,hc=this.convertToLinkedEntityManager.PP(ic.DomainId);hc&&(ic=Object(Va.a)(new Sa.a,{Id:wb,ExternalId:wb,Command:"-1662108744",LabelText:ic.Name,Alt:ic.SuperTip,Visible:!0,MenuItemId:a(756).ConvertToLinkedEntityManager.f1a(ic.DomainId),Image16by16:Qb,Image16by16Class:this.l7h(hc.FontLocator)}),zb.ControlList.push(ic))}}sFh(zb,ic){return Object(Va.a)(new vb.a,{Id:a(756).ConvertToLinkedEntityManager.IIe+zb.toString(),ExternalId:a(756).ConvertToLinkedEntityManager.IIe+
zb.toString(),MenuItemId:a(756).ConvertToLinkedEntityManager.m6c+zb.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.l8e(ic.FontLocator),LabelText:ic.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.Acd(ic)})}uMg(zb){switch(zb){case "Animal":return yb.a.OIg;case "Apple":return yb.a.TJg;case "Atom":return yb.a.oLg;case "Beaker":return yb.a.lNg;case "Bridge":return yb.a.MOg;case "Cat":return yb.a.KUg;case "City":return yb.a.RWg;
case "Constellation":return yb.a.O0g;case "Dog":return yb.a.Wgh;case "Finance":return yb.a.eNg;case "GradCap":return yb.a.X_h;case "HumanAnatomy":return yb.a.A6h;case "LocationPointer":return yb.a.Isi;case "Map":return yb.a.hUi;case "MedicineNeedle":return yb.a.czi;case "Mountain":return yb.a.vAi;case "Movie":return yb.a.QAi;case "Music":return yb.a.cBi;case "OuterSpace":return yb.a.KUi;case "Planet":return yb.a.IXi;case "Satellite":return yb.a.Pij;case "WolframGeneric":return yb.a.Ghj;default:return yb.a.C2g}}l7h(zb){if("PowerBIRibbon"!==
zb)return r.a.D8c;switch(zb){case "AnimalRibbon":return r.a.ssh;case "AppleRibbon":return r.a.tsh;case "AtomRibbon":return r.a.ush;case "BeakerRibbon":return r.a.vsh;case "BridgeRibbon":return r.a.wsh;case "CenterMapRibbon":return r.a.xsh;case "CityRibbon":return r.a.ysh;case "CurrencyRibbon":return r.a.zsh;case "ExerciseRibbon":return r.a.Ash;case "FinanceRibbon":return r.a.IOe;case "FirstAidRibbon":return r.a.Bsh;case "GlobeLightningRibbon":return r.a.Csh;case "GradCapRibbon":return r.a.Dsh;case "HumanAnatomyRibbon":return r.a.Esh;
case "LeafRibbon":return r.a.Fsh;case "LocationPointerRibbon":return r.a.Hsh;case "MapRibbon":return r.a.GOe;case "MountainRibbon":return r.a.Ish;case "MovieRibbon":return r.a.Jsh;case "MusicRibbon":return r.a.Ksh;case "NotablePeopleRibbon":return r.a.Lsh;case "OuterSpaceRibbon":return r.a.Msh;case "PartlySunnyWeatherRibbon":return r.a.Nsh;case "PowerBIRibbon":return r.a.HOe;case "SatelliteRibbon":return r.a.Osh;case "WolframGenericRibbon":return r.a.Gsh;case "YogaRibbon":return r.a.Qsh;default:return r.a.FOe}}l8e(zb){switch(zb){case "AnimalRibbon":return"AnimalExcelDataTypes_24";
case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";
case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";
case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}yFh(zb,ic){ic=this.Sa.FC("ConvertToLinkedEntitySection_"+ic,this.Tjf,this.Sjf);var Qb=!1;for(var wb of zb.DomainIds){const hc=
this.convertToLinkedEntityManager.PP(wb);if(!hc||hc.DomainBlocked||!hc.ShowInRibbon)continue;Qb=hc.Name;const Za=a(756).ConvertToLinkedEntityManager.f1a(wb);ic.Kt("Data.ConvertToLinkedEntityMenuItem_"+Za,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,Za,this.l8e(hc.FontLocator),void 0,void 0,this.Acd(hc),Qb);Qb=!0}if(!Qb)return null;wb=ic.N_b(!0);ic=this.Sa.zc();ic.title=zb.Name;zb=ic.Q_b();zb.ControlList.push(wb);return zb}sRj(){this.Tjf=5;this.Sjf="Size112by64"}Acd(zb){return zb.RibbonTooltipHeader?
zb.RibbonTooltipHeader+"\n\n"+zb.RibbonTooltip:zb.RibbonTooltip}}Object(c.a)(Ob,"ConvertToLinkedEntityMenuRenderer",null,[602]);var Ja=a(58),lb=a(247),Pb=a(121),Jb=a(171),Lb=a(69);class Ab{constructor(zb,ic){this.Mhd=this.Phd=!1;this.pPi=Qb=>{b.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.Phd=!0;if(fb.a.rg(Qb.Errors))b.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${fb.a.yc(Qb.Errors)}`);else{var wb=0,hc=[],Za=!1;try{if(!Qb.Result)return;
const ub=Qb.Result;if(!ub){b.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}hc=this.YVi(ub);if(!hc||!hc.length)return;wb=hc.length;this.rzi(hc);this.Aza.tSf();b.ULS.sendTraceTag(537166677,0,50,`OnReadRoamingStringSuccess MruCount:${this.Aza.sab.length}`);if(sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const uc of this.Aza.sab)if(1===(uc.Id&1048320)>>8){Za=!0;break}b.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${Za}`)}}finally{b.ULS.sendTraceTag(537166675,
0,50,`ParseRecentlyUsedLinkedDataTypes returned ${wb} data types.`),Qb=[],Qb.push(Object(Va.a)(new Lb.a,{name:"MruCount",int64:wb})),Qb.push(Object(Va.a)(new Lb.a,{name:"MruWolframAvailable",bool:Za})),Jb.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Qb)}this.Mhd&&(this.Bgg(this.Aza.sab),this.Mhd=!1)}};this.HTi=Qb=>{b.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");fb.a.rg(Qb.Errors)?b.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${fb.a.yc(Qb.Errors)}`):
Qb.Result&&(Qb.Result||b.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.gBf=(Qb,wb,hc)=>{Qb=Pb.a.lf(Qb.data);b.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${hc}. Errors: ${fb.a.yc(Qb)}.`)};this.$=zb;this.Aza=ic}wUh(){this.Phd||sb.EwaSettings.isChangeGateEnabled("OfficeVSO:6422438_RoamingHandlerNoSessionIdPresent")&&!this.$.ea.fc||(b.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),
lb.v(this.$.oa.va,0,this.pPi,this.gBf,null,null))}Bgg(zb){zb&&zb.length?this.Phd?(zb=this.gnj(zb))?(b.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),lb.B(this.$.oa.va,0,zb,this.HTi,this.gBf,null,null)):b.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.Mhd=!0:b.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}gnj(zb){if(!zb||
!zb.length)return b.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var ic=[];for(const Qb of zb)zb={},zb.Id=Qb.Id,Qb.StringId&&(zb.StringId=Qb.StringId),ic.push(zb);ic="<DataTypes>"+Ja.a.Ac(ic)+"</DataTypes>";return 1906<ic.length?(b.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):ic}YVi(zb){if(!zb)return b.ULS.sendTraceTag(537166685,0,
15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!zb.startsWith("<DataTypes>")||!zb.endsWith("</DataTypes>"))return b.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;zb=zb.substring(11,zb.length-12);if(!zb)return b.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let ic=[];try{ic=Ja.a.Vh(zb)}catch(Qb){return b.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${Qb.message}`),
null}b.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${ic.length} data types.`);return ic}rzi(zb){const ic=this.Aza.sab,Qb=this.Aza.s5i;if(ic.length!==Qb){for(let wb=0;wb<zb.length&&ic.length<Qb;++wb){const hc=zb[wb];this.Aza.PP(hc)&&!ic.includes(hc)&&ic.push(hc)}this.Aza.sab=ic}}}Object(c.a)(Ab,"LinkedDataTypeRoamingHandler",null,[]);var nb=a(513),va=a(59),db=a(50),Xa=a(212),gb=a(37),Ha=a(47),tb=a(28),bc=a(281),tc=a(22),Ma=a(99);a.d(C,"ConvertToLinkedEntityManager",function(){return Tb});
class Tb extends w.a{constructor(zb,ic,Qb,wb,hc,Za){super();this.sgf=this.Ipd=this.Bqd=this.yod=this.xod=this.s6a=this.sld=null;this.XCb=this.qhd=0;this.yba=null;this.Cld=!1;this.Sad=this.Ln=this.dLd=null;this.ds=0;this.RX=null;this.rKa=8;this.zYc=this.Rjf=this.qcf=this.W9a=!1;this.Cya=this.RUe=this.CRe=null;this.wWc=0;this.GMg=5;this.h_b=3E4;this.c$f=!1;this.w9=null;this.Qha=Array(5);this.Dbg=this.hXd=!1;this.GTf=this.nsd=0;this.S$d=null;this.O3f=!0;this.Xc=(ub,uc)=>{uc.fc&&!uc.Bzb&&this.showUntrustedImageBusinessBarIfNecessary()};
this.eLi=ub=>{if(ub.Result){var uc=ub.Result;if(uc&&uc.length){b.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${uc.length} labels`);var Oc=db.GetServiceTaskFactory.Ra(this.$.da,274,275,0);gb.TaskExtensions.Aa(Oc,()=>{Oc.result.nWc(uc,2)||b.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.la,3)}}else b.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};
this.Uf=()=>{this.Nyb&&(this.EMj(),this.Y1h(this.$.ea.to.LinkedEntityAsyncRefreshStateId));this.z6a?this.$2h(this.$.ea.to.RichDataClassificationLabelStateId):this.K5a&&this.uWd(!0)};this.JIi=()=>{this.hXd=!0;this.Ln&&this.Ln.v6i()};this.yKi=ub=>{if(ub&&!bc.a(ub))try{ub.Result.HasUntrustedImageUrl&&(this.businessBar.Yf(59,null),this.Dbg=!0)}catch(uc){b.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${uc}.`)}};
this.ujf=()=>{if(!this.Rjf&&this.fyb()&&!this.qmd())if(Jb.a("DataTabActive"),va.a.tg.BQ)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var ub=this.e3b();if(ub){var uc={};uc.InputMethod=rb.a.Eb;uc.CalloutName=8;uc.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ka.Mb(ub,uc);this.Rjf=!0}else b.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else b.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else b.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.GHi=ub=>{fb.a.rg(ub.Errors)||(this.z6a||this.uWd(!1),this.raiseEvent("LinkedEntityConverted"))};this.HRi=()=>{this.$.da.Za(211,ub=>{ub.readText(Ca.a.instance.ga(1810))})};this.$c=(ub,uc)=>{b.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");uc.$U?b.ULS.sendTraceTag(537166865,
0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(this.$.isEditMode?this.Twe():this.nfj(),sb.EwaSettings.ma(648)&&this.hXd&&this.OJe())};this.GKi=ub=>{this.j1b();if(ub.Result){var uc=ub.Result;ub=uc.DomainDataArray;this.yba=uc.Ribbon;if(this.Hwa&&this.yba){var Oc={};Oc.Name=Ca.a.instance.ga(1800);Oc.DomainIds=this.sK;this.yba.Categories.splice(Tb.J7a,0,Oc)}0<uc.MaximumCellsToConvert&&(this.S$d=uc.MaximumCellsToConvert);this.ds=2;uc=!1;if(ub){b.ULS.sendTraceTag(39949271,
0,50,`OnGetLinkedEntityServiceDomainsSuccess: Received ${ub.length} domains`);this.UMa||(this.UMa=[]);Oc=Ca.a.instance.ga(1797);const Bb=Ca.a.instance.ga(1799);for(const Nb of ub)Nb.DomainId?(this.UMa.push(Nb),Nb.DomainBlocked?(ub=!!Nb.DomainId.StringId,b.ULS.sendTraceTag(537166861,0,50,`Domain: ${ub?Nb.DomainId.Id.toString():Nb.Name} is telemetry only, do not show in menu (Has String ID: ${ub})`)):(this.$T.ia(Tb.f1a(Nb.DomainId),Nb),Nb.Name===Oc||268435456===Nb.DomainId.Id?this.CRe=Nb.DomainId.Id.toString():
Nb.Name===Bb||536870912===Nb.DomainId.Id?this.RUe=Nb.DomainId.Id.toString():268435712===Nb.DomainId.Id&&Nb.ShowInRibbon&&(this.zYc=!0),uc=!0)):b.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}uc||(this.UMa=null);this.qcg();this.Ood&&this.dLd.wUh();this.c$f||(this.AMj(),this.c$f=!0)}else this.UMa=null,this.ds=3,-1<this.rKa&&window.setTimeout(()=>{this.PFb()},100*(8-this.rKa)),b.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");
this.IGd();this.TCe();this.zYc&&this.Ldf&&Xa.c(this.ujf,this.$.la,500);this.K5a&&!this.z6a&&this.uWd(!0)};this.FKi=ub=>{ub=Pb.a.lf(ub.data);b.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${fb.a.yc(ub)}].`);this.UMa=null;this.ds=3;this.W9a=!0;this.IGd()};this.onContentReady=()=>{this.nag()&&this.gridView.py(this.onContentReady);this.O3f&&this.$.workbookContext.Options&1048576&&(this.businessBar.tBj(),this.O3f=!1)};this.Yi=()=>{this.j1b()};this.lNi=ub=>{if(bc.a(ub)){const uc=
db.GetServiceTaskFactory.Ra(this.$.da,5,4,0);gb.TaskExtensions.Aa(uc,()=>{let Bb=null;if(null===ub||void 0===ub?0:ub.Errors)Bb=ub.Errors[0];uc.result.u3f(Bb,null)},this.$.la,3);b.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${fb.a.yc(ub.Errors)}].`);const Oc=fb.a.QF(ub.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.ea.zp(Oc)}};
this.qYc=()=>{b.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.h_b} millisecond interval`);this.X$e("Periodic auto-refresh check",this.ZFi,this.YFi)};this.ZFi=ub=>{bc.a(ub)?(b.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${fb.a.yc(ub.Errors)}].`),++this.wWc):this.wWc=0;d.a.Ia(this.Cya);this.wWc>=this.GMg?(b.ULS.sendTraceTag(537166794,
0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.Cya=null):(b.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.Cya=Ha.a.instance.create(this.qYc,this.h_b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.YFi=ub=>{ub=Pb.a.lf(ub.data);f.a.Dh(ub)?b.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):
b.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${fb.a.yc(ub)}].`);d.a.Ia(this.Cya);this.Cya=Ha.a.instance.create(this.qYc,this.h_b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.nOi=ub=>{ub=!!ub.Result&&ub.Result;b.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${ub.toString()}`);ub?(b.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${tb.a.Wa.je.m-
this.qhd} ms, retry count = ${this.XCb}`),this.PFb()):this.yxc()};this.mOi=()=>{b.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.yxc()};this.iKi=ub=>{ub.Result?(ub=ub.Result)?(this.VHd(),this.businessBar.u3f(null,ub)):b.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):b.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=zb;this.businessBar=Za;this.svgIconProvider=
Qb;this.UMa=[];this.sK=[];this.gridView=ab.g(this.$);this.Xbc=-1;this.uii=sb.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.K5a=this.$.ma(440)&&this.$.ma(291);this.z6a=this.$.ma(669);this.Nyb=sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityAutoRefresh",!1);this.Ood=(this.Hwa=this.$.ma(668))&&sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReadAndWriteRecentlyUsedListToTheRoamingService",!0);this.Ldf=
sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.$T=new Ma.a;this.p8a=new Ob(zb,ic,this);wb&&(this.Ln=new Na(zb,wb,hc,this,this));this.$.el(this.$c);y.a(this.$)&&y.a(this.$).Koj(this);this.Twe();(this.Nyb||this.K5a||this.z6a)&&this.$.ea.Lu(this.Uf);sb.EwaSettings.ma(130)&&sb.EwaSettings.ma(138)&&(this.nag()||this.gridView.Ku(this.onContentReady));this.$.EA(this.Yi);sb.EwaSettings.ma(648)&&(this.$.ea.jk(this.Xc),this.showUntrustedImageBusinessBarIfNecessary());
this.Ood&&(this.dLd=new Ab(this.$,this))}dispose(){(this.Nyb||this.K5a||this.z6a)&&this.$.ea.Hw(this.Uf);sb.EwaSettings.ma(648)&&this.$.ea.Ik(this.Xc);!this.w9&&sb.EwaSettings.ma(130)&&sb.EwaSettings.ma(138)&&this.gridView.py(this.onContentReady);this.Ln&&this.Ln.dispose();this.$.zD(this.Yi);this.$.Al(this.$c);this.K5a&&(this.sld=null);d.a.Ia(this.Cya)}eFg(zb){this.addHandler("LinkedEntityConverted",zb)}TPf(zb){this.removeHandler("LinkedEntityConverted",zb)}get s5i(){return 5}get sab(){return this.sK}set sab(zb){this.sK=
zb}selectEntity(zb){return this.Ln?this.Ln.selectEntity(zb):!1}searchEntity(zb,ic){this.Ln&&this.Ln.searchEntity(zb,ic)}$Ld(zb,ic,Qb,wb){this.Ln&&this.Ln.searchEntity(zb,ic,!0,Qb,wb)}vCb(zb){return this.Ln?this.Ln.vCb(zb):!1}onPaneClosed(){if(this.Ln)this.Ln.onPaneClosed()}cancelSearch(){this.Ln&&this.Ln.cancelSearch()}selectDataType(zb){this.Ln&&this.Ln.selectDataType(zb)}showHelpArticle(zb){this.Ln&&this.Ln.showHelpArticle(zb)}showSurveyDialog(zb){this.Ln&&this.Ln.showSurveyDialog(zb)}insertTable(zb,
ic){this.Ln&&this.Ln.insertTable(zb,ic)}$2h(zb){this.$.isEditMode&&this.GTf!==zb&&e.AFrameworkApplication.fa.qa("SupportsPolicies")&&(this.GTf=zb,b.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels"),U(this.$.oa.va,this.eLi,null,null,null))}OJe(){const zb=(ic,Qb,wb)=>O(this.$.oa.va,Ua.b(ic,this.JIi),Qb,wb,null);sb.EwaSettings.dc()?this.$.userOperationManager.Ub(new Ea.a(589,0,zb,80),null):this.$.userOperationManager.Ub(new nb.a(589,
0,zb,16),null)}showUntrustedImageBusinessBarIfNecessary(){this.hXd||this.Dbg||!this.$.ea.fc||this.kmj()}kmj(){const zb=(ic,Qb,wb)=>qa(this.$.oa.va,Ua.b(ic,this.yKi),Qb,wb,null);sb.EwaSettings.dc()?this.$.userOperationManager.Ub(new Ea.a(588,0,zb,80),null):this.$.userOperationManager.Ub(new nb.a(588,0,zb,16),null)}uWd(zb){if(this.K5a&&null==this.sld&&!this.z6a&&e.AFrameworkApplication.fa.qa("SupportsPolicies")&&null!=this.s6a&&this.s6a&&(!zb||this.$.workbookContext.Options&262144)){var ic=db.GetServiceTaskFactory.Ra(this.$.da,
274,275,0);gb.TaskExtensions.Aa(ic,()=>{this.sld=ic.result.kNf(2)},this.$.la,3)}}get xNa(){return this.Qha.length}get Zyi(){return this.S$d}D2g(zb){(zb=this.$gh(zb))?this.convertToLinkedEntity(zb):b.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(zb){b.ULS.sendTraceTag(34415004,0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${zb.Id}].`);if(this.gridView){var ic=this.gridView.ha.sa.Wc,Qb=ic.Ge(this.gridView.nH);
this.Hwa&&this.Cld&&this.PCg(zb);if(Qb){Qb=this.gridView.Db.zwa(Qb);if(!this.H5e(zb)&&this.Nef(zb.Id)){b.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(va.a.tg.BQ){ic=this.Tbd();if(!ic){b.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Qb=this.e3b();if(!Qb){b.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var wb=
{["InputMethod"]:rb.a.Eb,CalloutName:3};wb.Target=ic;wb.RibbonButtonLabel=sb.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.vTf(zb):this.oAb(zb.Id.toString());wb.ExampleEntities=this.IPe(zb);this.$.Ka.Mb(Qb,wb);return}b.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.Nef(zb.Id)&&!zb.StringId)this.launchLinkedEntityDataTypeSelectorPane(Tb.f1a(zb));
else{if(Qb){b.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.sGj(zb)){ic=nc.r(this.gridView.ha.sa.selectedRanges,this.$);this.Ln.aqi(ic,zb);return}if(va.a.tg.BQ){ic=this.Tbd();if(!ic){b.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Qb=this.e3b();if(!Qb){b.ULS.sendTraceTag(537166912,
0,50,"RibbonCommandInfo is null for blankCellConvert");return}wb={["InputMethod"]:rb.a.Eb,CalloutName:2};wb.Target=ic;wb.RibbonButtonLabel=this.vTf(zb);wb.ExampleEntities=this.IPe(zb);wb.BlankCellResourceId=this.NNg(zb);wb.HasBlankCellWalkthrough=this.L3h(zb);wb.ServiceDomain=zb.Id;this.$.Ka.Mb(Qb,wb);return}b.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.B1c(zb,!1,ic)}}}else b.ULS.shipAssertTag(537166919,
0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.w9&&this.w9.ZGa()}onAutoDetectUIShown(){const zb=(ic,Qb,wb)=>S(this.$.oa.va,ic,Qb,wb,null);sb.EwaSettings.dc()?Wb.a(this.$.userOperationManager,zb,ic=>new Ea.a(230,0,ic,80),null):Wb.a(this.$.userOperationManager,zb,ic=>new nb.a(230,0,ic,16),null)}B1c(zb,ic,Qb){const wb=nc.q(Qb,this.$),hc=()=>new cc.a;Wb.a(this.$.userOperationManager,(Za,ub,uc)=>X(this.$.oa.va,wb,zb,ic,Ua.b(Za,this.GHi,this.HRi,this.Ln.FHi),ub,uc,null),
Za=>new Ea.a(115,0,Za,void 0,hc),null)}PCg(zb){if(this.Hwa&&this.Cld){var ic={};ic.Id=zb.Id;zb.StringId&&(ic.StringId=zb.StringId);if(!(0<this.sK.length&&this.sK[0].Id===ic.Id&&this.sK[0].StringId===ic.StringId)){zb=!1;this.sK.splice(0,0,ic);for(let Qb=1;Qb<this.sK.length;++Qb)if(this.sK[Qb].Id===ic.Id&&this.sK[Qb].StringId===ic.StringId){this.sK.splice(Qb,1);zb=!0;break}for(;5<this.sK.length;)this.sK.splice(this.sK.length-1,1);this.yba.Categories[Tb.J7a].DomainIds=this.sK;this.tSf();this.Ood&&!zb&&
this.dLd.Bgg(this.sK)}}}convertLinkedEntityToText(){b.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var zb=nc.q(this.gridView.ha.sa.Wc,this.$);Wb.a(this.$.userOperationManager,(ic,Qb,wb)=>D(this.$.oa.va,zb,ic,Qb,wb,null),ic=>new Ea.a(116,0,ic),null)}else b.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){b.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");
if(ab.g(this.$)){this.$.isEditMode||b.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.VHd();var zb=nc.r(this.gridView.ha.sa.selectedRanges,this.$);Wb.a(this.$.userOperationManager,(ic,Qb,wb)=>J(this.$.oa.va,zb,ic,Qb,wb,null),ic=>new Ea.a(248,0,ic),null)}else b.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}Cxj(zb){zb=this.PP(zb.DomainId);if(!zb||zb.DomainBlocked||sb.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&
!zb.HasCuratedData)return!1;if(this.uii){for(let ic of this.$T)if(ic.value.DomainId.Id===zb.DomainId.Id&&ic.value.ShowInRibbon)return!0;return!1}return zb.ShowInRibbon}swj(zb){return 2!==this.ds||!this.Qha[zb]}launchDisambiguationPaneForSearch(){this.Ln&&this.Ln.launchDisambiguationPaneForSearch()}Rc(zb,ic,Qb){if("PopulateConvertToLinkedEntityMenu"!==ic)return!1;this.Sad=Qb.MenuId;if(0===this.ds||3===this.ds)return this.jYi(),!0;if(!this.yba)return b.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),
!1;if(!this.$T)return b.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.RX=this.RX||this.p8a.SEh(this.yba,Qb.MenuId);Qb.MenuItems=this.RX;return this.Cld=!0}jYi(){-1===this.Xbc&&(this.PFb(),this.Xbc=window.setInterval(()=>{this.PFb()},2E3))}PFb(){this.$.ea.fc&&2!==this.ds&&(this.rKa--,b.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted."),this.ds=1,H(this.$.oa.va,this.GKi,this.FKi,null,null))}qmd(){return this.$.isEditMode&&
2!==this.ds&&(0<=this.rKa||!this.W9a)}SXd(zb){e.AFrameworkApplication.Ng?b.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):y.a(this.$)?(this.SRj(),zb&&this.$.qf()):b.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}nfj(){this.XCb=0;this.rKa=8;this.W9a=!1;this.ds=this.Xbc=0;this.UMa=this.yba=null;this.j1b();for(let zb=0;zb<this.xNa;++zb)this.Qha[zb]=null;this.fyb()&&this.SXd(!0)}j1b(){this.RX=null}fyb(){const zb=
u.a.HGb,ic=y.a(this.$);return!!ic&&ic.Vl.Tz===zb}qcg(){if(this.yba){let wb=0;if(this.Hwa){let hc=-1,Za=-1,ub=0,uc=0,Oc=0;var zb=0,ic=[null,null,null,null,null];for(var Qb of this.yba.Categories){let Bb=!1;for(const Nb of Qb.DomainIds){let dc=this.PP(Nb);dc&&!dc.DomainBlocked&&dc.ShowInRibbon&&(wb<this.xNa?(this.Qha[wb]=Nb,uc===Tb.J7a&&(-1===hc&&(hc=wb),Za=wb,zb=Za-hc+1),++wb):wb===this.xNa&&ub<zb&&uc!==Tb.J7a&&(ic[ub]=Nb,++ub),Bb=!0)}Bb&&++Oc;++uc}if(-1<hc&&Oc<=Tb.Ujf){for(Qb=Za;Qb>=hc;--Qb)this.Qha.splice(Qb,
1);for(Qb=0;Qb<zb;++Qb)this.Qha.splice(wb+Qb,0,ic[Qb])}}else for(zb of this.yba.Categories){for(ic of zb.DomainIds)if((Qb=this.PP(ic))&&!Qb.DomainBlocked&&Qb.ShowInRibbon&&(this.Qha[wb]=ic,++wb,wb>=this.xNa))break;if(wb>=this.xNa)break}for(;wb<this.xNa;)this.Qha[wb]=null,++wb}}nag(){var zb=Object(n.a)(580,ab.g(this.$).Ea);const ic=this.gridView.ha.Je;return zb&&zb.uhd&&1===ic&&this.gridView.ha.sa.activeCell?(zb=db.GetServiceTaskFactory.Ra(this.$.da,12,477,1),this.w9=new x.a(this.$,this.svgIconProvider,
zb.result,this),!0):!1}dqi(){this.Ln&&this.Ln.Qrd(!0)}launchLinkedEntityDataTypeSelectorPane(zb){if(this.Ln)if(zb=this.U5c(zb))if(zb.DomainId.StringId)b.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var ic=nc.r(this.gridView.ha.sa.selectedRanges,this.$);this.Ln.launchLinkedEntityDataTypeSelectorPane(ic,zb.DomainId.Id)}else b.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}S0g(zb){const ic=this.k7h(zb),
Qb=k.a.Eg(this.oAb(zb));zb=k.a.Eg(this.sVd(zb));return Tb.uEh(ic,Oa.a.hf(11),Qb,zb)}sVd(zb){try{return this.VHe(parseInt(zb,10)).Description}catch(ic){}return Ca.a.instance.ga(1794)}oAb(zb){try{return this.VHe(parseInt(zb,10)).Name}catch(ic){}return Ca.a.instance.ga(1780)}vTf(zb){try{return this.PP(zb).Name}catch(ic){}return this.oAb(zb.Id.toString())}NNg(zb){try{return this.PP(zb).BlankCellResourceId}catch(ic){}return null}L3h(zb){try{return this.PP(zb).HasBlankCellWalkthrough}catch(ic){}return!1}H5e(zb){try{const ic=
Tb.f1a(zb);if(this.$T.mb(ic))return this.$T.na(ic).HasCuratedData}catch(ic){}return!1}sGj(zb){try{return this.PP(zb).SupportsStarterData}catch(ic){}return!1}Nef(zb){return 268435968===zb}Tbd(){return 2===y.a(this.$).uR?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}e3b(){return new ma.a(-847286761,rb.a.Eb,this.$.Mc,0,u.a.KV)}TCe(){if(this.fyb()&&!this.qmd()&&!this.qcf&&sb.EwaSettings.ma(440)&&this.H5e({Id:268435968,StringId:null}))if(b.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),
va.a.tg.BQ){const Qb=this.Tbd();if(Qb){var zb=this.e3b();if(zb){var ic={["InputMethod"]:rb.a.Eb,CalloutName:6};ic.Target=Qb;ic.ShouldCanvasTakeFocus=!0;this.$.Ka.Mb(zb,ic);this.qcf=!0}else b.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else b.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else b.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}J6h(zb){zb=
this.U5c(zb);return zb?this.p8a.uMg(zb.SubdomainFontLocator):(b.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}vec(zb){return this.w9?this.w9.tMg(zb):!1}CHh(){return this.w9?this.w9.xIh():""}Qdi(){return this.w9?this.w9.UAb:!1}pMh(zb,ic){const Qb=this.X8e(zb);if(0>Qb)b.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${zb}`);else if(zb=(zb=this.WHe(zb))?this.PP(zb):
null)ic[l.a.GalleryButtonProps]=this.p8a.sFh(Qb,zb),ic[l.a.Alt]=this.p8a.Acd(zb)}tSf(){this.qcg();this.fyb()&&this.SXd(!0);this.j1b()}k7h(zb){return zb===this.CRe?r.a.IOe:zb===this.RUe?r.a.GOe:r.a.FOe}IPe(zb){try{return this.PP(zb).ExampleEntities}catch(ic){}return Ca.a.instance.ga(1802)}IGd(){(0>this.rKa||this.W9a)&&b.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.ds||0>this.rKa||this.W9a)&&window.clearInterval(this.Xbc);this.qmd()?
this.Sad&&this.$.frame.Qw(this.Sad):this.SXd(this.fyb())}Gb(zb){return this.$.Bb+zb}SRj(){var zb=!0;const ic=Array(this.xNa),Qb=y.a(this.$)?y.a(this.$).Vl:null;if(Qb){for(let wb=0;wb<ic.length;++wb)this.swj(wb)?ic[wb]=!0:zb=ic[wb]=!1;Qb.sOd(["ConvertToLinkedEntityGallery"],zb);if(!zb)for(zb=0;zb<ic.length;++zb)ic[zb]&&Qb.sOd([this.oMh(zb)],!0)}else b.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}PP(zb){const ic=Tb.f1a(zb);if(this.$T.mb(ic))return this.$T.na(ic);
b.ULS.sendTraceTag(592729218,0,15,`No domain data for domain ID ${zb.Id} (Has String ID: ${!!zb.StringId})`);return null}oMh(zb){return"ConvertToLinkedEntityPreview"+zb.toString()}JXd(){m.a.get_instance().rk(10,()=>{this.TCe();this.zYc&&this.Ldf&&Xa.c(this.ujf,this.$.la,500)})}Mbc(zb,ic){switch(zb){case "QueryLinkedEntityGalleryButtons":if(!ic[l.a.InnerHTML]){zb=ic[rb.a.Pc].toString();const Qb=tc.a.equals(zb,Ca.a.instance.ga(1797),!0)||tc.a.equals(zb,Ca.a.instance.ga(1798),!0),wb=tc.a.equals(zb,Ca.a.instance.ga(1799),
!0);Qb||wb||this.pMh(zb,ic)}break;case "QueryLinkedEntityMenuGalleryButtons":ic[l.a.InnerHTML]||(ic[l.a.InnerHTML]=this.S0g(ic[rb.a.Pc]))}return ic}$gh(zb){var ic=this.WHe(zb);if(ic)return ic;if(ic=this.U5c(zb))return ic.DomainId;b.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${zb}`);return null}VHe(zb){const ic={};ic.Id=zb;return this.PP(ic)}U5c(zb){return this.$T.mb(zb)?this.$T.na(zb):null}X8e(zb){if(!zb.startsWith(Tb.m6c))return-1;const ic=parseInt(zb.substr(Tb.m6c.length),
10);return isNaN(ic)?(b.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${zb}`),-1):ic}WHe(zb){zb=this.X8e(zb);return 0>zb?null:this.Qha[zb]}X$e(zb,ic,Qb){this.Nyb&&this.$T&&this.$T.count&&(b.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${zb})`),zb=this.$.oa.va.Sb(),this.$.ea.fc&&ea(this.$.oa.va,Ua.b(this.lNi,ic),Qb,null,null,zb))}AMj(){this.X$e("Auto-refresh on load",null,null)}EMj(){this.Nyb&&this.$T&&this.$T.count&&
(this.Cya?b.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.to.HasAutoRefreshableLinkedEntityDomainsEver?(b.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.Cya=Ha.a.instance.create(this.qYc,this.h_b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):
b.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}yxc(){if(this.$.ea.fc&&null!=this.s6a&&null!=this.xod&&null!=this.yod&&null!=this.Bqd&&null!=this.Ipd)if(++this.XCb,12>=this.XCb){1===this.XCb&&(this.qhd=tb.a.Wa.je.m,b.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));const zb=this.$.oa.va.Sb();
lb.t(this.$.oa.va,this.jri,this.kri(),this.nOi,this.mOi,null,zb)}else b.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${tb.a.Wa.je.m-this.qhd} ms`),this.W9a=!0,this.IGd()}Twe(){if(this.$.isEditMode)if(null!=this.s6a)this.yxc();else{var zb=tb.a.Wa.je.m,ic=[];v.a.instance.Wb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Qb=>{Qb.isFeatureEnabled("ExcelPowerBiPro",!1).then(wb=>{b.ULS.sendTraceTag(537166747,
0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${tb.a.Wa.je.m-zb} Millisecond.`);b.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${wb}]`);return this.s6a=wb}).then(()=>{ic.push(Qb.isFeatureEnabled("ExcelWolframAlpha",!1).then(wb=>{b.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${tb.a.Wa.je.m-zb} Millisecond.`);b.ULS.sendTraceTag(537166743,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${wb}]`);return this.Bqd=wb}))}).then(()=>{ic.push(Qb.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(wb=>{b.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${tb.a.Wa.je.m-zb} Millisecond.`);b.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${wb}]`);
let hc;const Za=[(hc=new Lb.a,hc.name="IsRestrictedByLicense",hc.bool=wb,hc)];Jb.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,Za);this.sgf=wb&&sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return wb}))}).then(()=>{ic.push(Qb.isFeatureEnabled("StockHistory",!1).then(wb=>{b.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${tb.a.Wa.je.m-zb} Millisecond.`);b.ULS.sendTraceTag(537166738,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${wb}]`);return this.Ipd=wb}))}).then(()=>{ic.push(Qb.isFeatureEnabled("ExcelPowerBiFree",!1).then(wb=>{b.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${tb.a.Wa.je.m-zb} Millisecond.`);b.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${wb}]`);return this.xod=wb}))}).then(()=>
{ic.push(Qb.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(wb=>{b.ULS.sendTraceTag(537166734,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${tb.a.Wa.je.m-zb} Millisecond.`);b.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${wb}]`);return this.yod=wb}))}).then(()=>{Promise.all(ic).then(()=>{this.yxc()})})})}}get jri(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}kri(){return[this.s6a,
this.Bqd,this.Ipd,this.xod,this.yod,this.sgf]}VHd(){this.businessBar&&this.businessBar.FLa(58)&&this.businessBar.removeEntry(58)}Y1h(zb){this.nsd!==zb&&this.businessBar&&((this.nsd=zb)?da(this.$.oa.va,this.iKi,null,null,null):this.VHd())}static uEh(zb,ic,Qb,wb){zb=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',zb,ic,wb);Qb=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
Qb);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',zb,Qb)}static f1a(zb){return zb.StringId?zb.Id.toString()+"."+zb.StringId:zb.Id.toString()}}Tb.IIe="ConvertToLinkedEntityPreview";Tb.m6c="PreviewGalleryButtonIndex.";Tb.J7a=0;Tb.Ujf=2;Object(c.a)(Tb,"ConvertToLinkedEntityManager",w.a,[581,582,2,583])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.le.js.map/daceba8b196cd3020f3bd1fb64b2c91c/EwaDSEsNext.le.js.map